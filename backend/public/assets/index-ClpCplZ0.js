function ZR(t,e){for(var r=0;r<e.length;r++){const a=e[r];if(typeof a!="string"&&!Array.isArray(a)){for(const o in a)if(o!=="default"&&!(o in t)){const n=Object.getOwnPropertyDescriptor(a,o);n&&Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:()=>a[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const f of n.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();var px=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function DO(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function a(){var o=!1;try{o=this instanceof a}catch{}return o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(a){var o=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(r,a,o.get?o:{enumerable:!0,get:function(){return t[a]}})}),r}var HS={exports:{}},ay={};var _k;function RO(){if(_k)return ay;_k=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(a,o,n){var f=null;if(n!==void 0&&(f=""+n),o.key!==void 0&&(f=""+o.key),"key"in o){n={};for(var m in o)m!=="key"&&(n[m]=o[m])}else n=o;return o=n.ref,{$$typeof:t,type:a,key:f,ref:o!==void 0?o:null,props:n}}return ay.Fragment=e,ay.jsx=r,ay.jsxs=r,ay}var Ok;function IO(){return Ok||(Ok=1,HS.exports=RO()),HS.exports}var d=IO(),WS={exports:{}},Er={};var Fk;function PO(){if(Fk)return Er;Fk=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),n=Symbol.for("react.consumer"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),C=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),R=Symbol.iterator;function I(V){return V===null||typeof V!="object"?null:(V=R&&V[R]||V["@@iterator"],typeof V=="function"?V:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,O={};function j(V,ue,Ee){this.props=V,this.context=ue,this.refs=O,this.updater=Ee||M}j.prototype.isReactComponent={},j.prototype.setState=function(V,ue){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,ue,"setState")},j.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function U(){}U.prototype=j.prototype;function H(V,ue,Ee){this.props=V,this.context=ue,this.refs=O,this.updater=Ee||M}var K=H.prototype=new U;K.constructor=H,F(K,j.prototype),K.isPureReactComponent=!0;var W=Array.isArray;function X(){}var ee={H:null,A:null,T:null,S:null},ie=Object.prototype.hasOwnProperty;function de(V,ue,Ee){var Ie=Ee.ref;return{$$typeof:t,type:V,key:ue,ref:Ie!==void 0?Ie:null,props:Ee}}function le(V,ue){return de(V.type,ue,V.props)}function oe(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function N(V){var ue={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(Ee){return ue[Ee]})}var ce=/\/+/g;function ne(V,ue){return typeof V=="object"&&V!==null&&V.key!=null?N(""+V.key):ue.toString(36)}function Se(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(X,X):(V.status="pending",V.then(function(ue){V.status==="pending"&&(V.status="fulfilled",V.value=ue)},function(ue){V.status==="pending"&&(V.status="rejected",V.reason=ue)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function se(V,ue,Ee,Ie,ae){var be=typeof V;(be==="undefined"||be==="boolean")&&(V=null);var Te=!1;if(V===null)Te=!0;else switch(be){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(V.$$typeof){case t:case e:Te=!0;break;case w:return Te=V._init,se(Te(V._payload),ue,Ee,Ie,ae)}}if(Te)return ae=ae(V),Te=Ie===""?"."+ne(V,0):Ie,W(ae)?(Ee="",Te!=null&&(Ee=Te.replace(ce,"$&/")+"/"),se(ae,ue,Ee,"",function(Pe){return Pe})):ae!=null&&(oe(ae)&&(ae=le(ae,Ee+(ae.key==null||V&&V.key===ae.key?"":(""+ae.key).replace(ce,"$&/")+"/")+Te)),ue.push(ae)),1;Te=0;var tt=Ie===""?".":Ie+":";if(W(V))for(var je=0;je<V.length;je++)Ie=V[je],be=tt+ne(Ie,je),Te+=se(Ie,ue,Ee,be,ae);else if(je=I(V),typeof je=="function")for(V=je.call(V),je=0;!(Ie=V.next()).done;)Ie=Ie.value,be=tt+ne(Ie,je++),Te+=se(Ie,ue,Ee,be,ae);else if(be==="object"){if(typeof V.then=="function")return se(Se(V),ue,Ee,Ie,ae);throw ue=String(V),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.")}return Te}function ye(V,ue,Ee){if(V==null)return V;var Ie=[],ae=0;return se(V,Ie,"","",function(be){return ue.call(Ee,be,ae++)}),Ie}function ze(V){if(V._status===-1){var ue=V._result;ue=ue(),ue.then(function(Ee){(V._status===0||V._status===-1)&&(V._status=1,V._result=Ee)},function(Ee){(V._status===0||V._status===-1)&&(V._status=2,V._result=Ee)}),V._status===-1&&(V._status=0,V._result=ue)}if(V._status===1)return V._result.default;throw V._result}var Re=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ue=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(ue))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},ve={map:ye,forEach:function(V,ue,Ee){ye(V,function(){ue.apply(this,arguments)},Ee)},count:function(V){var ue=0;return ye(V,function(){ue++}),ue},toArray:function(V){return ye(V,function(ue){return ue})||[]},only:function(V){if(!oe(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Er.Activity=A,Er.Children=ve,Er.Component=j,Er.Fragment=r,Er.Profiler=o,Er.PureComponent=H,Er.StrictMode=a,Er.Suspense=y,Er.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ee,Er.__COMPILER_RUNTIME={__proto__:null,c:function(V){return ee.H.useMemoCache(V)}},Er.cache=function(V){return function(){return V.apply(null,arguments)}},Er.cacheSignal=function(){return null},Er.cloneElement=function(V,ue,Ee){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var Ie=F({},V.props),ae=V.key;if(ue!=null)for(be in ue.key!==void 0&&(ae=""+ue.key),ue)!ie.call(ue,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&ue.ref===void 0||(Ie[be]=ue[be]);var be=arguments.length-2;if(be===1)Ie.children=Ee;else if(1<be){for(var Te=Array(be),tt=0;tt<be;tt++)Te[tt]=arguments[tt+2];Ie.children=Te}return de(V.type,ae,Ie)},Er.createContext=function(V){return V={$$typeof:f,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:n,_context:V},V},Er.createElement=function(V,ue,Ee){var Ie,ae={},be=null;if(ue!=null)for(Ie in ue.key!==void 0&&(be=""+ue.key),ue)ie.call(ue,Ie)&&Ie!=="key"&&Ie!=="__self"&&Ie!=="__source"&&(ae[Ie]=ue[Ie]);var Te=arguments.length-2;if(Te===1)ae.children=Ee;else if(1<Te){for(var tt=Array(Te),je=0;je<Te;je++)tt[je]=arguments[je+2];ae.children=tt}if(V&&V.defaultProps)for(Ie in Te=V.defaultProps,Te)ae[Ie]===void 0&&(ae[Ie]=Te[Ie]);return de(V,be,ae)},Er.createRef=function(){return{current:null}},Er.forwardRef=function(V){return{$$typeof:m,render:V}},Er.isValidElement=oe,Er.lazy=function(V){return{$$typeof:w,_payload:{_status:-1,_result:V},_init:ze}},Er.memo=function(V,ue){return{$$typeof:C,type:V,compare:ue===void 0?null:ue}},Er.startTransition=function(V){var ue=ee.T,Ee={};ee.T=Ee;try{var Ie=V(),ae=ee.S;ae!==null&&ae(Ee,Ie),typeof Ie=="object"&&Ie!==null&&typeof Ie.then=="function"&&Ie.then(X,Re)}catch(be){Re(be)}finally{ue!==null&&Ee.types!==null&&(ue.types=Ee.types),ee.T=ue}},Er.unstable_useCacheRefresh=function(){return ee.H.useCacheRefresh()},Er.use=function(V){return ee.H.use(V)},Er.useActionState=function(V,ue,Ee){return ee.H.useActionState(V,ue,Ee)},Er.useCallback=function(V,ue){return ee.H.useCallback(V,ue)},Er.useContext=function(V){return ee.H.useContext(V)},Er.useDebugValue=function(){},Er.useDeferredValue=function(V,ue){return ee.H.useDeferredValue(V,ue)},Er.useEffect=function(V,ue){return ee.H.useEffect(V,ue)},Er.useEffectEvent=function(V){return ee.H.useEffectEvent(V)},Er.useId=function(){return ee.H.useId()},Er.useImperativeHandle=function(V,ue,Ee){return ee.H.useImperativeHandle(V,ue,Ee)},Er.useInsertionEffect=function(V,ue){return ee.H.useInsertionEffect(V,ue)},Er.useLayoutEffect=function(V,ue){return ee.H.useLayoutEffect(V,ue)},Er.useMemo=function(V,ue){return ee.H.useMemo(V,ue)},Er.useOptimistic=function(V,ue){return ee.H.useOptimistic(V,ue)},Er.useReducer=function(V,ue,Ee){return ee.H.useReducer(V,ue,Ee)},Er.useRef=function(V){return ee.H.useRef(V)},Er.useState=function(V){return ee.H.useState(V)},Er.useSyncExternalStore=function(V,ue,Ee){return ee.H.useSyncExternalStore(V,ue,Ee)},Er.useTransition=function(){return ee.H.useTransition()},Er.version="19.2.1",Er}var Nk;function KT(){return Nk||(Nk=1,WS.exports=PO()),WS.exports}var E=KT();const Jr=hb(E),h2=ZR({__proto__:null,default:Jr},[E]);var VS={exports:{}},sy={},GS={exports:{}},KS={};var jk;function MO(){return jk||(jk=1,(function(t){function e(se,ye){var ze=se.length;se.push(ye);e:for(;0<ze;){var Re=ze-1>>>1,ve=se[Re];if(0<o(ve,ye))se[Re]=ye,se[ze]=ve,ze=Re;else break e}}function r(se){return se.length===0?null:se[0]}function a(se){if(se.length===0)return null;var ye=se[0],ze=se.pop();if(ze!==ye){se[0]=ze;e:for(var Re=0,ve=se.length,V=ve>>>1;Re<V;){var ue=2*(Re+1)-1,Ee=se[ue],Ie=ue+1,ae=se[Ie];if(0>o(Ee,ze))Ie<ve&&0>o(ae,Ee)?(se[Re]=ae,se[Ie]=ze,Re=Ie):(se[Re]=Ee,se[ue]=ze,Re=ue);else if(Ie<ve&&0>o(ae,ze))se[Re]=ae,se[Ie]=ze,Re=Ie;else break e}}return ye}function o(se,ye){var ze=se.sortIndex-ye.sortIndex;return ze!==0?ze:se.id-ye.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var n=performance;t.unstable_now=function(){return n.now()}}else{var f=Date,m=f.now();t.unstable_now=function(){return f.now()-m}}var y=[],C=[],w=1,A=null,R=3,I=!1,M=!1,F=!1,O=!1,j=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function K(se){for(var ye=r(C);ye!==null;){if(ye.callback===null)a(C);else if(ye.startTime<=se)a(C),ye.sortIndex=ye.expirationTime,e(y,ye);else break;ye=r(C)}}function W(se){if(F=!1,K(se),!M)if(r(y)!==null)M=!0,X||(X=!0,N());else{var ye=r(C);ye!==null&&Se(W,ye.startTime-se)}}var X=!1,ee=-1,ie=5,de=-1;function le(){return O?!0:!(t.unstable_now()-de<ie)}function oe(){if(O=!1,X){var se=t.unstable_now();de=se;var ye=!0;try{e:{M=!1,F&&(F=!1,U(ee),ee=-1),I=!0;var ze=R;try{t:{for(K(se),A=r(y);A!==null&&!(A.expirationTime>se&&le());){var Re=A.callback;if(typeof Re=="function"){A.callback=null,R=A.priorityLevel;var ve=Re(A.expirationTime<=se);if(se=t.unstable_now(),typeof ve=="function"){A.callback=ve,K(se),ye=!0;break t}A===r(y)&&a(y),K(se)}else a(y);A=r(y)}if(A!==null)ye=!0;else{var V=r(C);V!==null&&Se(W,V.startTime-se),ye=!1}}break e}finally{A=null,R=ze,I=!1}ye=void 0}}finally{ye?N():X=!1}}}var N;if(typeof H=="function")N=function(){H(oe)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ne=ce.port2;ce.port1.onmessage=oe,N=function(){ne.postMessage(null)}}else N=function(){j(oe,0)};function Se(se,ye){ee=j(function(){se(t.unstable_now())},ye)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(se){se.callback=null},t.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<se?Math.floor(1e3/se):5},t.unstable_getCurrentPriorityLevel=function(){return R},t.unstable_next=function(se){switch(R){case 1:case 2:case 3:var ye=3;break;default:ye=R}var ze=R;R=ye;try{return se()}finally{R=ze}},t.unstable_requestPaint=function(){O=!0},t.unstable_runWithPriority=function(se,ye){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var ze=R;R=se;try{return ye()}finally{R=ze}},t.unstable_scheduleCallback=function(se,ye,ze){var Re=t.unstable_now();switch(typeof ze=="object"&&ze!==null?(ze=ze.delay,ze=typeof ze=="number"&&0<ze?Re+ze:Re):ze=Re,se){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=ze+ve,se={id:w++,callback:ye,priorityLevel:se,startTime:ze,expirationTime:ve,sortIndex:-1},ze>Re?(se.sortIndex=ze,e(C,se),r(y)===null&&se===r(C)&&(F?(U(ee),ee=-1):F=!0,Se(W,ze-Re))):(se.sortIndex=ve,e(y,se),M||I||(M=!0,X||(X=!0,N()))),se},t.unstable_shouldYield=le,t.unstable_wrapCallback=function(se){var ye=R;return function(){var ze=R;R=ye;try{return se.apply(this,arguments)}finally{R=ze}}}})(KS)),KS}var Lk;function _O(){return Lk||(Lk=1,GS.exports=MO()),GS.exports}var YS={exports:{}},Xs={};var Bk;function OO(){if(Bk)return Xs;Bk=1;var t=KT();function e(y){var C="https://react.dev/errors/"+y;if(1<arguments.length){C+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)C+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+y+"; visit "+C+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},o=Symbol.for("react.portal");function n(y,C,w){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:A==null?null:""+A,children:y,containerInfo:C,implementation:w}}var f=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(y,C){if(y==="font")return"";if(typeof C=="string")return C==="use-credentials"?C:""}return Xs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Xs.createPortal=function(y,C){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C||C.nodeType!==1&&C.nodeType!==9&&C.nodeType!==11)throw Error(e(299));return n(y,C,null,w)},Xs.flushSync=function(y){var C=f.T,w=a.p;try{if(f.T=null,a.p=2,y)return y()}finally{f.T=C,a.p=w,a.d.f()}},Xs.preconnect=function(y,C){typeof y=="string"&&(C?(C=C.crossOrigin,C=typeof C=="string"?C==="use-credentials"?C:"":void 0):C=null,a.d.C(y,C))},Xs.prefetchDNS=function(y){typeof y=="string"&&a.d.D(y)},Xs.preinit=function(y,C){if(typeof y=="string"&&C&&typeof C.as=="string"){var w=C.as,A=m(w,C.crossOrigin),R=typeof C.integrity=="string"?C.integrity:void 0,I=typeof C.fetchPriority=="string"?C.fetchPriority:void 0;w==="style"?a.d.S(y,typeof C.precedence=="string"?C.precedence:void 0,{crossOrigin:A,integrity:R,fetchPriority:I}):w==="script"&&a.d.X(y,{crossOrigin:A,integrity:R,fetchPriority:I,nonce:typeof C.nonce=="string"?C.nonce:void 0})}},Xs.preinitModule=function(y,C){if(typeof y=="string")if(typeof C=="object"&&C!==null){if(C.as==null||C.as==="script"){var w=m(C.as,C.crossOrigin);a.d.M(y,{crossOrigin:w,integrity:typeof C.integrity=="string"?C.integrity:void 0,nonce:typeof C.nonce=="string"?C.nonce:void 0})}}else C==null&&a.d.M(y)},Xs.preload=function(y,C){if(typeof y=="string"&&typeof C=="object"&&C!==null&&typeof C.as=="string"){var w=C.as,A=m(w,C.crossOrigin);a.d.L(y,w,{crossOrigin:A,integrity:typeof C.integrity=="string"?C.integrity:void 0,nonce:typeof C.nonce=="string"?C.nonce:void 0,type:typeof C.type=="string"?C.type:void 0,fetchPriority:typeof C.fetchPriority=="string"?C.fetchPriority:void 0,referrerPolicy:typeof C.referrerPolicy=="string"?C.referrerPolicy:void 0,imageSrcSet:typeof C.imageSrcSet=="string"?C.imageSrcSet:void 0,imageSizes:typeof C.imageSizes=="string"?C.imageSizes:void 0,media:typeof C.media=="string"?C.media:void 0})}},Xs.preloadModule=function(y,C){if(typeof y=="string")if(C){var w=m(C.as,C.crossOrigin);a.d.m(y,{as:typeof C.as=="string"&&C.as!=="script"?C.as:void 0,crossOrigin:w,integrity:typeof C.integrity=="string"?C.integrity:void 0})}else a.d.m(y)},Xs.requestFormReset=function(y){a.d.r(y)},Xs.unstable_batchedUpdates=function(y,C){return y(C)},Xs.useFormState=function(y,C,w){return f.H.useFormState(y,C,w)},Xs.useFormStatus=function(){return f.H.useHostTransitionStatus()},Xs.version="19.2.1",Xs}var zk;function e3(){if(zk)return YS.exports;zk=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),YS.exports=OO(),YS.exports}var Uk;function FO(){if(Uk)return sy;Uk=1;var t=_O(),e=KT(),r=e3();function a(i){var l="https://react.dev/errors/"+i;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function n(i){var l=i,p=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(p=l.return),i=l.return;while(i)}return l.tag===3?p:null}function f(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function m(i){if(i.tag===31){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function y(i){if(n(i)!==i)throw Error(a(188))}function C(i){var l=i.alternate;if(!l){if(l=n(i),l===null)throw Error(a(188));return l!==i?null:i}for(var p=i,b=l;;){var D=p.return;if(D===null)break;var P=D.alternate;if(P===null){if(b=D.return,b!==null){p=b;continue}break}if(D.child===P.child){for(P=D.child;P;){if(P===p)return y(D),i;if(P===b)return y(D),l;P=P.sibling}throw Error(a(188))}if(p.return!==b.return)p=D,b=P;else{for(var q=!1,ge=D.child;ge;){if(ge===p){q=!0,p=D,b=P;break}if(ge===b){q=!0,b=D,p=P;break}ge=ge.sibling}if(!q){for(ge=P.child;ge;){if(ge===p){q=!0,p=P,b=D;break}if(ge===b){q=!0,b=P,p=D;break}ge=ge.sibling}if(!q)throw Error(a(189))}}if(p.alternate!==b)throw Error(a(190))}if(p.tag!==3)throw Error(a(188));return p.stateNode.current===p?i:l}function w(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i;for(i=i.child;i!==null;){if(l=w(i),l!==null)return l;i=i.sibling}return null}var A=Object.assign,R=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),H=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),de=Symbol.for("react.activity"),le=Symbol.for("react.memo_cache_sentinel"),oe=Symbol.iterator;function N(i){return i===null||typeof i!="object"?null:(i=oe&&i[oe]||i["@@iterator"],typeof i=="function"?i:null)}var ce=Symbol.for("react.client.reference");function ne(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===ce?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case F:return"Fragment";case j:return"Profiler";case O:return"StrictMode";case W:return"Suspense";case X:return"SuspenseList";case de:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case M:return"Portal";case H:return i.displayName||"Context";case U:return(i._context.displayName||"Context")+".Consumer";case K:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ee:return l=i.displayName||null,l!==null?l:ne(i.type)||"Memo";case ie:l=i._payload,i=i._init;try{return ne(i(l))}catch{}}return null}var Se=Array.isArray,se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ze={pending:!1,data:null,method:null,action:null},Re=[],ve=-1;function V(i){return{current:i}}function ue(i){0>ve||(i.current=Re[ve],Re[ve]=null,ve--)}function Ee(i,l){ve++,Re[ve]=i.current,i.current=l}var Ie=V(null),ae=V(null),be=V(null),Te=V(null);function tt(i,l){switch(Ee(be,l),Ee(ae,i),Ee(Ie,null),l.nodeType){case 9:case 11:i=(i=l.documentElement)&&(i=i.namespaceURI)?ey(i):0;break;default:if(i=l.tagName,l=l.namespaceURI)l=ey(l),i=pl(l,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}ue(Ie),Ee(Ie,i)}function je(){ue(Ie),ue(ae),ue(be)}function Pe(i){i.memoizedState!==null&&Ee(Te,i);var l=Ie.current,p=pl(l,i.type);l!==p&&(Ee(ae,i),Ee(Ie,p))}function Be(i){ae.current===i&&(ue(Ie),ue(ae)),Te.current===i&&(ue(Te),An._currentValue=ze)}var Fe,Ge;function Oe(i){if(Fe===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);Fe=l&&l[1]||"",Ge=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fe+i+Ge}var mt=!1;function qe(i,l){if(!i||mt)return"";mt=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(l){var It=function(){throw Error()};if(Object.defineProperty(It.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(It,[])}catch(Ct){var ht=Ct}Reflect.construct(i,[],It)}else{try{It.call()}catch(Ct){ht=Ct}i.call(It.prototype)}}else{try{throw Error()}catch(Ct){ht=Ct}(It=i())&&typeof It.catch=="function"&&It.catch(function(){})}}catch(Ct){if(Ct&&ht&&typeof Ct.stack=="string")return[Ct.stack,ht.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=b.DetermineComponentFrameRoot(),q=P[0],ge=P[1];if(q&&ge){var Le=q.split(`
`),ct=ge.split(`
`);for(D=b=0;b<Le.length&&!Le[b].includes("DetermineComponentFrameRoot");)b++;for(;D<ct.length&&!ct[D].includes("DetermineComponentFrameRoot");)D++;if(b===Le.length||D===ct.length)for(b=Le.length-1,D=ct.length-1;1<=b&&0<=D&&Le[b]!==ct[D];)D--;for(;1<=b&&0<=D;b--,D--)if(Le[b]!==ct[D]){if(b!==1||D!==1)do if(b--,D--,0>D||Le[b]!==ct[D]){var Dt=`
`+Le[b].replace(" at new "," at ");return i.displayName&&Dt.includes("<anonymous>")&&(Dt=Dt.replace("<anonymous>",i.displayName)),Dt}while(1<=b&&0<=D);break}}}finally{mt=!1,Error.prepareStackTrace=p}return(p=i?i.displayName||i.name:"")?Oe(p):""}function Ae(i,l){switch(i.tag){case 26:case 27:case 5:return Oe(i.type);case 16:return Oe("Lazy");case 13:return i.child!==l&&l!==null?Oe("Suspense Fallback"):Oe("Suspense");case 19:return Oe("SuspenseList");case 0:case 15:return qe(i.type,!1);case 11:return qe(i.type.render,!1);case 1:return qe(i.type,!0);case 31:return Oe("Activity");default:return""}}function te(i){try{var l="",p=null;do l+=Ae(i,p),p=i,i=i.return;while(i);return l}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}var pe=Object.prototype.hasOwnProperty,J=t.unstable_scheduleCallback,fe=t.unstable_cancelCallback,xe=t.unstable_shouldYield,Ne=t.unstable_requestPaint,Me=t.unstable_now,Ve=t.unstable_getCurrentPriorityLevel,Qe=t.unstable_ImmediatePriority,rt=t.unstable_UserBlockingPriority,st=t.unstable_NormalPriority,it=t.unstable_LowPriority,xt=t.unstable_IdlePriority,pt=t.log,Yt=t.unstable_setDisableYieldValue,Kt=null,tn=null;function Wt(i){if(typeof pt=="function"&&Yt(i),tn&&typeof tn.setStrictMode=="function")try{tn.setStrictMode(Kt,i)}catch{}}var _t=Math.clz32?Math.clz32:qt,at=Math.log,Et=Math.LN2;function qt(i){return i>>>=0,i===0?32:31-(at(i)/Et|0)|0}var gn=256,Sn=262144,Zt=4194304;function Kn(i){var l=i&42;if(l!==0)return l;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function $t(i,l,p){var b=i.pendingLanes;if(b===0)return 0;var D=0,P=i.suspendedLanes,q=i.pingedLanes;i=i.warmLanes;var ge=b&134217727;return ge!==0?(b=ge&~P,b!==0?D=Kn(b):(q&=ge,q!==0?D=Kn(q):p||(p=ge&~i,p!==0&&(D=Kn(p))))):(ge=b&~P,ge!==0?D=Kn(ge):q!==0?D=Kn(q):p||(p=b&~i,p!==0&&(D=Kn(p)))),D===0?0:l!==0&&l!==D&&(l&P)===0&&(P=D&-D,p=l&-l,P>=p||P===32&&(p&4194048)!==0)?l:D}function Cr(i,l){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&l)===0}function tr(i,l){switch(i){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bt(){var i=Zt;return Zt<<=1,(Zt&62914560)===0&&(Zt=4194304),i}function gr(i){for(var l=[],p=0;31>p;p++)l.push(i);return l}function en(i,l){i.pendingLanes|=l,l!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function un(i,l,p,b,D,P){var q=i.pendingLanes;i.pendingLanes=p,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=p,i.entangledLanes&=p,i.errorRecoveryDisabledLanes&=p,i.shellSuspendCounter=0;var ge=i.entanglements,Le=i.expirationTimes,ct=i.hiddenUpdates;for(p=q&~p;0<p;){var Dt=31-_t(p),It=1<<Dt;ge[Dt]=0,Le[Dt]=-1;var ht=ct[Dt];if(ht!==null)for(ct[Dt]=null,Dt=0;Dt<ht.length;Dt++){var Ct=ht[Dt];Ct!==null&&(Ct.lane&=-536870913)}p&=~It}b!==0&&Yn(i,b,0),P!==0&&D===0&&i.tag!==0&&(i.suspendedLanes|=P&~(q&~l))}function Yn(i,l,p){i.pendingLanes|=l,i.suspendedLanes&=~l;var b=31-_t(l);i.entangledLanes|=l,i.entanglements[b]=i.entanglements[b]|1073741824|p&261930}function En(i,l){var p=i.entangledLanes|=l;for(i=i.entanglements;p;){var b=31-_t(p),D=1<<b;D&l|i[b]&l&&(i[b]|=l),p&=~D}}function fr(i,l){var p=l&-l;return p=(p&42)!==0?1:fo(p),(p&(i.suspendedLanes|l))!==0?0:p}function fo(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function xo(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Qn(){var i=ye.p;return i!==0?i:(i=window.event,i===void 0?32:Ue(i.type))}function Or(i,l){var p=ye.p;try{return ye.p=i,l()}finally{ye.p=p}}var Ko=Math.random().toString(36).slice(2),Rr="__reactFiber$"+Ko,Jn="__reactProps$"+Ko,aa="__reactContainer$"+Ko,qr="__reactEvents$"+Ko,ho="__reactListeners$"+Ko,ts="__reactHandles$"+Ko,Pt="__reactResources$"+Ko,Tt="__reactMarker$"+Ko;function Dn(i){delete i[Rr],delete i[Jn],delete i[qr],delete i[ho],delete i[ts]}function nr(i){var l=i[Rr];if(l)return l;for(var p=i.parentNode;p;){if(l=p[aa]||p[Rr]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(i=hx(i);i!==null;){if(p=i[Rr])return p;i=hx(i)}return l}i=p,p=i.parentNode}return null}function or(i){if(i=i[Rr]||i[aa]){var l=i.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return i}return null}function Ao(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i.stateNode;throw Error(a(33))}function kr(i){var l=i[Pt];return l||(l=i[Pt]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Zr(i){i[Tt]=!0}var Eo=new Set,da={};function bs(i,l){ar(i,l),ar(i+"Capture",l)}function ar(i,l){for(da[i]=l,i=0;i<l.length;i++)Eo.add(l[i])}var Fr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vs={},ke={};function Ke(i){return pe.call(ke,i)?!0:pe.call(Vs,i)?!1:Fr.test(i)?ke[i]=!0:(Vs[i]=!0,!1)}function cn(i,l,p){if(Ke(l))if(p===null)i.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":i.removeAttribute(l);return;case"boolean":var b=l.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){i.removeAttribute(l);return}}i.setAttribute(l,""+p)}}function $n(i,l,p){if(p===null)i.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttribute(l,""+p)}}function Zo(i,l,p,b){if(b===null)i.removeAttribute(p);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(p);return}i.setAttributeNS(l,p,""+b)}}function Ra(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function sr(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Gs(i,l,p){var b=Object.getOwnPropertyDescriptor(i.constructor.prototype,l);if(!i.hasOwnProperty(l)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var D=b.get,P=b.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return D.call(this)},set:function(q){p=""+q,P.call(this,q)}}),Object.defineProperty(i,l,{enumerable:b.enumerable}),{getValue:function(){return p},setValue:function(q){p=""+q},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function Rd(i){if(!i._valueTracker){var l=sr(i)?"checked":"value";i._valueTracker=Gs(i,l,""+i[l])}}function Ks(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var p=l.getValue(),b="";return i&&(b=sr(i)?i.checked?"true":"false":i.value),i=b,i!==p?(l.setValue(i),!0):!1}function Yf(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Sg=/[\n"\\]/g;function Sr(i){return i.replace(Sg,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function qf(i,l,p,b,D,P,q,ge){i.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?i.type=q:i.removeAttribute("type"),l!=null?q==="number"?(l===0&&i.value===""||i.value!=l)&&(i.value=""+Ra(l)):i.value!==""+Ra(l)&&(i.value=""+Ra(l)):q!=="submit"&&q!=="reset"||i.removeAttribute("value"),l!=null?co(i,q,Ra(l)):p!=null?co(i,q,Ra(p)):b!=null&&i.removeAttribute("value"),D==null&&P!=null&&(i.defaultChecked=!!P),D!=null&&(i.checked=D&&typeof D!="function"&&typeof D!="symbol"),ge!=null&&typeof ge!="function"&&typeof ge!="symbol"&&typeof ge!="boolean"?i.name=""+Ra(ge):i.removeAttribute("name")}function zb(i,l,p,b,D,P,q,ge){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(i.type=P),l!=null||p!=null){if(!(P!=="submit"&&P!=="reset"||l!=null)){Rd(i);return}p=p!=null?""+Ra(p):"",l=l!=null?""+Ra(l):p,ge||l===i.value||(i.value=l),i.defaultValue=l}b=b??D,b=typeof b!="function"&&typeof b!="symbol"&&!!b,i.checked=ge?i.checked:!!b,i.defaultChecked=!!b,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(i.name=q),Rd(i)}function co(i,l,p){l==="number"&&Yf(i.ownerDocument)===i||i.defaultValue===""+p||(i.defaultValue=""+p)}function Ou(i,l,p,b){if(i=i.options,l){l={};for(var D=0;D<p.length;D++)l["$"+p[D]]=!0;for(p=0;p<i.length;p++)D=l.hasOwnProperty("$"+i[p].value),i[p].selected!==D&&(i[p].selected=D),D&&b&&(i[p].defaultSelected=!0)}else{for(p=""+Ra(p),l=null,D=0;D<i.length;D++){if(i[D].value===p){i[D].selected=!0,b&&(i[D].defaultSelected=!0);return}l!==null||i[D].disabled||(l=i[D])}l!==null&&(l.selected=!0)}}function wg(i,l,p){if(l!=null&&(l=""+Ra(l),l!==i.value&&(i.value=l),p==null)){i.defaultValue!==l&&(i.defaultValue=l);return}i.defaultValue=p!=null?""+Ra(p):""}function Op(i,l,p,b){if(l==null){if(b!=null){if(p!=null)throw Error(a(92));if(Se(b)){if(1<b.length)throw Error(a(93));b=b[0]}p=b}p==null&&(p=""),l=p}p=Ra(l),i.defaultValue=p,b=i.textContent,b===p&&b!==""&&b!==null&&(i.value=b),Rd(i)}function Fu(i,l){if(l){var p=i.firstChild;if(p&&p===i.lastChild&&p.nodeType===3){p.nodeValue=l;return}}i.textContent=l}var Ub=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $b(i,l,p){var b=l.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?b?i.setProperty(l,""):l==="float"?i.cssFloat="":i[l]="":b?i.setProperty(l,p):typeof p!="number"||p===0||Ub.has(l)?l==="float"?i.cssFloat=p:i[l]=(""+p).trim():i[l]=p+"px"}function Bo(i,l,p){if(l!=null&&typeof l!="object")throw Error(a(62));if(i=i.style,p!=null){for(var b in p)!p.hasOwnProperty(b)||l!=null&&l.hasOwnProperty(b)||(b.indexOf("--")===0?i.setProperty(b,""):b==="float"?i.cssFloat="":i[b]="");for(var D in l)b=l[D],l.hasOwnProperty(D)&&p[D]!==b&&$b(i,D,b)}else for(var P in l)l.hasOwnProperty(P)&&$b(i,P,l[P])}function Qf(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Wb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Id(i){return Wb.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function _i(){}var Pd=null;function po(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ks=null,El=null;function Tg(i){var l=or(i);if(l&&(i=l.stateNode)){var p=i[Jn]||null;e:switch(i=l.stateNode,l.type){case"input":if(qf(i,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),l=p.name,p.type==="radio"&&l!=null){for(p=i;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Sr(""+l)+'"][type="radio"]'),l=0;l<p.length;l++){var b=p[l];if(b!==i&&b.form===i.form){var D=b[Jn]||null;if(!D)throw Error(a(90));qf(b,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(l=0;l<p.length;l++)b=p[l],b.form===i.form&&Ks(b)}break e;case"textarea":wg(i,p.value,p.defaultValue);break e;case"select":l=p.value,l!=null&&Ou(i,!!p.multiple,l,!1)}}}var Ag=!1;function Vb(i,l,p){if(Ag)return i(l,p);Ag=!0;try{var b=i(l);return b}finally{if(Ag=!1,(ks!==null||El!==null)&&(Y0(),ks&&(l=ks,i=El,El=ks=null,Tg(l),i)))for(l=0;l<i.length;l++)Tg(i[l])}}function Xf(i,l){var p=i.stateNode;if(p===null)return null;var b=p[Jn]||null;if(b===null)return null;p=b[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(i=i.type,b=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!b;break e;default:i=!1}if(i)return null;if(p&&typeof p!="function")throw Error(a(231,l,typeof p));return p}var kl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fp=!1;if(kl)try{var va={};Object.defineProperty(va,"passive",{get:function(){Fp=!0}}),window.addEventListener("test",va,va),window.removeEventListener("test",va,va)}catch{Fp=!1}var Oi=null,mn=null,Md=null;function Np(){if(Md)return Md;var i,l=mn,p=l.length,b,D="value"in Oi?Oi.value:Oi.textContent,P=D.length;for(i=0;i<p&&l[i]===D[i];i++);var q=p-i;for(b=1;b<=q&&l[p-b]===D[P-b];b++);return Md=D.slice(i,1<b?1-b:void 0)}function Uc(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function fa(){return!0}function $c(){return!1}function zo(i){function l(p,b,D,P,q){this._reactName=p,this._targetInst=D,this.type=b,this.nativeEvent=P,this.target=q,this.currentTarget=null;for(var ge in i)i.hasOwnProperty(ge)&&(p=i[ge],this[ge]=p?p(P):P[ge]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?fa:$c,this.isPropagationStopped=$c,this}return A(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=fa)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=fa)},persist:function(){},isPersistent:fa}),l}var Hc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jf=zo(Hc),_d=A({},Hc,{view:0,detail:0}),Gb=zo(_d),jp,Lp,Od,Zf=A({},_d,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mg,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Od&&(Od&&i.type==="mousemove"?(jp=i.screenX-Od.screenX,Lp=i.screenY-Od.screenY):Lp=jp=0,Od=i),jp)},movementY:function(i){return"movementY"in i?i.movementY:Lp}}),Eg=zo(Zf),Kb=A({},Zf,{dataTransfer:0}),Yb=zo(Kb),Bp=A({},_d,{relatedTarget:0}),zp=zo(Bp),Fd=A({},Hc,{animationName:0,elapsedTime:0,pseudoElement:0}),kg=zo(Fd),Dg=A({},Hc,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Rg=zo(Dg),Ig=A({},Hc,{data:0}),Up=zo(Ig),$p={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oc(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=Nd[i])?!!l[i]:!1}function Mg(){return oc}var ns=A({},_d,{key:function(i){if(i.key){var l=$p[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=Uc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Pg[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mg,charCode:function(i){return i.type==="keypress"?Uc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Uc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Nu=zo(ns),AS=A({},Zf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jd=zo(AS),ES=A({},_d,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mg}),kS=zo(ES),DS=A({},Hc,{propertyName:0,elapsedTime:0,pseudoElement:0}),RS=zo(DS),qb=A({},Zf,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ds=zo(qb),vs=A({},Hc,{newState:0,oldState:0}),Mt=zo(vs),ac=[9,13,27,32],xs=kl&&"CompositionEvent"in window,Ut=null;kl&&"documentMode"in document&&(Ut=document.documentMode);var eh=kl&&"TextEvent"in window&&!Ut,_g=kl&&(!xs||Ut&&8<Ut&&11>=Ut),Ld=" ",Hp=!1;function Wp(i,l){switch(i){case"keyup":return ac.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sa(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Wc=!1;function Yo(i,l){switch(i){case"compositionend":return sa(l);case"keypress":return l.which!==32?null:(Hp=!0,Ld);case"textInput":return i=l.data,i===Ld&&Hp?null:i;default:return null}}function ia(i,l){if(Wc)return i==="compositionend"||!xs&&Wp(i,l)?(i=Np(),Md=mn=Oi=null,Wc=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return _g&&l.locale!=="ko"?null:l.data;default:return null}}var yr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cs(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!yr[i.type]:l==="textarea"}function Tr(i,l,p,b){ks?El?El.push(b):El=[b]:ks=b,l=Wh(l,"onChange"),0<l.length&&(p=new Jf("onChange","change",null,p,b),i.push({event:p,listeners:l}))}var Ir=null,th=null;function Dl(i){cx(i,0)}function rl(i){var l=Ao(i);if(Ks(l))return i}function Og(i,l){if(i==="change")return l}var ju=!1;if(kl){var ii;if(kl){var rs="oninput"in document;if(!rs){var Wa=document.createElement("div");Wa.setAttribute("oninput","return;"),rs=typeof Wa.oninput=="function"}ii=rs}else ii=!1;ju=ii&&(!document.documentMode||9<document.documentMode)}function Vp(){Ir&&(Ir.detachEvent("onpropertychange",Qb),th=Ir=null)}function Qb(i){if(i.propertyName==="value"&&rl(th)){var l=[];Tr(l,th,i,po(i)),Vb(Dl,l)}}function IS(i,l,p){i==="focusin"?(Vp(),Ir=l,th=p,Ir.attachEvent("onpropertychange",Qb)):i==="focusout"&&Vp()}function Fi(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return rl(th)}function Lu(i,l){if(i==="click")return rl(l)}function Bu(i,l){if(i==="input"||i==="change")return rl(l)}function zu(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var li=typeof Object.is=="function"?Object.is:zu;function Bd(i,l){if(li(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var p=Object.keys(i),b=Object.keys(l);if(p.length!==b.length)return!1;for(b=0;b<p.length;b++){var D=p[b];if(!pe.call(l,D)||!li(i[D],l[D]))return!1}return!0}function Gp(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function nh(i,l){var p=Gp(i);i=0;for(var b;p;){if(p.nodeType===3){if(b=i+p.textContent.length,i<=l&&b>=l)return{node:p,offset:l-i};i=b}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Gp(p)}}function Xb(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?Xb(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function Kp(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var l=Yf(i.document);l instanceof i.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)i=l.contentWindow;else break;l=Yf(i.document)}return l}function rh(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}var Fg=kl&&"documentMode"in document&&11>=document.documentMode,Uu=null,Yp=null,ol=null,Vc=!1;function fs(i,l,p){var b=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Vc||Uu==null||Uu!==Yf(b)||(b=Uu,"selectionStart"in b&&rh(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),ol&&Bd(ol,b)||(ol=b,b=Wh(Yp,"onSelect"),0<b.length&&(l=new Jf("onSelect","select",null,l,p),i.push({event:l,listeners:b}),l.target=Uu)))}function Ni(i,l){var p={};return p[i.toLowerCase()]=l.toLowerCase(),p["Webkit"+i]="webkit"+l,p["Moz"+i]="moz"+l,p}var sc={animationend:Ni("Animation","AnimationEnd"),animationiteration:Ni("Animation","AnimationIteration"),animationstart:Ni("Animation","AnimationStart"),transitionrun:Ni("Transition","TransitionRun"),transitionstart:Ni("Transition","TransitionStart"),transitioncancel:Ni("Transition","TransitionCancel"),transitionend:Ni("Transition","TransitionEnd")},qp={},Qp={};kl&&(Qp=document.createElement("div").style,"AnimationEvent"in window||(delete sc.animationend.animation,delete sc.animationiteration.animation,delete sc.animationstart.animation),"TransitionEvent"in window||delete sc.transitionend.transition);function Ia(i){if(qp[i])return qp[i];if(!sc[i])return i;var l=sc[i],p;for(p in l)if(l.hasOwnProperty(p)&&p in Qp)return qp[i]=l[p];return i}var Ng=Ia("animationend"),jg=Ia("animationiteration"),Jb=Ia("animationstart"),Lg=Ia("transitionrun"),Bg=Ia("transitionstart"),Zb=Ia("transitioncancel"),ev=Ia("transitionend"),zd=new Map,al="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");al.push("scrollEnd");function ji(i,l){zd.set(i,l),bs(l,[i])}var Ud=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ds=[],Gc=0,Xp=0;function wr(){for(var i=Gc,l=Xp=Gc=0;l<i;){var p=Ds[l];Ds[l++]=null;var b=Ds[l];Ds[l++]=null;var D=Ds[l];Ds[l++]=null;var P=Ds[l];if(Ds[l++]=null,b!==null&&D!==null){var q=b.pending;q===null?D.next=D:(D.next=q.next,q.next=D),b.pending=D}P!==0&&mo(p,D,P)}}function Kc(i,l,p,b){Ds[Gc++]=i,Ds[Gc++]=l,Ds[Gc++]=p,Ds[Gc++]=b,Xp|=b,i.lanes|=b,i=i.alternate,i!==null&&(i.lanes|=b)}function $u(i,l,p,b){return Kc(i,l,p,b),Jp(i)}function Li(i,l){return Kc(i,null,null,l),Jp(i)}function mo(i,l,p){i.lanes|=p;var b=i.alternate;b!==null&&(b.lanes|=p);for(var D=!1,P=i.return;P!==null;)P.childLanes|=p,b=P.alternate,b!==null&&(b.childLanes|=p),P.tag===22&&(i=P.stateNode,i===null||i._visibility&1||(D=!0)),i=P,P=P.return;return i.tag===3?(P=i.stateNode,D&&l!==null&&(D=31-_t(p),i=P.hiddenUpdates,b=i[D],b===null?i[D]=[l]:b.push(l),l.lane=p|536870912),P):null}function Jp(i){if(50<Nh)throw Nh=0,jh=null,Error(a(185));for(var l=i.return;l!==null;)i=l,l=i.return;return i.tag===3?i.stateNode:null}var Hu={};function tv(i,l,p,b){this.tag=i,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ea(i,l,p,b){return new tv(i,l,p,b)}function zg(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Rl(i,l){var p=i.alternate;return p===null?(p=ea(i.tag,l,i.key,i.mode),p.elementType=i.elementType,p.type=i.type,p.stateNode=i.stateNode,p.alternate=i,i.alternate=p):(p.pendingProps=l,p.type=i.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=i.flags&65011712,p.childLanes=i.childLanes,p.lanes=i.lanes,p.child=i.child,p.memoizedProps=i.memoizedProps,p.memoizedState=i.memoizedState,p.updateQueue=i.updateQueue,l=i.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=i.sibling,p.index=i.index,p.ref=i.ref,p.refCleanup=i.refCleanup,p}function Zp(i,l){i.flags&=65011714;var p=i.alternate;return p===null?(i.childLanes=0,i.lanes=l,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=p.childLanes,i.lanes=p.lanes,i.child=p.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=p.memoizedProps,i.memoizedState=p.memoizedState,i.updateQueue=p.updateQueue,i.type=p.type,l=p.dependencies,i.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),i}function oh(i,l,p,b,D,P){var q=0;if(b=i,typeof i=="function")zg(i)&&(q=1);else if(typeof i=="string")q=wn(i,p,Ie.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case de:return i=ea(31,p,l,D),i.elementType=de,i.lanes=P,i;case F:return ci(p.children,D,P,l);case O:q=8,D|=24;break;case j:return i=ea(12,p,l,D|2),i.elementType=j,i.lanes=P,i;case W:return i=ea(13,p,l,D),i.elementType=W,i.lanes=P,i;case X:return i=ea(19,p,l,D),i.elementType=X,i.lanes=P,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case H:q=10;break e;case U:q=9;break e;case K:q=11;break e;case ee:q=14;break e;case ie:q=16,b=null;break e}q=29,p=Error(a(130,i===null?"null":typeof i,"")),b=null}return l=ea(q,p,l,D),l.elementType=i,l.type=b,l.lanes=P,l}function ci(i,l,p,b){return i=ea(7,i,b,l),i.lanes=p,i}function e0(i,l,p){return i=ea(6,i,null,l),i.lanes=p,i}function Ug(i){var l=ea(18,null,null,0);return l.stateNode=i,l}function t0(i,l,p){return l=ea(4,i.children!==null?i.children:[],i.key,l),l.lanes=p,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}var nv=new WeakMap;function ui(i,l){if(typeof i=="object"&&i!==null){var p=nv.get(i);return p!==void 0?p:(l={value:i,source:l,stack:te(l)},nv.set(i,l),l)}return{value:i,source:l,stack:te(l)}}var Wu=[],Yc=0,$d=null,Hd=0,di=[],fi=0,ic=null,Il=1,sl="";function Pl(i,l){Wu[Yc++]=Hd,Wu[Yc++]=$d,$d=i,Hd=l}function ah(i,l,p){di[fi++]=Il,di[fi++]=sl,di[fi++]=ic,ic=i;var b=Il;i=sl;var D=32-_t(b)-1;b&=~(1<<D),p+=1;var P=32-_t(l)+D;if(30<P){var q=D-D%5;P=(b&(1<<q)-1).toString(32),b>>=q,D-=q,Il=1<<32-_t(l)+D|p<<D|b,sl=P+i}else Il=1<<P|p<<D|b,sl=i}function n0(i){i.return!==null&&(Pl(i,1),ah(i,1,0))}function r0(i){for(;i===$d;)$d=Wu[--Yc],Wu[Yc]=null,Hd=Wu[--Yc],Wu[Yc]=null;for(;i===ic;)ic=di[--fi],di[fi]=null,sl=di[--fi],di[fi]=null,Il=di[--fi],di[fi]=null}function $g(i,l){di[fi++]=Il,di[fi++]=sl,di[fi++]=ic,Il=l.id,sl=l.overflow,ic=i}var os=null,Uo=null,Gr=!1,Rs=null,ao=!1,hs=Error(a(519));function _o(i){var l=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw cc(ui(l,i)),hs}function hi(i){var l=i.stateNode,p=i.type,b=i.memoizedProps;switch(l[Rr]=i,l[Jn]=b,p){case"dialog":cr("cancel",l),cr("close",l);break;case"iframe":case"object":case"embed":cr("load",l);break;case"video":case"audio":for(p=0;p<fd.length;p++)cr(fd[p],l);break;case"source":cr("error",l);break;case"img":case"image":case"link":cr("error",l),cr("load",l);break;case"details":cr("toggle",l);break;case"input":cr("invalid",l),zb(l,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0);break;case"select":cr("invalid",l);break;case"textarea":cr("invalid",l),Op(l,b.value,b.defaultValue,b.children)}p=b.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||l.textContent===""+p||b.suppressHydrationWarning===!0||q1(l.textContent,p)?(b.popover!=null&&(cr("beforetoggle",l),cr("toggle",l)),b.onScroll!=null&&cr("scroll",l),b.onScrollEnd!=null&&cr("scrollend",l),b.onClick!=null&&(l.onclick=_i),l=!0):l=!1,l||_o(i,!0)}function Hg(i){for(os=i.return;os;)switch(os.tag){case 5:case 31:case 13:ao=!1;return;case 27:case 3:ao=!0;return;default:os=os.return}}function Vu(i){if(i!==os)return!1;if(!Gr)return Hg(i),Gr=!0,!1;var l=i.tag,p;if((p=l!==3&&l!==27)&&((p=l===5)&&(p=i.type,p=!(p!=="form"&&p!=="button")||vf(i.type,i.memoizedProps)),p=!p),p&&Uo&&_o(i),Hg(i),l===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Uo=Yr(i)}else if(l===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Uo=Yr(i)}else l===27?(l=Uo,Dc(i.type)?(i=uu,uu=null,Uo=i):Uo=l):Uo=os?xi(i.stateNode.nextSibling):null;return!0}function il(){Uo=os=null,Gr=!1}function lc(){var i=Rs;return i!==null&&(qs===null?qs=i:qs.push.apply(qs,i),Rs=null),i}function cc(i){Rs===null?Rs=[i]:Rs.push(i)}var uc=V(null),qc=null,dc=null;function ll(i,l,p){Ee(uc,l._currentValue),l._currentValue=p}function Ml(i){i._currentValue=uc.current,ue(uc)}function o0(i,l,p){for(;i!==null;){var b=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,b!==null&&(b.childLanes|=l)):b!==null&&(b.childLanes&l)!==l&&(b.childLanes|=l),i===p)break;i=i.return}}function a0(i,l,p,b){var D=i.child;for(D!==null&&(D.return=i);D!==null;){var P=D.dependencies;if(P!==null){var q=D.child;P=P.firstContext;e:for(;P!==null;){var ge=P;P=D;for(var Le=0;Le<l.length;Le++)if(ge.context===l[Le]){P.lanes|=p,ge=P.alternate,ge!==null&&(ge.lanes|=p),o0(P.return,p,i),b||(q=null);break e}P=ge.next}}else if(D.tag===18){if(q=D.return,q===null)throw Error(a(341));q.lanes|=p,P=q.alternate,P!==null&&(P.lanes|=p),o0(q,p,i),q=null}else q=D.child;if(q!==null)q.return=D;else for(q=D;q!==null;){if(q===i){q=null;break}if(D=q.sibling,D!==null){D.return=q.return,q=D;break}q=q.return}D=q}}function Is(i,l,p,b){i=null;for(var D=l,P=!1;D!==null;){if(!P){if((D.flags&524288)!==0)P=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var q=D.alternate;if(q===null)throw Error(a(387));if(q=q.memoizedProps,q!==null){var ge=D.type;li(D.pendingProps.value,q.value)||(i!==null?i.push(ge):i=[ge])}}else if(D===Te.current){if(q=D.alternate,q===null)throw Error(a(387));q.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(i!==null?i.push(An):i=[An])}D=D.return}i!==null&&a0(l,i,p,b),l.flags|=262144}function _l(i){for(i=i.firstContext;i!==null;){if(!li(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Qc(i){qc=i,dc=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Pa(i){return Wg(qc,i)}function sh(i,l){return qc===null&&Qc(i),Wg(i,l)}function Wg(i,l){var p=l._currentValue;if(l={context:l,memoizedValue:p,next:null},dc===null){if(i===null)throw Error(a(308));dc=l,i.dependencies={lanes:0,firstContext:l},i.flags|=524288}else dc=dc.next=l;return p}var PS=typeof AbortController<"u"?AbortController:function(){var i=[],l=this.signal={aborted:!1,addEventListener:function(p,b){i.push(b)}};this.abort=function(){l.aborted=!0,i.forEach(function(p){return p()})}},rv=t.unstable_scheduleCallback,Ss=t.unstable_NormalPriority,Ma={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wd(){return{controller:new PS,data:new Map,refCount:0}}function Gu(i){i.refCount--,i.refCount===0&&rv(Ss,function(){i.controller.abort()})}var ih=null,s0=0,Ku=0,Yu=null;function ov(i,l){if(ih===null){var p=ih=[];s0=0,Ku=Br(),Yu={status:"pending",value:void 0,then:function(b){p.push(b)}}}return s0++,l.then(Vg,Vg),l}function Vg(){if(--s0===0&&ih!==null){Yu!==null&&(Yu.status="fulfilled");var i=ih;ih=null,Ku=0,Yu=null;for(var l=0;l<i.length;l++)(0,i[l])()}}function av(i,l){var p=[],b={status:"pending",value:null,reason:null,then:function(D){p.push(D)}};return i.then(function(){b.status="fulfilled",b.value=l;for(var D=0;D<p.length;D++)(0,p[D])(l)},function(D){for(b.status="rejected",b.reason=D,D=0;D<p.length;D++)(0,p[D])(void 0)}),b}var sv=se.S;se.S=function(i,l){Gv=Me(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&ov(i,l),sv!==null&&sv(i,l)};var Xc=V(null);function i0(){var i=Xc.current;return i!==null?i:Oo.pooledCache}function lh(i,l){l===null?Ee(Xc,Xc.current):Ee(Xc,l.pool)}function iv(){var i=i0();return i===null?null:{parent:Ma._currentValue,pool:i}}var Vd=Error(a(460)),l0=Error(a(474)),c0=Error(a(542)),u0={then:function(){}};function Gg(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Kg(i,l,p){switch(p=i[p],p===void 0?i.push(l):p!==l&&(l.then(_i,_i),l=p),l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,Yg(i),i;default:if(typeof l.status=="string")l.then(_i,_i);else{if(i=Oo,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=l,i.status="pending",i.then(function(b){if(l.status==="pending"){var D=l;D.status="fulfilled",D.value=b}},function(b){if(l.status==="pending"){var D=l;D.status="rejected",D.reason=b}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,Yg(i),i}throw qu=l,Vd}}function Ol(i){try{var l=i._init;return l(i._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(qu=p,Vd):p}}var qu=null;function d0(){if(qu===null)throw Error(a(459));var i=qu;return qu=null,i}function Yg(i){if(i===Vd||i===c0)throw Error(a(483))}var fc=null,Gd=0;function ch(i){var l=Gd;return Gd+=1,fc===null&&(fc=[]),Kg(fc,i,l)}function Kd(i,l){l=l.props.ref,i.ref=l!==void 0?l:null}function uh(i,l){throw l.$$typeof===R?Error(a(525)):(i=Object.prototype.toString.call(l),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i)))}function dh(i){function l(lt,Ze){if(i){var gt=lt.deletions;gt===null?(lt.deletions=[Ze],lt.flags|=16):gt.push(Ze)}}function p(lt,Ze){if(!i)return null;for(;Ze!==null;)l(lt,Ze),Ze=Ze.sibling;return null}function b(lt){for(var Ze=new Map;lt!==null;)lt.key!==null?Ze.set(lt.key,lt):Ze.set(lt.index,lt),lt=lt.sibling;return Ze}function D(lt,Ze){return lt=Rl(lt,Ze),lt.index=0,lt.sibling=null,lt}function P(lt,Ze,gt){return lt.index=gt,i?(gt=lt.alternate,gt!==null?(gt=gt.index,gt<Ze?(lt.flags|=67108866,Ze):gt):(lt.flags|=67108866,Ze)):(lt.flags|=1048576,Ze)}function q(lt){return i&&lt.alternate===null&&(lt.flags|=67108866),lt}function ge(lt,Ze,gt,Lt){return Ze===null||Ze.tag!==6?(Ze=e0(gt,lt.mode,Lt),Ze.return=lt,Ze):(Ze=D(Ze,gt),Ze.return=lt,Ze)}function Le(lt,Ze,gt,Lt){var ur=gt.type;return ur===F?Dt(lt,Ze,gt.props.children,Lt,gt.key):Ze!==null&&(Ze.elementType===ur||typeof ur=="object"&&ur!==null&&ur.$$typeof===ie&&Ol(ur)===Ze.type)?(Ze=D(Ze,gt.props),Kd(Ze,gt),Ze.return=lt,Ze):(Ze=oh(gt.type,gt.key,gt.props,null,lt.mode,Lt),Kd(Ze,gt),Ze.return=lt,Ze)}function ct(lt,Ze,gt,Lt){return Ze===null||Ze.tag!==4||Ze.stateNode.containerInfo!==gt.containerInfo||Ze.stateNode.implementation!==gt.implementation?(Ze=t0(gt,lt.mode,Lt),Ze.return=lt,Ze):(Ze=D(Ze,gt.children||[]),Ze.return=lt,Ze)}function Dt(lt,Ze,gt,Lt,ur){return Ze===null||Ze.tag!==7?(Ze=ci(gt,lt.mode,Lt,ur),Ze.return=lt,Ze):(Ze=D(Ze,gt),Ze.return=lt,Ze)}function It(lt,Ze,gt){if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return Ze=e0(""+Ze,lt.mode,gt),Ze.return=lt,Ze;if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case I:return gt=oh(Ze.type,Ze.key,Ze.props,null,lt.mode,gt),Kd(gt,Ze),gt.return=lt,gt;case M:return Ze=t0(Ze,lt.mode,gt),Ze.return=lt,Ze;case ie:return Ze=Ol(Ze),It(lt,Ze,gt)}if(Se(Ze)||N(Ze))return Ze=ci(Ze,lt.mode,gt,null),Ze.return=lt,Ze;if(typeof Ze.then=="function")return It(lt,ch(Ze),gt);if(Ze.$$typeof===H)return It(lt,sh(lt,Ze),gt);uh(lt,Ze)}return null}function ht(lt,Ze,gt,Lt){var ur=Ze!==null?Ze.key:null;if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return ur!==null?null:ge(lt,Ze,""+gt,Lt);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case I:return gt.key===ur?Le(lt,Ze,gt,Lt):null;case M:return gt.key===ur?ct(lt,Ze,gt,Lt):null;case ie:return gt=Ol(gt),ht(lt,Ze,gt,Lt)}if(Se(gt)||N(gt))return ur!==null?null:Dt(lt,Ze,gt,Lt,null);if(typeof gt.then=="function")return ht(lt,Ze,ch(gt),Lt);if(gt.$$typeof===H)return ht(lt,Ze,sh(lt,gt),Lt);uh(lt,gt)}return null}function Ct(lt,Ze,gt,Lt,ur){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number"||typeof Lt=="bigint")return lt=lt.get(gt)||null,ge(Ze,lt,""+Lt,ur);if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case I:return lt=lt.get(Lt.key===null?gt:Lt.key)||null,Le(Ze,lt,Lt,ur);case M:return lt=lt.get(Lt.key===null?gt:Lt.key)||null,ct(Ze,lt,Lt,ur);case ie:return Lt=Ol(Lt),Ct(lt,Ze,gt,Lt,ur)}if(Se(Lt)||N(Lt))return lt=lt.get(gt)||null,Dt(Ze,lt,Lt,ur,null);if(typeof Lt.then=="function")return Ct(lt,Ze,gt,ch(Lt),ur);if(Lt.$$typeof===H)return Ct(lt,Ze,gt,sh(Ze,Lt),ur);uh(Ze,Lt)}return null}function Bn(lt,Ze,gt,Lt){for(var ur=null,yo=null,Zn=Ze,Lr=Ze=0,to=null;Zn!==null&&Lr<gt.length;Lr++){Zn.index>Lr?(to=Zn,Zn=null):to=Zn.sibling;var bo=ht(lt,Zn,gt[Lr],Lt);if(bo===null){Zn===null&&(Zn=to);break}i&&Zn&&bo.alternate===null&&l(lt,Zn),Ze=P(bo,Ze,Lr),yo===null?ur=bo:yo.sibling=bo,yo=bo,Zn=to}if(Lr===gt.length)return p(lt,Zn),Gr&&Pl(lt,Lr),ur;if(Zn===null){for(;Lr<gt.length;Lr++)Zn=It(lt,gt[Lr],Lt),Zn!==null&&(Ze=P(Zn,Ze,Lr),yo===null?ur=Zn:yo.sibling=Zn,yo=Zn);return Gr&&Pl(lt,Lr),ur}for(Zn=b(Zn);Lr<gt.length;Lr++)to=Ct(Zn,lt,Lr,gt[Lr],Lt),to!==null&&(i&&to.alternate!==null&&Zn.delete(to.key===null?Lr:to.key),Ze=P(to,Ze,Lr),yo===null?ur=to:yo.sibling=to,yo=to);return i&&Zn.forEach(function(Cf){return l(lt,Cf)}),Gr&&Pl(lt,Lr),ur}function mr(lt,Ze,gt,Lt){if(gt==null)throw Error(a(151));for(var ur=null,yo=null,Zn=Ze,Lr=Ze=0,to=null,bo=gt.next();Zn!==null&&!bo.done;Lr++,bo=gt.next()){Zn.index>Lr?(to=Zn,Zn=null):to=Zn.sibling;var Cf=ht(lt,Zn,bo.value,Lt);if(Cf===null){Zn===null&&(Zn=to);break}i&&Zn&&Cf.alternate===null&&l(lt,Zn),Ze=P(Cf,Ze,Lr),yo===null?ur=Cf:yo.sibling=Cf,yo=Cf,Zn=to}if(bo.done)return p(lt,Zn),Gr&&Pl(lt,Lr),ur;if(Zn===null){for(;!bo.done;Lr++,bo=gt.next())bo=It(lt,bo.value,Lt),bo!==null&&(Ze=P(bo,Ze,Lr),yo===null?ur=bo:yo.sibling=bo,yo=bo);return Gr&&Pl(lt,Lr),ur}for(Zn=b(Zn);!bo.done;Lr++,bo=gt.next())bo=Ct(Zn,lt,Lr,bo.value,Lt),bo!==null&&(i&&bo.alternate!==null&&Zn.delete(bo.key===null?Lr:bo.key),Ze=P(bo,Ze,Lr),yo===null?ur=bo:yo.sibling=bo,yo=bo);return i&&Zn.forEach(function(kO){return l(lt,kO)}),Gr&&Pl(lt,Lr),ur}function $o(lt,Ze,gt,Lt){if(typeof gt=="object"&&gt!==null&&gt.type===F&&gt.key===null&&(gt=gt.props.children),typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case I:e:{for(var ur=gt.key;Ze!==null;){if(Ze.key===ur){if(ur=gt.type,ur===F){if(Ze.tag===7){p(lt,Ze.sibling),Lt=D(Ze,gt.props.children),Lt.return=lt,lt=Lt;break e}}else if(Ze.elementType===ur||typeof ur=="object"&&ur!==null&&ur.$$typeof===ie&&Ol(ur)===Ze.type){p(lt,Ze.sibling),Lt=D(Ze,gt.props),Kd(Lt,gt),Lt.return=lt,lt=Lt;break e}p(lt,Ze);break}else l(lt,Ze);Ze=Ze.sibling}gt.type===F?(Lt=ci(gt.props.children,lt.mode,Lt,gt.key),Lt.return=lt,lt=Lt):(Lt=oh(gt.type,gt.key,gt.props,null,lt.mode,Lt),Kd(Lt,gt),Lt.return=lt,lt=Lt)}return q(lt);case M:e:{for(ur=gt.key;Ze!==null;){if(Ze.key===ur)if(Ze.tag===4&&Ze.stateNode.containerInfo===gt.containerInfo&&Ze.stateNode.implementation===gt.implementation){p(lt,Ze.sibling),Lt=D(Ze,gt.children||[]),Lt.return=lt,lt=Lt;break e}else{p(lt,Ze);break}else l(lt,Ze);Ze=Ze.sibling}Lt=t0(gt,lt.mode,Lt),Lt.return=lt,lt=Lt}return q(lt);case ie:return gt=Ol(gt),$o(lt,Ze,gt,Lt)}if(Se(gt))return Bn(lt,Ze,gt,Lt);if(N(gt)){if(ur=N(gt),typeof ur!="function")throw Error(a(150));return gt=ur.call(gt),mr(lt,Ze,gt,Lt)}if(typeof gt.then=="function")return $o(lt,Ze,ch(gt),Lt);if(gt.$$typeof===H)return $o(lt,Ze,sh(lt,gt),Lt);uh(lt,gt)}return typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint"?(gt=""+gt,Ze!==null&&Ze.tag===6?(p(lt,Ze.sibling),Lt=D(Ze,gt),Lt.return=lt,lt=Lt):(p(lt,Ze),Lt=e0(gt,lt.mode,Lt),Lt.return=lt,lt=Lt),q(lt)):p(lt,Ze)}return function(lt,Ze,gt,Lt){try{Gd=0;var ur=$o(lt,Ze,gt,Lt);return fc=null,ur}catch(Zn){if(Zn===Vd||Zn===c0)throw Zn;var yo=ea(29,Zn,null,lt.mode);return yo.lanes=Lt,yo.return=lt,yo}finally{}}}var Jc=dh(!0),qg=dh(!1),cl=!1;function f0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yd(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ps(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function hc(i,l,p){var b=i.updateQueue;if(b===null)return null;if(b=b.shared,(uo&2)!==0){var D=b.pending;return D===null?l.next=l:(l.next=D.next,D.next=l),b.pending=l,l=Jp(i),mo(i,null,p),l}return Kc(i,b,l,p),Jp(i)}function Qu(i,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194048)!==0)){var b=l.lanes;b&=i.pendingLanes,p|=b,l.lanes=p,En(i,p)}}function h0(i,l){var p=i.updateQueue,b=i.alternate;if(b!==null&&(b=b.updateQueue,p===b)){var D=null,P=null;if(p=p.firstBaseUpdate,p!==null){do{var q={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};P===null?D=P=q:P=P.next=q,p=p.next}while(p!==null);P===null?D=P=l:P=P.next=l}else D=P=l;p={baseState:b.baseState,firstBaseUpdate:D,lastBaseUpdate:P,shared:b.shared,callbacks:b.callbacks},i.updateQueue=p;return}i=p.lastBaseUpdate,i===null?p.firstBaseUpdate=l:i.next=l,p.lastBaseUpdate=l}var p0=!1;function qd(){if(p0){var i=Yu;if(i!==null)throw i}}function Xu(i,l,p,b){p0=!1;var D=i.updateQueue;cl=!1;var P=D.firstBaseUpdate,q=D.lastBaseUpdate,ge=D.shared.pending;if(ge!==null){D.shared.pending=null;var Le=ge,ct=Le.next;Le.next=null,q===null?P=ct:q.next=ct,q=Le;var Dt=i.alternate;Dt!==null&&(Dt=Dt.updateQueue,ge=Dt.lastBaseUpdate,ge!==q&&(ge===null?Dt.firstBaseUpdate=ct:ge.next=ct,Dt.lastBaseUpdate=Le))}if(P!==null){var It=D.baseState;q=0,Dt=ct=Le=null,ge=P;do{var ht=ge.lane&-536870913,Ct=ht!==ge.lane;if(Ct?(Kr&ht)===ht:(b&ht)===ht){ht!==0&&ht===Ku&&(p0=!0),Dt!==null&&(Dt=Dt.next={lane:0,tag:ge.tag,payload:ge.payload,callback:null,next:null});e:{var Bn=i,mr=ge;ht=l;var $o=p;switch(mr.tag){case 1:if(Bn=mr.payload,typeof Bn=="function"){It=Bn.call($o,It,ht);break e}It=Bn;break e;case 3:Bn.flags=Bn.flags&-65537|128;case 0:if(Bn=mr.payload,ht=typeof Bn=="function"?Bn.call($o,It,ht):Bn,ht==null)break e;It=A({},It,ht);break e;case 2:cl=!0}}ht=ge.callback,ht!==null&&(i.flags|=64,Ct&&(i.flags|=8192),Ct=D.callbacks,Ct===null?D.callbacks=[ht]:Ct.push(ht))}else Ct={lane:ht,tag:ge.tag,payload:ge.payload,callback:ge.callback,next:null},Dt===null?(ct=Dt=Ct,Le=It):Dt=Dt.next=Ct,q|=ht;if(ge=ge.next,ge===null){if(ge=D.shared.pending,ge===null)break;Ct=ge,ge=Ct.next,Ct.next=null,D.lastBaseUpdate=Ct,D.shared.pending=null}}while(!0);Dt===null&&(Le=It),D.baseState=Le,D.firstBaseUpdate=ct,D.lastBaseUpdate=Dt,P===null&&(D.shared.lanes=0),Tc|=q,i.lanes=q,i.memoizedState=It}}function Qg(i,l){if(typeof i!="function")throw Error(a(191,i));i.call(l)}function m0(i,l){var p=i.callbacks;if(p!==null)for(i.callbacks=null,i=0;i<p.length;i++)Qg(p[i],l)}var pc=V(null),mc=V(0);function Xg(i,l){i=wc,Ee(mc,i),Ee(pc,l),wc=i|l.baseLanes}function g0(){Ee(mc,wc),Ee(pc,pc.current)}function Jg(){wc=mc.current,ue(pc),ue(mc)}var pi=V(null),mi=null;function ul(i){var l=i.alternate;Ee(ha,ha.current&1),Ee(pi,i),mi===null&&(l===null||pc.current!==null||l.memoizedState!==null)&&(mi=i)}function fh(i){Ee(ha,ha.current),Ee(pi,i),mi===null&&(mi=i)}function y0(i){i.tag===22?(Ee(ha,ha.current),Ee(pi,i),mi===null&&(mi=i)):gc()}function gc(){Ee(ha,ha.current),Ee(pi,pi.current)}function Va(i){ue(pi),mi===i&&(mi=null),ue(ha)}var ha=V(0);function Qd(i){for(var l=i;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||pm(p)||xf(p)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Bi=0,Ar=null,oo=null,ta=null,hh=!1,Ju=!1,Zc=!1,ph=0,Xd=0,Zu=null,lv=0;function pa(){throw Error(a(321))}function Zg(i,l){if(l===null)return!1;for(var p=0;p<l.length&&p<i.length;p++)if(!li(i[p],l[p]))return!1;return!0}function b0(i,l,p,b,D,P){return Bi=P,Ar=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,se.H=i===null||i.memoizedState===null?Av:y1,Zc=!1,P=p(b,D),Zc=!1,Ju&&(P=uv(l,p,b,D)),cv(i),P}function cv(i){se.H=Ah;var l=oo!==null&&oo.next!==null;if(Bi=0,ta=oo=Ar=null,hh=!1,Xd=0,Zu=null,l)throw Error(a(300));i===null||_a||(i=i.dependencies,i!==null&&_l(i)&&(_a=!0))}function uv(i,l,p,b){Ar=i;var D=0;do{if(Ju&&(Zu=null),Xd=0,Ju=!1,25<=D)throw Error(a(301));if(D+=1,ta=oo=null,i.updateQueue!=null){var P=i.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}se.H=Ev,P=l(p,b)}while(Ju);return P}function MS(){var i=se.H,l=i.useState()[0];return l=typeof l.then=="function"?gh(l):l,i=i.useState()[0],(oo!==null?oo.memoizedState:null)!==i&&(Ar.flags|=1024),l}function e1(){var i=ph!==0;return ph=0,i}function t1(i,l,p){l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~p}function mh(i){if(hh){for(i=i.memoizedState;i!==null;){var l=i.queue;l!==null&&(l.pending=null),i=i.next}hh=!1}Bi=0,ta=oo=Ar=null,Ju=!1,Xd=ph=0,Zu=null}function Ps(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ta===null?Ar.memoizedState=ta=i:ta=ta.next=i,ta}function xa(){if(oo===null){var i=Ar.alternate;i=i!==null?i.memoizedState:null}else i=oo.next;var l=ta===null?Ar.memoizedState:ta.next;if(l!==null)ta=l,oo=i;else{if(i===null)throw Ar.alternate===null?Error(a(467)):Error(a(310));oo=i,i={memoizedState:oo.memoizedState,baseState:oo.baseState,baseQueue:oo.baseQueue,queue:oo.queue,next:null},ta===null?Ar.memoizedState=ta=i:ta=ta.next=i}return ta}function v0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gh(i){var l=Xd;return Xd+=1,Zu===null&&(Zu=[]),i=Kg(Zu,i,l),l=Ar,(ta===null?l.memoizedState:ta.next)===null&&(l=l.alternate,se.H=l===null||l.memoizedState===null?Av:y1),i}function yh(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return gh(i);if(i.$$typeof===H)return Pa(i)}throw Error(a(438,String(i)))}function n1(i){var l=null,p=Ar.updateQueue;if(p!==null&&(l=p.memoCache),l==null){var b=Ar.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(l={data:b.data.map(function(D){return D.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),p===null&&(p=v0(),Ar.updateQueue=p),p.memoCache=l,p=l.data[l.index],p===void 0)for(p=l.data[l.index]=Array(i),b=0;b<i;b++)p[b]=le;return l.index++,p}function yc(i,l){return typeof l=="function"?l(i):l}function bh(i){var l=xa();return dl(l,oo,i)}function dl(i,l,p){var b=i.queue;if(b===null)throw Error(a(311));b.lastRenderedReducer=p;var D=i.baseQueue,P=b.pending;if(P!==null){if(D!==null){var q=D.next;D.next=P.next,P.next=q}l.baseQueue=D=P,b.pending=null}if(P=i.baseState,D===null)i.memoizedState=P;else{l=D.next;var ge=q=null,Le=null,ct=l,Dt=!1;do{var It=ct.lane&-536870913;if(It!==ct.lane?(Kr&It)===It:(Bi&It)===It){var ht=ct.revertLane;if(ht===0)Le!==null&&(Le=Le.next={lane:0,revertLane:0,gesture:null,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),It===Ku&&(Dt=!0);else if((Bi&ht)===ht){ct=ct.next,ht===Ku&&(Dt=!0);continue}else It={lane:0,revertLane:ct.revertLane,gesture:null,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null},Le===null?(ge=Le=It,q=P):Le=Le.next=It,Ar.lanes|=ht,Tc|=ht;It=ct.action,Zc&&p(P,It),P=ct.hasEagerState?ct.eagerState:p(P,It)}else ht={lane:It,revertLane:ct.revertLane,gesture:ct.gesture,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null},Le===null?(ge=Le=ht,q=P):Le=Le.next=ht,Ar.lanes|=It,Tc|=It;ct=ct.next}while(ct!==null&&ct!==l);if(Le===null?q=P:Le.next=ge,!li(P,i.memoizedState)&&(_a=!0,Dt&&(p=Yu,p!==null)))throw p;i.memoizedState=P,i.baseState=q,i.baseQueue=Le,b.lastRenderedState=P}return D===null&&(b.lanes=0),[i.memoizedState,b.dispatch]}function r1(i){var l=xa(),p=l.queue;if(p===null)throw Error(a(311));p.lastRenderedReducer=i;var b=p.dispatch,D=p.pending,P=l.memoizedState;if(D!==null){p.pending=null;var q=D=D.next;do P=i(P,q.action),q=q.next;while(q!==D);li(P,l.memoizedState)||(_a=!0),l.memoizedState=P,l.baseQueue===null&&(l.baseState=P),p.lastRenderedState=P}return[P,b]}function dv(i,l,p){var b=Ar,D=xa(),P=Gr;if(P){if(p===void 0)throw Error(a(407));p=p()}else p=l();var q=!li((oo||D).memoizedState,p);if(q&&(D.memoizedState=p,_a=!0),D=D.queue,Ch(fv.bind(null,b,D,i),[i]),D.getSnapshot!==l||q||ta!==null&&ta.memoizedState.tag&1){if(b.flags|=2048,Ca(9,{destroy:void 0},a1.bind(null,b,D,p,l),null),Oo===null)throw Error(a(349));P||(Bi&127)!==0||o1(b,l,p)}return p}function o1(i,l,p){i.flags|=16384,i={getSnapshot:l,value:p},l=Ar.updateQueue,l===null?(l=v0(),Ar.updateQueue=l,l.stores=[i]):(p=l.stores,p===null?l.stores=[i]:p.push(i))}function a1(i,l,p,b){l.value=p,l.getSnapshot=b,x0(l)&&C0(i)}function fv(i,l,p){return p(function(){x0(l)&&C0(i)})}function x0(i){var l=i.getSnapshot;i=i.value;try{var p=l();return!li(i,p)}catch{return!0}}function C0(i){var l=Li(i,2);l!==null&&Fs(l,i,2)}function S0(i){var l=Ps();if(typeof i=="function"){var p=i;if(i=p(),Zc){Wt(!0);try{p()}finally{Wt(!1)}}}return l.memoizedState=l.baseState=i,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yc,lastRenderedState:i},l}function s1(i,l,p,b){return i.baseState=p,dl(i,oo,typeof b=="function"?b:yc)}function hv(i,l,p,b,D){if(k0(i))throw Error(a(485));if(i=l.action,i!==null){var P={payload:D,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){P.listeners.push(q)}};se.T!==null?p(!0):P.isTransition=!1,b(P),p=l.pending,p===null?(P.next=l.pending=P,ed(l,P)):(P.next=p.next,l.pending=p.next=P)}}function ed(i,l){var p=l.action,b=l.payload,D=i.state;if(l.isTransition){var P=se.T,q={};se.T=q;try{var ge=p(D,b),Le=se.S;Le!==null&&Le(q,ge),pv(i,l,ge)}catch(ct){w0(i,l,ct)}finally{P!==null&&q.types!==null&&(P.types=q.types),se.T=P}}else try{P=p(D,b),pv(i,l,P)}catch(ct){w0(i,l,ct)}}function pv(i,l,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(b){mv(i,l,b)},function(b){return w0(i,l,b)}):mv(i,l,p)}function mv(i,l,p){l.status="fulfilled",l.value=p,i1(l),i.state=p,l=i.pending,l!==null&&(p=l.next,p===l?i.pending=null:(p=p.next,l.next=p,ed(i,p)))}function w0(i,l,p){var b=i.pending;if(i.pending=null,b!==null){b=b.next;do l.status="rejected",l.reason=p,i1(l),l=l.next;while(l!==b)}i.action=null}function i1(i){i=i.listeners;for(var l=0;l<i.length;l++)(0,i[l])()}function vh(i,l){return l}function Jd(i,l){if(Gr){var p=Oo.formState;if(p!==null){e:{var b=Ar;if(Gr){if(Uo){t:{for(var D=Uo,P=ao;D.nodeType!==8;){if(!P){D=null;break t}if(D=xi(D.nextSibling),D===null){D=null;break t}}P=D.data,D=P==="F!"||P==="F"?D:null}if(D){Uo=xi(D.nextSibling),b=D.data==="F!";break e}}_o(b)}b=!1}b&&(l=p[0])}}return p=Ps(),p.memoizedState=p.baseState=l,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vh,lastRenderedState:l},p.queue=b,p=nf.bind(null,Ar,b),b.dispatch=p,b=S0(!1),P=g1.bind(null,Ar,!1,b.queue),b=Ps(),D={state:l,dispatch:null,action:i,pending:null},b.queue=D,p=hv.bind(null,Ar,D,P,p),D.dispatch=p,b.memoizedState=i,[l,p,!1]}function xh(i){var l=xa();return l1(l,oo,i)}function l1(i,l,p){if(l=dl(i,l,vh)[0],i=bh(yc)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var b=gh(l)}catch(q){throw q===Vd?c0:q}else b=l;l=xa();var D=l.queue,P=D.dispatch;return p!==l.memoizedState&&(Ar.flags|=2048,Ca(9,{destroy:void 0},_S.bind(null,D,p),null)),[b,P,i]}function _S(i,l){i.action=l}function gv(i){var l=xa(),p=oo;if(p!==null)return l1(l,p,i);xa(),l=l.memoizedState,p=xa();var b=p.queue.dispatch;return p.memoizedState=i,[l,b,!1]}function Ca(i,l,p,b){return i={tag:i,create:p,deps:b,inst:l,next:null},l=Ar.updateQueue,l===null&&(l=v0(),Ar.updateQueue=l),p=l.lastEffect,p===null?l.lastEffect=i.next=i:(b=p.next,p.next=i,i.next=b,l.lastEffect=i),i}function Zd(){return xa().memoizedState}function eu(i,l,p,b){var D=Ps();Ar.flags|=i,D.memoizedState=Ca(1|l,{destroy:void 0},p,b===void 0?null:b)}function td(i,l,p,b){var D=xa();b=b===void 0?null:b;var P=D.memoizedState.inst;oo!==null&&b!==null&&Zg(b,oo.memoizedState.deps)?D.memoizedState=Ca(l,P,p,b):(Ar.flags|=i,D.memoizedState=Ca(1|l,P,p,b))}function T0(i,l){eu(8390656,8,i,l)}function Ch(i,l){td(2048,8,i,l)}function tu(i){Ar.flags|=4;var l=Ar.updateQueue;if(l===null)l=v0(),Ar.updateQueue=l,l.events=[i];else{var p=l.events;p===null?l.events=[i]:p.push(i)}}function c1(i){var l=xa().memoizedState;return tu({ref:l,nextImpl:i}),function(){if((uo&2)!==0)throw Error(a(440));return l.impl.apply(void 0,arguments)}}function ef(i,l){return td(4,2,i,l)}function nd(i,l){return td(4,4,i,l)}function yv(i,l){if(typeof l=="function"){i=i();var p=l(i);return function(){typeof p=="function"?p():l(null)}}if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function Sh(i,l,p){p=p!=null?p.concat([i]):null,td(4,4,yv.bind(null,l,i),p)}function tf(){}function u1(i,l){var p=xa();l=l===void 0?null:l;var b=p.memoizedState;return l!==null&&Zg(l,b[1])?b[0]:(p.memoizedState=[i,l],i)}function d1(i,l){var p=xa();l=l===void 0?null:l;var b=p.memoizedState;if(l!==null&&Zg(l,b[1]))return b[0];if(b=i(),Zc){Wt(!0);try{i()}finally{Wt(!1)}}return p.memoizedState=[b,l],b}function A0(i,l,p){return p===void 0||(Bi&1073741824)!==0&&(Kr&261930)===0?i.memoizedState=l:(i.memoizedState=p,i=Kv(),Ar.lanes|=i,Tc|=i,p)}function f1(i,l,p,b){return li(p,l)?p:pc.current!==null?(i=A0(i,p,b),li(i,l)||(_a=!0),i):(Bi&42)===0||(Bi&1073741824)!==0&&(Kr&261930)===0?(_a=!0,i.memoizedState=p):(i=Kv(),Ar.lanes|=i,Tc|=i,l)}function h1(i,l,p,b,D){var P=ye.p;ye.p=P!==0&&8>P?P:8;var q=se.T,ge={};se.T=ge,g1(i,!1,l,p);try{var Le=D(),ct=se.S;if(ct!==null&&ct(ge,Le),Le!==null&&typeof Le=="object"&&typeof Le.then=="function"){var Dt=av(Le,b);Th(i,l,Dt,Os(i))}else Th(i,l,b,Os(i))}catch(It){Th(i,l,{then:function(){},status:"rejected",reason:It},Os())}finally{ye.p=P,q!==null&&ge.types!==null&&(q.types=ge.types),se.T=q}}function wh(){}function p1(i,l,p,b){if(i.tag!==5)throw Error(a(476));var D=m1(i).queue;h1(i,D,l,ze,p===null?wh:function(){return bv(i),p(b)})}function m1(i){var l=i.memoizedState;if(l!==null)return l;l={memoizedState:ze,baseState:ze,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yc,lastRenderedState:ze},next:null};var p={};return l.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yc,lastRenderedState:p},next:null},i.memoizedState=l,i=i.alternate,i!==null&&(i.memoizedState=l),l}function bv(i){var l=m1(i);l.next===null&&(l=i.alternate.memoizedState),Th(i,l.next.queue,{},Os())}function E0(){return Pa(An)}function vv(){return xa().memoizedState}function xv(){return xa().memoizedState}function Cv(i){for(var l=i.return;l!==null;){switch(l.tag){case 24:case 3:var p=Os();i=ps(p);var b=hc(l,i,p);b!==null&&(Fs(b,l,p),Qu(b,l,p)),l={cache:Wd()},i.payload=l;return}l=l.return}}function Sv(i,l,p){var b=Os();p={lane:b,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},k0(i)?wv(l,p):(p=$u(i,l,p,b),p!==null&&(Fs(p,i,b),Tv(p,l,b)))}function nf(i,l,p){var b=Os();Th(i,l,p,b)}function Th(i,l,p,b){var D={lane:b,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(k0(i))wv(l,D);else{var P=i.alternate;if(i.lanes===0&&(P===null||P.lanes===0)&&(P=l.lastRenderedReducer,P!==null))try{var q=l.lastRenderedState,ge=P(q,p);if(D.hasEagerState=!0,D.eagerState=ge,li(ge,q))return Kc(i,l,D,0),Oo===null&&wr(),!1}catch{}finally{}if(p=$u(i,l,D,b),p!==null)return Fs(p,i,b),Tv(p,l,b),!0}return!1}function g1(i,l,p,b){if(b={lane:2,revertLane:Br(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},k0(i)){if(l)throw Error(a(479))}else l=$u(i,p,b,2),l!==null&&Fs(l,i,2)}function k0(i){var l=i.alternate;return i===Ar||l!==null&&l===Ar}function wv(i,l){Ju=hh=!0;var p=i.pending;p===null?l.next=l:(l.next=p.next,p.next=l),i.pending=l}function Tv(i,l,p){if((p&4194048)!==0){var b=l.lanes;b&=i.pendingLanes,p|=b,l.lanes=p,En(i,p)}}var Ah={readContext:Pa,use:yh,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useLayoutEffect:pa,useInsertionEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useSyncExternalStore:pa,useId:pa,useHostTransitionStatus:pa,useFormState:pa,useActionState:pa,useOptimistic:pa,useMemoCache:pa,useCacheRefresh:pa};Ah.useEffectEvent=pa;var Av={readContext:Pa,use:yh,useCallback:function(i,l){return Ps().memoizedState=[i,l===void 0?null:l],i},useContext:Pa,useEffect:T0,useImperativeHandle:function(i,l,p){p=p!=null?p.concat([i]):null,eu(4194308,4,yv.bind(null,l,i),p)},useLayoutEffect:function(i,l){return eu(4194308,4,i,l)},useInsertionEffect:function(i,l){eu(4,2,i,l)},useMemo:function(i,l){var p=Ps();l=l===void 0?null:l;var b=i();if(Zc){Wt(!0);try{i()}finally{Wt(!1)}}return p.memoizedState=[b,l],b},useReducer:function(i,l,p){var b=Ps();if(p!==void 0){var D=p(l);if(Zc){Wt(!0);try{p(l)}finally{Wt(!1)}}}else D=l;return b.memoizedState=b.baseState=D,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:D},b.queue=i,i=i.dispatch=Sv.bind(null,Ar,i),[b.memoizedState,i]},useRef:function(i){var l=Ps();return i={current:i},l.memoizedState=i},useState:function(i){i=S0(i);var l=i.queue,p=nf.bind(null,Ar,l);return l.dispatch=p,[i.memoizedState,p]},useDebugValue:tf,useDeferredValue:function(i,l){var p=Ps();return A0(p,i,l)},useTransition:function(){var i=S0(!1);return i=h1.bind(null,Ar,i.queue,!0,!1),Ps().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,l,p){var b=Ar,D=Ps();if(Gr){if(p===void 0)throw Error(a(407));p=p()}else{if(p=l(),Oo===null)throw Error(a(349));(Kr&127)!==0||o1(b,l,p)}D.memoizedState=p;var P={value:p,getSnapshot:l};return D.queue=P,T0(fv.bind(null,b,P,i),[i]),b.flags|=2048,Ca(9,{destroy:void 0},a1.bind(null,b,P,p,l),null),p},useId:function(){var i=Ps(),l=Oo.identifierPrefix;if(Gr){var p=sl,b=Il;p=(b&~(1<<32-_t(b)-1)).toString(32)+p,l="_"+l+"R_"+p,p=ph++,0<p&&(l+="H"+p.toString(32)),l+="_"}else p=lv++,l="_"+l+"r_"+p.toString(32)+"_";return i.memoizedState=l},useHostTransitionStatus:E0,useFormState:Jd,useActionState:Jd,useOptimistic:function(i){var l=Ps();l.memoizedState=l.baseState=i;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=p,l=g1.bind(null,Ar,!0,p),p.dispatch=l,[i,l]},useMemoCache:n1,useCacheRefresh:function(){return Ps().memoizedState=Cv.bind(null,Ar)},useEffectEvent:function(i){var l=Ps(),p={impl:i};return l.memoizedState=p,function(){if((uo&2)!==0)throw Error(a(440));return p.impl.apply(void 0,arguments)}}},y1={readContext:Pa,use:yh,useCallback:u1,useContext:Pa,useEffect:Ch,useImperativeHandle:Sh,useInsertionEffect:ef,useLayoutEffect:nd,useMemo:d1,useReducer:bh,useRef:Zd,useState:function(){return bh(yc)},useDebugValue:tf,useDeferredValue:function(i,l){var p=xa();return f1(p,oo.memoizedState,i,l)},useTransition:function(){var i=bh(yc)[0],l=xa().memoizedState;return[typeof i=="boolean"?i:gh(i),l]},useSyncExternalStore:dv,useId:vv,useHostTransitionStatus:E0,useFormState:xh,useActionState:xh,useOptimistic:function(i,l){var p=xa();return s1(p,oo,i,l)},useMemoCache:n1,useCacheRefresh:xv};y1.useEffectEvent=c1;var Ev={readContext:Pa,use:yh,useCallback:u1,useContext:Pa,useEffect:Ch,useImperativeHandle:Sh,useInsertionEffect:ef,useLayoutEffect:nd,useMemo:d1,useReducer:r1,useRef:Zd,useState:function(){return r1(yc)},useDebugValue:tf,useDeferredValue:function(i,l){var p=xa();return oo===null?A0(p,i,l):f1(p,oo.memoizedState,i,l)},useTransition:function(){var i=r1(yc)[0],l=xa().memoizedState;return[typeof i=="boolean"?i:gh(i),l]},useSyncExternalStore:dv,useId:vv,useHostTransitionStatus:E0,useFormState:gv,useActionState:gv,useOptimistic:function(i,l){var p=xa();return oo!==null?s1(p,oo,i,l):(p.baseState=i,[i,p.queue.dispatch])},useMemoCache:n1,useCacheRefresh:xv};Ev.useEffectEvent=c1;function b1(i,l,p,b){l=i.memoizedState,p=p(b,l),p=p==null?l:A({},l,p),i.memoizedState=p,i.lanes===0&&(i.updateQueue.baseState=p)}var v1={enqueueSetState:function(i,l,p){i=i._reactInternals;var b=Os(),D=ps(b);D.payload=l,p!=null&&(D.callback=p),l=hc(i,D,b),l!==null&&(Fs(l,i,b),Qu(l,i,b))},enqueueReplaceState:function(i,l,p){i=i._reactInternals;var b=Os(),D=ps(b);D.tag=1,D.payload=l,p!=null&&(D.callback=p),l=hc(i,D,b),l!==null&&(Fs(l,i,b),Qu(l,i,b))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var p=Os(),b=ps(p);b.tag=2,l!=null&&(b.callback=l),l=hc(i,b,p),l!==null&&(Fs(l,i,p),Qu(l,i,p))}};function kv(i,l,p,b,D,P,q){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(b,P,q):l.prototype&&l.prototype.isPureReactComponent?!Bd(p,b)||!Bd(D,P):!0}function Dv(i,l,p,b){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,b),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,b),l.state!==i&&v1.enqueueReplaceState(l,l.state,null)}function nu(i,l){var p=l;if("ref"in l){p={};for(var b in l)b!=="ref"&&(p[b]=l[b])}if(i=i.defaultProps){p===l&&(p=A({},p));for(var D in i)p[D]===void 0&&(p[D]=i[D])}return p}function D0(i){Ud(i)}function Rv(i){console.error(i)}function Iv(i){Ud(i)}function R0(i,l){try{var p=i.onUncaughtError;p(l.value,{componentStack:l.stack})}catch(b){setTimeout(function(){throw b})}}function x1(i,l,p){try{var b=i.onCaughtError;b(p.value,{componentStack:p.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function ru(i,l,p){return p=ps(p),p.tag=3,p.payload={element:null},p.callback=function(){R0(i,l)},p}function C1(i){return i=ps(i),i.tag=3,i}function S1(i,l,p,b){var D=p.type.getDerivedStateFromError;if(typeof D=="function"){var P=b.value;i.payload=function(){return D(P)},i.callback=function(){x1(l,p,b)}}var q=p.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(i.callback=function(){x1(l,p,b),typeof D!="function"&&(iu===null?iu=new Set([this]):iu.add(this));var ge=b.stack;this.componentDidCatch(b.value,{componentStack:ge!==null?ge:""})})}function Pv(i,l,p,b,D){if(p.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(l=p.alternate,l!==null&&Is(l,p,D,!0),p=pi.current,p!==null){switch(p.tag){case 31:case 13:return mi===null?q0():p.alternate===null&&la===0&&(la=3),p.flags&=-257,p.flags|=65536,p.lanes=D,b===u0?p.flags|=16384:(l=p.updateQueue,l===null?p.updateQueue=new Set([b]):l.add(b),X0(i,b,D)),!1;case 22:return p.flags|=65536,b===u0?p.flags|=16384:(l=p.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([b])},p.updateQueue=l):(p=l.retryQueue,p===null?l.retryQueue=new Set([b]):p.add(b)),X0(i,b,D)),!1}throw Error(a(435,p.tag))}return X0(i,b,D),q0(),!1}if(Gr)return l=pi.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=D,b!==hs&&(i=Error(a(422),{cause:b}),cc(ui(i,p)))):(b!==hs&&(l=Error(a(423),{cause:b}),cc(ui(l,p))),i=i.current.alternate,i.flags|=65536,D&=-D,i.lanes|=D,b=ui(b,p),D=ru(i.stateNode,b,D),h0(i,D),la!==4&&(la=2)),!1;var P=Error(a(520),{cause:b});if(P=ui(P,p),Fh===null?Fh=[P]:Fh.push(P),la!==4&&(la=2),l===null)return!0;b=ui(b,p),p=l;do{switch(p.tag){case 3:return p.flags|=65536,i=D&-D,p.lanes|=i,i=ru(p.stateNode,b,i),h0(p,i),!1;case 1:if(l=p.type,P=p.stateNode,(p.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(iu===null||!iu.has(P))))return p.flags|=65536,D&=-D,p.lanes|=D,D=C1(D),S1(D,i,p,b),h0(p,D),!1}p=p.return}while(p!==null);return!1}var w1=Error(a(461)),_a=!1;function as(i,l,p,b){l.child=i===null?qg(l,null,p,b):Jc(l,i.child,p,b)}function I0(i,l,p,b,D){p=p.render;var P=l.ref;if("ref"in b){var q={};for(var ge in b)ge!=="ref"&&(q[ge]=b[ge])}else q=b;return Qc(l),b=b0(i,l,p,q,P,D),ge=e1(),i!==null&&!_a?(t1(i,l,D),bc(i,l,D)):(Gr&&ge&&n0(l),l.flags|=1,as(i,l,b,D),l.child)}function T1(i,l,p,b,D){if(i===null){var P=p.type;return typeof P=="function"&&!zg(P)&&P.defaultProps===void 0&&p.compare===null?(l.tag=15,l.type=P,rd(i,l,P,b,D)):(i=oh(p.type,null,b,l,l.mode,D),i.ref=l.ref,i.return=l,l.child=i)}if(P=i.child,!ad(i,D)){var q=P.memoizedProps;if(p=p.compare,p=p!==null?p:Bd,p(q,b)&&i.ref===l.ref)return bc(i,l,D)}return l.flags|=1,i=Rl(P,b),i.ref=l.ref,i.return=l,l.child=i}function rd(i,l,p,b,D){if(i!==null){var P=i.memoizedProps;if(Bd(P,b)&&i.ref===l.ref)if(_a=!1,l.pendingProps=b=P,ad(i,D))(i.flags&131072)!==0&&(_a=!0);else return l.lanes=i.lanes,bc(i,l,D)}return M0(i,l,p,b,D)}function Mv(i,l,p,b){var D=b.children,P=i!==null?i.memoizedState:null;if(i===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((l.flags&128)!==0){if(P=P!==null?P.baseLanes|p:p,i!==null){for(b=l.child=i.child,D=0;b!==null;)D=D|b.lanes|b.childLanes,b=b.sibling;b=D&~P}else b=0,l.child=null;return P0(i,l,P,p,b)}if((p&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},i!==null&&lh(l,P!==null?P.cachePool:null),P!==null?Xg(l,P):g0(),y0(l);else return b=l.lanes=536870912,P0(i,l,P!==null?P.baseLanes|p:p,p,b)}else P!==null?(lh(l,P.cachePool),Xg(l,P),gc(),l.memoizedState=null):(i!==null&&lh(l,null),g0(),gc());return as(i,l,D,p),l.child}function od(i,l){return i!==null&&i.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function P0(i,l,p,b,D){var P=i0();return P=P===null?null:{parent:Ma._currentValue,pool:P},l.memoizedState={baseLanes:p,cachePool:P},i!==null&&lh(l,null),g0(),y0(l),i!==null&&Is(i,l,b,!0),l.childLanes=D,null}function Eh(i,l){return l=Dh({mode:l.mode,children:l.children},i.mode),l.ref=i.ref,i.child=l,l.return=i,l}function A1(i,l,p){return Jc(l,i.child,null,p),i=Eh(l,l.pendingProps),i.flags|=2,Va(l),l.memoizedState=null,i}function Oa(i,l,p){var b=l.pendingProps,D=(l.flags&128)!==0;if(l.flags&=-129,i===null){if(Gr){if(b.mode==="hidden")return i=Eh(l,b),l.lanes=536870912,od(null,i);if(fh(l),(i=Uo)?(i=hm(i,ao),i=i!==null&&i.data==="&"?i:null,i!==null&&(l.memoizedState={dehydrated:i,treeContext:ic!==null?{id:Il,overflow:sl}:null,retryLane:536870912,hydrationErrors:null},p=Ug(i),p.return=l,l.child=p,os=l,Uo=null)):i=null,i===null)throw _o(l);return l.lanes=536870912,null}return Eh(l,b)}var P=i.memoizedState;if(P!==null){var q=P.dehydrated;if(fh(l),D)if(l.flags&256)l.flags&=-257,l=A1(i,l,p);else if(l.memoizedState!==null)l.child=i.child,l.flags|=128,l=null;else throw Error(a(558));else if(_a||Is(i,l,p,!1),D=(p&i.childLanes)!==0,_a||D){if(b=Oo,b!==null&&(q=fr(b,p),q!==0&&q!==P.retryLane))throw P.retryLane=q,Li(i,q),Fs(b,i,q),w1;q0(),l=A1(i,l,p)}else i=P.treeContext,Uo=xi(q.nextSibling),os=l,Gr=!0,Rs=null,ao=!1,i!==null&&$g(l,i),l=Eh(l,b),l.flags|=4096;return l}return i=Rl(i.child,{mode:b.mode,children:b.children}),i.ref=l.ref,l.child=i,i.return=l,i}function fl(i,l){var p=l.ref;if(p===null)i!==null&&i.ref!==null&&(l.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(a(284));(i===null||i.ref!==p)&&(l.flags|=4194816)}}function M0(i,l,p,b,D){return Qc(l),p=b0(i,l,p,b,void 0,D),b=e1(),i!==null&&!_a?(t1(i,l,D),bc(i,l,D)):(Gr&&b&&n0(l),l.flags|=1,as(i,l,p,D),l.child)}function E1(i,l,p,b,D,P){return Qc(l),l.updateQueue=null,p=uv(l,b,p,D),cv(i),b=e1(),i!==null&&!_a?(t1(i,l,P),bc(i,l,P)):(Gr&&b&&n0(l),l.flags|=1,as(i,l,p,P),l.child)}function k1(i,l,p,b,D){if(Qc(l),l.stateNode===null){var P=Hu,q=p.contextType;typeof q=="object"&&q!==null&&(P=Pa(q)),P=new p(b,P),l.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=v1,l.stateNode=P,P._reactInternals=l,P=l.stateNode,P.props=b,P.state=l.memoizedState,P.refs={},f0(l),q=p.contextType,P.context=typeof q=="object"&&q!==null?Pa(q):Hu,P.state=l.memoizedState,q=p.getDerivedStateFromProps,typeof q=="function"&&(b1(l,p,q,b),P.state=l.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(q=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),q!==P.state&&v1.enqueueReplaceState(P,P.state,null),Xu(l,b,P,D),qd(),P.state=l.memoizedState),typeof P.componentDidMount=="function"&&(l.flags|=4194308),b=!0}else if(i===null){P=l.stateNode;var ge=l.memoizedProps,Le=nu(p,ge);P.props=Le;var ct=P.context,Dt=p.contextType;q=Hu,typeof Dt=="object"&&Dt!==null&&(q=Pa(Dt));var It=p.getDerivedStateFromProps;Dt=typeof It=="function"||typeof P.getSnapshotBeforeUpdate=="function",ge=l.pendingProps!==ge,Dt||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(ge||ct!==q)&&Dv(l,P,b,q),cl=!1;var ht=l.memoizedState;P.state=ht,Xu(l,b,P,D),qd(),ct=l.memoizedState,ge||ht!==ct||cl?(typeof It=="function"&&(b1(l,p,It,b),ct=l.memoizedState),(Le=cl||kv(l,p,Le,b,ht,ct,q))?(Dt||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(l.flags|=4194308)):(typeof P.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=b,l.memoizedState=ct),P.props=b,P.state=ct,P.context=q,b=Le):(typeof P.componentDidMount=="function"&&(l.flags|=4194308),b=!1)}else{P=l.stateNode,Yd(i,l),q=l.memoizedProps,Dt=nu(p,q),P.props=Dt,It=l.pendingProps,ht=P.context,ct=p.contextType,Le=Hu,typeof ct=="object"&&ct!==null&&(Le=Pa(ct)),ge=p.getDerivedStateFromProps,(ct=typeof ge=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(q!==It||ht!==Le)&&Dv(l,P,b,Le),cl=!1,ht=l.memoizedState,P.state=ht,Xu(l,b,P,D),qd();var Ct=l.memoizedState;q!==It||ht!==Ct||cl||i!==null&&i.dependencies!==null&&_l(i.dependencies)?(typeof ge=="function"&&(b1(l,p,ge,b),Ct=l.memoizedState),(Dt=cl||kv(l,p,Dt,b,ht,Ct,Le)||i!==null&&i.dependencies!==null&&_l(i.dependencies))?(ct||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(b,Ct,Le),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(b,Ct,Le)),typeof P.componentDidUpdate=="function"&&(l.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof P.componentDidUpdate!="function"||q===i.memoizedProps&&ht===i.memoizedState||(l.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||q===i.memoizedProps&&ht===i.memoizedState||(l.flags|=1024),l.memoizedProps=b,l.memoizedState=Ct),P.props=b,P.state=Ct,P.context=Le,b=Dt):(typeof P.componentDidUpdate!="function"||q===i.memoizedProps&&ht===i.memoizedState||(l.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||q===i.memoizedProps&&ht===i.memoizedState||(l.flags|=1024),b=!1)}return P=b,fl(i,l),b=(l.flags&128)!==0,P||b?(P=l.stateNode,p=b&&typeof p.getDerivedStateFromError!="function"?null:P.render(),l.flags|=1,i!==null&&b?(l.child=Jc(l,i.child,null,D),l.child=Jc(l,null,p,D)):as(i,l,p,D),l.memoizedState=P.state,i=l.child):i=bc(i,l,D),i}function _v(i,l,p,b){return il(),l.flags|=256,as(i,l,p,b),l.child}var _0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function O0(i){return{baseLanes:i,cachePool:iv()}}function D1(i,l,p){return i=i!==null?i.childLanes&~p:0,l&&(i|=yi),i}function rf(i,l,p){var b=l.pendingProps,D=!1,P=(l.flags&128)!==0,q;if((q=P)||(q=i!==null&&i.memoizedState===null?!1:(ha.current&2)!==0),q&&(D=!0,l.flags&=-129),q=(l.flags&32)!==0,l.flags&=-33,i===null){if(Gr){if(D?ul(l):gc(),(i=Uo)?(i=hm(i,ao),i=i!==null&&i.data!=="&"?i:null,i!==null&&(l.memoizedState={dehydrated:i,treeContext:ic!==null?{id:Il,overflow:sl}:null,retryLane:536870912,hydrationErrors:null},p=Ug(i),p.return=l,l.child=p,os=l,Uo=null)):i=null,i===null)throw _o(l);return xf(i)?l.lanes=32:l.lanes=536870912,null}var ge=b.children;return b=b.fallback,D?(gc(),D=l.mode,ge=Dh({mode:"hidden",children:ge},D),b=ci(b,D,p,null),ge.return=l,b.return=l,ge.sibling=b,l.child=ge,b=l.child,b.memoizedState=O0(p),b.childLanes=D1(i,q,p),l.memoizedState=_0,od(null,b)):(ul(l),kh(l,ge))}var Le=i.memoizedState;if(Le!==null&&(ge=Le.dehydrated,ge!==null)){if(P)l.flags&256?(ul(l),l.flags&=-257,l=R1(i,l,p)):l.memoizedState!==null?(gc(),l.child=i.child,l.flags|=128,l=null):(gc(),ge=b.fallback,D=l.mode,b=Dh({mode:"visible",children:b.children},D),ge=ci(ge,D,p,null),ge.flags|=2,b.return=l,ge.return=l,b.sibling=ge,l.child=b,Jc(l,i.child,null,p),b=l.child,b.memoizedState=O0(p),b.childLanes=D1(i,q,p),l.memoizedState=_0,l=od(null,b));else if(ul(l),xf(ge)){if(q=ge.nextSibling&&ge.nextSibling.dataset,q)var ct=q.dgst;q=ct,b=Error(a(419)),b.stack="",b.digest=q,cc({value:b,source:null,stack:null}),l=R1(i,l,p)}else if(_a||Is(i,l,p,!1),q=(p&i.childLanes)!==0,_a||q){if(q=Oo,q!==null&&(b=fr(q,p),b!==0&&b!==Le.retryLane))throw Le.retryLane=b,Li(i,b),Fs(q,i,b),w1;pm(ge)||q0(),l=R1(i,l,p)}else pm(ge)?(l.flags|=192,l.child=i.child,l=null):(i=Le.treeContext,Uo=xi(ge.nextSibling),os=l,Gr=!0,Rs=null,ao=!1,i!==null&&$g(l,i),l=kh(l,b.children),l.flags|=4096);return l}return D?(gc(),ge=b.fallback,D=l.mode,Le=i.child,ct=Le.sibling,b=Rl(Le,{mode:"hidden",children:b.children}),b.subtreeFlags=Le.subtreeFlags&65011712,ct!==null?ge=Rl(ct,ge):(ge=ci(ge,D,p,null),ge.flags|=2),ge.return=l,b.return=l,b.sibling=ge,l.child=b,od(null,b),b=l.child,ge=i.child.memoizedState,ge===null?ge=O0(p):(D=ge.cachePool,D!==null?(Le=Ma._currentValue,D=D.parent!==Le?{parent:Le,pool:Le}:D):D=iv(),ge={baseLanes:ge.baseLanes|p,cachePool:D}),b.memoizedState=ge,b.childLanes=D1(i,q,p),l.memoizedState=_0,od(i.child,b)):(ul(l),p=i.child,i=p.sibling,p=Rl(p,{mode:"visible",children:b.children}),p.return=l,p.sibling=null,i!==null&&(q=l.deletions,q===null?(l.deletions=[i],l.flags|=16):q.push(i)),l.child=p,l.memoizedState=null,p)}function kh(i,l){return l=Dh({mode:"visible",children:l},i.mode),l.return=i,i.child=l}function Dh(i,l){return i=ea(22,i,null,l),i.lanes=0,i}function R1(i,l,p){return Jc(l,i.child,null,p),i=kh(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function I1(i,l,p){i.lanes|=l;var b=i.alternate;b!==null&&(b.lanes|=l),o0(i.return,l,p)}function P1(i,l,p,b,D,P){var q=i.memoizedState;q===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:b,tail:p,tailMode:D,treeForkCount:P}:(q.isBackwards=l,q.rendering=null,q.renderingStartTime=0,q.last=b,q.tail=p,q.tailMode=D,q.treeForkCount=P)}function Ov(i,l,p){var b=l.pendingProps,D=b.revealOrder,P=b.tail;b=b.children;var q=ha.current,ge=(q&2)!==0;if(ge?(q=q&1|2,l.flags|=128):q&=1,Ee(ha,q),as(i,l,b,p),b=Gr?Hd:0,!ge&&i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&I1(i,p,l);else if(i.tag===19)I1(i,p,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(D){case"forwards":for(p=l.child,D=null;p!==null;)i=p.alternate,i!==null&&Qd(i)===null&&(D=p),p=p.sibling;p=D,p===null?(D=l.child,l.child=null):(D=p.sibling,p.sibling=null),P1(l,!1,D,p,P,b);break;case"backwards":case"unstable_legacy-backwards":for(p=null,D=l.child,l.child=null;D!==null;){if(i=D.alternate,i!==null&&Qd(i)===null){l.child=D;break}i=D.sibling,D.sibling=p,p=D,D=i}P1(l,!0,p,null,P,b);break;case"together":P1(l,!1,null,null,void 0,b);break;default:l.memoizedState=null}return l.child}function bc(i,l,p){if(i!==null&&(l.dependencies=i.dependencies),Tc|=l.lanes,(p&l.childLanes)===0)if(i!==null){if(Is(i,l,p,!1),(p&l.childLanes)===0)return null}else return null;if(i!==null&&l.child!==i.child)throw Error(a(153));if(l.child!==null){for(i=l.child,p=Rl(i,i.pendingProps),l.child=p,p.return=l;i.sibling!==null;)i=i.sibling,p=p.sibling=Rl(i,i.pendingProps),p.return=l;p.sibling=null}return l.child}function ad(i,l){return(i.lanes&l)!==0?!0:(i=i.dependencies,!!(i!==null&&_l(i)))}function Rh(i,l,p){switch(l.tag){case 3:tt(l,l.stateNode.containerInfo),ll(l,Ma,i.memoizedState.cache),il();break;case 27:case 5:Pe(l);break;case 4:tt(l,l.stateNode.containerInfo);break;case 10:ll(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,fh(l),null;break;case 13:var b=l.memoizedState;if(b!==null)return b.dehydrated!==null?(ul(l),l.flags|=128,null):(p&l.child.childLanes)!==0?rf(i,l,p):(ul(l),i=bc(i,l,p),i!==null?i.sibling:null);ul(l);break;case 19:var D=(i.flags&128)!==0;if(b=(p&l.childLanes)!==0,b||(Is(i,l,p,!1),b=(p&l.childLanes)!==0),D){if(b)return Ov(i,l,p);l.flags|=128}if(D=l.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),Ee(ha,ha.current),b)break;return null;case 22:return l.lanes=0,Mv(i,l,p,l.pendingProps);case 24:ll(l,Ma,i.memoizedState.cache)}return bc(i,l,p)}function Fv(i,l,p){if(i!==null)if(i.memoizedProps!==l.pendingProps)_a=!0;else{if(!ad(i,p)&&(l.flags&128)===0)return _a=!1,Rh(i,l,p);_a=(i.flags&131072)!==0}else _a=!1,Gr&&(l.flags&1048576)!==0&&ah(l,Hd,l.index);switch(l.lanes=0,l.tag){case 16:e:{var b=l.pendingProps;if(i=Ol(l.elementType),l.type=i,typeof i=="function")zg(i)?(b=nu(i,b),l.tag=1,l=k1(null,l,i,b,p)):(l.tag=0,l=M0(null,l,i,b,p));else{if(i!=null){var D=i.$$typeof;if(D===K){l.tag=11,l=I0(null,l,i,b,p);break e}else if(D===ee){l.tag=14,l=T1(null,l,i,b,p);break e}}throw l=ne(i)||i,Error(a(306,l,""))}}return l;case 0:return M0(i,l,l.type,l.pendingProps,p);case 1:return b=l.type,D=nu(b,l.pendingProps),k1(i,l,b,D,p);case 3:e:{if(tt(l,l.stateNode.containerInfo),i===null)throw Error(a(387));b=l.pendingProps;var P=l.memoizedState;D=P.element,Yd(i,l),Xu(l,b,null,p);var q=l.memoizedState;if(b=q.cache,ll(l,Ma,b),b!==P.cache&&a0(l,[Ma],p,!0),qd(),b=q.element,P.isDehydrated)if(P={element:b,isDehydrated:!1,cache:q.cache},l.updateQueue.baseState=P,l.memoizedState=P,l.flags&256){l=_v(i,l,b,p);break e}else if(b!==D){D=ui(Error(a(424)),l),cc(D),l=_v(i,l,b,p);break e}else{switch(i=l.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Uo=xi(i.firstChild),os=l,Gr=!0,Rs=null,ao=!0,p=qg(l,null,b,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(il(),b===D){l=bc(i,l,p);break e}as(i,l,b,p)}l=l.child}return l;case 26:return fl(i,l),i===null?(p=re(l.type,null,l.pendingProps,null))?l.memoizedState=p:Gr||(p=l.type,i=l.pendingProps,b=Vh(be.current).createElement(p),b[Rr]=l,b[Jn]=i,ls(b,p,i),Zr(b),l.stateNode=b):l.memoizedState=re(l.type,i.memoizedProps,l.pendingProps,i.memoizedState),null;case 27:return Pe(l),i===null&&Gr&&(b=l.stateNode=s(l.type,l.pendingProps,be.current),os=l,ao=!0,D=Uo,Dc(l.type)?(uu=D,Uo=xi(b.firstChild)):Uo=D),as(i,l,l.pendingProps.children,p),fl(i,l),i===null&&(l.flags|=4194304),l.child;case 5:return i===null&&Gr&&((D=b=Uo)&&(b=fm(b,l.type,l.pendingProps,ao),b!==null?(l.stateNode=b,os=l,Uo=xi(b.firstChild),ao=!1,D=!0):D=!1),D||_o(l)),Pe(l),D=l.type,P=l.pendingProps,q=i!==null?i.memoizedProps:null,b=P.children,vf(D,P)?b=null:q!==null&&vf(D,q)&&(l.flags|=32),l.memoizedState!==null&&(D=b0(i,l,MS,null,null,p),An._currentValue=D),fl(i,l),as(i,l,b,p),l.child;case 6:return i===null&&Gr&&((i=p=Uo)&&(p=ry(p,l.pendingProps,ao),p!==null?(l.stateNode=p,os=l,Uo=null,i=!0):i=!1),i||_o(l)),null;case 13:return rf(i,l,p);case 4:return tt(l,l.stateNode.containerInfo),b=l.pendingProps,i===null?l.child=Jc(l,null,b,p):as(i,l,b,p),l.child;case 11:return I0(i,l,l.type,l.pendingProps,p);case 7:return as(i,l,l.pendingProps,p),l.child;case 8:return as(i,l,l.pendingProps.children,p),l.child;case 12:return as(i,l,l.pendingProps.children,p),l.child;case 10:return b=l.pendingProps,ll(l,l.type,b.value),as(i,l,b.children,p),l.child;case 9:return D=l.type._context,b=l.pendingProps.children,Qc(l),D=Pa(D),b=b(D),l.flags|=1,as(i,l,b,p),l.child;case 14:return T1(i,l,l.type,l.pendingProps,p);case 15:return rd(i,l,l.type,l.pendingProps,p);case 19:return Ov(i,l,p);case 31:return Oa(i,l,p);case 22:return Mv(i,l,p,l.pendingProps);case 24:return Qc(l),b=Pa(Ma),i===null?(D=i0(),D===null&&(D=Oo,P=Wd(),D.pooledCache=P,P.refCount++,P!==null&&(D.pooledCacheLanes|=p),D=P),l.memoizedState={parent:b,cache:D},f0(l),ll(l,Ma,D)):((i.lanes&p)!==0&&(Yd(i,l),Xu(l,null,null,p),qd()),D=i.memoizedState,P=l.memoizedState,D.parent!==b?(D={parent:b,cache:b},l.memoizedState=D,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=D),ll(l,Ma,b)):(b=P.cache,ll(l,Ma,b),b!==D.cache&&a0(l,[Ma],p,!0))),as(i,l,l.pendingProps.children,p),l.child;case 29:throw l.pendingProps}throw Error(a(156,l.tag))}function Fl(i){i.flags|=4}function F0(i,l,p,b,D){if((l=(i.mode&32)!==0)&&(l=!1),l){if(i.flags|=16777216,(D&335544128)===D)if(i.stateNode.complete)i.flags|=8192;else if(Qv())i.flags|=8192;else throw qu=u0,l0}else i.flags&=-16777217}function ws(i,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!sn(l))if(Qv())i.flags|=8192;else throw qu=u0,l0}function of(i,l){l!==null&&(i.flags|=4),i.flags&16384&&(l=i.tag!==22?Bt():536870912,i.lanes|=l,hf|=l)}function Ih(i,l){if(!Gr)switch(i.tailMode){case"hidden":l=i.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?i.tail=null:p.sibling=null;break;case"collapsed":p=i.tail;for(var b=null;p!==null;)p.alternate!==null&&(b=p),p=p.sibling;b===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:b.sibling=null}}function ko(i){var l=i.alternate!==null&&i.alternate.child===i.child,p=0,b=0;if(l)for(var D=i.child;D!==null;)p|=D.lanes|D.childLanes,b|=D.subtreeFlags&65011712,b|=D.flags&65011712,D.return=i,D=D.sibling;else for(D=i.child;D!==null;)p|=D.lanes|D.childLanes,b|=D.subtreeFlags,b|=D.flags,D.return=i,D=D.sibling;return i.subtreeFlags|=b,i.childLanes=p,l}function OS(i,l,p){var b=l.pendingProps;switch(r0(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ko(l),null;case 1:return ko(l),null;case 3:return p=l.stateNode,b=null,i!==null&&(b=i.memoizedState.cache),l.memoizedState.cache!==b&&(l.flags|=2048),Ml(Ma),je(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&(Vu(l)?Fl(l):i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,lc())),ko(l),null;case 26:var D=l.type,P=l.memoizedState;return i===null?(Fl(l),P!==null?(ko(l),ws(l,P)):(ko(l),F0(l,D,null,b,p))):P?P!==i.memoizedState?(Fl(l),ko(l),ws(l,P)):(ko(l),l.flags&=-16777217):(i=i.memoizedProps,i!==b&&Fl(l),ko(l),F0(l,D,i,b,p)),null;case 27:if(Be(l),p=be.current,D=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==b&&Fl(l);else{if(!b){if(l.stateNode===null)throw Error(a(166));return ko(l),null}i=Ie.current,Vu(l)?hi(l):(i=s(D,b,p),l.stateNode=i,Fl(l))}return ko(l),null;case 5:if(Be(l),D=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==b&&Fl(l);else{if(!b){if(l.stateNode===null)throw Error(a(166));return ko(l),null}if(P=Ie.current,Vu(l))hi(l);else{var q=Vh(be.current);switch(P){case 1:P=q.createElementNS("http://www.w3.org/2000/svg",D);break;case 2:P=q.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;default:switch(D){case"svg":P=q.createElementNS("http://www.w3.org/2000/svg",D);break;case"math":P=q.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;case"script":P=q.createElement("div"),P.innerHTML="<script><\/script>",P=P.removeChild(P.firstChild);break;case"select":P=typeof b.is=="string"?q.createElement("select",{is:b.is}):q.createElement("select"),b.multiple?P.multiple=!0:b.size&&(P.size=b.size);break;default:P=typeof b.is=="string"?q.createElement(D,{is:b.is}):q.createElement(D)}}P[Rr]=l,P[Jn]=b;e:for(q=l.child;q!==null;){if(q.tag===5||q.tag===6)P.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===l)break e;for(;q.sibling===null;){if(q.return===null||q.return===l)break e;q=q.return}q.sibling.return=q.return,q=q.sibling}l.stateNode=P;e:switch(ls(P,D,b),D){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}b&&Fl(l)}}return ko(l),F0(l,l.type,i===null?null:i.memoizedProps,l.pendingProps,p),null;case 6:if(i&&l.stateNode!=null)i.memoizedProps!==b&&Fl(l);else{if(typeof b!="string"&&l.stateNode===null)throw Error(a(166));if(i=be.current,Vu(l)){if(i=l.stateNode,p=l.memoizedProps,b=null,D=os,D!==null)switch(D.tag){case 27:case 5:b=D.memoizedProps}i[Rr]=l,i=!!(i.nodeValue===p||b!==null&&b.suppressHydrationWarning===!0||q1(i.nodeValue,p)),i||_o(l,!0)}else i=Vh(i).createTextNode(b),i[Rr]=l,l.stateNode=i}return ko(l),null;case 31:if(p=l.memoizedState,i===null||i.memoizedState!==null){if(b=Vu(l),p!==null){if(i===null){if(!b)throw Error(a(318));if(i=l.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[Rr]=l}else il(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;ko(l),i=!1}else p=lc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),i=!0;if(!i)return l.flags&256?(Va(l),l):(Va(l),null);if((l.flags&128)!==0)throw Error(a(558))}return ko(l),null;case 13:if(b=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(D=Vu(l),b!==null&&b.dehydrated!==null){if(i===null){if(!D)throw Error(a(318));if(D=l.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(a(317));D[Rr]=l}else il(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;ko(l),D=!1}else D=lc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=D),D=!0;if(!D)return l.flags&256?(Va(l),l):(Va(l),null)}return Va(l),(l.flags&128)!==0?(l.lanes=p,l):(p=b!==null,i=i!==null&&i.memoizedState!==null,p&&(b=l.child,D=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(D=b.alternate.memoizedState.cachePool.pool),P=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(P=b.memoizedState.cachePool.pool),P!==D&&(b.flags|=2048)),p!==i&&p&&(l.child.flags|=8192),of(l,l.updateQueue),ko(l),null);case 4:return je(),i===null&&K1(l.stateNode.containerInfo),ko(l),null;case 10:return Ml(l.type),ko(l),null;case 19:if(ue(ha),b=l.memoizedState,b===null)return ko(l),null;if(D=(l.flags&128)!==0,P=b.rendering,P===null)if(D)Ih(b,!1);else{if(la!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(P=Qd(i),P!==null){for(l.flags|=128,Ih(b,!1),i=P.updateQueue,l.updateQueue=i,of(l,i),l.subtreeFlags=0,i=p,p=l.child;p!==null;)Zp(p,i),p=p.sibling;return Ee(ha,ha.current&1|2),Gr&&Pl(l,b.treeForkCount),l.child}i=i.sibling}b.tail!==null&&Me()>W0&&(l.flags|=128,D=!0,Ih(b,!1),l.lanes=4194304)}else{if(!D)if(i=Qd(P),i!==null){if(l.flags|=128,D=!0,i=i.updateQueue,l.updateQueue=i,of(l,i),Ih(b,!0),b.tail===null&&b.tailMode==="hidden"&&!P.alternate&&!Gr)return ko(l),null}else 2*Me()-b.renderingStartTime>W0&&p!==536870912&&(l.flags|=128,D=!0,Ih(b,!1),l.lanes=4194304);b.isBackwards?(P.sibling=l.child,l.child=P):(i=b.last,i!==null?i.sibling=P:l.child=P,b.last=P)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=Me(),i.sibling=null,p=ha.current,Ee(ha,D?p&1|2:p&1),Gr&&Pl(l,b.treeForkCount),i):(ko(l),null);case 22:case 23:return Va(l),Jg(),b=l.memoizedState!==null,i!==null?i.memoizedState!==null!==b&&(l.flags|=8192):b&&(l.flags|=8192),b?(p&536870912)!==0&&(l.flags&128)===0&&(ko(l),l.subtreeFlags&6&&(l.flags|=8192)):ko(l),p=l.updateQueue,p!==null&&of(l,p.retryQueue),p=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(p=i.memoizedState.cachePool.pool),b=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(b=l.memoizedState.cachePool.pool),b!==p&&(l.flags|=2048),i!==null&&ue(Xc),null;case 24:return p=null,i!==null&&(p=i.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),Ml(Ma),ko(l),null;case 25:return null;case 30:return null}throw Error(a(156,l.tag))}function N0(i,l){switch(r0(l),l.tag){case 1:return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return Ml(Ma),je(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 26:case 27:case 5:return Be(l),null;case 31:if(l.memoizedState!==null){if(Va(l),l.alternate===null)throw Error(a(340));il()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 13:if(Va(l),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(a(340));il()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return ue(ha),null;case 4:return je(),null;case 10:return Ml(l.type),null;case 22:case 23:return Va(l),Jg(),i!==null&&ue(Xc),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 24:return Ml(Ma),null;case 25:return null;default:return null}}function Nv(i,l){switch(r0(l),l.tag){case 3:Ml(Ma),je();break;case 26:case 27:case 5:Be(l);break;case 4:je();break;case 31:l.memoizedState!==null&&Va(l);break;case 13:Va(l);break;case 19:ue(ha);break;case 10:Ml(l.type);break;case 22:case 23:Va(l),Jg(),i!==null&&ue(Xc);break;case 24:Ml(Ma)}}function Ph(i,l){try{var p=l.updateQueue,b=p!==null?p.lastEffect:null;if(b!==null){var D=b.next;p=D;do{if((p.tag&i)===i){b=void 0;var P=p.create,q=p.inst;b=P(),q.destroy=b}p=p.next}while(p!==D)}}catch(ge){go(l,l.return,ge)}}function ou(i,l,p){try{var b=l.updateQueue,D=b!==null?b.lastEffect:null;if(D!==null){var P=D.next;b=P;do{if((b.tag&i)===i){var q=b.inst,ge=q.destroy;if(ge!==void 0){q.destroy=void 0,D=l;var Le=p,ct=ge;try{ct()}catch(Dt){go(D,Le,Dt)}}}b=b.next}while(b!==P)}}catch(Dt){go(l,l.return,Dt)}}function M1(i){var l=i.updateQueue;if(l!==null){var p=i.stateNode;try{m0(l,p)}catch(b){go(i,i.return,b)}}}function jv(i,l,p){p.props=nu(i.type,i.memoizedProps),p.state=i.memoizedState;try{p.componentWillUnmount()}catch(b){go(i,l,b)}}function af(i,l){try{var p=i.ref;if(p!==null){switch(i.tag){case 26:case 27:case 5:var b=i.stateNode;break;case 30:b=i.stateNode;break;default:b=i.stateNode}typeof p=="function"?i.refCleanup=p(b):p.current=b}}catch(D){go(i,l,D)}}function zi(i,l){var p=i.ref,b=i.refCleanup;if(p!==null)if(typeof b=="function")try{b()}catch(D){go(i,l,D)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(D){go(i,l,D)}else p.current=null}function sf(i){var l=i.type,p=i.memoizedProps,b=i.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":p.autoFocus&&b.focus();break e;case"img":p.src?b.src=p.src:p.srcSet&&(b.srcset=p.srcSet)}}catch(D){go(i,i.return,D)}}function au(i,l,p){try{var b=i.stateNode;X1(b,i.type,p,l),b[Jn]=l}catch(D){go(i,i.return,D)}}function lf(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Dc(i.type)||i.tag===4}function Mh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||lf(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Dc(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function cf(i,l,p){var b=i.tag;if(b===5||b===6)i=i.stateNode,l?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(i,l):(l=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,l.appendChild(i),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=_i));else if(b!==4&&(b===27&&Dc(i.type)&&(p=i.stateNode,l=null),i=i.child,i!==null))for(cf(i,l,p),i=i.sibling;i!==null;)cf(i,l,p),i=i.sibling}function Nl(i,l,p){var b=i.tag;if(b===5||b===6)i=i.stateNode,l?p.insertBefore(i,l):p.appendChild(i);else if(b!==4&&(b===27&&Dc(i.type)&&(p=i.stateNode),i=i.child,i!==null))for(Nl(i,l,p),i=i.sibling;i!==null;)Nl(i,l,p),i=i.sibling}function vc(i){var l=i.stateNode,p=i.memoizedProps;try{for(var b=i.type,D=l.attributes;D.length;)l.removeAttributeNode(D[0]);ls(l,b,p),l[Rr]=i,l[Jn]=p}catch(P){go(i,i.return,P)}}var jl=!1,Fa=!1,_1=!1,Lv=typeof WeakSet=="function"?WeakSet:Set,ss=null;function FS(i,l){if(i=i.containerInfo,bf=Qr,i=Kp(i),rh(i)){if("selectionStart"in i)var p={start:i.selectionStart,end:i.selectionEnd};else e:{p=(p=i.ownerDocument)&&p.defaultView||window;var b=p.getSelection&&p.getSelection();if(b&&b.rangeCount!==0){p=b.anchorNode;var D=b.anchorOffset,P=b.focusNode;b=b.focusOffset;try{p.nodeType,P.nodeType}catch{p=null;break e}var q=0,ge=-1,Le=-1,ct=0,Dt=0,It=i,ht=null;t:for(;;){for(var Ct;It!==p||D!==0&&It.nodeType!==3||(ge=q+D),It!==P||b!==0&&It.nodeType!==3||(Le=q+b),It.nodeType===3&&(q+=It.nodeValue.length),(Ct=It.firstChild)!==null;)ht=It,It=Ct;for(;;){if(It===i)break t;if(ht===p&&++ct===D&&(ge=q),ht===P&&++Dt===b&&(Le=q),(Ct=It.nextSibling)!==null)break;It=ht,ht=It.parentNode}It=Ct}p=ge===-1||Le===-1?null:{start:ge,end:Le}}else p=null}p=p||{start:0,end:0}}else p=null;for(sm={focusedElem:i,selectionRange:p},Qr=!1,ss=l;ss!==null;)if(l=ss,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,ss=i;else for(;ss!==null;){switch(l=ss,P=l.alternate,i=l.flags,l.tag){case 0:if((i&4)!==0&&(i=l.updateQueue,i=i!==null?i.events:null,i!==null))for(p=0;p<i.length;p++)D=i[p],D.ref.impl=D.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&P!==null){i=void 0,p=l,D=P.memoizedProps,P=P.memoizedState,b=p.stateNode;try{var Bn=nu(p.type,D);i=b.getSnapshotBeforeUpdate(Bn,P),b.__reactInternalSnapshotBeforeUpdate=i}catch(mr){go(p,p.return,mr)}}break;case 3:if((i&1024)!==0){if(i=l.stateNode.containerInfo,p=i.nodeType,p===9)dm(i);else if(p===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":dm(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=l.sibling,i!==null){i.return=l.return,ss=i;break}ss=l.return}}function Bv(i,l,p){var b=p.flags;switch(p.tag){case 0:case 11:case 15:Ll(i,p),b&4&&Ph(5,p);break;case 1:if(Ll(i,p),b&4)if(i=p.stateNode,l===null)try{i.componentDidMount()}catch(q){go(p,p.return,q)}else{var D=nu(p.type,l.memoizedProps);l=l.memoizedState;try{i.componentDidUpdate(D,l,i.__reactInternalSnapshotBeforeUpdate)}catch(q){go(p,p.return,q)}}b&64&&M1(p),b&512&&af(p,p.return);break;case 3:if(Ll(i,p),b&64&&(i=p.updateQueue,i!==null)){if(l=null,p.child!==null)switch(p.child.tag){case 27:case 5:l=p.child.stateNode;break;case 1:l=p.child.stateNode}try{m0(i,l)}catch(q){go(p,p.return,q)}}break;case 27:l===null&&b&4&&vc(p);case 26:case 5:Ll(i,p),l===null&&b&4&&sf(p),b&512&&af(p,p.return);break;case 12:Ll(i,p);break;case 31:Ll(i,p),b&4&&j0(i,p);break;case 13:Ll(i,p),b&4&&$v(i,p),b&64&&(i=p.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(p=ax.bind(null,p),oy(i,p))));break;case 22:if(b=p.memoizedState!==null||jl,!b){l=l!==null&&l.memoizedState!==null||Fa,D=jl;var P=Fa;jl=b,(Fa=l)&&!P?Cc(i,p,(p.subtreeFlags&8772)!==0):Ll(i,p),jl=D,Fa=P}break;case 30:break;default:Ll(i,p)}}function zv(i){var l=i.alternate;l!==null&&(i.alternate=null,zv(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&Dn(l)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var qo=null,Ys=!1;function xc(i,l,p){for(p=p.child;p!==null;)Uv(i,l,p),p=p.sibling}function Uv(i,l,p){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Kt,p)}catch{}switch(p.tag){case 26:Fa||zi(p,l),xc(i,l,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Fa||zi(p,l);var b=qo,D=Ys;Dc(p.type)&&(qo=p.stateNode,Ys=!1),xc(i,l,p),c(p.stateNode),qo=b,Ys=D;break;case 5:Fa||zi(p,l);case 6:if(b=qo,D=Ys,qo=null,xc(i,l,p),qo=b,Ys=D,qo!==null)if(Ys)try{(qo.nodeType===9?qo.body:qo.nodeName==="HTML"?qo.ownerDocument.body:qo).removeChild(p.stateNode)}catch(P){go(p,l,P)}else try{qo.removeChild(p.stateNode)}catch(P){go(p,l,P)}break;case 18:qo!==null&&(Ys?(i=qo,um(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,p.stateNode),Gn(i)):um(qo,p.stateNode));break;case 4:b=qo,D=Ys,qo=p.stateNode.containerInfo,Ys=!0,xc(i,l,p),qo=b,Ys=D;break;case 0:case 11:case 14:case 15:ou(2,p,l),Fa||ou(4,p,l),xc(i,l,p);break;case 1:Fa||(zi(p,l),b=p.stateNode,typeof b.componentWillUnmount=="function"&&jv(p,l,b)),xc(i,l,p);break;case 21:xc(i,l,p);break;case 22:Fa=(b=Fa)||p.memoizedState!==null,xc(i,l,p),Fa=b;break;default:xc(i,l,p)}}function j0(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Gn(i)}catch(p){go(l,l.return,p)}}}function $v(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Gn(i)}catch(p){go(l,l.return,p)}}function NS(i){switch(i.tag){case 31:case 13:case 19:var l=i.stateNode;return l===null&&(l=i.stateNode=new Lv),l;case 22:return i=i.stateNode,l=i._retryCache,l===null&&(l=i._retryCache=new Lv),l;default:throw Error(a(435,i.tag))}}function L0(i,l){var p=NS(i);l.forEach(function(b){if(!p.has(b)){p.add(b);var D=sx.bind(null,i,b);b.then(D,D)}})}function Ms(i,l){var p=l.deletions;if(p!==null)for(var b=0;b<p.length;b++){var D=p[b],P=i,q=l,ge=q;e:for(;ge!==null;){switch(ge.tag){case 27:if(Dc(ge.type)){qo=ge.stateNode,Ys=!1;break e}break;case 5:qo=ge.stateNode,Ys=!1;break e;case 3:case 4:qo=ge.stateNode.containerInfo,Ys=!0;break e}ge=ge.return}if(qo===null)throw Error(a(160));Uv(P,q,D),qo=null,Ys=!1,P=D.alternate,P!==null&&(P.return=null),D.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)O1(l,i),l=l.sibling}var Ui=null;function O1(i,l){var p=i.alternate,b=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Ms(l,i),_s(i),b&4&&(ou(3,i,i.return),Ph(3,i),ou(5,i,i.return));break;case 1:Ms(l,i),_s(i),b&512&&(Fa||p===null||zi(p,p.return)),b&64&&jl&&(i=i.updateQueue,i!==null&&(b=i.callbacks,b!==null&&(p=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=p===null?b:p.concat(b))));break;case 26:var D=Ui;if(Ms(l,i),_s(i),b&512&&(Fa||p===null||zi(p,p.return)),b&4){var P=p!==null?p.memoizedState:null;if(b=i.memoizedState,p===null)if(b===null)if(i.stateNode===null){e:{b=i.type,p=i.memoizedProps,D=D.ownerDocument||D;t:switch(b){case"title":P=D.getElementsByTagName("title")[0],(!P||P[Tt]||P[Rr]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=D.createElement(b),D.head.insertBefore(P,D.querySelector("head > title"))),ls(P,b,p),P[Rr]=i,Zr(P),b=P;break e;case"link":var q=Qt("link","href",D).get(b+(p.href||""));if(q){for(var ge=0;ge<q.length;ge++)if(P=q[ge],P.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&P.getAttribute("rel")===(p.rel==null?null:p.rel)&&P.getAttribute("title")===(p.title==null?null:p.title)&&P.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){q.splice(ge,1);break t}}P=D.createElement(b),ls(P,b,p),D.head.appendChild(P);break;case"meta":if(q=Qt("meta","content",D).get(b+(p.content||""))){for(ge=0;ge<q.length;ge++)if(P=q[ge],P.getAttribute("content")===(p.content==null?null:""+p.content)&&P.getAttribute("name")===(p.name==null?null:p.name)&&P.getAttribute("property")===(p.property==null?null:p.property)&&P.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&P.getAttribute("charset")===(p.charSet==null?null:p.charSet)){q.splice(ge,1);break t}}P=D.createElement(b),ls(P,b,p),D.head.appendChild(P);break;default:throw Error(a(468,b))}P[Rr]=i,Zr(P),b=P}i.stateNode=b}else Tn(D,i.type,i.stateNode);else i.stateNode=et(D,b,i.memoizedProps);else P!==b?(P===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):P.count--,b===null?Tn(D,i.type,i.stateNode):et(D,b,i.memoizedProps)):b===null&&i.stateNode!==null&&au(i,i.memoizedProps,p.memoizedProps)}break;case 27:Ms(l,i),_s(i),b&512&&(Fa||p===null||zi(p,p.return)),p!==null&&b&4&&au(i,i.memoizedProps,p.memoizedProps);break;case 5:if(Ms(l,i),_s(i),b&512&&(Fa||p===null||zi(p,p.return)),i.flags&32){D=i.stateNode;try{Fu(D,"")}catch(Bn){go(i,i.return,Bn)}}b&4&&i.stateNode!=null&&(D=i.memoizedProps,au(i,D,p!==null?p.memoizedProps:D)),b&1024&&(_1=!0);break;case 6:if(Ms(l,i),_s(i),b&4){if(i.stateNode===null)throw Error(a(162));b=i.memoizedProps,p=i.stateNode;try{p.nodeValue=b}catch(Bn){go(i,i.return,Bn)}}break;case 3:if(bt=null,D=Ui,Ui=g(l.containerInfo),Ms(l,i),Ui=D,_s(i),b&4&&p!==null&&p.memoizedState.isDehydrated)try{Gn(l.containerInfo)}catch(Bn){go(i,i.return,Bn)}_1&&(_1=!1,F1(i));break;case 4:b=Ui,Ui=g(i.stateNode.containerInfo),Ms(l,i),_s(i),Ui=b;break;case 12:Ms(l,i),_s(i);break;case 31:Ms(l,i),_s(i),b&4&&(b=i.updateQueue,b!==null&&(i.updateQueue=null,L0(i,b)));break;case 13:Ms(l,i),_s(i),i.child.flags&8192&&i.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(H0=Me()),b&4&&(b=i.updateQueue,b!==null&&(i.updateQueue=null,L0(i,b)));break;case 22:D=i.memoizedState!==null;var Le=p!==null&&p.memoizedState!==null,ct=jl,Dt=Fa;if(jl=ct||D,Fa=Dt||Le,Ms(l,i),Fa=Dt,jl=ct,_s(i),b&8192)e:for(l=i.stateNode,l._visibility=D?l._visibility&-2:l._visibility|1,D&&(p===null||Le||jl||Fa||su(i)),p=null,l=i;;){if(l.tag===5||l.tag===26){if(p===null){Le=p=l;try{if(P=Le.stateNode,D)q=P.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{ge=Le.stateNode;var It=Le.memoizedProps.style,ht=It!=null&&It.hasOwnProperty("display")?It.display:null;ge.style.display=ht==null||typeof ht=="boolean"?"":(""+ht).trim()}}catch(Bn){go(Le,Le.return,Bn)}}}else if(l.tag===6){if(p===null){Le=l;try{Le.stateNode.nodeValue=D?"":Le.memoizedProps}catch(Bn){go(Le,Le.return,Bn)}}}else if(l.tag===18){if(p===null){Le=l;try{var Ct=Le.stateNode;D?ny(Ct,!0):ny(Le.stateNode,!1)}catch(Bn){go(Le,Le.return,Bn)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===i)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break e;for(;l.sibling===null;){if(l.return===null||l.return===i)break e;p===l&&(p=null),l=l.return}p===l&&(p=null),l.sibling.return=l.return,l=l.sibling}b&4&&(b=i.updateQueue,b!==null&&(p=b.retryQueue,p!==null&&(b.retryQueue=null,L0(i,p))));break;case 19:Ms(l,i),_s(i),b&4&&(b=i.updateQueue,b!==null&&(i.updateQueue=null,L0(i,b)));break;case 30:break;case 21:break;default:Ms(l,i),_s(i)}}function _s(i){var l=i.flags;if(l&2){try{for(var p,b=i.return;b!==null;){if(lf(b)){p=b;break}b=b.return}if(p==null)throw Error(a(160));switch(p.tag){case 27:var D=p.stateNode,P=Mh(i);Nl(i,P,D);break;case 5:var q=p.stateNode;p.flags&32&&(Fu(q,""),p.flags&=-33);var ge=Mh(i);Nl(i,ge,q);break;case 3:case 4:var Le=p.stateNode.containerInfo,ct=Mh(i);cf(i,ct,Le);break;default:throw Error(a(161))}}catch(Dt){go(i,i.return,Dt)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function F1(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var l=i;F1(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),i=i.sibling}}function Ll(i,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Bv(i,l.alternate,l),l=l.sibling}function su(i){for(i=i.child;i!==null;){var l=i;switch(l.tag){case 0:case 11:case 14:case 15:ou(4,l,l.return),su(l);break;case 1:zi(l,l.return);var p=l.stateNode;typeof p.componentWillUnmount=="function"&&jv(l,l.return,p),su(l);break;case 27:c(l.stateNode);case 26:case 5:zi(l,l.return),su(l);break;case 22:l.memoizedState===null&&su(l);break;case 30:su(l);break;default:su(l)}i=i.sibling}}function Cc(i,l,p){for(p=p&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var b=l.alternate,D=i,P=l,q=P.flags;switch(P.tag){case 0:case 11:case 15:Cc(D,P,p),Ph(4,P);break;case 1:if(Cc(D,P,p),b=P,D=b.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(ct){go(b,b.return,ct)}if(b=P,D=b.updateQueue,D!==null){var ge=b.stateNode;try{var Le=D.shared.hiddenCallbacks;if(Le!==null)for(D.shared.hiddenCallbacks=null,D=0;D<Le.length;D++)Qg(Le[D],ge)}catch(ct){go(b,b.return,ct)}}p&&q&64&&M1(P),af(P,P.return);break;case 27:vc(P);case 26:case 5:Cc(D,P,p),p&&b===null&&q&4&&sf(P),af(P,P.return);break;case 12:Cc(D,P,p);break;case 31:Cc(D,P,p),p&&q&4&&j0(D,P);break;case 13:Cc(D,P,p),p&&q&4&&$v(D,P);break;case 22:P.memoizedState===null&&Cc(D,P,p),af(P,P.return);break;case 30:break;default:Cc(D,P,p)}l=l.sibling}}function N1(i,l){var p=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(p=i.memoizedState.cachePool.pool),i=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(i=l.memoizedState.cachePool.pool),i!==p&&(i!=null&&i.refCount++,p!=null&&Gu(p))}function B0(i,l){i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&Gu(i))}function hl(i,l,p,b){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)_h(i,l,p,b),l=l.sibling}function _h(i,l,p,b){var D=l.flags;switch(l.tag){case 0:case 11:case 15:hl(i,l,p,b),D&2048&&Ph(9,l);break;case 1:hl(i,l,p,b);break;case 3:hl(i,l,p,b),D&2048&&(i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&Gu(i)));break;case 12:if(D&2048){hl(i,l,p,b),i=l.stateNode;try{var P=l.memoizedProps,q=P.id,ge=P.onPostCommit;typeof ge=="function"&&ge(q,l.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Le){go(l,l.return,Le)}}else hl(i,l,p,b);break;case 31:hl(i,l,p,b);break;case 13:hl(i,l,p,b);break;case 23:break;case 22:P=l.stateNode,q=l.alternate,l.memoizedState!==null?P._visibility&2?hl(i,l,p,b):df(i,l):P._visibility&2?hl(i,l,p,b):(P._visibility|=2,uf(i,l,p,b,(l.subtreeFlags&10256)!==0||!1)),D&2048&&N1(q,l);break;case 24:hl(i,l,p,b),D&2048&&B0(l.alternate,l);break;default:hl(i,l,p,b)}}function uf(i,l,p,b,D){for(D=D&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var P=i,q=l,ge=p,Le=b,ct=q.flags;switch(q.tag){case 0:case 11:case 15:uf(P,q,ge,Le,D),Ph(8,q);break;case 23:break;case 22:var Dt=q.stateNode;q.memoizedState!==null?Dt._visibility&2?uf(P,q,ge,Le,D):df(P,q):(Dt._visibility|=2,uf(P,q,ge,Le,D)),D&&ct&2048&&N1(q.alternate,q);break;case 24:uf(P,q,ge,Le,D),D&&ct&2048&&B0(q.alternate,q);break;default:uf(P,q,ge,Le,D)}l=l.sibling}}function df(i,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var p=i,b=l,D=b.flags;switch(b.tag){case 22:df(p,b),D&2048&&N1(b.alternate,b);break;case 24:df(p,b),D&2048&&B0(b.alternate,b);break;default:df(p,b)}l=l.sibling}}var Bl=8192;function ff(i,l,p){if(i.subtreeFlags&Bl)for(i=i.child;i!==null;)j1(i,l,p),i=i.sibling}function j1(i,l,p){switch(i.tag){case 26:ff(i,l,p),i.flags&Bl&&i.memoizedState!==null&&dn(p,Ui,i.memoizedState,i.memoizedProps);break;case 5:ff(i,l,p);break;case 3:case 4:var b=Ui;Ui=g(i.stateNode.containerInfo),ff(i,l,p),Ui=b;break;case 22:i.memoizedState===null&&(b=i.alternate,b!==null&&b.memoizedState!==null?(b=Bl,Bl=16777216,ff(i,l,p),Bl=b):ff(i,l,p));break;default:ff(i,l,p)}}function Hv(i){var l=i.alternate;if(l!==null&&(i=l.child,i!==null)){l.child=null;do l=i.sibling,i.sibling=null,i=l;while(i!==null)}}function Oh(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var b=l[p];ss=b,Vv(b,i)}Hv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Wv(i),i=i.sibling}function Wv(i){switch(i.tag){case 0:case 11:case 15:Oh(i),i.flags&2048&&ou(9,i,i.return);break;case 3:Oh(i);break;case 12:Oh(i);break;case 22:var l=i.stateNode;i.memoizedState!==null&&l._visibility&2&&(i.return===null||i.return.tag!==13)?(l._visibility&=-3,z0(i)):Oh(i);break;default:Oh(i)}}function z0(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var b=l[p];ss=b,Vv(b,i)}Hv(i)}for(i=i.child;i!==null;){switch(l=i,l.tag){case 0:case 11:case 15:ou(8,l,l.return),z0(l);break;case 22:p=l.stateNode,p._visibility&2&&(p._visibility&=-3,z0(l));break;default:z0(l)}i=i.sibling}}function Vv(i,l){for(;ss!==null;){var p=ss;switch(p.tag){case 0:case 11:case 15:ou(8,p,l);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var b=p.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:Gu(p.memoizedState.cache)}if(b=p.child,b!==null)b.return=p,ss=b;else e:for(p=i;ss!==null;){b=ss;var D=b.sibling,P=b.return;if(zv(b),b===p){ss=null;break e}if(D!==null){D.return=P,ss=D;break e}ss=P}}}var jS={getCacheForType:function(i){var l=Pa(Ma),p=l.data.get(i);return p===void 0&&(p=i(),l.data.set(i,p)),p},cacheSignal:function(){return Pa(Ma).controller.signal}},LS=typeof WeakMap=="function"?WeakMap:Map,uo=0,Oo=null,Nr=null,Kr=0,Co=0,gi=null,Sc=!1,sd=!1,U0=!1,wc=0,la=0,Tc=0,id=0,$0=0,yi=0,hf=0,Fh=null,qs=null,L1=!1,H0=0,Gv=0,W0=1/0,V0=null,iu=null,Ga=0,lu=null,pf=null,bi=0,G0=0,K0=null,$i=null,Nh=0,jh=null;function Os(){return(uo&2)!==0&&Kr!==0?Kr&-Kr:se.T!==null?Br():Qn()}function Kv(){if(yi===0)if((Kr&536870912)===0||Gr){var i=Sn;Sn<<=1,(Sn&3932160)===0&&(Sn=262144),yi=i}else yi=536870912;return i=pi.current,i!==null&&(i.flags|=32),yi}function Fs(i,l,p){(i===Oo&&(Co===2||Co===9)||i.cancelPendingCommit!==null)&&(Ns(i,0),cu(i,Kr,yi,!1)),en(i,p),((uo&2)===0||i!==Oo)&&(i===Oo&&((uo&2)===0&&(id|=p),la===4&&cu(i,Kr,yi,!1)),is(i))}function Yv(i,l,p){if((uo&6)!==0)throw Error(a(327));var b=!p&&(l&127)===0&&(l&i.expiredLanes)===0||Cr(i,l),D=b?vn(i,l):ld(i,l,!0),P=b;do{if(D===0){sd&&!b&&cu(i,l,0,!1);break}else{if(p=i.current.alternate,P&&!BS(p)){D=ld(i,l,!1),P=!1;continue}if(D===2){if(P=l,i.errorRecoveryDisabledLanes&P)var q=0;else q=i.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){l=q;e:{var ge=i;D=Fh;var Le=ge.current.memoizedState.isDehydrated;if(Le&&(Ns(ge,q).flags|=256),q=ld(ge,q,!1),q!==2){if(U0&&!Le){ge.errorRecoveryDisabledLanes|=P,id|=P,D=4;break e}P=qs,qs=D,P!==null&&(qs===null?qs=P:qs.push.apply(qs,P))}D=q}if(P=!1,D!==2)continue}}if(D===1){Ns(i,0),cu(i,l,0,!0);break}e:{switch(b=i,P=D,P){case 0:case 1:throw Error(a(345));case 4:if((l&4194048)!==l)break;case 6:cu(b,l,yi,!Sc);break e;case 2:qs=null;break;case 3:case 5:break;default:throw Error(a(329))}if((l&62914560)===l&&(D=H0+300-Me(),10<D)){if(cu(b,l,yi,!Sc),$t(b,0,!0)!==0)break e;bi=l,b.timeoutHandle=lm(qv.bind(null,b,p,qs,V0,L1,l,yi,id,hf,Sc,P,"Throttled",-0,0),D);break e}qv(b,p,qs,V0,L1,l,yi,id,hf,Sc,P,null,-0,0)}}break}while(!0);is(i)}function qv(i,l,p,b,D,P,q,ge,Le,ct,Dt,It,ht,Ct){if(i.timeoutHandle=-1,It=l.subtreeFlags,It&8192||(It&16785408)===16785408){It={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_i},j1(l,P,It);var Bn=(P&62914560)===P?H0-Me():(P&4194048)===P?Gv-Me():0;if(Bn=Vt(It,Bn),Bn!==null){bi=P,i.cancelPendingCommit=Bn(ex.bind(null,i,l,P,p,b,D,q,ge,Le,Dt,It,null,ht,Ct)),cu(i,P,q,!ct);return}}ex(i,l,P,p,b,D,q,ge,Le)}function BS(i){for(var l=i;;){var p=l.tag;if((p===0||p===11||p===15)&&l.flags&16384&&(p=l.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var b=0;b<p.length;b++){var D=p[b],P=D.getSnapshot;D=D.value;try{if(!li(P(),D))return!1}catch{return!1}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function cu(i,l,p,b){l&=~$0,l&=~id,i.suspendedLanes|=l,i.pingedLanes&=~l,b&&(i.warmLanes|=l),b=i.expirationTimes;for(var D=l;0<D;){var P=31-_t(D),q=1<<P;b[P]=-1,D&=~q}p!==0&&Yn(i,p,l)}function Y0(){return(uo&6)===0?(ud(0),!1):!0}function B1(){if(Nr!==null){if(Co===0)var i=Nr.return;else i=Nr,dc=qc=null,mh(i),fc=null,Gd=0,i=Nr;for(;i!==null;)Nv(i.alternate,i),i=i.return;Nr=null}}function Ns(i,l){var p=i.timeoutHandle;p!==-1&&(i.timeoutHandle=-1,dx(p)),p=i.cancelPendingCommit,p!==null&&(i.cancelPendingCommit=null,p()),bi=0,B1(),Oo=i,Nr=p=Rl(i.current,null),Kr=l,Co=0,gi=null,Sc=!1,sd=Cr(i,l),U0=!1,hf=yi=$0=id=Tc=la=0,qs=Fh=null,L1=!1,(l&8)!==0&&(l|=l&32);var b=i.entangledLanes;if(b!==0)for(i=i.entanglements,b&=l;0<b;){var D=31-_t(b),P=1<<D;l|=i[D],b&=~P}return wc=l,wr(),p}function Lh(i,l){Ar=null,se.H=Ah,l===Vd||l===c0?(l=d0(),Co=3):l===l0?(l=d0(),Co=4):Co=l===w1?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,gi=l,Nr===null&&(la=1,R0(i,ui(l,i.current)))}function Qv(){var i=pi.current;return i===null?!0:(Kr&4194048)===Kr?mi===null:(Kr&62914560)===Kr||(Kr&536870912)!==0?i===mi:!1}function mf(){var i=se.H;return se.H=Ah,i===null?Ah:i}function Bh(){var i=se.A;return se.A=jS,i}function q0(){la=4,Sc||(Kr&4194048)!==Kr&&pi.current!==null||(sd=!0),(Tc&134217727)===0&&(id&134217727)===0||Oo===null||cu(Oo,Kr,yi,!1)}function ld(i,l,p){var b=uo;uo|=2;var D=mf(),P=Bh();(Oo!==i||Kr!==l)&&(V0=null,Ns(i,l)),l=!1;var q=la;e:do try{if(Co!==0&&Nr!==null){var ge=Nr,Le=gi;switch(Co){case 8:B1(),q=6;break e;case 3:case 2:case 9:case 6:pi.current===null&&(l=!0);var ct=Co;if(Co=0,gi=null,gf(i,ge,Le,ct),p&&sd){q=0;break e}break;default:ct=Co,Co=0,gi=null,gf(i,ge,Le,ct)}}z1(),q=la;break}catch(Dt){Lh(i,Dt)}while(!0);return l&&i.shellSuspendCounter++,dc=qc=null,uo=b,se.H=D,se.A=P,Nr===null&&(Oo=null,Kr=0,wr()),q}function z1(){for(;Nr!==null;)Xv(Nr)}function vn(i,l){var p=uo;uo|=2;var b=mf(),D=Bh();Oo!==i||Kr!==l?(V0=null,W0=Me()+500,Ns(i,l)):sd=Cr(i,l);e:do try{if(Co!==0&&Nr!==null){l=Nr;var P=gi;t:switch(Co){case 1:Co=0,gi=null,gf(i,l,P,1);break;case 2:case 9:if(Gg(P)){Co=0,gi=null,Jv(l);break}l=function(){Co!==2&&Co!==9||Oo!==i||(Co=7),is(i)},P.then(l,l);break e;case 3:Co=7;break e;case 4:Co=5;break e;case 7:Gg(P)?(Co=0,gi=null,Jv(l)):(Co=0,gi=null,gf(i,l,P,7));break;case 5:var q=null;switch(Nr.tag){case 26:q=Nr.memoizedState;case 5:case 27:var ge=Nr;if(q?sn(q):ge.stateNode.complete){Co=0,gi=null;var Le=ge.sibling;if(Le!==null)Nr=Le;else{var ct=ge.return;ct!==null?(Nr=ct,Q0(ct)):Nr=null}break t}}Co=0,gi=null,gf(i,l,P,5);break;case 6:Co=0,gi=null,gf(i,l,P,6);break;case 8:B1(),la=6;break e;default:throw Error(a(462))}}zh();break}catch(Dt){Lh(i,Dt)}while(!0);return dc=qc=null,se.H=b,se.A=D,uo=p,Nr!==null?0:(Oo=null,Kr=0,wr(),la)}function zh(){for(;Nr!==null&&!xe();)Xv(Nr)}function Xv(i){var l=Fv(i.alternate,i,wc);i.memoizedProps=i.pendingProps,l===null?Q0(i):Nr=l}function Jv(i){var l=i,p=l.alternate;switch(l.tag){case 15:case 0:l=E1(p,l,l.pendingProps,l.type,void 0,Kr);break;case 11:l=E1(p,l,l.pendingProps,l.type.render,l.ref,Kr);break;case 5:mh(l);default:Nv(p,l),l=Nr=Zp(l,wc),l=Fv(p,l,wc)}i.memoizedProps=i.pendingProps,l===null?Q0(i):Nr=l}function gf(i,l,p,b){dc=qc=null,mh(l),fc=null,Gd=0;var D=l.return;try{if(Pv(i,D,l,p,Kr)){la=1,R0(i,ui(p,i.current)),Nr=null;return}}catch(P){if(D!==null)throw Nr=D,P;la=1,R0(i,ui(p,i.current)),Nr=null;return}l.flags&32768?(Gr||b===1?i=!0:sd||(Kr&536870912)!==0?i=!1:(Sc=i=!0,(b===2||b===9||b===3||b===6)&&(b=pi.current,b!==null&&b.tag===13&&(b.flags|=16384))),Zv(l,i)):Q0(l)}function Q0(i){var l=i;do{if((l.flags&32768)!==0){Zv(l,Sc);return}i=l.return;var p=OS(l.alternate,l,wc);if(p!==null){Nr=p;return}if(l=l.sibling,l!==null){Nr=l;return}Nr=l=i}while(l!==null);la===0&&(la=5)}function Zv(i,l){do{var p=N0(i.alternate,i);if(p!==null){p.flags&=32767,Nr=p;return}if(p=i.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!l&&(i=i.sibling,i!==null)){Nr=i;return}Nr=i=p}while(i!==null);la=6,Nr=null}function ex(i,l,p,b,D,P,q,ge,Le){i.cancelPendingCommit=null;do Uh();while(Ga!==0);if((uo&6)!==0)throw Error(a(327));if(l!==null){if(l===i.current)throw Error(a(177));if(P=l.lanes|l.childLanes,P|=Xp,un(i,p,P,q,ge,Le),i===Oo&&(Nr=Oo=null,Kr=0),pf=l,lu=i,bi=p,G0=P,K0=D,$i=b,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,ix(st,function(){return $1(),null})):(i.callbackNode=null,i.callbackPriority=0),b=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||b){b=se.T,se.T=null,D=ye.p,ye.p=2,q=uo,uo|=4;try{FS(i,l,p)}finally{uo=q,ye.p=D,se.T=b}}Ga=1,tx(),nx(),rx()}}function tx(){if(Ga===1){Ga=0;var i=lu,l=pf,p=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||p){p=se.T,se.T=null;var b=ye.p;ye.p=2;var D=uo;uo|=4;try{O1(l,i);var P=sm,q=Kp(i.containerInfo),ge=P.focusedElem,Le=P.selectionRange;if(q!==ge&&ge&&ge.ownerDocument&&Xb(ge.ownerDocument.documentElement,ge)){if(Le!==null&&rh(ge)){var ct=Le.start,Dt=Le.end;if(Dt===void 0&&(Dt=ct),"selectionStart"in ge)ge.selectionStart=ct,ge.selectionEnd=Math.min(Dt,ge.value.length);else{var It=ge.ownerDocument||document,ht=It&&It.defaultView||window;if(ht.getSelection){var Ct=ht.getSelection(),Bn=ge.textContent.length,mr=Math.min(Le.start,Bn),$o=Le.end===void 0?mr:Math.min(Le.end,Bn);!Ct.extend&&mr>$o&&(q=$o,$o=mr,mr=q);var lt=nh(ge,mr),Ze=nh(ge,$o);if(lt&&Ze&&(Ct.rangeCount!==1||Ct.anchorNode!==lt.node||Ct.anchorOffset!==lt.offset||Ct.focusNode!==Ze.node||Ct.focusOffset!==Ze.offset)){var gt=It.createRange();gt.setStart(lt.node,lt.offset),Ct.removeAllRanges(),mr>$o?(Ct.addRange(gt),Ct.extend(Ze.node,Ze.offset)):(gt.setEnd(Ze.node,Ze.offset),Ct.addRange(gt))}}}}for(It=[],Ct=ge;Ct=Ct.parentNode;)Ct.nodeType===1&&It.push({element:Ct,left:Ct.scrollLeft,top:Ct.scrollTop});for(typeof ge.focus=="function"&&ge.focus(),ge=0;ge<It.length;ge++){var Lt=It[ge];Lt.element.scrollLeft=Lt.left,Lt.element.scrollTop=Lt.top}}Qr=!!bf,sm=bf=null}finally{uo=D,ye.p=b,se.T=p}}i.current=l,Ga=2}}function nx(){if(Ga===2){Ga=0;var i=lu,l=pf,p=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||p){p=se.T,se.T=null;var b=ye.p;ye.p=2;var D=uo;uo|=4;try{Bv(i,l.alternate,l)}finally{uo=D,ye.p=b,se.T=p}}Ga=3}}function rx(){if(Ga===4||Ga===3){Ga=0,Ne();var i=lu,l=pf,p=bi,b=$i;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Ga=5:(Ga=0,pf=lu=null,U1(i,i.pendingLanes));var D=i.pendingLanes;if(D===0&&(iu=null),xo(p),l=l.stateNode,tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Kt,l,void 0,(l.current.flags&128)===128)}catch{}if(b!==null){l=se.T,D=ye.p,ye.p=2,se.T=null;try{for(var P=i.onRecoverableError,q=0;q<b.length;q++){var ge=b[q];P(ge.value,{componentStack:ge.stack})}}finally{se.T=l,ye.p=D}}(bi&3)!==0&&Uh(),is(i),D=i.pendingLanes,(p&261930)!==0&&(D&42)!==0?i===jh?Nh++:(Nh=0,jh=i):Nh=0,ud(0)}}function U1(i,l){(i.pooledCacheLanes&=l)===0&&(l=i.pooledCache,l!=null&&(i.pooledCache=null,Gu(l)))}function Uh(){return tx(),nx(),rx(),$1()}function $1(){if(Ga!==5)return!1;var i=lu,l=G0;G0=0;var p=xo(bi),b=se.T,D=ye.p;try{ye.p=32>p?32:p,se.T=null,p=K0,K0=null;var P=lu,q=bi;if(Ga=0,pf=lu=null,bi=0,(uo&6)!==0)throw Error(a(331));var ge=uo;if(uo|=4,Wv(P.current),_h(P,P.current,q,p),uo=ge,ud(0,!1),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Kt,P)}catch{}return!0}finally{ye.p=D,se.T=b,U1(i,l)}}function H1(i,l,p){l=ui(p,l),l=ru(i.stateNode,l,2),i=hc(i,l,2),i!==null&&(en(i,2),is(i))}function go(i,l,p){if(i.tag===3)H1(i,i,p);else for(;l!==null;){if(l.tag===3){H1(l,i,p);break}else if(l.tag===1){var b=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(iu===null||!iu.has(b))){i=ui(p,i),p=C1(2),b=hc(l,p,2),b!==null&&(S1(p,b,l,i),en(b,2),is(b));break}}l=l.return}}function X0(i,l,p){var b=i.pingCache;if(b===null){b=i.pingCache=new LS;var D=new Set;b.set(l,D)}else D=b.get(l),D===void 0&&(D=new Set,b.set(l,D));D.has(p)||(U0=!0,D.add(p),i=ox.bind(null,i,l,p),l.then(i,i))}function ox(i,l,p){var b=i.pingCache;b!==null&&b.delete(l),i.pingedLanes|=i.suspendedLanes&p,i.warmLanes&=~p,Oo===i&&(Kr&p)===p&&(la===4||la===3&&(Kr&62914560)===Kr&&300>Me()-H0?(uo&2)===0&&Ns(i,0):$0|=p,hf===Kr&&(hf=0)),is(i)}function W1(i,l){l===0&&(l=Bt()),i=Li(i,l),i!==null&&(en(i,l),is(i))}function ax(i){var l=i.memoizedState,p=0;l!==null&&(p=l.retryLane),W1(i,p)}function sx(i,l){var p=0;switch(i.tag){case 31:case 13:var b=i.stateNode,D=i.memoizedState;D!==null&&(p=D.retryLane);break;case 19:b=i.stateNode;break;case 22:b=i.stateNode._retryCache;break;default:throw Error(a(314))}b!==null&&b.delete(l),W1(i,p)}function ix(i,l){return J(i,l)}var $h=null,cd=null,J0=!1,Z0=!1,em=!1,Ac=0;function is(i){i!==cd&&i.next===null&&(cd===null?$h=cd=i:cd=cd.next=i),Z0=!0,J0||(J0=!0,na())}function ud(i,l){if(!em&&Z0){em=!0;do for(var p=!1,b=$h;b!==null;){if(i!==0){var D=b.pendingLanes;if(D===0)var P=0;else{var q=b.suspendedLanes,ge=b.pingedLanes;P=(1<<31-_t(42|i)+1)-1,P&=D&~(q&~ge),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(p=!0,eo(b,P))}else P=Kr,P=$t(b,b===Oo?P:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(P&3)===0||Cr(b,P)||(p=!0,eo(b,P));b=b.next}while(p);em=!1}}function lx(){Ec()}function Ec(){Z0=J0=!1;var i=0;Ac!==0&&im()&&(i=Ac);for(var l=Me(),p=null,b=$h;b!==null;){var D=b.next,P=V1(b,l);P===0?(b.next=null,p===null?$h=D:p.next=D,D===null&&(cd=p)):(p=b,(i!==0||(P&3)!==0)&&(Z0=!0)),b=D}Ga!==0&&Ga!==5||ud(i),Ac!==0&&(Ac=0)}function V1(i,l){for(var p=i.suspendedLanes,b=i.pingedLanes,D=i.expirationTimes,P=i.pendingLanes&-62914561;0<P;){var q=31-_t(P),ge=1<<q,Le=D[q];Le===-1?((ge&p)===0||(ge&b)!==0)&&(D[q]=tr(ge,l)):Le<=l&&(i.expiredLanes|=ge),P&=~ge}if(l=Oo,p=Kr,p=$t(i,i===l?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),b=i.callbackNode,p===0||i===l&&(Co===2||Co===9)||i.cancelPendingCommit!==null)return b!==null&&b!==null&&fe(b),i.callbackNode=null,i.callbackPriority=0;if((p&3)===0||Cr(i,p)){if(l=p&-p,l===i.callbackPriority)return l;switch(b!==null&&fe(b),xo(p)){case 2:case 8:p=rt;break;case 32:p=st;break;case 268435456:p=xt;break;default:p=st}return b=yf.bind(null,i),p=J(p,b),i.callbackPriority=l,i.callbackNode=p,l}return b!==null&&b!==null&&fe(b),i.callbackPriority=2,i.callbackNode=null,2}function yf(i,l){if(Ga!==0&&Ga!==5)return i.callbackNode=null,i.callbackPriority=0,null;var p=i.callbackNode;if(Uh()&&i.callbackNode!==p)return null;var b=Kr;return b=$t(i,i===Oo?b:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),b===0?null:(Yv(i,b,l),V1(i,Me()),i.callbackNode!=null&&i.callbackNode===p?yf.bind(null,i):null)}function eo(i,l){if(Uh())return null;Yv(i,l,!0)}function na(){cm(function(){(uo&6)!==0?J(Qe,lx):Ec()})}function Br(){if(Ac===0){var i=Ku;i===0&&(i=gn,gn<<=1,(gn&261888)===0&&(gn=256)),Ac=i}return Ac}function ra(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Id(""+i)}function tm(i,l){var p=l.ownerDocument.createElement("input");return p.name=l.name,p.value=l.value,i.id&&p.setAttribute("form",i.id),l.parentNode.insertBefore(p,l),i=new FormData(i),p.parentNode.removeChild(p),i}function Hi(i,l,p,b,D){if(l==="submit"&&p&&p.stateNode===D){var P=ra((D[Jn]||null).action),q=b.submitter;q&&(l=(l=q[Jn]||null)?ra(l.formAction):q.getAttribute("formAction"),l!==null&&(P=l,q=null));var ge=new Jf("action","action",null,b,D);i.push({event:ge,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(Ac!==0){var Le=q?tm(D,q):new FormData(D);p1(p,{pending:!0,data:Le,method:D.method,action:P},null,Le)}}else typeof P=="function"&&(ge.preventDefault(),Le=q?tm(D,q):new FormData(D),p1(p,{pending:!0,data:Le,method:D.method,action:P},P,Le))},currentTarget:D}]})}}for(var kc=0;kc<al.length;kc++){var Qs=al[kc],dd=Qs.toLowerCase(),zS=Qs[0].toUpperCase()+Qs.slice(1);ji(dd,"on"+zS)}ji(Ng,"onAnimationEnd"),ji(jg,"onAnimationIteration"),ji(Jb,"onAnimationStart"),ji("dblclick","onDoubleClick"),ji("focusin","onFocus"),ji("focusout","onBlur"),ji(Lg,"onTransitionRun"),ji(Bg,"onTransitionStart"),ji(Zb,"onTransitionCancel"),ji(ev,"onTransitionEnd"),ar("onMouseEnter",["mouseout","mouseover"]),ar("onMouseLeave",["mouseout","mouseover"]),ar("onPointerEnter",["pointerout","pointerover"]),ar("onPointerLeave",["pointerout","pointerover"]),bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bs("onBeforeInput",["compositionend","keypress","textInput","paste"]),bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fd));function cx(i,l){l=(l&4)!==0;for(var p=0;p<i.length;p++){var b=i[p],D=b.event;b=b.listeners;e:{var P=void 0;if(l)for(var q=b.length-1;0<=q;q--){var ge=b[q],Le=ge.instance,ct=ge.currentTarget;if(ge=ge.listener,Le!==P&&D.isPropagationStopped())break e;P=ge,D.currentTarget=ct;try{P(D)}catch(Dt){Ud(Dt)}D.currentTarget=null,P=Le}else for(q=0;q<b.length;q++){if(ge=b[q],Le=ge.instance,ct=ge.currentTarget,ge=ge.listener,Le!==P&&D.isPropagationStopped())break e;P=ge,D.currentTarget=ct;try{P(D)}catch(Dt){Ud(Dt)}D.currentTarget=null,P=Le}}}}function cr(i,l){var p=l[qr];p===void 0&&(p=l[qr]=new Set);var b=i+"__bubble";p.has(b)||(ux(l,i,2,!1),p.add(b))}function nm(i,l,p){var b=0;l&&(b|=4),ux(p,i,b,l)}var rm="_reactListening"+Math.random().toString(36).slice(2);function K1(i){if(!i[rm]){i[rm]=!0,Eo.forEach(function(p){p!=="selectionchange"&&(G1.has(p)||nm(p,!1,i),nm(p,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[rm]||(l[rm]=!0,nm("selectionchange",!1,l))}}function ux(i,l,p,b){switch(Ue(l)){case 2:var D=Ka;break;case 8:D=Wi;break;default:D=De}p=D.bind(null,l,p,i),D=void 0,!Fp||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(D=!0),b?D!==void 0?i.addEventListener(l,p,{capture:!0,passive:D}):i.addEventListener(l,p,!0):D!==void 0?i.addEventListener(l,p,{passive:D}):i.addEventListener(l,p,!1)}function om(i,l,p,b,D){var P=b;if((l&1)===0&&(l&2)===0&&b!==null)e:for(;;){if(b===null)return;var q=b.tag;if(q===3||q===4){var ge=b.stateNode.containerInfo;if(ge===D)break;if(q===4)for(q=b.return;q!==null;){var Le=q.tag;if((Le===3||Le===4)&&q.stateNode.containerInfo===D)return;q=q.return}for(;ge!==null;){if(q=nr(ge),q===null)return;if(Le=q.tag,Le===5||Le===6||Le===26||Le===27){b=P=q;continue e}ge=ge.parentNode}}b=b.return}Vb(function(){var ct=P,Dt=po(p),It=[];e:{var ht=zd.get(i);if(ht!==void 0){var Ct=Jf,Bn=i;switch(i){case"keypress":if(Uc(p)===0)break e;case"keydown":case"keyup":Ct=Nu;break;case"focusin":Bn="focus",Ct=zp;break;case"focusout":Bn="blur",Ct=zp;break;case"beforeblur":case"afterblur":Ct=zp;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ct=Eg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ct=Yb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ct=kS;break;case Ng:case jg:case Jb:Ct=kg;break;case ev:Ct=RS;break;case"scroll":case"scrollend":Ct=Gb;break;case"wheel":Ct=ds;break;case"copy":case"cut":case"paste":Ct=Rg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ct=jd;break;case"toggle":case"beforetoggle":Ct=Mt}var mr=(l&4)!==0,$o=!mr&&(i==="scroll"||i==="scrollend"),lt=mr?ht!==null?ht+"Capture":null:ht;mr=[];for(var Ze=ct,gt;Ze!==null;){var Lt=Ze;if(gt=Lt.stateNode,Lt=Lt.tag,Lt!==5&&Lt!==26&&Lt!==27||gt===null||lt===null||(Lt=Xf(Ze,lt),Lt!=null&&mr.push(Hh(Ze,Lt,gt))),$o)break;Ze=Ze.return}0<mr.length&&(ht=new Ct(ht,Bn,null,p,Dt),It.push({event:ht,listeners:mr}))}}if((l&7)===0){e:{if(ht=i==="mouseover"||i==="pointerover",Ct=i==="mouseout"||i==="pointerout",ht&&p!==Pd&&(Bn=p.relatedTarget||p.fromElement)&&(nr(Bn)||Bn[aa]))break e;if((Ct||ht)&&(ht=Dt.window===Dt?Dt:(ht=Dt.ownerDocument)?ht.defaultView||ht.parentWindow:window,Ct?(Bn=p.relatedTarget||p.toElement,Ct=ct,Bn=Bn?nr(Bn):null,Bn!==null&&($o=n(Bn),mr=Bn.tag,Bn!==$o||mr!==5&&mr!==27&&mr!==6)&&(Bn=null)):(Ct=null,Bn=ct),Ct!==Bn)){if(mr=Eg,Lt="onMouseLeave",lt="onMouseEnter",Ze="mouse",(i==="pointerout"||i==="pointerover")&&(mr=jd,Lt="onPointerLeave",lt="onPointerEnter",Ze="pointer"),$o=Ct==null?ht:Ao(Ct),gt=Bn==null?ht:Ao(Bn),ht=new mr(Lt,Ze+"leave",Ct,p,Dt),ht.target=$o,ht.relatedTarget=gt,Lt=null,nr(Dt)===ct&&(mr=new mr(lt,Ze+"enter",Bn,p,Dt),mr.target=gt,mr.relatedTarget=$o,Lt=mr),$o=Lt,Ct&&Bn)t:{for(mr=Y1,lt=Ct,Ze=Bn,gt=0,Lt=lt;Lt;Lt=mr(Lt))gt++;Lt=0;for(var ur=Ze;ur;ur=mr(ur))Lt++;for(;0<gt-Lt;)lt=mr(lt),gt--;for(;0<Lt-gt;)Ze=mr(Ze),Lt--;for(;gt--;){if(lt===Ze||Ze!==null&&lt===Ze.alternate){mr=lt;break t}lt=mr(lt),Ze=mr(Ze)}mr=null}else mr=null;Ct!==null&&am(It,ht,Ct,mr,!1),Bn!==null&&$o!==null&&am(It,$o,Bn,mr,!0)}}e:{if(ht=ct?Ao(ct):window,Ct=ht.nodeName&&ht.nodeName.toLowerCase(),Ct==="select"||Ct==="input"&&ht.type==="file")var yo=Og;else if(Cs(ht))if(ju)yo=Bu;else{yo=Fi;var Zn=IS}else Ct=ht.nodeName,!Ct||Ct.toLowerCase()!=="input"||ht.type!=="checkbox"&&ht.type!=="radio"?ct&&Qf(ct.elementType)&&(yo=Og):yo=Lu;if(yo&&(yo=yo(i,ct))){Tr(It,yo,p,Dt);break e}Zn&&Zn(i,ht,ct),i==="focusout"&&ct&&ht.type==="number"&&ct.memoizedProps.value!=null&&co(ht,"number",ht.value)}switch(Zn=ct?Ao(ct):window,i){case"focusin":(Cs(Zn)||Zn.contentEditable==="true")&&(Uu=Zn,Yp=ct,ol=null);break;case"focusout":ol=Yp=Uu=null;break;case"mousedown":Vc=!0;break;case"contextmenu":case"mouseup":case"dragend":Vc=!1,fs(It,p,Dt);break;case"selectionchange":if(Fg)break;case"keydown":case"keyup":fs(It,p,Dt)}var Lr;if(xs)e:{switch(i){case"compositionstart":var to="onCompositionStart";break e;case"compositionend":to="onCompositionEnd";break e;case"compositionupdate":to="onCompositionUpdate";break e}to=void 0}else Wc?Wp(i,p)&&(to="onCompositionEnd"):i==="keydown"&&p.keyCode===229&&(to="onCompositionStart");to&&(_g&&p.locale!=="ko"&&(Wc||to!=="onCompositionStart"?to==="onCompositionEnd"&&Wc&&(Lr=Np()):(Oi=Dt,mn="value"in Oi?Oi.value:Oi.textContent,Wc=!0)),Zn=Wh(ct,to),0<Zn.length&&(to=new Up(to,i,null,p,Dt),It.push({event:to,listeners:Zn}),Lr?to.data=Lr:(Lr=sa(p),Lr!==null&&(to.data=Lr)))),(Lr=eh?Yo(i,p):ia(i,p))&&(to=Wh(ct,"onBeforeInput"),0<to.length&&(Zn=new Up("onBeforeInput","beforeinput",null,p,Dt),It.push({event:Zn,listeners:to}),Zn.data=Lr)),Hi(It,i,ct,p,Dt)}cx(It,l)})}function Hh(i,l,p){return{instance:i,listener:l,currentTarget:p}}function Wh(i,l){for(var p=l+"Capture",b=[];i!==null;){var D=i,P=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||P===null||(D=Xf(i,p),D!=null&&b.unshift(Hh(i,D,P)),D=Xf(i,l),D!=null&&b.push(Hh(i,D,P))),i.tag===3)return b;i=i.return}return[]}function Y1(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function am(i,l,p,b,D){for(var P=l._reactName,q=[];p!==null&&p!==b;){var ge=p,Le=ge.alternate,ct=ge.stateNode;if(ge=ge.tag,Le!==null&&Le===b)break;ge!==5&&ge!==26&&ge!==27||ct===null||(Le=ct,D?(ct=Xf(p,P),ct!=null&&q.unshift(Hh(p,ct,Le))):D||(ct=Xf(p,P),ct!=null&&q.push(Hh(p,ct,Le)))),p=p.return}q.length!==0&&i.push({event:l,listeners:q})}var US=/\r\n?/g,$S=/\u0000|\uFFFD/g;function vi(i){return(typeof i=="string"?i:""+i).replace(US,`
`).replace($S,"")}function q1(i,l){return l=vi(l),vi(i)===l}function Do(i,l,p,b,D,P){switch(p){case"children":typeof b=="string"?l==="body"||l==="textarea"&&b===""||Fu(i,b):(typeof b=="number"||typeof b=="bigint")&&l!=="body"&&Fu(i,""+b);break;case"className":$n(i,"class",b);break;case"tabIndex":$n(i,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":$n(i,p,b);break;case"style":Bo(i,b,P);break;case"data":if(l!=="object"){$n(i,"data",b);break}case"src":case"href":if(b===""&&(l!=="a"||p!=="href")){i.removeAttribute(p);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){i.removeAttribute(p);break}b=Id(""+b),i.setAttribute(p,b);break;case"action":case"formAction":if(typeof b=="function"){i.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(p==="formAction"?(l!=="input"&&Do(i,l,"name",D.name,D,null),Do(i,l,"formEncType",D.formEncType,D,null),Do(i,l,"formMethod",D.formMethod,D,null),Do(i,l,"formTarget",D.formTarget,D,null)):(Do(i,l,"encType",D.encType,D,null),Do(i,l,"method",D.method,D,null),Do(i,l,"target",D.target,D,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){i.removeAttribute(p);break}b=Id(""+b),i.setAttribute(p,b);break;case"onClick":b!=null&&(i.onclick=_i);break;case"onScroll":b!=null&&cr("scroll",i);break;case"onScrollEnd":b!=null&&cr("scrollend",i);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(a(61));if(p=b.__html,p!=null){if(D.children!=null)throw Error(a(60));i.innerHTML=p}}break;case"multiple":i.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":i.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){i.removeAttribute("xlink:href");break}p=Id(""+b),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?i.setAttribute(p,""+b):i.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?i.setAttribute(p,""):i.removeAttribute(p);break;case"capture":case"download":b===!0?i.setAttribute(p,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?i.setAttribute(p,b):i.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?i.setAttribute(p,b):i.removeAttribute(p);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?i.removeAttribute(p):i.setAttribute(p,b);break;case"popover":cr("beforetoggle",i),cr("toggle",i),cn(i,"popover",b);break;case"xlinkActuate":Zo(i,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":Zo(i,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":Zo(i,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":Zo(i,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":Zo(i,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":Zo(i,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":Zo(i,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":Zo(i,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":Zo(i,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":cn(i,"is",b);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Hb.get(p)||p,cn(i,p,b))}}function Q1(i,l,p,b,D,P){switch(p){case"style":Bo(i,b,P);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(a(61));if(p=b.__html,p!=null){if(D.children!=null)throw Error(a(60));i.innerHTML=p}}break;case"children":typeof b=="string"?Fu(i,b):(typeof b=="number"||typeof b=="bigint")&&Fu(i,""+b);break;case"onScroll":b!=null&&cr("scroll",i);break;case"onScrollEnd":b!=null&&cr("scrollend",i);break;case"onClick":b!=null&&(i.onclick=_i);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!da.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(D=p.endsWith("Capture"),l=p.slice(2,D?p.length-7:void 0),P=i[Jn]||null,P=P!=null?P[p]:null,typeof P=="function"&&i.removeEventListener(l,P,D),typeof b=="function")){typeof P!="function"&&P!==null&&(p in i?i[p]=null:i.hasAttribute(p)&&i.removeAttribute(p)),i.addEventListener(l,b,D);break e}p in i?i[p]=b:b===!0?i.setAttribute(p,""):cn(i,p,b)}}}function ls(i,l,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":cr("error",i),cr("load",i);var b=!1,D=!1,P;for(P in p)if(p.hasOwnProperty(P)){var q=p[P];if(q!=null)switch(P){case"src":b=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:Do(i,l,P,q,p,null)}}D&&Do(i,l,"srcSet",p.srcSet,p,null),b&&Do(i,l,"src",p.src,p,null);return;case"input":cr("invalid",i);var ge=P=q=D=null,Le=null,ct=null;for(b in p)if(p.hasOwnProperty(b)){var Dt=p[b];if(Dt!=null)switch(b){case"name":D=Dt;break;case"type":q=Dt;break;case"checked":Le=Dt;break;case"defaultChecked":ct=Dt;break;case"value":P=Dt;break;case"defaultValue":ge=Dt;break;case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(a(137,l));break;default:Do(i,l,b,Dt,p,null)}}zb(i,P,ge,Le,ct,q,D,!1);return;case"select":cr("invalid",i),b=q=P=null;for(D in p)if(p.hasOwnProperty(D)&&(ge=p[D],ge!=null))switch(D){case"value":P=ge;break;case"defaultValue":q=ge;break;case"multiple":b=ge;default:Do(i,l,D,ge,p,null)}l=P,p=q,i.multiple=!!b,l!=null?Ou(i,!!b,l,!1):p!=null&&Ou(i,!!b,p,!0);return;case"textarea":cr("invalid",i),P=D=b=null;for(q in p)if(p.hasOwnProperty(q)&&(ge=p[q],ge!=null))switch(q){case"value":b=ge;break;case"defaultValue":D=ge;break;case"children":P=ge;break;case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(91));break;default:Do(i,l,q,ge,p,null)}Op(i,b,D,P);return;case"option":for(Le in p)if(p.hasOwnProperty(Le)&&(b=p[Le],b!=null))switch(Le){case"selected":i.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:Do(i,l,Le,b,p,null)}return;case"dialog":cr("beforetoggle",i),cr("toggle",i),cr("cancel",i),cr("close",i);break;case"iframe":case"object":cr("load",i);break;case"video":case"audio":for(b=0;b<fd.length;b++)cr(fd[b],i);break;case"image":cr("error",i),cr("load",i);break;case"details":cr("toggle",i);break;case"embed":case"source":case"link":cr("error",i),cr("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ct in p)if(p.hasOwnProperty(ct)&&(b=p[ct],b!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:Do(i,l,ct,b,p,null)}return;default:if(Qf(l)){for(Dt in p)p.hasOwnProperty(Dt)&&(b=p[Dt],b!==void 0&&Q1(i,l,Dt,b,p,void 0));return}}for(ge in p)p.hasOwnProperty(ge)&&(b=p[ge],b!=null&&Do(i,l,ge,b,p,null))}function X1(i,l,p,b){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,P=null,q=null,ge=null,Le=null,ct=null,Dt=null;for(Ct in p){var It=p[Ct];if(p.hasOwnProperty(Ct)&&It!=null)switch(Ct){case"checked":break;case"value":break;case"defaultValue":Le=It;default:b.hasOwnProperty(Ct)||Do(i,l,Ct,null,b,It)}}for(var ht in b){var Ct=b[ht];if(It=p[ht],b.hasOwnProperty(ht)&&(Ct!=null||It!=null))switch(ht){case"type":P=Ct;break;case"name":D=Ct;break;case"checked":ct=Ct;break;case"defaultChecked":Dt=Ct;break;case"value":q=Ct;break;case"defaultValue":ge=Ct;break;case"children":case"dangerouslySetInnerHTML":if(Ct!=null)throw Error(a(137,l));break;default:Ct!==It&&Do(i,l,ht,Ct,b,It)}}qf(i,q,ge,Le,ct,Dt,P,D);return;case"select":Ct=q=ge=ht=null;for(P in p)if(Le=p[P],p.hasOwnProperty(P)&&Le!=null)switch(P){case"value":break;case"multiple":Ct=Le;default:b.hasOwnProperty(P)||Do(i,l,P,null,b,Le)}for(D in b)if(P=b[D],Le=p[D],b.hasOwnProperty(D)&&(P!=null||Le!=null))switch(D){case"value":ht=P;break;case"defaultValue":ge=P;break;case"multiple":q=P;default:P!==Le&&Do(i,l,D,P,b,Le)}l=ge,p=q,b=Ct,ht!=null?Ou(i,!!p,ht,!1):!!b!=!!p&&(l!=null?Ou(i,!!p,l,!0):Ou(i,!!p,p?[]:"",!1));return;case"textarea":Ct=ht=null;for(ge in p)if(D=p[ge],p.hasOwnProperty(ge)&&D!=null&&!b.hasOwnProperty(ge))switch(ge){case"value":break;case"children":break;default:Do(i,l,ge,null,b,D)}for(q in b)if(D=b[q],P=p[q],b.hasOwnProperty(q)&&(D!=null||P!=null))switch(q){case"value":ht=D;break;case"defaultValue":Ct=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(a(91));break;default:D!==P&&Do(i,l,q,D,b,P)}wg(i,ht,Ct);return;case"option":for(var Bn in p)if(ht=p[Bn],p.hasOwnProperty(Bn)&&ht!=null&&!b.hasOwnProperty(Bn))switch(Bn){case"selected":i.selected=!1;break;default:Do(i,l,Bn,null,b,ht)}for(Le in b)if(ht=b[Le],Ct=p[Le],b.hasOwnProperty(Le)&&ht!==Ct&&(ht!=null||Ct!=null))switch(Le){case"selected":i.selected=ht&&typeof ht!="function"&&typeof ht!="symbol";break;default:Do(i,l,Le,ht,b,Ct)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var mr in p)ht=p[mr],p.hasOwnProperty(mr)&&ht!=null&&!b.hasOwnProperty(mr)&&Do(i,l,mr,null,b,ht);for(ct in b)if(ht=b[ct],Ct=p[ct],b.hasOwnProperty(ct)&&ht!==Ct&&(ht!=null||Ct!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":if(ht!=null)throw Error(a(137,l));break;default:Do(i,l,ct,ht,b,Ct)}return;default:if(Qf(l)){for(var $o in p)ht=p[$o],p.hasOwnProperty($o)&&ht!==void 0&&!b.hasOwnProperty($o)&&Q1(i,l,$o,void 0,b,ht);for(Dt in b)ht=b[Dt],Ct=p[Dt],!b.hasOwnProperty(Dt)||ht===Ct||ht===void 0&&Ct===void 0||Q1(i,l,Dt,ht,b,Ct);return}}for(var lt in p)ht=p[lt],p.hasOwnProperty(lt)&&ht!=null&&!b.hasOwnProperty(lt)&&Do(i,l,lt,null,b,ht);for(It in b)ht=b[It],Ct=p[It],!b.hasOwnProperty(It)||ht===Ct||ht==null&&Ct==null||Do(i,l,It,ht,b,Ct)}function J1(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Z1(){if(typeof performance.getEntriesByType=="function"){for(var i=0,l=0,p=performance.getEntriesByType("resource"),b=0;b<p.length;b++){var D=p[b],P=D.transferSize,q=D.initiatorType,ge=D.duration;if(P&&ge&&J1(q)){for(q=0,ge=D.responseEnd,b+=1;b<p.length;b++){var Le=p[b],ct=Le.startTime;if(ct>ge)break;var Dt=Le.transferSize,It=Le.initiatorType;Dt&&J1(It)&&(Le=Le.responseEnd,q+=Dt*(Le<ge?1:(ge-ct)/(Le-ct)))}if(--b,l+=8*(P+q)/(D.duration/1e3),i++,10<i)break}}if(0<i)return l/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var bf=null,sm=null;function Vh(i){return i.nodeType===9?i:i.ownerDocument}function ey(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function pl(i,l){if(i===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&l==="foreignObject"?0:i}function vf(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Gh=null;function im(){var i=window.event;return i&&i.type==="popstate"?i===Gh?!1:(Gh=i,!0):(Gh=null,!1)}var lm=typeof setTimeout=="function"?setTimeout:void 0,dx=typeof clearTimeout=="function"?clearTimeout:void 0,ty=typeof Promise=="function"?Promise:void 0,cm=typeof queueMicrotask=="function"?queueMicrotask:typeof ty<"u"?function(i){return ty.resolve(null).then(i).catch(fx)}:lm;function fx(i){setTimeout(function(){throw i})}function Dc(i){return i==="head"}function um(i,l){var p=l,b=0;do{var D=p.nextSibling;if(i.removeChild(p),D&&D.nodeType===8)if(p=D.data,p==="/$"||p==="/&"){if(b===0){i.removeChild(D),Gn(l);return}b--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")b++;else if(p==="html")c(i.ownerDocument.documentElement);else if(p==="head"){p=i.ownerDocument.head,c(p);for(var P=p.firstChild;P;){var q=P.nextSibling,ge=P.nodeName;P[Tt]||ge==="SCRIPT"||ge==="STYLE"||ge==="LINK"&&P.rel.toLowerCase()==="stylesheet"||p.removeChild(P),P=q}}else p==="body"&&c(i.ownerDocument.body);p=D}while(p);Gn(l)}function ny(i,l){var p=i;i=0;do{var b=p.nextSibling;if(p.nodeType===1?l?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(l?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),b&&b.nodeType===8)if(p=b.data,p==="/$"){if(i===0)break;i--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||i++;p=b}while(p)}function dm(i){var l=i.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var p=l;switch(l=l.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":dm(p),Dn(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}i.removeChild(p)}}function fm(i,l,p,b){for(;i.nodeType===1;){var D=p;if(i.nodeName.toLowerCase()!==l.toLowerCase()){if(!b&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(b){if(!i[Tt])switch(l){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(P=i.getAttribute("rel"),P==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(P!==D.rel||i.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||i.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||i.getAttribute("title")!==(D.title==null?null:D.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(P=i.getAttribute("src"),(P!==(D.src==null?null:D.src)||i.getAttribute("type")!==(D.type==null?null:D.type)||i.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&P&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(l==="input"&&i.type==="hidden"){var P=D.name==null?null:""+D.name;if(D.type==="hidden"&&i.getAttribute("name")===P)return i}else return i;if(i=xi(i.nextSibling),i===null)break}return null}function ry(i,l,p){if(l==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!p||(i=xi(i.nextSibling),i===null))return null;return i}function hm(i,l){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=xi(i.nextSibling),i===null))return null;return i}function pm(i){return i.data==="$?"||i.data==="$~"}function xf(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function oy(i,l){var p=i.ownerDocument;if(i.data==="$~")i._reactRetry=l;else if(i.data!=="$?"||p.readyState!=="loading")l();else{var b=function(){l(),p.removeEventListener("DOMContentLoaded",b)};p.addEventListener("DOMContentLoaded",b),i._reactRetry=b}}function xi(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return i}var uu=null;function Yr(i){i=i.nextSibling;for(var l=0;i;){if(i.nodeType===8){var p=i.data;if(p==="/$"||p==="/&"){if(l===0)return xi(i.nextSibling);l--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||l++}i=i.nextSibling}return null}function hx(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var p=i.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(l===0)return i;l--}else p!=="/$"&&p!=="/&"||l++}i=i.previousSibling}return null}function s(i,l,p){switch(l=Vh(p),i){case"html":if(i=l.documentElement,!i)throw Error(a(452));return i;case"head":if(i=l.head,!i)throw Error(a(453));return i;case"body":if(i=l.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function c(i){for(var l=i.attributes;l.length;)i.removeAttributeNode(l[0]);Dn(i)}var u=new Map,h=new Set;function g(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var x=ye.d;ye.d={f:v,r:S,D:_,C:L,L:B,m:z,X:G,S:Z,M:me};function v(){var i=x.f(),l=Y0();return i||l}function S(i){var l=or(i);l!==null&&l.tag===5&&l.type==="form"?bv(l):x.r(i)}var T=typeof document>"u"?null:document;function k(i,l,p){var b=T;if(b&&typeof l=="string"&&l){var D=Sr(l);D='link[rel="'+i+'"][href="'+D+'"]',typeof p=="string"&&(D+='[crossorigin="'+p+'"]'),h.has(D)||(h.add(D),i={rel:i,crossOrigin:p,href:l},b.querySelector(D)===null&&(l=b.createElement("link"),ls(l,"link",i),Zr(l),b.head.appendChild(l)))}}function _(i){x.D(i),k("dns-prefetch",i,null)}function L(i,l){x.C(i,l),k("preconnect",i,l)}function B(i,l,p){x.L(i,l,p);var b=T;if(b&&i&&l){var D='link[rel="preload"][as="'+Sr(l)+'"]';l==="image"&&p&&p.imageSrcSet?(D+='[imagesrcset="'+Sr(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(D+='[imagesizes="'+Sr(p.imageSizes)+'"]')):D+='[href="'+Sr(i)+'"]';var P=D;switch(l){case"style":P=Y(i);break;case"script":P=$e(i)}u.has(P)||(i=A({rel:"preload",href:l==="image"&&p&&p.imageSrcSet?void 0:i,as:l},p),u.set(P,i),b.querySelector(D)!==null||l==="style"&&b.querySelector(he(P))||l==="script"&&b.querySelector(ot(P))||(l=b.createElement("link"),ls(l,"link",i),Zr(l),b.head.appendChild(l)))}}function z(i,l){x.m(i,l);var p=T;if(p&&i){var b=l&&typeof l.as=="string"?l.as:"script",D='link[rel="modulepreload"][as="'+Sr(b)+'"][href="'+Sr(i)+'"]',P=D;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=$e(i)}if(!u.has(P)&&(i=A({rel:"modulepreload",href:i},l),u.set(P,i),p.querySelector(D)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(ot(P)))return}b=p.createElement("link"),ls(b,"link",i),Zr(b),p.head.appendChild(b)}}}function Z(i,l,p){x.S(i,l,p);var b=T;if(b&&i){var D=kr(b).hoistableStyles,P=Y(i);l=l||"default";var q=D.get(P);if(!q){var ge={loading:0,preload:null};if(q=b.querySelector(he(P)))ge.loading=5;else{i=A({rel:"stylesheet",href:i,"data-precedence":l},p),(p=u.get(P))&&Ot(i,p);var Le=q=b.createElement("link");Zr(Le),ls(Le,"link",i),Le._p=new Promise(function(ct,Dt){Le.onload=ct,Le.onerror=Dt}),Le.addEventListener("load",function(){ge.loading|=1}),Le.addEventListener("error",function(){ge.loading|=2}),ge.loading|=4,dt(q,l,b)}q={type:"stylesheet",instance:q,count:1,state:ge},D.set(P,q)}}}function G(i,l){x.X(i,l);var p=T;if(p&&i){var b=kr(p).hoistableScripts,D=$e(i),P=b.get(D);P||(P=p.querySelector(ot(D)),P||(i=A({src:i,async:!0},l),(l=u.get(D))&&jt(i,l),P=p.createElement("script"),Zr(P),ls(P,"link",i),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},b.set(D,P))}}function me(i,l){x.M(i,l);var p=T;if(p&&i){var b=kr(p).hoistableScripts,D=$e(i),P=b.get(D);P||(P=p.querySelector(ot(D)),P||(i=A({src:i,async:!0,type:"module"},l),(l=u.get(D))&&jt(i,l),P=p.createElement("script"),Zr(P),ls(P,"link",i),p.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},b.set(D,P))}}function re(i,l,p,b){var D=(D=be.current)?g(D):null;if(!D)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(l=Y(p.href),p=kr(D).hoistableStyles,b=p.get(l),b||(b={type:"style",instance:null,count:0,state:null},p.set(l,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){i=Y(p.href);var P=kr(D).hoistableStyles,q=P.get(i);if(q||(D=D.ownerDocument||D,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(i,q),(P=D.querySelector(he(i)))&&!P._p&&(q.instance=P,q.state.loading=5),u.has(i)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},u.set(i,p),P||we(D,i,p,q.state))),l&&b===null)throw Error(a(528,""));return q}if(l&&b!==null)throw Error(a(529,""));return null;case"script":return l=p.async,p=p.src,typeof p=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=$e(p),p=kr(D).hoistableScripts,b=p.get(l),b||(b={type:"script",instance:null,count:0,state:null},p.set(l,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Y(i){return'href="'+Sr(i)+'"'}function he(i){return'link[rel="stylesheet"]['+i+"]"}function Ce(i){return A({},i,{"data-precedence":i.precedence,precedence:null})}function we(i,l,p,b){i.querySelector('link[rel="preload"][as="style"]['+l+"]")?b.loading=1:(l=i.createElement("link"),b.preload=l,l.addEventListener("load",function(){return b.loading|=1}),l.addEventListener("error",function(){return b.loading|=2}),ls(l,"link",p),Zr(l),i.head.appendChild(l))}function $e(i){return'[src="'+Sr(i)+'"]'}function ot(i){return"script[async]"+i}function et(i,l,p){if(l.count++,l.instance===null)switch(l.type){case"style":var b=i.querySelector('style[data-href~="'+Sr(p.href)+'"]');if(b)return l.instance=b,Zr(b),b;var D=A({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return b=(i.ownerDocument||i).createElement("style"),Zr(b),ls(b,"style",D),dt(b,p.precedence,i),l.instance=b;case"stylesheet":D=Y(p.href);var P=i.querySelector(he(D));if(P)return l.state.loading|=4,l.instance=P,Zr(P),P;b=Ce(p),(D=u.get(D))&&Ot(b,D),P=(i.ownerDocument||i).createElement("link"),Zr(P);var q=P;return q._p=new Promise(function(ge,Le){q.onload=ge,q.onerror=Le}),ls(P,"link",b),l.state.loading|=4,dt(P,p.precedence,i),l.instance=P;case"script":return P=$e(p.src),(D=i.querySelector(ot(P)))?(l.instance=D,Zr(D),D):(b=p,(D=u.get(P))&&(b=A({},p),jt(b,D)),i=i.ownerDocument||i,D=i.createElement("script"),Zr(D),ls(D,"link",b),i.head.appendChild(D),l.instance=D);case"void":return null;default:throw Error(a(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(b=l.instance,l.state.loading|=4,dt(b,p.precedence,i));return l.instance}function dt(i,l,p){for(var b=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=b.length?b[b.length-1]:null,P=D,q=0;q<b.length;q++){var ge=b[q];if(ge.dataset.precedence===l)P=ge;else if(P!==D)break}P?P.parentNode.insertBefore(i,P.nextSibling):(l=p.nodeType===9?p.head:p,l.insertBefore(i,l.firstChild))}function Ot(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.title==null&&(i.title=l.title)}function jt(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.integrity==null&&(i.integrity=l.integrity)}var bt=null;function Qt(i,l,p){if(bt===null){var b=new Map,D=bt=new Map;D.set(p,b)}else D=bt,b=D.get(p),b||(b=new Map,D.set(p,b));if(b.has(i))return b;for(b.set(i,null),p=p.getElementsByTagName(i),D=0;D<p.length;D++){var P=p[D];if(!(P[Tt]||P[Rr]||i==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var q=P.getAttribute(l)||"";q=i+q;var ge=b.get(q);ge?ge.push(P):b.set(q,[P])}}return b}function Tn(i,l,p){i=i.ownerDocument||i,i.head.insertBefore(p,l==="title"?i.querySelector("head > title"):null)}function wn(i,l,p){if(p===1||l.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return i=l.disabled,typeof l.precedence=="string"&&i==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function sn(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function dn(i,l,p,b){if(p.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var D=Y(b.href),P=l.querySelector(he(D));if(P){l=P._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(i.count++,i=Rn.bind(i),l.then(i,i)),p.state.loading|=4,p.instance=P,Zr(P);return}P=l.ownerDocument||l,b=Ce(b),(D=u.get(D))&&Ot(b,D),P=P.createElement("link"),Zr(P);var q=P;q._p=new Promise(function(ge,Le){q.onload=ge,q.onerror=Le}),ls(P,"link",b),p.instance=P}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(p,l),(l=p.state.preload)&&(p.state.loading&3)===0&&(i.count++,p=Rn.bind(i),l.addEventListener("load",p),l.addEventListener("error",p))}}var rn=0;function Vt(i,l){return i.stylesheets&&i.count===0&&qn(i,i.stylesheets),0<i.count||0<i.imgCount?function(p){var b=setTimeout(function(){if(i.stylesheets&&qn(i,i.stylesheets),i.unsuspend){var P=i.unsuspend;i.unsuspend=null,P()}},6e4+l);0<i.imgBytes&&rn===0&&(rn=62500*Z1());var D=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&qn(i,i.stylesheets),i.unsuspend)){var P=i.unsuspend;i.unsuspend=null,P()}},(i.imgBytes>rn?50:800)+l);return i.unsuspend=p,function(){i.unsuspend=null,clearTimeout(b),clearTimeout(D)}}:null}function Rn(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qn(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Fn=null;function qn(i,l){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Fn=new Map,l.forEach(Dr,i),Fn=null,Rn.call(i))}function Dr(i,l){if(!(l.state.loading&4)){var p=Fn.get(i);if(p)var b=p.get(null);else{p=new Map,Fn.set(i,p);for(var D=i.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<D.length;P++){var q=D[P];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(p.set(q.dataset.precedence,q),b=q)}b&&p.set(null,b)}D=l.instance,q=D.getAttribute("data-precedence"),P=p.get(q)||b,P===b&&p.set(null,D),p.set(q,D),this.count++,b=Rn.bind(this),D.addEventListener("load",b),D.addEventListener("error",b),P?P.parentNode.insertBefore(D,P.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(D,i.firstChild)),l.state.loading|=4}}var An={$$typeof:H,Provider:null,Consumer:null,_currentValue:ze,_currentValue2:ze,_threadCount:0};function Xt(i,l,p,b,D,P,q,ge,Le){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gr(0),this.hiddenUpdates=gr(null),this.identifierPrefix=b,this.onUncaughtError=D,this.onCaughtError=P,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Le,this.incompleteTransitions=new Map}function pr(i,l,p,b,D,P,q,ge,Le,ct,Dt,It){return i=new Xt(i,l,p,q,Le,ct,Dt,It,ge),l=1,P===!0&&(l|=24),P=ea(3,null,null,l),i.current=P,P.stateNode=i,l=Wd(),l.refCount++,i.pooledCache=l,l.refCount++,P.memoizedState={element:b,isDehydrated:p,cache:l},f0(P),i}function Vr(i){return i?(i=Hu,i):Hu}function jr(i,l,p,b,D,P){D=Vr(D),b.context===null?b.context=D:b.pendingContext=D,b=ps(l),b.payload={element:p},P=P===void 0?null:P,P!==null&&(b.callback=P),p=hc(i,b,l),p!==null&&(Fs(p,i,l),Qu(p,i,l))}function so(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var p=i.retryLane;i.retryLane=p!==0&&p<l?p:l}}function oa(i,l){so(i,l),(i=i.alternate)&&so(i,l)}function Ye(i){if(i.tag===13||i.tag===31){var l=Li(i,67108864);l!==null&&Fs(l,i,67108864),oa(i,67108864)}}function io(i){if(i.tag===13||i.tag===31){var l=Os();l=fo(l);var p=Li(i,l);p!==null&&Fs(p,i,l),oa(i,l)}}var Qr=!0;function Ka(i,l,p,b){var D=se.T;se.T=null;var P=ye.p;try{ye.p=2,De(i,l,p,b)}finally{ye.p=P,se.T=D}}function Wi(i,l,p,b){var D=se.T;se.T=null;var P=ye.p;try{ye.p=8,De(i,l,p,b)}finally{ye.p=P,se.T=D}}function De(i,l,p,b){if(Qr){var D=vt(b);if(D===null)om(i,l,b,He,p),xn(i,b);else if(Hn(D,i,l,p,b))b.stopPropagation();else if(xn(i,b),l&4&&-1<Pn.indexOf(i)){for(;D!==null;){var P=or(D);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var q=Kn(P.pendingLanes);if(q!==0){var ge=P;for(ge.pendingLanes|=2,ge.entangledLanes|=2;q;){var Le=1<<31-_t(q);ge.entanglements[1]|=Le,q&=~Le}is(P),(uo&6)===0&&(W0=Me()+500,ud(0))}}break;case 31:case 13:ge=Li(P,2),ge!==null&&Fs(ge,P,2),Y0(),oa(P,2)}if(P=vt(b),P===null&&om(i,l,b,He,p),P===D)break;D=P}D!==null&&b.stopPropagation()}else om(i,l,b,null,p)}}function vt(i){return i=po(i),yt(i)}var He=null;function yt(i){if(He=null,i=nr(i),i!==null){var l=n(i);if(l===null)i=null;else{var p=l.tag;if(p===13){if(i=f(l),i!==null)return i;i=null}else if(p===31){if(i=m(l),i!==null)return i;i=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null)}}return He=i,null}function Ue(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ve()){case Qe:return 2;case rt:return 8;case st:case it:return 32;case xt:return 268435456;default:return 32}default:return 32}}var Gt=!1,ft=null,St=null,ut=null,Rt=new Map,Jt=new Map,Mn=[],Pn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xn(i,l){switch(i){case"focusin":case"focusout":ft=null;break;case"dragenter":case"dragleave":St=null;break;case"mouseover":case"mouseout":ut=null;break;case"pointerover":case"pointerout":Rt.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jt.delete(l.pointerId)}}function _n(i,l,p,b,D,P){return i===null||i.nativeEvent!==P?(i={blockedOn:l,domEventName:p,eventSystemFlags:b,nativeEvent:P,targetContainers:[D]},l!==null&&(l=or(l),l!==null&&Ye(l)),i):(i.eventSystemFlags|=b,l=i.targetContainers,D!==null&&l.indexOf(D)===-1&&l.push(D),i)}function Hn(i,l,p,b,D){switch(l){case"focusin":return ft=_n(ft,i,l,p,b,D),!0;case"dragenter":return St=_n(St,i,l,p,b,D),!0;case"mouseover":return ut=_n(ut,i,l,p,b,D),!0;case"pointerover":var P=D.pointerId;return Rt.set(P,_n(Rt.get(P)||null,i,l,p,b,D)),!0;case"gotpointercapture":return P=D.pointerId,Jt.set(P,_n(Jt.get(P)||null,i,l,p,b,D)),!0}return!1}function zn(i){var l=nr(i.target);if(l!==null){var p=n(l);if(p!==null){if(l=p.tag,l===13){if(l=f(p),l!==null){i.blockedOn=l,Or(i.priority,function(){io(p)});return}}else if(l===31){if(l=m(p),l!==null){i.blockedOn=l,Or(i.priority,function(){io(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){i.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}i.blockedOn=null}function fn(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var p=vt(i.nativeEvent);if(p===null){p=i.nativeEvent;var b=new p.constructor(p.type,p);Pd=b,p.target.dispatchEvent(b),Pd=null}else return l=or(p),l!==null&&Ye(l),i.blockedOn=p,!1;l.shift()}return!0}function nn(i,l,p){fn(i)&&p.delete(l)}function Vn(){Gt=!1,ft!==null&&fn(ft)&&(ft=null),St!==null&&fn(St)&&(St=null),ut!==null&&fn(ut)&&(ut=null),Rt.forEach(nn),Jt.forEach(nn)}function kn(i,l){i.blockedOn===l&&(i.blockedOn=null,Gt||(Gt=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Vn)))}var on=null;function er(i){on!==i&&(on=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){on===i&&(on=null);for(var l=0;l<i.length;l+=3){var p=i[l],b=i[l+1],D=i[l+2];if(typeof b!="function"){if(yt(b||p)===null)continue;break}var P=or(p);P!==null&&(i.splice(l,3),l-=3,p1(P,{pending:!0,data:D,method:p.method,action:b},b,D))}}))}function Gn(i){function l(Le){return kn(Le,i)}ft!==null&&kn(ft,i),St!==null&&kn(St,i),ut!==null&&kn(ut,i),Rt.forEach(l),Jt.forEach(l);for(var p=0;p<Mn.length;p++){var b=Mn[p];b.blockedOn===i&&(b.blockedOn=null)}for(;0<Mn.length&&(p=Mn[0],p.blockedOn===null);)zn(p),p.blockedOn===null&&Mn.shift();if(p=(i.ownerDocument||i).$$reactFormReplay,p!=null)for(b=0;b<p.length;b+=3){var D=p[b],P=p[b+1],q=D[Jn]||null;if(typeof P=="function")q||er(p);else if(q){var ge=null;if(P&&P.hasAttribute("formAction")){if(D=P,q=P[Jn]||null)ge=q.formAction;else if(yt(D)!==null)continue}else ge=q.action;typeof ge=="function"?p[b+1]=ge:(p.splice(b,3),b-=3),er(p)}}}function Ro(){function i(P){P.canIntercept&&P.info==="react-transition"&&P.intercept({handler:function(){return new Promise(function(q){return D=q})},focusReset:"manual",scroll:"manual"})}function l(){D!==null&&(D(),D=null),b||setTimeout(p,20)}function p(){if(!b&&!navigation.transition){var P=navigation.currentEntry;P&&P.url!=null&&navigation.navigate(P.url,{state:P.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var b=!1,D=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(p,100),function(){b=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),D!==null&&(D(),D=null)}}}function ir(i){this._internalRoot=i}xr.prototype.render=ir.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(a(409));var p=l.current,b=Os();jr(p,b,i,l,null,null)},xr.prototype.unmount=ir.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;jr(i.current,2,null,i,null,null),Y0(),l[aa]=null}};function xr(i){this._internalRoot=i}xr.prototype.unstable_scheduleHydration=function(i){if(i){var l=Qn();i={blockedOn:null,target:i,priority:l};for(var p=0;p<Mn.length&&l!==0&&l<Mn[p].priority;p++);Mn.splice(p,0,i),p===0&&zn(i)}};var Ln=e.version;if(Ln!=="19.2.1")throw Error(a(527,Ln,"19.2.1"));ye.findDOMNode=function(i){var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=C(l),i=i!==null?w(i):null,i=i===null?null:i.stateNode,i};var zr={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pr.isDisabled&&Pr.supportsFiber)try{Kt=Pr.inject(zr),tn=Pr}catch{}}return sy.createRoot=function(i,l){if(!o(i))throw Error(a(299));var p=!1,b="",D=D0,P=Rv,q=Iv;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(b=l.identifierPrefix),l.onUncaughtError!==void 0&&(D=l.onUncaughtError),l.onCaughtError!==void 0&&(P=l.onCaughtError),l.onRecoverableError!==void 0&&(q=l.onRecoverableError)),l=pr(i,1,!1,null,null,p,b,null,D,P,q,Ro),i[aa]=l.current,K1(i),new ir(l)},sy.hydrateRoot=function(i,l,p){if(!o(i))throw Error(a(299));var b=!1,D="",P=D0,q=Rv,ge=Iv,Le=null;return p!=null&&(p.unstable_strictMode===!0&&(b=!0),p.identifierPrefix!==void 0&&(D=p.identifierPrefix),p.onUncaughtError!==void 0&&(P=p.onUncaughtError),p.onCaughtError!==void 0&&(q=p.onCaughtError),p.onRecoverableError!==void 0&&(ge=p.onRecoverableError),p.formState!==void 0&&(Le=p.formState)),l=pr(i,1,!0,l,p??null,b,D,Le,P,q,ge,Ro),l.context=Vr(null),p=l.current,b=Os(),b=fo(b),D=ps(b),D.callback=null,hc(p,D,b),p=b,l.current.lanes=p,en(l,p),is(l),i[aa]=l.current,K1(i),new xr(l)},sy.version="19.2.1",sy}var $k;function NO(){if($k)return VS.exports;$k=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),VS.exports=FO(),VS.exports}var jO=NO();const LO=hb(jO),Gy={black:"#000",white:"#fff"},mm={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},gm={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},ym={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},bm={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},vm={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},iy={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},BO={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function xd(t,...e){const r=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(a=>r.searchParams.append("args[]",a)),`Minified MUI error #${t}; visit ${r} for the full message.`}const ql="$$material";function Xe(){return Xe=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var a in r)({}).hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Xe.apply(null,arguments)}function zO(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function UO(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var $O=(function(){function t(r){var a=this;this._insertTag=function(o){var n;a.tags.length===0?a.insertionPoint?n=a.insertionPoint.nextSibling:a.prepend?n=a.container.firstChild:n=a.before:n=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(o,n),a.tags.push(o)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(a){a.forEach(this._insertTag)},e.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(UO(this));var o=this.tags[this.tags.length-1];if(this.isSpeedy){var n=zO(o);try{n.insertRule(a,n.cssRules.length)}catch{}}else o.appendChild(document.createTextNode(a));this.ctr++},e.flush=function(){this.tags.forEach(function(a){var o;return(o=a.parentNode)==null?void 0:o.removeChild(a)}),this.tags=[],this.ctr=0},t})(),Js="-ms-",p2="-moz-",So="-webkit-",t3="comm",YT="rule",qT="decl",HO="@import",n3="@keyframes",WO="@layer",VO=Math.abs,aC=String.fromCharCode,GO=Object.assign;function KO(t,e){return Bs(t,0)^45?(((e<<2^Bs(t,0))<<2^Bs(t,1))<<2^Bs(t,2))<<2^Bs(t,3):0}function r3(t){return t.trim()}function YO(t,e){return(t=e.exec(t))?t[0]:t}function wo(t,e,r){return t.replace(e,r)}function Fw(t,e){return t.indexOf(e)}function Bs(t,e){return t.charCodeAt(e)|0}function Ky(t,e,r){return t.slice(e,r)}function hu(t){return t.length}function QT(t){return t.length}function mx(t,e){return e.push(t),t}function qO(t,e){return t.map(e).join("")}var sC=1,Gm=1,o3=0,el=0,us=0,og="";function iC(t,e,r,a,o,n,f){return{value:t,root:e,parent:r,type:a,props:o,children:n,line:sC,column:Gm,length:f,return:""}}function ly(t,e){return GO(iC("",null,null,"",null,null,0),t,{length:-t.length},e)}function QO(){return us}function XO(){return us=el>0?Bs(og,--el):0,Gm--,us===10&&(Gm=1,sC--),us}function Cl(){return us=el<o3?Bs(og,el++):0,Gm++,us===10&&(Gm=1,sC++),us}function Tu(){return Bs(og,el)}function Gx(){return el}function pb(t,e){return Ky(og,t,e)}function Yy(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function a3(t){return sC=Gm=1,o3=hu(og=t),el=0,[]}function s3(t){return og="",t}function Kx(t){return r3(pb(el-1,Nw(t===91?t+2:t===40?t+1:t)))}function JO(t){for(;(us=Tu())&&us<33;)Cl();return Yy(t)>2||Yy(us)>3?"":" "}function ZO(t,e){for(;--e&&Cl()&&!(us<48||us>102||us>57&&us<65||us>70&&us<97););return pb(t,Gx()+(e<6&&Tu()==32&&Cl()==32))}function Nw(t){for(;Cl();)switch(us){case t:return el;case 34:case 39:t!==34&&t!==39&&Nw(us);break;case 40:t===41&&Nw(t);break;case 92:Cl();break}return el}function eF(t,e){for(;Cl()&&t+us!==57;)if(t+us===84&&Tu()===47)break;return"/*"+pb(e,el-1)+"*"+aC(t===47?t:Cl())}function tF(t){for(;!Yy(Tu());)Cl();return pb(t,el)}function nF(t){return s3(Yx("",null,null,null,[""],t=a3(t),0,[0],t))}function Yx(t,e,r,a,o,n,f,m,y){for(var C=0,w=0,A=f,R=0,I=0,M=0,F=1,O=1,j=1,U=0,H="",K=o,W=n,X=a,ee=H;O;)switch(M=U,U=Cl()){case 40:if(M!=108&&Bs(ee,A-1)==58){Fw(ee+=wo(Kx(U),"&","&\f"),"&\f")!=-1&&(j=-1);break}case 34:case 39:case 91:ee+=Kx(U);break;case 9:case 10:case 13:case 32:ee+=JO(M);break;case 92:ee+=ZO(Gx()-1,7);continue;case 47:switch(Tu()){case 42:case 47:mx(rF(eF(Cl(),Gx()),e,r),y);break;default:ee+="/"}break;case 123*F:m[C++]=hu(ee)*j;case 125*F:case 59:case 0:switch(U){case 0:case 125:O=0;case 59+w:j==-1&&(ee=wo(ee,/\f/g,"")),I>0&&hu(ee)-A&&mx(I>32?Wk(ee+";",a,r,A-1):Wk(wo(ee," ","")+";",a,r,A-2),y);break;case 59:ee+=";";default:if(mx(X=Hk(ee,e,r,C,w,o,m,H,K=[],W=[],A),n),U===123)if(w===0)Yx(ee,e,X,X,K,n,A,m,W);else switch(R===99&&Bs(ee,3)===110?100:R){case 100:case 108:case 109:case 115:Yx(t,X,X,a&&mx(Hk(t,X,X,0,0,o,m,H,o,K=[],A),W),o,W,A,m,a?K:W);break;default:Yx(ee,X,X,X,[""],W,0,m,W)}}C=w=I=0,F=j=1,H=ee="",A=f;break;case 58:A=1+hu(ee),I=M;default:if(F<1){if(U==123)--F;else if(U==125&&F++==0&&XO()==125)continue}switch(ee+=aC(U),U*F){case 38:j=w>0?1:(ee+="\f",-1);break;case 44:m[C++]=(hu(ee)-1)*j,j=1;break;case 64:Tu()===45&&(ee+=Kx(Cl())),R=Tu(),w=A=hu(H=ee+=tF(Gx())),U++;break;case 45:M===45&&hu(ee)==2&&(F=0)}}return n}function Hk(t,e,r,a,o,n,f,m,y,C,w){for(var A=o-1,R=o===0?n:[""],I=QT(R),M=0,F=0,O=0;M<a;++M)for(var j=0,U=Ky(t,A+1,A=VO(F=f[M])),H=t;j<I;++j)(H=r3(F>0?R[j]+" "+U:wo(U,/&\f/g,R[j])))&&(y[O++]=H);return iC(t,e,r,o===0?YT:m,y,C,w)}function rF(t,e,r){return iC(t,e,r,t3,aC(QO()),Ky(t,2,-2),0)}function Wk(t,e,r,a){return iC(t,e,r,qT,Ky(t,0,a),Ky(t,a+1,-1),a)}function Om(t,e){for(var r="",a=QT(t),o=0;o<a;o++)r+=e(t[o],o,t,e)||"";return r}function oF(t,e,r,a){switch(t.type){case WO:if(t.children.length)break;case HO:case qT:return t.return=t.return||t.value;case t3:return"";case n3:return t.return=t.value+"{"+Om(t.children,a)+"}";case YT:t.value=t.props.join(",")}return hu(r=Om(t.children,a))?t.return=t.value+"{"+r+"}":""}function aF(t){var e=QT(t);return function(r,a,o,n){for(var f="",m=0;m<e;m++)f+=t[m](r,a,o,n)||"";return f}}function sF(t){return function(e){e.root||(e=e.return)&&t(e)}}function i3(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var iF=function(e,r,a){for(var o=0,n=0;o=n,n=Tu(),o===38&&n===12&&(r[a]=1),!Yy(n);)Cl();return pb(e,el)},lF=function(e,r){var a=-1,o=44;do switch(Yy(o)){case 0:o===38&&Tu()===12&&(r[a]=1),e[a]+=iF(el-1,r,a);break;case 2:e[a]+=Kx(o);break;case 4:if(o===44){e[++a]=Tu()===58?"&\f":"",r[a]=e[a].length;break}default:e[a]+=aC(o)}while(o=Cl());return e},cF=function(e,r){return s3(lF(a3(e),r))},Vk=new WeakMap,uF=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,a=e.parent,o=e.column===a.column&&e.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!Vk.get(a))&&!o){Vk.set(e,!0);for(var n=[],f=cF(r,n),m=a.props,y=0,C=0;y<f.length;y++)for(var w=0;w<m.length;w++,C++)e.props[C]=n[y]?f[y].replace(/&\f/g,m[w]):m[w]+" "+f[y]}}},dF=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function l3(t,e){switch(KO(t,e)){case 5103:return So+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return So+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return So+t+p2+t+Js+t+t;case 6828:case 4268:return So+t+Js+t+t;case 6165:return So+t+Js+"flex-"+t+t;case 5187:return So+t+wo(t,/(\w+).+(:[^]+)/,So+"box-$1$2"+Js+"flex-$1$2")+t;case 5443:return So+t+Js+"flex-item-"+wo(t,/flex-|-self/,"")+t;case 4675:return So+t+Js+"flex-line-pack"+wo(t,/align-content|flex-|-self/,"")+t;case 5548:return So+t+Js+wo(t,"shrink","negative")+t;case 5292:return So+t+Js+wo(t,"basis","preferred-size")+t;case 6060:return So+"box-"+wo(t,"-grow","")+So+t+Js+wo(t,"grow","positive")+t;case 4554:return So+wo(t,/([^-])(transform)/g,"$1"+So+"$2")+t;case 6187:return wo(wo(wo(t,/(zoom-|grab)/,So+"$1"),/(image-set)/,So+"$1"),t,"")+t;case 5495:case 3959:return wo(t,/(image-set\([^]*)/,So+"$1$`$1");case 4968:return wo(wo(t,/(.+:)(flex-)?(.*)/,So+"box-pack:$3"+Js+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+So+t+t;case 4095:case 3583:case 4068:case 2532:return wo(t,/(.+)-inline(.+)/,So+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(hu(t)-1-e>6)switch(Bs(t,e+1)){case 109:if(Bs(t,e+4)!==45)break;case 102:return wo(t,/(.+:)(.+)-([^]+)/,"$1"+So+"$2-$3$1"+p2+(Bs(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Fw(t,"stretch")?l3(wo(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Bs(t,e+1)!==115)break;case 6444:switch(Bs(t,hu(t)-3-(~Fw(t,"!important")&&10))){case 107:return wo(t,":",":"+So)+t;case 101:return wo(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+So+(Bs(t,14)===45?"inline-":"")+"box$3$1"+So+"$2$3$1"+Js+"$2box$3")+t}break;case 5936:switch(Bs(t,e+11)){case 114:return So+t+Js+wo(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return So+t+Js+wo(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return So+t+Js+wo(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return So+t+Js+t+t}return t}var fF=function(e,r,a,o){if(e.length>-1&&!e.return)switch(e.type){case qT:e.return=l3(e.value,e.length);break;case n3:return Om([ly(e,{value:wo(e.value,"@","@"+So)})],o);case YT:if(e.length)return qO(e.props,function(n){switch(YO(n,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Om([ly(e,{props:[wo(n,/:(read-\w+)/,":"+p2+"$1")]})],o);case"::placeholder":return Om([ly(e,{props:[wo(n,/:(plac\w+)/,":"+So+"input-$1")]}),ly(e,{props:[wo(n,/:(plac\w+)/,":"+p2+"$1")]}),ly(e,{props:[wo(n,/:(plac\w+)/,Js+"input-$1")]})],o)}return""})}},hF=[fF],pF=function(e){var r=e.key;if(r==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(F){var O=F.getAttribute("data-emotion");O.indexOf(" ")!==-1&&(document.head.appendChild(F),F.setAttribute("data-s",""))})}var o=e.stylisPlugins||hF,n={},f,m=[];f=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(F){for(var O=F.getAttribute("data-emotion").split(" "),j=1;j<O.length;j++)n[O[j]]=!0;m.push(F)});var y,C=[uF,dF];{var w,A=[oF,sF(function(F){w.insert(F)})],R=aF(C.concat(o,A)),I=function(O){return Om(nF(O),R)};y=function(O,j,U,H){w=U,I(O?O+"{"+j.styles+"}":j.styles),H&&(M.inserted[j.name]=!0)}}var M={key:r,sheet:new $O({key:r,container:f,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:n,registered:{},insert:y};return M.sheet.hydrate(m),M},qS={exports:{}},Io={};var Gk;function mF(){if(Gk)return Io;Gk=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,a=t?Symbol.for("react.fragment"):60107,o=t?Symbol.for("react.strict_mode"):60108,n=t?Symbol.for("react.profiler"):60114,f=t?Symbol.for("react.provider"):60109,m=t?Symbol.for("react.context"):60110,y=t?Symbol.for("react.async_mode"):60111,C=t?Symbol.for("react.concurrent_mode"):60111,w=t?Symbol.for("react.forward_ref"):60112,A=t?Symbol.for("react.suspense"):60113,R=t?Symbol.for("react.suspense_list"):60120,I=t?Symbol.for("react.memo"):60115,M=t?Symbol.for("react.lazy"):60116,F=t?Symbol.for("react.block"):60121,O=t?Symbol.for("react.fundamental"):60117,j=t?Symbol.for("react.responder"):60118,U=t?Symbol.for("react.scope"):60119;function H(W){if(typeof W=="object"&&W!==null){var X=W.$$typeof;switch(X){case e:switch(W=W.type,W){case y:case C:case a:case n:case o:case A:return W;default:switch(W=W&&W.$$typeof,W){case m:case w:case M:case I:case f:return W;default:return X}}case r:return X}}}function K(W){return H(W)===C}return Io.AsyncMode=y,Io.ConcurrentMode=C,Io.ContextConsumer=m,Io.ContextProvider=f,Io.Element=e,Io.ForwardRef=w,Io.Fragment=a,Io.Lazy=M,Io.Memo=I,Io.Portal=r,Io.Profiler=n,Io.StrictMode=o,Io.Suspense=A,Io.isAsyncMode=function(W){return K(W)||H(W)===y},Io.isConcurrentMode=K,Io.isContextConsumer=function(W){return H(W)===m},Io.isContextProvider=function(W){return H(W)===f},Io.isElement=function(W){return typeof W=="object"&&W!==null&&W.$$typeof===e},Io.isForwardRef=function(W){return H(W)===w},Io.isFragment=function(W){return H(W)===a},Io.isLazy=function(W){return H(W)===M},Io.isMemo=function(W){return H(W)===I},Io.isPortal=function(W){return H(W)===r},Io.isProfiler=function(W){return H(W)===n},Io.isStrictMode=function(W){return H(W)===o},Io.isSuspense=function(W){return H(W)===A},Io.isValidElementType=function(W){return typeof W=="string"||typeof W=="function"||W===a||W===C||W===n||W===o||W===A||W===R||typeof W=="object"&&W!==null&&(W.$$typeof===M||W.$$typeof===I||W.$$typeof===f||W.$$typeof===m||W.$$typeof===w||W.$$typeof===O||W.$$typeof===j||W.$$typeof===U||W.$$typeof===F)},Io.typeOf=H,Io}var Kk;function gF(){return Kk||(Kk=1,qS.exports=mF()),qS.exports}var QS,Yk;function yF(){if(Yk)return QS;Yk=1;var t=gF(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},n={};n[t.ForwardRef]=a,n[t.Memo]=o;function f(M){return t.isMemo(M)?o:n[M.$$typeof]||e}var m=Object.defineProperty,y=Object.getOwnPropertyNames,C=Object.getOwnPropertySymbols,w=Object.getOwnPropertyDescriptor,A=Object.getPrototypeOf,R=Object.prototype;function I(M,F,O){if(typeof F!="string"){if(R){var j=A(F);j&&j!==R&&I(M,j,O)}var U=y(F);C&&(U=U.concat(C(F)));for(var H=f(M),K=f(F),W=0;W<U.length;++W){var X=U[W];if(!r[X]&&!(O&&O[X])&&!(K&&K[X])&&!(H&&H[X])){var ee=w(F,X);try{m(M,X,ee)}catch{}}}}return M}return QS=I,QS}yF();var bF=!0;function c3(t,e,r){var a="";return r.split(" ").forEach(function(o){t[o]!==void 0?e.push(t[o]+";"):o&&(a+=o+" ")}),a}var XT=function(e,r,a){var o=e.key+"-"+r.name;(a===!1||bF===!1)&&e.registered[o]===void 0&&(e.registered[o]=r.styles)},JT=function(e,r,a){XT(e,r,a);var o=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var n=r;do e.insert(r===n?"."+o:"",n,e.sheet,!0),n=n.next;while(n!==void 0)}};function vF(t){for(var e=0,r,a=0,o=t.length;o>=4;++a,o-=4)r=t.charCodeAt(a)&255|(t.charCodeAt(++a)&255)<<8|(t.charCodeAt(++a)&255)<<16|(t.charCodeAt(++a)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(o){case 3:e^=(t.charCodeAt(a+2)&255)<<16;case 2:e^=(t.charCodeAt(a+1)&255)<<8;case 1:e^=t.charCodeAt(a)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var xF={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},CF=/[A-Z]|^ms/g,SF=/_EMO_([^_]+?)_([^]*?)_EMO_/g,u3=function(e){return e.charCodeAt(1)===45},qk=function(e){return e!=null&&typeof e!="boolean"},XS=i3(function(t){return u3(t)?t:t.replace(CF,"-$&").toLowerCase()}),Qk=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(SF,function(a,o,n){return pu={name:o,styles:n,next:pu},o})}return xF[e]!==1&&!u3(e)&&typeof r=="number"&&r!==0?r+"px":r};function qy(t,e,r){if(r==null)return"";var a=r;if(a.__emotion_styles!==void 0)return a;switch(typeof r){case"boolean":return"";case"object":{var o=r;if(o.anim===1)return pu={name:o.name,styles:o.styles,next:pu},o.name;var n=r;if(n.styles!==void 0){var f=n.next;if(f!==void 0)for(;f!==void 0;)pu={name:f.name,styles:f.styles,next:pu},f=f.next;var m=n.styles+";";return m}return wF(t,e,r)}case"function":{if(t!==void 0){var y=pu,C=r(t);return pu=y,qy(t,e,C)}break}}var w=r;if(e==null)return w;var A=e[w];return A!==void 0?A:w}function wF(t,e,r){var a="";if(Array.isArray(r))for(var o=0;o<r.length;o++)a+=qy(t,e,r[o])+";";else for(var n in r){var f=r[n];if(typeof f!="object"){var m=f;e!=null&&e[m]!==void 0?a+=n+"{"+e[m]+"}":qk(m)&&(a+=XS(n)+":"+Qk(n,m)+";")}else if(Array.isArray(f)&&typeof f[0]=="string"&&(e==null||e[f[0]]===void 0))for(var y=0;y<f.length;y++)qk(f[y])&&(a+=XS(n)+":"+Qk(n,f[y])+";");else{var C=qy(t,e,f);switch(n){case"animation":case"animationName":{a+=XS(n)+":"+C+";";break}default:a+=n+"{"+C+"}"}}}return a}var Xk=/label:\s*([^\s;{]+)\s*(;|$)/g,pu;function mb(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var a=!0,o="";pu=void 0;var n=t[0];if(n==null||n.raw===void 0)a=!1,o+=qy(r,e,n);else{var f=n;o+=f[0]}for(var m=1;m<t.length;m++)if(o+=qy(r,e,t[m]),a){var y=n;o+=y[m]}Xk.lastIndex=0;for(var C="",w;(w=Xk.exec(o))!==null;)C+="-"+w[1];var A=vF(o)+C;return{name:A,styles:o,next:pu}}var TF=function(e){return e()},d3=h2.useInsertionEffect?h2.useInsertionEffect:!1,f3=d3||TF,Jk=d3||E.useLayoutEffect,h3=E.createContext(typeof HTMLElement<"u"?pF({key:"css"}):null);h3.Provider;var ZT=function(e){return E.forwardRef(function(r,a){var o=E.useContext(h3);return e(r,o,a)})},gb=E.createContext({}),eA={}.hasOwnProperty,jw="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",AF=function(e,r){var a={};for(var o in r)eA.call(r,o)&&(a[o]=r[o]);return a[jw]=e,a},EF=function(e){var r=e.cache,a=e.serialized,o=e.isStringTag;return XT(r,a,o),f3(function(){return JT(r,a,o)}),null},kF=ZT(function(t,e,r){var a=t.css;typeof a=="string"&&e.registered[a]!==void 0&&(a=e.registered[a]);var o=t[jw],n=[a],f="";typeof t.className=="string"?f=c3(e.registered,n,t.className):t.className!=null&&(f=t.className+" ");var m=mb(n,void 0,E.useContext(gb));f+=e.key+"-"+m.name;var y={};for(var C in t)eA.call(t,C)&&C!=="css"&&C!==jw&&(y[C]=t[C]);return y.className=f,r&&(y.ref=r),E.createElement(E.Fragment,null,E.createElement(EF,{cache:e,serialized:m,isStringTag:typeof o=="string"}),E.createElement(o,y))}),DF=kF,Zk=function(e,r){var a=arguments;if(r==null||!eA.call(r,"css"))return E.createElement.apply(void 0,a);var o=a.length,n=new Array(o);n[0]=DF,n[1]=AF(e,r);for(var f=2;f<o;f++)n[f]=a[f];return E.createElement.apply(null,n)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(Zk||(Zk={}));var RF=ZT(function(t,e){var r=t.styles,a=mb([r],void 0,E.useContext(gb)),o=E.useRef();return Jk(function(){var n=e.key+"-global",f=new e.sheet.constructor({key:n,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),m=!1,y=document.querySelector('style[data-emotion="'+n+" "+a.name+'"]');return e.sheet.tags.length&&(f.before=e.sheet.tags[0]),y!==null&&(m=!0,y.setAttribute("data-emotion",n),f.hydrate([y])),o.current=[f,m],function(){f.flush()}},[e]),Jk(function(){var n=o.current,f=n[0],m=n[1];if(m){n[1]=!1;return}if(a.next!==void 0&&JT(e,a.next,!0),f.tags.length){var y=f.tags[f.tags.length-1].nextElementSibling;f.before=y,f.flush()}e.insert("",a,f,!1)},[e,a.name]),null});function ag(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return mb(e)}function Uf(){var t=ag.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var IF=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,PF=i3(function(t){return IF.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),MF=PF,_F=function(e){return e!=="theme"},e4=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?MF:_F},t4=function(e,r,a){var o;if(r){var n=r.shouldForwardProp;o=e.__emotion_forwardProp&&n?function(f){return e.__emotion_forwardProp(f)&&n(f)}:n}return typeof o!="function"&&a&&(o=e.__emotion_forwardProp),o},OF=function(e){var r=e.cache,a=e.serialized,o=e.isStringTag;return XT(r,a,o),f3(function(){return JT(r,a,o)}),null},FF=function t(e,r){var a=e.__emotion_real===e,o=a&&e.__emotion_base||e,n,f;r!==void 0&&(n=r.label,f=r.target);var m=t4(e,r,a),y=m||e4(o),C=!y("as");return function(){var w=arguments,A=a&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(n!==void 0&&A.push("label:"+n+";"),w[0]==null||w[0].raw===void 0)A.push.apply(A,w);else{var R=w[0];A.push(R[0]);for(var I=w.length,M=1;M<I;M++)A.push(w[M],R[M])}var F=ZT(function(O,j,U){var H=C&&O.as||o,K="",W=[],X=O;if(O.theme==null){X={};for(var ee in O)X[ee]=O[ee];X.theme=E.useContext(gb)}typeof O.className=="string"?K=c3(j.registered,W,O.className):O.className!=null&&(K=O.className+" ");var ie=mb(A.concat(W),j.registered,X);K+=j.key+"-"+ie.name,f!==void 0&&(K+=" "+f);var de=C&&m===void 0?e4(H):y,le={};for(var oe in O)C&&oe==="as"||de(oe)&&(le[oe]=O[oe]);return le.className=K,U&&(le.ref=U),E.createElement(E.Fragment,null,E.createElement(OF,{cache:j,serialized:ie,isStringTag:typeof H=="string"}),E.createElement(H,le))});return F.displayName=n!==void 0?n:"Styled("+(typeof o=="string"?o:o.displayName||o.name||"Component")+")",F.defaultProps=e.defaultProps,F.__emotion_real=F,F.__emotion_base=o,F.__emotion_styles=A,F.__emotion_forwardProp=m,Object.defineProperty(F,"toString",{value:function(){return"."+f}}),F.withComponent=function(O,j){var U=t(O,Xe({},r,j,{shouldForwardProp:t4(F,j,!0)}));return U.apply(void 0,A)},F}},NF=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Lw=FF.bind(null);NF.forEach(function(t){Lw[t]=Lw(t)});var JS={exports:{}},ZS,n4;function jF(){if(n4)return ZS;n4=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ZS=t,ZS}var ew,r4;function LF(){if(r4)return ew;r4=1;var t=jF();function e(){}function r(){}return r.resetWarningCache=e,ew=function(){function a(f,m,y,C,w,A){if(A!==t){var R=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw R.name="Invariant Violation",R}}a.isRequired=a;function o(){return a}var n={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:o,element:a,elementType:a,instanceOf:o,node:a,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:r,resetWarningCache:e};return n.PropTypes=n,n},ew}var o4;function BF(){return o4||(o4=1,JS.exports=LF()()),JS.exports}var zF=BF();const kt=hb(zF);function UF(t){return t==null||Object.keys(t).length===0}function p3(t){const{styles:e,defaultTheme:r={}}=t,a=typeof e=="function"?o=>e(UF(o)?r:o):e;return d.jsx(RF,{styles:a})}function m3(t,e){return Lw(t,e)}function $F(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const a4=[];function Pf(t){return a4[0]=t,mb(a4)}var tw={exports:{}},Ho={};var s4;function HF(){if(s4)return Ho;s4=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),n=Symbol.for("react.consumer"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),R=Symbol.for("react.view_transition"),I=Symbol.for("react.client.reference");function M(F){if(typeof F=="object"&&F!==null){var O=F.$$typeof;switch(O){case t:switch(F=F.type,F){case r:case o:case a:case y:case C:case R:return F;default:switch(F=F&&F.$$typeof,F){case f:case m:case A:case w:return F;case n:return F;default:return O}}case e:return O}}}return Ho.ContextConsumer=n,Ho.ContextProvider=f,Ho.Element=t,Ho.ForwardRef=m,Ho.Fragment=r,Ho.Lazy=A,Ho.Memo=w,Ho.Portal=e,Ho.Profiler=o,Ho.StrictMode=a,Ho.Suspense=y,Ho.SuspenseList=C,Ho.isContextConsumer=function(F){return M(F)===n},Ho.isContextProvider=function(F){return M(F)===f},Ho.isElement=function(F){return typeof F=="object"&&F!==null&&F.$$typeof===t},Ho.isForwardRef=function(F){return M(F)===m},Ho.isFragment=function(F){return M(F)===r},Ho.isLazy=function(F){return M(F)===A},Ho.isMemo=function(F){return M(F)===w},Ho.isPortal=function(F){return M(F)===e},Ho.isProfiler=function(F){return M(F)===o},Ho.isStrictMode=function(F){return M(F)===a},Ho.isSuspense=function(F){return M(F)===y},Ho.isSuspenseList=function(F){return M(F)===C},Ho.isValidElementType=function(F){return typeof F=="string"||typeof F=="function"||F===r||F===o||F===a||F===y||F===C||typeof F=="object"&&F!==null&&(F.$$typeof===A||F.$$typeof===w||F.$$typeof===f||F.$$typeof===n||F.$$typeof===m||F.$$typeof===I||F.getModuleId!==void 0)},Ho.typeOf=M,Ho}var i4;function WF(){return i4||(i4=1,tw.exports=HF()),tw.exports}var g3=WF();function gu(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function y3(t){if(E.isValidElement(t)||g3.isValidElementType(t)||!gu(t))return t;const e={};return Object.keys(t).forEach(r=>{e[r]=y3(t[r])}),e}function ri(t,e,r={clone:!0}){const a=r.clone?{...t}:t;return gu(t)&&gu(e)&&Object.keys(e).forEach(o=>{E.isValidElement(e[o])||g3.isValidElementType(e[o])?a[o]=e[o]:gu(e[o])&&Object.prototype.hasOwnProperty.call(t,o)&&gu(t[o])?a[o]=ri(t[o],e[o],r):r.clone?a[o]=gu(e[o])?y3(e[o]):e[o]:a[o]=e[o]}),a}const VF=t=>{const e=Object.keys(t).map(r=>({key:r,val:t[r]}))||[];return e.sort((r,a)=>r.val-a.val),e.reduce((r,a)=>({...r,[a.key]:a.val}),{})};function GF(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:a=5,...o}=t,n=VF(e),f=Object.keys(n);function m(R){return`@media (min-width:${typeof e[R]=="number"?e[R]:R}${r})`}function y(R){return`@media (max-width:${(typeof e[R]=="number"?e[R]:R)-a/100}${r})`}function C(R,I){const M=f.indexOf(I);return`@media (min-width:${typeof e[R]=="number"?e[R]:R}${r}) and (max-width:${(M!==-1&&typeof e[f[M]]=="number"?e[f[M]]:I)-a/100}${r})`}function w(R){return f.indexOf(R)+1<f.length?C(R,f[f.indexOf(R)+1]):m(R)}function A(R){const I=f.indexOf(R);return I===0?m(f[1]):I===f.length-1?y(f[I]):C(R,f[f.indexOf(R)+1]).replace("@media","@media not all and")}return{keys:f,values:n,up:m,down:y,between:C,only:w,not:A,unit:r,...o}}function l4(t,e){if(!t.containerQueries)return e;const r=Object.keys(e).filter(a=>a.startsWith("@container")).sort((a,o)=>{const n=/min-width:\s*([0-9.]+)/;return+(a.match(n)?.[1]||0)-+(o.match(n)?.[1]||0)});return r.length?r.reduce((a,o)=>{const n=e[o];return delete a[o],a[o]=n,a},{...e}):e}function KF(t,e){return e==="@"||e.startsWith("@")&&(t.some(r=>e.startsWith(`@${r}`))||!!e.match(/^@\d/))}function YF(t,e){const r=e.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;const[,a,o]=r,n=Number.isNaN(+a)?a||0:+a;return t.containerQueries(o).up(n)}function qF(t){const e=(n,f)=>n.replace("@media",f?`@container ${f}`:"@container");function r(n,f){n.up=(...m)=>e(t.breakpoints.up(...m),f),n.down=(...m)=>e(t.breakpoints.down(...m),f),n.between=(...m)=>e(t.breakpoints.between(...m),f),n.only=(...m)=>e(t.breakpoints.only(...m),f),n.not=(...m)=>{const y=e(t.breakpoints.not(...m),f);return y.includes("not all and")?y.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):y}}const a={},o=n=>(r(a,n),a);return r(o),{...t,containerQueries:o}}const QF={borderRadius:4};function Iy(t,e){return e?ri(t,e,{clone:!1}):t}const lC={xs:0,sm:600,md:900,lg:1200,xl:1536},c4={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${lC[t]}px)`},XF={containerQueries:t=>({up:e=>{let r=typeof e=="number"?e:lC[e]||e;return typeof r=="number"&&(r=`${r}px`),t?`@container ${t} (min-width:${r})`:`@container (min-width:${r})`}})};function Cd(t,e,r){const a=t.theme||{};if(Array.isArray(e)){const n=a.breakpoints||c4;return e.reduce((f,m,y)=>(f[n.up(n.keys[y])]=r(e[y]),f),{})}if(typeof e=="object"){const n=a.breakpoints||c4;return Object.keys(e).reduce((f,m)=>{if(KF(n.keys,m)){const y=YF(a.containerQueries?a:XF,m);y&&(f[y]=r(e[m],m))}else if(Object.keys(n.values||lC).includes(m)){const y=n.up(m);f[y]=r(e[m],m)}else{const y=m;f[y]=e[y]}return f},{})}return r(e)}function JF(t={}){return t.keys?.reduce((r,a)=>{const o=t.up(a);return r[o]={},r},{})||{}}function u4(t,e){return t.reduce((r,a)=>{const o=r[a];return(!o||Object.keys(o).length===0)&&delete r[a],r},e)}function At(t){if(typeof t!="string")throw new Error(xd(7));return t.charAt(0).toUpperCase()+t.slice(1)}function cC(t,e,r=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&r){const a=`vars.${e}`.split(".").reduce((o,n)=>o&&o[n]?o[n]:null,t);if(a!=null)return a}return e.split(".").reduce((a,o)=>a&&a[o]!=null?a[o]:null,t)}function m2(t,e,r,a=r){let o;return typeof t=="function"?o=t(r):Array.isArray(t)?o=t[r]||a:o=cC(t,r)||a,e&&(o=e(o,a,t)),o}function es(t){const{prop:e,cssProperty:r=t.prop,themeKey:a,transform:o}=t,n=f=>{if(f[e]==null)return null;const m=f[e],y=f.theme,C=cC(y,a)||{};return Cd(f,m,A=>{let R=m2(C,o,A);return A===R&&typeof A=="string"&&(R=m2(C,o,`${e}${A==="default"?"":At(A)}`,A)),r===!1?R:{[r]:R}})};return n.propTypes={},n.filterProps=[e],n}function ZF(t){const e={};return r=>(e[r]===void 0&&(e[r]=t(r)),e[r])}const eN={m:"margin",p:"padding"},tN={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},d4={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},nN=ZF(t=>{if(t.length>2)if(d4[t])t=d4[t];else return[t];const[e,r]=t.split(""),a=eN[e],o=tN[r]||"";return Array.isArray(o)?o.map(n=>a+n):[a+o]}),tA=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],nA=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...tA,...nA];function yb(t,e,r,a){const o=cC(t,e,!0)??r;return typeof o=="number"||typeof o=="string"?n=>typeof n=="string"?n:typeof o=="string"?o.startsWith("var(")&&n===0?0:o.startsWith("var(")&&n===1?o:`calc(${n} * ${o})`:o*n:Array.isArray(o)?n=>{if(typeof n=="string")return n;const f=Math.abs(n),m=o[f];return n>=0?m:typeof m=="number"?-m:typeof m=="string"&&m.startsWith("var(")?`calc(-1 * ${m})`:`-${m}`}:typeof o=="function"?o:()=>{}}function rA(t){return yb(t,"spacing",8)}function bb(t,e){return typeof e=="string"||e==null?e:t(e)}function rN(t,e){return r=>t.reduce((a,o)=>(a[o]=bb(e,r),a),{})}function oN(t,e,r,a){if(!e.includes(r))return null;const o=nN(r),n=rN(o,a),f=t[r];return Cd(t,f,n)}function b3(t,e){const r=rA(t.theme);return Object.keys(t).map(a=>oN(t,e,a,r)).reduce(Iy,{})}function Na(t){return b3(t,tA)}Na.propTypes={};Na.filterProps=tA;function ja(t){return b3(t,nA)}ja.propTypes={};ja.filterProps=nA;function v3(t=8,e=rA({spacing:t})){if(t.mui)return t;const r=(...a)=>(a.length===0?[1]:a).map(n=>{const f=e(n);return typeof f=="number"?`${f}px`:f}).join(" ");return r.mui=!0,r}function uC(...t){const e=t.reduce((a,o)=>(o.filterProps.forEach(n=>{a[n]=o}),a),{}),r=a=>Object.keys(a).reduce((o,n)=>e[n]?Iy(o,e[n](a)):o,{});return r.propTypes={},r.filterProps=t.reduce((a,o)=>a.concat(o.filterProps),[]),r}function Kl(t){return typeof t!="number"?t:`${t}px solid`}function tc(t,e){return es({prop:t,themeKey:"borders",transform:e})}const aN=tc("border",Kl),sN=tc("borderTop",Kl),iN=tc("borderRight",Kl),lN=tc("borderBottom",Kl),cN=tc("borderLeft",Kl),uN=tc("borderColor"),dN=tc("borderTopColor"),fN=tc("borderRightColor"),hN=tc("borderBottomColor"),pN=tc("borderLeftColor"),mN=tc("outline",Kl),gN=tc("outlineColor"),dC=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=yb(t.theme,"shape.borderRadius",4),r=a=>({borderRadius:bb(e,a)});return Cd(t,t.borderRadius,r)}return null};dC.propTypes={};dC.filterProps=["borderRadius"];uC(aN,sN,iN,lN,cN,uN,dN,fN,hN,pN,dC,mN,gN);const fC=t=>{if(t.gap!==void 0&&t.gap!==null){const e=yb(t.theme,"spacing",8),r=a=>({gap:bb(e,a)});return Cd(t,t.gap,r)}return null};fC.propTypes={};fC.filterProps=["gap"];const hC=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=yb(t.theme,"spacing",8),r=a=>({columnGap:bb(e,a)});return Cd(t,t.columnGap,r)}return null};hC.propTypes={};hC.filterProps=["columnGap"];const pC=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=yb(t.theme,"spacing",8),r=a=>({rowGap:bb(e,a)});return Cd(t,t.rowGap,r)}return null};pC.propTypes={};pC.filterProps=["rowGap"];const yN=es({prop:"gridColumn"}),bN=es({prop:"gridRow"}),vN=es({prop:"gridAutoFlow"}),xN=es({prop:"gridAutoColumns"}),CN=es({prop:"gridAutoRows"}),SN=es({prop:"gridTemplateColumns"}),wN=es({prop:"gridTemplateRows"}),TN=es({prop:"gridTemplateAreas"}),AN=es({prop:"gridArea"});uC(fC,hC,pC,yN,bN,vN,xN,CN,SN,wN,TN,AN);function Fm(t,e){return e==="grey"?e:t}const EN=es({prop:"color",themeKey:"palette",transform:Fm}),kN=es({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Fm}),DN=es({prop:"backgroundColor",themeKey:"palette",transform:Fm});uC(EN,kN,DN);function vl(t){return t<=1&&t!==0?`${t*100}%`:t}const RN=es({prop:"width",transform:vl}),oA=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=r=>{const a=t.theme?.breakpoints?.values?.[r]||lC[r];return a?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${a}${t.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:vl(r)}};return Cd(t,t.maxWidth,e)}return null};oA.filterProps=["maxWidth"];const IN=es({prop:"minWidth",transform:vl}),PN=es({prop:"height",transform:vl}),MN=es({prop:"maxHeight",transform:vl}),_N=es({prop:"minHeight",transform:vl});es({prop:"size",cssProperty:"width",transform:vl});es({prop:"size",cssProperty:"height",transform:vl});const ON=es({prop:"boxSizing"});uC(RN,oA,IN,PN,MN,_N,ON);const vb={border:{themeKey:"borders",transform:Kl},borderTop:{themeKey:"borders",transform:Kl},borderRight:{themeKey:"borders",transform:Kl},borderBottom:{themeKey:"borders",transform:Kl},borderLeft:{themeKey:"borders",transform:Kl},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Kl},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:dC},color:{themeKey:"palette",transform:Fm},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Fm},backgroundColor:{themeKey:"palette",transform:Fm},p:{style:ja},pt:{style:ja},pr:{style:ja},pb:{style:ja},pl:{style:ja},px:{style:ja},py:{style:ja},padding:{style:ja},paddingTop:{style:ja},paddingRight:{style:ja},paddingBottom:{style:ja},paddingLeft:{style:ja},paddingX:{style:ja},paddingY:{style:ja},paddingInline:{style:ja},paddingInlineStart:{style:ja},paddingInlineEnd:{style:ja},paddingBlock:{style:ja},paddingBlockStart:{style:ja},paddingBlockEnd:{style:ja},m:{style:Na},mt:{style:Na},mr:{style:Na},mb:{style:Na},ml:{style:Na},mx:{style:Na},my:{style:Na},margin:{style:Na},marginTop:{style:Na},marginRight:{style:Na},marginBottom:{style:Na},marginLeft:{style:Na},marginX:{style:Na},marginY:{style:Na},marginInline:{style:Na},marginInlineStart:{style:Na},marginInlineEnd:{style:Na},marginBlock:{style:Na},marginBlockStart:{style:Na},marginBlockEnd:{style:Na},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:fC},rowGap:{style:pC},columnGap:{style:hC},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:vl},maxWidth:{style:oA},minWidth:{transform:vl},height:{transform:vl},maxHeight:{transform:vl},minHeight:{transform:vl},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function FN(...t){const e=t.reduce((a,o)=>a.concat(Object.keys(o)),[]),r=new Set(e);return t.every(a=>r.size===Object.keys(a).length)}function NN(t,e){return typeof t=="function"?t(e):t}function jN(){function t(r,a,o,n){const f={[r]:a,theme:o},m=n[r];if(!m)return{[r]:a};const{cssProperty:y=r,themeKey:C,transform:w,style:A}=m;if(a==null)return null;if(C==="typography"&&a==="inherit")return{[r]:a};const R=cC(o,C)||{};return A?A(f):Cd(f,a,M=>{let F=m2(R,w,M);return M===F&&typeof M=="string"&&(F=m2(R,w,`${r}${M==="default"?"":At(M)}`,M)),y===!1?F:{[y]:F}})}function e(r){const{sx:a,theme:o={},nested:n}=r||{};if(!a)return null;const f=o.unstable_sxConfig??vb;function m(y){let C=y;if(typeof y=="function")C=y(o);else if(typeof y!="object")return y;if(!C)return null;const w=JF(o.breakpoints),A=Object.keys(w);let R=w;return Object.keys(C).forEach(I=>{const M=NN(C[I],o);if(M!=null)if(typeof M=="object")if(f[I])R=Iy(R,t(I,M,o,f));else{const F=Cd({theme:o},M,O=>({[I]:O}));FN(F,M)?R[I]=e({sx:M,theme:o,nested:!0}):R=Iy(R,F)}else R=Iy(R,t(I,M,o,f))}),!n&&o.modularCssLayers?{"@layer sx":l4(o,u4(A,R))}:l4(o,u4(A,R))}return Array.isArray(a)?a.map(m):m(a)}return e}const jf=jN();jf.filterProps=["sx"];function LN(t,e){const r=this;if(r.vars){if(!r.colorSchemes?.[t]||typeof r.getColorSchemeSelector!="function")return{};let a=r.getColorSchemeSelector(t);return a==="&"?e:((a.includes("data-")||a.includes("."))&&(a=`*:where(${a.replace(/\s*&$/,"")}) &`),{[a]:e})}return r.palette.mode===t?e:{}}function mC(t={},...e){const{breakpoints:r={},palette:a={},spacing:o,shape:n={},...f}=t,m=GF(r),y=v3(o);let C=ri({breakpoints:m,direction:"ltr",components:{},palette:{mode:"light",...a},spacing:y,shape:{...QF,...n}},f);return C=qF(C),C.applyStyles=LN,C=e.reduce((w,A)=>ri(w,A),C),C.unstable_sxConfig={...vb,...f?.unstable_sxConfig},C.unstable_sx=function(A){return jf({sx:A,theme:this})},C}function BN(t){return Object.keys(t).length===0}function gC(t=null){const e=E.useContext(gb);return!e||BN(e)?t:e}const zN=mC();function yC(t=zN){return gC(t)}function nw(t){const e=Pf(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function x3({styles:t,themeId:e,defaultTheme:r={}}){const a=yC(r),o=e&&a[e]||a;let n=typeof t=="function"?t(o):t;return o.modularCssLayers&&(Array.isArray(n)?n=n.map(f=>nw(typeof f=="function"?f(o):f)):n=nw(n)),d.jsx(p3,{styles:n})}const UN=t=>{const e={systemProps:{},otherProps:{}},r=t?.theme?.unstable_sxConfig??vb;return Object.keys(t).forEach(a=>{r[a]?e.systemProps[a]=t[a]:e.otherProps[a]=t[a]}),e};function C3(t){const{sx:e,...r}=t,{systemProps:a,otherProps:o}=UN(r);let n;return Array.isArray(e)?n=[a,...e]:typeof e=="function"?n=(...f)=>{const m=e(...f);return gu(m)?{...a,...m}:a}:n={...a,...e},{...o,sx:n}}const f4=t=>t,$N=()=>{let t=f4;return{configure(e){t=e},generate(e){return t(e)},reset(){t=f4}}},S3=$N();function w3(t){var e,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(r=w3(t[e]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Ht(){for(var t,e,r=0,a="",o=arguments.length;r<o;r++)(t=arguments[r])&&(e=w3(t))&&(a&&(a+=" "),a+=e);return a}function HN(t={}){const{themeId:e,defaultTheme:r,defaultClassName:a="MuiBox-root",generateClassName:o}=t,n=m3("div",{shouldForwardProp:m=>m!=="theme"&&m!=="sx"&&m!=="as"})(jf);return E.forwardRef(function(y,C){const w=yC(r),{className:A,component:R="div",...I}=C3(y);return d.jsx(n,{as:R,ref:C,className:Ht(A,o?o(a):a),theme:e&&w[e]||w,...I})})}const WN={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Cn(t,e,r="Mui"){const a=WN[e];return a?`${r}-${a}`:`${S3.generate(t)}-${e}`}function bn(t,e,r="Mui"){const a={};return e.forEach(o=>{a[o]=Cn(t,o,r)}),a}function T3(t){const{variants:e,...r}=t,a={variants:e,style:Pf(r),isProcessed:!0};return a.style===r||e&&e.forEach(o=>{typeof o.style!="function"&&(o.style=Pf(o.style))}),a}const VN=mC();function Au(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function ap(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function GN(t){return t?(e,r)=>r[t]:null}function KN(t,e,r){t.theme=qN(t.theme)?r:t.theme[e]||t.theme}function qx(t,e,r){const a=typeof e=="function"?e(t):e;if(Array.isArray(a))return a.flatMap(o=>qx(t,o,r));if(Array.isArray(a?.variants)){let o;if(a.isProcessed)o=r?ap(a.style,r):a.style;else{const{variants:n,...f}=a;o=r?ap(Pf(f),r):f}return A3(t,a.variants,[o],r)}return a?.isProcessed?r?ap(Pf(a.style),r):a.style:r?ap(Pf(a),r):a}function A3(t,e,r=[],a=void 0){let o;e:for(let n=0;n<e.length;n+=1){const f=e[n];if(typeof f.props=="function"){if(o??={...t,...t.ownerState,ownerState:t.ownerState},!f.props(o))continue}else for(const m in f.props)if(t[m]!==f.props[m]&&t.ownerState?.[m]!==f.props[m])continue e;typeof f.style=="function"?(o??={...t,...t.ownerState,ownerState:t.ownerState},r.push(a?ap(Pf(f.style(o)),a):f.style(o))):r.push(a?ap(Pf(f.style),a):f.style)}return r}function E3(t={}){const{themeId:e,defaultTheme:r=VN,rootShouldForwardProp:a=Au,slotShouldForwardProp:o=Au}=t;function n(m){KN(m,e,r)}return(m,y={})=>{$F(m,X=>X.filter(ee=>ee!==jf));const{name:C,slot:w,skipVariantsResolver:A,skipSx:R,overridesResolver:I=GN(XN(w)),...M}=y,F=C&&C.startsWith("Mui")||w?"components":"custom",O=A!==void 0?A:w&&w!=="Root"&&w!=="root"||!1,j=R||!1;let U=Au;w==="Root"||w==="root"?U=a:w?U=o:QN(m)&&(U=void 0);const H=m3(m,{shouldForwardProp:U,label:YN(),...M}),K=X=>{if(X.__emotion_real===X)return X;if(typeof X=="function")return function(ie){return qx(ie,X,ie.theme.modularCssLayers?F:void 0)};if(gu(X)){const ee=T3(X);return function(de){return ee.variants?qx(de,ee,de.theme.modularCssLayers?F:void 0):de.theme.modularCssLayers?ap(ee.style,F):ee.style}}return X},W=(...X)=>{const ee=[],ie=X.map(K),de=[];if(ee.push(n),C&&I&&de.push(function(ce){const Se=ce.theme.components?.[C]?.styleOverrides;if(!Se)return null;const se={};for(const ye in Se)se[ye]=qx(ce,Se[ye],ce.theme.modularCssLayers?"theme":void 0);return I(ce,se)}),C&&!O&&de.push(function(ce){const Se=ce.theme?.components?.[C]?.variants;return Se?A3(ce,Se,[],ce.theme.modularCssLayers?"theme":void 0):null}),j||de.push(jf),Array.isArray(ie[0])){const N=ie.shift(),ce=new Array(ee.length).fill(""),ne=new Array(de.length).fill("");let Se;Se=[...ce,...N,...ne],Se.raw=[...ce,...N.raw,...ne],ee.unshift(Se)}const le=[...ee,...ie,...de],oe=H(...le);return m.muiName&&(oe.muiName=m.muiName),oe};return H.withConfig&&(W.withConfig=H.withConfig),W}}function YN(t,e){return void 0}function qN(t){for(const e in t)return!1;return!0}function QN(t){return typeof t=="string"&&t.charCodeAt(0)>96}function XN(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const JN=E3();function Km(t,e,r=!1){const a={...e};for(const o in t)if(Object.prototype.hasOwnProperty.call(t,o)){const n=o;if(n==="components"||n==="slots")a[n]={...t[n],...a[n]};else if(n==="componentsProps"||n==="slotProps"){const f=t[n],m=e[n];if(!m)a[n]=f||{};else if(!f)a[n]=m;else{a[n]={...m};for(const y in f)if(Object.prototype.hasOwnProperty.call(f,y)){const C=y;a[n][C]=Km(f[C],m[C],r)}}}else n==="className"&&r&&e.className?a.className=Ht(t?.className,e?.className):n==="style"&&r&&e.style?a.style={...t?.style,...e?.style}:a[n]===void 0&&(a[n]=t[n])}return a}function k3(t){const{theme:e,name:r,props:a}=t;return!e||!e.components||!e.components[r]||!e.components[r].defaultProps?a:Km(e.components[r].defaultProps,a)}function D3({props:t,name:e,defaultTheme:r,themeId:a}){let o=yC(r);return a&&(o=o[a]||o),k3({theme:o,name:e,props:t})}const ka=typeof window<"u"?E.useLayoutEffect:E.useEffect;function ZN(t,e,r,a,o){const[n,f]=E.useState(()=>o&&r?r(t).matches:a?a(t).matches:e);return ka(()=>{if(!r)return;const m=r(t),y=()=>{f(m.matches)};return y(),m.addEventListener("change",y),()=>{m.removeEventListener("change",y)}},[t,r]),n}const ej={...h2},R3=ej.useSyncExternalStore;function tj(t,e,r,a,o){const n=E.useCallback(()=>e,[e]),f=E.useMemo(()=>{if(o&&r)return()=>r(t).matches;if(a!==null){const{matches:w}=a(t);return()=>w}return n},[n,t,a,o,r]),[m,y]=E.useMemo(()=>{if(r===null)return[n,()=>()=>{}];const w=r(t);return[()=>w.matches,A=>(w.addEventListener("change",A),()=>{w.removeEventListener("change",A)})]},[n,r,t]);return R3(y,m,f)}function I3(t={}){const{themeId:e}=t;return function(a,o={}){let n=gC();n&&e&&(n=n[e]||n);const f=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:m=!1,matchMedia:y=f?window.matchMedia:null,ssrMatchMedia:C=null,noSsr:w=!1}=k3({name:"MuiUseMediaQuery",props:o,theme:n});let A=typeof a=="function"?a(n):a;return A=A.replace(/^@media( ?)/m,""),A.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(R3!==void 0?tj:ZN)(A,m,y,C,w)}}I3();function nj(t,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,r))}function aA(t,e=0,r=1){return nj(t,e,r)}function rj(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(e);return r&&r[0].length===1&&(r=r.map(a=>a+a)),r?`rgb${r.length===4?"a":""}(${r.map((a,o)=>o<3?parseInt(a,16):Math.round(parseInt(a,16)/255*1e3)/1e3).join(", ")})`:""}function Lf(t){if(t.type)return t;if(t.charAt(0)==="#")return Lf(rj(t));const e=t.indexOf("("),r=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(r))throw new Error(xd(9,t));let a=t.substring(e+1,t.length-1),o;if(r==="color"){if(a=a.split(" "),o=a.shift(),a.length===4&&a[3].charAt(0)==="/"&&(a[3]=a[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(o))throw new Error(xd(10,o))}else a=a.split(",");return a=a.map(n=>parseFloat(n)),{type:r,values:a,colorSpace:o}}const oj=t=>{const e=Lf(t);return e.values.slice(0,3).map((r,a)=>e.type.includes("hsl")&&a!==0?`${r}%`:r).join(" ")},Ty=(t,e)=>{try{return oj(t)}catch{return t}};function bC(t){const{type:e,colorSpace:r}=t;let{values:a}=t;return e.includes("rgb")?a=a.map((o,n)=>n<3?parseInt(o,10):o):e.includes("hsl")&&(a[1]=`${a[1]}%`,a[2]=`${a[2]}%`),e.includes("color")?a=`${r} ${a.join(" ")}`:a=`${a.join(", ")}`,`${e}(${a})`}function P3(t){t=Lf(t);const{values:e}=t,r=e[0],a=e[1]/100,o=e[2]/100,n=a*Math.min(o,1-o),f=(C,w=(C+r/30)%12)=>o-n*Math.max(Math.min(w-3,9-w,1),-1);let m="rgb";const y=[Math.round(f(0)*255),Math.round(f(8)*255),Math.round(f(4)*255)];return t.type==="hsla"&&(m+="a",y.push(e[3])),bC({type:m,values:y})}function Bw(t){t=Lf(t);let e=t.type==="hsl"||t.type==="hsla"?Lf(P3(t)).values:t.values;return e=e.map(r=>(t.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function aj(t,e){const r=Bw(t),a=Bw(e);return(Math.max(r,a)+.05)/(Math.min(r,a)+.05)}function Du(t,e){return t=Lf(t),e=aA(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,bC(t)}function Kh(t,e,r){try{return Du(t,e)}catch{return t}}function vC(t,e){if(t=Lf(t),e=aA(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]*=1-e;return bC(t)}function Fo(t,e,r){try{return vC(t,e)}catch{return t}}function xC(t,e){if(t=Lf(t),e=aA(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let r=0;r<3;r+=1)t.values[r]+=(255-t.values[r])*e;else if(t.type.includes("color"))for(let r=0;r<3;r+=1)t.values[r]+=(1-t.values[r])*e;return bC(t)}function No(t,e,r){try{return xC(t,e)}catch{return t}}function zw(t,e=.15){return Bw(t)>.5?vC(t,e):xC(t,e)}function gx(t,e,r){try{return zw(t,e)}catch{return t}}const M3=E.createContext(null);function sA(){return E.useContext(M3)}const sj=typeof Symbol=="function"&&Symbol.for,ij=sj?Symbol.for("mui.nested"):"__THEME_NESTED__";function lj(t,e){return typeof e=="function"?e(t):{...t,...e}}function cj(t){const{children:e,theme:r}=t,a=sA(),o=E.useMemo(()=>{const n=a===null?{...r}:lj(a,r);return n!=null&&(n[ij]=a!==null),n},[r,a]);return d.jsx(M3.Provider,{value:o,children:e})}const _3=E.createContext();function uj({value:t,...e}){return d.jsx(_3.Provider,{value:t??!0,...e})}const Pi=()=>E.useContext(_3)??!1,O3=E.createContext(void 0);function dj({value:t,children:e}){return d.jsx(O3.Provider,{value:t,children:e})}function fj(t){const{theme:e,name:r,props:a}=t;if(!e||!e.components||!e.components[r])return a;const o=e.components[r];return o.defaultProps?Km(o.defaultProps,a,e.components.mergeClassNameAndStyle):!o.styleOverrides&&!o.variants?Km(o,a,e.components.mergeClassNameAndStyle):a}function hj({props:t,name:e}){const r=E.useContext(O3);return fj({props:t,name:e,theme:{components:r}})}let h4=0;function pj(t){const[e,r]=E.useState(t),a=t||e;return E.useEffect(()=>{e==null&&(h4+=1,r(`mui-${h4}`))},[e]),a}const mj={...h2},p4=mj.useId;function nc(t){if(p4!==void 0){const e=p4();return t??e}return pj(t)}function gj(t){const e=gC(),r=nc()||"",{modularCssLayers:a}=t;let o="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!a||e!==null?o="":typeof a=="string"?o=a.replace(/mui(?!\.)/g,o):o=`@layer ${o};`,ka(()=>{const n=document.querySelector("head");if(!n)return;const f=n.firstChild;if(o){if(f&&f.hasAttribute?.("data-mui-layer-order")&&f.getAttribute("data-mui-layer-order")===r)return;const m=document.createElement("style");m.setAttribute("data-mui-layer-order",r),m.textContent=o,n.prepend(m)}else n.querySelector(`style[data-mui-layer-order="${r}"]`)?.remove()},[o,r]),o?d.jsx(x3,{styles:o}):null}const m4={};function g4(t,e,r,a=!1){return E.useMemo(()=>{const o=t&&e[t]||e;if(typeof r=="function"){const n=r(o),f=t?{...e,[t]:n}:n;return a?()=>f:f}return t?{...e,[t]:r}:{...e,...r}},[t,e,r,a])}function F3(t){const{children:e,theme:r,themeId:a}=t,o=gC(m4),n=sA()||m4,f=g4(a,o,r),m=g4(a,n,r,!0),y=(a?f[a]:f).direction==="rtl",C=gj(f);return d.jsx(cj,{theme:m,children:d.jsx(gb.Provider,{value:f,children:d.jsx(uj,{value:y,children:d.jsxs(dj,{value:a?f[a].components:f.components,children:[C,e]})})})})}const y4={theme:void 0};function yj(t){let e,r;return function(o){let n=e;return(n===void 0||o.theme!==r)&&(y4.theme=o.theme,n=T3(t(y4)),e=n,r=o.theme),n}}const iA="mode",lA="color-scheme",bj="data-color-scheme";function vj(t){const{defaultMode:e="system",defaultLightColorScheme:r="light",defaultDarkColorScheme:a="dark",modeStorageKey:o=iA,colorSchemeStorageKey:n=lA,attribute:f=bj,colorSchemeNode:m="document.documentElement",nonce:y}=t||{};let C="",w=f;if(f==="class"&&(w=".%s"),f==="data"&&(w="[data-%s]"),w.startsWith(".")){const R=w.substring(1);C+=`${m}.classList.remove('${R}'.replace('%s', light), '${R}'.replace('%s', dark));
      ${m}.classList.add('${R}'.replace('%s', colorScheme));`}const A=w.match(/\[([^[\]]+)\]/);if(A){const[R,I]=A[1].split("=");I||(C+=`${m}.removeAttribute('${R}'.replace('%s', light));
      ${m}.removeAttribute('${R}'.replace('%s', dark));`),C+=`
      ${m}.setAttribute('${R}'.replace('%s', colorScheme), ${I?`${I}.replace('%s', colorScheme)`:'""'});`}else w!==".%s"&&(C+=`${m}.setAttribute('${w}', colorScheme);`);return d.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?y:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${o}') || '${e}';
  const dark = localStorage.getItem('${n}-dark') || '${a}';
  const light = localStorage.getItem('${n}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${C}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function xj(){}const Cj=({key:t,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(r){if(typeof window>"u")return;if(!e)return r;let a;try{a=e.localStorage.getItem(t)}catch{}return a||r},set:r=>{if(e)try{e.localStorage.setItem(t,r)}catch{}},subscribe:r=>{if(!e)return xj;const a=o=>{const n=o.newValue;o.key===t&&r(n)};return e.addEventListener("storage",a),()=>{e.removeEventListener("storage",a)}}});function rw(){}function b4(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function N3(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function Sj(t){return N3(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function wj(t){const{defaultMode:e="light",defaultLightColorScheme:r,defaultDarkColorScheme:a,supportedColorSchemes:o=[],modeStorageKey:n=iA,colorSchemeStorageKey:f=lA,storageWindow:m=typeof window>"u"?void 0:window,storageManager:y=Cj,noSsr:C=!1}=t,w=o.join(","),A=o.length>1,R=E.useMemo(()=>y?.({key:n,storageWindow:m}),[y,n,m]),I=E.useMemo(()=>y?.({key:`${f}-light`,storageWindow:m}),[y,f,m]),M=E.useMemo(()=>y?.({key:`${f}-dark`,storageWindow:m}),[y,f,m]),[F,O]=E.useState(()=>{const ie=R?.get(e)||e,de=I?.get(r)||r,le=M?.get(a)||a;return{mode:ie,systemMode:b4(ie),lightColorScheme:de,darkColorScheme:le}}),[j,U]=E.useState(C||!A);E.useEffect(()=>{U(!0)},[]);const H=Sj(F),K=E.useCallback(ie=>{O(de=>{if(ie===de.mode)return de;const le=ie??e;return R?.set(le),{...de,mode:le,systemMode:b4(le)}})},[R,e]),W=E.useCallback(ie=>{ie?typeof ie=="string"?ie&&!w.includes(ie)?console.error(`\`${ie}\` does not exist in \`theme.colorSchemes\`.`):O(de=>{const le={...de};return N3(de,oe=>{oe==="light"&&(I?.set(ie),le.lightColorScheme=ie),oe==="dark"&&(M?.set(ie),le.darkColorScheme=ie)}),le}):O(de=>{const le={...de},oe=ie.light===null?r:ie.light,N=ie.dark===null?a:ie.dark;return oe&&(w.includes(oe)?(le.lightColorScheme=oe,I?.set(oe)):console.error(`\`${oe}\` does not exist in \`theme.colorSchemes\`.`)),N&&(w.includes(N)?(le.darkColorScheme=N,M?.set(N)):console.error(`\`${N}\` does not exist in \`theme.colorSchemes\`.`)),le}):O(de=>(I?.set(r),M?.set(a),{...de,lightColorScheme:r,darkColorScheme:a}))},[w,I,M,r,a]),X=E.useCallback(ie=>{F.mode==="system"&&O(de=>{const le=ie?.matches?"dark":"light";return de.systemMode===le?de:{...de,systemMode:le}})},[F.mode]),ee=E.useRef(X);return ee.current=X,E.useEffect(()=>{if(typeof window.matchMedia!="function"||!A)return;const ie=(...le)=>ee.current(...le),de=window.matchMedia("(prefers-color-scheme: dark)");return de.addListener(ie),ie(de),()=>{de.removeListener(ie)}},[A]),E.useEffect(()=>{if(A){const ie=R?.subscribe(oe=>{(!oe||["light","dark","system"].includes(oe))&&K(oe||e)})||rw,de=I?.subscribe(oe=>{(!oe||w.match(oe))&&W({light:oe})})||rw,le=M?.subscribe(oe=>{(!oe||w.match(oe))&&W({dark:oe})})||rw;return()=>{ie(),de(),le()}}},[W,K,w,e,m,A,R,I,M]),{...F,mode:j?F.mode:void 0,systemMode:j?F.systemMode:void 0,colorScheme:j?H:void 0,setMode:K,setColorScheme:W}}const Tj="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function Aj(t){const{themeId:e,theme:r={},modeStorageKey:a=iA,colorSchemeStorageKey:o=lA,disableTransitionOnChange:n=!1,defaultColorScheme:f,resolveTheme:m}=t,y={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},C=E.createContext(void 0),w=()=>E.useContext(C)||y,A={},R={};function I(j){const{children:U,theme:H,modeStorageKey:K=a,colorSchemeStorageKey:W=o,disableTransitionOnChange:X=n,storageManager:ee,storageWindow:ie=typeof window>"u"?void 0:window,documentNode:de=typeof document>"u"?void 0:document,colorSchemeNode:le=typeof document>"u"?void 0:document.documentElement,disableNestedContext:oe=!1,disableStyleSheetGeneration:N=!1,defaultMode:ce="system",forceThemeRerender:ne=!1,noSsr:Se}=j,se=E.useRef(!1),ye=sA(),ze=E.useContext(C),Re=!!ze&&!oe,ve=E.useMemo(()=>H||(typeof r=="function"?r():r),[H]),V=ve[e],ue=V||ve,{colorSchemes:Ee=A,components:Ie=R,cssVarPrefix:ae}=ue,be=Object.keys(Ee).filter(Qe=>!!Ee[Qe]).join(","),Te=E.useMemo(()=>be.split(","),[be]),tt=typeof f=="string"?f:f.light,je=typeof f=="string"?f:f.dark,Pe=Ee[tt]&&Ee[je]?ce:Ee[ue.defaultColorScheme]?.palette?.mode||ue.palette?.mode,{mode:Be,setMode:Fe,systemMode:Ge,lightColorScheme:Oe,darkColorScheme:mt,colorScheme:qe,setColorScheme:Ae}=wj({supportedColorSchemes:Te,defaultLightColorScheme:tt,defaultDarkColorScheme:je,modeStorageKey:K,colorSchemeStorageKey:W,defaultMode:Pe,storageManager:ee,storageWindow:ie,noSsr:Se});let te=Be,pe=qe;Re&&(te=ze.mode,pe=ze.colorScheme);let J=pe||ue.defaultColorScheme;ue.vars&&!ne&&(J=ue.defaultColorScheme);const fe=E.useMemo(()=>{const Qe=ue.generateThemeVars?.()||ue.vars,rt={...ue,components:Ie,colorSchemes:Ee,cssVarPrefix:ae,vars:Qe};if(typeof rt.generateSpacing=="function"&&(rt.spacing=rt.generateSpacing()),J){const st=Ee[J];st&&typeof st=="object"&&Object.keys(st).forEach(it=>{st[it]&&typeof st[it]=="object"?rt[it]={...rt[it],...st[it]}:rt[it]=st[it]})}return m?m(rt):rt},[ue,J,Ie,Ee,ae]),xe=ue.colorSchemeSelector;ka(()=>{if(pe&&le&&xe&&xe!=="media"){const Qe=xe;let rt=xe;if(Qe==="class"&&(rt=".%s"),Qe==="data"&&(rt="[data-%s]"),Qe?.startsWith("data-")&&!Qe.includes("%s")&&(rt=`[${Qe}="%s"]`),rt.startsWith("."))le.classList.remove(...Te.map(st=>rt.substring(1).replace("%s",st))),le.classList.add(rt.substring(1).replace("%s",pe));else{const st=rt.replace("%s",pe).match(/\[([^\]]+)\]/);if(st){const[it,xt]=st[1].split("=");xt||Te.forEach(pt=>{le.removeAttribute(it.replace(pe,pt))}),le.setAttribute(it,xt?xt.replace(/"|'/g,""):"")}else le.setAttribute(rt,pe)}}},[pe,xe,le,Te]),E.useEffect(()=>{let Qe;if(X&&se.current&&de){const rt=de.createElement("style");rt.appendChild(de.createTextNode(Tj)),de.head.appendChild(rt),window.getComputedStyle(de.body),Qe=setTimeout(()=>{de.head.removeChild(rt)},1)}return()=>{clearTimeout(Qe)}},[pe,X,de]),E.useEffect(()=>(se.current=!0,()=>{se.current=!1}),[]);const Ne=E.useMemo(()=>({allColorSchemes:Te,colorScheme:pe,darkColorScheme:mt,lightColorScheme:Oe,mode:te,setColorScheme:Ae,setMode:Fe,systemMode:Ge}),[Te,pe,mt,Oe,te,Ae,Fe,Ge,fe.colorSchemeSelector]);let Me=!0;(N||ue.cssVariables===!1||Re&&ye?.cssVarPrefix===ae)&&(Me=!1);const Ve=d.jsxs(E.Fragment,{children:[d.jsx(F3,{themeId:V?e:void 0,theme:fe,children:U}),Me&&d.jsx(p3,{styles:fe.generateStyleSheets?.()||[]})]});return Re?Ve:d.jsx(C.Provider,{value:Ne,children:Ve})}const M=typeof f=="string"?f:f.light,F=typeof f=="string"?f:f.dark;return{CssVarsProvider:I,useColorScheme:w,getInitColorSchemeScript:j=>vj({colorSchemeStorageKey:o,defaultLightColorScheme:M,defaultDarkColorScheme:F,modeStorageKey:a,...j})}}function Ej(t=""){function e(...a){if(!a.length)return"";const o=a[0];return typeof o=="string"&&!o.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${o}${e(...a.slice(1))})`:`, ${o}`}return(a,...o)=>`var(--${t?`${t}-`:""}${a}${e(...o)})`}const v4=(t,e,r,a=[])=>{let o=t;e.forEach((n,f)=>{f===e.length-1?Array.isArray(o)?o[Number(n)]=r:o&&typeof o=="object"&&(o[n]=r):o&&typeof o=="object"&&(o[n]||(o[n]=a.includes(n)?[]:{}),o=o[n])})},kj=(t,e,r)=>{function a(o,n=[],f=[]){Object.entries(o).forEach(([m,y])=>{(!r||r&&!r([...n,m]))&&y!=null&&(typeof y=="object"&&Object.keys(y).length>0?a(y,[...n,m],Array.isArray(y)?[...f,m]:f):e([...n,m],y,f))})}a(t)},Dj=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(a=>t.includes(a))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function ow(t,e){const{prefix:r,shouldSkipGeneratingVar:a}=e||{},o={},n={},f={};return kj(t,(m,y,C)=>{if((typeof y=="string"||typeof y=="number")&&(!a||!a(m,y))){const w=`--${r?`${r}-`:""}${m.join("-")}`,A=Dj(m,y);Object.assign(o,{[w]:A}),v4(n,m,`var(${w})`,C),v4(f,m,`var(${w}, ${A})`,C)}},m=>m[0]==="vars"),{css:o,vars:n,varsWithDefaults:f}}function Rj(t,e={}){const{getSelector:r=j,disableCssColorScheme:a,colorSchemeSelector:o,enableContrastVars:n}=e,{colorSchemes:f={},components:m,defaultColorScheme:y="light",...C}=t,{vars:w,css:A,varsWithDefaults:R}=ow(C,e);let I=R;const M={},{[y]:F,...O}=f;if(Object.entries(O||{}).forEach(([K,W])=>{const{vars:X,css:ee,varsWithDefaults:ie}=ow(W,e);I=ri(I,ie),M[K]={css:ee,vars:X}}),F){const{css:K,vars:W,varsWithDefaults:X}=ow(F,e);I=ri(I,X),M[y]={css:K,vars:W}}function j(K,W){let X=o;if(o==="class"&&(X=".%s"),o==="data"&&(X="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(X=`[${o}="%s"]`),K){if(X==="media")return t.defaultColorScheme===K?":root":{[`@media (prefers-color-scheme: ${f[K]?.palette?.mode||K})`]:{":root":W}};if(X)return t.defaultColorScheme===K?`:root, ${X.replace("%s",String(K))}`:X.replace("%s",String(K))}return":root"}return{vars:I,generateThemeVars:()=>{let K={...w};return Object.entries(M).forEach(([,{vars:W}])=>{K=ri(K,W)}),K},generateStyleSheets:()=>{const K=[],W=t.defaultColorScheme||"light";function X(de,le){Object.keys(le).length&&K.push(typeof de=="string"?{[de]:{...le}}:de)}X(r(void 0,{...A}),A);const{[W]:ee,...ie}=M;if(ee){const{css:de}=ee,le=f[W]?.palette?.mode,oe=!a&&le?{colorScheme:le,...de}:{...de};X(r(W,{...oe}),oe)}return Object.entries(ie).forEach(([de,{css:le}])=>{const oe=f[de]?.palette?.mode,N=!a&&oe?{colorScheme:oe,...le}:{...le};X(r(de,{...N}),N)}),n&&K.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),K}}}function Ij(t){return function(r){return t==="media"?`@media (prefers-color-scheme: ${r})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${r}"] &`:t==="class"?`.${r} &`:t==="data"?`[data-${r}] &`:`${t.replace("%s",r)} &`:"&"}}function pn(t,e,r=void 0){const a={};for(const o in t){const n=t[o];let f="",m=!0;for(let y=0;y<n.length;y+=1){const C=n[y];C&&(f+=(m===!0?"":" ")+e(C),m=!1,r&&r[C]&&(f+=" "+r[C]))}a[o]=f}return a}const Pj=mC(),Mj=JN("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`maxWidth${At(String(r.maxWidth))}`],r.fixed&&e.fixed,r.disableGutters&&e.disableGutters]}}),_j=t=>D3({props:t,name:"MuiContainer",defaultTheme:Pj}),Oj=(t,e)=>{const r=y=>Cn(e,y),{classes:a,fixed:o,disableGutters:n,maxWidth:f}=t,m={root:["root",f&&`maxWidth${At(String(f))}`,o&&"fixed",n&&"disableGutters"]};return pn(m,r,a)};function Fj(t={}){const{createStyledComponent:e=Mj,useThemeProps:r=_j,componentName:a="MuiContainer"}=t,o=e(({theme:f,ownerState:m})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!m.disableGutters&&{paddingLeft:f.spacing(2),paddingRight:f.spacing(2),[f.breakpoints.up("sm")]:{paddingLeft:f.spacing(3),paddingRight:f.spacing(3)}}}),({theme:f,ownerState:m})=>m.fixed&&Object.keys(f.breakpoints.values).reduce((y,C)=>{const w=C,A=f.breakpoints.values[w];return A!==0&&(y[f.breakpoints.up(w)]={maxWidth:`${A}${f.breakpoints.unit}`}),y},{}),({theme:f,ownerState:m})=>({...m.maxWidth==="xs"&&{[f.breakpoints.up("xs")]:{maxWidth:Math.max(f.breakpoints.values.xs,444)}},...m.maxWidth&&m.maxWidth!=="xs"&&{[f.breakpoints.up(m.maxWidth)]:{maxWidth:`${f.breakpoints.values[m.maxWidth]}${f.breakpoints.unit}`}}}));return E.forwardRef(function(m,y){const C=r(m),{className:w,component:A="div",disableGutters:R=!1,fixed:I=!1,maxWidth:M="lg",classes:F,...O}=C,j={...C,component:A,disableGutters:R,fixed:I,maxWidth:M},U=Oj(j,a);return d.jsx(o,{as:A,ownerState:j,className:Ht(U.root,w),ref:y,...O})})}function Qx(t,e){return E.isValidElement(t)&&e.indexOf(t.type.muiName??t.type?._payload?.value?.muiName)!==-1}function j3(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Gy.white,default:Gy.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const L3=j3();function B3(){return{text:{primary:Gy.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Gy.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Uw=B3();function x4(t,e,r,a){const o=a.light||a,n=a.dark||a*1.5;t[e]||(t.hasOwnProperty(r)?t[e]=t[r]:e==="light"?t.light=xC(t.main,o):e==="dark"&&(t.dark=vC(t.main,n)))}function C4(t,e,r,a,o){const n=o.light||o,f=o.dark||o*1.5;e[r]||(e.hasOwnProperty(a)?e[r]=e[a]:r==="light"?e.light=`color-mix(in ${t}, ${e.main}, #fff ${(n*100).toFixed(0)}%)`:r==="dark"&&(e.dark=`color-mix(in ${t}, ${e.main}, #000 ${(f*100).toFixed(0)}%)`))}function Nj(t="light"){return t==="dark"?{main:ym[200],light:ym[50],dark:ym[400]}:{main:ym[700],light:ym[400],dark:ym[800]}}function jj(t="light"){return t==="dark"?{main:gm[200],light:gm[50],dark:gm[400]}:{main:gm[500],light:gm[300],dark:gm[700]}}function Lj(t="light"){return t==="dark"?{main:mm[500],light:mm[300],dark:mm[700]}:{main:mm[700],light:mm[400],dark:mm[800]}}function Bj(t="light"){return t==="dark"?{main:bm[400],light:bm[300],dark:bm[700]}:{main:bm[700],light:bm[500],dark:bm[900]}}function zj(t="light"){return t==="dark"?{main:vm[400],light:vm[300],dark:vm[700]}:{main:vm[800],light:vm[500],dark:vm[900]}}function Uj(t="light"){return t==="dark"?{main:iy[400],light:iy[300],dark:iy[700]}:{main:"#ed6c02",light:iy[500],dark:iy[900]}}function $j(t){return`oklch(from ${t} var(--__l) 0 h / var(--__a))`}function cA(t){const{mode:e="light",contrastThreshold:r=3,tonalOffset:a=.2,colorSpace:o,...n}=t,f=t.primary||Nj(e),m=t.secondary||jj(e),y=t.error||Lj(e),C=t.info||Bj(e),w=t.success||zj(e),A=t.warning||Uj(e);function R(O){return o?$j(O):aj(O,Uw.text.primary)>=r?Uw.text.primary:L3.text.primary}const I=({color:O,name:j,mainShade:U=500,lightShade:H=300,darkShade:K=700})=>{if(O={...O},!O.main&&O[U]&&(O.main=O[U]),!O.hasOwnProperty("main"))throw new Error(xd(11,j?` (${j})`:"",U));if(typeof O.main!="string")throw new Error(xd(12,j?` (${j})`:"",JSON.stringify(O.main)));return o?(C4(o,O,"light",H,a),C4(o,O,"dark",K,a)):(x4(O,"light",H,a),x4(O,"dark",K,a)),O.contrastText||(O.contrastText=R(O.main)),O};let M;return e==="light"?M=j3():e==="dark"&&(M=B3()),ri({common:{...Gy},mode:e,primary:I({color:f,name:"primary"}),secondary:I({color:m,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:I({color:y,name:"error"}),warning:I({color:A,name:"warning"}),info:I({color:C,name:"info"}),success:I({color:w,name:"success"}),grey:BO,contrastThreshold:r,getContrastText:R,augmentColor:I,tonalOffset:a,...M},n)}function Hj(t){const e={};return Object.entries(t).forEach(a=>{const[o,n]=a;typeof n=="object"&&(e[o]=`${n.fontStyle?`${n.fontStyle} `:""}${n.fontVariant?`${n.fontVariant} `:""}${n.fontWeight?`${n.fontWeight} `:""}${n.fontStretch?`${n.fontStretch} `:""}${n.fontSize||""}${n.lineHeight?`/${n.lineHeight} `:""}${n.fontFamily||""}`)}),e}function Wj(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function Vj(t){return Math.round(t*1e5)/1e5}const S4={textTransform:"uppercase"},w4='"Roboto", "Helvetica", "Arial", sans-serif';function z3(t,e){const{fontFamily:r=w4,fontSize:a=14,fontWeightLight:o=300,fontWeightRegular:n=400,fontWeightMedium:f=500,fontWeightBold:m=700,htmlFontSize:y=16,allVariants:C,pxToRem:w,...A}=typeof e=="function"?e(t):e,R=a/14,I=w||(O=>`${O/y*R}rem`),M=(O,j,U,H,K)=>({fontFamily:r,fontWeight:O,fontSize:I(j),lineHeight:U,...r===w4?{letterSpacing:`${Vj(H/j)}em`}:{},...K,...C}),F={h1:M(o,96,1.167,-1.5),h2:M(o,60,1.2,-.5),h3:M(n,48,1.167,0),h4:M(n,34,1.235,.25),h5:M(n,24,1.334,0),h6:M(f,20,1.6,.15),subtitle1:M(n,16,1.75,.15),subtitle2:M(f,14,1.57,.1),body1:M(n,16,1.5,.15),body2:M(n,14,1.43,.15),button:M(f,14,1.75,.4,S4),caption:M(n,12,1.66,.4),overline:M(n,12,2.66,1,S4),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ri({htmlFontSize:y,pxToRem:I,fontFamily:r,fontSize:a,fontWeightLight:o,fontWeightRegular:n,fontWeightMedium:f,fontWeightBold:m,...F},A,{clone:!1})}const Gj=.2,Kj=.14,Yj=.12;function ma(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Gj})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Kj})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Yj})`].join(",")}const qj=["none",ma(0,2,1,-1,0,1,1,0,0,1,3,0),ma(0,3,1,-2,0,2,2,0,0,1,5,0),ma(0,3,3,-2,0,3,4,0,0,1,8,0),ma(0,2,4,-1,0,4,5,0,0,1,10,0),ma(0,3,5,-1,0,5,8,0,0,1,14,0),ma(0,3,5,-1,0,6,10,0,0,1,18,0),ma(0,4,5,-2,0,7,10,1,0,2,16,1),ma(0,5,5,-3,0,8,10,1,0,3,14,2),ma(0,5,6,-3,0,9,12,1,0,3,16,2),ma(0,6,6,-3,0,10,14,1,0,4,18,3),ma(0,6,7,-4,0,11,15,1,0,4,20,3),ma(0,7,8,-4,0,12,17,2,0,5,22,4),ma(0,7,8,-4,0,13,19,2,0,5,24,4),ma(0,7,9,-4,0,14,21,2,0,5,26,4),ma(0,8,9,-5,0,15,22,2,0,6,28,5),ma(0,8,10,-5,0,16,24,2,0,6,30,5),ma(0,8,11,-5,0,17,26,2,0,6,32,5),ma(0,9,11,-5,0,18,28,2,0,7,34,6),ma(0,9,12,-6,0,19,29,2,0,7,36,6),ma(0,10,13,-6,0,20,31,3,0,8,38,7),ma(0,10,13,-6,0,21,33,3,0,8,40,7),ma(0,10,14,-6,0,22,35,3,0,8,42,7),ma(0,11,14,-7,0,23,36,3,0,9,44,8),ma(0,11,15,-7,0,24,38,3,0,9,46,8)],Qj={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Xj={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function T4(t){return`${Math.round(t)}ms`}function Jj(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function Zj(t){const e={...Qj,...t.easing},r={...Xj,...t.duration};return{getAutoHeightDuration:Jj,create:(o=["all"],n={})=>{const{duration:f=r.standard,easing:m=e.easeInOut,delay:y=0,...C}=n;return(Array.isArray(o)?o:[o]).map(w=>`${w} ${typeof f=="string"?f:T4(f)} ${m} ${typeof y=="string"?y:T4(y)}`).join(",")},...t,easing:e,duration:r}}const e8={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function t8(t){return gu(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function U3(t={}){const e={...t};function r(a){const o=Object.entries(a);for(let n=0;n<o.length;n++){const[f,m]=o[n];!t8(m)||f.startsWith("unstable_")?delete a[f]:gu(m)&&(a[f]={...m},r(a[f]))}}return r(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function A4(t){return typeof t=="number"?`${(t*100).toFixed(0)}%`:`calc((${t}) * 100%)`}const n8=t=>{if(!Number.isNaN(+t))return+t;const e=t.match(/\d*\.?\d+/g);if(!e)return 0;let r=0;for(let a=0;a<e.length;a+=1)r+=+e[a];return r};function r8(t){Object.assign(t,{alpha(e,r){const a=this||t;return a.colorSpace?`oklch(from ${e} l c h / ${typeof r=="string"?`calc(${r})`:r})`:a.vars?`rgba(${e.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof r=="string"?`calc(${r})`:r})`:Du(e,n8(r))},lighten(e,r){const a=this||t;return a.colorSpace?`color-mix(in ${a.colorSpace}, ${e}, #fff ${A4(r)})`:xC(e,r)},darken(e,r){const a=this||t;return a.colorSpace?`color-mix(in ${a.colorSpace}, ${e}, #000 ${A4(r)})`:vC(e,r)}})}function $w(t={},...e){const{breakpoints:r,mixins:a={},spacing:o,palette:n={},transitions:f={},typography:m={},shape:y,colorSpace:C,...w}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(xd(20));const A=cA({...n,colorSpace:C}),R=mC(t);let I=ri(R,{mixins:Wj(R.breakpoints,a),palette:A,shadows:qj.slice(),typography:z3(A,m),transitions:Zj(f),zIndex:{...e8}});return I=ri(I,w),I=e.reduce((M,F)=>ri(M,F),I),I.unstable_sxConfig={...vb,...w?.unstable_sxConfig},I.unstable_sx=function(F){return jf({sx:F,theme:this})},I.toRuntimeSource=U3,r8(I),I}function Hw(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const o8=[...Array(25)].map((t,e)=>{if(e===0)return"none";const r=Hw(e);return`linear-gradient(rgba(255 255 255 / ${r}), rgba(255 255 255 / ${r}))`});function $3(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function H3(t){return t==="dark"?o8:[]}function a8(t){const{palette:e={mode:"light"},opacity:r,overlays:a,colorSpace:o,...n}=t,f=cA({...e,colorSpace:o});return{palette:f,opacity:{...$3(f.mode),...r},overlays:a||H3(f.mode),...n}}function s8(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const i8=t=>[...[...Array(25)].map((e,r)=>`--${t?`${t}-`:""}overlays-${r}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],l8=t=>(e,r)=>{const a=t.rootSelector||":root",o=t.colorSchemeSelector;let n=o;if(o==="class"&&(n=".%s"),o==="data"&&(n="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(n=`[${o}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const f={};return i8(t.cssVarPrefix).forEach(m=>{f[m]=r[m],delete r[m]}),n==="media"?{[a]:r,"@media (prefers-color-scheme: dark)":{[a]:f}}:n?{[n.replace("%s",e)]:f,[`${a}, ${n.replace("%s",e)}`]:r}:{[a]:{...r,...f}}}if(n&&n!=="media")return`${a}, ${n.replace("%s",String(e))}`}else if(e){if(n==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[a]:r}};if(n)return n.replace("%s",String(e))}return a};function c8(t,e){e.forEach(r=>{t[r]||(t[r]={})})}function Ft(t,e,r){!t[e]&&r&&(t[e]=r)}function Ay(t){return typeof t!="string"||!t.startsWith("hsl")?t:P3(t)}function hd(t,e){`${e}Channel`in t||(t[`${e}Channel`]=Ty(Ay(t[e])))}function u8(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const du=t=>{try{return t()}catch{}},d8=(t="mui")=>Ej(t);function aw(t,e,r,a,o){if(!r)return;r=r===!0?{}:r;const n=o==="dark"?"dark":"light";if(!a){e[o]=a8({...r,palette:{mode:n,...r?.palette},colorSpace:t});return}const{palette:f,...m}=$w({...a,palette:{mode:n,...r?.palette},colorSpace:t});return e[o]={...r,palette:f,opacity:{...$3(n),...r?.opacity},overlays:r?.overlays||H3(n)},m}function f8(t={},...e){const{colorSchemes:r={light:!0},defaultColorScheme:a,disableCssColorScheme:o=!1,cssVarPrefix:n="mui",nativeColor:f=!1,shouldSkipGeneratingVar:m=s8,colorSchemeSelector:y=r.light&&r.dark?"media":void 0,rootSelector:C=":root",...w}=t,A=Object.keys(r)[0],R=a||(r.light&&A!=="light"?"light":A),I=d8(n),{[R]:M,light:F,dark:O,...j}=r,U={...j};let H=M;if((R==="dark"&&!("dark"in r)||R==="light"&&!("light"in r))&&(H=!0),!H)throw new Error(xd(21,R));let K;f&&(K="oklch");const W=aw(K,U,H,w,R);F&&!U.light&&aw(K,U,F,void 0,"light"),O&&!U.dark&&aw(K,U,O,void 0,"dark");let X={defaultColorScheme:R,...W,cssVarPrefix:n,colorSchemeSelector:y,rootSelector:C,getCssVar:I,colorSchemes:U,font:{...Hj(W.typography),...W.font},spacing:u8(w.spacing)};Object.keys(X.colorSchemes).forEach(oe=>{const N=X.colorSchemes[oe].palette,ce=Se=>{const se=Se.split("-"),ye=se[1],ze=se[2];return I(Se,N[ye][ze])};N.mode==="light"&&(Ft(N.common,"background","#fff"),Ft(N.common,"onBackground","#000")),N.mode==="dark"&&(Ft(N.common,"background","#000"),Ft(N.common,"onBackground","#fff"));function ne(Se,se,ye){if(K){let ze;return Se===Kh&&(ze=`transparent ${((1-ye)*100).toFixed(0)}%`),Se===Fo&&(ze=`#000 ${(ye*100).toFixed(0)}%`),Se===No&&(ze=`#fff ${(ye*100).toFixed(0)}%`),`color-mix(in ${K}, ${se}, ${ze})`}return Se(se,ye)}if(c8(N,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),N.mode==="light"){Ft(N.Alert,"errorColor",ne(Fo,N.error.light,.6)),Ft(N.Alert,"infoColor",ne(Fo,N.info.light,.6)),Ft(N.Alert,"successColor",ne(Fo,N.success.light,.6)),Ft(N.Alert,"warningColor",ne(Fo,N.warning.light,.6)),Ft(N.Alert,"errorFilledBg",ce("palette-error-main")),Ft(N.Alert,"infoFilledBg",ce("palette-info-main")),Ft(N.Alert,"successFilledBg",ce("palette-success-main")),Ft(N.Alert,"warningFilledBg",ce("palette-warning-main")),Ft(N.Alert,"errorFilledColor",du(()=>N.getContrastText(N.error.main))),Ft(N.Alert,"infoFilledColor",du(()=>N.getContrastText(N.info.main))),Ft(N.Alert,"successFilledColor",du(()=>N.getContrastText(N.success.main))),Ft(N.Alert,"warningFilledColor",du(()=>N.getContrastText(N.warning.main))),Ft(N.Alert,"errorStandardBg",ne(No,N.error.light,.9)),Ft(N.Alert,"infoStandardBg",ne(No,N.info.light,.9)),Ft(N.Alert,"successStandardBg",ne(No,N.success.light,.9)),Ft(N.Alert,"warningStandardBg",ne(No,N.warning.light,.9)),Ft(N.Alert,"errorIconColor",ce("palette-error-main")),Ft(N.Alert,"infoIconColor",ce("palette-info-main")),Ft(N.Alert,"successIconColor",ce("palette-success-main")),Ft(N.Alert,"warningIconColor",ce("palette-warning-main")),Ft(N.AppBar,"defaultBg",ce("palette-grey-100")),Ft(N.Avatar,"defaultBg",ce("palette-grey-400")),Ft(N.Button,"inheritContainedBg",ce("palette-grey-300")),Ft(N.Button,"inheritContainedHoverBg",ce("palette-grey-A100")),Ft(N.Chip,"defaultBorder",ce("palette-grey-400")),Ft(N.Chip,"defaultAvatarColor",ce("palette-grey-700")),Ft(N.Chip,"defaultIconColor",ce("palette-grey-700")),Ft(N.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ft(N.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ft(N.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ft(N.LinearProgress,"primaryBg",ne(No,N.primary.main,.62)),Ft(N.LinearProgress,"secondaryBg",ne(No,N.secondary.main,.62)),Ft(N.LinearProgress,"errorBg",ne(No,N.error.main,.62)),Ft(N.LinearProgress,"infoBg",ne(No,N.info.main,.62)),Ft(N.LinearProgress,"successBg",ne(No,N.success.main,.62)),Ft(N.LinearProgress,"warningBg",ne(No,N.warning.main,.62)),Ft(N.Skeleton,"bg",K?ne(Kh,N.text.primary,.11):`rgba(${ce("palette-text-primaryChannel")} / 0.11)`),Ft(N.Slider,"primaryTrack",ne(No,N.primary.main,.62)),Ft(N.Slider,"secondaryTrack",ne(No,N.secondary.main,.62)),Ft(N.Slider,"errorTrack",ne(No,N.error.main,.62)),Ft(N.Slider,"infoTrack",ne(No,N.info.main,.62)),Ft(N.Slider,"successTrack",ne(No,N.success.main,.62)),Ft(N.Slider,"warningTrack",ne(No,N.warning.main,.62));const Se=K?ne(Fo,N.background.default,.6825):gx(N.background.default,.8);Ft(N.SnackbarContent,"bg",Se),Ft(N.SnackbarContent,"color",du(()=>K?Uw.text.primary:N.getContrastText(Se))),Ft(N.SpeedDialAction,"fabHoverBg",gx(N.background.paper,.15)),Ft(N.StepConnector,"border",ce("palette-grey-400")),Ft(N.StepContent,"border",ce("palette-grey-400")),Ft(N.Switch,"defaultColor",ce("palette-common-white")),Ft(N.Switch,"defaultDisabledColor",ce("palette-grey-100")),Ft(N.Switch,"primaryDisabledColor",ne(No,N.primary.main,.62)),Ft(N.Switch,"secondaryDisabledColor",ne(No,N.secondary.main,.62)),Ft(N.Switch,"errorDisabledColor",ne(No,N.error.main,.62)),Ft(N.Switch,"infoDisabledColor",ne(No,N.info.main,.62)),Ft(N.Switch,"successDisabledColor",ne(No,N.success.main,.62)),Ft(N.Switch,"warningDisabledColor",ne(No,N.warning.main,.62)),Ft(N.TableCell,"border",ne(No,ne(Kh,N.divider,1),.88)),Ft(N.Tooltip,"bg",ne(Kh,N.grey[700],.92))}if(N.mode==="dark"){Ft(N.Alert,"errorColor",ne(No,N.error.light,.6)),Ft(N.Alert,"infoColor",ne(No,N.info.light,.6)),Ft(N.Alert,"successColor",ne(No,N.success.light,.6)),Ft(N.Alert,"warningColor",ne(No,N.warning.light,.6)),Ft(N.Alert,"errorFilledBg",ce("palette-error-dark")),Ft(N.Alert,"infoFilledBg",ce("palette-info-dark")),Ft(N.Alert,"successFilledBg",ce("palette-success-dark")),Ft(N.Alert,"warningFilledBg",ce("palette-warning-dark")),Ft(N.Alert,"errorFilledColor",du(()=>N.getContrastText(N.error.dark))),Ft(N.Alert,"infoFilledColor",du(()=>N.getContrastText(N.info.dark))),Ft(N.Alert,"successFilledColor",du(()=>N.getContrastText(N.success.dark))),Ft(N.Alert,"warningFilledColor",du(()=>N.getContrastText(N.warning.dark))),Ft(N.Alert,"errorStandardBg",ne(Fo,N.error.light,.9)),Ft(N.Alert,"infoStandardBg",ne(Fo,N.info.light,.9)),Ft(N.Alert,"successStandardBg",ne(Fo,N.success.light,.9)),Ft(N.Alert,"warningStandardBg",ne(Fo,N.warning.light,.9)),Ft(N.Alert,"errorIconColor",ce("palette-error-main")),Ft(N.Alert,"infoIconColor",ce("palette-info-main")),Ft(N.Alert,"successIconColor",ce("palette-success-main")),Ft(N.Alert,"warningIconColor",ce("palette-warning-main")),Ft(N.AppBar,"defaultBg",ce("palette-grey-900")),Ft(N.AppBar,"darkBg",ce("palette-background-paper")),Ft(N.AppBar,"darkColor",ce("palette-text-primary")),Ft(N.Avatar,"defaultBg",ce("palette-grey-600")),Ft(N.Button,"inheritContainedBg",ce("palette-grey-800")),Ft(N.Button,"inheritContainedHoverBg",ce("palette-grey-700")),Ft(N.Chip,"defaultBorder",ce("palette-grey-700")),Ft(N.Chip,"defaultAvatarColor",ce("palette-grey-300")),Ft(N.Chip,"defaultIconColor",ce("palette-grey-300")),Ft(N.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ft(N.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ft(N.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ft(N.LinearProgress,"primaryBg",ne(Fo,N.primary.main,.5)),Ft(N.LinearProgress,"secondaryBg",ne(Fo,N.secondary.main,.5)),Ft(N.LinearProgress,"errorBg",ne(Fo,N.error.main,.5)),Ft(N.LinearProgress,"infoBg",ne(Fo,N.info.main,.5)),Ft(N.LinearProgress,"successBg",ne(Fo,N.success.main,.5)),Ft(N.LinearProgress,"warningBg",ne(Fo,N.warning.main,.5)),Ft(N.Skeleton,"bg",K?ne(Kh,N.text.primary,.13):`rgba(${ce("palette-text-primaryChannel")} / 0.13)`),Ft(N.Slider,"primaryTrack",ne(Fo,N.primary.main,.5)),Ft(N.Slider,"secondaryTrack",ne(Fo,N.secondary.main,.5)),Ft(N.Slider,"errorTrack",ne(Fo,N.error.main,.5)),Ft(N.Slider,"infoTrack",ne(Fo,N.info.main,.5)),Ft(N.Slider,"successTrack",ne(Fo,N.success.main,.5)),Ft(N.Slider,"warningTrack",ne(Fo,N.warning.main,.5));const Se=K?ne(No,N.background.default,.985):gx(N.background.default,.98);Ft(N.SnackbarContent,"bg",Se),Ft(N.SnackbarContent,"color",du(()=>K?L3.text.primary:N.getContrastText(Se))),Ft(N.SpeedDialAction,"fabHoverBg",gx(N.background.paper,.15)),Ft(N.StepConnector,"border",ce("palette-grey-600")),Ft(N.StepContent,"border",ce("palette-grey-600")),Ft(N.Switch,"defaultColor",ce("palette-grey-300")),Ft(N.Switch,"defaultDisabledColor",ce("palette-grey-600")),Ft(N.Switch,"primaryDisabledColor",ne(Fo,N.primary.main,.55)),Ft(N.Switch,"secondaryDisabledColor",ne(Fo,N.secondary.main,.55)),Ft(N.Switch,"errorDisabledColor",ne(Fo,N.error.main,.55)),Ft(N.Switch,"infoDisabledColor",ne(Fo,N.info.main,.55)),Ft(N.Switch,"successDisabledColor",ne(Fo,N.success.main,.55)),Ft(N.Switch,"warningDisabledColor",ne(Fo,N.warning.main,.55)),Ft(N.TableCell,"border",ne(Fo,ne(Kh,N.divider,1),.68)),Ft(N.Tooltip,"bg",ne(Kh,N.grey[700],.92))}hd(N.background,"default"),hd(N.background,"paper"),hd(N.common,"background"),hd(N.common,"onBackground"),hd(N,"divider"),Object.keys(N).forEach(Se=>{const se=N[Se];Se!=="tonalOffset"&&se&&typeof se=="object"&&(se.main&&Ft(N[Se],"mainChannel",Ty(Ay(se.main))),se.light&&Ft(N[Se],"lightChannel",Ty(Ay(se.light))),se.dark&&Ft(N[Se],"darkChannel",Ty(Ay(se.dark))),se.contrastText&&Ft(N[Se],"contrastTextChannel",Ty(Ay(se.contrastText))),Se==="text"&&(hd(N[Se],"primary"),hd(N[Se],"secondary")),Se==="action"&&(se.active&&hd(N[Se],"active"),se.selected&&hd(N[Se],"selected")))})}),X=e.reduce((oe,N)=>ri(oe,N),X);const ee={prefix:n,disableCssColorScheme:o,shouldSkipGeneratingVar:m,getSelector:l8(X),enableContrastVars:f},{vars:ie,generateThemeVars:de,generateStyleSheets:le}=Rj(X,ee);return X.vars=ie,Object.entries(X.colorSchemes[X.defaultColorScheme]).forEach(([oe,N])=>{X[oe]=N}),X.generateThemeVars=de,X.generateStyleSheets=le,X.generateSpacing=function(){return v3(w.spacing,rA(this))},X.getColorSchemeSelector=Ij(y),X.spacing=X.generateSpacing(),X.shouldSkipGeneratingVar=m,X.unstable_sxConfig={...vb,...w?.unstable_sxConfig},X.unstable_sx=function(N){return jf({sx:N,theme:this})},X.toRuntimeSource=U3,X}function E4(t,e,r){t.colorSchemes&&r&&(t.colorSchemes[e]={...r!==!0&&r,palette:cA({...r===!0?{}:r.palette,mode:e})})}function CC(t={},...e){const{palette:r,cssVariables:a=!1,colorSchemes:o=r?void 0:{light:!0},defaultColorScheme:n=r?.mode,...f}=t,m=n||"light",y=o?.[m],C={...o,...r?{[m]:{...typeof y!="boolean"&&y,palette:r}}:void 0};if(a===!1){if(!("colorSchemes"in t))return $w(t,...e);let w=r;"palette"in t||C[m]&&(C[m]!==!0?w=C[m].palette:m==="dark"&&(w={mode:"dark"}));const A=$w({...t,palette:w},...e);return A.defaultColorScheme=m,A.colorSchemes=C,A.palette.mode==="light"&&(A.colorSchemes.light={...C.light!==!0&&C.light,palette:A.palette},E4(A,"dark",C.dark)),A.palette.mode==="dark"&&(A.colorSchemes.dark={...C.dark!==!0&&C.dark,palette:A.palette},E4(A,"light",C.light)),A}return!r&&!("light"in C)&&m==="light"&&(C.light=!0),f8({...f,colorSchemes:C,defaultColorScheme:m,...typeof a!="boolean"&&a},...e)}const SC=CC();function kd(){const t=yC(SC);return t[ql]||t}function Da({props:t,name:e}){return D3({props:t,name:e,defaultTheme:SC,themeId:ql})}function W3(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const si=t=>W3(t)&&t!=="classes",nt=E3({themeId:ql,defaultTheme:SC,rootShouldForwardProp:si});function h8({theme:t,...e}){const r=ql in t?t[ql]:void 0;return d.jsx(F3,{...e,themeId:r?ql:void 0,theme:r||t})}const yx={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:p8}=Aj({themeId:ql,theme:()=>CC({cssVariables:!0}),colorSchemeStorageKey:yx.colorSchemeStorageKey,modeStorageKey:yx.modeStorageKey,defaultColorScheme:{light:yx.defaultLightColorScheme,dark:yx.defaultDarkColorScheme},resolveTheme:t=>{const e={...t,typography:z3(t.palette,t.typography)};return e.unstable_sx=function(a){return jf({sx:a,theme:this})},e}}),m8=p8;function g8({theme:t,...e}){const r=E.useMemo(()=>{if(typeof t=="function")return t;const a=ql in t?t[ql]:t;return"colorSchemes"in a?null:"vars"in a?t:{...t,vars:null}},[t]);return r?d.jsx(h8,{theme:r,...e}):d.jsx(m8,{theme:t,...e})}function Ww(...t){return t.reduce((e,r)=>r==null?e:function(...o){e.apply(this,o),r.apply(this,o)},()=>{})}function y8(t){return d.jsx(x3,{...t,defaultTheme:SC,themeId:ql})}function uA(t){return function(r){return d.jsx(y8,{styles:typeof t=="function"?a=>t({theme:a,...r}):t})}}function b8(){return C3}const jn=yj;function Wn(t){return hj(t)}function v8(t){return Cn("MuiSvgIcon",t)}bn("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const x8=t=>{const{color:e,fontSize:r,classes:a}=t,o={root:["root",e!=="inherit"&&`color${At(e)}`,`fontSize${At(r)}`]};return pn(o,v8,a)},C8=nt("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color!=="inherit"&&e[`color${At(r.color)}`],e[`fontSize${At(r.fontSize)}`]]}})(jn(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),Vw=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiSvgIcon"}),{children:o,className:n,color:f="inherit",component:m="svg",fontSize:y="medium",htmlColor:C,inheritViewBox:w=!1,titleAccess:A,viewBox:R="0 0 24 24",...I}=a,M=E.isValidElement(o)&&o.type==="svg",F={...a,color:f,component:m,fontSize:y,instanceFontSize:e.fontSize,inheritViewBox:w,viewBox:R,hasSvgAsChild:M},O={};w||(O.viewBox=R);const j=x8(F);return d.jsxs(C8,{as:m,className:Ht(j.root,n),focusable:"false",color:C,"aria-hidden":A?void 0:!0,role:A?"img":void 0,ref:r,...O,...I,...M&&o.props,ownerState:F,children:[M?o.props.children:o,A?d.jsx("title",{children:A}):null]})});Vw.muiName="SvgIcon";function dr(t,e){function r(a,o){return d.jsx(Vw,{"data-testid":void 0,ref:o,...a,children:t})}return r.muiName=Vw.muiName,E.memo(E.forwardRef(r))}function wC(t,e=166){let r;function a(...o){const n=()=>{t.apply(this,o)};clearTimeout(r),r=setTimeout(n,e)}return a.clear=()=>{clearTimeout(r)},a}function $a(t){return t&&t.ownerDocument||document}function Fc(t){return $a(t).defaultView||window}function Gw(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Ki(t){const{controlled:e,default:r,name:a,state:o="value"}=t,{current:n}=E.useRef(e!==void 0),[f,m]=E.useState(r),y=n?e:f,C=E.useCallback(w=>{n||m(w)},[]);return[y,C]}function yn(t){const e=E.useRef(t);return ka(()=>{e.current=t}),E.useRef((...r)=>(0,e.current)(...r)).current}function ro(...t){const e=E.useRef(void 0),r=E.useCallback(a=>{const o=t.map(n=>{if(n==null)return null;if(typeof n=="function"){const f=n,m=f(a);return typeof m=="function"?m:()=>{f(null)}}return n.current=a,()=>{n.current=null}});return()=>{o.forEach(n=>n?.())}},t);return E.useMemo(()=>t.every(a=>a==null)?null:a=>{e.current&&(e.current(),e.current=void 0),a!=null&&(e.current=r(a))},t)}function S8(t,e){const r=t.charCodeAt(2);return t[0]==="o"&&t[1]==="n"&&r>=65&&r<=90&&typeof e=="function"}function V3(t,e){if(!t)return e;function r(f,m){const y={};return Object.keys(m).forEach(C=>{S8(C,m[C])&&typeof f[C]=="function"&&(y[C]=(...w)=>{f[C](...w),m[C](...w)})}),y}if(typeof t=="function"||typeof e=="function")return f=>{const m=typeof e=="function"?e(f):e,y=typeof t=="function"?t({...f,...m}):t,C=Ht(f?.className,m?.className,y?.className),w=r(y,m);return{...m,...y,...w,...!!C&&{className:C},...m?.style&&y?.style&&{style:{...m.style,...y.style}},...m?.sx&&y?.sx&&{sx:[...Array.isArray(m.sx)?m.sx:[m.sx],...Array.isArray(y.sx)?y.sx:[y.sx]]}}};const a=e,o=r(t,a),n=Ht(a?.className,t?.className);return{...e,...t,...o,...!!n&&{className:n},...a?.style&&t?.style&&{style:{...a.style,...t.style}},...a?.sx&&t?.sx&&{sx:[...Array.isArray(a.sx)?a.sx:[a.sx],...Array.isArray(t.sx)?t.sx:[t.sx]]}}}function vr(t,e){if(t==null)return{};var r={};for(var a in t)if({}.hasOwnProperty.call(t,a)){if(e.indexOf(a)!==-1)continue;r[a]=t[a]}return r}function Kw(t,e){return Kw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Kw(t,e)}function dA(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Kw(t,e)}function w8(t,e){return t.classList?!!e&&t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function T8(t,e){t.classList?t.classList.add(e):w8(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function k4(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function A8(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=k4(t.className,e):t.setAttribute("class",k4(t.className&&t.className.baseVal||"",e))}var sp=e3();const bx=hb(sp),D4={disabled:!1},g2=Jr.createContext(null);var G3=function(e){return e.scrollTop},Ey="unmounted",ep="exited",tp="entering",km="entered",Yw="exiting",Bc=(function(t){dA(e,t);function e(a,o){var n;n=t.call(this,a,o)||this;var f=o,m=f&&!f.isMounting?a.enter:a.appear,y;return n.appearStatus=null,a.in?m?(y=ep,n.appearStatus=tp):y=km:a.unmountOnExit||a.mountOnEnter?y=Ey:y=ep,n.state={status:y},n.nextCallback=null,n}e.getDerivedStateFromProps=function(o,n){var f=o.in;return f&&n.status===Ey?{status:ep}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(o){var n=null;if(o!==this.props){var f=this.state.status;this.props.in?f!==tp&&f!==km&&(n=tp):(f===tp||f===km)&&(n=Yw)}this.updateStatus(!1,n)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var o=this.props.timeout,n,f,m;return n=f=m=o,o!=null&&typeof o!="number"&&(n=o.exit,f=o.enter,m=o.appear!==void 0?o.appear:f),{exit:n,enter:f,appear:m}},r.updateStatus=function(o,n){if(o===void 0&&(o=!1),n!==null)if(this.cancelNextCallback(),n===tp){if(this.props.unmountOnExit||this.props.mountOnEnter){var f=this.props.nodeRef?this.props.nodeRef.current:bx.findDOMNode(this);f&&G3(f)}this.performEnter(o)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ep&&this.setState({status:Ey})},r.performEnter=function(o){var n=this,f=this.props.enter,m=this.context?this.context.isMounting:o,y=this.props.nodeRef?[m]:[bx.findDOMNode(this),m],C=y[0],w=y[1],A=this.getTimeouts(),R=m?A.appear:A.enter;if(!o&&!f||D4.disabled){this.safeSetState({status:km},function(){n.props.onEntered(C)});return}this.props.onEnter(C,w),this.safeSetState({status:tp},function(){n.props.onEntering(C,w),n.onTransitionEnd(R,function(){n.safeSetState({status:km},function(){n.props.onEntered(C,w)})})})},r.performExit=function(){var o=this,n=this.props.exit,f=this.getTimeouts(),m=this.props.nodeRef?void 0:bx.findDOMNode(this);if(!n||D4.disabled){this.safeSetState({status:ep},function(){o.props.onExited(m)});return}this.props.onExit(m),this.safeSetState({status:Yw},function(){o.props.onExiting(m),o.onTransitionEnd(f.exit,function(){o.safeSetState({status:ep},function(){o.props.onExited(m)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(o,n){n=this.setNextCallback(n),this.setState(o,n)},r.setNextCallback=function(o){var n=this,f=!0;return this.nextCallback=function(m){f&&(f=!1,n.nextCallback=null,o(m))},this.nextCallback.cancel=function(){f=!1},this.nextCallback},r.onTransitionEnd=function(o,n){this.setNextCallback(n);var f=this.props.nodeRef?this.props.nodeRef.current:bx.findDOMNode(this),m=o==null&&!this.props.addEndListener;if(!f||m){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var y=this.props.nodeRef?[this.nextCallback]:[f,this.nextCallback],C=y[0],w=y[1];this.props.addEndListener(C,w)}o!=null&&setTimeout(this.nextCallback,o)},r.render=function(){var o=this.state.status;if(o===Ey)return null;var n=this.props,f=n.children;n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef;var m=vr(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Jr.createElement(g2.Provider,{value:null},typeof f=="function"?f(o,m):Jr.cloneElement(Jr.Children.only(f),m))},e})(Jr.Component);Bc.contextType=g2;Bc.propTypes={};function xm(){}Bc.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:xm,onEntering:xm,onEntered:xm,onExit:xm,onExiting:xm,onExited:xm};Bc.UNMOUNTED=Ey;Bc.EXITED=ep;Bc.ENTERING=tp;Bc.ENTERED=km;Bc.EXITING=Yw;var E8=function(e,r){return e&&r&&r.split(" ").forEach(function(a){return T8(e,a)})},sw=function(e,r){return e&&r&&r.split(" ").forEach(function(a){return A8(e,a)})},fA=(function(t){dA(e,t);function e(){for(var a,o=arguments.length,n=new Array(o),f=0;f<o;f++)n[f]=arguments[f];return a=t.call.apply(t,[this].concat(n))||this,a.appliedClasses={appear:{},enter:{},exit:{}},a.onEnter=function(m,y){var C=a.resolveArguments(m,y),w=C[0],A=C[1];a.removeClasses(w,"exit"),a.addClass(w,A?"appear":"enter","base"),a.props.onEnter&&a.props.onEnter(m,y)},a.onEntering=function(m,y){var C=a.resolveArguments(m,y),w=C[0],A=C[1],R=A?"appear":"enter";a.addClass(w,R,"active"),a.props.onEntering&&a.props.onEntering(m,y)},a.onEntered=function(m,y){var C=a.resolveArguments(m,y),w=C[0],A=C[1],R=A?"appear":"enter";a.removeClasses(w,R),a.addClass(w,R,"done"),a.props.onEntered&&a.props.onEntered(m,y)},a.onExit=function(m){var y=a.resolveArguments(m),C=y[0];a.removeClasses(C,"appear"),a.removeClasses(C,"enter"),a.addClass(C,"exit","base"),a.props.onExit&&a.props.onExit(m)},a.onExiting=function(m){var y=a.resolveArguments(m),C=y[0];a.addClass(C,"exit","active"),a.props.onExiting&&a.props.onExiting(m)},a.onExited=function(m){var y=a.resolveArguments(m),C=y[0];a.removeClasses(C,"exit"),a.addClass(C,"exit","done"),a.props.onExited&&a.props.onExited(m)},a.resolveArguments=function(m,y){return a.props.nodeRef?[a.props.nodeRef.current,m]:[m,y]},a.getClassNames=function(m){var y=a.props.classNames,C=typeof y=="string",w=C&&y?y+"-":"",A=C?""+w+m:y[m],R=C?A+"-active":y[m+"Active"],I=C?A+"-done":y[m+"Done"];return{baseClassName:A,activeClassName:R,doneClassName:I}},a}var r=e.prototype;return r.addClass=function(o,n,f){var m=this.getClassNames(n)[f+"ClassName"],y=this.getClassNames("enter"),C=y.doneClassName;n==="appear"&&f==="done"&&C&&(m+=" "+C),f==="active"&&o&&G3(o),m&&(this.appliedClasses[n][f]=m,E8(o,m))},r.removeClasses=function(o,n){var f=this.appliedClasses[n],m=f.base,y=f.active,C=f.done;this.appliedClasses[n]={},m&&sw(o,m),y&&sw(o,y),C&&sw(o,C)},r.render=function(){var o=this.props;o.classNames;var n=vr(o,["classNames"]);return Jr.createElement(Bc,Xe({},n,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},e})(Jr.Component);fA.defaultProps={classNames:""};fA.propTypes={};function k8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hA(t,e){var r=function(n){return e&&E.isValidElement(n)?e(n):n},a=Object.create(null);return t&&E.Children.map(t,function(o){return o}).forEach(function(o){a[o.key]=r(o)}),a}function D8(t,e){t=t||{},e=e||{};function r(w){return w in e?e[w]:t[w]}var a=Object.create(null),o=[];for(var n in t)n in e?o.length&&(a[n]=o,o=[]):o.push(n);var f,m={};for(var y in e){if(a[y])for(f=0;f<a[y].length;f++){var C=a[y][f];m[a[y][f]]=r(C)}m[y]=r(y)}for(f=0;f<o.length;f++)m[o[f]]=r(o[f]);return m}function ip(t,e,r){return r[e]!=null?r[e]:t.props[e]}function R8(t,e){return hA(t.children,function(r){return E.cloneElement(r,{onExited:e.bind(null,r),in:!0,appear:ip(r,"appear",t),enter:ip(r,"enter",t),exit:ip(r,"exit",t)})})}function I8(t,e,r){var a=hA(t.children),o=D8(e,a);return Object.keys(o).forEach(function(n){var f=o[n];if(E.isValidElement(f)){var m=n in e,y=n in a,C=e[n],w=E.isValidElement(C)&&!C.props.in;y&&(!m||w)?o[n]=E.cloneElement(f,{onExited:r.bind(null,f),in:!0,exit:ip(f,"exit",t),enter:ip(f,"enter",t)}):!y&&m&&!w?o[n]=E.cloneElement(f,{in:!1}):y&&m&&E.isValidElement(C)&&(o[n]=E.cloneElement(f,{onExited:r.bind(null,f),in:C.props.in,exit:ip(f,"exit",t),enter:ip(f,"enter",t)}))}}),o}var P8=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},M8={component:"div",childFactory:function(e){return e}},xb=(function(t){dA(e,t);function e(a,o){var n;n=t.call(this,a,o)||this;var f=n.handleExited.bind(k8(n));return n.state={contextValue:{isMounting:!0},handleExited:f,firstRender:!0},n}var r=e.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(o,n){var f=n.children,m=n.handleExited,y=n.firstRender;return{children:y?R8(o,m):I8(o,f,m),firstRender:!1}},r.handleExited=function(o,n){var f=hA(this.props.children);o.key in f||(o.props.onExited&&o.props.onExited(n),this.mounted&&this.setState(function(m){var y=Xe({},m.children);return delete y[o.key],{children:y}}))},r.render=function(){var o=this.props,n=o.component,f=o.childFactory,m=vr(o,["component","childFactory"]),y=this.state.contextValue,C=P8(this.state.children).map(f);return delete m.appear,delete m.enter,delete m.exit,n===null?Jr.createElement(g2.Provider,{value:y},C):Jr.createElement(g2.Provider,{value:y},Jr.createElement(n,m,C))},e})(Jr.Component);xb.propTypes={};xb.defaultProps=M8;const R4={};function K3(t,e){const r=E.useRef(R4);return r.current===R4&&(r.current=t(e)),r}const _8=[];function O8(t){E.useEffect(t,_8)}class TC{static create(){return new TC}currentId=null;start(e,r){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,r()},e)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function xl(){const t=K3(TC.create).current;return O8(t.disposeEffect),t}const Y3=t=>t.scrollTop;function y2(t,e){const{timeout:r,easing:a,style:o={}}=t;return{duration:o.transitionDuration??(typeof r=="number"?r:r[e.mode]||0),easing:o.transitionTimingFunction??(typeof a=="object"?a[e.mode]:a),delay:o.transitionDelay}}function Ym(t){return typeof t=="string"}function q3(t,e,r){return t===void 0||Ym(t)?e:{...e,ownerState:{...e.ownerState,...r}}}function Ql(t,e,r){return typeof t=="function"?t(e,r):t}function b2(t,e=[]){if(t===void 0)return{};const r={};return Object.keys(t).filter(a=>a.match(/^on[A-Z]/)&&typeof t[a]=="function"&&!e.includes(a)).forEach(a=>{r[a]=t[a]}),r}function I4(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(r=>!(r.match(/^on[A-Z]/)&&typeof t[r]=="function")).forEach(r=>{e[r]=t[r]}),e}function Q3(t){const{getSlotProps:e,additionalProps:r,externalSlotProps:a,externalForwardedProps:o,className:n}=t;if(!e){const I=Ht(r?.className,n,o?.className,a?.className),M={...r?.style,...o?.style,...a?.style},F={...r,...o,...a};return I.length>0&&(F.className=I),Object.keys(M).length>0&&(F.style=M),{props:F,internalRef:void 0}}const f=b2({...o,...a}),m=I4(a),y=I4(o),C=e(f),w=Ht(C?.className,r?.className,n,o?.className,a?.className),A={...C?.style,...r?.style,...o?.style,...a?.style},R={...C,...r,...y,...m};return w.length>0&&(R.className=w),Object.keys(A).length>0&&(R.style=A),{props:R,internalRef:C.ref}}function rr(t,e){const{className:r,elementType:a,ownerState:o,externalForwardedProps:n,internalForwardedProps:f,shouldForwardComponentProp:m=!1,...y}=e,{component:C,slots:w={[t]:void 0},slotProps:A={[t]:void 0},...R}=n,I=w[t]||a,M=Ql(A[t],o),{props:{component:F,...O},internalRef:j}=Q3({className:r,...y,externalForwardedProps:t==="root"?R:void 0,externalSlotProps:M}),U=ro(j,M?.ref,e.ref),H=t==="root"?F||C:F,K=q3(I,{...t==="root"&&!C&&!w[t]&&f,...t!=="root"&&!w[t]&&f,...O,...H&&!m&&{as:H},...H&&m&&{component:H},ref:U},o);return[I,K]}function F8(t){return Cn("MuiPaper",t)}bn("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const N8=t=>{const{square:e,elevation:r,variant:a,classes:o}=t,n={root:["root",a,!e&&"rounded",a==="elevation"&&`elevation${r}`]};return pn(n,F8,o)},j8=nt("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],!r.square&&e.rounded,r.variant==="elevation"&&e[`elevation${r.elevation}`]]}})(jn(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),ua=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiPaper"}),o=kd(),{className:n,component:f="div",elevation:m=1,square:y=!1,variant:C="elevation",...w}=a,A={...a,component:f,elevation:m,square:y,variant:C},R=N8(A);return d.jsx(j8,{as:f,ownerState:A,className:Ht(R.root,n),ref:r,...w,style:{...C==="elevation"&&{"--Paper-shadow":(o.vars||o).shadows[m],...o.vars&&{"--Paper-overlay":o.vars.overlays?.[m]},...!o.vars&&o.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Du("#fff",Hw(m))}, ${Du("#fff",Hw(m))})`}},...w.style}})}),X3=kt.oneOfType([kt.func,kt.object]);function v2(t){try{return t.matches(":focus-visible")}catch{}return!1}class x2{static create(){return new x2}static use(){const e=K3(x2.create).current,[r,a]=E.useState(!1);return e.shouldMount=r,e.setShouldMount=a,E.useEffect(e.mountEffect,[r]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=B8(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then(()=>this.ref.current?.start(...e))}stop(...e){this.mount().then(()=>this.ref.current?.stop(...e))}pulsate(...e){this.mount().then(()=>this.ref.current?.pulsate(...e))}}function L8(){return x2.use()}function B8(){let t,e;const r=new Promise((a,o)=>{t=a,e=o});return r.resolve=t,r.reject=e,r}function z8(t){const{className:e,classes:r,pulsate:a=!1,rippleX:o,rippleY:n,rippleSize:f,in:m,onExited:y,timeout:C}=t,[w,A]=E.useState(!1),R=Ht(e,r.ripple,r.rippleVisible,a&&r.ripplePulsate),I={width:f,height:f,top:-(f/2)+n,left:-(f/2)+o},M=Ht(r.child,w&&r.childLeaving,a&&r.childPulsate);return!m&&!w&&A(!0),E.useEffect(()=>{if(!m&&y!=null){const F=setTimeout(y,C);return()=>{clearTimeout(F)}}},[y,m,C]),d.jsx("span",{className:R,style:I,children:d.jsx("span",{className:M})})}const Wl=bn("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),qw=550,U8=80,$8=Uf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,H8=Uf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,W8=Uf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,V8=nt("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),G8=nt(z8,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Wl.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${$8};
    animation-duration: ${qw}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${Wl.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${Wl.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Wl.childLeaving} {
    opacity: 0;
    animation-name: ${H8};
    animation-duration: ${qw}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${Wl.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${W8};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,K8=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTouchRipple"}),{center:o=!1,classes:n={},className:f,...m}=a,[y,C]=E.useState([]),w=E.useRef(0),A=E.useRef(null);E.useEffect(()=>{A.current&&(A.current(),A.current=null)},[y]);const R=E.useRef(!1),I=xl(),M=E.useRef(null),F=E.useRef(null),O=E.useCallback(K=>{const{pulsate:W,rippleX:X,rippleY:ee,rippleSize:ie,cb:de}=K;C(le=>[...le,d.jsx(G8,{classes:{ripple:Ht(n.ripple,Wl.ripple),rippleVisible:Ht(n.rippleVisible,Wl.rippleVisible),ripplePulsate:Ht(n.ripplePulsate,Wl.ripplePulsate),child:Ht(n.child,Wl.child),childLeaving:Ht(n.childLeaving,Wl.childLeaving),childPulsate:Ht(n.childPulsate,Wl.childPulsate)},timeout:qw,pulsate:W,rippleX:X,rippleY:ee,rippleSize:ie},w.current)]),w.current+=1,A.current=de},[n]),j=E.useCallback((K={},W={},X=()=>{})=>{const{pulsate:ee=!1,center:ie=o||W.pulsate,fakeElement:de=!1}=W;if(K?.type==="mousedown"&&R.current){R.current=!1;return}K?.type==="touchstart"&&(R.current=!0);const le=de?null:F.current,oe=le?le.getBoundingClientRect():{width:0,height:0,left:0,top:0};let N,ce,ne;if(ie||K===void 0||K.clientX===0&&K.clientY===0||!K.clientX&&!K.touches)N=Math.round(oe.width/2),ce=Math.round(oe.height/2);else{const{clientX:Se,clientY:se}=K.touches&&K.touches.length>0?K.touches[0]:K;N=Math.round(Se-oe.left),ce=Math.round(se-oe.top)}if(ie)ne=Math.sqrt((2*oe.width**2+oe.height**2)/3),ne%2===0&&(ne+=1);else{const Se=Math.max(Math.abs((le?le.clientWidth:0)-N),N)*2+2,se=Math.max(Math.abs((le?le.clientHeight:0)-ce),ce)*2+2;ne=Math.sqrt(Se**2+se**2)}K?.touches?M.current===null&&(M.current=()=>{O({pulsate:ee,rippleX:N,rippleY:ce,rippleSize:ne,cb:X})},I.start(U8,()=>{M.current&&(M.current(),M.current=null)})):O({pulsate:ee,rippleX:N,rippleY:ce,rippleSize:ne,cb:X})},[o,O,I]),U=E.useCallback(()=>{j({},{pulsate:!0})},[j]),H=E.useCallback((K,W)=>{if(I.clear(),K?.type==="touchend"&&M.current){M.current(),M.current=null,I.start(0,()=>{H(K,W)});return}M.current=null,C(X=>X.length>0?X.slice(1):X),A.current=W},[I]);return E.useImperativeHandle(r,()=>({pulsate:U,start:j,stop:H}),[U,j,H]),d.jsx(V8,{className:Ht(Wl.root,n.root,f),ref:F,...m,children:d.jsx(xb,{component:null,exit:!0,children:y})})});function Y8(t){return Cn("MuiButtonBase",t)}const q8=bn("MuiButtonBase",["root","disabled","focusVisible"]),Q8=t=>{const{disabled:e,focusVisible:r,focusVisibleClassName:a,classes:o}=t,f=pn({root:["root",e&&"disabled",r&&"focusVisible"]},Y8,o);return r&&a&&(f.root+=` ${a}`),f},X8=nt("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${q8.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Ru=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiButtonBase"}),{action:o,centerRipple:n=!1,children:f,className:m,component:y="button",disabled:C=!1,disableRipple:w=!1,disableTouchRipple:A=!1,focusRipple:R=!1,focusVisibleClassName:I,LinkComponent:M="a",onBlur:F,onClick:O,onContextMenu:j,onDragLeave:U,onFocus:H,onFocusVisible:K,onKeyDown:W,onKeyUp:X,onMouseDown:ee,onMouseLeave:ie,onMouseUp:de,onTouchEnd:le,onTouchMove:oe,onTouchStart:N,tabIndex:ce=0,TouchRippleProps:ne,touchRippleRef:Se,type:se,...ye}=a,ze=E.useRef(null),Re=L8(),ve=ro(Re.ref,Se),[V,ue]=E.useState(!1);C&&V&&ue(!1),E.useImperativeHandle(o,()=>({focusVisible:()=>{ue(!0),ze.current.focus()}}),[]);const Ee=Re.shouldMount&&!w&&!C;E.useEffect(()=>{V&&R&&!w&&Re.pulsate()},[w,R,V,Re]);const Ie=pd(Re,"start",ee,A),ae=pd(Re,"stop",j,A),be=pd(Re,"stop",U,A),Te=pd(Re,"stop",de,A),tt=pd(Re,"stop",xe=>{V&&xe.preventDefault(),ie&&ie(xe)},A),je=pd(Re,"start",N,A),Pe=pd(Re,"stop",le,A),Be=pd(Re,"stop",oe,A),Fe=pd(Re,"stop",xe=>{v2(xe.target)||ue(!1),F&&F(xe)},!1),Ge=yn(xe=>{ze.current||(ze.current=xe.currentTarget),v2(xe.target)&&(ue(!0),K&&K(xe)),H&&H(xe)}),Oe=()=>{const xe=ze.current;return y&&y!=="button"&&!(xe.tagName==="A"&&xe.href)},mt=yn(xe=>{R&&!xe.repeat&&V&&xe.key===" "&&Re.stop(xe,()=>{Re.start(xe)}),xe.target===xe.currentTarget&&Oe()&&xe.key===" "&&xe.preventDefault(),W&&W(xe),xe.target===xe.currentTarget&&Oe()&&xe.key==="Enter"&&!C&&(xe.preventDefault(),O&&O(xe))}),qe=yn(xe=>{R&&xe.key===" "&&V&&!xe.defaultPrevented&&Re.stop(xe,()=>{Re.pulsate(xe)}),X&&X(xe),O&&xe.target===xe.currentTarget&&Oe()&&xe.key===" "&&!xe.defaultPrevented&&O(xe)});let Ae=y;Ae==="button"&&(ye.href||ye.to)&&(Ae=M);const te={};if(Ae==="button"){const xe=!!ye.formAction;te.type=se===void 0&&!xe?"button":se,te.disabled=C}else!ye.href&&!ye.to&&(te.role="button"),C&&(te["aria-disabled"]=C);const pe=ro(r,ze),J={...a,centerRipple:n,component:y,disabled:C,disableRipple:w,disableTouchRipple:A,focusRipple:R,tabIndex:ce,focusVisible:V},fe=Q8(J);return d.jsxs(X8,{as:Ae,className:Ht(fe.root,m),ownerState:J,onBlur:Fe,onClick:O,onContextMenu:ae,onFocus:Ge,onKeyDown:mt,onKeyUp:qe,onMouseDown:Ie,onMouseLeave:tt,onMouseUp:Te,onDragLeave:be,onTouchEnd:Pe,onTouchMove:Be,onTouchStart:je,ref:pe,tabIndex:C?-1:ce,type:se,...te,...ye,children:[f,Ee?d.jsx(K8,{ref:ve,center:n,...ne}):null]})});function pd(t,e,r,a=!1){return yn(o=>(r&&r(o),a||t[e](o),!0))}function J8(t){return typeof t.main=="string"}function Z8(t,e=[]){if(!J8(t))return!1;for(const r of e)if(!t.hasOwnProperty(r)||typeof t[r]!="string")return!1;return!0}function Go(t=[]){return([,e])=>e&&Z8(e,t)}function e7(t){return Cn("MuiAlert",t)}const P4=bn("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function t7(t){return Cn("MuiCircularProgress",t)}bn("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","track","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Rc=44,Qw=Uf`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Xw=Uf`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,n7=typeof Qw!="string"?ag`
        animation: ${Qw} 1.4s linear infinite;
      `:null,r7=typeof Xw!="string"?ag`
        animation: ${Xw} 1.4s ease-in-out infinite;
      `:null,o7=t=>{const{classes:e,variant:r,color:a,disableShrink:o}=t,n={root:["root",r,`color${At(a)}`],svg:["svg"],track:["track"],circle:["circle",`circle${At(r)}`,o&&"circleDisableShrink"]};return pn(n,t7,e)},a7=nt("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`color${At(r.color)}`]]}})(jn(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:n7||{animation:`${Qw} 1.4s linear infinite`}},...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),s7=nt("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),i7=nt("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.circle,e[`circle${At(r.variant)}`],r.disableShrink&&e.circleDisableShrink]}})(jn(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:r7||{animation:`${Xw} 1.4s ease-in-out infinite`}}]}))),l7=nt("circle",{name:"MuiCircularProgress",slot:"Track"})(jn(({theme:t})=>({stroke:"currentColor",opacity:(t.vars||t).palette.action.activatedOpacity}))),Ri=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiCircularProgress"}),{className:o,color:n="primary",disableShrink:f=!1,enableTrackSlot:m=!1,size:y=40,style:C,thickness:w=3.6,value:A=0,variant:R="indeterminate",...I}=a,M={...a,color:n,disableShrink:f,size:y,thickness:w,value:A,variant:R,enableTrackSlot:m},F=o7(M),O={},j={},U={};if(R==="determinate"){const H=2*Math.PI*((Rc-w)/2);O.strokeDasharray=H.toFixed(3),U["aria-valuenow"]=Math.round(A),O.strokeDashoffset=`${((100-A)/100*H).toFixed(3)}px`,j.transform="rotate(-90deg)"}return d.jsx(a7,{className:Ht(F.root,o),style:{width:y,height:y,...j,...C},ownerState:M,ref:r,role:"progressbar",...U,...I,children:d.jsxs(s7,{className:F.svg,ownerState:M,viewBox:`${Rc/2} ${Rc/2} ${Rc} ${Rc}`,children:[m?d.jsx(l7,{className:F.track,ownerState:M,cx:Rc,cy:Rc,r:(Rc-w)/2,fill:"none",strokeWidth:w,"aria-hidden":"true"}):null,d.jsx(i7,{className:F.circle,style:O,ownerState:M,cx:Rc,cy:Rc,r:(Rc-w)/2,fill:"none",strokeWidth:w})]})})});function c7(t){return Cn("MuiIconButton",t)}const M4=bn("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),u7=t=>{const{classes:e,disabled:r,color:a,edge:o,size:n,loading:f}=t,m={root:["root",f&&"loading",r&&"disabled",a!=="default"&&`color${At(a)}`,o&&`edge${At(o)}`,`size${At(n)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return pn(m,c7,e)},d7=nt(Ru,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.loading&&e.loading,r.color!=="default"&&e[`color${At(r.color)}`],r.edge&&e[`edge${At(r.edge)}`],e[`size${At(r.size)}`]]}})(jn(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),jn(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${M4.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${M4.loading}`]:{color:"transparent"}}))),f7=nt("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),_r=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiIconButton"}),{edge:o=!1,children:n,className:f,color:m="default",disabled:y=!1,disableFocusRipple:C=!1,size:w="medium",id:A,loading:R=null,loadingIndicator:I,...M}=a,F=nc(A),O=I??d.jsx(Ri,{"aria-labelledby":F,color:"inherit",size:16}),j={...a,edge:o,color:m,disabled:y,disableFocusRipple:C,loading:R,loadingIndicator:O,size:w},U=u7(j);return d.jsxs(d7,{id:R?F:A,className:Ht(U.root,f),centerRipple:!0,focusRipple:!C,disabled:y||R,ref:r,...M,ownerState:j,children:[typeof R=="boolean"&&d.jsx("span",{className:U.loadingWrapper,style:{display:"contents"},children:d.jsx(f7,{className:U.loadingIndicator,ownerState:j,children:R&&O})}),n]})}),h7=dr(d.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),p7=dr(d.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),m7=dr(d.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),g7=dr(d.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),J3=dr(d.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),y7=t=>{const{variant:e,color:r,severity:a,classes:o}=t,n={root:["root",`color${At(r||a)}`,`${e}${At(r||a)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return pn(n,e7,o)},b7=nt(ua,{name:"MuiAlert",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`${r.variant}${At(r.color||r.severity)}`]]}})(jn(({theme:t})=>{const e=t.palette.mode==="light"?t.darken:t.lighten,r=t.palette.mode==="light"?t.lighten:t.darken;return{...t.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(Go(["light"])).map(([a])=>({props:{colorSeverity:a,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${a}Color`]:e(t.palette[a].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${a}StandardBg`]:r(t.palette[a].light,.9),[`& .${P4.icon}`]:t.vars?{color:t.vars.palette.Alert[`${a}IconColor`]}:{color:t.palette[a].main}}})),...Object.entries(t.palette).filter(Go(["light"])).map(([a])=>({props:{colorSeverity:a,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${a}Color`]:e(t.palette[a].light,.6),border:`1px solid ${(t.vars||t).palette[a].light}`,[`& .${P4.icon}`]:t.vars?{color:t.vars.palette.Alert[`${a}IconColor`]}:{color:t.palette[a].main}}})),...Object.entries(t.palette).filter(Go(["dark"])).map(([a])=>({props:{colorSeverity:a,variant:"filled"},style:{fontWeight:t.typography.fontWeightMedium,...t.vars?{color:t.vars.palette.Alert[`${a}FilledColor`],backgroundColor:t.vars.palette.Alert[`${a}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[a].dark:t.palette[a].main,color:t.palette.getContrastText(t.palette[a].main)}}}))]}})),v7=nt("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),x7=nt("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),C7=nt("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),_4={success:d.jsx(h7,{fontSize:"inherit"}),warning:d.jsx(p7,{fontSize:"inherit"}),error:d.jsx(m7,{fontSize:"inherit"}),info:d.jsx(g7,{fontSize:"inherit"})},Hs=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiAlert"}),{action:o,children:n,className:f,closeText:m="Close",color:y,components:C={},componentsProps:w={},icon:A,iconMapping:R=_4,onClose:I,role:M="alert",severity:F="success",slotProps:O={},slots:j={},variant:U="standard",...H}=a,K={...a,color:y,severity:F,variant:U,colorSeverity:y||F},W=y7(K),X={slots:{closeButton:C.CloseButton,closeIcon:C.CloseIcon,...j},slotProps:{...w,...O}},[ee,ie]=rr("root",{ref:r,shouldForwardComponentProp:!0,className:Ht(W.root,f),elementType:b7,externalForwardedProps:{...X,...H},ownerState:K,additionalProps:{role:M,elevation:0}}),[de,le]=rr("icon",{className:W.icon,elementType:v7,externalForwardedProps:X,ownerState:K}),[oe,N]=rr("message",{className:W.message,elementType:x7,externalForwardedProps:X,ownerState:K}),[ce,ne]=rr("action",{className:W.action,elementType:C7,externalForwardedProps:X,ownerState:K}),[Se,se]=rr("closeButton",{elementType:_r,externalForwardedProps:X,ownerState:K}),[ye,ze]=rr("closeIcon",{elementType:J3,externalForwardedProps:X,ownerState:K});return d.jsxs(ee,{...ie,children:[A!==!1?d.jsx(de,{...le,children:A||R[F]||_4[F]}):null,d.jsx(oe,{...N,children:n}),o!=null?d.jsx(ce,{...ne,children:o}):null,o==null&&I?d.jsx(ce,{...ne,children:d.jsx(Se,{size:"small","aria-label":m,title:m,color:"inherit",onClick:I,...se,children:d.jsx(ye,{fontSize:"small",...ze})})}):null]})});function S7(t){return Cn("MuiTypography",t)}const O4=bn("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),w7={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},T7=b8(),A7=t=>{const{align:e,gutterBottom:r,noWrap:a,paragraph:o,variant:n,classes:f}=t,m={root:["root",n,t.align!=="inherit"&&`align${At(e)}`,r&&"gutterBottom",a&&"noWrap",o&&"paragraph"]};return pn(m,S7,f)},E7=nt("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.variant&&e[r.variant],r.align!=="inherit"&&e[`align${At(r.align)}`],r.noWrap&&e.noWrap,r.gutterBottom&&e.gutterBottom,r.paragraph&&e.paragraph]}})(jn(({theme:t})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([e,r])=>e!=="inherit"&&r&&typeof r=="object").map(([e,r])=>({props:{variant:e},style:r})),...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette?.text||{}).filter(([,e])=>typeof e=="string").map(([e])=>({props:{color:`text${At(e)}`},style:{color:(t.vars||t).palette.text[e]}})),{props:({ownerState:e})=>e.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]}))),F4={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},We=E.forwardRef(function(e,r){const{color:a,...o}=Wn({props:e,name:"MuiTypography"}),n=!w7[a],f=T7({...o,...n&&{color:a}}),{align:m="inherit",className:y,component:C,gutterBottom:w=!1,noWrap:A=!1,paragraph:R=!1,variant:I="body1",variantMapping:M=F4,...F}=f,O={...f,align:m,color:a,className:y,component:C,gutterBottom:w,noWrap:A,paragraph:R,variant:I,variantMapping:M},j=C||(R?"p":M[I]||F4[I])||"span",U=A7(O);return d.jsx(E7,{as:j,ref:r,className:Ht(U.root,y),...F,ownerState:O,style:{...m!=="inherit"&&{"--Typography-textAlign":m},...F.style}})});function k7(t){return Cn("MuiAppBar",t)}bn("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const D7=t=>{const{color:e,position:r,classes:a}=t,o={root:["root",`color${At(e)}`,`position${At(r)}`]};return pn(o,k7,a)},N4=(t,e)=>t?`${t?.replace(")","")}, ${e})`:e,R7=nt(ua,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`position${At(r.position)}`],e[`color${At(r.color)}`]]}})(jn(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(Go(["contrastText"])).map(([e])=>({props:{color:e},style:{"--AppBar-background":(t.vars??t).palette[e].main,"--AppBar-color":(t.vars??t).palette[e].contrastText}})),{props:e=>e.enableColorOnDark===!0&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>e.enableColorOnDark===!1&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?N4(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?N4(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),I7=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiAppBar"}),{className:o,color:n="primary",enableColorOnDark:f=!1,position:m="fixed",...y}=a,C={...a,color:n,position:m,enableColorOnDark:f},w=D7(C);return d.jsx(R7,{square:!0,component:"header",ownerState:C,elevation:4,className:Ht(w.root,o,m==="fixed"&&"mui-fixed"),ref:r,...y})});function P7(t){const e=E.useRef({});return E.useEffect(()=>{e.current=t}),e.current}function j4({array1:t,array2:e,parser:r=a=>a}){return t&&e&&t.length===e.length&&t.every((a,o)=>r(a)===r(e[o]))}function L4(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function M7(t={}){const{ignoreAccents:e=!0,ignoreCase:r=!0,limit:a,matchFrom:o="any",stringify:n,trim:f=!1}=t;return(m,{inputValue:y,getOptionLabel:C})=>{let w=f?y.trim():y;r&&(w=w.toLowerCase()),e&&(w=L4(w));const A=w?m.filter(R=>{let I=(n||C)(R);return r&&(I=I.toLowerCase()),e&&(I=L4(I)),o==="start"?I.startsWith(w):I.includes(w)}):m;return typeof a=="number"?A.slice(0,a):A}}const _7=M7(),B4=5,O7=t=>t.current!==null&&t.current.parentElement?.contains(document.activeElement),F7=[];function z4(t,e,r,a){if(e||t==null||a)return"";const o=r(t);return typeof o=="string"?o:""}function N7(t){const{unstable_isActiveElementInListbox:e=O7,unstable_classNamePrefix:r="Mui",autoComplete:a=!1,autoHighlight:o=!1,autoSelect:n=!1,blurOnSelect:f=!1,clearOnBlur:m=!t.freeSolo,clearOnEscape:y=!1,componentName:C="useAutocomplete",defaultValue:w=t.multiple?F7:null,disableClearable:A=!1,disableCloseOnSelect:R=!1,disabled:I,disabledItemsFocusable:M=!1,disableListWrap:F=!1,filterOptions:O=_7,filterSelectedOptions:j=!1,freeSolo:U=!1,getOptionDisabled:H,getOptionKey:K,getOptionLabel:W=Pt=>Pt.label??Pt,groupBy:X,handleHomeEndKeys:ee=!t.freeSolo,id:ie,includeInputInList:de=!1,inputValue:le,isOptionEqualToValue:oe=(Pt,Tt)=>Pt===Tt,multiple:N=!1,onChange:ce,onClose:ne,onHighlightChange:Se,onInputChange:se,onOpen:ye,open:ze,openOnFocus:Re=!1,options:ve,readOnly:V=!1,renderValue:ue,selectOnFocus:Ee=!t.freeSolo,value:Ie}=t,ae=nc(ie);let be=W;be=Pt=>{const Tt=W(Pt);return typeof Tt!="string"?String(Tt):Tt};const Te=E.useRef(!1),tt=E.useRef(!0),je=E.useRef(null),Pe=E.useRef(null),[Be,Fe]=E.useState(null),[Ge,Oe]=E.useState(-1),mt=o?0:-1,qe=E.useRef(mt),Ae=E.useRef(z4(w??Ie,N,be)).current,[te,pe]=Ki({controlled:Ie,default:w,name:C}),[J,fe]=Ki({controlled:le,default:Ae,name:C,state:"inputValue"}),[xe,Ne]=E.useState(!1),Me=E.useCallback((Pt,Tt,Dn)=>{if(!(N?te.length<Tt.length:Tt!==null)&&!m)return;const or=z4(Tt,N,be,ue);J!==or&&(fe(or),se&&se(Pt,or,Dn))},[be,J,N,se,fe,m,te,ue]),[Ve,Qe]=Ki({controlled:ze,default:!1,name:C,state:"open"}),[rt,st]=E.useState(!0),it=!N&&te!=null&&J===be(te),xt=Ve&&!V,pt=xt?O(ve.filter(Pt=>!(j&&(N?te:[te]).some(Tt=>Tt!==null&&oe(Pt,Tt)))),{inputValue:it&&rt?"":J,getOptionLabel:be}):[],Yt=P7({filteredOptions:pt,value:te,inputValue:J});E.useEffect(()=>{const Pt=te!==Yt.value;xe&&!Pt||U&&!Pt||Me(null,te,"reset")},[te,Me,xe,Yt.value,U]);const Kt=Ve&&pt.length>0&&!V,tn=yn(Pt=>{if(Pt===-1)je.current.focus();else{const Tt=ue?"data-item-index":"data-tag-index";Be.querySelector(`[${Tt}="${Pt}"]`).focus()}});E.useEffect(()=>{N&&Ge>te.length-1&&(Oe(-1),tn(-1))},[te,N,Ge,tn]);function Wt(Pt,Tt){if(!Pe.current||Pt<0||Pt>=pt.length)return-1;let Dn=Pt;for(;;){const nr=Pe.current.querySelector(`[data-option-index="${Dn}"]`),or=M?!1:!nr||nr.disabled||nr.getAttribute("aria-disabled")==="true";if(nr&&nr.hasAttribute("tabindex")&&!or)return Dn;if(Tt==="next"?Dn=(Dn+1)%pt.length:Dn=(Dn-1+pt.length)%pt.length,Dn===Pt)return-1}}const _t=yn(({event:Pt,index:Tt,reason:Dn})=>{if(qe.current=Tt,Tt===-1?je.current.removeAttribute("aria-activedescendant"):je.current.setAttribute("aria-activedescendant",`${ae}-option-${Tt}`),Se&&["mouse","keyboard","touch"].includes(Dn)&&Se(Pt,Tt===-1?null:pt[Tt],Dn),!Pe.current)return;const nr=Pe.current.querySelector(`[role="option"].${r}-focused`);nr&&(nr.classList.remove(`${r}-focused`),nr.classList.remove(`${r}-focusVisible`));let or=Pe.current;if(Pe.current.getAttribute("role")!=="listbox"&&(or=Pe.current.parentElement.querySelector('[role="listbox"]')),!or)return;if(Tt===-1){or.scrollTop=0;return}const Ao=Pe.current.querySelector(`[data-option-index="${Tt}"]`);if(Ao&&(Ao.classList.add(`${r}-focused`),Dn==="keyboard"&&Ao.classList.add(`${r}-focusVisible`),or.scrollHeight>or.clientHeight&&Dn!=="mouse"&&Dn!=="touch")){const kr=Ao,Zr=or.clientHeight+or.scrollTop,Eo=kr.offsetTop+kr.offsetHeight;Eo>Zr?or.scrollTop=Eo-or.clientHeight:kr.offsetTop-kr.offsetHeight*(X?1.3:0)<or.scrollTop&&(or.scrollTop=kr.offsetTop-kr.offsetHeight*(X?1.3:0))}}),at=yn(({event:Pt,diff:Tt,direction:Dn="next",reason:nr})=>{if(!xt)return;const Ao=Wt((()=>{const kr=pt.length-1;if(Tt==="reset")return mt;if(Tt==="start")return 0;if(Tt==="end")return kr;const Zr=qe.current+Tt;return Zr<0?Zr===-1&&de?-1:F&&qe.current!==-1||Math.abs(Tt)>1?0:kr:Zr>kr?Zr===kr+1&&de?-1:F||Math.abs(Tt)>1?kr:0:Zr})(),Dn);if(_t({index:Ao,reason:nr,event:Pt}),a&&Tt!=="reset")if(Ao===-1)je.current.value=J;else{const kr=be(pt[Ao]);je.current.value=kr,kr.toLowerCase().indexOf(J.toLowerCase())===0&&J.length>0&&je.current.setSelectionRange(J.length,kr.length)}}),Et=!j4({array1:Yt.filteredOptions,array2:pt,parser:be}),qt=()=>{const Pt=(Tt,Dn)=>{const nr=Tt?be(Tt):"",or=Dn?be(Dn):"";return nr===or};if(qe.current!==-1&&!j4({array1:Yt.filteredOptions,array2:pt,parser:be})&&Yt.inputValue===J&&(N?te.length===Yt.value.length&&Yt.value.every((Tt,Dn)=>be(te[Dn])===be(Tt)):Pt(Yt.value,te))){const Tt=Yt.filteredOptions[qe.current];if(Tt)return pt.findIndex(Dn=>be(Dn)===be(Tt))}return-1},gn=E.useCallback(()=>{if(!xt)return;const Pt=qt();if(Pt!==-1){qe.current=Pt;return}const Tt=N?te[0]:te;if(pt.length===0||Tt==null){at({diff:"reset"});return}if(Pe.current){if(Tt!=null){const Dn=pt[qe.current];if(N&&Dn&&te.findIndex(or=>oe(Dn,or))!==-1)return;const nr=pt.findIndex(or=>oe(or,Tt));nr===-1?at({diff:"reset"}):_t({index:nr});return}if(qe.current>=pt.length-1){_t({index:pt.length-1});return}_t({index:qe.current})}},[pt.length,N?!1:te,at,_t,xt,J,N]),Sn=yn(Pt=>{Gw(Pe,Pt),Pt&&gn()});E.useEffect(()=>{(Et||xt)&&gn()},[gn,Et,xt]);const Zt=Pt=>{Ve||(Qe(!0),st(!0),ye&&ye(Pt))},Kn=(Pt,Tt)=>{Ve&&(Qe(!1),ne&&ne(Pt,Tt))},$t=(Pt,Tt,Dn,nr)=>{if(N){if(te.length===Tt.length&&te.every((or,Ao)=>or===Tt[Ao]))return}else if(te===Tt)return;ce&&ce(Pt,Tt,Dn,nr),pe(Tt)},Cr=E.useRef(!1),tr=(Pt,Tt,Dn="selectOption",nr="options")=>{let or=Dn,Ao=Tt;if(N){Ao=Array.isArray(te)?te.slice():[];const kr=Ao.findIndex(Zr=>oe(Tt,Zr));kr===-1?Ao.push(Tt):nr!=="freeSolo"&&(Ao.splice(kr,1),or="removeOption")}Me(Pt,Ao,or),$t(Pt,Ao,or,{option:Tt}),!R&&(!Pt||!Pt.ctrlKey&&!Pt.metaKey)&&Kn(Pt,or),(f===!0||f==="touch"&&Cr.current||f==="mouse"&&!Cr.current)&&je.current.blur()};function Bt(Pt,Tt){if(Pt===-1)return-1;let Dn=Pt;for(;;){if(Tt==="next"&&Dn===te.length||Tt==="previous"&&Dn===-1)return-1;const nr=ue?"data-item-index":"data-tag-index",or=Be.querySelector(`[${nr}="${Dn}"]`);if(!or||!or.hasAttribute("tabindex")||or.disabled||or.getAttribute("aria-disabled")==="true")Dn+=Tt==="next"?1:-1;else return Dn}}const gr=(Pt,Tt)=>{if(!N)return;J===""&&Kn(Pt,"toggleInput");let Dn=Ge;Ge===-1?J===""&&Tt==="previous"&&(Dn=te.length-1):(Dn+=Tt==="next"?1:-1,Dn<0&&(Dn=0),Dn===te.length&&(Dn=-1)),Dn=Bt(Dn,Tt),Oe(Dn),tn(Dn)},en=Pt=>{Te.current=!0,fe(""),se&&se(Pt,"","clear"),$t(Pt,N?[]:null,"clear")},un=Pt=>Tt=>{if(Pt.onKeyDown&&Pt.onKeyDown(Tt),!Tt.defaultMuiPrevented&&(Ge!==-1&&!["ArrowLeft","ArrowRight"].includes(Tt.key)&&(Oe(-1),tn(-1)),Tt.which!==229))switch(Tt.key){case"Home":xt&&ee&&(Tt.preventDefault(),at({diff:"start",direction:"next",reason:"keyboard",event:Tt}));break;case"End":xt&&ee&&(Tt.preventDefault(),at({diff:"end",direction:"previous",reason:"keyboard",event:Tt}));break;case"PageUp":Tt.preventDefault(),at({diff:-B4,direction:"previous",reason:"keyboard",event:Tt}),Zt(Tt);break;case"PageDown":Tt.preventDefault(),at({diff:B4,direction:"next",reason:"keyboard",event:Tt}),Zt(Tt);break;case"ArrowDown":Tt.preventDefault(),at({diff:1,direction:"next",reason:"keyboard",event:Tt}),Zt(Tt);break;case"ArrowUp":Tt.preventDefault(),at({diff:-1,direction:"previous",reason:"keyboard",event:Tt}),Zt(Tt);break;case"ArrowLeft":!N&&ue&&te!=null?(Oe(0),tn(0)):gr(Tt,"previous");break;case"ArrowRight":!N&&ue?(Oe(-1),tn(-1)):gr(Tt,"next");break;case"Enter":if(qe.current!==-1&&xt){const Dn=pt[qe.current],nr=H?H(Dn):!1;if(Tt.preventDefault(),nr)return;tr(Tt,Dn,"selectOption"),a&&je.current.setSelectionRange(je.current.value.length,je.current.value.length)}else U&&J!==""&&it===!1&&(N&&Tt.preventDefault(),tr(Tt,J,"createOption","freeSolo"));break;case"Escape":xt?(Tt.preventDefault(),Tt.stopPropagation(),Kn(Tt,"escape")):y&&(J!==""||N&&te.length>0||ue)&&(Tt.preventDefault(),Tt.stopPropagation(),en(Tt));break;case"Backspace":if(N&&!V&&J===""&&te.length>0){const Dn=Ge===-1?te.length-1:Ge,nr=te.slice();nr.splice(Dn,1),$t(Tt,nr,"removeOption",{option:te[Dn]})}!N&&ue&&!V&&(pe(null),Oe(-1),tn(-1));break;case"Delete":if(N&&!V&&J===""&&te.length>0&&Ge!==-1){const Dn=Ge,nr=te.slice();nr.splice(Dn,1),$t(Tt,nr,"removeOption",{option:te[Dn]})}!N&&ue&&!V&&(pe(null),Oe(-1),tn(-1));break}},Yn=Pt=>{Ne(!0),Ge!==-1&&(Oe(-1),tn(-1)),Re&&!Te.current&&Zt(Pt)},En=Pt=>{if(e(Pe)){je.current.focus();return}Ne(!1),tt.current=!0,Te.current=!1,n&&qe.current!==-1&&xt?tr(Pt,pt[qe.current],"blur"):n&&U&&J!==""?tr(Pt,J,"blur","freeSolo"):m&&Me(Pt,te,"blur"),Kn(Pt,"blur")},fr=Pt=>{const Tt=Pt.target.value;J!==Tt&&(fe(Tt),st(!1),se&&se(Pt,Tt,"input")),Tt===""?!A&&!N&&$t(Pt,null,"clear"):Zt(Pt)},fo=Pt=>{const Tt=Number(Pt.currentTarget.getAttribute("data-option-index"));qe.current!==Tt&&_t({event:Pt,index:Tt,reason:"mouse"})},xo=Pt=>{_t({event:Pt,index:Number(Pt.currentTarget.getAttribute("data-option-index")),reason:"touch"}),Cr.current=!0},Qn=Pt=>{const Tt=Number(Pt.currentTarget.getAttribute("data-option-index"));tr(Pt,pt[Tt],"selectOption"),Cr.current=!1},Or=Pt=>Tt=>{const Dn=te.slice();Dn.splice(Pt,1),$t(Tt,Dn,"removeOption",{option:te[Pt]})},Ko=Pt=>{$t(Pt,null,"removeOption",{option:te})},Rr=Pt=>{Ve?Kn(Pt,"toggleInput"):Zt(Pt)},Jn=Pt=>{Pt.currentTarget.contains(Pt.target)&&Pt.target.getAttribute("id")!==ae&&Pt.preventDefault()},aa=Pt=>{Pt.currentTarget.contains(Pt.target)&&(je.current.focus(),Ee&&tt.current&&je.current.selectionEnd-je.current.selectionStart===0&&je.current.select(),tt.current=!1)},qr=Pt=>{!I&&(J===""||!Ve)&&Rr(Pt)};let ho=U&&J.length>0;ho=ho||(N?te.length>0:te!==null);let ts=pt;return X&&(ts=pt.reduce((Pt,Tt,Dn)=>{const nr=X(Tt);return Pt.length>0&&Pt[Pt.length-1].group===nr?Pt[Pt.length-1].options.push(Tt):Pt.push({key:Dn,index:Dn,group:nr,options:[Tt]}),Pt},[])),I&&xe&&En(),{getRootProps:(Pt={})=>({...Pt,onKeyDown:un(Pt),onMouseDown:Jn,onClick:aa}),getInputLabelProps:()=>({id:`${ae}-label`,htmlFor:ae}),getInputProps:()=>({id:ae,value:J,onBlur:En,onFocus:Yn,onChange:fr,onMouseDown:qr,"aria-activedescendant":xt?"":null,"aria-autocomplete":a?"both":"list","aria-controls":Kt?`${ae}-listbox`:void 0,"aria-expanded":Kt,autoComplete:"off",ref:je,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:I}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:en}),getItemProps:({index:Pt=0}={})=>({...N&&{key:Pt},...ue?{"data-item-index":Pt}:{"data-tag-index":Pt},tabIndex:-1,...!V&&{onDelete:N?Or(Pt):Ko}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:Rr}),getTagProps:({index:Pt})=>({key:Pt,"data-tag-index":Pt,tabIndex:-1,...!V&&{onDelete:Or(Pt)}}),getListboxProps:()=>({role:"listbox",id:`${ae}-listbox`,"aria-labelledby":`${ae}-label`,ref:Sn,onMouseDown:Pt=>{Pt.preventDefault()}}),getOptionProps:({index:Pt,option:Tt})=>{const Dn=(N?te:[te]).some(or=>or!=null&&oe(Tt,or)),nr=H?H(Tt):!1;return{key:K?.(Tt)??be(Tt),tabIndex:-1,role:"option",id:`${ae}-option-${Pt}`,onMouseMove:fo,onClick:Qn,onTouchStart:xo,"data-option-index":Pt,"aria-disabled":nr,"aria-selected":Dn}},id:ae,inputValue:J,value:te,dirty:ho,expanded:xt&&Be,popupOpen:xt,focused:xe||Ge!==-1,anchorEl:Be,setAnchorEl:Fe,focusedItem:Ge,focusedTag:Ge,groupedOptions:ts}}var Yi="top",Jl="bottom",Zl="right",qi="left",pA="auto",Cb=[Yi,Jl,Zl,qi],qm="start",Qy="end",j7="clippingParents",Z3="viewport",cy="popper",L7="reference",U4=Cb.reduce(function(t,e){return t.concat([e+"-"+qm,e+"-"+Qy])},[]),eI=[].concat(Cb,[pA]).reduce(function(t,e){return t.concat([e,e+"-"+qm,e+"-"+Qy])},[]),B7="beforeRead",z7="read",U7="afterRead",$7="beforeMain",H7="main",W7="afterMain",V7="beforeWrite",G7="write",K7="afterWrite",Y7=[B7,z7,U7,$7,H7,W7,V7,G7,K7];function Iu(t){return t?(t.nodeName||"").toLowerCase():null}function Tl(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function mp(t){var e=Tl(t).Element;return t instanceof e||t instanceof Element}function Xl(t){var e=Tl(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function mA(t){if(typeof ShadowRoot>"u")return!1;var e=Tl(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function q7(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var a=e.styles[r]||{},o=e.attributes[r]||{},n=e.elements[r];!Xl(n)||!Iu(n)||(Object.assign(n.style,a),Object.keys(o).forEach(function(f){var m=o[f];m===!1?n.removeAttribute(f):n.setAttribute(f,m===!0?"":m)}))})}function Q7(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(a){var o=e.elements[a],n=e.attributes[a]||{},f=Object.keys(e.styles.hasOwnProperty(a)?e.styles[a]:r[a]),m=f.reduce(function(y,C){return y[C]="",y},{});!Xl(o)||!Iu(o)||(Object.assign(o.style,m),Object.keys(n).forEach(function(y){o.removeAttribute(y)}))})}}const X7={name:"applyStyles",enabled:!0,phase:"write",fn:q7,effect:Q7,requires:["computeStyles"]};function Eu(t){return t.split("-")[0]}var hp=Math.max,C2=Math.min,Qm=Math.round;function Jw(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function tI(){return!/^((?!chrome|android).)*safari/i.test(Jw())}function Xm(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var a=t.getBoundingClientRect(),o=1,n=1;e&&Xl(t)&&(o=t.offsetWidth>0&&Qm(a.width)/t.offsetWidth||1,n=t.offsetHeight>0&&Qm(a.height)/t.offsetHeight||1);var f=mp(t)?Tl(t):window,m=f.visualViewport,y=!tI()&&r,C=(a.left+(y&&m?m.offsetLeft:0))/o,w=(a.top+(y&&m?m.offsetTop:0))/n,A=a.width/o,R=a.height/n;return{width:A,height:R,top:w,right:C+A,bottom:w+R,left:C,x:C,y:w}}function gA(t){var e=Xm(t),r=t.offsetWidth,a=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-a)<=1&&(a=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:a}}function nI(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&mA(r)){var a=e;do{if(a&&t.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function Sd(t){return Tl(t).getComputedStyle(t)}function J7(t){return["table","td","th"].indexOf(Iu(t))>=0}function $f(t){return((mp(t)?t.ownerDocument:t.document)||window.document).documentElement}function AC(t){return Iu(t)==="html"?t:t.assignedSlot||t.parentNode||(mA(t)?t.host:null)||$f(t)}function $4(t){return!Xl(t)||Sd(t).position==="fixed"?null:t.offsetParent}function Z7(t){var e=/firefox/i.test(Jw()),r=/Trident/i.test(Jw());if(r&&Xl(t)){var a=Sd(t);if(a.position==="fixed")return null}var o=AC(t);for(mA(o)&&(o=o.host);Xl(o)&&["html","body"].indexOf(Iu(o))<0;){var n=Sd(o);if(n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].indexOf(n.willChange)!==-1||e&&n.willChange==="filter"||e&&n.filter&&n.filter!=="none")return o;o=o.parentNode}return null}function Sb(t){for(var e=Tl(t),r=$4(t);r&&J7(r)&&Sd(r).position==="static";)r=$4(r);return r&&(Iu(r)==="html"||Iu(r)==="body"&&Sd(r).position==="static")?e:r||Z7(t)||e}function yA(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Py(t,e,r){return hp(t,C2(e,r))}function eL(t,e,r){var a=Py(t,e,r);return a>r?r:a}function rI(){return{top:0,right:0,bottom:0,left:0}}function oI(t){return Object.assign({},rI(),t)}function aI(t,e){return e.reduce(function(r,a){return r[a]=t,r},{})}var tL=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,oI(typeof e!="number"?e:aI(e,Cb))};function nL(t){var e,r=t.state,a=t.name,o=t.options,n=r.elements.arrow,f=r.modifiersData.popperOffsets,m=Eu(r.placement),y=yA(m),C=[qi,Zl].indexOf(m)>=0,w=C?"height":"width";if(!(!n||!f)){var A=tL(o.padding,r),R=gA(n),I=y==="y"?Yi:qi,M=y==="y"?Jl:Zl,F=r.rects.reference[w]+r.rects.reference[y]-f[y]-r.rects.popper[w],O=f[y]-r.rects.reference[y],j=Sb(n),U=j?y==="y"?j.clientHeight||0:j.clientWidth||0:0,H=F/2-O/2,K=A[I],W=U-R[w]-A[M],X=U/2-R[w]/2+H,ee=Py(K,X,W),ie=y;r.modifiersData[a]=(e={},e[ie]=ee,e.centerOffset=ee-X,e)}}function rL(t){var e=t.state,r=t.options,a=r.element,o=a===void 0?"[data-popper-arrow]":a;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||nI(e.elements.popper,o)&&(e.elements.arrow=o))}const oL={name:"arrow",enabled:!0,phase:"main",fn:nL,effect:rL,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Jm(t){return t.split("-")[1]}var aL={top:"auto",right:"auto",bottom:"auto",left:"auto"};function sL(t,e){var r=t.x,a=t.y,o=e.devicePixelRatio||1;return{x:Qm(r*o)/o||0,y:Qm(a*o)/o||0}}function H4(t){var e,r=t.popper,a=t.popperRect,o=t.placement,n=t.variation,f=t.offsets,m=t.position,y=t.gpuAcceleration,C=t.adaptive,w=t.roundOffsets,A=t.isFixed,R=f.x,I=R===void 0?0:R,M=f.y,F=M===void 0?0:M,O=typeof w=="function"?w({x:I,y:F}):{x:I,y:F};I=O.x,F=O.y;var j=f.hasOwnProperty("x"),U=f.hasOwnProperty("y"),H=qi,K=Yi,W=window;if(C){var X=Sb(r),ee="clientHeight",ie="clientWidth";if(X===Tl(r)&&(X=$f(r),Sd(X).position!=="static"&&m==="absolute"&&(ee="scrollHeight",ie="scrollWidth")),X=X,o===Yi||(o===qi||o===Zl)&&n===Qy){K=Jl;var de=A&&X===W&&W.visualViewport?W.visualViewport.height:X[ee];F-=de-a.height,F*=y?1:-1}if(o===qi||(o===Yi||o===Jl)&&n===Qy){H=Zl;var le=A&&X===W&&W.visualViewport?W.visualViewport.width:X[ie];I-=le-a.width,I*=y?1:-1}}var oe=Object.assign({position:m},C&&aL),N=w===!0?sL({x:I,y:F},Tl(r)):{x:I,y:F};if(I=N.x,F=N.y,y){var ce;return Object.assign({},oe,(ce={},ce[K]=U?"0":"",ce[H]=j?"0":"",ce.transform=(W.devicePixelRatio||1)<=1?"translate("+I+"px, "+F+"px)":"translate3d("+I+"px, "+F+"px, 0)",ce))}return Object.assign({},oe,(e={},e[K]=U?F+"px":"",e[H]=j?I+"px":"",e.transform="",e))}function iL(t){var e=t.state,r=t.options,a=r.gpuAcceleration,o=a===void 0?!0:a,n=r.adaptive,f=n===void 0?!0:n,m=r.roundOffsets,y=m===void 0?!0:m,C={placement:Eu(e.placement),variation:Jm(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,H4(Object.assign({},C,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:f,roundOffsets:y})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,H4(Object.assign({},C,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:y})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const lL={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:iL,data:{}};var vx={passive:!0};function cL(t){var e=t.state,r=t.instance,a=t.options,o=a.scroll,n=o===void 0?!0:o,f=a.resize,m=f===void 0?!0:f,y=Tl(e.elements.popper),C=[].concat(e.scrollParents.reference,e.scrollParents.popper);return n&&C.forEach(function(w){w.addEventListener("scroll",r.update,vx)}),m&&y.addEventListener("resize",r.update,vx),function(){n&&C.forEach(function(w){w.removeEventListener("scroll",r.update,vx)}),m&&y.removeEventListener("resize",r.update,vx)}}const uL={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:cL,data:{}};var dL={left:"right",right:"left",bottom:"top",top:"bottom"};function Xx(t){return t.replace(/left|right|bottom|top/g,function(e){return dL[e]})}var fL={start:"end",end:"start"};function W4(t){return t.replace(/start|end/g,function(e){return fL[e]})}function bA(t){var e=Tl(t),r=e.pageXOffset,a=e.pageYOffset;return{scrollLeft:r,scrollTop:a}}function vA(t){return Xm($f(t)).left+bA(t).scrollLeft}function hL(t,e){var r=Tl(t),a=$f(t),o=r.visualViewport,n=a.clientWidth,f=a.clientHeight,m=0,y=0;if(o){n=o.width,f=o.height;var C=tI();(C||!C&&e==="fixed")&&(m=o.offsetLeft,y=o.offsetTop)}return{width:n,height:f,x:m+vA(t),y}}function pL(t){var e,r=$f(t),a=bA(t),o=(e=t.ownerDocument)==null?void 0:e.body,n=hp(r.scrollWidth,r.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),f=hp(r.scrollHeight,r.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),m=-a.scrollLeft+vA(t),y=-a.scrollTop;return Sd(o||r).direction==="rtl"&&(m+=hp(r.clientWidth,o?o.clientWidth:0)-n),{width:n,height:f,x:m,y}}function xA(t){var e=Sd(t),r=e.overflow,a=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+o+a)}function sI(t){return["html","body","#document"].indexOf(Iu(t))>=0?t.ownerDocument.body:Xl(t)&&xA(t)?t:sI(AC(t))}function My(t,e){var r;e===void 0&&(e=[]);var a=sI(t),o=a===((r=t.ownerDocument)==null?void 0:r.body),n=Tl(a),f=o?[n].concat(n.visualViewport||[],xA(a)?a:[]):a,m=e.concat(f);return o?m:m.concat(My(AC(f)))}function Zw(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function mL(t,e){var r=Xm(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function V4(t,e,r){return e===Z3?Zw(hL(t,r)):mp(e)?mL(e,r):Zw(pL($f(t)))}function gL(t){var e=My(AC(t)),r=["absolute","fixed"].indexOf(Sd(t).position)>=0,a=r&&Xl(t)?Sb(t):t;return mp(a)?e.filter(function(o){return mp(o)&&nI(o,a)&&Iu(o)!=="body"}):[]}function yL(t,e,r,a){var o=e==="clippingParents"?gL(t):[].concat(e),n=[].concat(o,[r]),f=n[0],m=n.reduce(function(y,C){var w=V4(t,C,a);return y.top=hp(w.top,y.top),y.right=C2(w.right,y.right),y.bottom=C2(w.bottom,y.bottom),y.left=hp(w.left,y.left),y},V4(t,f,a));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m}function iI(t){var e=t.reference,r=t.element,a=t.placement,o=a?Eu(a):null,n=a?Jm(a):null,f=e.x+e.width/2-r.width/2,m=e.y+e.height/2-r.height/2,y;switch(o){case Yi:y={x:f,y:e.y-r.height};break;case Jl:y={x:f,y:e.y+e.height};break;case Zl:y={x:e.x+e.width,y:m};break;case qi:y={x:e.x-r.width,y:m};break;default:y={x:e.x,y:e.y}}var C=o?yA(o):null;if(C!=null){var w=C==="y"?"height":"width";switch(n){case qm:y[C]=y[C]-(e[w]/2-r[w]/2);break;case Qy:y[C]=y[C]+(e[w]/2-r[w]/2);break}}return y}function Xy(t,e){e===void 0&&(e={});var r=e,a=r.placement,o=a===void 0?t.placement:a,n=r.strategy,f=n===void 0?t.strategy:n,m=r.boundary,y=m===void 0?j7:m,C=r.rootBoundary,w=C===void 0?Z3:C,A=r.elementContext,R=A===void 0?cy:A,I=r.altBoundary,M=I===void 0?!1:I,F=r.padding,O=F===void 0?0:F,j=oI(typeof O!="number"?O:aI(O,Cb)),U=R===cy?L7:cy,H=t.rects.popper,K=t.elements[M?U:R],W=yL(mp(K)?K:K.contextElement||$f(t.elements.popper),y,w,f),X=Xm(t.elements.reference),ee=iI({reference:X,element:H,placement:o}),ie=Zw(Object.assign({},H,ee)),de=R===cy?ie:X,le={top:W.top-de.top+j.top,bottom:de.bottom-W.bottom+j.bottom,left:W.left-de.left+j.left,right:de.right-W.right+j.right},oe=t.modifiersData.offset;if(R===cy&&oe){var N=oe[o];Object.keys(le).forEach(function(ce){var ne=[Zl,Jl].indexOf(ce)>=0?1:-1,Se=[Yi,Jl].indexOf(ce)>=0?"y":"x";le[ce]+=N[Se]*ne})}return le}function bL(t,e){e===void 0&&(e={});var r=e,a=r.placement,o=r.boundary,n=r.rootBoundary,f=r.padding,m=r.flipVariations,y=r.allowedAutoPlacements,C=y===void 0?eI:y,w=Jm(a),A=w?m?U4:U4.filter(function(M){return Jm(M)===w}):Cb,R=A.filter(function(M){return C.indexOf(M)>=0});R.length===0&&(R=A);var I=R.reduce(function(M,F){return M[F]=Xy(t,{placement:F,boundary:o,rootBoundary:n,padding:f})[Eu(F)],M},{});return Object.keys(I).sort(function(M,F){return I[M]-I[F]})}function vL(t){if(Eu(t)===pA)return[];var e=Xx(t);return[W4(t),e,W4(e)]}function xL(t){var e=t.state,r=t.options,a=t.name;if(!e.modifiersData[a]._skip){for(var o=r.mainAxis,n=o===void 0?!0:o,f=r.altAxis,m=f===void 0?!0:f,y=r.fallbackPlacements,C=r.padding,w=r.boundary,A=r.rootBoundary,R=r.altBoundary,I=r.flipVariations,M=I===void 0?!0:I,F=r.allowedAutoPlacements,O=e.options.placement,j=Eu(O),U=j===O,H=y||(U||!M?[Xx(O)]:vL(O)),K=[O].concat(H).reduce(function(Ie,ae){return Ie.concat(Eu(ae)===pA?bL(e,{placement:ae,boundary:w,rootBoundary:A,padding:C,flipVariations:M,allowedAutoPlacements:F}):ae)},[]),W=e.rects.reference,X=e.rects.popper,ee=new Map,ie=!0,de=K[0],le=0;le<K.length;le++){var oe=K[le],N=Eu(oe),ce=Jm(oe)===qm,ne=[Yi,Jl].indexOf(N)>=0,Se=ne?"width":"height",se=Xy(e,{placement:oe,boundary:w,rootBoundary:A,altBoundary:R,padding:C}),ye=ne?ce?Zl:qi:ce?Jl:Yi;W[Se]>X[Se]&&(ye=Xx(ye));var ze=Xx(ye),Re=[];if(n&&Re.push(se[N]<=0),m&&Re.push(se[ye]<=0,se[ze]<=0),Re.every(function(Ie){return Ie})){de=oe,ie=!1;break}ee.set(oe,Re)}if(ie)for(var ve=M?3:1,V=function(ae){var be=K.find(function(Te){var tt=ee.get(Te);if(tt)return tt.slice(0,ae).every(function(je){return je})});if(be)return de=be,"break"},ue=ve;ue>0;ue--){var Ee=V(ue);if(Ee==="break")break}e.placement!==de&&(e.modifiersData[a]._skip=!0,e.placement=de,e.reset=!0)}}const CL={name:"flip",enabled:!0,phase:"main",fn:xL,requiresIfExists:["offset"],data:{_skip:!1}};function G4(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function K4(t){return[Yi,Zl,Jl,qi].some(function(e){return t[e]>=0})}function SL(t){var e=t.state,r=t.name,a=e.rects.reference,o=e.rects.popper,n=e.modifiersData.preventOverflow,f=Xy(e,{elementContext:"reference"}),m=Xy(e,{altBoundary:!0}),y=G4(f,a),C=G4(m,o,n),w=K4(y),A=K4(C);e.modifiersData[r]={referenceClippingOffsets:y,popperEscapeOffsets:C,isReferenceHidden:w,hasPopperEscaped:A},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":w,"data-popper-escaped":A})}const wL={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:SL};function TL(t,e,r){var a=Eu(t),o=[qi,Yi].indexOf(a)>=0?-1:1,n=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,f=n[0],m=n[1];return f=f||0,m=(m||0)*o,[qi,Zl].indexOf(a)>=0?{x:m,y:f}:{x:f,y:m}}function AL(t){var e=t.state,r=t.options,a=t.name,o=r.offset,n=o===void 0?[0,0]:o,f=eI.reduce(function(w,A){return w[A]=TL(A,e.rects,n),w},{}),m=f[e.placement],y=m.x,C=m.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=y,e.modifiersData.popperOffsets.y+=C),e.modifiersData[a]=f}const EL={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:AL};function kL(t){var e=t.state,r=t.name;e.modifiersData[r]=iI({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const DL={name:"popperOffsets",enabled:!0,phase:"read",fn:kL,data:{}};function RL(t){return t==="x"?"y":"x"}function IL(t){var e=t.state,r=t.options,a=t.name,o=r.mainAxis,n=o===void 0?!0:o,f=r.altAxis,m=f===void 0?!1:f,y=r.boundary,C=r.rootBoundary,w=r.altBoundary,A=r.padding,R=r.tether,I=R===void 0?!0:R,M=r.tetherOffset,F=M===void 0?0:M,O=Xy(e,{boundary:y,rootBoundary:C,padding:A,altBoundary:w}),j=Eu(e.placement),U=Jm(e.placement),H=!U,K=yA(j),W=RL(K),X=e.modifiersData.popperOffsets,ee=e.rects.reference,ie=e.rects.popper,de=typeof F=="function"?F(Object.assign({},e.rects,{placement:e.placement})):F,le=typeof de=="number"?{mainAxis:de,altAxis:de}:Object.assign({mainAxis:0,altAxis:0},de),oe=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,N={x:0,y:0};if(X){if(n){var ce,ne=K==="y"?Yi:qi,Se=K==="y"?Jl:Zl,se=K==="y"?"height":"width",ye=X[K],ze=ye+O[ne],Re=ye-O[Se],ve=I?-ie[se]/2:0,V=U===qm?ee[se]:ie[se],ue=U===qm?-ie[se]:-ee[se],Ee=e.elements.arrow,Ie=I&&Ee?gA(Ee):{width:0,height:0},ae=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:rI(),be=ae[ne],Te=ae[Se],tt=Py(0,ee[se],Ie[se]),je=H?ee[se]/2-ve-tt-be-le.mainAxis:V-tt-be-le.mainAxis,Pe=H?-ee[se]/2+ve+tt+Te+le.mainAxis:ue+tt+Te+le.mainAxis,Be=e.elements.arrow&&Sb(e.elements.arrow),Fe=Be?K==="y"?Be.clientTop||0:Be.clientLeft||0:0,Ge=(ce=oe?.[K])!=null?ce:0,Oe=ye+je-Ge-Fe,mt=ye+Pe-Ge,qe=Py(I?C2(ze,Oe):ze,ye,I?hp(Re,mt):Re);X[K]=qe,N[K]=qe-ye}if(m){var Ae,te=K==="x"?Yi:qi,pe=K==="x"?Jl:Zl,J=X[W],fe=W==="y"?"height":"width",xe=J+O[te],Ne=J-O[pe],Me=[Yi,qi].indexOf(j)!==-1,Ve=(Ae=oe?.[W])!=null?Ae:0,Qe=Me?xe:J-ee[fe]-ie[fe]-Ve+le.altAxis,rt=Me?J+ee[fe]+ie[fe]-Ve-le.altAxis:Ne,st=I&&Me?eL(Qe,J,rt):Py(I?Qe:xe,J,I?rt:Ne);X[W]=st,N[W]=st-J}e.modifiersData[a]=N}}const PL={name:"preventOverflow",enabled:!0,phase:"main",fn:IL,requiresIfExists:["offset"]};function ML(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function _L(t){return t===Tl(t)||!Xl(t)?bA(t):ML(t)}function OL(t){var e=t.getBoundingClientRect(),r=Qm(e.width)/t.offsetWidth||1,a=Qm(e.height)/t.offsetHeight||1;return r!==1||a!==1}function FL(t,e,r){r===void 0&&(r=!1);var a=Xl(e),o=Xl(e)&&OL(e),n=$f(e),f=Xm(t,o,r),m={scrollLeft:0,scrollTop:0},y={x:0,y:0};return(a||!a&&!r)&&((Iu(e)!=="body"||xA(n))&&(m=_L(e)),Xl(e)?(y=Xm(e,!0),y.x+=e.clientLeft,y.y+=e.clientTop):n&&(y.x=vA(n))),{x:f.left+m.scrollLeft-y.x,y:f.top+m.scrollTop-y.y,width:f.width,height:f.height}}function NL(t){var e=new Map,r=new Set,a=[];t.forEach(function(n){e.set(n.name,n)});function o(n){r.add(n.name);var f=[].concat(n.requires||[],n.requiresIfExists||[]);f.forEach(function(m){if(!r.has(m)){var y=e.get(m);y&&o(y)}}),a.push(n)}return t.forEach(function(n){r.has(n.name)||o(n)}),a}function jL(t){var e=NL(t);return Y7.reduce(function(r,a){return r.concat(e.filter(function(o){return o.phase===a}))},[])}function LL(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function BL(t){var e=t.reduce(function(r,a){var o=r[a.name];return r[a.name]=o?Object.assign({},o,a,{options:Object.assign({},o.options,a.options),data:Object.assign({},o.data,a.data)}):a,r},{});return Object.keys(e).map(function(r){return e[r]})}var Y4={placement:"bottom",modifiers:[],strategy:"absolute"};function q4(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function zL(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,a=r===void 0?[]:r,o=e.defaultOptions,n=o===void 0?Y4:o;return function(m,y,C){C===void 0&&(C=n);var w={placement:"bottom",orderedModifiers:[],options:Object.assign({},Y4,n),modifiersData:{},elements:{reference:m,popper:y},attributes:{},styles:{}},A=[],R=!1,I={state:w,setOptions:function(j){var U=typeof j=="function"?j(w.options):j;F(),w.options=Object.assign({},n,w.options,U),w.scrollParents={reference:mp(m)?My(m):m.contextElement?My(m.contextElement):[],popper:My(y)};var H=jL(BL([].concat(a,w.options.modifiers)));return w.orderedModifiers=H.filter(function(K){return K.enabled}),M(),I.update()},forceUpdate:function(){if(!R){var j=w.elements,U=j.reference,H=j.popper;if(q4(U,H)){w.rects={reference:FL(U,Sb(H),w.options.strategy==="fixed"),popper:gA(H)},w.reset=!1,w.placement=w.options.placement,w.orderedModifiers.forEach(function(le){return w.modifiersData[le.name]=Object.assign({},le.data)});for(var K=0;K<w.orderedModifiers.length;K++){if(w.reset===!0){w.reset=!1,K=-1;continue}var W=w.orderedModifiers[K],X=W.fn,ee=W.options,ie=ee===void 0?{}:ee,de=W.name;typeof X=="function"&&(w=X({state:w,options:ie,name:de,instance:I})||w)}}}},update:LL(function(){return new Promise(function(O){I.forceUpdate(),O(w)})}),destroy:function(){F(),R=!0}};if(!q4(m,y))return I;I.setOptions(C).then(function(O){!R&&C.onFirstUpdate&&C.onFirstUpdate(O)});function M(){w.orderedModifiers.forEach(function(O){var j=O.name,U=O.options,H=U===void 0?{}:U,K=O.effect;if(typeof K=="function"){var W=K({state:w,name:j,instance:I,options:H}),X=function(){};A.push(W||X)}})}function F(){A.forEach(function(O){return O()}),A=[]}return I}}var UL=[uL,DL,lL,X7,EL,CL,PL,oL,wL],$L=zL({defaultModifiers:UL});function no(t){const{elementType:e,externalSlotProps:r,ownerState:a,skipResolvingSlotProps:o=!1,...n}=t,f=o?{}:Ql(r,a),{props:m,internalRef:y}=Q3({...n,externalSlotProps:f}),C=ro(y,f?.ref,t.additionalProps?.ref);return q3(e,{...m,ref:C},a)}function Dp(t){return parseInt(E.version,10)>=19?t?.props?.ref||null:t?.ref||null}function HL(t){return typeof t=="function"?t():t}const lI=E.forwardRef(function(e,r){const{children:a,container:o,disablePortal:n=!1}=e,[f,m]=E.useState(null),y=ro(E.isValidElement(a)?Dp(a):null,r);if(ka(()=>{n||m(HL(o)||document.body)},[o,n]),ka(()=>{if(f&&!n)return Gw(r,f),()=>{Gw(r,null)}},[r,f,n]),n){if(E.isValidElement(a)){const C={ref:y};return E.cloneElement(a,C)}return a}return f&&sp.createPortal(a,f)});function WL(t){return Cn("MuiPopper",t)}bn("MuiPopper",["root"]);function VL(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function eT(t){return typeof t=="function"?t():t}function GL(t){return t.nodeType!==void 0}const KL=t=>{const{classes:e}=t;return pn({root:["root"]},WL,e)},YL={},qL=E.forwardRef(function(e,r){const{anchorEl:a,children:o,direction:n,disablePortal:f,modifiers:m,open:y,placement:C,popperOptions:w,popperRef:A,slotProps:R={},slots:I={},TransitionProps:M,ownerState:F,...O}=e,j=E.useRef(null),U=ro(j,r),H=E.useRef(null),K=ro(H,A),W=E.useRef(K);ka(()=>{W.current=K},[K]),E.useImperativeHandle(A,()=>H.current,[]);const X=VL(C,n),[ee,ie]=E.useState(X),[de,le]=E.useState(eT(a));E.useEffect(()=>{H.current&&H.current.forceUpdate()}),E.useEffect(()=>{a&&le(eT(a))},[a]),ka(()=>{if(!de||!y)return;const Se=ze=>{ie(ze.placement)};let se=[{name:"preventOverflow",options:{altBoundary:f}},{name:"flip",options:{altBoundary:f}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:ze})=>{Se(ze)}}];m!=null&&(se=se.concat(m)),w&&w.modifiers!=null&&(se=se.concat(w.modifiers));const ye=$L(de,j.current,{placement:X,...w,modifiers:se});return W.current(ye),()=>{ye.destroy(),W.current(null)}},[de,f,m,y,w,X]);const oe={placement:ee};M!==null&&(oe.TransitionProps=M);const N=KL(e),ce=I.root??"div",ne=no({elementType:ce,externalSlotProps:R.root,externalForwardedProps:O,additionalProps:{role:"tooltip",ref:U},ownerState:e,className:N.root});return d.jsx(ce,{...ne,children:typeof o=="function"?o(oe):o})}),QL=E.forwardRef(function(e,r){const{anchorEl:a,children:o,container:n,direction:f="ltr",disablePortal:m=!1,keepMounted:y=!1,modifiers:C,open:w,placement:A="bottom",popperOptions:R=YL,popperRef:I,style:M,transition:F=!1,slotProps:O={},slots:j={},...U}=e,[H,K]=E.useState(!0),W=()=>{K(!1)},X=()=>{K(!0)};if(!y&&!w&&(!F||H))return null;let ee;if(n)ee=n;else if(a){const le=eT(a);ee=le&&GL(le)?$a(le).body:$a(null).body}const ie=!w&&y&&(!F||H)?"none":void 0,de=F?{in:w,onEnter:W,onExited:X}:void 0;return d.jsx(lI,{disablePortal:m,container:ee,children:d.jsx(qL,{anchorEl:a,direction:f,disablePortal:m,modifiers:C,ref:r,open:F?!H:w,placement:A,popperOptions:R,popperRef:I,slotProps:O,slots:j,...U,style:{position:"fixed",top:0,left:0,display:ie,...M},TransitionProps:de,children:o})})}),XL=nt(QL,{name:"MuiPopper",slot:"Root"})({}),wb=E.forwardRef(function(e,r){const a=Pi(),o=Wn({props:e,name:"MuiPopper"}),{anchorEl:n,component:f,components:m,componentsProps:y,container:C,disablePortal:w,keepMounted:A,modifiers:R,open:I,placement:M,popperOptions:F,popperRef:O,transition:j,slots:U,slotProps:H,...K}=o,W=U?.root??m?.Root,X={anchorEl:n,container:C,disablePortal:w,keepMounted:A,modifiers:R,open:I,placement:M,popperOptions:F,popperRef:O,transition:j,...K};return d.jsx(XL,{as:f,direction:a?"rtl":"ltr",slots:{root:W},slotProps:H??y,...X,ref:r})});function JL(t){return Cn("MuiListSubheader",t)}bn("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const ZL=t=>{const{classes:e,color:r,disableGutters:a,inset:o,disableSticky:n}=t,f={root:["root",r!=="default"&&`color${At(r)}`,!a&&"gutters",o&&"inset",!n&&"sticky"]};return pn(f,JL,e)},e9=nt("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color!=="default"&&e[`color${At(r.color)}`],!r.disableGutters&&e.gutters,r.inset&&e.inset,!r.disableSticky&&e.sticky]}})(jn(({theme:t})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(t.vars||t).palette.text.secondary,fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(t.vars||t).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:72}},{props:({ownerState:e})=>!e.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(t.vars||t).palette.background.paper}}]}))),tT=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiListSubheader"}),{className:o,color:n="default",component:f="li",disableGutters:m=!1,disableSticky:y=!1,inset:C=!1,...w}=a,A={...a,color:n,component:f,disableGutters:m,disableSticky:y,inset:C},R=ZL(A);return d.jsx(e9,{as:f,className:Ht(R.root,o),ref:r,ownerState:A,...w})});tT&&(tT.muiSkipListHighlight=!0);const t9=dr(d.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function n9(t){return Cn("MuiChip",t)}const Xr=bn("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),r9=t=>{const{classes:e,disabled:r,size:a,color:o,iconColor:n,onDelete:f,clickable:m,variant:y}=t,C={root:["root",y,r&&"disabled",`size${At(a)}`,`color${At(o)}`,m&&"clickable",m&&`clickableColor${At(o)}`,f&&"deletable",f&&`deletableColor${At(o)}`,`${y}${At(o)}`],label:["label",`label${At(a)}`],avatar:["avatar",`avatar${At(a)}`,`avatarColor${At(o)}`],icon:["icon",`icon${At(a)}`,`iconColor${At(n)}`],deleteIcon:["deleteIcon",`deleteIcon${At(a)}`,`deleteIconColor${At(o)}`,`deleteIcon${At(y)}Color${At(o)}`]};return pn(C,n9,e)},o9=nt("div",{name:"MuiChip",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t,{color:a,iconColor:o,clickable:n,onDelete:f,size:m,variant:y}=r;return[{[`& .${Xr.avatar}`]:e.avatar},{[`& .${Xr.avatar}`]:e[`avatar${At(m)}`]},{[`& .${Xr.avatar}`]:e[`avatarColor${At(a)}`]},{[`& .${Xr.icon}`]:e.icon},{[`& .${Xr.icon}`]:e[`icon${At(m)}`]},{[`& .${Xr.icon}`]:e[`iconColor${At(o)}`]},{[`& .${Xr.deleteIcon}`]:e.deleteIcon},{[`& .${Xr.deleteIcon}`]:e[`deleteIcon${At(m)}`]},{[`& .${Xr.deleteIcon}`]:e[`deleteIconColor${At(a)}`]},{[`& .${Xr.deleteIcon}`]:e[`deleteIcon${At(y)}Color${At(a)}`]},e.root,e[`size${At(m)}`],e[`color${At(a)}`],n&&e.clickable,n&&a!=="default"&&e[`clickableColor${At(a)}`],f&&e.deletable,f&&a!=="default"&&e[`deletableColor${At(a)}`],e[y],e[`${y}${At(a)}`]]}})(jn(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[700]:t.palette.grey[300];return{maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,lineHeight:1.5,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${Xr.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${Xr.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:e,fontSize:t.typography.pxToRem(12)},[`& .${Xr.avatarColorPrimary}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},[`& .${Xr.avatarColorSecondary}`]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},[`& .${Xr.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},[`& .${Xr.icon}`]:{marginLeft:5,marginRight:-6},[`& .${Xr.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:t.alpha((t.vars||t).palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.alpha((t.vars||t).palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${Xr.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${Xr.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(t.palette).filter(Go(["contrastText"])).map(([r])=>({props:{color:r},style:{backgroundColor:(t.vars||t).palette[r].main,color:(t.vars||t).palette[r].contrastText,[`& .${Xr.deleteIcon}`]:{color:t.alpha((t.vars||t).palette[r].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[r].contrastText}}}})),{props:r=>r.iconColor===r.color,style:{[`& .${Xr.icon}`]:{color:t.vars?t.vars.palette.Chip.defaultIconColor:e}}},{props:r=>r.iconColor===r.color&&r.color!=="default",style:{[`& .${Xr.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${Xr.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.action.selected,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}}},...Object.entries(t.palette).filter(Go(["dark"])).map(([r])=>({props:{color:r,onDelete:!0},style:{[`&.${Xr.focusVisible}`]:{background:(t.vars||t).palette[r].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.selected,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`)},[`&.${Xr.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.action.selected,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)},"&:active":{boxShadow:(t.vars||t).shadows[1]}}},...Object.entries(t.palette).filter(Go(["dark"])).map(([r])=>({props:{color:r,clickable:!0},style:{[`&:hover, &.${Xr.focusVisible}`]:{backgroundColor:(t.vars||t).palette[r].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:t.vars?`1px solid ${t.vars.palette.Chip.defaultBorder}`:`1px solid ${t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[700]}`,[`&.${Xr.clickable}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${Xr.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`& .${Xr.avatar}`]:{marginLeft:4},[`& .${Xr.avatarSmall}`]:{marginLeft:2},[`& .${Xr.icon}`]:{marginLeft:4},[`& .${Xr.iconSmall}`]:{marginLeft:2},[`& .${Xr.deleteIcon}`]:{marginRight:5},[`& .${Xr.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(t.palette).filter(Go()).map(([r])=>({props:{variant:"outlined",color:r},style:{color:(t.vars||t).palette[r].main,border:`1px solid ${t.alpha((t.vars||t).palette[r].main,.7)}`,[`&.${Xr.clickable}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette[r].main,(t.vars||t).palette.action.hoverOpacity)},[`&.${Xr.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette[r].main,(t.vars||t).palette.action.focusOpacity)},[`& .${Xr.deleteIcon}`]:{color:t.alpha((t.vars||t).palette[r].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[r].main}}}}))]}})),a9=nt("span",{name:"MuiChip",slot:"Label",overridesResolver:(t,e)=>{const{ownerState:r}=t,{size:a}=r;return[e.label,e[`label${At(a)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function Q4(t){return t.key==="Backspace"||t.key==="Delete"}const Sa=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiChip"}),{avatar:o,className:n,clickable:f,color:m="default",component:y,deleteIcon:C,disabled:w=!1,icon:A,label:R,onClick:I,onDelete:M,onKeyDown:F,onKeyUp:O,size:j="medium",variant:U="filled",tabIndex:H,skipFocusWhenDisabled:K=!1,slots:W={},slotProps:X={},...ee}=a,ie=E.useRef(null),de=ro(ie,r),le=be=>{be.stopPropagation(),M&&M(be)},oe=be=>{be.currentTarget===be.target&&Q4(be)&&be.preventDefault(),F&&F(be)},N=be=>{be.currentTarget===be.target&&M&&Q4(be)&&M(be),O&&O(be)},ce=f!==!1&&I?!0:f,ne=ce||M?Ru:y||"div",Se={...a,component:ne,disabled:w,size:j,color:m,iconColor:E.isValidElement(A)&&A.props.color||m,onDelete:!!M,clickable:ce,variant:U},se=r9(Se),ye=ne===Ru?{component:y||"div",focusVisibleClassName:se.focusVisible,...M&&{disableRipple:!0}}:{};let ze=null;M&&(ze=C&&E.isValidElement(C)?E.cloneElement(C,{className:Ht(C.props.className,se.deleteIcon),onClick:le}):d.jsx(t9,{className:se.deleteIcon,onClick:le}));let Re=null;o&&E.isValidElement(o)&&(Re=E.cloneElement(o,{className:Ht(se.avatar,o.props.className)}));let ve=null;A&&E.isValidElement(A)&&(ve=E.cloneElement(A,{className:Ht(se.icon,A.props.className)}));const V={slots:W,slotProps:X},[ue,Ee]=rr("root",{elementType:o9,externalForwardedProps:{...V,...ee},ownerState:Se,shouldForwardComponentProp:!0,ref:de,className:Ht(se.root,n),additionalProps:{disabled:ce&&w?!0:void 0,tabIndex:K&&w?-1:H,...ye},getSlotProps:be=>({...be,onClick:Te=>{be.onClick?.(Te),I?.(Te)},onKeyDown:Te=>{be.onKeyDown?.(Te),oe(Te)},onKeyUp:Te=>{be.onKeyUp?.(Te),N(Te)}})}),[Ie,ae]=rr("label",{elementType:a9,externalForwardedProps:V,ownerState:Se,className:se.label});return d.jsxs(ue,{as:ne,...Ee,children:[Re||ve,d.jsx(Ie,{...ae,children:R}),ze]})});function xx(t){return parseInt(t,10)||0}const s9={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function i9(t){for(const e in t)return!1;return!0}function X4(t){return i9(t)||t.outerHeightStyle===0&&!t.overflowing}const l9=E.forwardRef(function(e,r){const{onChange:a,maxRows:o,minRows:n=1,style:f,value:m,...y}=e,{current:C}=E.useRef(m!=null),w=E.useRef(null),A=ro(r,w),R=E.useRef(null),I=E.useRef(null),M=E.useCallback(()=>{const H=w.current,K=I.current;if(!H||!K)return;const X=Fc(H).getComputedStyle(H);if(X.width==="0px")return{outerHeightStyle:0,overflowing:!1};K.style.width=X.width,K.value=H.value||e.placeholder||"x",K.value.slice(-1)===`
`&&(K.value+=" ");const ee=X.boxSizing,ie=xx(X.paddingBottom)+xx(X.paddingTop),de=xx(X.borderBottomWidth)+xx(X.borderTopWidth),le=K.scrollHeight;K.value="x";const oe=K.scrollHeight;let N=le;n&&(N=Math.max(Number(n)*oe,N)),o&&(N=Math.min(Number(o)*oe,N)),N=Math.max(N,oe);const ce=N+(ee==="border-box"?ie+de:0),ne=Math.abs(N-le)<=1;return{outerHeightStyle:ce,overflowing:ne}},[o,n,e.placeholder]),F=yn(()=>{const H=w.current,K=M();if(!H||!K||X4(K))return!1;const W=K.outerHeightStyle;return R.current!=null&&R.current!==W}),O=E.useCallback(()=>{const H=w.current,K=M();if(!H||!K||X4(K))return;const W=K.outerHeightStyle;R.current!==W&&(R.current=W,H.style.height=`${W}px`),H.style.overflow=K.overflowing?"hidden":""},[M]),j=E.useRef(-1);ka(()=>{const H=wC(O),K=w?.current;if(!K)return;const W=Fc(K);W.addEventListener("resize",H);let X;return typeof ResizeObserver<"u"&&(X=new ResizeObserver(()=>{F()&&(X.unobserve(K),cancelAnimationFrame(j.current),O(),j.current=requestAnimationFrame(()=>{X.observe(K)}))}),X.observe(K)),()=>{H.clear(),cancelAnimationFrame(j.current),W.removeEventListener("resize",H),X&&X.disconnect()}},[M,O,F]),ka(()=>{O()});const U=H=>{C||O();const K=H.target,W=K.value.length,X=K.value.endsWith(`
`),ee=K.selectionStart===W;X&&ee&&K.setSelectionRange(W,W),a&&a(H)};return d.jsxs(E.Fragment,{children:[d.jsx("textarea",{value:m,onChange:U,ref:A,rows:n,style:f,...y}),d.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:I,tabIndex:-1,style:{...s9.shadow,...f,paddingTop:0,paddingBottom:0}})]})});function Hf({props:t,states:e,muiFormControl:r}){return e.reduce((a,o)=>(a[o]=t[o],r&&typeof t[o]>"u"&&(a[o]=r[o]),a),{})}const EC=E.createContext(void 0);function Al(){return E.useContext(EC)}function J4(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function S2(t,e=!1){return t&&(J4(t.value)&&t.value!==""||e&&J4(t.defaultValue)&&t.defaultValue!=="")}function c9(t){return t.startAdornment}function u9(t){return Cn("MuiInputBase",t)}const yl=bn("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var Z4;const kC=(t,e)=>{const{ownerState:r}=t;return[e.root,r.formControl&&e.formControl,r.startAdornment&&e.adornedStart,r.endAdornment&&e.adornedEnd,r.error&&e.error,r.size==="small"&&e.sizeSmall,r.multiline&&e.multiline,r.color&&e[`color${At(r.color)}`],r.fullWidth&&e.fullWidth,r.hiddenLabel&&e.hiddenLabel]},DC=(t,e)=>{const{ownerState:r}=t;return[e.input,r.size==="small"&&e.inputSizeSmall,r.multiline&&e.inputMultiline,r.type==="search"&&e.inputTypeSearch,r.startAdornment&&e.inputAdornedStart,r.endAdornment&&e.inputAdornedEnd,r.hiddenLabel&&e.inputHiddenLabel]},d9=t=>{const{classes:e,color:r,disabled:a,error:o,endAdornment:n,focused:f,formControl:m,fullWidth:y,hiddenLabel:C,multiline:w,readOnly:A,size:R,startAdornment:I,type:M}=t,F={root:["root",`color${At(r)}`,a&&"disabled",o&&"error",y&&"fullWidth",f&&"focused",m&&"formControl",R&&R!=="medium"&&`size${At(R)}`,w&&"multiline",I&&"adornedStart",n&&"adornedEnd",C&&"hiddenLabel",A&&"readOnly"],input:["input",a&&"disabled",M==="search"&&"inputTypeSearch",w&&"inputMultiline",R==="small"&&"inputSizeSmall",C&&"inputHiddenLabel",I&&"inputAdornedStart",n&&"inputAdornedEnd",A&&"readOnly"]};return pn(F,u9,e)},RC=nt("div",{name:"MuiInputBase",slot:"Root",overridesResolver:kC})(jn(({theme:t})=>({...t.typography.body1,color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${yl.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:r})=>e.multiline&&r==="small",style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),IC=nt("input",{name:"MuiInputBase",slot:"Input",overridesResolver:DC})(jn(({theme:t})=>{const e=t.palette.mode==="light",r={color:"currentColor",...t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5},transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},a={opacity:"0 !important"},o=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${yl.formControl} &`]:{"&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&::-ms-input-placeholder":a,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${yl.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:({ownerState:n})=>!n.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:n})=>n.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),eD=uA({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),CA=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:n,autoFocus:f,className:m,color:y,components:C={},componentsProps:w={},defaultValue:A,disabled:R,disableInjectingGlobalStyles:I,endAdornment:M,error:F,fullWidth:O=!1,id:j,inputComponent:U="input",inputProps:H={},inputRef:K,margin:W,maxRows:X,minRows:ee,multiline:ie=!1,name:de,onBlur:le,onChange:oe,onClick:N,onFocus:ce,onKeyDown:ne,onKeyUp:Se,placeholder:se,readOnly:ye,renderSuffix:ze,rows:Re,size:ve,slotProps:V={},slots:ue={},startAdornment:Ee,type:Ie="text",value:ae,...be}=a,Te=H.value!=null?H.value:ae,{current:tt}=E.useRef(Te!=null),je=E.useRef(),Pe=E.useCallback(pt=>{},[]),Be=ro(je,K,H.ref,Pe),[Fe,Ge]=E.useState(!1),Oe=Al(),mt=Hf({props:a,muiFormControl:Oe,states:["color","disabled","error","hiddenLabel","size","required","filled"]});mt.focused=Oe?Oe.focused:Fe,E.useEffect(()=>{!Oe&&R&&Fe&&(Ge(!1),le&&le())},[Oe,R,Fe,le]);const qe=Oe&&Oe.onFilled,Ae=Oe&&Oe.onEmpty,te=E.useCallback(pt=>{S2(pt)?qe&&qe():Ae&&Ae()},[qe,Ae]);ka(()=>{tt&&te({value:Te})},[Te,te,tt]);const pe=pt=>{ce&&ce(pt),H.onFocus&&H.onFocus(pt),Oe&&Oe.onFocus?Oe.onFocus(pt):Ge(!0)},J=pt=>{le&&le(pt),H.onBlur&&H.onBlur(pt),Oe&&Oe.onBlur?Oe.onBlur(pt):Ge(!1)},fe=(pt,...Yt)=>{if(!tt){const Kt=pt.target||je.current;if(Kt==null)throw new Error(xd(1));te({value:Kt.value})}H.onChange&&H.onChange(pt,...Yt),oe&&oe(pt,...Yt)};E.useEffect(()=>{te(je.current)},[]);const xe=pt=>{je.current&&pt.currentTarget===pt.target&&je.current.focus(),N&&N(pt)};let Ne=U,Me=H;ie&&Ne==="input"&&(Re?Me={type:void 0,minRows:Re,maxRows:Re,...Me}:Me={type:void 0,maxRows:X,minRows:ee,...Me},Ne=l9);const Ve=pt=>{te(pt.animationName==="mui-auto-fill-cancel"?je.current:{value:"x"})};E.useEffect(()=>{Oe&&Oe.setAdornedStart(!!Ee)},[Oe,Ee]);const Qe={...a,color:mt.color||"primary",disabled:mt.disabled,endAdornment:M,error:mt.error,focused:mt.focused,formControl:Oe,fullWidth:O,hiddenLabel:mt.hiddenLabel,multiline:ie,size:mt.size,startAdornment:Ee,type:Ie},rt=d9(Qe),st=ue.root||C.Root||RC,it=V.root||w.root||{},xt=ue.input||C.Input||IC;return Me={...Me,...V.input??w.input},d.jsxs(E.Fragment,{children:[!I&&typeof eD=="function"&&(Z4||(Z4=d.jsx(eD,{}))),d.jsxs(st,{...it,ref:r,onClick:xe,...be,...!Ym(st)&&{ownerState:{...Qe,...it.ownerState}},className:Ht(rt.root,it.className,m,ye&&"MuiInputBase-readOnly"),children:[Ee,d.jsx(EC.Provider,{value:null,children:d.jsx(xt,{"aria-invalid":mt.error,"aria-describedby":o,autoComplete:n,autoFocus:f,defaultValue:A,disabled:mt.disabled,id:j,onAnimationStart:Ve,name:de,placeholder:se,readOnly:ye,required:mt.required,rows:Re,value:Te,onKeyDown:ne,onKeyUp:Se,type:Ie,...Me,...!Ym(xt)&&{as:Ne,ownerState:{...Qe,...Me.ownerState}},ref:Be,className:Ht(rt.input,Me.className,ye&&"MuiInputBase-readOnly"),onBlur:J,onChange:fe,onFocus:pe})}),M,ze?ze({...mt,startAdornment:Ee}):null]})]})});function f9(t){return Cn("MuiInput",t)}const kf={...yl,...bn("MuiInput",["root","underline","input"])};function h9(t){return Cn("MuiOutlinedInput",t)}const $l={...yl,...bn("MuiOutlinedInput",["root","notchedOutline","input"])};function p9(t){return Cn("MuiFilledInput",t)}const bl={...yl,...bn("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},cI=dr(d.jsx("path",{d:"M7 10l5 5 5-5z"}));function m9(t){return Cn("MuiAutocomplete",t)}const Ur=bn("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var tD,nD;const g9=t=>{const{classes:e,disablePortal:r,expanded:a,focused:o,fullWidth:n,hasClearIcon:f,hasPopupIcon:m,inputFocused:y,popupOpen:C,size:w}=t,A={root:["root",a&&"expanded",o&&"focused",n&&"fullWidth",f&&"hasClearIcon",m&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",y&&"inputFocused"],tag:["tag",`tagSize${At(w)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",C&&"popupIndicatorOpen"],popper:["popper",r&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]};return pn(A,m9,e)},y9=nt("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t,{fullWidth:a,hasClearIcon:o,hasPopupIcon:n,inputFocused:f,size:m}=r;return[{[`& .${Ur.tag}`]:e.tag},{[`& .${Ur.tag}`]:e[`tagSize${At(m)}`]},{[`& .${Ur.inputRoot}`]:e.inputRoot},{[`& .${Ur.input}`]:e.input},{[`& .${Ur.input}`]:f&&e.inputFocused},e.root,a&&e.fullWidth,n&&e.hasPopupIcon,o&&e.hasClearIcon]}})({[`&.${Ur.focused} .${Ur.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${Ur.clearIndicator}`]:{visibility:"visible"}},[`& .${Ur.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${Ur.inputRoot}`]:{[`.${Ur.hasPopupIcon}&, .${Ur.hasClearIcon}&`]:{paddingRight:30},[`.${Ur.hasPopupIcon}.${Ur.hasClearIcon}&`]:{paddingRight:56},[`& .${Ur.input}`]:{width:0,minWidth:30}},[`& .${kf.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${kf.root}.${yl.sizeSmall}`]:{[`& .${kf.input}`]:{padding:"2px 4px 3px 0"}},[`& .${$l.root}`]:{padding:9,[`.${Ur.hasPopupIcon}&, .${Ur.hasClearIcon}&`]:{paddingRight:39},[`.${Ur.hasPopupIcon}.${Ur.hasClearIcon}&`]:{paddingRight:65},[`& .${Ur.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${Ur.endAdornment}`]:{right:9}},[`& .${$l.root}.${yl.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${Ur.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${bl.root}`]:{paddingTop:19,paddingLeft:8,[`.${Ur.hasPopupIcon}&, .${Ur.hasClearIcon}&`]:{paddingRight:39},[`.${Ur.hasPopupIcon}.${Ur.hasClearIcon}&`]:{paddingRight:65},[`& .${bl.input}`]:{padding:"7px 4px"},[`& .${Ur.endAdornment}`]:{right:9}},[`& .${bl.root}.${yl.sizeSmall}`]:{paddingBottom:1,[`& .${bl.input}`]:{padding:"2.5px 4px"}},[`& .${yl.hiddenLabel}`]:{paddingTop:8},[`& .${bl.root}.${yl.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${Ur.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${bl.root}.${yl.hiddenLabel}.${yl.sizeSmall}`]:{[`& .${Ur.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${Ur.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${Ur.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${Ur.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${Ur.inputRoot}`]:{flexWrap:"wrap"}}}]}),b9=nt("div",{name:"MuiAutocomplete",slot:"EndAdornment"})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),v9=nt(_r,{name:"MuiAutocomplete",slot:"ClearIndicator"})({marginRight:-2,padding:4,visibility:"hidden"}),x9=nt(_r,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popupIndicator,r.popupOpen&&e.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),C9=nt(wb,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${Ur.option}`]:e.option},e.popper,r.disablePortal&&e.popperDisablePortal]}})(jn(({theme:t})=>({zIndex:(t.vars||t).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}))),S9=nt(ua,{name:"MuiAutocomplete",slot:"Paper"})(jn(({theme:t})=>({...t.typography.body1,overflow:"auto"}))),w9=nt("div",{name:"MuiAutocomplete",slot:"Loading"})(jn(({theme:t})=>({color:(t.vars||t).palette.text.secondary,padding:"14px 16px"}))),T9=nt("div",{name:"MuiAutocomplete",slot:"NoOptions"})(jn(({theme:t})=>({color:(t.vars||t).palette.text.secondary,padding:"14px 16px"}))),A9=nt("ul",{name:"MuiAutocomplete",slot:"Listbox"})(jn(({theme:t})=>({listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${Ur.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[t.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${Ur.focused}`]:{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${Ur.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${Ur.focused}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${Ur.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}}}}))),E9=nt(tT,{name:"MuiAutocomplete",slot:"GroupLabel"})(jn(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,top:-8}))),k9=nt("ul",{name:"MuiAutocomplete",slot:"GroupUl"})({padding:0,[`& .${Ur.option}`]:{paddingLeft:24}}),w2=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiAutocomplete"}),{autoComplete:o=!1,autoHighlight:n=!1,autoSelect:f=!1,blurOnSelect:m=!1,ChipProps:y,className:C,clearIcon:w=tD||(tD=d.jsx(J3,{fontSize:"small"})),clearOnBlur:A=!a.freeSolo,clearOnEscape:R=!1,clearText:I="Clear",closeText:M="Close",componentsProps:F,defaultValue:O=a.multiple?[]:null,disableClearable:j=!1,disableCloseOnSelect:U=!1,disabled:H=!1,disabledItemsFocusable:K=!1,disableListWrap:W=!1,disablePortal:X=!1,filterOptions:ee,filterSelectedOptions:ie=!1,forcePopupIcon:de="auto",freeSolo:le=!1,fullWidth:oe=!1,getLimitTagsText:N=Fr=>`+${Fr}`,getOptionDisabled:ce,getOptionKey:ne,getOptionLabel:Se,isOptionEqualToValue:se,groupBy:ye,handleHomeEndKeys:ze=!a.freeSolo,id:Re,includeInputInList:ve=!1,inputValue:V,limitTags:ue=-1,ListboxComponent:Ee,ListboxProps:Ie,loading:ae=!1,loadingText:be="Loading",multiple:Te=!1,noOptionsText:tt="No options",onChange:je,onClose:Pe,onHighlightChange:Be,onInputChange:Fe,onOpen:Ge,open:Oe,openOnFocus:mt=!1,openText:qe="Open",options:Ae,PaperComponent:te,PopperComponent:pe,popupIcon:J=nD||(nD=d.jsx(cI,{})),readOnly:fe=!1,renderGroup:xe,renderInput:Ne,renderOption:Me,renderTags:Ve,renderValue:Qe,selectOnFocus:rt=!a.freeSolo,size:st="medium",slots:it={},slotProps:xt={},value:pt,...Yt}=a,{getRootProps:Kt,getInputProps:tn,getInputLabelProps:Wt,getPopupIndicatorProps:_t,getClearProps:at,getItemProps:Et,getListboxProps:qt,getOptionProps:gn,value:Sn,dirty:Zt,expanded:Kn,id:$t,popupOpen:Cr,focused:tr,focusedItem:Bt,anchorEl:gr,setAnchorEl:en,inputValue:un,groupedOptions:Yn}=N7({...a,componentName:"Autocomplete"}),En=!j&&!H&&Zt&&!fe,fr=(!le||de===!0)&&de!==!1,{onMouseDown:fo}=tn(),{ref:xo,...Qn}=qt(),Ko=Se||(Fr=>Fr.label??Fr),Rr={...a,disablePortal:X,expanded:Kn,focused:tr,fullWidth:oe,getOptionLabel:Ko,hasClearIcon:En,hasPopupIcon:fr,inputFocused:Bt===-1,popupOpen:Cr,size:st},Jn=g9(Rr),aa={slots:{paper:te,popper:pe,...it},slotProps:{chip:y,listbox:Ie,...F,...xt}},[qr,ho]=rr("listbox",{elementType:A9,externalForwardedProps:aa,ownerState:Rr,className:Jn.listbox,additionalProps:Qn,ref:xo}),[ts,Pt]=rr("paper",{elementType:ua,externalForwardedProps:aa,ownerState:Rr,className:Jn.paper}),[Tt,Dn]=rr("popper",{elementType:wb,externalForwardedProps:aa,ownerState:Rr,className:Jn.popper,additionalProps:{disablePortal:X,style:{width:gr?gr.clientWidth:null},role:"presentation",anchorEl:gr,open:Cr}});let nr;const or=Fr=>({className:Jn.tag,disabled:H,...Et(Fr)});if(Te?Sn.length>0&&(Ve?nr=Ve(Sn,or,Rr):Qe?nr=Qe(Sn,or,Rr):nr=Sn.map((Fr,Vs)=>{const{key:ke,...Ke}=or({index:Vs});return d.jsx(Sa,{label:Ko(Fr),size:st,...Ke,...aa.slotProps.chip},ke)})):Qe&&Sn!=null&&(nr=Qe(Sn,or,Rr)),ue>-1&&Array.isArray(nr)){const Fr=nr.length-ue;!tr&&Fr>0&&(nr=nr.splice(0,ue),nr.push(d.jsx("span",{className:Jn.tag,children:N(Fr)},nr.length)))}const kr=xe||(Fr=>d.jsxs("li",{children:[d.jsx(E9,{className:Jn.groupLabel,ownerState:Rr,component:"div",children:Fr.group}),d.jsx(k9,{className:Jn.groupUl,ownerState:Rr,children:Fr.children})]},Fr.key)),Eo=Me||((Fr,Vs)=>{const{key:ke,...Ke}=Fr;return d.jsx("li",{...Ke,children:Ko(Vs)},ke)}),da=(Fr,Vs)=>{const ke=gn({option:Fr,index:Vs});return Eo({...ke,className:Jn.option},Fr,{selected:ke["aria-selected"],index:Vs,inputValue:un},Rr)},bs=aa.slotProps.clearIndicator,ar=aa.slotProps.popupIndicator;return d.jsxs(E.Fragment,{children:[d.jsx(y9,{ref:r,className:Ht(Jn.root,C),ownerState:Rr,...Kt(Yt),children:Ne({id:$t,disabled:H,fullWidth:!0,size:st==="small"?"small":void 0,InputLabelProps:Wt(),InputProps:{ref:en,className:Jn.inputRoot,startAdornment:nr,onMouseDown:Fr=>{Fr.target===Fr.currentTarget&&fo(Fr)},...(En||fr)&&{endAdornment:d.jsxs(b9,{className:Jn.endAdornment,ownerState:Rr,children:[En?d.jsx(v9,{...at(),"aria-label":I,title:I,ownerState:Rr,...bs,className:Ht(Jn.clearIndicator,bs?.className),children:w}):null,fr?d.jsx(x9,{..._t(),disabled:H,"aria-label":Cr?M:qe,title:Cr?M:qe,ownerState:Rr,...ar,className:Ht(Jn.popupIndicator,ar?.className),children:J}):null]})}},inputProps:{className:Jn.input,disabled:H,readOnly:fe,...tn()}})}),gr?d.jsx(C9,{as:Tt,...Dn,children:d.jsxs(S9,{as:ts,...Pt,children:[ae&&Yn.length===0?d.jsx(w9,{className:Jn.loading,ownerState:Rr,children:be}):null,Yn.length===0&&!le&&!ae?d.jsx(T9,{className:Jn.noOptions,ownerState:Rr,role:"presentation",onMouseDown:Fr=>{Fr.preventDefault()},children:tt}):null,Yn.length>0?d.jsx(qr,{as:Ee,...ho,children:Yn.map((Fr,Vs)=>ye?kr({key:Fr.key,group:Fr.group,children:Fr.options.map((ke,Ke)=>da(ke,Fr.index+Ke))}):da(Fr,Vs))}):null]})}):null]})}),D9={entering:{opacity:1},entered:{opacity:1}},gp=E.forwardRef(function(e,r){const a=kd(),o={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{addEndListener:n,appear:f=!0,children:m,easing:y,in:C,onEnter:w,onEntered:A,onEntering:R,onExit:I,onExited:M,onExiting:F,style:O,timeout:j=o,TransitionComponent:U=Bc,...H}=e,K=E.useRef(null),W=ro(K,Dp(m),r),X=ne=>Se=>{if(ne){const se=K.current;Se===void 0?ne(se):ne(se,Se)}},ee=X(R),ie=X((ne,Se)=>{Y3(ne);const se=y2({style:O,timeout:j,easing:y},{mode:"enter"});ne.style.webkitTransition=a.transitions.create("opacity",se),ne.style.transition=a.transitions.create("opacity",se),w&&w(ne,Se)}),de=X(A),le=X(F),oe=X(ne=>{const Se=y2({style:O,timeout:j,easing:y},{mode:"exit"});ne.style.webkitTransition=a.transitions.create("opacity",Se),ne.style.transition=a.transitions.create("opacity",Se),I&&I(ne)}),N=X(M),ce=ne=>{n&&n(K.current,ne)};return d.jsx(U,{appear:f,in:C,nodeRef:K,onEnter:ie,onEntered:de,onEntering:ee,onExit:oe,onExited:N,onExiting:le,addEndListener:ce,timeout:j,...H,children:(ne,{ownerState:Se,...se})=>E.cloneElement(m,{style:{opacity:0,visibility:ne==="exited"&&!C?"hidden":void 0,...D9[ne],...O,...m.props.style},ref:W,...se})})});function R9(t){return Cn("MuiBackdrop",t)}bn("MuiBackdrop",["root","invisible"]);const I9=t=>{const{classes:e,invisible:r}=t;return pn({root:["root",r&&"invisible"]},R9,e)},P9=nt("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),uI=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiBackdrop"}),{children:o,className:n,component:f="div",invisible:m=!1,open:y,components:C={},componentsProps:w={},slotProps:A={},slots:R={},TransitionComponent:I,transitionDuration:M,...F}=a,O={...a,component:f,invisible:m},j=I9(O),U={transition:I,root:C.Root,...R},H={...w,...A},K={component:f,slots:U,slotProps:H},[W,X]=rr("root",{elementType:P9,externalForwardedProps:K,className:Ht(j.root,n),ownerState:O}),[ee,ie]=rr("transition",{elementType:gp,externalForwardedProps:K,ownerState:O});return d.jsx(ee,{in:y,timeout:M,...F,...ie,children:d.jsx(W,{"aria-hidden":!0,...X,classes:j,ref:r,children:o})})}),M9=bn("MuiBox",["root"]),_9=CC(),_e=HN({themeId:ql,defaultTheme:_9,defaultClassName:M9.root,generateClassName:S3.generate});function O9(t){return Cn("MuiButton",t)}const Yh=bn("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),F9=E.createContext({}),N9=E.createContext(void 0),j9=t=>{const{color:e,disableElevation:r,fullWidth:a,size:o,variant:n,loading:f,loadingPosition:m,classes:y}=t,C={root:["root",f&&"loading",n,`${n}${At(e)}`,`size${At(o)}`,`${n}Size${At(o)}`,`color${At(e)}`,r&&"disableElevation",a&&"fullWidth",f&&`loadingPosition${At(m)}`],startIcon:["icon","startIcon",`iconSize${At(o)}`],endIcon:["icon","endIcon",`iconSize${At(o)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},w=pn(C,O9,y);return{...y,...w}},dI=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],L9=nt(Ru,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`${r.variant}${At(r.color)}`],e[`size${At(r.size)}`],e[`${r.variant}Size${At(r.size)}`],r.color==="inherit"&&e.colorInherit,r.disableElevation&&e.disableElevation,r.fullWidth&&e.fullWidth,r.loading&&e.loading]}})(jn(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],r=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Yh.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${Yh.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${Yh.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Yh.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(Go()).map(([a])=>({props:{color:a},style:{"--variant-textColor":(t.vars||t).palette[a].main,"--variant-outlinedColor":(t.vars||t).palette[a].main,"--variant-outlinedBorder":t.alpha((t.vars||t).palette[a].main,.5),"--variant-containedColor":(t.vars||t).palette[a].contrastText,"--variant-containedBg":(t.vars||t).palette[a].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[a].dark,"--variant-textBg":t.alpha((t.vars||t).palette[a].main,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[a].main,"--variant-outlinedBg":t.alpha((t.vars||t).palette[a].main,(t.vars||t).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Yh.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Yh.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${Yh.loading}`]:{color:"transparent"}}}]}})),B9=nt("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.startIcon,r.loading&&e.startIconLoadingStart,e[`iconSize${At(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...dI]})),z9=nt("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.endIcon,r.loading&&e.endIconLoadingEnd,e[`iconSize${At(r.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...dI]})),U9=nt("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),rD=nt("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),Un=E.forwardRef(function(e,r){const a=E.useContext(F9),o=E.useContext(N9),n=Km(a,e),f=Wn({props:n,name:"MuiButton"}),{children:m,color:y="primary",component:C="button",className:w,disabled:A=!1,disableElevation:R=!1,disableFocusRipple:I=!1,endIcon:M,focusVisibleClassName:F,fullWidth:O=!1,id:j,loading:U=null,loadingIndicator:H,loadingPosition:K="center",size:W="medium",startIcon:X,type:ee,variant:ie="text",...de}=f,le=nc(j),oe=H??d.jsx(Ri,{"aria-labelledby":le,color:"inherit",size:16}),N={...f,color:y,component:C,disabled:A,disableElevation:R,disableFocusRipple:I,fullWidth:O,loading:U,loadingIndicator:oe,loadingPosition:K,size:W,type:ee,variant:ie},ce=j9(N),ne=(X||U&&K==="start")&&d.jsx(B9,{className:ce.startIcon,ownerState:N,children:X||d.jsx(rD,{className:ce.loadingIconPlaceholder,ownerState:N})}),Se=(M||U&&K==="end")&&d.jsx(z9,{className:ce.endIcon,ownerState:N,children:M||d.jsx(rD,{className:ce.loadingIconPlaceholder,ownerState:N})}),se=o||"",ye=typeof U=="boolean"?d.jsx("span",{className:ce.loadingWrapper,style:{display:"contents"},children:U&&d.jsx(U9,{className:ce.loadingIndicator,ownerState:N,children:oe})}):null;return d.jsxs(L9,{ownerState:N,className:Ht(a.className,ce.root,w,se),component:C,disabled:A||U,focusRipple:!I,focusVisibleClassName:Ht(ce.focusVisible,F),ref:r,type:ee,id:U?le:j,...de,classes:ce,children:[ne,K!=="end"&&ye,m,K==="end"&&ye,Se]})});function $9(t){return E.Children.toArray(t).filter(e=>E.isValidElement(e))}function H9(t){return Cn("MuiCard",t)}bn("MuiCard",["root"]);const W9=t=>{const{classes:e}=t;return pn({root:["root"]},H9,e)},V9=nt(ua,{name:"MuiCard",slot:"Root"})({overflow:"hidden"}),Ta=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiCard"}),{className:o,raised:n=!1,...f}=a,m={...a,raised:n},y=W9(m);return d.jsx(V9,{className:Ht(y.root,o),elevation:n?8:void 0,ref:r,ownerState:m,...f})});function G9(t){return Cn("MuiCardContent",t)}bn("MuiCardContent",["root"]);const K9=t=>{const{classes:e}=t;return pn({root:["root"]},G9,e)},Y9=nt("div",{name:"MuiCardContent",slot:"Root"})({padding:16,"&:last-child":{paddingBottom:24}}),Aa=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiCardContent"}),{className:o,component:n="div",...f}=a,m={...a,component:n},y=K9(m);return d.jsx(Y9,{as:n,className:Ht(y.root,o),ownerState:m,ref:r,...f})});function q9(t){return Cn("PrivateSwitchBase",t)}bn("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Q9=t=>{const{classes:e,checked:r,disabled:a,edge:o}=t,n={root:["root",r&&"checked",a&&"disabled",o&&`edge${At(o)}`],input:["input"]};return pn(n,q9,e)},X9=nt(Ru,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:e})=>t==="start"&&e.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:e})=>t==="end"&&e.size!=="small",style:{marginRight:-12}}]}),J9=nt("input",{name:"MuiSwitchBase",shouldForwardProp:si})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),SA=E.forwardRef(function(e,r){const{autoFocus:a,checked:o,checkedIcon:n,defaultChecked:f,disabled:m,disableFocusRipple:y=!1,edge:C=!1,icon:w,id:A,inputProps:R,inputRef:I,name:M,onBlur:F,onChange:O,onFocus:j,readOnly:U,required:H=!1,tabIndex:K,type:W,value:X,slots:ee={},slotProps:ie={},...de}=e,[le,oe]=Ki({controlled:o,default:!!f,name:"SwitchBase",state:"checked"}),N=Al(),ce=ae=>{j&&j(ae),N&&N.onFocus&&N.onFocus(ae)},ne=ae=>{F&&F(ae),N&&N.onBlur&&N.onBlur(ae)},Se=ae=>{if(ae.nativeEvent.defaultPrevented)return;const be=ae.target.checked;oe(be),O&&O(ae,be)};let se=m;N&&typeof se>"u"&&(se=N.disabled);const ye=W==="checkbox"||W==="radio",ze={...e,checked:le,disabled:se,disableFocusRipple:y,edge:C},Re=Q9(ze),ve={slots:ee,slotProps:{input:R,...ie}},[V,ue]=rr("root",{ref:r,elementType:X9,className:Re.root,shouldForwardComponentProp:!0,externalForwardedProps:{...ve,component:"span",...de},getSlotProps:ae=>({...ae,onFocus:be=>{ae.onFocus?.(be),ce(be)},onBlur:be=>{ae.onBlur?.(be),ne(be)}}),ownerState:ze,additionalProps:{centerRipple:!0,focusRipple:!y,disabled:se,role:void 0,tabIndex:null}}),[Ee,Ie]=rr("input",{ref:I,elementType:J9,className:Re.input,externalForwardedProps:ve,getSlotProps:ae=>({...ae,onChange:be=>{ae.onChange?.(be),Se(be)}}),ownerState:ze,additionalProps:{autoFocus:a,checked:o,defaultChecked:f,disabled:se,id:ye?A:void 0,name:M,readOnly:U,required:H,tabIndex:K,type:W,...W==="checkbox"&&X===void 0?{}:{value:X}}});return d.jsxs(V,{...ue,children:[d.jsx(Ee,{...Ie}),le?n:w]})}),Z9=dr(d.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),eB=dr(d.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),tB=dr(d.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function nB(t){return Cn("MuiCheckbox",t)}const iw=bn("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),rB=t=>{const{classes:e,indeterminate:r,color:a,size:o}=t,n={root:["root",r&&"indeterminate",`color${At(a)}`,`size${At(o)}`]},f=pn(n,nB,e);return{...e,...f}},oB=nt(SA,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.indeterminate&&e.indeterminate,e[`size${At(r.size)}`],r.color!=="default"&&e[`color${At(r.color)}`]]}})(jn(({theme:t})=>({color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{[`&.${iw.checked}, &.${iw.indeterminate}`]:{color:(t.vars||t).palette[e].main},[`&.${iw.disabled}`]:{color:(t.vars||t).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),aB=d.jsx(eB,{}),sB=d.jsx(Z9,{}),iB=d.jsx(tB,{}),lB=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiCheckbox"}),{checkedIcon:o=aB,color:n="primary",icon:f=sB,indeterminate:m=!1,indeterminateIcon:y=iB,inputProps:C,size:w="medium",disableRipple:A=!1,className:R,slots:I={},slotProps:M={},...F}=a,O=m?y:f,j=m?y:o,U={...a,disableRipple:A,color:n,indeterminate:m,size:w},H=rB(U),K=M.input??C,[W,X]=rr("root",{ref:r,elementType:oB,className:Ht(H.root,R),shouldForwardComponentProp:!0,externalForwardedProps:{slots:I,slotProps:M,...F},ownerState:U,additionalProps:{type:"checkbox",icon:E.cloneElement(O,{fontSize:O.props.fontSize??w}),checkedIcon:E.cloneElement(j,{fontSize:j.props.fontSize??w}),disableRipple:A,slots:I,slotProps:{input:V3(typeof K=="function"?K(U):K,{"data-indeterminate":m})}}});return d.jsx(W,{...X,classes:H})});function oD(t){return t.substring(2).toLowerCase()}function cB(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function uB(t){const{children:e,disableReactTree:r=!1,mouseEvent:a="onClick",onClickAway:o,touchEvent:n="onTouchEnd"}=t,f=E.useRef(!1),m=E.useRef(null),y=E.useRef(!1),C=E.useRef(!1);E.useEffect(()=>(setTimeout(()=>{y.current=!0},0),()=>{y.current=!1}),[]);const w=ro(Dp(e),m),A=yn(M=>{const F=C.current;C.current=!1;const O=$a(m.current);if(!y.current||!m.current||"clientX"in M&&cB(M,O))return;if(f.current){f.current=!1;return}let j;M.composedPath?j=M.composedPath().includes(m.current):j=!O.documentElement.contains(M.target)||m.current.contains(M.target),!j&&(r||!F)&&o(M)}),R=M=>F=>{C.current=!0;const O=e.props[M];O&&O(F)},I={ref:w};return n!==!1&&(I[n]=R(n)),E.useEffect(()=>{if(n!==!1){const M=oD(n),F=$a(m.current),O=()=>{f.current=!0};return F.addEventListener(M,A),F.addEventListener("touchmove",O),()=>{F.removeEventListener(M,A),F.removeEventListener("touchmove",O)}}},[A,n]),a!==!1&&(I[a]=R(a)),E.useEffect(()=>{if(a!==!1){const M=oD(a),F=$a(m.current);return F.addEventListener(M,A),()=>{F.removeEventListener(M,A)}}},[A,a]),E.cloneElement(e,I)}const nT=Fj({createStyledComponent:nt("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`maxWidth${At(String(r.maxWidth))}`],r.fixed&&e.fixed,r.disableGutters&&e.disableGutters]}}),useThemeProps:t=>Wn({props:t,name:"MuiContainer"})}),rT=typeof uA({})=="function",dB=(t,e)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...e&&!t.vars&&{colorScheme:t.palette.mode}}),fB=t=>({color:(t.vars||t).palette.text.primary,...t.typography.body1,backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),fI=(t,e=!1)=>{const r={};e&&t.colorSchemes&&typeof t.getColorSchemeSelector=="function"&&Object.entries(t.colorSchemes).forEach(([n,f])=>{const m=t.getColorSchemeSelector(n);m.startsWith("@")?r[m]={":root":{colorScheme:f.palette?.mode}}:r[m.replace(/\s*&/,"")]={colorScheme:f.palette?.mode}});let a={html:dB(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:{margin:0,...fB(t),"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}},...r};const o=t.components?.MuiCssBaseline?.styleOverrides;return o&&(a=[a,o]),a},Jx="mui-ecs",hB=t=>{const e=fI(t,!1),r=Array.isArray(e)?e[0]:e;return!t.vars&&r&&(r.html[`:root:has(${Jx})`]={colorScheme:t.palette.mode}),t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([a,o])=>{const n=t.getColorSchemeSelector(a);n.startsWith("@")?r[n]={[`:root:not(:has(.${Jx}))`]:{colorScheme:o.palette?.mode}}:r[n.replace(/\s*&/,"")]={[`&:not(:has(.${Jx}))`]:{colorScheme:o.palette?.mode}}}),e},pB=uA(rT?({theme:t,enableColorScheme:e})=>fI(t,e):({theme:t})=>hB(t));function mB(t){const e=Wn({props:t,name:"MuiCssBaseline"}),{children:r,enableColorScheme:a=!1}=e;return d.jsxs(E.Fragment,{children:[rT&&d.jsx(pB,{enableColorScheme:a}),!rT&&!a&&d.jsx("span",{className:Jx,style:{display:"none"}}),r]})}function hI(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function gB(t){const e=$a(t);return e.body===t?Fc(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function _y(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function aD(t){return parseInt(Fc(t).getComputedStyle(t).paddingRight,10)||0}function yB(t){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),a=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return r||a}function sD(t,e,r,a,o){const n=[e,r,...a];[].forEach.call(t.children,f=>{const m=!n.includes(f),y=!yB(f);m&&y&&_y(f,o)})}function lw(t,e){let r=-1;return t.some((a,o)=>e(a)?(r=o,!0):!1),r}function bB(t,e){const r=[],a=t.container;if(!e.disableScrollLock){if(gB(a)){const f=hI(Fc(a));r.push({value:a.style.paddingRight,property:"padding-right",el:a}),a.style.paddingRight=`${aD(a)+f}px`;const m=$a(a).querySelectorAll(".mui-fixed");[].forEach.call(m,y=>{r.push({value:y.style.paddingRight,property:"padding-right",el:y}),y.style.paddingRight=`${aD(y)+f}px`})}let n;if(a.parentNode instanceof DocumentFragment)n=$a(a).body;else{const f=a.parentElement,m=Fc(a);n=f?.nodeName==="HTML"&&m.getComputedStyle(f).overflowY==="scroll"?f:a}r.push({value:n.style.overflow,property:"overflow",el:n},{value:n.style.overflowX,property:"overflow-x",el:n},{value:n.style.overflowY,property:"overflow-y",el:n}),n.style.overflow="hidden"}return()=>{r.forEach(({value:n,el:f,property:m})=>{n?f.style.setProperty(m,n):f.style.removeProperty(m)})}}function vB(t){const e=[];return[].forEach.call(t.children,r=>{r.getAttribute("aria-hidden")==="true"&&e.push(r)}),e}class xB{constructor(){this.modals=[],this.containers=[]}add(e,r){let a=this.modals.indexOf(e);if(a!==-1)return a;a=this.modals.length,this.modals.push(e),e.modalRef&&_y(e.modalRef,!1);const o=vB(r);sD(r,e.mount,e.modalRef,o,!0);const n=lw(this.containers,f=>f.container===r);return n!==-1?(this.containers[n].modals.push(e),a):(this.containers.push({modals:[e],container:r,restore:null,hiddenSiblings:o}),a)}mount(e,r){const a=lw(this.containers,n=>n.modals.includes(e)),o=this.containers[a];o.restore||(o.restore=bB(o,r))}remove(e,r=!0){const a=this.modals.indexOf(e);if(a===-1)return a;const o=lw(this.containers,f=>f.modals.includes(e)),n=this.containers[o];if(n.modals.splice(n.modals.indexOf(e),1),this.modals.splice(a,1),n.modals.length===0)n.restore&&n.restore(),e.modalRef&&_y(e.modalRef,r),sD(n.container,e.mount,e.modalRef,n.hiddenSiblings,!1),this.containers.splice(o,1);else{const f=n.modals[n.modals.length-1];f.modalRef&&_y(f.modalRef,!1)}return a}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function Pm(t){let e=t.activeElement;for(;e?.shadowRoot?.activeElement!=null;)e=e.shadowRoot.activeElement;return e}const CB=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function SB(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function wB(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=a=>t.ownerDocument.querySelector(`input[type="radio"]${a}`);let r=e(`[name="${t.name}"]:checked`);return r||(r=e(`[name="${t.name}"]`)),r!==t}function TB(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||wB(t))}function AB(t){const e=[],r=[];return Array.from(t.querySelectorAll(CB)).forEach((a,o)=>{const n=SB(a);n===-1||!TB(a)||(n===0?e.push(a):r.push({documentOrder:o,tabIndex:n,node:a}))}),r.sort((a,o)=>a.tabIndex===o.tabIndex?a.documentOrder-o.documentOrder:a.tabIndex-o.tabIndex).map(a=>a.node).concat(e)}function EB(){return!0}function pI(t){const{children:e,disableAutoFocus:r=!1,disableEnforceFocus:a=!1,disableRestoreFocus:o=!1,getTabbable:n=AB,isEnabled:f=EB,open:m}=t,y=E.useRef(!1),C=E.useRef(null),w=E.useRef(null),A=E.useRef(null),R=E.useRef(null),I=E.useRef(!1),M=E.useRef(null),F=ro(Dp(e),M),O=E.useRef(null);E.useEffect(()=>{!m||!M.current||(I.current=!r)},[r,m]),E.useEffect(()=>{if(!m||!M.current)return;const H=$a(M.current),K=Pm(H);return M.current.contains(K)||(M.current.hasAttribute("tabIndex")||M.current.setAttribute("tabIndex","-1"),I.current&&M.current.focus()),()=>{o||(A.current&&A.current.focus&&(y.current=!0,A.current.focus()),A.current=null)}},[m]),E.useEffect(()=>{if(!m||!M.current)return;const H=$a(M.current),K=Pm(H),W=ie=>{O.current=ie,!(a||!f()||ie.key!=="Tab")&&K===M.current&&ie.shiftKey&&(y.current=!0,w.current&&w.current.focus())},X=()=>{const ie=M.current;if(ie===null)return;const de=Pm(H);if(!H.hasFocus()||!f()||y.current){y.current=!1;return}if(ie.contains(de)||a&&de!==C.current&&de!==w.current)return;if(de!==R.current)R.current=null;else if(R.current!==null)return;if(!I.current)return;let le=[];if((de===C.current||de===w.current)&&(le=n(M.current)),le.length>0){const oe=!!(O.current?.shiftKey&&O.current?.key==="Tab"),N=le[0],ce=le[le.length-1];typeof N!="string"&&typeof ce!="string"&&(oe?ce.focus():N.focus())}else ie.focus()};H.addEventListener("focusin",X),H.addEventListener("keydown",W,!0);const ee=setInterval(()=>{const ie=Pm(H);ie&&ie.tagName==="BODY"&&X()},50);return()=>{clearInterval(ee),H.removeEventListener("focusin",X),H.removeEventListener("keydown",W,!0)}},[r,a,o,f,m,n]);const j=H=>{A.current===null&&(A.current=H.relatedTarget),I.current=!0,R.current=H.target;const K=e.props.onFocus;K&&K(H)},U=H=>{A.current===null&&(A.current=H.relatedTarget),I.current=!0};return d.jsxs(E.Fragment,{children:[d.jsx("div",{tabIndex:m?0:-1,onFocus:U,ref:C,"data-testid":"sentinelStart"}),E.cloneElement(e,{ref:F,onFocus:j}),d.jsx("div",{tabIndex:m?0:-1,onFocus:U,ref:w,"data-testid":"sentinelEnd"})]})}function kB(t){return typeof t=="function"?t():t}function DB(t){return t?t.props.hasOwnProperty("in"):!1}const iD=()=>{},Cx=new xB;function RB(t){const{container:e,disableEscapeKeyDown:r=!1,disableScrollLock:a=!1,closeAfterTransition:o=!1,onTransitionEnter:n,onTransitionExited:f,children:m,onClose:y,open:C,rootRef:w}=t,A=E.useRef({}),R=E.useRef(null),I=E.useRef(null),M=ro(I,w),[F,O]=E.useState(!C),j=DB(m);let U=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(U=!1);const H=()=>$a(R.current),K=()=>(A.current.modalRef=I.current,A.current.mount=R.current,A.current),W=()=>{Cx.mount(K(),{disableScrollLock:a}),I.current&&(I.current.scrollTop=0)},X=yn(()=>{const Se=kB(e)||H().body;Cx.add(K(),Se),I.current&&W()}),ee=()=>Cx.isTopModal(K()),ie=yn(Se=>{R.current=Se,Se&&(C&&ee()?W():I.current&&_y(I.current,U))}),de=E.useCallback(()=>{Cx.remove(K(),U)},[U]);E.useEffect(()=>()=>{de()},[de]),E.useEffect(()=>{C?X():(!j||!o)&&de()},[C,de,j,o,X]);const le=Se=>se=>{Se.onKeyDown?.(se),!(se.key!=="Escape"||se.which===229||!ee())&&(r||(se.stopPropagation(),y&&y(se,"escapeKeyDown")))},oe=Se=>se=>{Se.onClick?.(se),se.target===se.currentTarget&&y&&y(se,"backdropClick")};return{getRootProps:(Se={})=>{const se=b2(t);delete se.onTransitionEnter,delete se.onTransitionExited;const ye={...se,...Se};return{role:"presentation",...ye,onKeyDown:le(ye),ref:M}},getBackdropProps:(Se={})=>{const se=Se;return{"aria-hidden":!0,...se,onClick:oe(se),open:C}},getTransitionProps:()=>{const Se=()=>{O(!1),n&&n()},se=()=>{O(!0),f&&f(),o&&de()};return{onEnter:Ww(Se,m?.props.onEnter??iD),onExited:Ww(se,m?.props.onExited??iD)}},rootRef:M,portalRef:ie,isTopModal:ee,exited:F,hasTransition:j}}function IB(t){return Cn("MuiModal",t)}bn("MuiModal",["root","hidden","backdrop"]);const PB=t=>{const{open:e,exited:r,classes:a}=t;return pn({root:["root",!e&&r&&"hidden"],backdrop:["backdrop"]},IB,a)},MB=nt("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.open&&r.exited&&e.hidden]}})(jn(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),_B=nt(uI,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),mI=E.forwardRef(function(e,r){const a=Wn({name:"MuiModal",props:e}),{BackdropComponent:o=_B,BackdropProps:n,classes:f,className:m,closeAfterTransition:y=!1,children:C,container:w,component:A,components:R={},componentsProps:I={},disableAutoFocus:M=!1,disableEnforceFocus:F=!1,disableEscapeKeyDown:O=!1,disablePortal:j=!1,disableRestoreFocus:U=!1,disableScrollLock:H=!1,hideBackdrop:K=!1,keepMounted:W=!1,onClose:X,onTransitionEnter:ee,onTransitionExited:ie,open:de,slotProps:le={},slots:oe={},theme:N,...ce}=a,ne={...a,closeAfterTransition:y,disableAutoFocus:M,disableEnforceFocus:F,disableEscapeKeyDown:O,disablePortal:j,disableRestoreFocus:U,disableScrollLock:H,hideBackdrop:K,keepMounted:W},{getRootProps:Se,getBackdropProps:se,getTransitionProps:ye,portalRef:ze,isTopModal:Re,exited:ve,hasTransition:V}=RB({...ne,rootRef:r}),ue={...ne,exited:ve},Ee=PB(ue),Ie={};if(C.props.tabIndex===void 0&&(Ie.tabIndex="-1"),V){const{onEnter:Pe,onExited:Be}=ye();Ie.onEnter=Pe,Ie.onExited=Be}const ae={slots:{root:R.Root,backdrop:R.Backdrop,...oe},slotProps:{...I,...le}},[be,Te]=rr("root",{ref:r,elementType:MB,externalForwardedProps:{...ae,...ce,component:A},getSlotProps:Se,ownerState:ue,className:Ht(m,Ee?.root,!ue.open&&ue.exited&&Ee?.hidden)}),[tt,je]=rr("backdrop",{ref:n?.ref,elementType:o,externalForwardedProps:ae,shouldForwardComponentProp:!0,additionalProps:n,getSlotProps:Pe=>se({...Pe,onClick:Be=>{Pe?.onClick&&Pe.onClick(Be)}}),className:Ht(n?.className,Ee?.backdrop),ownerState:ue});return!W&&!de&&(!V||ve)?null:d.jsx(lI,{ref:ze,container:w,disablePortal:j,children:d.jsxs(be,{...Te,children:[!K&&o?d.jsx(tt,{...je}):null,d.jsx(pI,{disableEnforceFocus:F,disableAutoFocus:M,disableRestoreFocus:U,isEnabled:Re,open:de,children:E.cloneElement(C,Ie)})]})})});function OB(t){return Cn("MuiDialog",t)}const Oy=bn("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),gI=E.createContext({}),FB=nt(uI,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),NB=t=>{const{classes:e,scroll:r,maxWidth:a,fullWidth:o,fullScreen:n}=t,f={root:["root"],container:["container",`scroll${At(r)}`],paper:["paper",`paperScroll${At(r)}`,`paperWidth${At(String(a))}`,o&&"paperFullWidth",n&&"paperFullScreen"]};return pn(f,OB,e)},jB=nt(mI,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),LB=nt("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.container,e[`scroll${At(r.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),BB=nt(ua,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.paper,e[`scrollPaper${At(r.scroll)}`],e[`paperWidth${At(String(r.maxWidth))}`],r.fullWidth&&e.paperFullWidth,r.fullScreen&&e.paperFullScreen]}})(jn(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${Oy.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${Oy.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${Oy.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),oi=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiDialog"}),o=kd(),n={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{"aria-describedby":f,"aria-labelledby":m,"aria-modal":y=!0,BackdropComponent:C,BackdropProps:w,children:A,className:R,disableEscapeKeyDown:I=!1,fullScreen:M=!1,fullWidth:F=!1,maxWidth:O="sm",onClick:j,onClose:U,open:H,PaperComponent:K=ua,PaperProps:W={},scroll:X="paper",slots:ee={},slotProps:ie={},TransitionComponent:de=gp,transitionDuration:le=n,TransitionProps:oe,...N}=a,ce={...a,disableEscapeKeyDown:I,fullScreen:M,fullWidth:F,maxWidth:O,scroll:X},ne=NB(ce),Se=E.useRef(),se=Ge=>{Se.current=Ge.target===Ge.currentTarget},ye=Ge=>{j&&j(Ge),Se.current&&(Se.current=null,U&&U(Ge,"backdropClick"))},ze=nc(m),Re=E.useMemo(()=>({titleId:ze}),[ze]),ve={transition:de,...ee},V={transition:oe,paper:W,backdrop:w,...ie},ue={slots:ve,slotProps:V},[Ee,Ie]=rr("root",{elementType:jB,shouldForwardComponentProp:!0,externalForwardedProps:ue,ownerState:ce,className:Ht(ne.root,R),ref:r}),[ae,be]=rr("backdrop",{elementType:FB,shouldForwardComponentProp:!0,externalForwardedProps:ue,ownerState:ce}),[Te,tt]=rr("paper",{elementType:BB,shouldForwardComponentProp:!0,externalForwardedProps:ue,ownerState:ce,className:Ht(ne.paper,W.className)}),[je,Pe]=rr("container",{elementType:LB,externalForwardedProps:ue,ownerState:ce,className:ne.container}),[Be,Fe]=rr("transition",{elementType:gp,externalForwardedProps:ue,ownerState:ce,additionalProps:{appear:!0,in:H,timeout:le,role:"presentation"}});return d.jsx(Ee,{closeAfterTransition:!0,slots:{backdrop:ae},slotProps:{backdrop:{transitionDuration:le,as:C,...be}},disableEscapeKeyDown:I,onClose:U,open:H,onClick:ye,...Ie,...N,children:d.jsx(Be,{...Fe,children:d.jsx(je,{onMouseDown:se,...Pe,children:d.jsx(Te,{as:K,elevation:24,role:"dialog","aria-describedby":f,"aria-labelledby":ze,"aria-modal":y,...tt,children:d.jsx(gI.Provider,{value:Re,children:A})})})})})});function zB(t){return Cn("MuiDialogActions",t)}bn("MuiDialogActions",["root","spacing"]);const UB=t=>{const{classes:e,disableSpacing:r}=t;return pn({root:["root",!r&&"spacing"]},zB,e)},$B=nt("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),tl=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiDialogActions"}),{className:o,disableSpacing:n=!1,...f}=a,m={...a,disableSpacing:n},y=UB(m);return d.jsx($B,{className:Ht(y.root,o),ownerState:m,ref:r,...f})});function HB(t){return Cn("MuiDialogContent",t)}bn("MuiDialogContent",["root","dividers"]);function WB(t){return Cn("MuiDialogTitle",t)}const VB=bn("MuiDialogTitle",["root"]),GB=t=>{const{classes:e,dividers:r}=t;return pn({root:["root",r&&"dividers"]},HB,e)},KB=nt("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.dividers&&e.dividers]}})(jn(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${VB.root} + &`]:{paddingTop:0}}}]}))),ai=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiDialogContent"}),{className:o,dividers:n=!1,...f}=a,m={...a,dividers:n},y=GB(m);return d.jsx(KB,{className:Ht(y.root,o),ownerState:m,ref:r,...f})}),YB=t=>{const{classes:e}=t;return pn({root:["root"]},WB,e)},qB=nt(We,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),Ii=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiDialogTitle"}),{className:o,id:n,...f}=a,m=a,y=YB(m),{titleId:C=n}=E.useContext(gI);return d.jsx(qB,{component:"h2",className:Ht(y.root,o),ownerState:m,ref:r,variant:"h6",id:n??C,...f})});function QB(t){return Cn("MuiDivider",t)}const lD=bn("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),XB=t=>{const{absolute:e,children:r,classes:a,flexItem:o,light:n,orientation:f,textAlign:m,variant:y}=t;return pn({root:["root",e&&"absolute",y,n&&"light",f==="vertical"&&"vertical",o&&"flexItem",r&&"withChildren",r&&f==="vertical"&&"withChildrenVertical",m==="right"&&f!=="vertical"&&"textAlignRight",m==="left"&&f!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",f==="vertical"&&"wrapperVertical"]},QB,a)},JB=nt("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.absolute&&e.absolute,e[r.variant],r.light&&e.light,r.orientation==="vertical"&&e.vertical,r.flexItem&&e.flexItem,r.children&&e.withChildren,r.children&&r.orientation==="vertical"&&e.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&e.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&e.textAlignLeft]}})(jn(({theme:t})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.alpha((t.vars||t).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),ZB=nt("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.wrapper,r.orientation==="vertical"&&e.wrapperVertical]}})(jn(({theme:t})=>({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}))),T2=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiDivider"}),{absolute:o=!1,children:n,className:f,orientation:m="horizontal",component:y=n||m==="vertical"?"div":"hr",flexItem:C=!1,light:w=!1,role:A=y!=="hr"?"separator":void 0,textAlign:R="center",variant:I="fullWidth",...M}=a,F={...a,absolute:o,component:y,flexItem:C,light:w,orientation:m,role:A,textAlign:R,variant:I},O=XB(F);return d.jsx(JB,{as:y,className:Ht(O.root,f),role:A,ref:r,ownerState:F,"aria-orientation":A==="separator"&&(y!=="hr"||m==="vertical")?m:void 0,...M,children:n?d.jsx(ZB,{className:O.wrapper,ownerState:F,children:n}):null})});T2&&(T2.muiSkipListHighlight=!0);const ez=t=>{const{classes:e,disableUnderline:r,startAdornment:a,endAdornment:o,size:n,hiddenLabel:f,multiline:m}=t,y={root:["root",!r&&"underline",a&&"adornedStart",o&&"adornedEnd",n==="small"&&`size${At(n)}`,f&&"hiddenLabel",m&&"multiline"],input:["input"]},C=pn(y,p9,e);return{...e,...C}},tz=nt(RC,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...kC(t,e),!r.disableUnderline&&e.underline]}})(jn(({theme:t})=>{const e=t.palette.mode==="light",r=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",a=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",o=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",n=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:o,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a}},[`&.${bl.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a},[`&.${bl.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:n},variants:[{props:({ownerState:f})=>!f.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${bl.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${bl.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline):r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${bl.disabled}, .${bl.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${bl.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(Go()).map(([f])=>({props:{disableUnderline:!1,color:f},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[f]?.main}`}}})),{props:({ownerState:f})=>f.startAdornment,style:{paddingLeft:12}},{props:({ownerState:f})=>f.endAdornment,style:{paddingRight:12}},{props:({ownerState:f})=>f.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:f,size:m})=>f.multiline&&m==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:f})=>f.multiline&&f.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:f})=>f.multiline&&f.hiddenLabel&&f.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),nz=nt(IC,{name:"MuiFilledInput",slot:"Input",overridesResolver:DC})(jn(({theme:t})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&e.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),wA=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiFilledInput"}),{disableUnderline:o=!1,components:n={},componentsProps:f,fullWidth:m=!1,hiddenLabel:y,inputComponent:C="input",multiline:w=!1,slotProps:A,slots:R={},type:I="text",...M}=a,F={...a,disableUnderline:o,fullWidth:m,inputComponent:C,multiline:w,type:I},O=ez(a),j={root:{ownerState:F},input:{ownerState:F}},U=A??f?ri(j,A??f):j,H=R.root??n.Root??tz,K=R.input??n.Input??nz;return d.jsx(CA,{slots:{root:H,input:K},slotProps:U,fullWidth:m,inputComponent:C,multiline:w,ref:r,type:I,...M,classes:O})});wA.muiName="Input";function rz(t){return Cn("MuiFormControl",t)}bn("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const oz=t=>{const{classes:e,margin:r,fullWidth:a}=t,o={root:["root",r!=="none"&&`margin${At(r)}`,a&&"fullWidth"]};return pn(o,rz,e)},az=nt("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`margin${At(r.margin)}`],r.fullWidth&&e.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),Hr=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiFormControl"}),{children:o,className:n,color:f="primary",component:m="div",disabled:y=!1,error:C=!1,focused:w,fullWidth:A=!1,hiddenLabel:R=!1,margin:I="none",required:M=!1,size:F="medium",variant:O="outlined",...j}=a,U={...a,color:f,component:m,disabled:y,error:C,fullWidth:A,hiddenLabel:R,margin:I,required:M,size:F,variant:O},H=oz(U),[K,W]=E.useState(()=>{let Se=!1;return o&&E.Children.forEach(o,se=>{if(!Qx(se,["Input","Select"]))return;const ye=Qx(se,["Select"])?se.props.input:se;ye&&c9(ye.props)&&(Se=!0)}),Se}),[X,ee]=E.useState(()=>{let Se=!1;return o&&E.Children.forEach(o,se=>{Qx(se,["Input","Select"])&&(S2(se.props,!0)||S2(se.props.inputProps,!0))&&(Se=!0)}),Se}),[ie,de]=E.useState(!1);y&&ie&&de(!1);const le=w!==void 0&&!y?w:ie;let oe;E.useRef(!1);const N=E.useCallback(()=>{ee(!0)},[]),ce=E.useCallback(()=>{ee(!1)},[]),ne=E.useMemo(()=>({adornedStart:K,setAdornedStart:W,color:f,disabled:y,error:C,filled:X,focused:le,fullWidth:A,hiddenLabel:R,size:F,onBlur:()=>{de(!1)},onFocus:()=>{de(!0)},onEmpty:ce,onFilled:N,registerEffect:oe,required:M,variant:O}),[K,f,y,C,X,le,A,R,oe,ce,N,M,F,O]);return d.jsx(EC.Provider,{value:ne,children:d.jsx(az,{as:m,ownerState:U,className:Ht(H.root,n),ref:r,...j,children:o})})});function sz(t){return Cn("MuiFormControlLabel",t)}const ky=bn("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),iz=t=>{const{classes:e,disabled:r,labelPlacement:a,error:o,required:n}=t,f={root:["root",r&&"disabled",`labelPlacement${At(a)}`,o&&"error",n&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",o&&"error"]};return pn(f,sz,e)},lz=nt("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${ky.label}`]:e.label},e.root,e[`labelPlacement${At(r.labelPlacement)}`]]}})(jn(({theme:t})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${ky.disabled}`]:{cursor:"default"},[`& .${ky.label}`]:{[`&.${ky.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>e==="start"||e==="top"||e==="bottom",style:{marginLeft:16}}]}))),cz=nt("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(jn(({theme:t})=>({[`&.${ky.error}`]:{color:(t.vars||t).palette.error.main}}))),oT=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiFormControlLabel"}),{checked:o,className:n,componentsProps:f={},control:m,disabled:y,disableTypography:C,inputRef:w,label:A,labelPlacement:R="end",name:I,onChange:M,required:F,slots:O={},slotProps:j={},value:U,...H}=a,K=Al(),W=y??m.props.disabled??K?.disabled,X=F??m.props.required,ee={disabled:W,required:X};["checked","name","onChange","value","inputRef"].forEach(Se=>{typeof m.props[Se]>"u"&&typeof a[Se]<"u"&&(ee[Se]=a[Se])});const ie=Hf({props:a,muiFormControl:K,states:["error"]}),de={...a,disabled:W,labelPlacement:R,required:X,error:ie.error},le=iz(de),oe={slots:O,slotProps:{...f,...j}},[N,ce]=rr("typography",{elementType:We,externalForwardedProps:oe,ownerState:de});let ne=A;return ne!=null&&ne.type!==We&&!C&&(ne=d.jsx(N,{component:"span",...ce,className:Ht(le.label,ce?.className),children:ne})),d.jsxs(lz,{className:Ht(le.root,n),ownerState:de,ref:r,...H,children:[E.cloneElement(m,ee),X?d.jsxs("div",{children:[ne,d.jsxs(cz,{ownerState:de,"aria-hidden":!0,className:le.asterisk,children:["","*"]})]}):ne]})});function uz(t){return Cn("MuiFormGroup",t)}bn("MuiFormGroup",["root","row","error"]);const dz=t=>{const{classes:e,row:r,error:a}=t;return pn({root:["root",r&&"row",a&&"error"]},uz,e)},fz=nt("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),hz=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiFormGroup"}),{className:o,row:n=!1,...f}=a,m=Al(),y=Hf({props:a,muiFormControl:m,states:["error"]}),C={...a,row:n,error:y.error},w=dz(C);return d.jsx(fz,{className:Ht(w.root,o),ownerState:C,ref:r,...f})});function pz(t){return Cn("MuiFormHelperText",t)}const cD=bn("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var uD;const mz=t=>{const{classes:e,contained:r,size:a,disabled:o,error:n,filled:f,focused:m,required:y}=t,C={root:["root",o&&"disabled",n&&"error",a&&`size${At(a)}`,r&&"contained",m&&"focused",f&&"filled",y&&"required"]};return pn(C,pz,e)},gz=nt("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size&&e[`size${At(r.size)}`],r.contained&&e.contained,r.filled&&e.filled]}})(jn(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${cD.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${cD.error}`]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),yI=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiFormHelperText"}),{children:o,className:n,component:f="p",disabled:m,error:y,filled:C,focused:w,margin:A,required:R,variant:I,...M}=a,F=Al(),O=Hf({props:a,muiFormControl:F,states:["variant","size","disabled","error","filled","focused","required"]}),j={...a,component:f,contained:O.variant==="filled"||O.variant==="outlined",variant:O.variant,size:O.size,disabled:O.disabled,error:O.error,filled:O.filled,focused:O.focused,required:O.required};delete j.ownerState;const U=mz(j);return d.jsx(gz,{as:f,className:Ht(U.root,n),ref:r,...M,ownerState:j,children:o===" "?uD||(uD=d.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):o})});function yz(t){return Cn("MuiFormLabel",t)}const Fy=bn("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),bz=t=>{const{classes:e,color:r,focused:a,disabled:o,error:n,filled:f,required:m}=t,y={root:["root",`color${At(r)}`,o&&"disabled",n&&"error",f&&"filled",a&&"focused",m&&"required"],asterisk:["asterisk",n&&"error"]};return pn(y,yz,e)},vz=nt("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.color==="secondary"&&e.colorSecondary,r.filled&&e.filled]}})(jn(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{[`&.${Fy.focused}`]:{color:(t.vars||t).palette[e].main}}})),{props:{},style:{[`&.${Fy.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${Fy.error}`]:{color:(t.vars||t).palette.error.main}}}]}))),xz=nt("span",{name:"MuiFormLabel",slot:"Asterisk"})(jn(({theme:t})=>({[`&.${Fy.error}`]:{color:(t.vars||t).palette.error.main}}))),Cz=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiFormLabel"}),{children:o,className:n,color:f,component:m="label",disabled:y,error:C,filled:w,focused:A,required:R,...I}=a,M=Al(),F=Hf({props:a,muiFormControl:M,states:["color","required","focused","disabled","error","filled"]}),O={...a,color:F.color||"primary",component:m,disabled:F.disabled,error:F.error,filled:F.filled,focused:F.focused,required:F.required},j=bz(O);return d.jsxs(vz,{as:m,ownerState:O,className:Ht(j.root,n),ref:r,...I,children:[o,F.required&&d.jsxs(xz,{ownerState:O,"aria-hidden":!0,className:j.asterisk,children:["","*"]})]})});function aT(t){return`scale(${t}, ${t**2})`}const Sz={entering:{opacity:1,transform:aT(1)},entered:{opacity:1,transform:"none"}},cw=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Zm=E.forwardRef(function(e,r){const{addEndListener:a,appear:o=!0,children:n,easing:f,in:m,onEnter:y,onEntered:C,onEntering:w,onExit:A,onExited:R,onExiting:I,style:M,timeout:F="auto",TransitionComponent:O=Bc,...j}=e,U=xl(),H=E.useRef(),K=kd(),W=E.useRef(null),X=ro(W,Dp(n),r),ee=Se=>se=>{if(Se){const ye=W.current;se===void 0?Se(ye):Se(ye,se)}},ie=ee(w),de=ee((Se,se)=>{Y3(Se);const{duration:ye,delay:ze,easing:Re}=y2({style:M,timeout:F,easing:f},{mode:"enter"});let ve;F==="auto"?(ve=K.transitions.getAutoHeightDuration(Se.clientHeight),H.current=ve):ve=ye,Se.style.transition=[K.transitions.create("opacity",{duration:ve,delay:ze}),K.transitions.create("transform",{duration:cw?ve:ve*.666,delay:ze,easing:Re})].join(","),y&&y(Se,se)}),le=ee(C),oe=ee(I),N=ee(Se=>{const{duration:se,delay:ye,easing:ze}=y2({style:M,timeout:F,easing:f},{mode:"exit"});let Re;F==="auto"?(Re=K.transitions.getAutoHeightDuration(Se.clientHeight),H.current=Re):Re=se,Se.style.transition=[K.transitions.create("opacity",{duration:Re,delay:ye}),K.transitions.create("transform",{duration:cw?Re:Re*.666,delay:cw?ye:ye||Re*.333,easing:ze})].join(","),Se.style.opacity=0,Se.style.transform=aT(.75),A&&A(Se)}),ce=ee(R),ne=Se=>{F==="auto"&&U.start(H.current||0,Se),a&&a(W.current,Se)};return d.jsx(O,{appear:o,in:m,nodeRef:W,onEnter:de,onEntered:le,onEntering:ie,onExit:N,onExited:ce,onExiting:oe,addEndListener:ne,timeout:F==="auto"?null:F,...j,children:(Se,{ownerState:se,...ye})=>E.cloneElement(n,{style:{opacity:0,transform:aT(.75),visibility:Se==="exited"&&!m?"hidden":void 0,...Sz[Se],...M,...n.props.style},ref:X,...ye})})});Zm&&(Zm.muiSupportAuto=!0);const wz=t=>{const{classes:e,disableUnderline:r}=t,o=pn({root:["root",!r&&"underline"],input:["input"]},f9,e);return{...e,...o}},Tz=nt(RC,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[...kC(t,e),!r.disableUnderline&&e.underline]}})(jn(({theme:t})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:a})=>a.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:a})=>!a.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${kf.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${kf.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${kf.disabled}, .${kf.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${kf.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(Go()).map(([a])=>({props:{color:a,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[a].main}`}}}))]}})),Az=nt(IC,{name:"MuiInput",slot:"Input",overridesResolver:DC})({}),TA=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiInput"}),{disableUnderline:o=!1,components:n={},componentsProps:f,fullWidth:m=!1,inputComponent:y="input",multiline:C=!1,slotProps:w,slots:A={},type:R="text",...I}=a,M=wz(a),O={root:{ownerState:{disableUnderline:o}}},j=w??f?ri(w??f,O):O,U=A.root??n.Root??Tz,H=A.input??n.Input??Az;return d.jsx(CA,{slots:{root:U,input:H},slotProps:j,fullWidth:m,inputComponent:y,multiline:C,ref:r,type:R,...I,classes:M})});TA.muiName="Input";function Ez(t){return Cn("MuiInputAdornment",t)}const dD=bn("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var fD;const kz=(t,e)=>{const{ownerState:r}=t;return[e.root,e[`position${At(r.position)}`],r.disablePointerEvents===!0&&e.disablePointerEvents,e[r.variant]]},Dz=t=>{const{classes:e,disablePointerEvents:r,hiddenLabel:a,position:o,size:n,variant:f}=t,m={root:["root",r&&"disablePointerEvents",o&&`position${At(o)}`,f,a&&"hiddenLabel",n&&`size${At(n)}`]};return pn(m,Ez,e)},Rz=nt("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:kz})(jn(({theme:t})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${dD.positionStart}&:not(.${dD.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),Pu=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiInputAdornment"}),{children:o,className:n,component:f="div",disablePointerEvents:m=!1,disableTypography:y=!1,position:C,variant:w,...A}=a,R=Al()||{};let I=w;w&&R.variant,R&&!I&&(I=R.variant);const M={...a,hiddenLabel:R.hiddenLabel,size:R.size,disablePointerEvents:m,position:C,variant:I},F=Dz(M);return d.jsx(EC.Provider,{value:null,children:d.jsx(Rz,{as:f,ownerState:M,className:Ht(F.root,n),ref:r,...A,children:typeof o=="string"&&!y?d.jsx(We,{color:"textSecondary",children:o}):d.jsxs(E.Fragment,{children:[C==="start"?fD||(fD=d.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):null,o]})})})});function Iz(t){return Cn("MuiInputLabel",t)}bn("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Pz=t=>{const{classes:e,formControl:r,size:a,shrink:o,disableAnimation:n,variant:f,required:m}=t,y={root:["root",r&&"formControl",!n&&"animated",o&&"shrink",a&&a!=="medium"&&`size${At(a)}`,f],asterisk:[m&&"asterisk"]},C=pn(y,Iz,e);return{...e,...C}},Mz=nt(Cz,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${Fy.asterisk}`]:e.asterisk},e.root,r.formControl&&e.formControl,r.size==="small"&&e.sizeSmall,r.shrink&&e.shrink,!r.disableAnimation&&e.animated,r.focused&&e.focused,e[r.variant]]}})(jn(({theme:t})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="filled"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:r,size:a})=>e==="filled"&&r.shrink&&a==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:r})=>e==="outlined"&&r.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),Qi=E.forwardRef(function(e,r){const a=Wn({name:"MuiInputLabel",props:e}),{disableAnimation:o=!1,margin:n,shrink:f,variant:m,className:y,...C}=a,w=Al();let A=f;typeof A>"u"&&w&&(A=w.filled||w.focused||w.adornedStart);const R=Hf({props:a,muiFormControl:w,states:["size","variant","required","focused"]}),I={...a,disableAnimation:o,formControl:w,shrink:A,size:R.size,variant:R.variant,required:R.required,focused:R.focused},M=Pz(I);return d.jsx(Mz,{"data-shrink":A,ref:r,className:Ht(M.root,y),...C,ownerState:I,classes:M})});function _z(t){return Cn("MuiLinearProgress",t)}bn("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const sT=4,iT=Uf`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,Oz=typeof iT!="string"?ag`
        animation: ${iT} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,lT=Uf`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,Fz=typeof lT!="string"?ag`
        animation: ${lT} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,cT=Uf`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,Nz=typeof cT!="string"?ag`
        animation: ${cT} 3s infinite linear;
      `:null,jz=t=>{const{classes:e,variant:r,color:a}=t,o={root:["root",`color${At(a)}`,r],dashed:["dashed",`dashedColor${At(a)}`],bar1:["bar","bar1",`barColor${At(a)}`,(r==="indeterminate"||r==="query")&&"bar1Indeterminate",r==="determinate"&&"bar1Determinate",r==="buffer"&&"bar1Buffer"],bar2:["bar","bar2",r!=="buffer"&&`barColor${At(a)}`,r==="buffer"&&`color${At(a)}`,(r==="indeterminate"||r==="query")&&"bar2Indeterminate",r==="buffer"&&"bar2Buffer"]};return pn(o,_z,e)},AA=(t,e)=>t.vars?t.vars.palette.LinearProgress[`${e}Bg`]:t.palette.mode==="light"?t.lighten(t.palette[e].main,.62):t.darken(t.palette[e].main,.5),Lz=nt("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`color${At(r.color)}`],e[r.variant]]}})(jn(({theme:t})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{backgroundColor:AA(t,e)}})),{props:({ownerState:e})=>e.color==="inherit"&&e.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),Bz=nt("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.dashed,e[`dashedColor${At(r.color)}`]]}})(jn(({theme:t})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(t.palette).filter(Go()).map(([e])=>{const r=AA(t,e);return{props:{color:e},style:{backgroundImage:`radial-gradient(${r} 0%, ${r} 16%, transparent 42%)`}}})]})),Nz||{animation:`${cT} 3s infinite linear`}),zz=nt("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.bar,e.bar1,e[`barColor${At(r.color)}`],(r.variant==="indeterminate"||r.variant==="query")&&e.bar1Indeterminate,r.variant==="determinate"&&e.bar1Determinate,r.variant==="buffer"&&e.bar1Buffer]}})(jn(({theme:t})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{backgroundColor:(t.vars||t).palette[e].main}})),{props:{variant:"determinate"},style:{transition:`transform .${sT}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${sT}s linear`}},{props:({ownerState:e})=>e.variant==="indeterminate"||e.variant==="query",style:{width:"auto"}},{props:({ownerState:e})=>e.variant==="indeterminate"||e.variant==="query",style:Oz||{animation:`${iT} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),Uz=nt("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.bar,e.bar2,e[`barColor${At(r.color)}`],(r.variant==="indeterminate"||r.variant==="query")&&e.bar2Indeterminate,r.variant==="buffer"&&e.bar2Buffer]}})(jn(({theme:t})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{"--LinearProgressBar2-barColor":(t.vars||t).palette[e].main}})),{props:({ownerState:e})=>e.variant!=="buffer"&&e.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:e})=>e.variant!=="buffer"&&e.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e,variant:"buffer"},style:{backgroundColor:AA(t,e),transition:`transform .${sT}s linear`}})),{props:({ownerState:e})=>e.variant==="indeterminate"||e.variant==="query",style:{width:"auto"}},{props:({ownerState:e})=>e.variant==="indeterminate"||e.variant==="query",style:Fz||{animation:`${lT} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),$z=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiLinearProgress"}),{className:o,color:n="primary",value:f,valueBuffer:m,variant:y="indeterminate",...C}=a,w={...a,color:n,variant:y},A=jz(w),R=Pi(),I={},M={bar1:{},bar2:{}};if((y==="determinate"||y==="buffer")&&f!==void 0){I["aria-valuenow"]=Math.round(f),I["aria-valuemin"]=0,I["aria-valuemax"]=100;let F=f-100;R&&(F=-F),M.bar1.transform=`translateX(${F}%)`}if(y==="buffer"&&m!==void 0){let F=(m||0)-100;R&&(F=-F),M.bar2.transform=`translateX(${F}%)`}return d.jsxs(Lz,{className:Ht(A.root,o),ownerState:w,role:"progressbar",...I,ref:r,...C,children:[y==="buffer"?d.jsx(Bz,{className:A.dashed,ownerState:w}):null,d.jsx(zz,{className:A.bar1,ownerState:w,style:M.bar1}),y==="determinate"?null:d.jsx(Uz,{className:A.bar2,ownerState:w,style:M.bar2})]})}),bd=E.createContext({});function Hz(t){return Cn("MuiList",t)}bn("MuiList",["root","padding","dense","subheader"]);const Wz=t=>{const{classes:e,disablePadding:r,dense:a,subheader:o}=t;return pn({root:["root",!r&&"padding",a&&"dense",o&&"subheader"]},Hz,e)},Vz=nt("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disablePadding&&e.padding,r.dense&&e.dense,r.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),bI=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiList"}),{children:o,className:n,component:f="ul",dense:m=!1,disablePadding:y=!1,subheader:C,...w}=a,A=E.useMemo(()=>({dense:m}),[m]),R={...a,component:f,dense:m,disablePadding:y},I=Wz(R);return d.jsx(bd.Provider,{value:A,children:d.jsxs(Vz,{as:f,className:Ht(I.root,n),ref:r,ownerState:R,...w,children:[C,o]})})});function Gz(t){return Cn("MuiListItem",t)}bn("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);const Kz=bn("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function Yz(t){return Cn("MuiListItemSecondaryAction",t)}bn("MuiListItemSecondaryAction",["root","disableGutters"]);const qz=t=>{const{disableGutters:e,classes:r}=t;return pn({root:["root",e&&"disableGutters"]},Yz,r)},Qz=nt("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.disableGutters&&e.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:t})=>t.disableGutters,style:{right:0}}]}),vI=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiListItemSecondaryAction"}),{className:o,...n}=a,f=E.useContext(bd),m={...a,disableGutters:f.disableGutters},y=qz(m);return d.jsx(Qz,{className:Ht(y.root,o),ownerState:m,ref:r,...n})});vI.muiName="ListItemSecondaryAction";const Xz=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.alignItems==="flex-start"&&e.alignItemsFlexStart,r.divider&&e.divider,!r.disableGutters&&e.gutters,!r.disablePadding&&e.padding,r.hasSecondaryAction&&e.secondaryAction]},Jz=t=>{const{alignItems:e,classes:r,dense:a,disableGutters:o,disablePadding:n,divider:f,hasSecondaryAction:m}=t;return pn({root:["root",a&&"dense",!o&&"gutters",!n&&"padding",f&&"divider",e==="flex-start"&&"alignItemsFlexStart",m&&"secondaryAction"],container:["container"],secondaryAction:["secondaryAction"]},Gz,r)},Zz=nt("div",{name:"MuiListItem",slot:"Root",overridesResolver:Xz})(jn(({theme:t})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${Kz.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),eU=nt("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),tU=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiListItem"}),{alignItems:o="center",children:n,className:f,component:m,components:y={},componentsProps:C={},ContainerComponent:w="li",ContainerProps:{className:A,...R}={},dense:I=!1,disableGutters:M=!1,disablePadding:F=!1,divider:O=!1,secondaryAction:j,slotProps:U={},slots:H={},...K}=a,W=E.useContext(bd),X=E.useMemo(()=>({dense:I||W.dense||!1,alignItems:o,disableGutters:M}),[o,W.dense,I,M]),ee=E.useRef(null),ie=E.Children.toArray(n),de=ie.length&&Qx(ie[ie.length-1],["ListItemSecondaryAction"]),le={...a,alignItems:o,dense:X.dense,disableGutters:M,disablePadding:F,divider:O,hasSecondaryAction:de},oe=Jz(le),N=ro(ee,r),ce={slots:H,slotProps:U},[ne,Se]=rr("secondaryAction",{elementType:vI,externalForwardedProps:ce,ownerState:le,className:oe.secondaryAction}),se=H.root||y.Root||Zz,ye=U.root||C.root||{},ze={className:Ht(oe.root,ye.className,f),...K};let Re=m||"li";return de?(Re=!ze.component&&!m?"div":Re,w==="li"&&(Re==="li"?Re="div":ze.component==="li"&&(ze.component="div")),d.jsx(bd.Provider,{value:X,children:d.jsxs(eU,{as:w,className:Ht(oe.container,A),ref:N,ownerState:le,...R,children:[d.jsx(se,{...ye,...!Ym(se)&&{as:Re,ownerState:{...le,...ye.ownerState}},...ze,children:ie}),ie.pop()]})})):d.jsx(bd.Provider,{value:X,children:d.jsxs(se,{...ye,as:Re,ref:N,...!Ym(se)&&{ownerState:{...le,...ye.ownerState}},...ze,children:[ie,j&&d.jsx(ne,{...Se,children:j})]})})});function nU(t){return Cn("MuiListItemIcon",t)}const hD=bn("MuiListItemIcon",["root","alignItemsFlexStart"]),rU=t=>{const{alignItems:e,classes:r}=t;return pn({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},nU,r)},oU=nt("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.alignItems==="flex-start"&&e.alignItemsFlexStart]}})(jn(({theme:t})=>({minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),Ts=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiListItemIcon"}),{className:o,...n}=a,f=E.useContext(bd),m={...a,alignItems:f.alignItems},y=rU(m);return d.jsx(oU,{className:Ht(y.root,o),ownerState:m,ref:r,...n})});function aU(t){return Cn("MuiListItemText",t)}const Mm=bn("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),sU=t=>{const{classes:e,inset:r,primary:a,secondary:o,dense:n}=t;return pn({root:["root",r&&"inset",n&&"dense",a&&o&&"multiline"],primary:["primary"],secondary:["secondary"]},aU,e)},iU=nt("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${Mm.primary}`]:e.primary},{[`& .${Mm.secondary}`]:e.secondary},e.root,r.inset&&e.inset,r.primary&&r.secondary&&e.multiline,r.dense&&e.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${O4.root}:where(& .${Mm.primary})`]:{display:"block"},[`.${O4.root}:where(& .${Mm.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),As=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiListItemText"}),{children:o,className:n,disableTypography:f=!1,inset:m=!1,primary:y,primaryTypographyProps:C,secondary:w,secondaryTypographyProps:A,slots:R={},slotProps:I={},...M}=a,{dense:F}=E.useContext(bd);let O=y??o,j=w;const U={...a,disableTypography:f,inset:m,primary:!!O,secondary:!!j,dense:F},H=sU(U),K={slots:R,slotProps:{primary:C,secondary:A,...I}},[W,X]=rr("root",{className:Ht(H.root,n),elementType:iU,externalForwardedProps:{...K,...M},ownerState:U,ref:r}),[ee,ie]=rr("primary",{className:H.primary,elementType:We,externalForwardedProps:K,ownerState:U}),[de,le]=rr("secondary",{className:H.secondary,elementType:We,externalForwardedProps:K,ownerState:U});return O!=null&&O.type!==We&&!f&&(O=d.jsx(ee,{variant:F?"body2":"body1",component:ie?.variant?void 0:"span",...ie,children:O})),j!=null&&j.type!==We&&!f&&(j=d.jsx(de,{variant:"body2",color:"textSecondary",...le,children:j})),d.jsxs(W,{...X,children:[O,j]})});function uw(t,e,r){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:r?null:t.firstChild}function pD(t,e,r){return t===e?r?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:r?null:t.lastChild}function xI(t,e){if(e===void 0)return!0;let r=t.innerText;return r===void 0&&(r=t.textContent),r=r.trim().toLowerCase(),r.length===0?!1:e.repeating?r[0]===e.keys[0]:r.startsWith(e.keys.join(""))}function uy(t,e,r,a,o,n){let f=!1,m=o(t,e,e?r:!1);for(;m;){if(m===t.firstChild){if(f)return!1;f=!0}const y=a?!1:m.disabled||m.getAttribute("aria-disabled")==="true";if(!m.hasAttribute("tabindex")||!xI(m,n)||y)m=o(t,m,r);else return m.focus(),!0}return!1}const lU=E.forwardRef(function(e,r){const{actions:a,autoFocus:o=!1,autoFocusItem:n=!1,children:f,className:m,disabledItemsFocusable:y=!1,disableListWrap:C=!1,onKeyDown:w,variant:A="selectedMenu",...R}=e,I=E.useRef(null),M=E.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});ka(()=>{o&&I.current.focus()},[o]),E.useImperativeHandle(a,()=>({adjustStyleForScrollbar:(H,{direction:K})=>{const W=!I.current.style.width;if(H.clientHeight<I.current.clientHeight&&W){const X=`${hI(Fc(H))}px`;I.current.style[K==="rtl"?"paddingLeft":"paddingRight"]=X,I.current.style.width=`calc(100% + ${X})`}return I.current}}),[]);const F=H=>{const K=I.current,W=H.key;if(H.ctrlKey||H.metaKey||H.altKey){w&&w(H);return}const ee=Pm($a(K));if(W==="ArrowDown")H.preventDefault(),uy(K,ee,C,y,uw);else if(W==="ArrowUp")H.preventDefault(),uy(K,ee,C,y,pD);else if(W==="Home")H.preventDefault(),uy(K,null,C,y,uw);else if(W==="End")H.preventDefault(),uy(K,null,C,y,pD);else if(W.length===1){const ie=M.current,de=W.toLowerCase(),le=performance.now();ie.keys.length>0&&(le-ie.lastTime>500?(ie.keys=[],ie.repeating=!0,ie.previousKeyMatched=!0):ie.repeating&&de!==ie.keys[0]&&(ie.repeating=!1)),ie.lastTime=le,ie.keys.push(de);const oe=ee&&!ie.repeating&&xI(ee,ie);ie.previousKeyMatched&&(oe||uy(K,ee,!1,y,uw,ie))?H.preventDefault():ie.previousKeyMatched=!1}w&&w(H)},O=ro(I,r);let j=-1;E.Children.forEach(f,(H,K)=>{if(!E.isValidElement(H)){j===K&&(j+=1,j>=f.length&&(j=-1));return}H.props.disabled||(A==="selectedMenu"&&H.props.selected||j===-1)&&(j=K),j===K&&(H.props.disabled||H.props.muiSkipListHighlight||H.type.muiSkipListHighlight)&&(j+=1,j>=f.length&&(j=-1))});const U=E.Children.map(f,(H,K)=>{if(K===j){const W={};return n&&(W.autoFocus=!0),H.props.tabIndex===void 0&&A==="selectedMenu"&&(W.tabIndex=0),E.cloneElement(H,W)}return H});return d.jsx(bI,{role:"menu",ref:O,className:m,onKeyDown:F,tabIndex:o?0:-1,...R,children:U})});function cU(t){return Cn("MuiPopover",t)}bn("MuiPopover",["root","paper"]);function mD(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.height/2:e==="bottom"&&(r=t.height),r}function gD(t,e){let r=0;return typeof e=="number"?r=e:e==="center"?r=t.width/2:e==="right"&&(r=t.width),r}function yD(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function Sx(t){return typeof t=="function"?t():t}const uU=t=>{const{classes:e}=t;return pn({root:["root"],paper:["paper"]},cU,e)},dU=nt(mI,{name:"MuiPopover",slot:"Root"})({}),CI=nt(ua,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),fU=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiPopover"}),{action:o,anchorEl:n,anchorOrigin:f={vertical:"top",horizontal:"left"},anchorPosition:m,anchorReference:y="anchorEl",children:C,className:w,container:A,elevation:R=8,marginThreshold:I=16,open:M,PaperProps:F={},slots:O={},slotProps:j={},transformOrigin:U={vertical:"top",horizontal:"left"},TransitionComponent:H,transitionDuration:K="auto",TransitionProps:W={},disableScrollLock:X=!1,...ee}=a,ie=E.useRef(),de={...a,anchorOrigin:f,anchorReference:y,elevation:R,marginThreshold:I,transformOrigin:U,TransitionComponent:H,transitionDuration:K,TransitionProps:W},le=uU(de),oe=E.useCallback(()=>{if(y==="anchorPosition")return m;const Pe=Sx(n),Fe=(Pe&&Pe.nodeType===1?Pe:$a(ie.current).body).getBoundingClientRect();return{top:Fe.top+mD(Fe,f.vertical),left:Fe.left+gD(Fe,f.horizontal)}},[n,f.horizontal,f.vertical,m,y]),N=E.useCallback(Pe=>({vertical:mD(Pe,U.vertical),horizontal:gD(Pe,U.horizontal)}),[U.horizontal,U.vertical]),ce=E.useCallback(Pe=>{const Be={width:Pe.offsetWidth,height:Pe.offsetHeight},Fe=N(Be);if(y==="none")return{top:null,left:null,transformOrigin:yD(Fe)};const Ge=oe();let Oe=Ge.top-Fe.vertical,mt=Ge.left-Fe.horizontal;const qe=Oe+Be.height,Ae=mt+Be.width,te=Fc(Sx(n)),pe=te.innerHeight-I,J=te.innerWidth-I;if(I!==null&&Oe<I){const fe=Oe-I;Oe-=fe,Fe.vertical+=fe}else if(I!==null&&qe>pe){const fe=qe-pe;Oe-=fe,Fe.vertical+=fe}if(I!==null&&mt<I){const fe=mt-I;mt-=fe,Fe.horizontal+=fe}else if(Ae>J){const fe=Ae-J;mt-=fe,Fe.horizontal+=fe}return{top:`${Math.round(Oe)}px`,left:`${Math.round(mt)}px`,transformOrigin:yD(Fe)}},[n,y,oe,N,I]),[ne,Se]=E.useState(M),se=E.useCallback(()=>{const Pe=ie.current;if(!Pe)return;const Be=ce(Pe);Be.top!==null&&Pe.style.setProperty("top",Be.top),Be.left!==null&&(Pe.style.left=Be.left),Pe.style.transformOrigin=Be.transformOrigin,Se(!0)},[ce]);E.useEffect(()=>(X&&window.addEventListener("scroll",se),()=>window.removeEventListener("scroll",se)),[n,X,se]);const ye=()=>{se()},ze=()=>{Se(!1)};E.useEffect(()=>{M&&se()}),E.useImperativeHandle(o,()=>M?{updatePosition:()=>{se()}}:null,[M,se]),E.useEffect(()=>{if(!M)return;const Pe=wC(()=>{se()}),Be=Fc(Sx(n));return Be.addEventListener("resize",Pe),()=>{Pe.clear(),Be.removeEventListener("resize",Pe)}},[n,M,se]);let Re=K;const ve={slots:{transition:H,...O},slotProps:{transition:W,paper:F,...j}},[V,ue]=rr("transition",{elementType:Zm,externalForwardedProps:ve,ownerState:de,getSlotProps:Pe=>({...Pe,onEntering:(Be,Fe)=>{Pe.onEntering?.(Be,Fe),ye()},onExited:Be=>{Pe.onExited?.(Be),ze()}}),additionalProps:{appear:!0,in:M}});K==="auto"&&!V.muiSupportAuto&&(Re=void 0);const Ee=A||(n?$a(Sx(n)).body:void 0),[Ie,{slots:ae,slotProps:be,...Te}]=rr("root",{ref:r,elementType:dU,externalForwardedProps:{...ve,...ee},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:O.backdrop},slotProps:{backdrop:V3(typeof j.backdrop=="function"?j.backdrop(de):j.backdrop,{invisible:!0})},container:Ee,open:M},ownerState:de,className:Ht(le.root,w)}),[tt,je]=rr("paper",{ref:ie,className:le.paper,elementType:CI,externalForwardedProps:ve,shouldForwardComponentProp:!0,additionalProps:{elevation:R,style:ne?void 0:{opacity:0}},ownerState:de});return d.jsx(Ie,{...Te,...!Ym(Ie)&&{slots:ae,slotProps:be,disableScrollLock:X},children:d.jsx(V,{...ue,timeout:Re,children:d.jsx(tt,{...je,children:C})})})});function hU(t){return Cn("MuiMenu",t)}bn("MuiMenu",["root","paper","list"]);const pU={vertical:"top",horizontal:"right"},mU={vertical:"top",horizontal:"left"},gU=t=>{const{classes:e}=t;return pn({root:["root"],paper:["paper"],list:["list"]},hU,e)},yU=nt(fU,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),bU=nt(CI,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),vU=nt(lU,{name:"MuiMenu",slot:"List"})({outline:0}),lp=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiMenu"}),{autoFocus:o=!0,children:n,className:f,disableAutoFocusItem:m=!1,MenuListProps:y={},onClose:C,open:w,PaperProps:A={},PopoverClasses:R,transitionDuration:I="auto",TransitionProps:{onEntering:M,...F}={},variant:O="selectedMenu",slots:j={},slotProps:U={},...H}=a,K=Pi(),W={...a,autoFocus:o,disableAutoFocusItem:m,MenuListProps:y,onEntering:M,PaperProps:A,transitionDuration:I,TransitionProps:F,variant:O},X=gU(W),ee=o&&!m&&w,ie=E.useRef(null),de=(Re,ve)=>{ie.current&&ie.current.adjustStyleForScrollbar(Re,{direction:K?"rtl":"ltr"}),M&&M(Re,ve)},le=Re=>{Re.key==="Tab"&&(Re.preventDefault(),C&&C(Re,"tabKeyDown"))};let oe=-1;E.Children.map(n,(Re,ve)=>{E.isValidElement(Re)&&(Re.props.disabled||(O==="selectedMenu"&&Re.props.selected||oe===-1)&&(oe=ve))});const N={slots:j,slotProps:{list:y,transition:F,paper:A,...U}},ce=no({elementType:j.root,externalSlotProps:U.root,ownerState:W,className:[X.root,f]}),[ne,Se]=rr("paper",{className:X.paper,elementType:bU,externalForwardedProps:N,shouldForwardComponentProp:!0,ownerState:W}),[se,ye]=rr("list",{className:Ht(X.list,y.className),elementType:vU,shouldForwardComponentProp:!0,externalForwardedProps:N,getSlotProps:Re=>({...Re,onKeyDown:ve=>{le(ve),Re.onKeyDown?.(ve)}}),ownerState:W}),ze=typeof N.slotProps.transition=="function"?N.slotProps.transition(W):N.slotProps.transition;return d.jsx(yU,{onClose:C,anchorOrigin:{vertical:"bottom",horizontal:K?"right":"left"},transformOrigin:K?pU:mU,slots:{root:j.root,paper:ne,backdrop:j.backdrop,...j.transition&&{transition:j.transition}},slotProps:{root:ce,paper:Se,backdrop:typeof U.backdrop=="function"?U.backdrop(W):U.backdrop,transition:{...ze,onEntering:(...Re)=>{de(...Re),ze?.onEntering?.(...Re)}}},open:w,ref:r,transitionDuration:I,ownerState:W,...H,classes:R,children:d.jsx(se,{actions:ie,autoFocus:o&&(oe===-1||m),autoFocusItem:ee,variant:O,...ye,children:n})})});function xU(t){return Cn("MuiMenuItem",t)}const dy=bn("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),CU=(t,e)=>{const{ownerState:r}=t;return[e.root,r.dense&&e.dense,r.divider&&e.divider,!r.disableGutters&&e.gutters]},SU=t=>{const{disabled:e,dense:r,divider:a,disableGutters:o,selected:n,classes:f}=t,y=pn({root:["root",r&&"dense",e&&"disabled",!o&&"gutters",a&&"divider",n&&"selected"]},xU,f);return{...f,...y}},wU=nt(Ru,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:CU})(jn(({theme:t})=>({...t.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${dy.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),[`&.${dy.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}},[`&.${dy.selected}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity)}},[`&.${dy.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${dy.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${lD.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${lD.inset}`]:{marginLeft:52},[`& .${Mm.root}`]:{marginTop:0,marginBottom:0},[`& .${Mm.inset}`]:{paddingLeft:36},[`& .${hD.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...t.typography.body2,[`& .${hD.root} svg`]:{fontSize:"1.25rem"}}}]}))),ln=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiMenuItem"}),{autoFocus:o=!1,component:n="li",dense:f=!1,divider:m=!1,disableGutters:y=!1,focusVisibleClassName:C,role:w="menuitem",tabIndex:A,className:R,...I}=a,M=E.useContext(bd),F=E.useMemo(()=>({dense:f||M.dense||!1,disableGutters:y}),[M.dense,f,y]),O=E.useRef(null);ka(()=>{o&&O.current&&O.current.focus()},[o]);const j={...a,dense:F.dense,divider:m,disableGutters:y},U=SU(a),H=ro(O,r);let K;return a.disabled||(K=A!==void 0?A:-1),d.jsx(bd.Provider,{value:F,children:d.jsx(wU,{ref:H,role:w,tabIndex:K,component:n,focusVisibleClassName:Ht(U.focusVisible,C),className:Ht(U.root,R),...I,ownerState:j,classes:U})})});function TU(t){return Cn("MuiNativeSelect",t)}const EA=bn("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),AU=t=>{const{classes:e,variant:r,disabled:a,multiple:o,open:n,error:f}=t,m={select:["select",r,a&&"disabled",o&&"multiple",f&&"error"],icon:["icon",`icon${At(r)}`,n&&"iconOpen",a&&"disabled"]};return pn(m,TU,e)},SI=nt("select",{name:"MuiNativeSelect"})(({theme:t})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${EA.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:({ownerState:e})=>e.variant!=="filled"&&e.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]})),EU=nt(SI,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:si,overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.select,e[r.variant],r.error&&e.error,{[`&.${EA.multiple}`]:e.multiple}]}})({}),wI=nt("svg",{name:"MuiNativeSelect"})(({theme:t})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${EA.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),kU=nt(wI,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${At(r.variant)}`],r.open&&e.iconOpen]}})({}),DU=E.forwardRef(function(e,r){const{className:a,disabled:o,error:n,IconComponent:f,inputRef:m,variant:y="standard",...C}=e,w={...e,disabled:o,variant:y,error:n},A=AU(w);return d.jsxs(E.Fragment,{children:[d.jsx(EU,{ownerState:w,className:Ht(A.select,a),disabled:o,ref:m||r,...C}),e.multiple?null:d.jsx(kU,{as:f,ownerState:w,className:A.icon})]})});var bD;const RU=nt("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:si})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),IU=nt("legend",{name:"MuiNotchedOutlined",shouldForwardProp:si})(jn(({theme:t})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]})));function PU(t){const{children:e,classes:r,className:a,label:o,notched:n,...f}=t,m=o!=null&&o!=="",y={...t,notched:n,withLabel:m};return d.jsx(RU,{"aria-hidden":!0,className:a,ownerState:y,...f,children:d.jsx(IU,{ownerState:y,children:m?d.jsx("span",{children:o}):bD||(bD=d.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const MU=t=>{const{classes:e}=t,a=pn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},h9,e);return{...e,...a}},_U=nt(RC,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:kC})(jn(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${$l.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${$l.notchedOutline}`]:{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}},[`&.${$l.focused} .${$l.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(Go()).map(([r])=>({props:{color:r},style:{[`&.${$l.focused} .${$l.notchedOutline}`]:{borderColor:(t.vars||t).palette[r].main}}})),{props:{},style:{[`&.${$l.error} .${$l.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${$l.disabled} .${$l.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:14}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:14}},{props:({ownerState:r})=>r.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:r,size:a})=>r.multiline&&a==="small",style:{padding:"8.5px 14px"}}]}})),OU=nt(PU,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(jn(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}})),FU=nt(IC,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:DC})(jn(({theme:t})=>({padding:"16.5px 14px",...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),kA=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiOutlinedInput"}),{components:o={},fullWidth:n=!1,inputComponent:f="input",label:m,multiline:y=!1,notched:C,slots:w={},slotProps:A={},type:R="text",...I}=a,M=MU(a),F=Al(),O=Hf({props:a,muiFormControl:F,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),j={...a,color:O.color||"primary",disabled:O.disabled,error:O.error,focused:O.focused,formControl:F,fullWidth:n,hiddenLabel:O.hiddenLabel,multiline:y,size:O.size,type:R},U=w.root??o.Root??_U,H=w.input??o.Input??FU,[K,W]=rr("notchedOutline",{elementType:OU,className:M.notchedOutline,shouldForwardComponentProp:!0,ownerState:j,externalForwardedProps:{slots:w,slotProps:A},additionalProps:{label:m!=null&&m!==""&&O.required?d.jsxs(E.Fragment,{children:[m,"","*"]}):m}});return d.jsx(CA,{slots:{root:U,input:H},slotProps:A,renderSuffix:X=>d.jsx(K,{...W,notched:typeof C<"u"?C:!!(X.startAdornment||X.filled||X.focused)}),fullWidth:n,inputComponent:f,multiline:y,ref:r,type:R,...I,classes:{...M,notchedOutline:null}})});kA.muiName="Input";const NU=dr(d.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),jU=dr(d.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),LU=nt("span",{name:"MuiRadioButtonIcon",shouldForwardProp:si})({position:"relative",display:"flex"}),BU=nt(NU,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),zU=nt(jU,{name:"MuiRadioButtonIcon"})(jn(({theme:t})=>({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}}]})));function TI(t){const{checked:e=!1,classes:r={},fontSize:a}=t,o={...t,checked:e};return d.jsxs(LU,{className:r.root,ownerState:o,children:[d.jsx(BU,{fontSize:a,className:r.background,ownerState:o}),d.jsx(zU,{fontSize:a,className:r.dot,ownerState:o})]})}const AI=E.createContext(void 0);function UU(){return E.useContext(AI)}function $U(t){return Cn("MuiRadio",t)}const vD=bn("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),HU=t=>{const{classes:e,color:r,size:a}=t,o={root:["root",`color${At(r)}`,a!=="medium"&&`size${At(a)}`]};return{...e,...pn(o,$U,e)}},WU=nt(SA,{shouldForwardProp:t=>si(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.size!=="medium"&&e[`size${At(r.size)}`],e[`color${At(r.color)}`]]}})(jn(({theme:t})=>({color:(t.vars||t).palette.text.secondary,[`&.${vD.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${vD.checked}`]:{color:(t.vars||t).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function VU(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}const GU=d.jsx(TI,{checked:!0}),KU=d.jsx(TI,{}),xD=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiRadio"}),{checked:o,checkedIcon:n=GU,color:f="primary",icon:m=KU,name:y,onChange:C,size:w="medium",className:A,disabled:R,disableRipple:I=!1,slots:M={},slotProps:F={},inputProps:O,...j}=a,U=Al();let H=R;U&&typeof H>"u"&&(H=U.disabled),H??=!1;const K={...a,disabled:H,disableRipple:I,color:f,size:w},W=HU(K),X=UU();let ee=o;const ie=Ww(C,X&&X.onChange);let de=y;X&&(typeof ee>"u"&&(ee=VU(X.value,a.value)),typeof de>"u"&&(de=X.name));const le=F.input??O,[oe,N]=rr("root",{ref:r,elementType:WU,className:Ht(W.root,A),shouldForwardComponentProp:!0,externalForwardedProps:{slots:M,slotProps:F,...j},getSlotProps:ce=>({...ce,onChange:(ne,...Se)=>{ce.onChange?.(ne,...Se),ie(ne,...Se)}}),ownerState:K,additionalProps:{type:"radio",icon:E.cloneElement(m,{fontSize:m.props.fontSize??w}),checkedIcon:E.cloneElement(n,{fontSize:n.props.fontSize??w}),disabled:H,name:de,checked:ee,slots:M,slotProps:{input:typeof le=="function"?le(K):le}}});return d.jsx(oe,{...N,classes:W})});function YU(t){return Cn("MuiRadioGroup",t)}bn("MuiRadioGroup",["root","row","error"]);const qU=t=>{const{classes:e,row:r,error:a}=t;return pn({root:["root",r&&"row",a&&"error"]},YU,e)},QU=E.forwardRef(function(e,r){const{actions:a,children:o,className:n,defaultValue:f,name:m,onChange:y,value:C,...w}=e,A=E.useRef(null),R=qU(e),[I,M]=Ki({controlled:C,default:f,name:"RadioGroup"});E.useImperativeHandle(a,()=>({focus:()=>{let U=A.current.querySelector("input:not(:disabled):checked");U||(U=A.current.querySelector("input:not(:disabled)")),U&&U.focus()}}),[]);const F=ro(r,A),O=nc(m),j=E.useMemo(()=>({name:O,onChange(U){M(U.target.value),y&&y(U,U.target.value)},value:I}),[O,y,M,I]);return d.jsx(AI.Provider,{value:j,children:d.jsx(hz,{role:"radiogroup",ref:F,className:Ht(R.root,n),...w,children:o})})}),XU={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function EI(t){return Cn("MuiSelect",t)}const fy=bn("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var CD;const JU=nt(SI,{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`&.${fy.select}`]:e.select},{[`&.${fy.select}`]:e[r.variant]},{[`&.${fy.error}`]:e.error},{[`&.${fy.multiple}`]:e.multiple}]}})({[`&.${fy.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),ZU=nt(wI,{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.icon,r.variant&&e[`icon${At(r.variant)}`],r.open&&e.iconOpen]}})({}),e$=nt("input",{shouldForwardProp:t=>W3(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function SD(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function t$(t){return t==null||typeof t=="string"&&!t.trim()}const n$=t=>{const{classes:e,variant:r,disabled:a,multiple:o,open:n,error:f}=t,m={select:["select",r,a&&"disabled",o&&"multiple",f&&"error"],icon:["icon",`icon${At(r)}`,n&&"iconOpen",a&&"disabled"],nativeInput:["nativeInput"]};return pn(m,EI,e)},r$=E.forwardRef(function(e,r){const{"aria-describedby":a,"aria-label":o,autoFocus:n,autoWidth:f,children:m,className:y,defaultOpen:C,defaultValue:w,disabled:A,displayEmpty:R,error:I=!1,IconComponent:M,inputRef:F,labelId:O,MenuProps:j={},multiple:U,name:H,onBlur:K,onChange:W,onClose:X,onFocus:ee,onKeyDown:ie,onMouseDown:de,onOpen:le,open:oe,readOnly:N,renderValue:ce,required:ne,SelectDisplayProps:Se={},tabIndex:se,type:ye,value:ze,variant:Re="standard",...ve}=e,[V,ue]=Ki({controlled:ze,default:w,name:"Select"}),[Ee,Ie]=Ki({controlled:oe,default:C,name:"Select"}),ae=E.useRef(null),be=E.useRef(null),[Te,tt]=E.useState(null),{current:je}=E.useRef(oe!=null),[Pe,Be]=E.useState(),Fe=ro(r,F),Ge=E.useCallback(at=>{be.current=at,at&&tt(at)},[]),Oe=Te?.parentNode;E.useImperativeHandle(Fe,()=>({focus:()=>{be.current.focus()},node:ae.current,value:V}),[V]),E.useEffect(()=>{C&&Ee&&Te&&!je&&(Be(f?null:Oe.clientWidth),be.current.focus())},[Te,f]),E.useEffect(()=>{n&&be.current.focus()},[n]),E.useEffect(()=>{if(!O)return;const at=$a(be.current).getElementById(O);if(at){const Et=()=>{getSelection().isCollapsed&&be.current.focus()};return at.addEventListener("click",Et),()=>{at.removeEventListener("click",Et)}}},[O]);const mt=(at,Et)=>{at?le&&le(Et):X&&X(Et),je||(Be(f?null:Oe.clientWidth),Ie(at))},qe=at=>{de?.(at),at.button===0&&(at.preventDefault(),be.current.focus(),mt(!0,at))},Ae=at=>{mt(!1,at)},te=E.Children.toArray(m),pe=at=>{const Et=te.find(qt=>qt.props.value===at.target.value);Et!==void 0&&(ue(Et.props.value),W&&W(at,Et))},J=at=>Et=>{let qt;if(Et.currentTarget.hasAttribute("tabindex")){if(U){qt=Array.isArray(V)?V.slice():[];const gn=V.indexOf(at.props.value);gn===-1?qt.push(at.props.value):qt.splice(gn,1)}else qt=at.props.value;if(at.props.onClick&&at.props.onClick(Et),V!==qt&&(ue(qt),W)){const gn=Et.nativeEvent||Et,Sn=new gn.constructor(gn.type,gn);Object.defineProperty(Sn,"target",{writable:!0,value:{value:qt,name:H}}),W(Sn,at)}U||mt(!1,Et)}},fe=at=>{N||([" ","ArrowUp","ArrowDown","Enter"].includes(at.key)&&(at.preventDefault(),mt(!0,at)),ie?.(at))},xe=Te!==null&&Ee,Ne=at=>{!xe&&K&&(Object.defineProperty(at,"target",{writable:!0,value:{value:V,name:H}}),K(at))};delete ve["aria-invalid"];let Me,Ve;const Qe=[];let rt=!1;(S2({value:V})||R)&&(ce?Me=ce(V):rt=!0);const st=te.map(at=>{if(!E.isValidElement(at))return null;let Et;if(U){if(!Array.isArray(V))throw new Error(xd(2));Et=V.some(qt=>SD(qt,at.props.value)),Et&&rt&&Qe.push(at.props.children)}else Et=SD(V,at.props.value),Et&&rt&&(Ve=at.props.children);return E.cloneElement(at,{"aria-selected":Et?"true":"false",onClick:J(at),onKeyUp:qt=>{qt.key===" "&&qt.preventDefault(),at.props.onKeyUp&&at.props.onKeyUp(qt)},role:"option",selected:Et,value:void 0,"data-value":at.props.value})});rt&&(U?Qe.length===0?Me=null:Me=Qe.reduce((at,Et,qt)=>(at.push(Et),qt<Qe.length-1&&at.push(", "),at),[]):Me=Ve);let it=Pe;!f&&je&&Te&&(it=Oe.clientWidth);let xt;typeof se<"u"?xt=se:xt=A?null:0;const pt=Se.id||(H?`mui-component-select-${H}`:void 0),Yt={...e,variant:Re,value:V,open:xe,error:I},Kt=n$(Yt),tn={...j.PaperProps,...typeof j.slotProps?.paper=="function"?j.slotProps.paper(Yt):j.slotProps?.paper},Wt={...j.MenuListProps,...typeof j.slotProps?.list=="function"?j.slotProps.list(Yt):j.slotProps?.list},_t=nc();return d.jsxs(E.Fragment,{children:[d.jsx(JU,{as:"div",ref:Ge,tabIndex:xt,role:"combobox","aria-controls":xe?_t:void 0,"aria-disabled":A?"true":void 0,"aria-expanded":xe?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[O,pt].filter(Boolean).join(" ")||void 0,"aria-describedby":a,"aria-required":ne?"true":void 0,"aria-invalid":I?"true":void 0,onKeyDown:fe,onMouseDown:A||N?null:qe,onBlur:Ne,onFocus:ee,...Se,ownerState:Yt,className:Ht(Se.className,Kt.select,y),id:pt,children:t$(Me)?CD||(CD=d.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):Me}),d.jsx(e$,{"aria-invalid":I,value:Array.isArray(V)?V.join(","):V,name:H,ref:ae,"aria-hidden":!0,onChange:pe,tabIndex:-1,disabled:A,className:Kt.nativeInput,autoFocus:n,required:ne,...ve,ownerState:Yt}),d.jsx(ZU,{as:M,className:Kt.icon,ownerState:Yt}),d.jsx(lp,{id:`menu-${H||""}`,anchorEl:Oe,open:xe,onClose:Ae,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...j,slotProps:{...j.slotProps,list:{"aria-labelledby":O,role:"listbox","aria-multiselectable":U?"true":void 0,disableListWrap:!0,id:_t,...Wt},paper:{...tn,style:{minWidth:it,...tn!=null?tn.style:null}}},children:st})]})}),o$=t=>{const{classes:e}=t,a=pn({root:["root"]},EI,e);return{...e,...a}},DA={name:"MuiSelect",slot:"Root",shouldForwardProp:t=>si(t)&&t!=="variant"},a$=nt(TA,DA)(""),s$=nt(kA,DA)(""),i$=nt(wA,DA)(""),Wr=E.forwardRef(function(e,r){const a=Wn({name:"MuiSelect",props:e}),{autoWidth:o=!1,children:n,classes:f={},className:m,defaultOpen:y=!1,displayEmpty:C=!1,IconComponent:w=cI,id:A,input:R,inputProps:I,label:M,labelId:F,MenuProps:O,multiple:j=!1,native:U=!1,onClose:H,onOpen:K,open:W,renderValue:X,SelectDisplayProps:ee,variant:ie="outlined",...de}=a,le=U?DU:r$,oe=Al(),N=Hf({props:a,muiFormControl:oe,states:["variant","error"]}),ce=N.variant||ie,ne={...a,variant:ce,classes:f},Se=o$(ne),{root:se,...ye}=Se,ze=R||{standard:d.jsx(a$,{ownerState:ne}),outlined:d.jsx(s$,{label:M,ownerState:ne}),filled:d.jsx(i$,{ownerState:ne})}[ce],Re=ro(r,Dp(ze));return d.jsx(E.Fragment,{children:E.cloneElement(ze,{inputComponent:le,inputProps:{children:n,error:N.error,IconComponent:w,variant:ce,type:void 0,multiple:j,...U?{id:A}:{autoWidth:o,defaultOpen:y,displayEmpty:C,labelId:F,MenuProps:O,onClose:H,onOpen:K,open:W,renderValue:X,SelectDisplayProps:{id:A,...ee}},...I,classes:I?ri(ye,I.classes):ye,...R?R.props.inputProps:{}},...(j&&U||C)&&ce==="outlined"?{notched:!0}:{},ref:Re,className:Ht(ze.props.className,m,Se.root),...!R&&{variant:ce},...de})})});Wr.muiName="Select";function l$(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:r=!1,onClose:a,open:o,resumeHideDuration:n}=t,f=xl();E.useEffect(()=>{if(!o)return;function j(U){U.defaultPrevented||U.key==="Escape"&&a?.(U,"escapeKeyDown")}return document.addEventListener("keydown",j),()=>{document.removeEventListener("keydown",j)}},[o,a]);const m=yn((j,U)=>{a?.(j,U)}),y=yn(j=>{!a||j==null||f.start(j,()=>{m(null,"timeout")})});E.useEffect(()=>(o&&y(e),f.clear),[o,e,y,f]);const C=j=>{a?.(j,"clickaway")},w=f.clear,A=E.useCallback(()=>{e!=null&&y(n??e*.5)},[e,n,y]),R=j=>U=>{const H=j.onBlur;H?.(U),A()},I=j=>U=>{const H=j.onFocus;H?.(U),w()},M=j=>U=>{const H=j.onMouseEnter;H?.(U),w()},F=j=>U=>{const H=j.onMouseLeave;H?.(U),A()};return E.useEffect(()=>{if(!r&&o)return window.addEventListener("focus",A),window.addEventListener("blur",w),()=>{window.removeEventListener("focus",A),window.removeEventListener("blur",w)}},[r,o,A,w]),{getRootProps:(j={})=>{const U={...b2(t),...b2(j)};return{role:"presentation",...j,...U,onBlur:R(U),onFocus:I(U),onMouseEnter:M(U),onMouseLeave:F(U)}},onClickAway:C}}function c$(t){return Cn("MuiSnackbarContent",t)}bn("MuiSnackbarContent",["root","message","action"]);const u$=t=>{const{classes:e}=t;return pn({root:["root"],action:["action"],message:["message"]},c$,e)},d$=nt(ua,{name:"MuiSnackbarContent",slot:"Root"})(jn(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98;return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(zw(t.palette.background.default,e)),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:zw(t.palette.background.default,e),display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),f$=nt("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),h$=nt("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),p$=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiSnackbarContent"}),{action:o,className:n,message:f,role:m="alert",...y}=a,C=a,w=u$(C);return d.jsxs(d$,{role:m,elevation:6,className:Ht(w.root,n),ownerState:C,ref:r,...y,children:[d.jsx(f$,{className:w.message,ownerState:C,children:f}),o?d.jsx(h$,{className:w.action,ownerState:C,children:o}):null]})});function m$(t){return Cn("MuiSnackbar",t)}bn("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const g$=t=>{const{classes:e,anchorOrigin:r}=t,a={root:["root",`anchorOrigin${At(r.vertical)}${At(r.horizontal)}`]};return pn(a,m$,e)},y$=nt("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`anchorOrigin${At(r.anchorOrigin.vertical)}${At(r.anchorOrigin.horizontal)}`]]}})(jn(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:e})=>e.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:e})=>e.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),Wf=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiSnackbar"}),o=kd(),n={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{action:f,anchorOrigin:{vertical:m,horizontal:y}={vertical:"bottom",horizontal:"left"},autoHideDuration:C=null,children:w,className:A,ClickAwayListenerProps:R,ContentProps:I,disableWindowBlurListener:M=!1,message:F,onBlur:O,onClose:j,onFocus:U,onMouseEnter:H,onMouseLeave:K,open:W,resumeHideDuration:X,slots:ee={},slotProps:ie={},TransitionComponent:de,transitionDuration:le=n,TransitionProps:{onEnter:oe,onExited:N,...ce}={},...ne}=a,Se={...a,anchorOrigin:{vertical:m,horizontal:y},autoHideDuration:C,disableWindowBlurListener:M,TransitionComponent:de,transitionDuration:le},se=g$(Se),{getRootProps:ye,onClickAway:ze}=l$(Se),[Re,ve]=E.useState(!0),V=Ge=>{ve(!0),N&&N(Ge)},ue=(Ge,Oe)=>{ve(!1),oe&&oe(Ge,Oe)},Ee={slots:{transition:de,...ee},slotProps:{content:I,clickAwayListener:R,transition:ce,...ie}},[Ie,ae]=rr("root",{ref:r,className:[se.root,A],elementType:y$,getSlotProps:ye,externalForwardedProps:{...Ee,...ne},ownerState:Se}),[be,{ownerState:Te,...tt}]=rr("clickAwayListener",{elementType:uB,externalForwardedProps:Ee,getSlotProps:Ge=>({onClickAway:(...Oe)=>{const mt=Oe[0];Ge.onClickAway?.(...Oe),!mt?.defaultMuiPrevented&&ze(...Oe)}}),ownerState:Se}),[je,Pe]=rr("content",{elementType:p$,shouldForwardComponentProp:!0,externalForwardedProps:Ee,additionalProps:{message:F,action:f},ownerState:Se}),[Be,Fe]=rr("transition",{elementType:Zm,externalForwardedProps:Ee,getSlotProps:Ge=>({onEnter:(...Oe)=>{Ge.onEnter?.(...Oe),ue(...Oe)},onExited:(...Oe)=>{Ge.onExited?.(...Oe),V(...Oe)}}),additionalProps:{appear:!0,in:W,timeout:le,direction:m==="top"?"down":"up"},ownerState:Se});return!W&&Re?null:d.jsx(be,{...tt,...ee.clickAwayListener&&{ownerState:Te},children:d.jsx(Ie,{...ae,children:d.jsx(Be,{...Fe,children:w||d.jsx(je,{...Pe})})})})});function b$(t){return Cn("MuiTooltip",t)}const La=bn("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function v$(t){return Math.round(t*1e5)/1e5}const x$=t=>{const{classes:e,disableInteractive:r,arrow:a,touch:o,placement:n}=t,f={popper:["popper",!r&&"popperInteractive",a&&"popperArrow"],tooltip:["tooltip",a&&"tooltipArrow",o&&"touch",`tooltipPlacement${At(n.split("-")[0])}`],arrow:["arrow"]};return pn(f,b$,e)},C$=nt(wb,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popper,!r.disableInteractive&&e.popperInteractive,r.arrow&&e.popperArrow,!r.open&&e.popperClose]}})(jn(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${La.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${La.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${La.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${La.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${La.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${La.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${La.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${La.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),S$=nt("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.tooltip,r.touch&&e.touch,r.arrow&&e.tooltipArrow,e[`tooltipPlacement${At(r.placement.split("-")[0])}`]]}})(jn(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${La.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${La.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${La.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${La.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${v$(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${La.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${La.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${La.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${La.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${La.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${La.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${La.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${La.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${La.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${La.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),w$=nt("span",{name:"MuiTooltip",slot:"Arrow"})(jn(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let wx=!1;const wD=new TC;let hy={x:0,y:0};function Tx(t,e){return(r,...a)=>{e&&e(r,...a),t(r,...a)}}const Mo=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTooltip"}),{arrow:o=!1,children:n,classes:f,components:m={},componentsProps:y={},describeChild:C=!1,disableFocusListener:w=!1,disableHoverListener:A=!1,disableInteractive:R=!1,disableTouchListener:I=!1,enterDelay:M=100,enterNextDelay:F=0,enterTouchDelay:O=700,followCursor:j=!1,id:U,leaveDelay:H=0,leaveTouchDelay:K=1500,onClose:W,onOpen:X,open:ee,placement:ie="bottom",PopperComponent:de,PopperProps:le={},slotProps:oe={},slots:N={},title:ce,TransitionComponent:ne,TransitionProps:Se,...se}=a,ye=E.isValidElement(n)?n:d.jsx("span",{children:n}),ze=kd(),Re=Pi(),[ve,V]=E.useState(),[ue,Ee]=E.useState(null),Ie=E.useRef(!1),ae=R||j,be=xl(),Te=xl(),tt=xl(),je=xl(),[Pe,Be]=Ki({controlled:ee,default:!1,name:"Tooltip",state:"open"});let Fe=Pe;const Ge=nc(U),Oe=E.useRef(),mt=yn(()=>{Oe.current!==void 0&&(document.body.style.WebkitUserSelect=Oe.current,Oe.current=void 0),je.clear()});E.useEffect(()=>mt,[mt]);const qe=Bt=>{wD.clear(),wx=!0,Be(!0),X&&!Fe&&X(Bt)},Ae=yn(Bt=>{wD.start(800+H,()=>{wx=!1}),Be(!1),W&&Fe&&W(Bt),be.start(ze.transitions.duration.shortest,()=>{Ie.current=!1})}),te=Bt=>{Ie.current&&Bt.type!=="touchstart"||(ve&&ve.removeAttribute("title"),Te.clear(),tt.clear(),M||wx&&F?Te.start(wx?F:M,()=>{qe(Bt)}):qe(Bt))},pe=Bt=>{Te.clear(),tt.start(H,()=>{Ae(Bt)})},[,J]=E.useState(!1),fe=Bt=>{v2(Bt.target)||(J(!1),pe(Bt))},xe=Bt=>{ve||V(Bt.currentTarget),v2(Bt.target)&&(J(!0),te(Bt))},Ne=Bt=>{Ie.current=!0;const gr=ye.props;gr.onTouchStart&&gr.onTouchStart(Bt)},Me=Bt=>{Ne(Bt),tt.clear(),be.clear(),mt(),Oe.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",je.start(O,()=>{document.body.style.WebkitUserSelect=Oe.current,te(Bt)})},Ve=Bt=>{ye.props.onTouchEnd&&ye.props.onTouchEnd(Bt),mt(),tt.start(K,()=>{Ae(Bt)})};E.useEffect(()=>{if(!Fe)return;function Bt(gr){gr.key==="Escape"&&Ae(gr)}return document.addEventListener("keydown",Bt),()=>{document.removeEventListener("keydown",Bt)}},[Ae,Fe]);const Qe=ro(Dp(ye),V,r);!ce&&ce!==0&&(Fe=!1);const rt=E.useRef(),st=Bt=>{const gr=ye.props;gr.onMouseMove&&gr.onMouseMove(Bt),hy={x:Bt.clientX,y:Bt.clientY},rt.current&&rt.current.update()},it={},xt=typeof ce=="string";C?(it.title=!Fe&&xt&&!A?ce:null,it["aria-describedby"]=Fe?Ge:null):(it["aria-label"]=xt?ce:null,it["aria-labelledby"]=Fe&&!xt?Ge:null);const pt={...it,...se,...ye.props,className:Ht(se.className,ye.props.className),onTouchStart:Ne,ref:Qe,...j?{onMouseMove:st}:{}},Yt={};I||(pt.onTouchStart=Me,pt.onTouchEnd=Ve),A||(pt.onMouseOver=Tx(te,pt.onMouseOver),pt.onMouseLeave=Tx(pe,pt.onMouseLeave),ae||(Yt.onMouseOver=te,Yt.onMouseLeave=pe)),w||(pt.onFocus=Tx(xe,pt.onFocus),pt.onBlur=Tx(fe,pt.onBlur),ae||(Yt.onFocus=xe,Yt.onBlur=fe));const Kt={...a,isRtl:Re,arrow:o,disableInteractive:ae,placement:ie,PopperComponentProp:de,touch:Ie.current},tn=typeof oe.popper=="function"?oe.popper(Kt):oe.popper,Wt=E.useMemo(()=>{let Bt=[{name:"arrow",enabled:!!ue,options:{element:ue,padding:4}}];return le.popperOptions?.modifiers&&(Bt=Bt.concat(le.popperOptions.modifiers)),tn?.popperOptions?.modifiers&&(Bt=Bt.concat(tn.popperOptions.modifiers)),{...le.popperOptions,...tn?.popperOptions,modifiers:Bt}},[ue,le.popperOptions,tn?.popperOptions]),_t=x$(Kt),at=typeof oe.transition=="function"?oe.transition(Kt):oe.transition,Et={slots:{popper:m.Popper,transition:m.Transition??ne,tooltip:m.Tooltip,arrow:m.Arrow,...N},slotProps:{arrow:oe.arrow??y.arrow,popper:{...le,...tn??y.popper},tooltip:oe.tooltip??y.tooltip,transition:{...Se,...at??y.transition}}},[qt,gn]=rr("popper",{elementType:C$,externalForwardedProps:Et,ownerState:Kt,className:Ht(_t.popper,le?.className)}),[Sn,Zt]=rr("transition",{elementType:Zm,externalForwardedProps:Et,ownerState:Kt}),[Kn,$t]=rr("tooltip",{elementType:S$,className:_t.tooltip,externalForwardedProps:Et,ownerState:Kt}),[Cr,tr]=rr("arrow",{elementType:w$,className:_t.arrow,externalForwardedProps:Et,ownerState:Kt,ref:Ee});return d.jsxs(E.Fragment,{children:[E.cloneElement(ye,pt),d.jsx(qt,{as:de??wb,placement:ie,anchorEl:j?{getBoundingClientRect:()=>({top:hy.y,left:hy.x,right:hy.x,bottom:hy.y,width:0,height:0})}:ve,popperRef:rt,open:ve?Fe:!1,id:Ge,transition:!0,...Yt,...gn,popperOptions:Wt,children:({TransitionProps:Bt})=>d.jsx(Sn,{timeout:ze.transitions.duration.shorter,...Bt,...Zt,children:d.jsxs(Kn,{...$t,children:[ce,o?d.jsx(Cr,{...tr}):null]})})})]})});function T$(t){return Cn("MuiSwitch",t)}const Si=bn("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),A$=t=>{const{classes:e,edge:r,size:a,color:o,checked:n,disabled:f}=t,m={root:["root",r&&`edge${At(r)}`,`size${At(a)}`],switchBase:["switchBase",`color${At(o)}`,n&&"checked",f&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},y=pn(m,T$,e);return{...e,...y}},E$=nt("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.edge&&e[`edge${At(r.edge)}`],e[`size${At(r.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${Si.thumb}`]:{width:16,height:16},[`& .${Si.switchBase}`]:{padding:4,[`&.${Si.checked}`]:{transform:"translateX(16px)"}}}}]}),k$=nt(SA,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.switchBase,{[`& .${Si.input}`]:e.input},r.color!=="default"&&e[`color${At(r.color)}`]]}})(jn(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${Si.checked}`]:{transform:"translateX(20px)"},[`&.${Si.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${Si.checked} + .${Si.track}`]:{opacity:.5},[`&.${Si.disabled} + .${Si.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${Si.input}`]:{left:"-100%",width:"300%"}})),jn(({theme:t})=>({"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(Go(["light"])).map(([e])=>({props:{color:e},style:{[`&.${Si.checked}`]:{color:(t.vars||t).palette[e].main,"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Si.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${e}DisabledColor`]:`${t.palette.mode==="light"?t.lighten(t.palette[e].main,.62):t.darken(t.palette[e].main,.55)}`}},[`&.${Si.checked} + .${Si.track}`]:{backgroundColor:(t.vars||t).palette[e].main}}}))]}))),D$=nt("span",{name:"MuiSwitch",slot:"Track"})(jn(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`}))),R$=nt("span",{name:"MuiSwitch",slot:"Thumb"})(jn(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),I$=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiSwitch"}),{className:o,color:n="primary",edge:f=!1,size:m="medium",sx:y,slots:C={},slotProps:w={},...A}=a,R={...a,color:n,edge:f,size:m},I=A$(R),M={slots:C,slotProps:w},[F,O]=rr("root",{className:Ht(I.root,o),elementType:E$,externalForwardedProps:M,ownerState:R,additionalProps:{sx:y}}),[j,U]=rr("thumb",{className:I.thumb,elementType:R$,externalForwardedProps:M,ownerState:R}),H=d.jsx(j,{...U}),[K,W]=rr("track",{className:I.track,elementType:D$,externalForwardedProps:M,ownerState:R});return d.jsxs(F,{...O,children:[d.jsx(k$,{type:"checkbox",icon:H,checkedIcon:H,ref:r,ownerState:R,...A,classes:{...I,root:I.switchBase},slots:{...C.switchBase&&{root:C.switchBase},...C.input&&{input:C.input}},slotProps:{...w.switchBase&&{root:typeof w.switchBase=="function"?w.switchBase(R):w.switchBase},input:{role:"switch"},...w.input&&{input:typeof w.input=="function"?w.input(R):w.input}}}),d.jsx(K,{...W})]})});function P$(t){return Cn("MuiTab",t)}const zl=bn("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper","icon"]),M$=t=>{const{classes:e,textColor:r,fullWidth:a,wrapped:o,icon:n,label:f,selected:m,disabled:y}=t,C={root:["root",n&&f&&"labelIcon",`textColor${At(r)}`,a&&"fullWidth",o&&"wrapped",m&&"selected",y&&"disabled"],icon:["iconWrapper","icon"]};return pn(C,P$,e)},_$=nt(Ru,{name:"MuiTab",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.label&&r.icon&&e.labelIcon,e[`textColor${At(r.textColor)}`],r.fullWidth&&e.fullWidth,r.wrapped&&e.wrapped,{[`& .${zl.iconWrapper}`]:e.iconWrapper},{[`& .${zl.icon}`]:e.icon}]}})(jn(({theme:t})=>({...t.typography.button,maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center",lineHeight:1.25,variants:[{props:({ownerState:e})=>e.label&&(e.iconPosition==="top"||e.iconPosition==="bottom"),style:{flexDirection:"column"}},{props:({ownerState:e})=>e.label&&e.iconPosition!=="top"&&e.iconPosition!=="bottom",style:{flexDirection:"row"}},{props:({ownerState:e})=>e.icon&&e.label,style:{minHeight:72,paddingTop:9,paddingBottom:9}},{props:({ownerState:e,iconPosition:r})=>e.icon&&e.label&&r==="top",style:{[`& > .${zl.icon}`]:{marginBottom:6}}},{props:({ownerState:e,iconPosition:r})=>e.icon&&e.label&&r==="bottom",style:{[`& > .${zl.icon}`]:{marginTop:6}}},{props:({ownerState:e,iconPosition:r})=>e.icon&&e.label&&r==="start",style:{[`& > .${zl.icon}`]:{marginRight:t.spacing(1)}}},{props:({ownerState:e,iconPosition:r})=>e.icon&&e.label&&r==="end",style:{[`& > .${zl.icon}`]:{marginLeft:t.spacing(1)}}},{props:{textColor:"inherit"},style:{color:"inherit",opacity:.6,[`&.${zl.selected}`]:{opacity:1},[`&.${zl.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}}},{props:{textColor:"primary"},style:{color:(t.vars||t).palette.text.secondary,[`&.${zl.selected}`]:{color:(t.vars||t).palette.primary.main},[`&.${zl.disabled}`]:{color:(t.vars||t).palette.text.disabled}}},{props:{textColor:"secondary"},style:{color:(t.vars||t).palette.text.secondary,[`&.${zl.selected}`]:{color:(t.vars||t).palette.secondary.main},[`&.${zl.disabled}`]:{color:(t.vars||t).palette.text.disabled}}},{props:({ownerState:e})=>e.fullWidth,style:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"}},{props:({ownerState:e})=>e.wrapped,style:{fontSize:t.typography.pxToRem(12)}}]}))),Cm=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTab"}),{className:o,disabled:n=!1,disableFocusRipple:f=!1,fullWidth:m,icon:y,iconPosition:C="top",indicator:w,label:A,onChange:R,onClick:I,onFocus:M,selected:F,selectionFollowsFocus:O,textColor:j="inherit",value:U,wrapped:H=!1,...K}=a,W={...a,disabled:n,disableFocusRipple:f,selected:F,icon:!!y,iconPosition:C,label:!!A,fullWidth:m,textColor:j,wrapped:H},X=M$(W),ee=y&&A&&E.isValidElement(y)?E.cloneElement(y,{className:Ht(X.icon,y.props.className)}):y,ie=le=>{!F&&R&&R(le,U),I&&I(le)},de=le=>{O&&!F&&R&&R(le,U),M&&M(le)};return d.jsxs(_$,{focusRipple:!f,className:Ht(X.root,o),ref:r,role:"tab","aria-selected":F,disabled:n,onClick:ie,onFocus:de,ownerState:W,tabIndex:F?0:-1,...K,children:[C==="top"||C==="start"?d.jsxs(E.Fragment,{children:[ee,A]}):d.jsxs(E.Fragment,{children:[A,ee]}),w]})}),kI=E.createContext();function O$(t){return Cn("MuiTable",t)}bn("MuiTable",["root","stickyHeader"]);const F$=t=>{const{classes:e,stickyHeader:r}=t;return pn({root:["root",r&&"stickyHeader"]},O$,e)},N$=nt("table",{name:"MuiTable",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.stickyHeader&&e.stickyHeader]}})(jn(({theme:t})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...t.typography.body2,padding:t.spacing(2),color:(t.vars||t).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:e})=>e.stickyHeader,style:{borderCollapse:"separate"}}]}))),TD="table",Ba=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTable"}),{className:o,component:n=TD,padding:f="normal",size:m="medium",stickyHeader:y=!1,...C}=a,w={...a,component:n,padding:f,size:m,stickyHeader:y},A=F$(w),R=E.useMemo(()=>({padding:f,size:m,stickyHeader:y}),[f,m,y]);return d.jsx(kI.Provider,{value:R,children:d.jsx(N$,{as:n,role:n===TD?null:"table",ref:r,className:Ht(A.root,o),ownerState:w,...C})})}),PC=E.createContext();function j$(t){return Cn("MuiTableBody",t)}bn("MuiTableBody",["root"]);const L$=t=>{const{classes:e}=t;return pn({root:["root"]},j$,e)},B$=nt("tbody",{name:"MuiTableBody",slot:"Root"})({display:"table-row-group"}),z$={variant:"body"},AD="tbody",za=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTableBody"}),{className:o,component:n=AD,...f}=a,m={...a,component:n},y=L$(m);return d.jsx(PC.Provider,{value:z$,children:d.jsx(B$,{className:Ht(y.root,o),as:n,ref:r,role:n===AD?null:"rowgroup",ownerState:m,...f})})});function U$(t){return Cn("MuiTableCell",t)}const $$=bn("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),H$=t=>{const{classes:e,variant:r,align:a,padding:o,size:n,stickyHeader:f}=t,m={root:["root",r,f&&"stickyHeader",a!=="inherit"&&`align${At(a)}`,o!=="normal"&&`padding${At(o)}`,`size${At(n)}`]};return pn(m,U$,e)},W$=nt("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[r.variant],e[`size${At(r.size)}`],r.padding!=="normal"&&e[`padding${At(r.padding)}`],r.align!=="inherit"&&e[`align${At(r.align)}`],r.stickyHeader&&e.stickyHeader]}})(jn(({theme:t})=>({...t.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:t.vars?`1px solid ${t.vars.palette.TableCell.border}`:`1px solid
    ${t.palette.mode==="light"?t.lighten(t.alpha(t.palette.divider,1),.88):t.darken(t.alpha(t.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(t.vars||t).palette.text.primary,lineHeight:t.typography.pxToRem(24),fontWeight:t.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(t.vars||t).palette.text.primary}},{props:{variant:"footer"},style:{color:(t.vars||t).palette.text.secondary,lineHeight:t.typography.pxToRem(21),fontSize:t.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${$$.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:e})=>e.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(t.vars||t).palette.background.default}}]}))),Q=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTableCell"}),{align:o="inherit",className:n,component:f,padding:m,scope:y,size:C,sortDirection:w,variant:A,...R}=a,I=E.useContext(kI),M=E.useContext(PC),F=M&&M.variant==="head";let O;f?O=f:O=F?"th":"td";let j=y;O==="td"?j=void 0:!j&&F&&(j="col");const U=A||M&&M.variant,H={...a,align:o,component:O,padding:m||(I&&I.padding?I.padding:"normal"),size:C||(I&&I.size?I.size:"medium"),sortDirection:w,stickyHeader:U==="head"&&I&&I.stickyHeader,variant:U},K=H$(H);let W=null;return w&&(W=w==="asc"?"ascending":"descending"),d.jsx(W$,{as:O,ref:r,className:Ht(K.root,n),"aria-sort":W,scope:j,ownerState:H,...R})});function V$(t){return Cn("MuiTableContainer",t)}bn("MuiTableContainer",["root"]);const G$=t=>{const{classes:e}=t;return pn({root:["root"]},V$,e)},K$=nt("div",{name:"MuiTableContainer",slot:"Root"})({width:"100%",overflowX:"auto"}),qa=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTableContainer"}),{className:o,component:n="div",...f}=a,m={...a,component:n},y=G$(m);return d.jsx(K$,{ref:r,as:n,className:Ht(y.root,o),ownerState:m,...f})});function Y$(t){return Cn("MuiTableHead",t)}bn("MuiTableHead",["root"]);const q$=t=>{const{classes:e}=t;return pn({root:["root"]},Y$,e)},Q$=nt("thead",{name:"MuiTableHead",slot:"Root"})({display:"table-header-group"}),X$={variant:"head"},ED="thead",wa=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTableHead"}),{className:o,component:n=ED,...f}=a,m={...a,component:n},y=q$(m);return d.jsx(PC.Provider,{value:X$,children:d.jsx(Q$,{as:n,className:Ht(y.root,o),ref:r,role:n===ED?null:"rowgroup",ownerState:m,...f})})});function J$(t){return Cn("MuiToolbar",t)}bn("MuiToolbar",["root","gutters","regular","dense"]);const Z$=t=>{const{classes:e,disableGutters:r,variant:a}=t;return pn({root:["root",!r&&"gutters",a]},J$,e)},eH=nt("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableGutters&&e.gutters,e[r.variant]]}})(jn(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),tH=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiToolbar"}),{className:o,component:n="div",disableGutters:f=!1,variant:m="regular",...y}=a,C={...a,component:n,disableGutters:f,variant:m},w=Z$(C);return d.jsx(eH,{as:n,className:Ht(w.root,o),ref:r,ownerState:C,...y})}),nH=dr(d.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})),rH=dr(d.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}));function oH(t){return Cn("MuiTableRow",t)}const kD=bn("MuiTableRow",["root","selected","hover","head","footer"]),aH=t=>{const{classes:e,selected:r,hover:a,head:o,footer:n}=t;return pn({root:["root",r&&"selected",a&&"hover",o&&"head",n&&"footer"]},oH,e)},sH=nt("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.head&&e.head,r.footer&&e.footer]}})(jn(({theme:t})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${kD.hover}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${kD.selected}`]:{backgroundColor:t.alpha((t.vars||t).palette.primary.main,(t.vars||t).palette.action.selectedOpacity),"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.primary.main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`)}}}))),DD="tr",hn=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTableRow"}),{className:o,component:n=DD,hover:f=!1,selected:m=!1,...y}=a,C=E.useContext(PC),w={...a,component:n,hover:f,selected:m,head:C&&C.variant==="head",footer:C&&C.variant==="footer"},A=aH(w);return d.jsx(sH,{as:n,ref:r,className:Ht(A.root,o),role:n===DD?null:"row",ownerState:w,...y})});function iH(t){return(1+Math.sin(Math.PI*t-Math.PI/2))/2}function lH(t,e,r,a={},o=()=>{}){const{ease:n=iH,duration:f=300}=a;let m=null;const y=e[t];let C=!1;const w=()=>{C=!0},A=R=>{if(C){o(new Error("Animation cancelled"));return}m===null&&(m=R);const I=Math.min(1,(R-m)/f);if(e[t]=n(I)*(r-y)+y,I>=1){requestAnimationFrame(()=>{o(null)});return}requestAnimationFrame(A)};return y===r?(o(new Error("Element already at target position")),w):(requestAnimationFrame(A),w)}const cH={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function uH(t){const{onChange:e,...r}=t,a=E.useRef(),o=E.useRef(null),n=()=>{a.current=o.current.offsetHeight-o.current.clientHeight};return ka(()=>{const f=wC(()=>{const y=a.current;n(),y!==a.current&&e(a.current)}),m=Fc(o.current);return m.addEventListener("resize",f),()=>{f.clear(),m.removeEventListener("resize",f)}},[e]),E.useEffect(()=>{n(),e(a.current)},[e]),d.jsx("div",{style:cH,...r,ref:o})}function dH(t){return Cn("MuiTabScrollButton",t)}const fH=bn("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),hH=t=>{const{classes:e,orientation:r,disabled:a}=t;return pn({root:["root",r,a&&"disabled"]},dH,e)},pH=nt(Ru,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.orientation&&e[r.orientation]]}})({width:40,flexShrink:0,opacity:.8,[`&.${fH.disabled}`]:{opacity:0},variants:[{props:{orientation:"vertical"},style:{width:"100%",height:40,"& svg":{transform:"var(--TabScrollButton-svgRotate)"}}}]}),mH=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTabScrollButton"}),{className:o,slots:n={},slotProps:f={},direction:m,orientation:y,disabled:C,...w}=a,A=Pi(),R={isRtl:A,...a},I=hH(R),M=n.StartScrollButtonIcon??nH,F=n.EndScrollButtonIcon??rH,O=no({elementType:M,externalSlotProps:f.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:R}),j=no({elementType:F,externalSlotProps:f.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:R});return d.jsx(pH,{component:"div",className:Ht(I.root,o),ref:r,role:null,ownerState:R,tabIndex:null,...w,style:{...w.style,...y==="vertical"&&{"--TabScrollButton-svgRotate":`rotate(${A?-90:90}deg)`}},children:m==="left"?d.jsx(M,{...O}):d.jsx(F,{...j})})});function gH(t){return Cn("MuiTabs",t)}const dw=bn("MuiTabs",["root","vertical","list","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),RD=(t,e)=>t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:t.firstChild,ID=(t,e)=>t===e?t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:t.lastChild,Ax=(t,e,r)=>{let a=!1,o=r(t,e);for(;o;){if(o===t.firstChild){if(a)return;a=!0}const n=o.disabled||o.getAttribute("aria-disabled")==="true";if(!o.hasAttribute("tabindex")||n)o=r(t,o);else{o.focus();return}}},yH=t=>{const{vertical:e,fixed:r,hideScrollbar:a,scrollableX:o,scrollableY:n,centered:f,scrollButtonsHideMobile:m,classes:y}=t;return pn({root:["root",e&&"vertical"],scroller:["scroller",r&&"fixed",a&&"hideScrollbar",o&&"scrollableX",n&&"scrollableY"],list:["list","flexContainer",e&&"flexContainerVertical",e&&"vertical",f&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",m&&"scrollButtonsHideMobile"],scrollableX:[o&&"scrollableX"],hideScrollbar:[a&&"hideScrollbar"]},gH,y)},bH=nt("div",{name:"MuiTabs",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${dw.scrollButtons}`]:e.scrollButtons},{[`& .${dw.scrollButtons}`]:r.scrollButtonsHideMobile&&e.scrollButtonsHideMobile},e.root,r.vertical&&e.vertical]}})(jn(({theme:t})=>({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex",variants:[{props:({ownerState:e})=>e.vertical,style:{flexDirection:"column"}},{props:({ownerState:e})=>e.scrollButtonsHideMobile,style:{[`& .${dw.scrollButtons}`]:{[t.breakpoints.down("sm")]:{display:"none"}}}}]}))),vH=nt("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.scroller,r.fixed&&e.fixed,r.hideScrollbar&&e.hideScrollbar,r.scrollableX&&e.scrollableX,r.scrollableY&&e.scrollableY]}})({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap",variants:[{props:({ownerState:t})=>t.fixed,style:{overflowX:"hidden",width:"100%"}},{props:({ownerState:t})=>t.hideScrollbar,style:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}},{props:({ownerState:t})=>t.scrollableX,style:{overflowX:"auto",overflowY:"hidden"}},{props:({ownerState:t})=>t.scrollableY,style:{overflowY:"auto",overflowX:"hidden"}}]}),xH=nt("div",{name:"MuiTabs",slot:"List",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.list,e.flexContainer,r.vertical&&e.flexContainerVertical,r.centered&&e.centered]}})({display:"flex",variants:[{props:({ownerState:t})=>t.vertical,style:{flexDirection:"column"}},{props:({ownerState:t})=>t.centered,style:{justifyContent:"center"}}]}),CH=nt("span",{name:"MuiTabs",slot:"Indicator"})(jn(({theme:t})=>({position:"absolute",height:2,bottom:0,width:"100%",transition:t.transitions.create(),variants:[{props:{indicatorColor:"primary"},style:{backgroundColor:(t.vars||t).palette.primary.main}},{props:{indicatorColor:"secondary"},style:{backgroundColor:(t.vars||t).palette.secondary.main}},{props:({ownerState:e})=>e.vertical,style:{height:"100%",width:2,right:0}}]}))),SH=nt(uH)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),PD={},wH=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTabs"}),o=kd(),n=Pi(),{"aria-label":f,"aria-labelledby":m,action:y,centered:C=!1,children:w,className:A,component:R="div",allowScrollButtonsMobile:I=!1,indicatorColor:M="primary",onChange:F,orientation:O="horizontal",ScrollButtonComponent:j,scrollButtons:U="auto",selectionFollowsFocus:H,slots:K={},slotProps:W={},TabIndicatorProps:X={},TabScrollButtonProps:ee={},textColor:ie="primary",value:de,variant:le="standard",visibleScrollbar:oe=!1,...N}=a,ce=le==="scrollable",ne=O==="vertical",Se=ne?"scrollTop":"scrollLeft",se=ne?"top":"left",ye=ne?"bottom":"right",ze=ne?"clientHeight":"clientWidth",Re=ne?"height":"width",ve={...a,component:R,allowScrollButtonsMobile:I,indicatorColor:M,orientation:O,vertical:ne,scrollButtons:U,textColor:ie,variant:le,visibleScrollbar:oe,fixed:!ce,hideScrollbar:ce&&!oe,scrollableX:ce&&!ne,scrollableY:ce&&ne,centered:C&&!ce,scrollButtonsHideMobile:!I},V=yH(ve),ue=no({elementType:K.StartScrollButtonIcon,externalSlotProps:W.startScrollButtonIcon,ownerState:ve}),Ee=no({elementType:K.EndScrollButtonIcon,externalSlotProps:W.endScrollButtonIcon,ownerState:ve}),[Ie,ae]=E.useState(!1),[be,Te]=E.useState(PD),[tt,je]=E.useState(!1),[Pe,Be]=E.useState(!1),[Fe,Ge]=E.useState(!1),[Oe,mt]=E.useState({overflow:"hidden",scrollbarWidth:0}),qe=new Map,Ae=E.useRef(null),te=E.useRef(null),pe={slots:K,slotProps:{indicator:X,scrollButton:ee,...W}},J=()=>{const en=Ae.current;let un;if(en){const En=en.getBoundingClientRect();un={clientWidth:en.clientWidth,scrollLeft:en.scrollLeft,scrollTop:en.scrollTop,scrollWidth:en.scrollWidth,top:En.top,bottom:En.bottom,left:En.left,right:En.right}}let Yn;if(en&&de!==!1){const En=te.current.children;if(En.length>0){const fr=En[qe.get(de)];Yn=fr?fr.getBoundingClientRect():null}}return{tabsMeta:un,tabMeta:Yn}},fe=yn(()=>{const{tabsMeta:en,tabMeta:un}=J();let Yn=0,En;ne?(En="top",un&&en&&(Yn=un.top-en.top+en.scrollTop)):(En=n?"right":"left",un&&en&&(Yn=(n?-1:1)*(un[En]-en[En]+en.scrollLeft)));const fr={[En]:Yn,[Re]:un?un[Re]:0};if(typeof be[En]!="number"||typeof be[Re]!="number")Te(fr);else{const fo=Math.abs(be[En]-fr[En]),xo=Math.abs(be[Re]-fr[Re]);(fo>=1||xo>=1)&&Te(fr)}}),xe=(en,{animation:un=!0}={})=>{un?lH(Se,Ae.current,en,{duration:o.transitions.duration.standard}):Ae.current[Se]=en},Ne=en=>{let un=Ae.current[Se];ne?un+=en:un+=en*(n?-1:1),xe(un)},Me=()=>{const en=Ae.current[ze];let un=0;const Yn=Array.from(te.current.children);for(let En=0;En<Yn.length;En+=1){const fr=Yn[En];if(un+fr[ze]>en){En===0&&(un=en);break}un+=fr[ze]}return un},Ve=()=>{Ne(-1*Me())},Qe=()=>{Ne(Me())},[rt,{onChange:st,...it}]=rr("scrollbar",{className:Ht(V.scrollableX,V.hideScrollbar),elementType:SH,shouldForwardComponentProp:!0,externalForwardedProps:pe,ownerState:ve}),xt=E.useCallback(en=>{st?.(en),mt({overflow:null,scrollbarWidth:en})},[st]),[pt,Yt]=rr("scrollButtons",{className:Ht(V.scrollButtons,ee.className),elementType:mH,externalForwardedProps:pe,ownerState:ve,additionalProps:{orientation:O,slots:{StartScrollButtonIcon:K.startScrollButtonIcon||K.StartScrollButtonIcon,EndScrollButtonIcon:K.endScrollButtonIcon||K.EndScrollButtonIcon},slotProps:{startScrollButtonIcon:ue,endScrollButtonIcon:Ee}}}),Kt=()=>{const en={};en.scrollbarSizeListener=ce?d.jsx(rt,{...it,onChange:xt}):null;const Yn=ce&&(U==="auto"&&(tt||Pe)||U===!0);return en.scrollButtonStart=Yn?d.jsx(pt,{direction:n?"right":"left",onClick:Ve,disabled:!tt,...Yt}):null,en.scrollButtonEnd=Yn?d.jsx(pt,{direction:n?"left":"right",onClick:Qe,disabled:!Pe,...Yt}):null,en},tn=yn(en=>{const{tabsMeta:un,tabMeta:Yn}=J();if(!(!Yn||!un)){if(Yn[se]<un[se]){const En=un[Se]+(Yn[se]-un[se]);xe(En,{animation:en})}else if(Yn[ye]>un[ye]){const En=un[Se]+(Yn[ye]-un[ye]);xe(En,{animation:en})}}}),Wt=yn(()=>{ce&&U!==!1&&Ge(!Fe)});E.useEffect(()=>{const en=wC(()=>{Ae.current&&fe()});let un;const Yn=fo=>{fo.forEach(xo=>{xo.removedNodes.forEach(Qn=>{un?.unobserve(Qn)}),xo.addedNodes.forEach(Qn=>{un?.observe(Qn)})}),en(),Wt()},En=Fc(Ae.current);En.addEventListener("resize",en);let fr;return typeof ResizeObserver<"u"&&(un=new ResizeObserver(en),Array.from(te.current.children).forEach(fo=>{un.observe(fo)})),typeof MutationObserver<"u"&&(fr=new MutationObserver(Yn),fr.observe(te.current,{childList:!0})),()=>{en.clear(),En.removeEventListener("resize",en),fr?.disconnect(),un?.disconnect()}},[fe,Wt]),E.useEffect(()=>{const en=Array.from(te.current.children),un=en.length;if(typeof IntersectionObserver<"u"&&un>0&&ce&&U!==!1){const Yn=en[0],En=en[un-1],fr={root:Ae.current,threshold:.99},fo=Ko=>{je(!Ko[0].isIntersecting)},xo=new IntersectionObserver(fo,fr);xo.observe(Yn);const Qn=Ko=>{Be(!Ko[0].isIntersecting)},Or=new IntersectionObserver(Qn,fr);return Or.observe(En),()=>{xo.disconnect(),Or.disconnect()}}},[ce,U,Fe,w?.length]),E.useEffect(()=>{ae(!0)},[]),E.useEffect(()=>{fe()}),E.useEffect(()=>{tn(PD!==be)},[tn,be]),E.useImperativeHandle(y,()=>({updateIndicator:fe,updateScrollButtons:Wt}),[fe,Wt]);const[_t,at]=rr("indicator",{className:Ht(V.indicator,X.className),elementType:CH,externalForwardedProps:pe,ownerState:ve,additionalProps:{style:be}}),Et=d.jsx(_t,{...at});let qt=0;const gn=E.Children.map(w,en=>{if(!E.isValidElement(en))return null;const un=en.props.value===void 0?qt:en.props.value;qe.set(un,qt);const Yn=un===de;return qt+=1,E.cloneElement(en,{fullWidth:le==="fullWidth",indicator:Yn&&!Ie&&Et,selected:Yn,selectionFollowsFocus:H,onChange:F,textColor:ie,value:un,...qt===1&&de===!1&&!en.props.tabIndex?{tabIndex:0}:{}})}),Sn=en=>{if(en.altKey||en.shiftKey||en.ctrlKey||en.metaKey)return;const un=te.current,Yn=Pm($a(un));if(Yn?.getAttribute("role")!=="tab")return;let fr=O==="horizontal"?"ArrowLeft":"ArrowUp",fo=O==="horizontal"?"ArrowRight":"ArrowDown";switch(O==="horizontal"&&n&&(fr="ArrowRight",fo="ArrowLeft"),en.key){case fr:en.preventDefault(),Ax(un,Yn,ID);break;case fo:en.preventDefault(),Ax(un,Yn,RD);break;case"Home":en.preventDefault(),Ax(un,null,RD);break;case"End":en.preventDefault(),Ax(un,null,ID);break}},Zt=Kt(),[Kn,$t]=rr("root",{ref:r,className:Ht(V.root,A),elementType:bH,externalForwardedProps:{...pe,...N,component:R},ownerState:ve}),[Cr,tr]=rr("scroller",{ref:Ae,className:V.scroller,elementType:vH,externalForwardedProps:pe,ownerState:ve,additionalProps:{style:{overflow:Oe.overflow,[ne?`margin${n?"Left":"Right"}`:"marginBottom"]:oe?void 0:-Oe.scrollbarWidth}}}),[Bt,gr]=rr("list",{ref:te,className:Ht(V.list,V.flexContainer),elementType:xH,externalForwardedProps:pe,ownerState:ve,getSlotProps:en=>({...en,onKeyDown:un=>{Sn(un),en.onKeyDown?.(un)}})});return d.jsxs(Kn,{...$t,children:[Zt.scrollButtonStart,Zt.scrollbarSizeListener,d.jsxs(Cr,{...tr,children:[d.jsx(Bt,{"aria-label":f,"aria-labelledby":m,"aria-orientation":O==="vertical"?"vertical":null,role:"tablist",...gr,children:gn}),Ie&&Et]}),Zt.scrollButtonEnd]})});function TH(t){return Cn("MuiTextField",t)}bn("MuiTextField",["root"]);const AH={standard:TA,filled:wA,outlined:kA},EH=t=>{const{classes:e}=t;return pn({root:["root"]},TH,e)},kH=nt(Hr,{name:"MuiTextField",slot:"Root"})({}),On=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiTextField"}),{autoComplete:o,autoFocus:n=!1,children:f,className:m,color:y="primary",defaultValue:C,disabled:w=!1,error:A=!1,FormHelperTextProps:R,fullWidth:I=!1,helperText:M,id:F,InputLabelProps:O,inputProps:j,InputProps:U,inputRef:H,label:K,maxRows:W,minRows:X,multiline:ee=!1,name:ie,onBlur:de,onChange:le,onFocus:oe,placeholder:N,required:ce=!1,rows:ne,select:Se=!1,SelectProps:se,slots:ye={},slotProps:ze={},type:Re,value:ve,variant:V="outlined",...ue}=a,Ee={...a,autoFocus:n,color:y,disabled:w,error:A,fullWidth:I,multiline:ee,required:ce,select:Se,variant:V},Ie=EH(Ee),ae=nc(F),be=M&&ae?`${ae}-helper-text`:void 0,Te=K&&ae?`${ae}-label`:void 0,tt=AH[V],je={slots:ye,slotProps:{input:U,inputLabel:O,htmlInput:j,formHelperText:R,select:se,...ze}},Pe={},Be=je.slotProps.inputLabel;V==="outlined"&&(Be&&typeof Be.shrink<"u"&&(Pe.notched=Be.shrink),Pe.label=K),Se&&((!se||!se.native)&&(Pe.id=void 0),Pe["aria-describedby"]=void 0);const[Fe,Ge]=rr("root",{elementType:kH,shouldForwardComponentProp:!0,externalForwardedProps:{...je,...ue},ownerState:Ee,className:Ht(Ie.root,m),ref:r,additionalProps:{disabled:w,error:A,fullWidth:I,required:ce,color:y,variant:V}}),[Oe,mt]=rr("input",{elementType:tt,externalForwardedProps:je,additionalProps:Pe,ownerState:Ee}),[qe,Ae]=rr("inputLabel",{elementType:Qi,externalForwardedProps:je,ownerState:Ee}),[te,pe]=rr("htmlInput",{elementType:"input",externalForwardedProps:je,ownerState:Ee}),[J,fe]=rr("formHelperText",{elementType:yI,externalForwardedProps:je,ownerState:Ee}),[xe,Ne]=rr("select",{elementType:Wr,externalForwardedProps:je,ownerState:Ee}),Me=d.jsx(Oe,{"aria-describedby":be,autoComplete:o,autoFocus:n,defaultValue:C,fullWidth:I,multiline:ee,name:ie,rows:ne,maxRows:W,minRows:X,type:Re,value:ve,id:ae,inputRef:H,onBlur:de,onChange:le,onFocus:oe,placeholder:N,inputProps:pe,slots:{input:ye.htmlInput?te:void 0},...mt});return d.jsxs(Fe,{...Ge,children:[K!=null&&K!==""&&d.jsx(qe,{htmlFor:ae,id:Te,...Ae,children:K}),Se?d.jsx(xe,{"aria-describedby":be,id:ae,labelId:Te,value:ve,input:Me,...Ne,children:f}):Me,M&&d.jsx(J,{id:be,...fe,children:M})]})});function DH(t){return Cn("MuiToggleButton",t)}const cp=bn("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),DI=E.createContext({}),RI=E.createContext(void 0);function RH(t,e){return e===void 0||t===void 0?!1:Array.isArray(e)?e.includes(t):t===e}const IH=t=>{const{classes:e,fullWidth:r,selected:a,disabled:o,size:n,color:f}=t,m={root:["root",a&&"selected",o&&"disabled",r&&"fullWidth",`size${At(n)}`,f]};return pn(m,DH,e)},PH=nt(Ru,{name:"MuiToggleButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`size${At(r.size)}`]]}})(jn(({theme:t})=>({...t.typography.button,borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:`1px solid ${(t.vars||t).palette.divider}`,color:(t.vars||t).palette.action.active,[`&.${cp.disabled}`]:{color:(t.vars||t).palette.action.disabled,border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{[`&.${cp.selected}`]:{color:(t.vars||t).palette.text.primary,backgroundColor:t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.selectedOpacity),"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.text.primary,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.selectedOpacity)}}}}},...Object.entries(t.palette).filter(Go()).map(([e])=>({props:{color:e},style:{[`&.${cp.selected}`]:{color:(t.vars||t).palette[e].main,backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.selectedOpacity),"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:t.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:t.typography.pxToRem(15)}}]}))),Ex=E.forwardRef(function(e,r){const{value:a,...o}=E.useContext(DI),n=E.useContext(RI),f=Km({...o,selected:RH(e.value,a)},e),m=Wn({props:f,name:"MuiToggleButton"}),{children:y,className:C,color:w="standard",disabled:A=!1,disableFocusRipple:R=!1,fullWidth:I=!1,onChange:M,onClick:F,selected:O,size:j="medium",value:U,...H}=m,K={...m,color:w,disabled:A,disableFocusRipple:R,fullWidth:I,size:j},W=IH(K),X=ie=>{F&&(F(ie,U),ie.defaultPrevented)||M&&M(ie,U)},ee=n||"";return d.jsx(PH,{className:Ht(o.className,W.root,C,ee),disabled:A,focusRipple:!R,ref:r,onClick:X,onChange:M,value:U,ownerState:K,"aria-pressed":O,...H,children:y})});function MH(t){return Cn("MuiToggleButtonGroup",t)}const ca=bn("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]),_H=t=>{const{classes:e,orientation:r,fullWidth:a,disabled:o}=t,n={root:["root",r,a&&"fullWidth"],grouped:["grouped",`grouped${At(r)}`,o&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return pn(n,MH,e)},OH=nt("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${ca.grouped}`]:e.grouped},{[`& .${ca.grouped}`]:e[`grouped${At(r.orientation)}`]},{[`& .${ca.firstButton}`]:e.firstButton},{[`& .${ca.lastButton}`]:e.lastButton},{[`& .${ca.middleButton}`]:e.middleButton},e.root,r.orientation==="vertical"&&e.vertical,r.fullWidth&&e.fullWidth]}})(jn(({theme:t})=>({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius,variants:[{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${ca.grouped}`]:{[`&.${ca.selected} + .${ca.grouped}.${ca.selected}`]:{borderTop:0,marginTop:0}},[`& .${ca.firstButton},& .${ca.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${ca.lastButton},& .${ca.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${ca.lastButton}.${cp.disabled},& .${ca.middleButton}.${cp.disabled}`]:{borderTop:"1px solid transparent"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"horizontal"},style:{[`& .${ca.grouped}`]:{[`&.${ca.selected} + .${ca.grouped}.${ca.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${ca.firstButton},& .${ca.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${ca.lastButton},& .${ca.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${ca.lastButton}.${cp.disabled},& .${ca.middleButton}.${cp.disabled}`]:{borderLeft:"1px solid transparent"}}}]}))),MD=E.forwardRef(function(e,r){const a=Wn({props:e,name:"MuiToggleButtonGroup"}),{children:o,className:n,color:f="standard",disabled:m=!1,exclusive:y=!1,fullWidth:C=!1,onChange:w,orientation:A="horizontal",size:R="medium",value:I,...M}=a,F={...a,disabled:m,fullWidth:C,orientation:A,size:R},O=_H(F),j=E.useCallback((ee,ie)=>{if(!w)return;const de=I&&I.indexOf(ie);let le;I&&de>=0?(le=I.slice(),le.splice(de,1)):le=I?I.concat(ie):[ie],w(ee,le)},[w,I]),U=E.useCallback((ee,ie)=>{w&&w(ee,I===ie?null:ie)},[w,I]),H=E.useMemo(()=>({className:O.grouped,onChange:y?U:j,value:I,size:R,fullWidth:C,color:f,disabled:m}),[O.grouped,y,U,j,I,R,C,f,m]),K=$9(o),W=K.length,X=ee=>{const ie=ee===0,de=ee===W-1;return ie&&de?"":ie?O.firstButton:de?O.lastButton:O.middleButton};return d.jsx(OH,{role:"group",className:Ht(O.root,n),ref:r,ownerState:F,...M,children:d.jsx(DI.Provider,{value:H,children:K.map((ee,ie)=>d.jsx(RI.Provider,{value:X(ie),children:ee},ie))})})}),II=I3({themeId:ql}),Df=7,sg=dr(d.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),_D=dr(d.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),FH=dr(d.jsx("path",{d:"m7 10 5 5 5-5z"})),NH=dr(d.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"})),jH=dr(d.jsx("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"})),LH=dr(d.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),PI=dr(d.jsx("path",{d:"M21.5 14.98c-.02 0-.03 0-.05.01C21.2 13.3 19.76 12 18 12c-1.4 0-2.6.83-3.16 2.02C13.26 14.1 12 15.4 12 17c0 1.66 1.34 3 3 3l6.5-.02c1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5M10 4.26v2.09C7.67 7.18 6 9.39 6 12c0 1.77.78 3.34 2 4.44V14h2v6H4v-2h2.73C5.06 16.54 4 14.4 4 12c0-3.73 2.55-6.85 6-7.74M20 6h-2.73c1.43 1.26 2.41 3.01 2.66 5h-2.02c-.23-1.36-.93-2.55-1.91-3.44V10h-2V4h6z"})),Rp=dr(d.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),yp=dr(d.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"})),bp=dr(d.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),uT=dr(d.jsx("path",{d:"M10.09 15.59 11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"})),RA=dr(d.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),IA=dr(d.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"})),OD=dr(d.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"})),MC=dr(d.jsx("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"})),kx=dr(d.jsx("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8z"})),MI=dr(d.jsx("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m0 12H4V8h16z"})),_I=dr(d.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"})),BH=dr(d.jsx("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"})),zH=dr(d.jsx("path",{d:"M11 7 9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8z"})),UH=dr(d.jsx("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"})),$H=dr(d.jsx("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"})),qh=dr(d.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"})),HH=dr(d.jsx("path",{d:"M7.5 11C9.43 11 11 9.43 11 7.5S9.43 4 7.5 4 4 5.57 4 7.5 5.57 11 7.5 11m0-5C8.33 6 9 6.67 9 7.5S8.33 9 7.5 9 6 8.33 6 7.5 6.67 6 7.5 6M4.0025 18.5832 18.59 3.9955l1.4142 1.4143L5.4167 19.9974zM16.5 13c-1.93 0-3.5 1.57-3.5 3.5s1.57 3.5 3.5 3.5 3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5m0 5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"})),OI=dr(d.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),WH=dr(d.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),PA=dr(d.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"})),FD=dr(d.jsx("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7zm-6 .67 2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"})),ig=dr(d.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})),VH=dr(d.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"})),Jy=dr(d.jsx("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2"})),_C=dr(d.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"})),Tf=dr(d.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}));var ND="popstate";function GH(t={}){function e(a,o){let{pathname:n,search:f,hash:m}=a.location;return dT("",{pathname:n,search:f,hash:m},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(a,o){return typeof o=="string"?o:Zy(o)}return YH(e,r,null,t)}function ba(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ec(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function KH(){return Math.random().toString(36).substring(2,10)}function jD(t,e){return{usr:t.state,key:t.key,idx:e}}function dT(t,e,r=null,a){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?lg(e):e,state:r,key:e&&e.key||a||KH()}}function Zy({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function lg(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let a=t.indexOf("?");a>=0&&(e.search=t.substring(a),t=t.substring(0,a)),t&&(e.pathname=t)}return e}function YH(t,e,r,a={}){let{window:o=document.defaultView,v5Compat:n=!1}=a,f=o.history,m="POP",y=null,C=w();C==null&&(C=0,f.replaceState({...f.state,idx:C},""));function w(){return(f.state||{idx:null}).idx}function A(){m="POP";let O=w(),j=O==null?null:O-C;C=O,y&&y({action:m,location:F.location,delta:j})}function R(O,j){m="PUSH";let U=dT(F.location,O,j);C=w()+1;let H=jD(U,C),K=F.createHref(U);try{f.pushState(H,"",K)}catch(W){if(W instanceof DOMException&&W.name==="DataCloneError")throw W;o.location.assign(K)}n&&y&&y({action:m,location:F.location,delta:1})}function I(O,j){m="REPLACE";let U=dT(F.location,O,j);C=w();let H=jD(U,C),K=F.createHref(U);f.replaceState(H,"",K),n&&y&&y({action:m,location:F.location,delta:0})}function M(O){return qH(O)}let F={get action(){return m},get location(){return t(o,f)},listen(O){if(y)throw new Error("A history only accepts one active listener");return o.addEventListener(ND,A),y=O,()=>{o.removeEventListener(ND,A),y=null}},createHref(O){return e(o,O)},createURL:M,encodeLocation(O){let j=M(O);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:R,replace:I,go(O){return f.go(O)}};return F}function qH(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),ba(r,"No window.location.(origin|href) available to create URL");let a=typeof t=="string"?t:Zy(t);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=r+a),new URL(a,r)}function FI(t,e,r="/"){return QH(t,e,r,!1)}function QH(t,e,r,a){let o=typeof e=="string"?lg(e):e,n=wd(o.pathname||"/",r);if(n==null)return null;let f=NI(t);XH(f);let m=null;for(let y=0;m==null&&y<f.length;++y){let C=lW(n);m=sW(f[y],C,a)}return m}function NI(t,e=[],r=[],a="",o=!1){let n=(f,m,y=o,C)=>{let w={relativePath:C===void 0?f.path||"":C,caseSensitive:f.caseSensitive===!0,childrenIndex:m,route:f};if(w.relativePath.startsWith("/")){if(!w.relativePath.startsWith(a)&&y)return;ba(w.relativePath.startsWith(a),`Absolute route path "${w.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),w.relativePath=w.relativePath.slice(a.length)}let A=vd([a,w.relativePath]),R=r.concat(w);f.children&&f.children.length>0&&(ba(f.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${A}".`),NI(f.children,e,R,A,y)),!(f.path==null&&!f.index)&&e.push({path:A,score:oW(A,f.index),routesMeta:R})};return t.forEach((f,m)=>{if(f.path===""||!f.path?.includes("?"))n(f,m);else for(let y of jI(f.path))n(f,m,!0,y)}),e}function jI(t){let e=t.split("/");if(e.length===0)return[];let[r,...a]=e,o=r.endsWith("?"),n=r.replace(/\?$/,"");if(a.length===0)return o?[n,""]:[n];let f=jI(a.join("/")),m=[];return m.push(...f.map(y=>y===""?n:[n,y].join("/"))),o&&m.push(...f),m.map(y=>t.startsWith("/")&&y===""?"/":y)}function XH(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:aW(e.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var JH=/^:[\w-]+$/,ZH=3,eW=2,tW=1,nW=10,rW=-2,LD=t=>t==="*";function oW(t,e){let r=t.split("/"),a=r.length;return r.some(LD)&&(a+=rW),e&&(a+=eW),r.filter(o=>!LD(o)).reduce((o,n)=>o+(JH.test(n)?ZH:n===""?tW:nW),a)}function aW(t,e){return t.length===e.length&&t.slice(0,-1).every((a,o)=>a===e[o])?t[t.length-1]-e[e.length-1]:0}function sW(t,e,r=!1){let{routesMeta:a}=t,o={},n="/",f=[];for(let m=0;m<a.length;++m){let y=a[m],C=m===a.length-1,w=n==="/"?e:e.slice(n.length)||"/",A=A2({path:y.relativePath,caseSensitive:y.caseSensitive,end:C},w),R=y.route;if(!A&&C&&r&&!a[a.length-1].route.index&&(A=A2({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},w)),!A)return null;Object.assign(o,A.params),f.push({params:o,pathname:vd([n,A.pathname]),pathnameBase:hW(vd([n,A.pathnameBase])),route:R}),A.pathnameBase!=="/"&&(n=vd([n,A.pathnameBase]))}return f}function A2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,a]=iW(t.path,t.caseSensitive,t.end),o=e.match(r);if(!o)return null;let n=o[0],f=n.replace(/(.)\/+$/,"$1"),m=o.slice(1);return{params:a.reduce((C,{paramName:w,isOptional:A},R)=>{if(w==="*"){let M=m[R]||"";f=n.slice(0,n.length-M.length).replace(/(.)\/+$/,"$1")}const I=m[R];return A&&!I?C[w]=void 0:C[w]=(I||"").replace(/%2F/g,"/"),C},{}),pathname:n,pathnameBase:f,pattern:t}}function iW(t,e=!1,r=!0){ec(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let a=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,m,y)=>(a.push({paramName:m,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(a.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),a]}function lW(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ec(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function wd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,a=t.charAt(r);return a&&a!=="/"?null:t.slice(r)||"/"}var cW=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uW=t=>cW.test(t);function dW(t,e="/"){let{pathname:r,search:a="",hash:o=""}=typeof t=="string"?lg(t):t,n;if(r)if(uW(r))n=r;else{if(r.includes("//")){let f=r;r=r.replace(/\/\/+/g,"/"),ec(!1,`Pathnames cannot have embedded double slashes - normalizing ${f} -> ${r}`)}r.startsWith("/")?n=BD(r.substring(1),"/"):n=BD(r,e)}else n=e;return{pathname:n,search:pW(a),hash:mW(o)}}function BD(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?r.length>1&&r.pop():o!=="."&&r.push(o)}),r.length>1?r.join("/"):"/"}function fw(t,e,r,a){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function fW(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function MA(t){let e=fW(t);return e.map((r,a)=>a===e.length-1?r.pathname:r.pathnameBase)}function _A(t,e,r,a=!1){let o;typeof t=="string"?o=lg(t):(o={...t},ba(!o.pathname||!o.pathname.includes("?"),fw("?","pathname","search",o)),ba(!o.pathname||!o.pathname.includes("#"),fw("#","pathname","hash",o)),ba(!o.search||!o.search.includes("#"),fw("#","search","hash",o)));let n=t===""||o.pathname==="",f=n?"/":o.pathname,m;if(f==null)m=r;else{let A=e.length-1;if(!a&&f.startsWith("..")){let R=f.split("/");for(;R[0]==="..";)R.shift(),A-=1;o.pathname=R.join("/")}m=A>=0?e[A]:"/"}let y=dW(o,m),C=f&&f!=="/"&&f.endsWith("/"),w=(n||f===".")&&r.endsWith("/");return!y.pathname.endsWith("/")&&(C||w)&&(y.pathname+="/"),y}var vd=t=>t.join("/").replace(/\/\/+/g,"/"),hW=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),pW=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,mW=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function gW(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function yW(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var LI=["POST","PUT","PATCH","DELETE"];new Set(LI);var bW=["GET",...LI];new Set(bW);var cg=E.createContext(null);cg.displayName="DataRouter";var OC=E.createContext(null);OC.displayName="DataRouterState";E.createContext(!1);var BI=E.createContext({isTransitioning:!1});BI.displayName="ViewTransition";var vW=E.createContext(new Map);vW.displayName="Fetchers";var xW=E.createContext(null);xW.displayName="Await";var rc=E.createContext(null);rc.displayName="Navigation";var Tb=E.createContext(null);Tb.displayName="Location";var _u=E.createContext({outlet:null,matches:[],isDataRoute:!1});_u.displayName="Route";var OA=E.createContext(null);OA.displayName="RouteError";function CW(t,{relative:e}={}){ba(ug(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=E.useContext(rc),{hash:o,pathname:n,search:f}=Eb(t,{relative:e}),m=n;return r!=="/"&&(m=n==="/"?r:vd([r,n])),a.createHref({pathname:m,search:f,hash:o})}function ug(){return E.useContext(Tb)!=null}function Vf(){return ba(ug(),"useLocation() may be used only in the context of a <Router> component."),E.useContext(Tb).location}var zI="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function UI(t){E.useContext(rc).static||E.useLayoutEffect(t)}function Ab(){let{isDataRoute:t}=E.useContext(_u);return t?OW():SW()}function SW(){ba(ug(),"useNavigate() may be used only in the context of a <Router> component.");let t=E.useContext(cg),{basename:e,navigator:r}=E.useContext(rc),{matches:a}=E.useContext(_u),{pathname:o}=Vf(),n=JSON.stringify(MA(a)),f=E.useRef(!1);return UI(()=>{f.current=!0}),E.useCallback((y,C={})=>{if(ec(f.current,zI),!f.current)return;if(typeof y=="number"){r.go(y);return}let w=_A(y,JSON.parse(n),o,C.relative==="path");t==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:vd([e,w.pathname])),(C.replace?r.replace:r.push)(w,C.state,C)},[e,r,n,o,t])}E.createContext(null);function Eb(t,{relative:e}={}){let{matches:r}=E.useContext(_u),{pathname:a}=Vf(),o=JSON.stringify(MA(r));return E.useMemo(()=>_A(t,JSON.parse(o),a,e==="path"),[t,o,a,e])}function wW(t,e){return $I(t,e)}function $I(t,e,r,a,o){ba(ug(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=E.useContext(rc),{matches:f}=E.useContext(_u),m=f[f.length-1],y=m?m.params:{},C=m?m.pathname:"/",w=m?m.pathnameBase:"/",A=m&&m.route;{let U=A&&A.path||"";HI(C,!A||U.endsWith("*")||U.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${C}" (under <Route path="${U}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${U}"> to <Route path="${U==="/"?"*":`${U}/*`}">.`)}let R=Vf(),I;if(e){let U=typeof e=="string"?lg(e):e;ba(w==="/"||U.pathname?.startsWith(w),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${w}" but pathname "${U.pathname}" was given in the \`location\` prop.`),I=U}else I=R;let M=I.pathname||"/",F=M;if(w!=="/"){let U=w.replace(/^\//,"").split("/");F="/"+M.replace(/^\//,"").split("/").slice(U.length).join("/")}let O=FI(t,{pathname:F});ec(A||O!=null,`No routes matched location "${I.pathname}${I.search}${I.hash}" `),ec(O==null||O[O.length-1].route.element!==void 0||O[O.length-1].route.Component!==void 0||O[O.length-1].route.lazy!==void 0,`Matched leaf route at location "${I.pathname}${I.search}${I.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=DW(O&&O.map(U=>Object.assign({},U,{params:Object.assign({},y,U.params),pathname:vd([w,n.encodeLocation?n.encodeLocation(U.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?w:vd([w,n.encodeLocation?n.encodeLocation(U.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:U.pathnameBase])})),f,r,a,o);return e&&j?E.createElement(Tb.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...I},navigationType:"POP"}},j):j}function TW(){let t=_W(),e=gW(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,a="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:a},n={padding:"2px 4px",backgroundColor:a},f=null;return console.error("Error handled by React Router default ErrorBoundary:",t),f=E.createElement(E.Fragment,null,E.createElement("p",null," Hey developer "),E.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",E.createElement("code",{style:n},"ErrorBoundary")," or"," ",E.createElement("code",{style:n},"errorElement")," prop on your route.")),E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),r?E.createElement("pre",{style:o},r):null,f)}var AW=E.createElement(TW,null),EW=class extends E.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?E.createElement(_u.Provider,{value:this.props.routeContext},E.createElement(OA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function kW({routeContext:t,match:e,children:r}){let a=E.useContext(cg);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),E.createElement(_u.Provider,{value:t},r)}function DW(t,e=[],r=null,a=null,o=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let n=t,f=r?.errors;if(f!=null){let w=n.findIndex(A=>A.route.id&&f?.[A.route.id]!==void 0);ba(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(f).join(",")}`),n=n.slice(0,Math.min(n.length,w+1))}let m=!1,y=-1;if(r)for(let w=0;w<n.length;w++){let A=n[w];if((A.route.HydrateFallback||A.route.hydrateFallbackElement)&&(y=w),A.route.id){let{loaderData:R,errors:I}=r,M=A.route.loader&&!R.hasOwnProperty(A.route.id)&&(!I||I[A.route.id]===void 0);if(A.route.lazy||M){m=!0,y>=0?n=n.slice(0,y+1):n=[n[0]];break}}}let C=r&&a?(w,A)=>{a(w,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:yW(r.matches),errorInfo:A})}:void 0;return n.reduceRight((w,A,R)=>{let I,M=!1,F=null,O=null;r&&(I=f&&A.route.id?f[A.route.id]:void 0,F=A.route.errorElement||AW,m&&(y<0&&R===0?(HI("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),M=!0,O=null):y===R&&(M=!0,O=A.route.hydrateFallbackElement||null)));let j=e.concat(n.slice(0,R+1)),U=()=>{let H;return I?H=F:M?H=O:A.route.Component?H=E.createElement(A.route.Component,null):A.route.element?H=A.route.element:H=w,E.createElement(kW,{match:A,routeContext:{outlet:w,matches:j,isDataRoute:r!=null},children:H})};return r&&(A.route.ErrorBoundary||A.route.errorElement||R===0)?E.createElement(EW,{location:r.location,revalidation:r.revalidation,component:F,error:I,children:U(),routeContext:{outlet:null,matches:j,isDataRoute:!0},onError:C}):U()},null)}function FA(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RW(t){let e=E.useContext(cg);return ba(e,FA(t)),e}function IW(t){let e=E.useContext(OC);return ba(e,FA(t)),e}function PW(t){let e=E.useContext(_u);return ba(e,FA(t)),e}function NA(t){let e=PW(t),r=e.matches[e.matches.length-1];return ba(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function MW(){return NA("useRouteId")}function _W(){let t=E.useContext(OA),e=IW("useRouteError"),r=NA("useRouteError");return t!==void 0?t:e.errors?.[r]}function OW(){let{router:t}=RW("useNavigate"),e=NA("useNavigate"),r=E.useRef(!1);return UI(()=>{r.current=!0}),E.useCallback(async(o,n={})=>{ec(r.current,zI),r.current&&(typeof o=="number"?await t.navigate(o):await t.navigate(o,{fromRouteId:e,...n}))},[t,e])}var zD={};function HI(t,e,r){!e&&!zD[t]&&(zD[t]=!0,ec(!1,r))}E.memo(FW);function FW({routes:t,future:e,state:r,unstable_onError:a}){return $I(t,void 0,r,a,e)}function hw({to:t,replace:e,state:r,relative:a}){ba(ug(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=E.useContext(rc);ec(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:n}=E.useContext(_u),{pathname:f}=Vf(),m=Ab(),y=_A(t,MA(n),f,a==="path"),C=JSON.stringify(y);return E.useEffect(()=>{m(JSON.parse(C),{replace:e,state:r,relative:a})},[m,C,a,e,r]),null}function Ci(t){ba(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function NW({basename:t="/",children:e=null,location:r,navigationType:a="POP",navigator:o,static:n=!1,unstable_useTransitions:f}){ba(!ug(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=t.replace(/^\/*/,"/"),y=E.useMemo(()=>({basename:m,navigator:o,static:n,unstable_useTransitions:f,future:{}}),[m,o,n,f]);typeof r=="string"&&(r=lg(r));let{pathname:C="/",search:w="",hash:A="",state:R=null,key:I="default"}=r,M=E.useMemo(()=>{let F=wd(C,m);return F==null?null:{location:{pathname:F,search:w,hash:A,state:R,key:I},navigationType:a}},[m,C,w,A,R,I,a]);return ec(M!=null,`<Router basename="${m}"> is not able to match the URL "${C}${w}${A}" because it does not start with the basename, so the <Router> won't render anything.`),M==null?null:E.createElement(rc.Provider,{value:y},E.createElement(Tb.Provider,{children:e,value:M}))}function jW({children:t,location:e}){return wW(fT(t),e)}function fT(t,e=[]){let r=[];return E.Children.forEach(t,(a,o)=>{if(!E.isValidElement(a))return;let n=[...e,o];if(a.type===E.Fragment){r.push.apply(r,fT(a.props.children,n));return}ba(a.type===Ci,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ba(!a.props.index||!a.props.children,"An index route cannot have child routes.");let f={id:a.props.id||n.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(f.children=fT(a.props.children,n)),r.push(f)}),r}var Zx="get",e2="application/x-www-form-urlencoded";function FC(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function LW(t){return FC(t)&&t.tagName.toLowerCase()==="button"}function BW(t){return FC(t)&&t.tagName.toLowerCase()==="form"}function zW(t){return FC(t)&&t.tagName.toLowerCase()==="input"}function UW(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function $W(t,e){return t.button===0&&(!e||e==="_self")&&!UW(t)}var Dx=null;function HW(){if(Dx===null)try{new FormData(document.createElement("form"),0),Dx=!1}catch{Dx=!0}return Dx}var WW=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pw(t){return t!=null&&!WW.has(t)?(ec(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${e2}"`),null):t}function VW(t,e){let r,a,o,n,f;if(BW(t)){let m=t.getAttribute("action");a=m?wd(m,e):null,r=t.getAttribute("method")||Zx,o=pw(t.getAttribute("enctype"))||e2,n=new FormData(t)}else if(LW(t)||zW(t)&&(t.type==="submit"||t.type==="image")){let m=t.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=t.getAttribute("formaction")||m.getAttribute("action");if(a=y?wd(y,e):null,r=t.getAttribute("formmethod")||m.getAttribute("method")||Zx,o=pw(t.getAttribute("formenctype"))||pw(m.getAttribute("enctype"))||e2,n=new FormData(m,t),!HW()){let{name:C,type:w,value:A}=t;if(w==="image"){let R=C?`${C}.`:"";n.append(`${R}x`,"0"),n.append(`${R}y`,"0")}else C&&n.append(C,A)}}else{if(FC(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Zx,a=null,o=e2,f=t}return n&&o==="text/plain"&&(f=n,n=void 0),{action:a,method:r.toLowerCase(),encType:o,formData:n,body:f}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function jA(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function GW(t,e,r){let a=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return a.pathname==="/"?a.pathname=`_root.${r}`:e&&wd(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${r}`,a}async function KW(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YW(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function qW(t,e,r){let a=await Promise.all(t.map(async o=>{let n=e.routes[o.route.id];if(n){let f=await KW(n,r);return f.links?f.links():[]}return[]}));return ZW(a.flat(1).filter(YW).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function UD(t,e,r,a,o,n){let f=(y,C)=>r[C]?y.route.id!==r[C].route.id:!0,m=(y,C)=>r[C].pathname!==y.pathname||r[C].route.path?.endsWith("*")&&r[C].params["*"]!==y.params["*"];return n==="assets"?e.filter((y,C)=>f(y,C)||m(y,C)):n==="data"?e.filter((y,C)=>{let w=a.routes[y.route.id];if(!w||!w.hasLoader)return!1;if(f(y,C)||m(y,C))return!0;if(y.route.shouldRevalidate){let A=y.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:y.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function QW(t,e,{includeHydrateFallback:r}={}){return XW(t.map(a=>{let o=e.routes[a.route.id];if(!o)return[];let n=[o.module];return o.clientActionModule&&(n=n.concat(o.clientActionModule)),o.clientLoaderModule&&(n=n.concat(o.clientLoaderModule)),r&&o.hydrateFallbackModule&&(n=n.concat(o.hydrateFallbackModule)),o.imports&&(n=n.concat(o.imports)),n}).flat(1))}function XW(t){return[...new Set(t)]}function JW(t){let e={},r=Object.keys(t).sort();for(let a of r)e[a]=t[a];return e}function ZW(t,e){let r=new Set;return new Set(e),t.reduce((a,o)=>{let n=JSON.stringify(JW(o));return r.has(n)||(r.add(n),a.push({key:n,link:o})),a},[])}function WI(){let t=E.useContext(cg);return jA(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function eV(){let t=E.useContext(OC);return jA(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var LA=E.createContext(void 0);LA.displayName="FrameworkContext";function VI(){let t=E.useContext(LA);return jA(t,"You must render this element inside a <HydratedRouter> element"),t}function tV(t,e){let r=E.useContext(LA),[a,o]=E.useState(!1),[n,f]=E.useState(!1),{onFocus:m,onBlur:y,onMouseEnter:C,onMouseLeave:w,onTouchStart:A}=e,R=E.useRef(null);E.useEffect(()=>{if(t==="render"&&f(!0),t==="viewport"){let F=j=>{j.forEach(U=>{f(U.isIntersecting)})},O=new IntersectionObserver(F,{threshold:.5});return R.current&&O.observe(R.current),()=>{O.disconnect()}}},[t]),E.useEffect(()=>{if(a){let F=setTimeout(()=>{f(!0)},100);return()=>{clearTimeout(F)}}},[a]);let I=()=>{o(!0)},M=()=>{o(!1),f(!1)};return r?t!=="intent"?[n,R,{}]:[n,R,{onFocus:py(m,I),onBlur:py(y,M),onMouseEnter:py(C,I),onMouseLeave:py(w,M),onTouchStart:py(A,I)}]:[!1,R,{}]}function py(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function nV({page:t,...e}){let{router:r}=WI(),a=E.useMemo(()=>FI(r.routes,t,r.basename),[r.routes,t,r.basename]);return a?E.createElement(oV,{page:t,matches:a,...e}):null}function rV(t){let{manifest:e,routeModules:r}=VI(),[a,o]=E.useState([]);return E.useEffect(()=>{let n=!1;return qW(t,e,r).then(f=>{n||o(f)}),()=>{n=!0}},[t,e,r]),a}function oV({page:t,matches:e,...r}){let a=Vf(),{manifest:o,routeModules:n}=VI(),{basename:f}=WI(),{loaderData:m,matches:y}=eV(),C=E.useMemo(()=>UD(t,e,y,o,a,"data"),[t,e,y,o,a]),w=E.useMemo(()=>UD(t,e,y,o,a,"assets"),[t,e,y,o,a]),A=E.useMemo(()=>{if(t===a.pathname+a.search+a.hash)return[];let M=new Set,F=!1;if(e.forEach(j=>{let U=o.routes[j.route.id];!U||!U.hasLoader||(!C.some(H=>H.route.id===j.route.id)&&j.route.id in m&&n[j.route.id]?.shouldRevalidate||U.hasClientLoader?F=!0:M.add(j.route.id))}),M.size===0)return[];let O=GW(t,f,"data");return F&&M.size>0&&O.searchParams.set("_routes",e.filter(j=>M.has(j.route.id)).map(j=>j.route.id).join(",")),[O.pathname+O.search]},[f,m,a,o,C,e,t,n]),R=E.useMemo(()=>QW(w,o),[w,o]),I=rV(w);return E.createElement(E.Fragment,null,A.map(M=>E.createElement("link",{key:M,rel:"prefetch",as:"fetch",href:M,...r})),R.map(M=>E.createElement("link",{key:M,rel:"modulepreload",href:M,...r})),I.map(({key:M,link:F})=>E.createElement("link",{key:M,nonce:r.nonce,...F})))}function aV(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var GI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{GI&&(window.__reactRouterVersion="7.10.1")}catch{}function sV({basename:t,children:e,unstable_useTransitions:r,window:a}){let o=E.useRef();o.current==null&&(o.current=GH({window:a,v5Compat:!0}));let n=o.current,[f,m]=E.useState({action:n.action,location:n.location}),y=E.useCallback(C=>{r===!1?m(C):E.startTransition(()=>m(C))},[r]);return E.useLayoutEffect(()=>n.listen(y),[n,y]),E.createElement(NW,{basename:t,children:e,location:f.location,navigationType:f.action,navigator:n,unstable_useTransitions:r===!0})}var KI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ml=E.forwardRef(function({onClick:e,discover:r="render",prefetch:a="none",relative:o,reloadDocument:n,replace:f,state:m,target:y,to:C,preventScrollReset:w,viewTransition:A,...R},I){let{basename:M,unstable_useTransitions:F}=E.useContext(rc),O=typeof C=="string"&&KI.test(C),j,U=!1;if(typeof C=="string"&&O&&(j=C,GI))try{let le=new URL(window.location.href),oe=C.startsWith("//")?new URL(le.protocol+C):new URL(C),N=wd(oe.pathname,M);oe.origin===le.origin&&N!=null?C=N+oe.search+oe.hash:U=!0}catch{ec(!1,`<Link to="${C}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let H=CW(C,{relative:o}),[K,W,X]=tV(a,R),ee=uV(C,{replace:f,state:m,target:y,preventScrollReset:w,relative:o,viewTransition:A,unstable_useTransitions:F});function ie(le){e&&e(le),le.defaultPrevented||ee(le)}let de=E.createElement("a",{...R,...X,href:j||H,onClick:U||n?e:ie,ref:aV(I,W),target:y,"data-discover":!O&&r==="render"?"true":void 0});return K&&!O?E.createElement(E.Fragment,null,de,E.createElement(nV,{page:H})):de});ml.displayName="Link";var iV=E.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:a="",end:o=!1,style:n,to:f,viewTransition:m,children:y,...C},w){let A=Eb(f,{relative:C.relative}),R=Vf(),I=E.useContext(OC),{navigator:M,basename:F}=E.useContext(rc),O=I!=null&&mV(A)&&m===!0,j=M.encodeLocation?M.encodeLocation(A).pathname:A.pathname,U=R.pathname,H=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;r||(U=U.toLowerCase(),H=H?H.toLowerCase():null,j=j.toLowerCase()),H&&F&&(H=wd(H,F)||H);const K=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let W=U===j||!o&&U.startsWith(j)&&U.charAt(K)==="/",X=H!=null&&(H===j||!o&&H.startsWith(j)&&H.charAt(j.length)==="/"),ee={isActive:W,isPending:X,isTransitioning:O},ie=W?e:void 0,de;typeof a=="function"?de=a(ee):de=[a,W?"active":null,X?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let le=typeof n=="function"?n(ee):n;return E.createElement(ml,{...C,"aria-current":ie,className:de,ref:w,style:le,to:f,viewTransition:m},typeof y=="function"?y(ee):y)});iV.displayName="NavLink";var lV=E.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:a,replace:o,state:n,method:f=Zx,action:m,onSubmit:y,relative:C,preventScrollReset:w,viewTransition:A,...R},I)=>{let{unstable_useTransitions:M}=E.useContext(rc),F=hV(),O=pV(m,{relative:C}),j=f.toLowerCase()==="get"?"get":"post",U=typeof m=="string"&&KI.test(m),H=K=>{if(y&&y(K),K.defaultPrevented)return;K.preventDefault();let W=K.nativeEvent.submitter,X=W?.getAttribute("formmethod")||f,ee=()=>F(W||K.currentTarget,{fetcherKey:e,method:X,navigate:r,replace:o,state:n,relative:C,preventScrollReset:w,viewTransition:A});M&&r!==!1?E.startTransition(()=>ee()):ee()};return E.createElement("form",{ref:I,method:j,action:O,onSubmit:a?y:H,...R,"data-discover":!U&&t==="render"?"true":void 0})});lV.displayName="Form";function cV(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YI(t){let e=E.useContext(cg);return ba(e,cV(t)),e}function uV(t,{target:e,replace:r,state:a,preventScrollReset:o,relative:n,viewTransition:f,unstable_useTransitions:m}={}){let y=Ab(),C=Vf(),w=Eb(t,{relative:n});return E.useCallback(A=>{if($W(A,e)){A.preventDefault();let R=r!==void 0?r:Zy(C)===Zy(w),I=()=>y(t,{replace:R,state:a,preventScrollReset:o,relative:n,viewTransition:f});m?E.startTransition(()=>I()):I()}},[C,y,w,r,a,e,t,o,n,f,m])}var dV=0,fV=()=>`__${String(++dV)}__`;function hV(){let{router:t}=YI("useSubmit"),{basename:e}=E.useContext(rc),r=MW(),a=t.fetch,o=t.navigate;return E.useCallback(async(n,f={})=>{let{action:m,method:y,encType:C,formData:w,body:A}=VW(n,e);if(f.navigate===!1){let R=f.fetcherKey||fV();await a(R,r,f.action||m,{preventScrollReset:f.preventScrollReset,formData:w,body:A,formMethod:f.method||y,formEncType:f.encType||C,flushSync:f.flushSync})}else await o(f.action||m,{preventScrollReset:f.preventScrollReset,formData:w,body:A,formMethod:f.method||y,formEncType:f.encType||C,replace:f.replace,state:f.state,fromRouteId:r,flushSync:f.flushSync,viewTransition:f.viewTransition})},[a,o,e,r])}function pV(t,{relative:e}={}){let{basename:r}=E.useContext(rc),a=E.useContext(_u);ba(a,"useFormAction must be used inside a RouteContext");let[o]=a.matches.slice(-1),n={...Eb(t||".",{relative:e})},f=Vf();if(t==null){n.search=f.search;let m=new URLSearchParams(n.search),y=m.getAll("index");if(y.some(w=>w==="")){m.delete("index"),y.filter(A=>A).forEach(A=>m.append("index",A));let w=m.toString();n.search=w?`?${w}`:""}}return(!t||t===".")&&o.route.index&&(n.search=n.search?n.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(n.pathname=n.pathname==="/"?r:vd([r,n.pathname])),Zy(n)}function mV(t,{relative:e}={}){let r=E.useContext(BI);ba(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=YI("useViewTransitionState"),o=Eb(t,{relative:e});if(!r.isTransitioning)return!1;let n=wd(r.currentLocation.pathname,a)||r.currentLocation.pathname,f=wd(r.nextLocation.pathname,a)||r.nextLocation.pathname;return A2(o.pathname,f)!=null||A2(o.pathname,n)!=null}var dg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},gV={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},yV=class{#e=gV;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},up=new yV;function bV(t){setTimeout(t,0)}var vp=typeof window>"u"||"Deno"in globalThis;function Ei(){}function vV(t,e){return typeof t=="function"?t(e):t}function hT(t){return typeof t=="number"&&t>=0&&t!==1/0}function qI(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Mf(t,e){return typeof t=="function"?t(e):t}function Vl(t,e){return typeof t=="function"?t(e):t}function $D(t,e){const{type:r="all",exact:a,fetchStatus:o,predicate:n,queryKey:f,stale:m}=t;if(f){if(a){if(e.queryHash!==BA(f,e.options))return!1}else if(!eb(e.queryKey,f))return!1}if(r!=="all"){const y=e.isActive();if(r==="active"&&!y||r==="inactive"&&y)return!1}return!(typeof m=="boolean"&&e.isStale()!==m||o&&o!==e.state.fetchStatus||n&&!n(e))}function HD(t,e){const{exact:r,status:a,predicate:o,mutationKey:n}=t;if(n){if(!e.options.mutationKey)return!1;if(r){if(xp(e.options.mutationKey)!==xp(n))return!1}else if(!eb(e.options.mutationKey,n))return!1}return!(a&&e.state.status!==a||o&&!o(e))}function BA(t,e){return(e?.queryKeyHashFn||xp)(t)}function xp(t){return JSON.stringify(t,(e,r)=>pT(r)?Object.keys(r).sort().reduce((a,o)=>(a[o]=r[o],a),{}):r)}function eb(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>eb(t[r],e[r])):!1}var xV=Object.prototype.hasOwnProperty;function QI(t,e){if(t===e)return t;const r=WD(t)&&WD(e);if(!r&&!(pT(t)&&pT(e)))return e;const o=(r?t:Object.keys(t)).length,n=r?e:Object.keys(e),f=n.length,m=r?new Array(f):{};let y=0;for(let C=0;C<f;C++){const w=r?C:n[C],A=t[w],R=e[w];if(A===R){m[w]=A,(r?C<o:xV.call(t,w))&&y++;continue}if(A===null||R===null||typeof A!="object"||typeof R!="object"){m[w]=R;continue}const I=QI(A,R);m[w]=I,I===A&&y++}return o===f&&y===o?t:m}function E2(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function WD(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function pT(t){if(!VD(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!VD(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function VD(t){return Object.prototype.toString.call(t)==="[object Object]"}function CV(t){return new Promise(e=>{up.setTimeout(e,t)})}function mT(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?QI(t,e):e}function SV(t,e,r=0){const a=[...t,e];return r&&a.length>r?a.slice(1):a}function wV(t,e,r=0){const a=[e,...t];return r&&a.length>r?a.slice(0,-1):a}var zA=Symbol();function XI(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===zA?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function JI(t,e){return typeof t=="function"?t(...e):!!t}var TV=class extends dg{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!vp&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},UA=new TV;function gT(){let t,e;const r=new Promise((o,n)=>{t=o,e=n});r.status="pending",r.catch(()=>{});function a(o){Object.assign(r,o),delete r.resolve,delete r.reject}return r.resolve=o=>{a({status:"fulfilled",value:o}),t(o)},r.reject=o=>{a({status:"rejected",reason:o}),e(o)},r}var AV=bV;function EV(){let t=[],e=0,r=m=>{m()},a=m=>{m()},o=AV;const n=m=>{e?t.push(m):o(()=>{r(m)})},f=()=>{const m=t;t=[],m.length&&o(()=>{a(()=>{m.forEach(y=>{r(y)})})})};return{batch:m=>{let y;e++;try{y=m()}finally{e--,e||f()}return y},batchCalls:m=>(...y)=>{n(()=>{m(...y)})},schedule:n,setNotifyFunction:m=>{r=m},setBatchNotifyFunction:m=>{a=m},setScheduler:m=>{o=m}}}var gs=EV(),kV=class extends dg{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!vp&&window.addEventListener){const e=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(r=>{r(t)}))}isOnline(){return this.#e}},k2=new kV;function DV(t){return Math.min(1e3*2**t,3e4)}function ZI(t){return(t??"online")==="online"?k2.isOnline():!0}var yT=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function eP(t){let e=!1,r=0,a;const o=gT(),n=()=>o.status!=="pending",f=F=>{if(!n()){const O=new yT(F);R(O),t.onCancel?.(O)}},m=()=>{e=!0},y=()=>{e=!1},C=()=>UA.isFocused()&&(t.networkMode==="always"||k2.isOnline())&&t.canRun(),w=()=>ZI(t.networkMode)&&t.canRun(),A=F=>{n()||(a?.(),o.resolve(F))},R=F=>{n()||(a?.(),o.reject(F))},I=()=>new Promise(F=>{a=O=>{(n()||C())&&F(O)},t.onPause?.()}).then(()=>{a=void 0,n()||t.onContinue?.()}),M=()=>{if(n())return;let F;const O=r===0?t.initialPromise:void 0;try{F=O??t.fn()}catch(j){F=Promise.reject(j)}Promise.resolve(F).then(A).catch(j=>{if(n())return;const U=t.retry??(vp?0:3),H=t.retryDelay??DV,K=typeof H=="function"?H(r,j):H,W=U===!0||typeof U=="number"&&r<U||typeof U=="function"&&U(r,j);if(e||!W){R(j);return}r++,t.onFail?.(r,j),CV(K).then(()=>C()?void 0:I()).then(()=>{e?R(j):M()})})};return{promise:o,status:()=>o.status,cancel:f,continue:()=>(a?.(),o),cancelRetry:m,continueRetry:y,canStart:w,start:()=>(w()?M():I().then(M),o)}}var tP=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),hT(this.gcTime)&&(this.#e=up.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(vp?1/0:300*1e3))}clearGcTimeout(){this.#e&&(up.clearTimeout(this.#e),this.#e=void 0)}},RV=class extends tP{#e;#t;#n;#o;#r;#s;#i;constructor(t){super(),this.#i=!1,this.#s=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#o=t.client,this.#n=this.#o.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=KD(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){if(this.options={...this.#s,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=KD(this.options);e.data!==void 0&&(this.setState(GD(e.data,e.dataUpdatedAt)),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const r=mT(this.state.data,t,this.options);return this.#a({data:r,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),r}setState(t,e){this.#a({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(Ei).catch(Ei):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>Vl(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===zA||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Mf(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!qI(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#i?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const m=this.observers.find(y=>y.options.queryFn);m&&this.setOptions(m.options)}const r=new AbortController,a=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(this.#i=!0,r.signal)})},o=()=>{const m=XI(this.options,e),C=(()=>{const w={client:this.#o,queryKey:this.queryKey,meta:this.meta};return a(w),w})();return this.#i=!1,this.options.persister?this.options.persister(m,C,this):m(C)},f=(()=>{const m={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#o,state:this.state,fetchFn:o};return a(m),m})();this.options.behavior?.onFetch(f,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==f.fetchOptions?.meta)&&this.#a({type:"fetch",meta:f.fetchOptions?.meta}),this.#r=eP({initialPromise:e?.initialPromise,fn:f.fetchFn,onCancel:m=>{m instanceof yT&&m.revert&&this.setState({...this.#t,fetchStatus:"idle"}),r.abort()},onFail:(m,y)=>{this.#a({type:"failed",failureCount:m,error:y})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0});try{const m=await this.#r.start();if(m===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(m),this.#n.config.onSuccess?.(m,this),this.#n.config.onSettled?.(m,this.state.error,this),m}catch(m){if(m instanceof yT){if(m.silent)return this.#r.promise;if(m.revert){if(this.state.data===void 0)throw m;return this.state.data}}throw this.#a({type:"error",error:m}),this.#n.config.onError?.(m,this),this.#n.config.onSettled?.(this.state.data,m,this),m}finally{this.scheduleGc()}}#a(t){const e=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...nP(r.data,this.options),fetchMeta:t.meta??null};case"success":const a={...r,...GD(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?a:void 0,a;case"error":const o=t.error;return{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=e(this.state),gs.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function nP(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ZI(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function GD(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function KD(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,a=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var IV=class extends dg{constructor(t,e){super(),this.options=e,this.#e=t,this.#a=null,this.#i=gT(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#o=void 0;#r;#s;#i;#a;#m;#f;#h;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),YD(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return bT(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return bT(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#x(),this.#C(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,r=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Vl(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#t.setOptions(this.options),e._defaulted&&!E2(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const a=this.hasListeners();a&&qD(this.#t,r,this.options,e)&&this.#d(),this.updateResult(),a&&(this.#t!==r||Vl(this.options.enabled,this.#t)!==Vl(e.enabled,this.#t)||Mf(this.options.staleTime,this.#t)!==Mf(e.staleTime,this.#t))&&this.#g();const o=this.#y();a&&(this.#t!==r||Vl(this.options.enabled,this.#t)!==Vl(e.enabled,this.#t)||o!==this.#l)&&this.#b(o)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),r=this.createResult(e,t);return MV(this,r)&&(this.#o=r,this.#s=this.options,this.#r=this.#t.state),r}getCurrentResult(){return this.#o}trackResult(t,e){return new Proxy(t,{get:(r,a)=>(this.trackProp(a),e?.(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#i.status==="pending"&&this.#i.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,a))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),r=this.#e.getQueryCache().build(this.#e,e);return r.fetch().then(()=>this.createResult(r,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#o))}#d(t){this.#S();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Ei)),e}#g(){this.#x();const t=Mf(this.options.staleTime,this.#t);if(vp||this.#o.isStale||!hT(t))return;const r=qI(this.#o.dataUpdatedAt,t)+1;this.#c=up.setTimeout(()=>{this.#o.isStale||this.updateResult()},r)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#b(t){this.#C(),this.#l=t,!(vp||Vl(this.options.enabled,this.#t)===!1||!hT(this.#l)||this.#l===0)&&(this.#u=up.setInterval(()=>{(this.options.refetchIntervalInBackground||UA.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#b(this.#y())}#x(){this.#c&&(up.clearTimeout(this.#c),this.#c=void 0)}#C(){this.#u&&(up.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const r=this.#t,a=this.options,o=this.#o,n=this.#r,f=this.#s,y=t!==r?t.state:this.#n,{state:C}=t;let w={...C},A=!1,R;if(e._optimisticResults){const ie=this.hasListeners(),de=!ie&&YD(t,e),le=ie&&qD(t,r,e,a);(de||le)&&(w={...w,...nP(C.data,t.options)}),e._optimisticResults==="isRestoring"&&(w.fetchStatus="idle")}let{error:I,errorUpdatedAt:M,status:F}=w;R=w.data;let O=!1;if(e.placeholderData!==void 0&&R===void 0&&F==="pending"){let ie;o?.isPlaceholderData&&e.placeholderData===f?.placeholderData?(ie=o.data,O=!0):ie=typeof e.placeholderData=="function"?e.placeholderData(this.#h?.state.data,this.#h):e.placeholderData,ie!==void 0&&(F="success",R=mT(o?.data,ie,e),A=!0)}if(e.select&&R!==void 0&&!O)if(o&&R===n?.data&&e.select===this.#m)R=this.#f;else try{this.#m=e.select,R=e.select(R),R=mT(o?.data,R,e),this.#f=R,this.#a=null}catch(ie){this.#a=ie}this.#a&&(I=this.#a,R=this.#f,M=Date.now(),F="error");const j=w.fetchStatus==="fetching",U=F==="pending",H=F==="error",K=U&&j,W=R!==void 0,ee={status:F,fetchStatus:w.fetchStatus,isPending:U,isSuccess:F==="success",isError:H,isInitialLoading:K,isLoading:K,data:R,dataUpdatedAt:w.dataUpdatedAt,error:I,errorUpdatedAt:M,failureCount:w.fetchFailureCount,failureReason:w.fetchFailureReason,errorUpdateCount:w.errorUpdateCount,isFetched:w.dataUpdateCount>0||w.errorUpdateCount>0,isFetchedAfterMount:w.dataUpdateCount>y.dataUpdateCount||w.errorUpdateCount>y.errorUpdateCount,isFetching:j,isRefetching:j&&!U,isLoadingError:H&&!W,isPaused:w.fetchStatus==="paused",isPlaceholderData:A,isRefetchError:H&&W,isStale:$A(t,e),refetch:this.refetch,promise:this.#i,isEnabled:Vl(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const ie=oe=>{ee.status==="error"?oe.reject(ee.error):ee.data!==void 0&&oe.resolve(ee.data)},de=()=>{const oe=this.#i=ee.promise=gT();ie(oe)},le=this.#i;switch(le.status){case"pending":t.queryHash===r.queryHash&&ie(le);break;case"fulfilled":(ee.status==="error"||ee.data!==le.value)&&de();break;case"rejected":(ee.status!=="error"||ee.error!==le.reason)&&de();break}}return ee}updateResult(){const t=this.#o,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#s=this.options,this.#r.data!==void 0&&(this.#h=this.#t),E2(e,t))return;this.#o=e;const r=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!this.#p.size)return!0;const n=new Set(o??this.#p);return this.options.throwOnError&&n.add("error"),Object.keys(this.#o).some(f=>{const m=f;return this.#o[m]!==t[m]&&n.has(m)})};this.#w({listeners:r()})}#S(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#w(t){gs.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#o)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function PV(t,e){return Vl(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function YD(t,e){return PV(t,e)||t.state.data!==void 0&&bT(t,e,e.refetchOnMount)}function bT(t,e,r){if(Vl(e.enabled,t)!==!1&&Mf(e.staleTime,t)!=="static"){const a=typeof r=="function"?r(t):r;return a==="always"||a!==!1&&$A(t,e)}return!1}function qD(t,e,r,a){return(t!==e||Vl(a.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&$A(t,r)}function $A(t,e){return Vl(e.enabled,t)!==!1&&t.isStaleByTime(Mf(e.staleTime,t))}function MV(t,e){return!E2(t.getCurrentResult(),e)}function QD(t){return{onFetch:(e,r)=>{const a=e.options,o=e.fetchOptions?.meta?.fetchMore?.direction,n=e.state.data?.pages||[],f=e.state.data?.pageParams||[];let m={pages:[],pageParams:[]},y=0;const C=async()=>{let w=!1;const A=M=>{Object.defineProperty(M,"signal",{enumerable:!0,get:()=>(e.signal.aborted?w=!0:e.signal.addEventListener("abort",()=>{w=!0}),e.signal)})},R=XI(e.options,e.fetchOptions),I=async(M,F,O)=>{if(w)return Promise.reject();if(F==null&&M.pages.length)return Promise.resolve(M);const U=(()=>{const X={client:e.client,queryKey:e.queryKey,pageParam:F,direction:O?"backward":"forward",meta:e.options.meta};return A(X),X})(),H=await R(U),{maxPages:K}=e.options,W=O?wV:SV;return{pages:W(M.pages,H,K),pageParams:W(M.pageParams,F,K)}};if(o&&n.length){const M=o==="backward",F=M?_V:XD,O={pages:n,pageParams:f},j=F(a,O);m=await I(O,j,M)}else{const M=t??n.length;do{const F=y===0?f[0]??a.initialPageParam:XD(a,m);if(y>0&&F==null)break;m=await I(m,F),y++}while(y<M)}return m};e.options.persister?e.fetchFn=()=>e.options.persister?.(C,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r):e.fetchFn=C}}}function XD(t,{pages:e,pageParams:r}){const a=e.length-1;return e.length>0?t.getNextPageParam(e[a],e,r[a],r):void 0}function _V(t,{pages:e,pageParams:r}){return e.length>0?t.getPreviousPageParam?.(e[0],e,r[0],r):void 0}var OV=class extends tP{#e;#t;#n;#o;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#t=[],this.state=t.state||rP(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#o?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#r({type:"continue"})},r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#o=eP({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(n,f)=>{this.#r({type:"failed",failureCount:n,error:f})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",o=!this.#o.canStart();try{if(a)e();else{this.#r({type:"pending",variables:t,isPaused:o}),await this.#n.config.onMutate?.(t,this,r);const f=await this.options.onMutate?.(t,r);f!==this.state.context&&this.#r({type:"pending",context:f,variables:t,isPaused:o})}const n=await this.#o.start();return await this.#n.config.onSuccess?.(n,t,this.state.context,this,r),await this.options.onSuccess?.(n,t,this.state.context,r),await this.#n.config.onSettled?.(n,null,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(n,null,t,this.state.context,r),this.#r({type:"success",data:n}),n}catch(n){try{throw await this.#n.config.onError?.(n,t,this.state.context,this,r),await this.options.onError?.(n,t,this.state.context,r),await this.#n.config.onSettled?.(void 0,n,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(void 0,n,t,this.state.context,r),n}finally{this.#r({type:"error",error:n})}}finally{this.#n.runNext(this)}}#r(t){const e=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),gs.batch(()=>{this.#t.forEach(r=>{r.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function rP(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var FV=class extends dg{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,r){const a=new OV({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:r});return this.add(a),a}add(t){this.#e.add(t);const e=Rx(t);if(typeof e=="string"){const r=this.#t.get(e);r?r.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Rx(t);if(typeof e=="string"){const r=this.#t.get(e);if(r)if(r.length>1){const a=r.indexOf(t);a!==-1&&r.splice(a,1)}else r[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Rx(t);if(typeof e=="string"){const a=this.#t.get(e)?.find(o=>o.state.status==="pending");return!a||a===t}else return!0}runNext(t){const e=Rx(t);return typeof e=="string"?this.#t.get(e)?.find(a=>a!==t&&a.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){gs.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(r=>HD(e,r))}findAll(t={}){return this.getAll().filter(e=>HD(t,e))}notify(t){gs.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return gs.batch(()=>Promise.all(t.map(e=>e.continue().catch(Ei))))}};function Rx(t){return t.options.scope?.id}var NV=class extends dg{#e;#t=void 0;#n;#o;constructor(e,r){super(),this.#e=e,this.setOptions(r),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#e.defaultMutationOptions(e),E2(this.options,r)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),r?.mutationKey&&this.options.mutationKey&&xp(r.mutationKey)!==xp(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#s(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#s()}mutate(e,r){return this.#o=r,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??rP();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#s(e){gs.batch(()=>{if(this.#o&&this.hasListeners()){const r=this.#t.variables,a=this.#t.context,o={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#o.onSuccess?.(e.data,r,a,o),this.#o.onSettled?.(e.data,null,r,a,o)):e?.type==="error"&&(this.#o.onError?.(e.error,r,a,o),this.#o.onSettled?.(void 0,e.error,r,a,o))}this.listeners.forEach(r=>{r(this.#t)})})}},jV=class extends dg{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,r){const a=e.queryKey,o=e.queryHash??BA(a,e);let n=this.get(o);return n||(n=new RV({client:t,queryKey:a,queryHash:o,options:t.defaultQueryOptions(e),state:r,defaultOptions:t.getQueryDefaults(a)}),this.add(n)),n}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){gs.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(r=>$D(e,r))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(r=>$D(t,r)):e}notify(t){gs.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){gs.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){gs.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},LV=class{#e;#t;#n;#o;#r;#s;#i;#a;constructor(t={}){this.#e=t.queryCache||new jV,this.#t=t.mutationCache||new FV,this.#n=t.defaultOptions||{},this.#o=new Map,this.#r=new Map,this.#s=0}mount(){this.#s++,this.#s===1&&(this.#i=UA.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#a=k2.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#s--,this.#s===0&&(this.#i?.(),this.#i=void 0,this.#a?.(),this.#a=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=this.#e.build(this,e),a=r.state.data;return a===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Mf(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(a))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:r})=>{const a=r.data;return[e,a]})}setQueryData(t,e,r){const a=this.defaultQueryOptions({queryKey:t}),n=this.#e.get(a.queryHash)?.state.data,f=vV(e,n);if(f!==void 0)return this.#e.build(this,a).setData(f,{...r,manual:!0})}setQueriesData(t,e,r){return gs.batch(()=>this.#e.findAll(t).map(({queryKey:a})=>[a,this.setQueryData(a,e,r)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;gs.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=this.#e;return gs.batch(()=>(r.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},a=gs.batch(()=>this.#e.findAll(t).map(o=>o.cancel(r)));return Promise.all(a).then(Ei).catch(Ei)}invalidateQueries(t,e={}){return gs.batch(()=>(this.#e.findAll(t).forEach(r=>{r.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},a=gs.batch(()=>this.#e.findAll(t).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let n=o.fetch(void 0,r);return r.throwOnError||(n=n.catch(Ei)),o.state.fetchStatus==="paused"?Promise.resolve():n}));return Promise.all(a).then(Ei)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=this.#e.build(this,e);return r.isStaleByTime(Mf(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ei).catch(Ei)}fetchInfiniteQuery(t){return t.behavior=QD(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ei).catch(Ei)}ensureInfiniteQueryData(t){return t.behavior=QD(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return k2.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#o.set(xp(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#o.values()],r={};return e.forEach(a=>{eb(t,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(t,e){this.#r.set(xp(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],r={};return e.forEach(a=>{eb(t,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=BA(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===zA&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},oP=E.createContext(void 0),Dd=t=>{const e=E.useContext(oP);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},BV=({client:t,children:e})=>(E.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),d.jsx(oP.Provider,{value:t,children:e})),aP=E.createContext(!1),zV=()=>E.useContext(aP);aP.Provider;function UV(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var $V=E.createContext(UV()),HV=()=>E.useContext($V),WV=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},VV=t=>{E.useEffect(()=>{t.clearReset()},[t])},GV=({result:t,errorResetBoundary:e,throwOnError:r,query:a,suspense:o})=>t.isError&&!e.isReset()&&!t.isFetching&&a&&(o&&t.data===void 0||JI(r,[t.error,a])),KV=t=>{if(t.suspense){const r=o=>o==="static"?o:Math.max(o??1e3,1e3),a=t.staleTime;t.staleTime=typeof a=="function"?(...o)=>r(a(...o)):r(a),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},YV=(t,e)=>t.isLoading&&t.isFetching&&!e,qV=(t,e)=>t?.suspense&&e.isPending,JD=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function QV(t,e,r){const a=zV(),o=HV(),n=Dd(),f=n.defaultQueryOptions(t);n.getDefaultOptions().queries?._experimental_beforeQuery?.(f),f._optimisticResults=a?"isRestoring":"optimistic",KV(f),WV(f,o),VV(o);const m=!n.getQueryCache().get(f.queryHash),[y]=E.useState(()=>new e(n,f)),C=y.getOptimisticResult(f),w=!a&&t.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(A=>{const R=w?y.subscribe(gs.batchCalls(A)):Ei;return y.updateResult(),R},[y,w]),()=>y.getCurrentResult(),()=>y.getCurrentResult()),E.useEffect(()=>{y.setOptions(f)},[f,y]),qV(f,C))throw JD(f,y,o);if(GV({result:C,errorResetBoundary:o,throwOnError:f.throwOnError,query:n.getQueryCache().get(f.queryHash),suspense:f.suspense}))throw C.error;return n.getDefaultOptions().queries?._experimental_afterQuery?.(f,C),f.experimental_prefetchInRender&&!vp&&YV(C,a)&&(m?JD(f,y,o):n.getQueryCache().get(f.queryHash)?.promise)?.catch(Ei).finally(()=>{y.updateResult()}),f.notifyOnChangeProps?C:y.trackResult(C)}function zs(t,e){return QV(t,IV)}function Ua(t,e){const r=Dd(),[a]=E.useState(()=>new NV(r,t));E.useEffect(()=>{a.setOptions(t)},[a,t]);const o=E.useSyncExternalStore(E.useCallback(f=>a.subscribe(gs.batchCalls(f)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),n=E.useCallback((f,m)=>{a.mutate(f,m).catch(Ei)},[a]);if(o.error&&JI(a.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:n,mutateAsync:o.mutate}}const sP=6048e5,XV=864e5,NC=6e4,jC=36e5,JV=1e3,ZD=Symbol.for("constructDateFrom");function Xo(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&ZD in t?t[ZD](e):t instanceof Date?new t.constructor(e):new Date(e)}function lr(t,e){return Xo(e||t,t)}function LC(t,e,r){const a=lr(t,r?.in);return isNaN(e)?Xo(r?.in||t,NaN):(e&&a.setDate(a.getDate()+e),a)}function BC(t,e,r){const a=lr(t,r?.in);if(isNaN(e))return Xo(t,NaN);if(!e)return a;const o=a.getDate(),n=Xo(t,a.getTime());n.setMonth(a.getMonth()+e+1,0);const f=n.getDate();return o>=f?n:(a.setFullYear(n.getFullYear(),n.getMonth(),o),a)}function iP(t,e,r){return Xo(t,+lr(t)+e)}function ZV(t,e,r){return iP(t,e*jC)}let eG={};function Ip(){return eG}function Td(t,e){const r=Ip(),a=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=lr(t,e?.in),n=o.getDay(),f=(n<a?7:0)+n-a;return o.setDate(o.getDate()-f),o.setHours(0,0,0,0),o}function eg(t,e){return Td(t,{...e,weekStartsOn:1})}function lP(t,e){const r=lr(t,e?.in),a=r.getFullYear(),o=Xo(r,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const n=eg(o),f=Xo(r,0);f.setFullYear(a,0,4),f.setHours(0,0,0,0);const m=eg(f);return r.getTime()>=n.getTime()?a+1:r.getTime()>=m.getTime()?a:a-1}function D2(t){const e=lr(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function fg(t,...e){const r=Xo.bind(null,e.find(a=>typeof a=="object"));return e.map(r)}function tb(t,e){const r=lr(t,e?.in);return r.setHours(0,0,0,0),r}function tG(t,e,r){const[a,o]=fg(r?.in,t,e),n=tb(a),f=tb(o),m=+n-D2(n),y=+f-D2(f);return Math.round((m-y)/XV)}function nG(t,e){const r=lP(t,e),a=Xo(t,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),eg(a)}function rG(t,e,r){const a=lr(t,r?.in);return a.setTime(a.getTime()+e*NC),a}function oG(t,e,r){return iP(t,e*1e3)}function aG(t,e,r){return LC(t,e*7,r)}function sG(t,e,r){return BC(t,e*12,r)}function iG(t,e,r){const[a,o]=fg(r?.in,t,e);return+tb(a)==+tb(o)}function lG(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function cP(t){return!(!lG(t)&&typeof t!="number"||isNaN(+lr(t)))}function e5(t,e){const r=lr(t,e?.in);return r.setHours(23,59,59,999),r}function Ti(t,e){const r=lr(t,e?.in),a=r.getMonth();return r.setFullYear(r.getFullYear(),a+1,0),r.setHours(23,59,59,999),r}function uP(t,e){const[r,a]=fg(t,e.start,e.end);return{start:r,end:a}}function cG(t,e){const{start:r,end:a}=uP(e?.in,t);let o=+r>+a;const n=o?+r:+a,f=o?a:r;f.setHours(0,0,0,0);let m=1;const y=[];for(;+f<=n;)y.push(Xo(r,f)),f.setDate(f.getDate()+m),f.setHours(0,0,0,0);return o?y.reverse():y}function dP(t,e){const{start:r,end:a}=uP(e?.in,t);let o=+r>+a;const n=o?+r:+a,f=o?a:r;f.setHours(0,0,0,0),f.setDate(1);let m=1;const y=[];for(;+f<=n;)y.push(Xo(r,f)),f.setMonth(f.getMonth()+m);return o?y.reverse():y}function ga(t,e){const r=lr(t,e?.in);return r.setDate(1),r.setHours(0,0,0,0),r}function t5(t,e){const r=lr(t,e?.in),a=r.getFullYear();return r.setFullYear(a+1,0,0),r.setHours(23,59,59,999),r}function fP(t,e){const r=lr(t,e?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function uG(t,e){const r=Ip(),a=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,o=lr(t,e?.in),n=o.getDay(),f=(n<a?-7:0)+6-(n-a);return o.setDate(o.getDate()+f),o.setHours(23,59,59,999),o}const dG={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fG=(t,e,r)=>{let a;const o=dG[t];return typeof o=="string"?a=o:e===1?a=o.one:a=o.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function mw(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const hG={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},pG={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},mG={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gG={date:mw({formats:hG,defaultWidth:"full"}),time:mw({formats:pG,defaultWidth:"full"}),dateTime:mw({formats:mG,defaultWidth:"full"})},yG={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},bG=(t,e,r,a)=>yG[t];function my(t){return(e,r)=>{const a=r?.context?String(r.context):"standalone";let o;if(a==="formatting"&&t.formattingValues){const f=t.defaultFormattingWidth||t.defaultWidth,m=r?.width?String(r.width):f;o=t.formattingValues[m]||t.formattingValues[f]}else{const f=t.defaultWidth,m=r?.width?String(r.width):t.defaultWidth;o=t.values[m]||t.values[f]}const n=t.argumentCallback?t.argumentCallback(e):e;return o[n]}}const vG={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xG={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},CG={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},SG={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wG={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},TG={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},AG=(t,e)=>{const r=Number(t),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},EG={ordinalNumber:AG,era:my({values:vG,defaultWidth:"wide"}),quarter:my({values:xG,defaultWidth:"wide",argumentCallback:t=>t-1}),month:my({values:CG,defaultWidth:"wide"}),day:my({values:SG,defaultWidth:"wide"}),dayPeriod:my({values:wG,defaultWidth:"wide",formattingValues:TG,defaultFormattingWidth:"wide"})};function gy(t){return(e,r={})=>{const a=r.width,o=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],n=e.match(o);if(!n)return null;const f=n[0],m=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth],y=Array.isArray(m)?DG(m,A=>A.test(f)):kG(m,A=>A.test(f));let C;C=t.valueCallback?t.valueCallback(y):y,C=r.valueCallback?r.valueCallback(C):C;const w=e.slice(f.length);return{value:C,rest:w}}}function kG(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function DG(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function RG(t){return(e,r={})=>{const a=e.match(t.matchPattern);if(!a)return null;const o=a[0],n=e.match(t.parsePattern);if(!n)return null;let f=t.valueCallback?t.valueCallback(n[0]):n[0];f=r.valueCallback?r.valueCallback(f):f;const m=e.slice(o.length);return{value:f,rest:m}}}const IG=/^(\d+)(th|st|nd|rd)?/i,PG=/\d+/i,MG={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_G={any:[/^b/i,/^(a|c)/i]},OG={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},FG={any:[/1/i,/2/i,/3/i,/4/i]},NG={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},jG={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},LG={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},BG={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},zG={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},UG={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$G={ordinalNumber:RG({matchPattern:IG,parsePattern:PG,valueCallback:t=>parseInt(t,10)}),era:gy({matchPatterns:MG,defaultMatchWidth:"wide",parsePatterns:_G,defaultParseWidth:"any"}),quarter:gy({matchPatterns:OG,defaultMatchWidth:"wide",parsePatterns:FG,defaultParseWidth:"any",valueCallback:t=>t+1}),month:gy({matchPatterns:NG,defaultMatchWidth:"wide",parsePatterns:jG,defaultParseWidth:"any"}),day:gy({matchPatterns:LG,defaultMatchWidth:"wide",parsePatterns:BG,defaultParseWidth:"any"}),dayPeriod:gy({matchPatterns:zG,defaultMatchWidth:"any",parsePatterns:UG,defaultParseWidth:"any"})},HA={code:"en-US",formatDistance:fG,formatLong:gG,formatRelative:bG,localize:EG,match:$G,options:{weekStartsOn:0,firstWeekContainsDate:1}};function HG(t,e){const r=lr(t,e?.in);return tG(r,fP(r))+1}function hP(t,e){const r=lr(t,e?.in),a=+eg(r)-+nG(r);return Math.round(a/sP)+1}function WA(t,e){const r=lr(t,e?.in),a=r.getFullYear(),o=Ip(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,f=Xo(e?.in||t,0);f.setFullYear(a+1,0,n),f.setHours(0,0,0,0);const m=Td(f,e),y=Xo(e?.in||t,0);y.setFullYear(a,0,n),y.setHours(0,0,0,0);const C=Td(y,e);return+r>=+m?a+1:+r>=+C?a:a-1}function WG(t,e){const r=Ip(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=WA(t,e),n=Xo(e?.in||t,0);return n.setFullYear(o,0,a),n.setHours(0,0,0,0),Td(n,e)}function VA(t,e){const r=lr(t,e?.in),a=+Td(r,e)-+WG(r,e);return Math.round(a/sP)+1}function jo(t,e){const r=t<0?"-":"",a=Math.abs(t).toString().padStart(e,"0");return r+a}const Sf={y(t,e){const r=t.getFullYear(),a=r>0?r:1-r;return jo(e==="yy"?a%100:a,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):jo(r+1,2)},d(t,e){return jo(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return jo(t.getHours()%12||12,e.length)},H(t,e){return jo(t.getHours(),e.length)},m(t,e){return jo(t.getMinutes(),e.length)},s(t,e){return jo(t.getSeconds(),e.length)},S(t,e){const r=e.length,a=t.getMilliseconds(),o=Math.trunc(a*Math.pow(10,r-3));return jo(o,e.length)}},Sm={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},n5={G:function(t,e,r){const a=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const a=t.getFullYear(),o=a>0?a:1-a;return r.ordinalNumber(o,{unit:"year"})}return Sf.y(t,e)},Y:function(t,e,r,a){const o=WA(t,a),n=o>0?o:1-o;if(e==="YY"){const f=n%100;return jo(f,2)}return e==="Yo"?r.ordinalNumber(n,{unit:"year"}):jo(n,e.length)},R:function(t,e){const r=lP(t);return jo(r,e.length)},u:function(t,e){const r=t.getFullYear();return jo(r,e.length)},Q:function(t,e,r){const a=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(a);case"QQ":return jo(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,e,r){const a=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(a);case"qq":return jo(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,e,r){const a=t.getMonth();switch(e){case"M":case"MM":return Sf.M(t,e);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(t,e,r){const a=t.getMonth();switch(e){case"L":return String(a+1);case"LL":return jo(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(t,e,r,a){const o=VA(t,a);return e==="wo"?r.ordinalNumber(o,{unit:"week"}):jo(o,e.length)},I:function(t,e,r){const a=hP(t);return e==="Io"?r.ordinalNumber(a,{unit:"week"}):jo(a,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Sf.d(t,e)},D:function(t,e,r){const a=HG(t);return e==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):jo(a,e.length)},E:function(t,e,r){const a=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(t,e,r,a){const o=t.getDay(),n=(o-a.weekStartsOn+8)%7||7;switch(e){case"e":return String(n);case"ee":return jo(n,2);case"eo":return r.ordinalNumber(n,{unit:"day"});case"eee":return r.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(o,{width:"short",context:"formatting"});case"eeee":default:return r.day(o,{width:"wide",context:"formatting"})}},c:function(t,e,r,a){const o=t.getDay(),n=(o-a.weekStartsOn+8)%7||7;switch(e){case"c":return String(n);case"cc":return jo(n,e.length);case"co":return r.ordinalNumber(n,{unit:"day"});case"ccc":return r.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(o,{width:"narrow",context:"standalone"});case"cccccc":return r.day(o,{width:"short",context:"standalone"});case"cccc":default:return r.day(o,{width:"wide",context:"standalone"})}},i:function(t,e,r){const a=t.getDay(),o=a===0?7:a;switch(e){case"i":return String(o);case"ii":return jo(o,e.length);case"io":return r.ordinalNumber(o,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(t,e,r){const o=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,e,r){const a=t.getHours();let o;switch(a===12?o=Sm.noon:a===0?o=Sm.midnight:o=a/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,e,r){const a=t.getHours();let o;switch(a>=17?o=Sm.evening:a>=12?o=Sm.afternoon:a>=4?o=Sm.morning:o=Sm.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let a=t.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Sf.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Sf.H(t,e)},K:function(t,e,r){const a=t.getHours()%12;return e==="Ko"?r.ordinalNumber(a,{unit:"hour"}):jo(a,e.length)},k:function(t,e,r){let a=t.getHours();return a===0&&(a=24),e==="ko"?r.ordinalNumber(a,{unit:"hour"}):jo(a,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Sf.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Sf.s(t,e)},S:function(t,e){return Sf.S(t,e)},X:function(t,e,r){const a=t.getTimezoneOffset();if(a===0)return"Z";switch(e){case"X":return o5(a);case"XXXX":case"XX":return np(a);case"XXXXX":case"XXX":default:return np(a,":")}},x:function(t,e,r){const a=t.getTimezoneOffset();switch(e){case"x":return o5(a);case"xxxx":case"xx":return np(a);case"xxxxx":case"xxx":default:return np(a,":")}},O:function(t,e,r){const a=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+r5(a,":");case"OOOO":default:return"GMT"+np(a,":")}},z:function(t,e,r){const a=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+r5(a,":");case"zzzz":default:return"GMT"+np(a,":")}},t:function(t,e,r){const a=Math.trunc(+t/1e3);return jo(a,e.length)},T:function(t,e,r){return jo(+t,e.length)}};function r5(t,e=""){const r=t>0?"-":"+",a=Math.abs(t),o=Math.trunc(a/60),n=a%60;return n===0?r+String(o):r+String(o)+e+jo(n,2)}function o5(t,e){return t%60===0?(t>0?"-":"+")+jo(Math.abs(t)/60,2):np(t,e)}function np(t,e=""){const r=t>0?"-":"+",a=Math.abs(t),o=jo(Math.trunc(a/60),2),n=jo(a%60,2);return r+o+e+n}const a5=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},pP=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},VG=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],a=r[1],o=r[2];if(!o)return a5(t,e);let n;switch(a){case"P":n=e.dateTime({width:"short"});break;case"PP":n=e.dateTime({width:"medium"});break;case"PPP":n=e.dateTime({width:"long"});break;case"PPPP":default:n=e.dateTime({width:"full"});break}return n.replace("{{date}}",a5(a,e)).replace("{{time}}",pP(o,e))},R2={p:pP,P:VG},GG=/^D+$/,KG=/^Y+$/,YG=["D","DD","YY","YYYY"];function mP(t){return GG.test(t)}function gP(t){return KG.test(t)}function vT(t,e,r){const a=qG(t,e,r);if(console.warn(a),YG.includes(t))throw new RangeError(a)}function qG(t,e,r){const a=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const QG=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,XG=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,JG=/^'([^]*?)'?$/,ZG=/''/g,eK=/[a-zA-Z]/;function In(t,e,r){const a=Ip(),o=r?.locale??a.locale??HA,n=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,f=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,m=lr(t,r?.in);if(!cP(m))throw new RangeError("Invalid time value");let y=e.match(XG).map(w=>{const A=w[0];if(A==="p"||A==="P"){const R=R2[A];return R(w,o.formatLong)}return w}).join("").match(QG).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const A=w[0];if(A==="'")return{isToken:!1,value:tK(w)};if(n5[A])return{isToken:!0,value:w};if(A.match(eK))throw new RangeError("Format string contains an unescaped latin alphabet character `"+A+"`");return{isToken:!1,value:w}});o.localize.preprocessor&&(y=o.localize.preprocessor(m,y));const C={firstWeekContainsDate:n,weekStartsOn:f,locale:o};return y.map(w=>{if(!w.isToken)return w.value;const A=w.value;(!r?.useAdditionalWeekYearTokens&&gP(A)||!r?.useAdditionalDayOfYearTokens&&mP(A))&&vT(A,e,String(t));const R=n5[A[0]];return R(m,A,o.localize,C)}).join("")}function tK(t){const e=t.match(JG);return e?e[1].replace(ZG,"'"):t}function nK(t,e){return lr(t,e?.in).getDate()}function gw(t,e){return lr(t,e?.in).getDay()}function yP(t,e){const r=lr(t,e?.in),a=r.getFullYear(),o=r.getMonth(),n=Xo(r,0);return n.setFullYear(a,o+1,0),n.setHours(0,0,0,0),n.getDate()}function rK(){return Object.assign({},Ip())}function oK(t,e){return lr(t,e?.in).getHours()}function aK(t,e){const r=lr(t,e?.in).getDay();return r===0?7:r}function sK(t){return lr(t).getMilliseconds()}function iK(t,e){return lr(t,e?.in).getMinutes()}function bP(t,e){return lr(t,e?.in).getMonth()}function lK(t){return lr(t).getSeconds()}function xT(t,e){return lr(t,e?.in).getFullYear()}function yu(t,e){return+lr(t)>+lr(e)}function bu(t,e){return+lr(t)<+lr(e)}function cK(t,e){return+lr(t)==+lr(e)}function uK(t,e){const r=dK(e)?new e(0):Xo(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function dK(t){return typeof t=="function"&&t.prototype?.constructor===t}const fK=10;class vP{subPriority=0;validate(e,r){return!0}}class hK extends vP{constructor(e,r,a,o,n){super(),this.value=e,this.validateValue=r,this.setValue=a,this.priority=o,n&&(this.subPriority=n)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,a){return this.setValue(e,r,this.value,a)}}class pK extends vP{priority=fK;subPriority=-1;constructor(e,r){super(),this.context=e||(a=>Xo(r,a))}set(e,r){return r.timestampIsSet?e:Xo(e,uK(e,this.context))}}class To{run(e,r,a,o){const n=this.parse(e,r,a,o);return n?{setter:new hK(n.value,this.validate,this.set,this.priority,this.subPriority),rest:n.rest}:null}validate(e,r,a){return!0}}class mK extends To{priority=140;parse(e,r,a){switch(r){case"G":case"GG":case"GGG":return a.era(e,{width:"abbreviated"})||a.era(e,{width:"narrow"});case"GGGGG":return a.era(e,{width:"narrow"});case"GGGG":default:return a.era(e,{width:"wide"})||a.era(e,{width:"abbreviated"})||a.era(e,{width:"narrow"})}}set(e,r,a){return r.era=a,e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]}const Xa={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},vu={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Ja(t,e){return t&&{value:e(t.value),rest:t.rest}}function Ea(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function xu(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const a=r[1]==="+"?1:-1,o=r[2]?parseInt(r[2],10):0,n=r[3]?parseInt(r[3],10):0,f=r[5]?parseInt(r[5],10):0;return{value:a*(o*jC+n*NC+f*JV),rest:e.slice(r[0].length)}}function xP(t){return Ea(Xa.anyDigitsSigned,t)}function Ha(t,e){switch(t){case 1:return Ea(Xa.singleDigit,e);case 2:return Ea(Xa.twoDigits,e);case 3:return Ea(Xa.threeDigits,e);case 4:return Ea(Xa.fourDigits,e);default:return Ea(new RegExp("^\\d{1,"+t+"}"),e)}}function I2(t,e){switch(t){case 1:return Ea(Xa.singleDigitSigned,e);case 2:return Ea(Xa.twoDigitsSigned,e);case 3:return Ea(Xa.threeDigitsSigned,e);case 4:return Ea(Xa.fourDigitsSigned,e);default:return Ea(new RegExp("^-?\\d{1,"+t+"}"),e)}}function GA(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function CP(t,e){const r=e>0,a=r?e:1-e;let o;if(a<=50)o=t||100;else{const n=a+50,f=Math.trunc(n/100)*100,m=t>=n%100;o=t+f-(m?100:0)}return r?o:1-o}function SP(t){return t%400===0||t%4===0&&t%100!==0}class gK extends To{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,r,a){const o=n=>({year:n,isTwoDigitYear:r==="yy"});switch(r){case"y":return Ja(Ha(4,e),o);case"yo":return Ja(a.ordinalNumber(e,{unit:"year"}),o);default:return Ja(Ha(r.length,e),o)}}validate(e,r){return r.isTwoDigitYear||r.year>0}set(e,r,a){const o=e.getFullYear();if(a.isTwoDigitYear){const f=CP(a.year,o);return e.setFullYear(f,0,1),e.setHours(0,0,0,0),e}const n=!("era"in r)||r.era===1?a.year:1-a.year;return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}}class yK extends To{priority=130;parse(e,r,a){const o=n=>({year:n,isTwoDigitYear:r==="YY"});switch(r){case"Y":return Ja(Ha(4,e),o);case"Yo":return Ja(a.ordinalNumber(e,{unit:"year"}),o);default:return Ja(Ha(r.length,e),o)}}validate(e,r){return r.isTwoDigitYear||r.year>0}set(e,r,a,o){const n=WA(e,o);if(a.isTwoDigitYear){const m=CP(a.year,n);return e.setFullYear(m,0,o.firstWeekContainsDate),e.setHours(0,0,0,0),Td(e,o)}const f=!("era"in r)||r.era===1?a.year:1-a.year;return e.setFullYear(f,0,o.firstWeekContainsDate),e.setHours(0,0,0,0),Td(e,o)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class bK extends To{priority=130;parse(e,r){return I2(r==="R"?4:r.length,e)}set(e,r,a){const o=Xo(e,0);return o.setFullYear(a,0,4),o.setHours(0,0,0,0),eg(o)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class vK extends To{priority=130;parse(e,r){return I2(r==="u"?4:r.length,e)}set(e,r,a){return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class xK extends To{priority=120;parse(e,r,a){switch(r){case"Q":case"QQ":return Ha(r.length,e);case"Qo":return a.ordinalNumber(e,{unit:"quarter"});case"QQQ":return a.quarter(e,{width:"abbreviated",context:"formatting"})||a.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(e,{width:"wide",context:"formatting"})||a.quarter(e,{width:"abbreviated",context:"formatting"})||a.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=1&&r<=4}set(e,r,a){return e.setMonth((a-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class CK extends To{priority=120;parse(e,r,a){switch(r){case"q":case"qq":return Ha(r.length,e);case"qo":return a.ordinalNumber(e,{unit:"quarter"});case"qqq":return a.quarter(e,{width:"abbreviated",context:"standalone"})||a.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(e,{width:"wide",context:"standalone"})||a.quarter(e,{width:"abbreviated",context:"standalone"})||a.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=1&&r<=4}set(e,r,a){return e.setMonth((a-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class SK extends To{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,r,a){const o=n=>n-1;switch(r){case"M":return Ja(Ea(Xa.month,e),o);case"MM":return Ja(Ha(2,e),o);case"Mo":return Ja(a.ordinalNumber(e,{unit:"month"}),o);case"MMM":return a.month(e,{width:"abbreviated",context:"formatting"})||a.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(e,{width:"wide",context:"formatting"})||a.month(e,{width:"abbreviated",context:"formatting"})||a.month(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=11}set(e,r,a){return e.setMonth(a,1),e.setHours(0,0,0,0),e}}class wK extends To{priority=110;parse(e,r,a){const o=n=>n-1;switch(r){case"L":return Ja(Ea(Xa.month,e),o);case"LL":return Ja(Ha(2,e),o);case"Lo":return Ja(a.ordinalNumber(e,{unit:"month"}),o);case"LLL":return a.month(e,{width:"abbreviated",context:"standalone"})||a.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(e,{width:"wide",context:"standalone"})||a.month(e,{width:"abbreviated",context:"standalone"})||a.month(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=0&&r<=11}set(e,r,a){return e.setMonth(a,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function TK(t,e,r){const a=lr(t,r?.in),o=VA(a,r)-e;return a.setDate(a.getDate()-o*7),lr(a,r?.in)}class AK extends To{priority=100;parse(e,r,a){switch(r){case"w":return Ea(Xa.week,e);case"wo":return a.ordinalNumber(e,{unit:"week"});default:return Ha(r.length,e)}}validate(e,r){return r>=1&&r<=53}set(e,r,a,o){return Td(TK(e,a,o),o)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function EK(t,e,r){const a=lr(t,r?.in),o=hP(a,r)-e;return a.setDate(a.getDate()-o*7),a}class kK extends To{priority=100;parse(e,r,a){switch(r){case"I":return Ea(Xa.week,e);case"Io":return a.ordinalNumber(e,{unit:"week"});default:return Ha(r.length,e)}}validate(e,r){return r>=1&&r<=53}set(e,r,a){return eg(EK(e,a))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const DK=[31,28,31,30,31,30,31,31,30,31,30,31],RK=[31,29,31,30,31,30,31,31,30,31,30,31];class IK extends To{priority=90;subPriority=1;parse(e,r,a){switch(r){case"d":return Ea(Xa.date,e);case"do":return a.ordinalNumber(e,{unit:"date"});default:return Ha(r.length,e)}}validate(e,r){const a=e.getFullYear(),o=SP(a),n=e.getMonth();return o?r>=1&&r<=RK[n]:r>=1&&r<=DK[n]}set(e,r,a){return e.setDate(a),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class PK extends To{priority=90;subpriority=1;parse(e,r,a){switch(r){case"D":case"DD":return Ea(Xa.dayOfYear,e);case"Do":return a.ordinalNumber(e,{unit:"date"});default:return Ha(r.length,e)}}validate(e,r){const a=e.getFullYear();return SP(a)?r>=1&&r<=366:r>=1&&r<=365}set(e,r,a){return e.setMonth(0,a),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function KA(t,e,r){const a=Ip(),o=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,n=lr(t,r?.in),f=n.getDay(),y=(e%7+7)%7,C=7-o,w=e<0||e>6?e-(f+C)%7:(y+C)%7-(f+C)%7;return LC(n,w,r)}class MK extends To{priority=90;parse(e,r,a){switch(r){case"E":case"EE":case"EEE":return a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(e,{width:"wide",context:"formatting"})||a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=6}set(e,r,a,o){return e=KA(e,a,o),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]}class _K extends To{priority=90;parse(e,r,a,o){const n=f=>{const m=Math.floor((f-1)/7)*7;return(f+o.weekStartsOn+6)%7+m};switch(r){case"e":case"ee":return Ja(Ha(r.length,e),n);case"eo":return Ja(a.ordinalNumber(e,{unit:"day"}),n);case"eee":return a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"});case"eeeee":return a.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(e,{width:"wide",context:"formatting"})||a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=6}set(e,r,a,o){return e=KA(e,a,o),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class OK extends To{priority=90;parse(e,r,a,o){const n=f=>{const m=Math.floor((f-1)/7)*7;return(f+o.weekStartsOn+6)%7+m};switch(r){case"c":case"cc":return Ja(Ha(r.length,e),n);case"co":return Ja(a.ordinalNumber(e,{unit:"day"}),n);case"ccc":return a.day(e,{width:"abbreviated",context:"standalone"})||a.day(e,{width:"short",context:"standalone"})||a.day(e,{width:"narrow",context:"standalone"});case"ccccc":return a.day(e,{width:"narrow",context:"standalone"});case"cccccc":return a.day(e,{width:"short",context:"standalone"})||a.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(e,{width:"wide",context:"standalone"})||a.day(e,{width:"abbreviated",context:"standalone"})||a.day(e,{width:"short",context:"standalone"})||a.day(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=0&&r<=6}set(e,r,a,o){return e=KA(e,a,o),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function FK(t,e,r){const a=lr(t,r?.in),o=aK(a,r),n=e-o;return LC(a,n,r)}class NK extends To{priority=90;parse(e,r,a){const o=n=>n===0?7:n;switch(r){case"i":case"ii":return Ha(r.length,e);case"io":return a.ordinalNumber(e,{unit:"day"});case"iii":return Ja(a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"}),o);case"iiiii":return Ja(a.day(e,{width:"narrow",context:"formatting"}),o);case"iiiiii":return Ja(a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"}),o);case"iiii":default:return Ja(a.day(e,{width:"wide",context:"formatting"})||a.day(e,{width:"abbreviated",context:"formatting"})||a.day(e,{width:"short",context:"formatting"})||a.day(e,{width:"narrow",context:"formatting"}),o)}}validate(e,r){return r>=1&&r<=7}set(e,r,a){return e=FK(e,a),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class jK extends To{priority=80;parse(e,r,a){switch(r){case"a":case"aa":case"aaa":return a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(e,{width:"wide",context:"formatting"})||a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,a){return e.setHours(GA(a),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]}class LK extends To{priority=80;parse(e,r,a){switch(r){case"b":case"bb":case"bbb":return a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(e,{width:"wide",context:"formatting"})||a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,a){return e.setHours(GA(a),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]}class BK extends To{priority=80;parse(e,r,a){switch(r){case"B":case"BB":case"BBB":return a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(e,{width:"wide",context:"formatting"})||a.dayPeriod(e,{width:"abbreviated",context:"formatting"})||a.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,a){return e.setHours(GA(a),0,0,0),e}incompatibleTokens=["a","b","t","T"]}class zK extends To{priority=70;parse(e,r,a){switch(r){case"h":return Ea(Xa.hour12h,e);case"ho":return a.ordinalNumber(e,{unit:"hour"});default:return Ha(r.length,e)}}validate(e,r){return r>=1&&r<=12}set(e,r,a){const o=e.getHours()>=12;return o&&a<12?e.setHours(a+12,0,0,0):!o&&a===12?e.setHours(0,0,0,0):e.setHours(a,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]}class UK extends To{priority=70;parse(e,r,a){switch(r){case"H":return Ea(Xa.hour23h,e);case"Ho":return a.ordinalNumber(e,{unit:"hour"});default:return Ha(r.length,e)}}validate(e,r){return r>=0&&r<=23}set(e,r,a){return e.setHours(a,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]}class $K extends To{priority=70;parse(e,r,a){switch(r){case"K":return Ea(Xa.hour11h,e);case"Ko":return a.ordinalNumber(e,{unit:"hour"});default:return Ha(r.length,e)}}validate(e,r){return r>=0&&r<=11}set(e,r,a){return e.getHours()>=12&&a<12?e.setHours(a+12,0,0,0):e.setHours(a,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]}class HK extends To{priority=70;parse(e,r,a){switch(r){case"k":return Ea(Xa.hour24h,e);case"ko":return a.ordinalNumber(e,{unit:"hour"});default:return Ha(r.length,e)}}validate(e,r){return r>=1&&r<=24}set(e,r,a){const o=a<=24?a%24:a;return e.setHours(o,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]}class WK extends To{priority=60;parse(e,r,a){switch(r){case"m":return Ea(Xa.minute,e);case"mo":return a.ordinalNumber(e,{unit:"minute"});default:return Ha(r.length,e)}}validate(e,r){return r>=0&&r<=59}set(e,r,a){return e.setMinutes(a,0,0),e}incompatibleTokens=["t","T"]}class VK extends To{priority=50;parse(e,r,a){switch(r){case"s":return Ea(Xa.second,e);case"so":return a.ordinalNumber(e,{unit:"second"});default:return Ha(r.length,e)}}validate(e,r){return r>=0&&r<=59}set(e,r,a){return e.setSeconds(a,0),e}incompatibleTokens=["t","T"]}class GK extends To{priority=30;parse(e,r){const a=o=>Math.trunc(o*Math.pow(10,-r.length+3));return Ja(Ha(r.length,e),a)}set(e,r,a){return e.setMilliseconds(a),e}incompatibleTokens=["t","T"]}class KK extends To{priority=10;parse(e,r){switch(r){case"X":return xu(vu.basicOptionalMinutes,e);case"XX":return xu(vu.basic,e);case"XXXX":return xu(vu.basicOptionalSeconds,e);case"XXXXX":return xu(vu.extendedOptionalSeconds,e);case"XXX":default:return xu(vu.extended,e)}}set(e,r,a){return r.timestampIsSet?e:Xo(e,e.getTime()-D2(e)-a)}incompatibleTokens=["t","T","x"]}class YK extends To{priority=10;parse(e,r){switch(r){case"x":return xu(vu.basicOptionalMinutes,e);case"xx":return xu(vu.basic,e);case"xxxx":return xu(vu.basicOptionalSeconds,e);case"xxxxx":return xu(vu.extendedOptionalSeconds,e);case"xxx":default:return xu(vu.extended,e)}}set(e,r,a){return r.timestampIsSet?e:Xo(e,e.getTime()-D2(e)-a)}incompatibleTokens=["t","T","X"]}class qK extends To{priority=40;parse(e){return xP(e)}set(e,r,a){return[Xo(e,a*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class QK extends To{priority=20;parse(e){return xP(e)}set(e,r,a){return[Xo(e,a),{timestampIsSet:!0}]}incompatibleTokens="*"}const XK={G:new mK,y:new gK,Y:new yK,R:new bK,u:new vK,Q:new xK,q:new CK,M:new SK,L:new wK,w:new AK,I:new kK,d:new IK,D:new PK,E:new MK,e:new _K,c:new OK,i:new NK,a:new jK,b:new LK,B:new BK,h:new zK,H:new UK,K:new $K,k:new HK,m:new WK,s:new VK,S:new GK,X:new KK,x:new YK,t:new qK,T:new QK},JK=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ZK=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eY=/^'([^]*?)'?$/,tY=/''/g,nY=/\S/,rY=/[a-zA-Z]/;function YA(t,e,r,a){const o=()=>Xo(a?.in||r,NaN),n=rK(),f=a?.locale??n.locale??HA,m=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,y=a?.weekStartsOn??a?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0;if(!e)return t?o():lr(r,a?.in);const C={firstWeekContainsDate:m,weekStartsOn:y,locale:f},w=[new pK(a?.in,r)],A=e.match(ZK).map(O=>{const j=O[0];if(j in R2){const U=R2[j];return U(O,f.formatLong)}return O}).join("").match(JK),R=[];for(let O of A){!a?.useAdditionalWeekYearTokens&&gP(O)&&vT(O,e,t),!a?.useAdditionalDayOfYearTokens&&mP(O)&&vT(O,e,t);const j=O[0],U=XK[j];if(U){const{incompatibleTokens:H}=U;if(Array.isArray(H)){const W=R.find(X=>H.includes(X.token)||X.token===j);if(W)throw new RangeError(`The format string mustn't contain \`${W.fullToken}\` and \`${O}\` at the same time`)}else if(U.incompatibleTokens==="*"&&R.length>0)throw new RangeError(`The format string mustn't contain \`${O}\` and any other token at the same time`);R.push({token:j,fullToken:O});const K=U.run(t,O,f.match,C);if(!K)return o();w.push(K.setter),t=K.rest}else{if(j.match(rY))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(O==="''"?O="'":j==="'"&&(O=oY(O)),t.indexOf(O)===0)t=t.slice(O.length);else return o()}}if(t.length>0&&nY.test(t))return o();const I=w.map(O=>O.priority).sort((O,j)=>j-O).filter((O,j,U)=>U.indexOf(O)===j).map(O=>w.filter(j=>j.priority===O).sort((j,U)=>U.subPriority-j.subPriority)).map(O=>O[0]);let M=lr(r,a?.in);if(isNaN(+M))return o();const F={};for(const O of I){if(!O.validate(M,C))return o();const j=O.set(M,F,C);Array.isArray(j)?(M=j[0],Object.assign(F,j[1])):M=j}return M}function oY(t){return t.match(eY)[1].replace(tY,"'")}function s5(t,e){const r=lr(t,e?.in);return r.setMinutes(0,0,0),r}function aY(t,e,r){const[a,o]=fg(r?.in,t,e);return+s5(a)==+s5(o)}function sY(t,e,r){const[a,o]=fg(r?.in,t,e);return a.getFullYear()===o.getFullYear()&&a.getMonth()===o.getMonth()}function iY(t,e,r){const[a,o]=fg(r?.in,t,e);return a.getFullYear()===o.getFullYear()}function Ya(t,e,r){const a=+lr(t,r?.in),[o,n]=[+lr(e.start,r?.in),+lr(e.end,r?.in)].sort((f,m)=>f-m);return a>=o&&a<=n}function Hl(t,e){const r=()=>Xo(e?.in,NaN),o=dY(t);let n;if(o.date){const C=fY(o.date,2);n=hY(C.restDateString,C.year)}if(!n||isNaN(+n))return r();const f=+n;let m=0,y;if(o.time&&(m=pY(o.time),isNaN(m)))return r();if(o.timezone){if(y=mY(o.timezone),isNaN(y))return r()}else{const C=new Date(f+m),w=lr(0,e?.in);return w.setFullYear(C.getUTCFullYear(),C.getUTCMonth(),C.getUTCDate()),w.setHours(C.getUTCHours(),C.getUTCMinutes(),C.getUTCSeconds(),C.getUTCMilliseconds()),w}return lr(f+m+y,e?.in)}const Ix={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},lY=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,cY=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,uY=/^([+-])(\d{2})(?::?(\d{2}))?$/;function dY(t){const e={},r=t.split(Ix.dateTimeDelimiter);let a;if(r.length>2)return e;if(/:/.test(r[0])?a=r[0]:(e.date=r[0],a=r[1],Ix.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Ix.timeZoneDelimiter)[0],a=t.substr(e.date.length,t.length))),a){const o=Ix.timezone.exec(a);o?(e.time=a.replace(o[1],""),e.timezone=o[1]):e.time=a}return e}function fY(t,e){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),a=t.match(r);if(!a)return{year:NaN,restDateString:""};const o=a[1]?parseInt(a[1]):null,n=a[2]?parseInt(a[2]):null;return{year:n===null?o:n*100,restDateString:t.slice((a[1]||a[2]).length)}}function hY(t,e){if(e===null)return new Date(NaN);const r=t.match(lY);if(!r)return new Date(NaN);const a=!!r[4],o=yy(r[1]),n=yy(r[2])-1,f=yy(r[3]),m=yy(r[4]),y=yy(r[5])-1;if(a)return xY(e,m,y)?gY(e,m,y):new Date(NaN);{const C=new Date(0);return!bY(e,n,f)||!vY(e,o)?new Date(NaN):(C.setUTCFullYear(e,n,Math.max(o,f)),C)}}function yy(t){return t?parseInt(t):1}function pY(t){const e=t.match(cY);if(!e)return NaN;const r=yw(e[1]),a=yw(e[2]),o=yw(e[3]);return CY(r,a,o)?r*jC+a*NC+o*1e3:NaN}function yw(t){return t&&parseFloat(t.replace(",","."))||0}function mY(t){if(t==="Z")return 0;const e=t.match(uY);if(!e)return 0;const r=e[1]==="+"?-1:1,a=parseInt(e[2]),o=e[3]&&parseInt(e[3])||0;return SY(a,o)?r*(a*jC+o*NC):NaN}function gY(t,e,r){const a=new Date(0);a.setUTCFullYear(t,0,4);const o=a.getUTCDay()||7,n=(e-1)*7+r+1-o;return a.setUTCDate(a.getUTCDate()+n),a}const yY=[31,null,31,30,31,30,31,31,30,31,30,31];function wP(t){return t%400===0||t%4===0&&t%100!==0}function bY(t,e,r){return e>=0&&e<=11&&r>=1&&r<=(yY[e]||(wP(t)?29:28))}function vY(t,e){return e>=1&&e<=(wP(t)?366:365)}function xY(t,e,r){return e>=1&&e<=53&&r>=0&&r<=6}function CY(t,e,r){return t===24?e===0&&r===0:r>=0&&r<60&&e>=0&&e<60&&t>=0&&t<25}function SY(t,e){return e>=0&&e<=59}function wY(t,e,r){const a=lr(t,r?.in),o=a.getFullYear(),n=a.getDate(),f=Xo(t,0);f.setFullYear(o,e,15),f.setHours(0,0,0,0);const m=yP(f);return a.setMonth(e,Math.min(n,m)),a}function TY(t,e,r){const a=lr(t,r?.in);return a.setDate(e),a}function AY(t,e,r){const a=lr(t,r?.in);return a.setHours(e),a}function EY(t,e,r){const a=lr(t,r?.in);return a.setMilliseconds(e),a}function kY(t,e,r){const a=lr(t,r?.in);return a.setMinutes(e),a}function DY(t,e,r){const a=lr(t,r?.in);return a.setSeconds(e),a}function RY(t,e,r){const a=lr(t,r?.in);return isNaN(+a)?Xo(t,NaN):(a.setFullYear(e),a)}const zt={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},If={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},dp={GET:"GET",POST:"POST"},hg=[zt.OPENID_SCOPE,zt.PROFILE_SCOPE,zt.OFFLINE_ACCESS_SCOPE],i5=[...hg,zt.EMAIL_SCOPE],Ai={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},l5={ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},_f={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Px={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Us={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",NO_SESSION:"no_session"},qA={CODE:"code",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"},zC={QUERY:"query",FRAGMENT:"fragment"},IY={QUERY:"query"},TP={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},Mx={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},nb={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},Ls={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},QA="appmetadata",PY="client_info",P2="1",M2={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},gl={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},js={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Lo={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Ny={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},c5={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},wm={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},bw={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},rp={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},MY={Pop:"pop"},AP=300;const _2="unexpected_error",_Y="post_request_failed";const u5={[_2]:"Unexpected error in authentication.",[_Y]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Vo extends Error{constructor(e,r,a){const o=r?`${e}: ${r}`:e;super(o),Object.setPrototypeOf(this,Vo.prototype),this.errorCode=e||zt.EMPTY_STRING,this.errorMessage=r||zt.EMPTY_STRING,this.subError=a||zt.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function CT(t,e){return new Vo(t,e?`${u5[t]} ${e}`:u5[t])}const XA="client_info_decoding_error",EP="client_info_empty_error",JA="token_parsing_error",kP="null_or_empty_token",gd="endpoints_resolution_error",DP="network_error",RP="openid_config_error",IP="hash_not_deserialized",tg="invalid_state",PP="state_mismatch",ST="state_not_found",MP="nonce_mismatch",ZA="auth_time_not_found",_P="max_age_transpired",OY="multiple_matching_tokens",FY="multiple_matching_accounts",OP="multiple_matching_appMetadata",FP="request_cannot_be_made",NP="cannot_remove_empty_scope",jP="cannot_append_scopeset",wT="empty_input_scopeset",NY="device_code_polling_cancelled",jY="device_code_expired",LY="device_code_unknown_error",eE="no_account_in_silent_request",LP="invalid_cache_record",tE="invalid_cache_environment",TT="no_account_found",AT="no_crypto_object",BY="unexpected_credential_type",zY="invalid_assertion",UY="invalid_client_credential",Of="token_refresh_required",$Y="user_timeout_reached",BP="token_claims_cnf_required_for_signedjwt",zP="authorization_code_missing_from_server_response",UP="binding_key_not_removed",$P="end_session_endpoint_not_supported",nE="key_id_missing",HY="no_network_connectivity",WY="user_canceled",VY="missing_tenant_id_error",$r="method_not_implemented",GY="nested_app_auth_bridge_disabled",KY="platform_broker_error";const d5={[XA]:"The client info could not be parsed/decoded correctly",[EP]:"The client info was empty",[JA]:"Token cannot be parsed",[kP]:"The token is null or empty",[gd]:"Endpoints cannot be resolved",[DP]:"Network request failed",[RP]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[IP]:"The hash parameters could not be deserialized",[tg]:"State was not the expected format",[PP]:"State mismatch error",[ST]:"State not found",[MP]:"Nonce mismatch error",[ZA]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[_P]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[OY]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[FY]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[OP]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[FP]:"Token request cannot be made without authorization code or refresh token.",[NP]:"Cannot remove null or empty scope from ScopeSet",[jP]:"Cannot append ScopeSet",[wT]:"Empty input ScopeSet cannot be processed",[NY]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[jY]:"Device code is expired.",[LY]:"Device code stopped polling for unknown reasons.",[eE]:"Please pass an account object, silent flow is not supported without account information",[LP]:"Cache record object was null or undefined.",[tE]:"Invalid environment when attempting to create cache entry",[TT]:"No account found in cache for given key.",[AT]:"No crypto object detected.",[BY]:"Unexpected credential type.",[zY]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[UY]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Of]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[$Y]:"User defined timeout for device code polling reached",[BP]:"Cannot generate a POP jwt if the token_claims are not populated",[zP]:"Server response does not contain an authorization code to proceed",[UP]:"Could not remove the credential's binding key from storage.",[$P]:"The provided authority does not support logout",[nE]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[HY]:"No network connectivity. Check your internet connection.",[WY]:"User cancelled the flow.",[VY]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[$r]:"This method has not been implemented",[GY]:"The nested app auth bridge is disabled",[KY]:"An error occurred in the native broker. See the platformBrokerError property for details."};class rE extends Vo{constructor(e,r){super(e,r?`${d5[e]}: ${r}`:d5[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,rE.prototype)}}function an(t,e){return new rE(t,e)}const O2={createNewGuid:()=>{throw an($r)},base64Decode:()=>{throw an($r)},base64Encode:()=>{throw an($r)},base64UrlEncode:()=>{throw an($r)},encodeKid:()=>{throw an($r)},async getPublicKeyThumbprint(){throw an($r)},async removeTokenBindingKey(){throw an($r)},async clearKeystore(){throw an($r)},async signJwt(){throw an($r)},async hashString(){throw an($r)}};var ya;(function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"})(ya||(ya={}));class Bf{constructor(e,r,a){this.level=ya.Info;const o=()=>{},n=e||Bf.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||o,this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level=typeof n.logLevel=="number"?n.logLevel:ya.Info,this.correlationId=n.correlationId||zt.EMPTY_STRING,this.packageName=r||zt.EMPTY_STRING,this.packageVersion=a||zt.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:ya.Info}}clone(e,r,a){return new Bf({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:a||this.correlationId},e,r)}logMessage(e,r){if(r.logLevel>this.level||!this.piiLoggingEnabled&&r.containsPii)return;const n=`${`[${new Date().toUTCString()}] : [${r.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${ya[r.logLevel]} - ${e}`;this.executeCallback(r.logLevel,n,r.containsPii||!1)}executeCallback(e,r,a){this.localCallback&&this.localCallback(e,r,a)}error(e,r){this.logMessage(e,{logLevel:ya.Error,containsPii:!1,correlationId:r||zt.EMPTY_STRING})}errorPii(e,r){this.logMessage(e,{logLevel:ya.Error,containsPii:!0,correlationId:r||zt.EMPTY_STRING})}warning(e,r){this.logMessage(e,{logLevel:ya.Warning,containsPii:!1,correlationId:r||zt.EMPTY_STRING})}warningPii(e,r){this.logMessage(e,{logLevel:ya.Warning,containsPii:!0,correlationId:r||zt.EMPTY_STRING})}info(e,r){this.logMessage(e,{logLevel:ya.Info,containsPii:!1,correlationId:r||zt.EMPTY_STRING})}infoPii(e,r){this.logMessage(e,{logLevel:ya.Info,containsPii:!0,correlationId:r||zt.EMPTY_STRING})}verbose(e,r){this.logMessage(e,{logLevel:ya.Verbose,containsPii:!1,correlationId:r||zt.EMPTY_STRING})}verbosePii(e,r){this.logMessage(e,{logLevel:ya.Verbose,containsPii:!0,correlationId:r||zt.EMPTY_STRING})}trace(e,r){this.logMessage(e,{logLevel:ya.Trace,containsPii:!1,correlationId:r||zt.EMPTY_STRING})}tracePii(e,r){this.logMessage(e,{logLevel:ya.Trace,containsPii:!0,correlationId:r||zt.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const HP="@azure/msal-common",oE="15.13.3";const aE={None:"none"};const WP="redirect_uri_empty",YY="claims_request_parsing_error",VP="authority_uri_insecure",Dy="url_parse_error",GP="empty_url_error",KP="empty_input_scopes_error",sE="invalid_claims",YP="token_request_empty",qP="logout_request_empty",qY="invalid_code_challenge_method",iE="pkce_params_missing",lE="invalid_cloud_discovery_metadata",QP="invalid_authority_metadata",XP="untrusted_authority",UC="missing_ssh_jwk",JP="missing_ssh_kid",QY="missing_nonce_authentication_header",XY="invalid_authentication_header",ZP="cannot_set_OIDCOptions",e6="cannot_allow_platform_broker",t6="authority_mismatch",n6="invalid_request_method_for_EAR",r6="invalid_authorize_post_body_parameters",o6="invalid_platform_broker_configuration";const JY={[WP]:"A redirect URI is required for all calls, and none has been set.",[YY]:"Could not parse the given claims request object.",[VP]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Dy]:"URL could not be parsed into appropriate segments.",[GP]:"URL was empty or null.",[KP]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[sE]:"Given claims parameter must be a stringified JSON object.",[YP]:"Token request was empty and not found in cache.",[qP]:"The logout request was null or undefined.",[qY]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[iE]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[lE]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[QP]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[XP]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[UC]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[JP]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[QY]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[XY]:"Invalid authentication header provided",[ZP]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[e6]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[t6]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[r6]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[n6]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST.",[o6]:"Invalid platform broker configuration. `allowPlatformBrokerWithDOM` can only be enabled when `allowPlatformBroker` is enabled."};class cE extends Vo{constructor(e){super(e,JY[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,cE.prototype)}}function Wo(t){return new cE(t)}class Sl{static isEmptyObj(e){if(e)try{const r=JSON.parse(e);return Object.keys(r).length===0}catch{}return!0}static startsWith(e,r){return e.indexOf(r)===0}static endsWith(e,r){return e.length>=r.length&&e.lastIndexOf(r)===e.length-r.length}static queryStringToObject(e){const r={},a=e.split("&"),o=n=>decodeURIComponent(n.replace(/\+/g," "));return a.forEach(n=>{if(n.trim()){const[f,m]=n.split(/=(.+)/g,2);f&&m&&(r[o(f)]=o(m))}}),r}static trimArrayEntries(e){return e.map(r=>r.trim())}static removeEmptyStringsFromArray(e){return e.filter(r=>!!r)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,r){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(r)}}class ys{constructor(e){const r=e?Sl.trimArrayEntries([...e]):[],a=r?Sl.removeEmptyStringsFromArray(r):[];if(!a||!a.length)throw Wo(KP);this.scopes=new Set,a.forEach(o=>this.scopes.add(o))}static fromString(e){const a=(e||zt.EMPTY_STRING).split(" ");return new ys(a)}static createSearchScopes(e){const r=e&&e.length>0?e:[...hg],a=new ys(r);return a.containsOnlyOIDCScopes()?a.removeScope(zt.OFFLINE_ACCESS_SCOPE):a.removeOIDCScopes(),a}containsScope(e){const r=this.printScopesLowerCase().split(" "),a=new ys(r);return e?a.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(r=>this.containsScope(r))}containsOnlyOIDCScopes(){let e=0;return i5.forEach(r=>{this.containsScope(r)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(r=>this.appendScope(r))}catch{throw an(jP)}}removeScope(e){if(!e)throw an(NP);this.scopes.delete(e.trim())}removeOIDCScopes(){i5.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw an(wT);const r=new Set;return e.scopes.forEach(a=>r.add(a.toLowerCase())),this.scopes.forEach(a=>r.add(a.toLowerCase())),r}intersectingScopeSets(e){if(!e)throw an(wT);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const r=this.unionScopeSets(e),a=e.getScopeCount(),o=this.getScopeCount();return r.size<o+a}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(r=>e.push(r)),e}printScopes(){return this.scopes?this.asArray().join(" "):zt.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function F2(t,e){if(!t)throw an(EP);try{const r=e(t);return JSON.parse(r)}catch{throw an(XA)}}function Nm(t){if(!t)throw an(XA);const e=t.split(nb.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?zt.EMPTY_STRING:e[1]}}function f5(t,e){return!!t&&!!e&&t===e.split(".")[1]}function $C(t,e,r,a){if(a){const{oid:o,sub:n,tid:f,name:m,tfp:y,acr:C,preferred_username:w,upn:A,login_hint:R}=a,I=f||y||C||"";return{tenantId:I,localAccountId:o||n||"",name:m,username:w||A||"",loginHint:R,isHomeTenant:f5(I,t)}}else return{tenantId:r,localAccountId:e,username:"",isHomeTenant:f5(r,t)}}function uE(t,e,r,a){let o=t;if(e){const{isHomeTenant:n,...f}=e;o={...t,...f}}if(r){const{isHomeTenant:n,...f}=$C(t.homeAccountId,t.localAccountId,t.tenantId,r);return o={...o,...f,idTokenClaims:r,idToken:a},o}return o}const _c={Default:0,Adfs:1,Dsts:2,Ciam:3};function dE(t){return t&&(t.tid||t.tfp||t.acr)||null}const Xi={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};class Qa{static getAccountInfo(e){return{homeAccountId:e.homeAccountId,environment:e.environment,tenantId:e.realm,username:e.username,localAccountId:e.localAccountId,loginHint:e.loginHint,name:e.name,nativeAccountId:e.nativeAccountId,authorityType:e.authorityType,tenantProfiles:new Map((e.tenantProfiles||[]).map(r=>[r.tenantId,r])),dataBoundary:e.dataBoundary}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,r,a){const o=new Qa;r.authorityType===_c.Adfs?o.authorityType=Mx.ADFS_ACCOUNT_TYPE:r.protocolMode===Xi.OIDC?o.authorityType=Mx.GENERIC_ACCOUNT_TYPE:o.authorityType=Mx.MSSTS_ACCOUNT_TYPE;let n;e.clientInfo&&a&&(n=F2(e.clientInfo,a),n.xms_tdbr&&(o.dataBoundary=n.xms_tdbr==="EU"?"EU":"None")),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;const f=e.environment||r&&r.getPreferredCache();if(!f)throw an(tE);o.environment=f,o.realm=n?.utid||dE(e.idTokenClaims)||"",o.localAccountId=n?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const m=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,y=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(o.username=m||y||"",o.loginHint=e.idTokenClaims?.login_hint,o.name=e.idTokenClaims?.name||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{const C=$C(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[C]}return o}static createFromAccountInfo(e,r,a){const o=new Qa;return o.authorityType=e.authorityType||Mx.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.loginHint=e.loginHint,o.cloudGraphHostName=r,o.msGraphHost=a,o.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),o.dataBoundary=e.dataBoundary,o}static generateHomeAccountId(e,r,a,o,n){if(!(r===_c.Adfs||r===_c.Dsts)){if(e)try{const f=F2(e,o.base64Decode);if(f.uid&&f.utid)return`${f.uid}.${f.utid}`}catch{}a.warning("No client info in response")}return n?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,r,a){if(!e||!r)return!1;let o=!0;if(a){const n=e.idTokenClaims||{},f=r.idTokenClaims||{};o=n.iat===f.iat&&n.nonce===f.nonce}return e.homeAccountId===r.homeAccountId&&e.localAccountId===r.localAccountId&&e.username===r.username&&e.tenantId===r.tenantId&&e.loginHint===r.loginHint&&e.environment===r.environment&&e.nativeAccountId===r.nativeAccountId&&o}}function wu(t,e){const r=ZY(t);try{const a=e(r);return JSON.parse(a)}catch{throw an(JA)}}function ku(t){if(!t.signin_state)return!1;const e=["kmsi","dvc_dmjd"];return t.signin_state.some(a=>e.includes(a.trim().toLowerCase()))}function ZY(t){if(!t)throw an(kP);const r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw an(JA);return r[2]}function a6(t,e){if(e===0||Date.now()-3e5>t+e)throw an(_P)}function h5(t){if(!t)return t;let e=t.toLowerCase();return Sl.endsWith(e,"?")?e=e.slice(0,-1):Sl.endsWith(e,"?/")&&(e=e.slice(0,-2)),Sl.endsWith(e,"/")||(e+="/"),e}function s6(t){return t.startsWith("#/")?t.substring(2):t.startsWith("#")||t.startsWith("?")?t.substring(1):t}function N2(t){if(!t||t.indexOf("=")<0)return null;try{const e=s6(t),r=Object.fromEntries(new URLSearchParams(e));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch{throw an(IP)}return null}function rb(t,e=!0,r){const a=new Array;return t.forEach((o,n)=>{!e&&r&&n in r?a.push(`${n}=${o}`):a.push(`${n}=${encodeURIComponent(o)}`)}),a.join("&")}function p5(t){if(!t)return t;const e=t.split("#")[0];try{const r=new URL(e),a=r.origin+r.pathname+r.search;return h5(a)}catch{return h5(e)}}class vo{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Wo(GP);e.includes("#")||(this._urlString=vo.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let r=e.toLowerCase();return Sl.endsWith(r,"?")?r=r.slice(0,-1):Sl.endsWith(r,"?/")&&(r=r.slice(0,-2)),Sl.endsWith(r,"/")||(r+="/"),r}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Wo(Dy)}if(!e.HostNameAndPort||!e.PathSegments)throw Wo(Dy);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Wo(VP)}static appendQueryString(e,r){return r?e.indexOf("?")<0?`${e}?${r}`:`${e}&${r}`:e}static removeHashFromUrl(e){return vo.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const r=this.getUrlComponents(),a=r.PathSegments;return e&&a.length!==0&&(a[0]===_f.COMMON||a[0]===_f.ORGANIZATIONS)&&(a[0]=e),vo.constructAuthorityUriFromObject(r)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=this.urlString.match(e);if(!r)throw Wo(Dy);const a={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5],QueryString:r[7]};let o=a.AbsolutePath.split("/");return o=o.filter(n=>n&&n.length>0),a.PathSegments=o,a.QueryString&&a.QueryString.endsWith("/")&&(a.QueryString=a.QueryString.substring(0,a.QueryString.length-1)),a}static getDomainFromUrl(e){const r=RegExp("^([^:/?#]+://)?([^/?#]*)"),a=e.match(r);if(!a)throw Wo(Dy);return a[2]}static getAbsoluteUrl(e,r){if(e[0]===zt.FORWARD_SLASH){const o=new vo(r).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new vo(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!N2(e)}}const i6={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},m5=i6.endpointMetadata,fE=i6.instanceDiscoveryMetadata,l6=new Set;fE.metadata.forEach(t=>{t.aliases.forEach(e=>{l6.add(e)})});function eq(t,e){let r;const a=t.canonicalAuthority;if(a){const o=new vo(a).getUrlComponents().HostNameAndPort;r=g5(o,t.cloudDiscoveryMetadata?.metadata,gl.CONFIG,e)||g5(o,fE.metadata,gl.HARDCODED_VALUES,e)||t.knownAuthorities}return r||[]}function g5(t,e,r,a){if(a?.trace(`getAliasesFromMetadata called with source: ${r}`),t&&e){const o=j2(e,t);if(o)return a?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),o.aliases;a?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function tq(t){return j2(fE.metadata,t)}function j2(t,e){for(let r=0;r<t.length;r++){const a=t[r];if(a.aliases.includes(e))return a}return null}const L2="cache_quota_exceeded",hE="cache_error_unknown";const vw={[L2]:"Exceeded cache storage capacity.",[hE]:"Unexpected error occurred when using cache storage."};class jm extends Vo{constructor(e,r){const a=r||(vw[e]?vw[e]:vw[hE]);super(`${e}: ${a}`),Object.setPrototypeOf(this,jm.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=a}}function ET(t){return t instanceof Error?t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED"||t.message.includes("exceeded the quota")?new jm(L2):new jm(t.name,t.message):new jm(hE)}class kT{constructor(e,r,a,o,n){this.clientId=e,this.cryptoImpl=r,this.commonLogger=a.clone(HP,oE),this.staticAuthorityOptions=n,this.performanceClient=o}getAllAccounts(e,r){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,r),r,e)}getAccountInfoFilteredBy(e,r){if(Object.keys(e).length===0||Object.values(e).every(o=>!o))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const a=this.getAllAccounts(e,r);return a.length>1?a.sort(n=>n.idTokenClaims?-1:1)[0]:a.length===1?a[0]:null}getBaseAccountInfo(e,r){const a=this.getAccountsFilteredBy(e,r);return a.length>0?Qa.getAccountInfo(a[0]):null}buildTenantProfiles(e,r,a){return e.flatMap(o=>this.getTenantProfilesFromAccountEntity(o,r,a?.tenantId,a))}getTenantedAccountInfoByFilter(e,r,a,o,n){let f=null,m;if(n&&!this.tenantProfileMatchesFilter(a,n))return null;const y=this.getIdToken(e,o,r,a.tenantId);return y&&(m=wu(y.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(m,n))?null:(f=uE(e,a,m,y?.secret),f)}getTenantProfilesFromAccountEntity(e,r,a,o){const n=Qa.getAccountInfo(e);let f=n.tenantProfiles||new Map;const m=this.getTokenKeys();if(a){const C=f.get(a);if(C)f=new Map([[a,C]]);else return[]}const y=[];return f.forEach(C=>{const w=this.getTenantedAccountInfoByFilter(n,m,C,r,o);w&&y.push(w)}),y}tenantProfileMatchesFilter(e,r){return!(r.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,r.localAccountId)||r.name&&e.name!==r.name||r.isHomeTenant!==void 0&&e.isHomeTenant!==r.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,r){return!(r&&(r.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,r.localAccountId)||r.loginHint&&!this.matchLoginHintFromTokenClaims(e,r.loginHint)||r.username&&!this.matchUsername(e.preferred_username,r.username)||r.name&&!this.matchName(e,r.name)||r.sid&&!this.matchSid(e,r.sid)))}async saveCacheRecord(e,r,a,o){if(!e)throw an(LP);try{e.account&&await this.setAccount(e.account,r,a),e.idToken&&o?.idToken!==!1&&await this.setIdTokenCredential(e.idToken,r,a),e.accessToken&&o?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,r,a),e.refreshToken&&o?.refreshToken!==!1&&await this.setRefreshTokenCredential(e.refreshToken,r,a),e.appMetadata&&this.setAppMetadata(e.appMetadata,r)}catch(n){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),n instanceof Vo?n:ET(n)}}async saveAccessToken(e,r,a){const o={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),f=ys.fromString(e.target);n.accessToken.forEach(m=>{if(!this.accessTokenKeyMatchesFilter(m,o,!1))return;const y=this.getAccessTokenCredential(m,r);y&&this.credentialMatchesFilter(y,o)&&ys.fromString(y.target).intersectingScopeSets(f)&&this.removeAccessToken(m,r)}),await this.setAccessTokenCredential(e,r,a)}getAccountsFilteredBy(e,r){const a=this.getAccountKeys(),o=[];return a.forEach(n=>{const f=this.getAccount(n,r);if(!f||e.homeAccountId&&!this.matchHomeAccountId(f,e.homeAccountId)||e.username&&!this.matchUsername(f.username,e.username)||e.environment&&!this.matchEnvironment(f,e.environment)||e.realm&&!this.matchRealm(f,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(f,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(f,e.authorityType))return;const m={localAccountId:e?.localAccountId,name:e?.name},y=f.tenantProfiles?.filter(C=>this.tenantProfileMatchesFilter(C,m));y&&y.length===0||o.push(f)}),o}credentialMatchesFilter(e,r){return!(r.clientId&&!this.matchClientId(e,r.clientId)||r.userAssertionHash&&!this.matchUserAssertionHash(e,r.userAssertionHash)||typeof r.homeAccountId=="string"&&!this.matchHomeAccountId(e,r.homeAccountId)||r.environment&&!this.matchEnvironment(e,r.environment)||r.realm&&!this.matchRealm(e,r.realm)||r.credentialType&&!this.matchCredentialType(e,r.credentialType)||r.familyId&&!this.matchFamilyId(e,r.familyId)||r.target&&!this.matchTarget(e,r.target)||(r.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==r.requestedClaimsHash||e.credentialType===Ls.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(r.tokenType&&!this.matchTokenType(e,r.tokenType)||r.tokenType===Lo.SSH&&r.keyId&&!this.matchKeyId(e,r.keyId)))}getAppMetadataFilteredBy(e){const r=this.getKeys(),a={};return r.forEach(o=>{if(!this.isAppMetadata(o))return;const n=this.getAppMetadata(o);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(a[o]=n))}),a}getAuthorityMetadataByAlias(e){const r=this.getAuthorityMetadataKeys();let a=null;return r.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;const n=this.getAuthorityMetadata(o);n&&n.aliases.indexOf(e)!==-1&&(a=n)}),a}removeAllAccounts(e){this.getAllAccounts({},e).forEach(a=>{this.removeAccount(a,e)})}removeAccount(e,r){this.removeAccountContext(e,r);const a=this.getAccountKeys(),o=n=>n.includes(e.homeAccountId)&&n.includes(e.environment);a.filter(o).forEach(n=>{this.removeItem(n,r),this.performanceClient.incrementFields({accountsRemoved:1},r)})}removeAccountContext(e,r){const a=this.getTokenKeys(),o=n=>n.includes(e.homeAccountId)&&n.includes(e.environment);a.idToken.filter(o).forEach(n=>{this.removeIdToken(n,r)}),a.accessToken.filter(o).forEach(n=>{this.removeAccessToken(n,r)}),a.refreshToken.filter(o).forEach(n=>{this.removeRefreshToken(n,r)})}removeAccessToken(e,r){const a=this.getAccessTokenCredential(e,r);if(this.removeItem(e,r),this.performanceClient.incrementFields({accessTokensRemoved:1},r),!a||a.credentialType.toLowerCase()!==Ls.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||a.tokenType!==Lo.POP)return;const o=a.keyId;o&&this.cryptoImpl.removeTokenBindingKey(o).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${o}`,r),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},r)})}removeAppMetadata(e){return this.getKeys().forEach(a=>{this.isAppMetadata(a)&&this.removeItem(a,e)}),!0}getIdToken(e,r,a,o,n){this.commonLogger.trace("CacheManager - getIdToken called");const f={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Ls.ID_TOKEN,clientId:this.clientId,realm:o},m=this.getIdTokensByFilter(f,r,a),y=m.size;if(y<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(y>1){let C=m;if(!o){const w=new Map;m.forEach((R,I)=>{R.realm===e.tenantId&&w.set(I,R)});const A=w.size;if(A<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),m.values().next().value;if(A===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),w.values().next().value;C=w}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),C.forEach((w,A)=>{this.removeIdToken(A,r)}),n&&r&&n.addFields({multiMatchedID:m.size},r),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),m.values().next().value}getIdTokensByFilter(e,r,a){const o=a&&a.idToken||this.getTokenKeys().idToken,n=new Map;return o.forEach(f=>{if(!this.idTokenKeyMatchesFilter(f,{clientId:this.clientId,...e}))return;const m=this.getIdTokenCredential(f,r);m&&this.credentialMatchesFilter(m,e)&&n.set(f,m)}),n}idTokenKeyMatchesFilter(e,r){const a=e.toLowerCase();return!(r.clientId&&a.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&a.indexOf(r.homeAccountId.toLowerCase())===-1)}removeIdToken(e,r){this.removeItem(e,r)}removeRefreshToken(e,r){this.removeItem(e,r)}getAccessToken(e,r,a,o){const n=r.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",n);const f=ys.createSearchScopes(r.scopes),m=r.authenticationScheme||Lo.BEARER,y=m.toLowerCase()!==Lo.BEARER.toLowerCase()?Ls.ACCESS_TOKEN_WITH_AUTH_SCHEME:Ls.ACCESS_TOKEN,C={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:y,clientId:this.clientId,realm:o||e.tenantId,target:f,tokenType:m,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},w=a&&a.accessToken||this.getTokenKeys().accessToken,A=[];w.forEach(I=>{if(this.accessTokenKeyMatchesFilter(I,C,!0)){const M=this.getAccessTokenCredential(I,n);M&&this.credentialMatchesFilter(M,C)&&A.push(M)}});const R=A.length;return R<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",n),null):R>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",n),A.forEach(I=>{this.removeAccessToken(this.generateCredentialKey(I),n)}),this.performanceClient.addFields({multiMatchedAT:A.length},n),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",n),A[0])}accessTokenKeyMatchesFilter(e,r,a){const o=e.toLowerCase();if(r.clientId&&o.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&o.indexOf(r.homeAccountId.toLowerCase())===-1||r.realm&&o.indexOf(r.realm.toLowerCase())===-1||r.requestedClaimsHash&&o.indexOf(r.requestedClaimsHash.toLowerCase())===-1)return!1;if(r.target){const n=r.target.asArray();for(let f=0;f<n.length;f++){if(a&&!o.includes(n[f].toLowerCase()))return!1;if(!a&&o.includes(n[f].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,r){const a=this.getTokenKeys(),o=[];return a.accessToken.forEach(n=>{if(!this.accessTokenKeyMatchesFilter(n,e,!0))return;const f=this.getAccessTokenCredential(n,r);f&&this.credentialMatchesFilter(f,e)&&o.push(f)}),o}getRefreshToken(e,r,a,o,n){this.commonLogger.trace("CacheManager - getRefreshToken called");const f=r?P2:void 0,m={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Ls.REFRESH_TOKEN,clientId:this.clientId,familyId:f},y=o&&o.refreshToken||this.getTokenKeys().refreshToken,C=[];y.forEach(A=>{if(this.refreshTokenKeyMatchesFilter(A,m)){const R=this.getRefreshTokenCredential(A,a);R&&this.credentialMatchesFilter(R,m)&&C.push(R)}});const w=C.length;return w<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(w>1&&n&&a&&n.addFields({multiMatchedRT:w},a),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),C[0])}refreshTokenKeyMatchesFilter(e,r){const a=e.toLowerCase();return!(r.familyId&&a.indexOf(r.familyId.toLowerCase())===-1||!r.familyId&&r.clientId&&a.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&a.indexOf(r.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const r={environment:e,clientId:this.clientId},a=this.getAppMetadataFilteredBy(r),o=Object.keys(a).map(f=>a[f]),n=o.length;if(n<1)return null;if(n>1)throw an(OP);return o[0]}isAppMetadataFOCI(e){const r=this.readAppMetadataFromCache(e);return!!(r&&r.familyId===P2)}matchHomeAccountId(e,r){return typeof e.homeAccountId=="string"&&r===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,r){const a=e.oid||e.sub;return r===a}matchLocalAccountIdFromTenantProfile(e,r){return e.localAccountId===r}matchName(e,r){return r.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,r){return!!(e&&typeof e=="string"&&r?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,r){return!!(e.userAssertionHash&&r===e.userAssertionHash)}matchEnvironment(e,r){if(this.staticAuthorityOptions){const o=eq(this.staticAuthorityOptions,this.commonLogger);if(o.includes(r)&&o.includes(e.environment))return!0}const a=this.getAuthorityMetadataByAlias(r);return!!(a&&a.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,r){return e.credentialType&&r.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,r){return!!(e.clientId&&r===e.clientId)}matchFamilyId(e,r){return!!(e.familyId&&r===e.familyId)}matchRealm(e,r){return e.realm?.toLowerCase()===r.toLowerCase()}matchNativeAccountId(e,r){return!!(e.nativeAccountId&&r===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,r){return e.login_hint===r||e.preferred_username===r||e.upn===r}matchSid(e,r){return e.sid===r}matchAuthorityType(e,r){return!!(e.authorityType&&r.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,r){return e.credentialType!==Ls.ACCESS_TOKEN&&e.credentialType!==Ls.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:ys.fromString(e.target).containsScopeSet(r)}matchTokenType(e,r){return!!(e.tokenType&&e.tokenType===r)}matchKeyId(e,r){return!!(e.keyId&&e.keyId===r)}isAppMetadata(e){return e.indexOf(QA)!==-1}isAuthorityMetadata(e){return e.indexOf(M2.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${M2.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,r){for(const a in r)e[a]=r[a];return e}}class nq extends kT{async setAccount(){throw an($r)}getAccount(){throw an($r)}async setIdTokenCredential(){throw an($r)}getIdTokenCredential(){throw an($r)}async setAccessTokenCredential(){throw an($r)}getAccessTokenCredential(){throw an($r)}async setRefreshTokenCredential(){throw an($r)}getRefreshTokenCredential(){throw an($r)}setAppMetadata(){throw an($r)}getAppMetadata(){throw an($r)}setServerTelemetry(){throw an($r)}getServerTelemetry(){throw an($r)}setAuthorityMetadata(){throw an($r)}getAuthorityMetadata(){throw an($r)}getAuthorityMetadataKeys(){throw an($r)}setThrottlingCache(){throw an($r)}getThrottlingCache(){throw an($r)}removeItem(){throw an($r)}getKeys(){throw an($r)}getAccountKeys(){throw an($r)}getTokenKeys(){throw an($r)}generateCredentialKey(){throw an($r)}generateAccountKey(){throw an($r)}}const Je={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},rq={InProgress:1};class y5{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class c6{generateId(){return"callback-id"}startMeasurement(e,r){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:rq.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:r||""},measurement:new y5}}startPerformanceMeasurement(){return new y5}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const u6={tokenRenewalOffsetSeconds:AP,preventCorsPreflight:!1},oq={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:ya.Info,correlationId:zt.EMPTY_STRING},aq={claimsBasedCachingEnabled:!1},sq={async sendGetRequestAsync(){throw an($r)},async sendPostRequestAsync(){throw an($r)}},iq={sku:zt.SKU,version:oE,cpu:zt.EMPTY_STRING,os:zt.EMPTY_STRING},lq={clientSecret:zt.EMPTY_STRING,clientAssertion:void 0},cq={azureCloudInstance:aE.None,tenant:`${zt.DEFAULT_COMMON_TENANT}`},uq={application:{appName:"",appVersion:""}};function dq({authOptions:t,systemOptions:e,loggerOptions:r,cacheOptions:a,storageInterface:o,networkInterface:n,cryptoInterface:f,clientCredentials:m,libraryInfo:y,telemetry:C,serverTelemetryManager:w,persistencePlugin:A,serializableCache:R}){const I={...oq,...r};return{authOptions:fq(t),systemOptions:{...u6,...e},loggerOptions:I,cacheOptions:{...aq,...a},storageInterface:o||new nq(t.clientId,O2,new Bf(I),new c6),networkInterface:n||sq,cryptoInterface:f||O2,clientCredentials:m||lq,libraryInfo:{...iq,...y},telemetry:{...uq,...C},serverTelemetryManager:w||null,persistencePlugin:A||null,serializableCache:R||null}}function fq(t){return{clientCapabilities:[],azureCloudOptions:cq,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...t}}function d6(t){return t.authOptions.authority.options.protocolMode===Xi.OIDC}const Oc={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};const Cp="client_id",f6="redirect_uri",hq="response_type",pq="response_mode",mq="grant_type",gq="claims",yq="scope",bq="refresh_token",vq="state",xq="nonce",Cq="prompt",Sq="code",wq="code_challenge",Tq="code_challenge_method",Aq="code_verifier",Eq="client-request-id",kq="x-client-SKU",Dq="x-client-VER",Rq="x-client-OS",Iq="x-client-CPU",Pq="x-client-current-telemetry",Mq="x-client-last-telemetry",_q="x-ms-lib-capability",Oq="x-app-name",Fq="x-app-ver",Nq="post_logout_redirect_uri",jq="id_token_hint",Lq="client_secret",Bq="client_assertion",zq="client_assertion_type",h6="token_type",p6="req_cnf",b5="return_spa_code",Uq="nativebroker",$q="logout_hint",Hq="sid",Wq="login_hint",Vq="domain_hint",Gq="x-client-xtra-sku",B2="brk_client_id",z2="brk_redirect_uri",DT="instance_aware",Kq="ear_jwk",Yq="ear_jwe_crypto";function HC(t,e,r){if(!e)return;const a=t.get(Cp);a&&t.has(B2)&&r?.addFields({embeddedClientId:a,embeddedRedirectUri:t.get(f6)},e)}function pE(t,e){t.set(hq,e)}function qq(t,e){t.set(pq,e||IY.QUERY)}function Qq(t){t.set(Uq,"1")}function mE(t,e,r=!0,a=hg){r&&!a.includes("openid")&&!e.includes("openid")&&a.push("openid");const o=r?[...e||[],...a]:e||[],n=new ys(o);t.set(yq,n.printScopes())}function gE(t,e){t.set(Cp,e)}function yE(t,e){t.set(f6,e)}function Xq(t,e){t.set(Nq,e)}function Jq(t,e){t.set(jq,e)}function Zq(t,e){t.set(Vq,e)}function _x(t,e){t.set(Wq,e)}function U2(t,e){t.set(Ai.CCS_HEADER,`UPN:${e}`)}function jy(t,e){t.set(Ai.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}function v5(t,e){t.set(Hq,e)}function bE(t,e,r){const a=aQ(e,r);try{JSON.parse(a)}catch{throw Wo(sE)}t.set(gq,a)}function vE(t,e){t.set(Eq,e)}function xE(t,e){t.set(kq,e.sku),t.set(Dq,e.version),e.os&&t.set(Rq,e.os),e.cpu&&t.set(Iq,e.cpu)}function CE(t,e){e?.appName&&t.set(Oq,e.appName),e?.appVersion&&t.set(Fq,e.appVersion)}function eQ(t,e){t.set(Cq,e)}function m6(t,e){e&&t.set(vq,e)}function tQ(t,e){t.set(xq,e)}function SE(t,e,r){if(e&&r)t.set(wq,e),t.set(Tq,r);else throw Wo(iE)}function nQ(t,e){t.set(Sq,e)}function rQ(t,e){t.set(bq,e)}function oQ(t,e){t.set(Aq,e)}function g6(t,e){t.set(Lq,e)}function y6(t,e){e&&t.set(Bq,e)}function b6(t,e){e&&t.set(zq,e)}function v6(t,e){t.set(mq,e)}function wE(t){t.set(PY,"1")}function x6(t){t.has(DT)||t.set(DT,"true")}function Ff(t,e){Object.entries(e).forEach(([r,a])=>{!t.has(r)&&a&&t.set(r,a)})}function aQ(t,e){let r;if(!t)r={};else try{r=JSON.parse(t)}catch{throw Wo(sE)}return e&&e.length>0&&(r.hasOwnProperty(Px.ACCESS_TOKEN)||(r[Px.ACCESS_TOKEN]={}),r[Px.ACCESS_TOKEN][Px.XMS_CC]={values:e}),JSON.stringify(r)}function TE(t,e){e&&(t.set(h6,Lo.POP),t.set(p6,e))}function C6(t,e){e&&(t.set(h6,Lo.SSH),t.set(p6,e))}function S6(t,e){t.set(Pq,e.generateCurrentRequestHeaderValue()),t.set(Mq,e.generateLastRequestHeaderValue())}function w6(t){t.set(_q,Ny.X_MS_LIB_CAPABILITY_VALUE)}function sQ(t,e){t.set($q,e)}function WC(t,e,r){t.has(B2)||t.set(B2,e),t.has(z2)||t.set(z2,r)}function iQ(t,e){t.set(Kq,encodeURIComponent(e)),t.set(Yq,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}function lQ(t,e){Object.entries(e).forEach(([r,a])=>{a&&t.set(r,a)})}function cQ(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}function uQ(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}function dQ(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}const wl=(t,e,r,a,o)=>(...n)=>{r.trace(`Executing function ${e}`);const f=a?.startMeasurement(e,o);if(o){const m=e+"CallCount";a?.incrementFields({[m]:1},o)}try{const m=t(...n);return f?.end({success:!0}),r.trace(`Returning result from ${e}`),m}catch(m){r.trace(`Error occurred in ${e}`);try{r.trace(JSON.stringify(m))}catch{r.trace("Unable to print error message.")}throw f?.end({success:!1},m),m}},Nt=(t,e,r,a,o)=>(...n)=>{r.trace(`Executing function ${e}`);const f=a?.startMeasurement(e,o);if(o){const m=e+"CallCount";a?.incrementFields({[m]:1},o)}return a?.setPreQueueTime(e,o),t(...n).then(m=>(r.trace(`Returning result from ${e}`),f?.end({success:!0}),m)).catch(m=>{r.trace(`Error occurred in ${e}`);try{r.trace(JSON.stringify(m))}catch{r.trace("Unable to print error message.")}throw f?.end({success:!1},m),m})};class VC{constructor(e,r,a,o){this.networkInterface=e,this.logger=r,this.performanceClient=a,this.correlationId=o}async detectRegion(e,r){this.performanceClient?.addQueueMeasurement(Je.RegionDiscoveryDetectRegion,this.correlationId);let a=e;if(a)r.region_source=wm.ENVIRONMENT_VARIABLE;else{const o=VC.IMDS_OPTIONS;try{const n=await Nt(this.getRegionFromIMDS.bind(this),Je.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(zt.IMDS_VERSION,o);if(n.status===If.SUCCESS&&(a=n.body,r.region_source=wm.IMDS),n.status===If.BAD_REQUEST){const f=await Nt(this.getCurrentVersion.bind(this),Je.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(o);if(!f)return r.region_source=wm.FAILED_AUTO_DETECTION,null;const m=await Nt(this.getRegionFromIMDS.bind(this),Je.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(f,o);m.status===If.SUCCESS&&(a=m.body,r.region_source=wm.IMDS)}}catch{return r.region_source=wm.FAILED_AUTO_DETECTION,null}}return a||(r.region_source=wm.FAILED_AUTO_DETECTION),a||null}async getRegionFromIMDS(e,r){return this.performanceClient?.addQueueMeasurement(Je.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${zt.IMDS_ENDPOINT}?api-version=${e}&format=text`,r,zt.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(Je.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${zt.IMDS_ENDPOINT}?format=json`,e);return r.status===If.BAD_REQUEST&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}}VC.IMDS_OPTIONS={headers:{Metadata:"true"}};function nl(){return Math.round(new Date().getTime()/1e3)}function x5(t){return t.getTime()/1e3}function Lm(t){return t?new Date(Number(t)*1e3):new Date}function $2(t,e){const r=Number(t)||0;return nl()+e>r}function C5(t,e){const r=Number(t)+e*24*60*60*1e3;return Date.now()>r}function fQ(t){return Number(t)>nl()}function GC(t,e,r,a,o){return{credentialType:Ls.ID_TOKEN,homeAccountId:t,environment:e,clientId:a,secret:r,realm:o,lastUpdatedAt:Date.now().toString()}}function KC(t,e,r,a,o,n,f,m,y,C,w,A,R,I,M){const F={homeAccountId:t,credentialType:Ls.ACCESS_TOKEN,secret:r,cachedAt:nl().toString(),expiresOn:f.toString(),extendedExpiresOn:m.toString(),environment:e,clientId:a,realm:o,target:n,tokenType:w||Lo.BEARER,lastUpdatedAt:Date.now().toString()};if(A&&(F.userAssertionHash=A),C&&(F.refreshOn=C.toString()),I&&(F.requestedClaims=I,F.requestedClaimsHash=M),F.tokenType?.toLowerCase()!==Lo.BEARER.toLowerCase())switch(F.credentialType=Ls.ACCESS_TOKEN_WITH_AUTH_SCHEME,F.tokenType){case Lo.POP:const O=wu(r,y);if(!O?.cnf?.kid)throw an(BP);F.keyId=O.cnf.kid;break;case Lo.SSH:F.keyId=R}return F}function T6(t,e,r,a,o,n,f){const m={credentialType:Ls.REFRESH_TOKEN,homeAccountId:t,environment:e,clientId:a,secret:r,lastUpdatedAt:Date.now().toString()};return n&&(m.userAssertionHash=n),o&&(m.familyId=o),f&&(m.expiresOn=f.toString()),m}function YC(t){return t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")}function S5(t){return t?YC(t)&&t.hasOwnProperty("realm")&&t.hasOwnProperty("target")&&(t.credentialType===Ls.ACCESS_TOKEN||t.credentialType===Ls.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function hQ(t){return t?YC(t)&&t.hasOwnProperty("realm")&&t.credentialType===Ls.ID_TOKEN:!1}function w5(t){return t?YC(t)&&t.credentialType===Ls.REFRESH_TOKEN:!1}function pQ(t,e){const r=t.indexOf(js.CACHE_KEY)===0;let a=!0;return e&&(a=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),r&&a}function mQ(t,e){let r=!1;t&&(r=t.indexOf(Ny.THROTTLING_PREFIX)===0);let a=!0;return e&&(a=e.hasOwnProperty("throttleTime")),r&&a}function gQ({environment:t,clientId:e}){return[QA,t,e].join(nb.CACHE_KEY_SEPARATOR).toLowerCase()}function yQ(t,e){return e?t.indexOf(QA)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function bQ(t,e){return e?t.indexOf(M2.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function T5(){return nl()+M2.REFRESH_TIME_SECONDS}function Ox(t,e,r){t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.end_session_endpoint=e.end_session_endpoint,t.issuer=e.issuer,t.endpointsFromNetwork=r,t.jwks_uri=e.jwks_uri}function xw(t,e,r){t.aliases=e.aliases,t.preferred_cache=e.preferred_cache,t.preferred_network=e.preferred_network,t.aliasesFromNetwork=r}function A5(t){return t.expiresAt<=nl()}class ei{constructor(e,r,a,o,n,f,m,y){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=r,this.cacheManager=a,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=n,this.performanceClient=m,this.correlationId=f,this.managedIdentity=y||!1,this.regionDiscovery=new VC(r,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(zt.CIAM_AUTH_URL))return _c.Ciam;const r=e.PathSegments;if(r.length)switch(r[0].toLowerCase()){case zt.ADFS:return _c.Adfs;case zt.DSTS:return _c.Dsts}return _c.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new vo(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw an(gd)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw an(gd)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw an(gd)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw an($P);return this.replacePath(this.metadata.end_session_endpoint)}else throw an(gd)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw an(gd)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw an(gd)}canReplaceTenant(e){return e.PathSegments.length===1&&!ei.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===_c.Default&&this.protocolMode!==Xi.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let r=e;const o=new vo(this.metadata.canonical_authority).getUrlComponents(),n=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((m,y)=>{let C=n[y];if(y===0&&this.canReplaceTenant(o)){const w=new vo(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];C!==w&&(this.logger.verbose(`Replacing tenant domain name ${C} with id ${w}`),C=w)}m!==C&&(r=r.replace(`/${C}/`,`/${m}/`))}),this.replaceTenant(r)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===_c.Adfs||this.protocolMode===Xi.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(Je.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),r=await Nt(this.updateCloudDiscoveryMetadata.bind(this),Je.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const a=await Nt(this.updateEndpointMetadata.bind(this),Je.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,r,{source:a}),this.performanceClient?.addFields({cloudDiscoverySource:r,authorityEndpointSource:a},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:T5(),jwks_uri:""}),e}updateCachedMetadata(e,r,a){r!==gl.CACHE&&a?.source!==gl.CACHE&&(e.expiresAt=T5(),e.canonical_authority=this.canonicalAuthority);const o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(Je.AuthorityUpdateEndpointMetadata,this.correlationId);const r=this.updateEndpointMetadataFromLocalSources(e);if(r){if(r.source===gl.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&r.metadata){const o=await Nt(this.updateMetadataWithRegionalInformation.bind(this),Je.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r.metadata);Ox(e,o,!1),e.canonical_authority=this.canonicalAuthority}return r.source}let a=await Nt(this.getEndpointMetadataFromNetwork.bind(this),Je.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(a)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(a=await Nt(this.updateMetadataWithRegionalInformation.bind(this),Je.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(a)),Ox(e,a,!0),gl.NETWORK;throw an(RP,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const r=this.getEndpointMetadataFromConfig();if(r)return this.logger.verbose("Found endpoint metadata in authority configuration"),Ox(e,r,!1),{source:gl.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const o=this.getEndpointMetadataFromHardcodedValues();if(o)return Ox(e,o,!1),{source:gl.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const a=A5(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!a?(this.logger.verbose("Found endpoint metadata in the cache."),{source:gl.CACHE}):(a&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new vo(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Wo(QP)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Je.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},r=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${r}`);try{const a=await this.networkInterface.sendGetRequestAsync(r,e);return cQ(a.body)?a.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(a){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${a}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in m5?m5[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(Je.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const r=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(r){if(r!==zt.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=bw.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=r,ei.replaceWithRegionalInformation(e,r);const a=await Nt(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Je.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(a)return this.regionDiscoveryMetadata.region_outcome=bw.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,ei.replaceWithRegionalInformation(e,a);this.regionDiscoveryMetadata.region_outcome=bw.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(Je.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const r=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(r)return r;const a=await Nt(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Je.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(a)return xw(e,a,!0),gl.NETWORK;throw Wo(XP)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||zt.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||zt.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||zt.NOT_APPLICABLE}`);const r=this.getCloudDiscoveryMetadataFromConfig();if(r)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),xw(e,r,!1),gl.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const o=tq(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),xw(e,o,!1),gl.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const a=A5(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!a?(this.logger.verbose("Found cloud discovery metadata in the cache."),gl.CACHE):(a&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===_c.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),ei.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=j2(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Wo(lE)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),ei.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Je.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${zt.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,r={};let a=null;try{const o=await this.networkInterface.sendGetRequestAsync(e,r);let n,f;if(uQ(o.body))n=o.body,f=n.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${n.tenant_discovery_endpoint}`);else if(dQ(o.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),n=o.body,n.error===zt.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${n.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${n.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),f=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),a=j2(f,this.hostnameAndPort)}catch(o){if(o instanceof Vo)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${o.errorCode}
Error Description: ${o.errorMessage}`);else{const n=o;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${n.name}
Error Description: ${n.message}`)}return null}return a||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),a=ei.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),a}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(r=>r&&vo.getDomainFromUrl(r).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,r){let a;if(r&&r.azureCloudInstance!==aE.None){const o=r.tenant?r.tenant:zt.DEFAULT_COMMON_TENANT;a=`${r.azureCloudInstance}/${o}/`}return a||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return zt.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw an(gd)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return l6.has(e)}static isPublicCloudAuthority(e){return zt.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,r,a){const o=new vo(e);o.validateAsUri();const n=o.getUrlComponents();let f=`${r}.${n.HostNameAndPort}`;this.isPublicCloudAuthority(n.HostNameAndPort)&&(f=`${r}.${zt.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const m=vo.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:f}).urlString;return a?`${m}?${a}`:m}static replaceWithRegionalInformation(e,r){const a={...e};return a.authorization_endpoint=ei.buildRegionalAuthorityString(a.authorization_endpoint,r),a.token_endpoint=ei.buildRegionalAuthorityString(a.token_endpoint,r),a.end_session_endpoint&&(a.end_session_endpoint=ei.buildRegionalAuthorityString(a.end_session_endpoint,r)),a}static transformCIAMAuthority(e){let r=e;const o=new vo(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(zt.CIAM_AUTH_URL)){const n=o.HostNameAndPort.split(".")[0];r=`${r}${n}${zt.AAD_TENANT_DOMAIN_SUFFIX}`}return r}}ei.reservedTenantDomains=new Set(["{tenant}","{tenantid}",_f.COMMON,_f.CONSUMERS,_f.ORGANIZATIONS]);function vQ(t){const a=new vo(t).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(a){case _f.COMMON:case _f.ORGANIZATIONS:case _f.CONSUMERS:return;default:return a}}function A6(t){return t.endsWith(zt.FORWARD_SLASH)?t:`${t}${zt.FORWARD_SLASH}`}function xQ(t){const e=t.cloudDiscoveryMetadata;let r;if(e)try{r=JSON.parse(e)}catch{throw Wo(lE)}return{canonicalAuthority:t.authority?A6(t.authority):void 0,knownAuthorities:t.knownAuthorities,cloudDiscoveryMetadata:r}}async function E6(t,e,r,a,o,n,f){f?.addQueueMeasurement(Je.AuthorityFactoryCreateDiscoveredInstance,n);const m=ei.transformCIAMAuthority(A6(t)),y=new ei(m,e,r,a,o,n,f);try{return await Nt(y.resolveEndpointsAsync.bind(y),Je.AuthorityResolveEndpointsAsync,o,f,n)(),y}catch{throw an(gd)}}class Pp extends Vo{constructor(e,r,a,o,n){super(e,r,a),this.name="ServerError",this.errorNo=o,this.status=n,Object.setPrototypeOf(this,Pp.prototype)}}function qC(t,e,r){return{clientId:t,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:r,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||e.tokenBodyParameters?.clientId}}class Cu{static generateThrottlingStorageKey(e){return`${Ny.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,r,a){const o=Cu.generateThrottlingStorageKey(r),n=e.getThrottlingCache(o);if(n){if(n.throttleTime<Date.now()){e.removeItem(o,a);return}throw new Pp(n.errorCodes?.join(" ")||zt.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,r,a,o){if(Cu.checkResponseStatus(a)||Cu.checkResponseForRetryAfter(a)){const n={throttleTime:Cu.calculateThrottleTime(parseInt(a.headers[Ai.RETRY_AFTER])),error:a.body.error,errorCodes:a.body.error_codes,errorMessage:a.body.error_description,subError:a.body.suberror};e.setThrottlingCache(Cu.generateThrottlingStorageKey(r),n,o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(Ai.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const r=e<=0?0:e,a=Date.now()/1e3;return Math.floor(Math.min(a+(r||Ny.DEFAULT_THROTTLE_TIME_SECONDS),a+Ny.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,r,a,o){const n=qC(r,a,o),f=this.generateThrottlingStorageKey(n);e.removeItem(f,a.correlationId)}}class QC extends Vo{constructor(e,r,a){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,QC.prototype),this.name="NetworkError",this.error=e,this.httpStatus=r,this.responseHeaders=a}}function Ry(t,e,r,a){return t.errorMessage=`${t.errorMessage}, additionalErrorInfo: error.name:${a?.name}, error.message:${a?.message}`,new QC(t,e,r)}class AE{constructor(e,r){this.config=dq(e),this.logger=new Bf(this.config.loggerOptions,HP,oE),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=r}createTokenRequestHeaders(e){const r={};if(r[Ai.CONTENT_TYPE]=zt.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Oc.HOME_ACCOUNT_ID:try{const a=Nm(e.credential);r[Ai.CCS_HEADER]=`Oid:${a.uid}@${a.utid}`}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Oc.UPN:r[Ai.CCS_HEADER]=`UPN: ${e.credential}`;break}return r}async executePostToTokenEndpoint(e,r,a,o,n,f){f&&this.performanceClient?.addQueueMeasurement(f,n);const m=await this.sendPostRequest(o,e,{body:r,headers:a},n);return this.config.serverTelemetryManager&&m.status<500&&m.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),m}async sendPostRequest(e,r,a,o){Cu.preProcess(this.cacheManager,e,o);let n;try{n=await Nt(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Je.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,o)(r,a);const f=n.headers||{};this.performanceClient?.addFields({refreshTokenSize:n.body.refresh_token?.length||0,httpVerToken:f[Ai.X_MS_HTTP_VERSION]||"",requestId:f[Ai.X_MS_REQUEST_ID]||""},o)}catch(f){if(f instanceof QC){const m=f.responseHeaders;throw m&&this.performanceClient?.addFields({httpVerToken:m[Ai.X_MS_HTTP_VERSION]||"",requestId:m[Ai.X_MS_REQUEST_ID]||"",contentTypeHeader:m[Ai.CONTENT_TYPE]||void 0,contentLengthHeader:m[Ai.CONTENT_LENGTH]||void 0,httpStatus:f.httpStatus},o),f.error}throw f instanceof Vo?f:an(DP)}return Cu.postProcess(this.cacheManager,e,n,o),n}async updateAuthority(e,r){this.performanceClient?.addQueueMeasurement(Je.UpdateTokenEndpointAuthority,r);const a=`https://${e}/${this.authority.tenant}/`,o=await E6(a,this.networkClient,this.cacheManager,this.authority.options,this.logger,r,this.performanceClient);this.authority=o}createTokenQueryParameters(e){const r=new Map;return e.embeddedClientId&&WC(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&Ff(r,e.tokenQueryParameters),vE(r,e.correlationId),HC(r,e.correlationId,this.performanceClient),rb(r)}}const H2="no_tokens_found",k6="native_account_unavailable",EE="refresh_token_expired",kE="ux_not_allowed",CQ="interaction_required",SQ="consent_required",wQ="login_required",XC="bad_token";const E5=[CQ,SQ,wQ,XC,kE],TQ=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],AQ={[H2]:"No refresh token found in the cache. Please sign-in.",[k6]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[EE]:"Refresh token has expired.",[XC]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[kE]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class Nc extends Vo{constructor(e,r,a,o,n,f,m,y){super(e,r,a),Object.setPrototypeOf(this,Nc.prototype),this.timestamp=o||zt.EMPTY_STRING,this.traceId=n||zt.EMPTY_STRING,this.correlationId=f||zt.EMPTY_STRING,this.claims=m||zt.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=y}}function D6(t,e,r){const a=!!t&&E5.indexOf(t)>-1,o=!!r&&TQ.indexOf(r)>-1,n=!!e&&E5.some(f=>e.indexOf(f)>-1);return a||n||o}function W2(t){return new Nc(t,AQ[t])}class pg{static setRequestState(e,r,a){const o=pg.generateLibraryState(e,a);return r?`${o}${zt.RESOURCE_DELIM}${r}`:o}static generateLibraryState(e,r){if(!e)throw an(AT);const a={id:e.createNewGuid()};r&&(a.meta=r);const o=JSON.stringify(a);return e.base64Encode(o)}static parseRequestState(e,r){if(!e)throw an(AT);if(!r)throw an(tg);try{const a=r.split(zt.RESOURCE_DELIM),o=a[0],n=a.length>1?a.slice(1).join(zt.RESOURCE_DELIM):zt.EMPTY_STRING,f=e.base64Decode(o),m=JSON.parse(f);return{userRequestState:n||zt.EMPTY_STRING,libraryState:m}}catch{throw an(tg)}}}const EQ={SW:"sw"};class ng{constructor(e,r){this.cryptoUtils=e,this.performanceClient=r}async generateCnf(e,r){this.performanceClient?.addQueueMeasurement(Je.PopTokenGenerateCnf,e.correlationId);const a=await Nt(this.generateKid.bind(this),Je.PopTokenGenerateCnf,r,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(a));return{kid:a.kid,reqCnfString:o}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(Je.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:EQ.SW}}async signPopToken(e,r,a){return this.signPayload(e,r,a)}async signPayload(e,r,a,o){const{resourceRequestMethod:n,resourceRequestUri:f,shrClaims:m,shrNonce:y,shrOptions:C}=a,A=(f?new vo(f):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:nl(),m:n?.toUpperCase(),u:A?.HostNameAndPort,nonce:y||this.cryptoUtils.createNewGuid(),p:A?.AbsolutePath,q:A?.QueryString?[[],A.QueryString]:void 0,client_claims:m||void 0,...o},r,C,a.correlationId)}}class kQ{constructor(e,r){this.cache=e,this.hasChanged=r}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class Sp{constructor(e,r,a,o,n,f,m){this.clientId=e,this.cacheStorage=r,this.cryptoObj=a,this.logger=o,this.serializableCache=n,this.persistencePlugin=f,this.performanceClient=m}validateTokenResponse(e,r){if(e.error||e.error_description||e.suberror){const a=`Error(s): ${e.error_codes||zt.NOT_AVAILABLE} - Timestamp: ${e.timestamp||zt.NOT_AVAILABLE} - Description: ${e.error_description||zt.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||zt.NOT_AVAILABLE} - Trace ID: ${e.trace_id||zt.NOT_AVAILABLE}`,o=e.error_codes?.length?e.error_codes[0]:void 0,n=new Pp(e.error,a,e.suberror,o,e.status);if(r&&e.status&&e.status>=If.SERVER_ERROR_RANGE_START&&e.status<=If.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${n}`);return}else if(r&&e.status&&e.status>=If.CLIENT_ERROR_RANGE_START&&e.status<=If.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${n}`);return}throw D6(e.error,e.error_description,e.suberror)?new Nc(e.error,e.error_description,e.suberror,e.timestamp||zt.EMPTY_STRING,e.trace_id||zt.EMPTY_STRING,e.correlation_id||zt.EMPTY_STRING,e.claims||zt.EMPTY_STRING,o):n}}async handleServerTokenResponse(e,r,a,o,n,f,m,y,C){this.performanceClient?.addQueueMeasurement(Je.HandleServerTokenResponse,e.correlation_id);let w;if(e.id_token){if(w=wu(e.id_token||zt.EMPTY_STRING,this.cryptoObj.base64Decode),n&&n.nonce&&w.nonce!==n.nonce)throw an(MP);if(o.maxAge||o.maxAge===0){const M=w.auth_time;if(!M)throw an(ZA);a6(M,o.maxAge)}}this.homeAccountIdentifier=Qa.generateHomeAccountId(e.client_info||zt.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,w);let A;n&&n.state&&(A=pg.parseRequestState(this.cryptoObj,n.state)),e.key_id=e.key_id||o.sshKid||void 0;const R=this.generateCacheRecord(e,r,a,o,w,f,n);let I;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),I=new kQ(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(I)),m&&!y&&R.account){const M=this.cacheStorage.generateAccountKey(Qa.getAccountInfo(R.account));if(!this.cacheStorage.getAccount(M,o.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Sp.generateAuthenticationResult(this.cryptoObj,r,R,!1,o,w,A,void 0,C)}await this.cacheStorage.saveCacheRecord(R,o.correlationId,ku(w||{}),o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&I&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(I))}return Sp.generateAuthenticationResult(this.cryptoObj,r,R,!1,o,w,A,e,C)}generateCacheRecord(e,r,a,o,n,f,m){const y=r.getPreferredCache();if(!y)throw an(tE);const C=dE(n);let w,A;e.id_token&&n&&(w=GC(this.homeAccountIdentifier,y,e.id_token,this.clientId,C||""),A=DE(this.cacheStorage,r,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o.correlationId,n,e.client_info,y,C,m,void 0,this.logger));let R=null;if(e.access_token){const F=e.scope?ys.fromString(e.scope):new ys(o.scopes||[]),O=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,j=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,U=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,H=a+O,K=H+j,W=U&&U>0?a+U:void 0;R=KC(this.homeAccountIdentifier,y,e.access_token,this.clientId,C||r.tenant||"",F.printScopes(),H,K,this.cryptoObj.base64Decode,W,e.token_type,f,e.key_id,o.claims,o.requestedClaimsHash)}let I=null;if(e.refresh_token){let F;if(e.refresh_token_expires_in){const O=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;F=a+O}I=T6(this.homeAccountIdentifier,y,e.refresh_token,this.clientId,e.foci,f,F)}let M=null;return e.foci&&(M={clientId:this.clientId,environment:y,familyId:e.foci}),{account:A,idToken:w,accessToken:R,refreshToken:I,appMetadata:M}}static async generateAuthenticationResult(e,r,a,o,n,f,m,y,C){let w=zt.EMPTY_STRING,A=[],R=null,I,M,F=zt.EMPTY_STRING;if(a.accessToken){if(a.accessToken.tokenType===Lo.POP&&!n.popKid){const H=new ng(e),{secret:K,keyId:W}=a.accessToken;if(!W)throw an(nE);w=await H.signPopToken(K,W,n)}else w=a.accessToken.secret;A=ys.fromString(a.accessToken.target).asArray(),R=Lm(a.accessToken.expiresOn),I=Lm(a.accessToken.extendedExpiresOn),a.accessToken.refreshOn&&(M=Lm(a.accessToken.refreshOn))}a.appMetadata&&(F=a.appMetadata.familyId===P2?P2:"");const O=f?.oid||f?.sub||"",j=f?.tid||"";y?.spa_accountid&&a.account&&(a.account.nativeAccountId=y?.spa_accountid);const U=a.account?uE(Qa.getAccountInfo(a.account),void 0,f,a.idToken?.secret):null;return{authority:r.canonicalAuthority,uniqueId:O,tenantId:j,scopes:A,account:U,idToken:a?.idToken?.secret||"",idTokenClaims:f||{},accessToken:w,fromCache:o,expiresOn:R,extExpiresOn:I,refreshOn:M,correlationId:n.correlationId,requestId:C||zt.EMPTY_STRING,familyId:F,tokenType:a.accessToken?.tokenType||zt.EMPTY_STRING,state:m?m.userRequestState:zt.EMPTY_STRING,cloudGraphHostName:a.account?.cloudGraphHostName||zt.EMPTY_STRING,msGraphHost:a.account?.msGraphHost||zt.EMPTY_STRING,code:y?.spa_code,fromNativeBroker:!1}}}function DE(t,e,r,a,o,n,f,m,y,C,w,A){A?.verbose("setCachedAccount called");const I=t.getAccountKeys().find(U=>U.startsWith(r));let M=null;I&&(M=t.getAccount(I,o));const F=M||Qa.createAccount({homeAccountId:r,idTokenClaims:n,clientInfo:f,environment:m,cloudGraphHostName:C?.cloud_graph_host_name,msGraphHost:C?.msgraph_host,nativeAccountId:w},e,a),O=F.tenantProfiles||[],j=y||F.realm;if(j&&!O.find(U=>U.tenantId===j)){const U=$C(r,F.localAccountId,j,n);O.push(U)}return F.tenantProfiles=O,F}async function R6(t,e,r){return typeof t=="string"?t:t({clientId:e,tokenEndpoint:r})}class I6 extends AE{constructor(e,r){super(e,r),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,r){if(this.performanceClient?.addQueueMeasurement(Je.AuthClientAcquireToken,e.correlationId),!e.code)throw an(FP);const a=nl(),o=await Nt(this.executeTokenRequest.bind(this),Je.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),n=o.headers?.[Ai.X_MS_REQUEST_ID],f=new Sp(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return f.validateTokenResponse(o.body),Nt(f.handleServerTokenResponse.bind(f),Je.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,a,e,r,void 0,void 0,void 0,n)}getLogoutUri(e){if(!e)throw Wo(qP);const r=this.createLogoutUrlQueryString(e);return vo.appendQueryString(this.authority.endSessionEndpoint,r)}async executeTokenRequest(e,r){this.performanceClient?.addQueueMeasurement(Je.AuthClientExecuteTokenRequest,r.correlationId);const a=this.createTokenQueryParameters(r),o=vo.appendQueryString(e.tokenEndpoint,a),n=await Nt(this.createTokenRequestBody.bind(this),Je.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,r.correlationId)(r);let f;if(r.clientInfo)try{const C=F2(r.clientInfo,this.cryptoUtils.base64Decode);f={credential:`${C.uid}${nb.CLIENT_INFO_SEPARATOR}${C.utid}`,type:Oc.HOME_ACCOUNT_ID}}catch(C){this.logger.verbose("Could not parse client info for CCS Header: "+C)}const m=this.createTokenRequestHeaders(f||r.ccsCredential),y=qC(this.config.authOptions.clientId,r);return Nt(this.executePostToTokenEndpoint.bind(this),Je.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,r.correlationId)(o,n,m,y,r.correlationId,Je.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Je.AuthClientCreateTokenRequestBody,e.correlationId);const r=new Map;if(gE(r,e.embeddedClientId||e.tokenBodyParameters?.[Cp]||this.config.authOptions.clientId),this.includeRedirectUri)yE(r,e.redirectUri);else if(!e.redirectUri)throw Wo(WP);if(mE(r,e.scopes,!0,this.oidcDefaultScopes),nQ(r,e.code),xE(r,this.config.libraryInfo),CE(r,this.config.telemetry.application),w6(r),this.serverTelemetryManager&&!d6(this.config)&&S6(r,this.serverTelemetryManager),e.codeVerifier&&oQ(r,e.codeVerifier),this.config.clientCredentials.clientSecret&&g6(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const o=this.config.clientCredentials.clientAssertion;y6(r,await R6(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),b6(r,o.assertionType)}if(v6(r,TP.AUTHORIZATION_CODE_GRANT),wE(r),e.authenticationScheme===Lo.POP){const o=new ng(this.cryptoUtils,this.performanceClient);let n;e.popKid?n=this.cryptoUtils.encodeKid(e.popKid):n=(await Nt(o.generateCnf.bind(o),Je.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,TE(r,n)}else if(e.authenticationScheme===Lo.SSH)if(e.sshJwk)C6(r,e.sshJwk);else throw Wo(UC);(!Sl.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&bE(r,e.claims,this.config.authOptions.clientCapabilities);let a;if(e.clientInfo)try{const o=F2(e.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${o.uid}${nb.CLIENT_INFO_SEPARATOR}${o.utid}`,type:Oc.HOME_ACCOUNT_ID}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else a=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case Oc.HOME_ACCOUNT_ID:try{const o=Nm(a.credential);jy(r,o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Oc.UPN:U2(r,a.credential);break}return e.embeddedClientId&&WC(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Ff(r,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[b5])&&Ff(r,{[b5]:"1"}),HC(r,e.correlationId,this.performanceClient),rb(r)}createLogoutUrlQueryString(e){const r=new Map;return e.postLogoutRedirectUri&&Xq(r,e.postLogoutRedirectUri),e.correlationId&&vE(r,e.correlationId),e.idTokenHint&&Jq(r,e.idTokenHint),e.state&&m6(r,e.state),e.logoutHint&&sQ(r,e.logoutHint),e.extraQueryParameters&&Ff(r,e.extraQueryParameters),this.config.authOptions.instanceAware&&x6(r),rb(r,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}const DQ=300;class RQ extends AE{constructor(e,r){super(e,r)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Je.RefreshTokenClientAcquireToken,e.correlationId);const r=nl(),a=await Nt(this.executeTokenRequest.bind(this),Je.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=a.headers?.[Ai.X_MS_REQUEST_ID],n=new Sp(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return n.validateTokenResponse(a.body),Nt(n.handleServerTokenResponse.bind(n),Je.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(a.body,this.authority,r,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){if(!e)throw Wo(YP);if(this.performanceClient?.addQueueMeasurement(Je.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw an(eE);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Nt(this.acquireTokenWithCachedRefreshToken.bind(this),Je.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(a){const o=a instanceof Nc&&a.errorCode===H2,n=a instanceof Pp&&a.errorCode===c5.INVALID_GRANT_ERROR&&a.subError===c5.CLIENT_MISMATCH_ERROR;if(o||n)return Nt(this.acquireTokenWithCachedRefreshToken.bind(this),Je.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw a}return Nt(this.acquireTokenWithCachedRefreshToken.bind(this),Je.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,r){this.performanceClient?.addQueueMeasurement(Je.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const a=wl(this.cacheManager.getRefreshToken.bind(this.cacheManager),Je.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,r,e.correlationId,void 0,this.performanceClient);if(!a)throw W2(H2);if(a.expiresOn&&$2(a.expiresOn,e.refreshTokenExpirationOffsetSeconds||DQ))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(a.expiresOn)},e.correlationId),W2(EE);const o={...e,refreshToken:a.secret,authenticationScheme:e.authenticationScheme||Lo.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Oc.HOME_ACCOUNT_ID}};try{return await Nt(this.acquireToken.bind(this),Je.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(n){if(n instanceof Nc&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(a.expiresOn)},e.correlationId),n.subError===XC)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const f=this.cacheManager.generateCredentialKey(a);this.cacheManager.removeRefreshToken(f,e.correlationId)}throw n}}async executeTokenRequest(e,r){this.performanceClient?.addQueueMeasurement(Je.RefreshTokenClientExecuteTokenRequest,e.correlationId);const a=this.createTokenQueryParameters(e),o=vo.appendQueryString(r.tokenEndpoint,a),n=await Nt(this.createTokenRequestBody.bind(this),Je.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),f=this.createTokenRequestHeaders(e.ccsCredential),m=qC(this.config.authOptions.clientId,e);return Nt(this.executePostToTokenEndpoint.bind(this),Je.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,n,f,m,e.correlationId,Je.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Je.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const r=new Map;if(gE(r,e.embeddedClientId||e.tokenBodyParameters?.[Cp]||this.config.authOptions.clientId),e.redirectUri&&yE(r,e.redirectUri),mE(r,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),v6(r,TP.REFRESH_TOKEN_GRANT),wE(r),xE(r,this.config.libraryInfo),CE(r,this.config.telemetry.application),w6(r),this.serverTelemetryManager&&!d6(this.config)&&S6(r,this.serverTelemetryManager),rQ(r,e.refreshToken),this.config.clientCredentials.clientSecret&&g6(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;y6(r,await R6(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),b6(r,a.assertionType)}if(e.authenticationScheme===Lo.POP){const a=new ng(this.cryptoUtils,this.performanceClient);let o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await Nt(a.generateCnf.bind(a),Je.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,TE(r,o)}else if(e.authenticationScheme===Lo.SSH)if(e.sshJwk)C6(r,e.sshJwk);else throw Wo(UC);if((!Sl.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&bE(r,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Oc.HOME_ACCOUNT_ID:try{const a=Nm(e.ccsCredential.credential);jy(r,a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Oc.UPN:U2(r,e.ccsCredential.credential);break}return e.embeddedClientId&&WC(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Ff(r,e.tokenBodyParameters),HC(r,e.correlationId,this.performanceClient),rb(r)}}class IQ extends AE{constructor(e,r){super(e,r)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(Je.SilentFlowClientAcquireCachedToken,e.correlationId);let r=rp.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Sl.isEmptyObj(e.claims))throw this.setCacheOutcome(rp.FORCE_REFRESH_OR_CLAIMS,e.correlationId),an(Of);if(!e.account)throw an(eE);const a=e.account.tenantId||vQ(e.authority),o=this.cacheManager.getTokenKeys(),n=this.cacheManager.getAccessToken(e.account,e,o,a);if(n){if(fQ(n.cachedAt)||$2(n.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(rp.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),an(Of);n.refreshOn&&$2(n.refreshOn,0)&&(r=rp.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(rp.NO_CACHED_ACCESS_TOKEN,e.correlationId),an(Of);const f=e.authority||this.authority.getPreferredCache(),m={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:n,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,o,a,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(f)};return this.setCacheOutcome(r,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Nt(this.generateResultFromCacheRecord.bind(this),Je.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(m,e),r]}setCacheOutcome(e,r){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},r),e!==rp.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,r){this.performanceClient?.addQueueMeasurement(Je.SilentFlowClientGenerateResultFromCacheRecord,r.correlationId);let a;if(e.idToken&&(a=wu(e.idToken.secret,this.config.cryptoInterface.base64Decode)),r.maxAge||r.maxAge===0){const o=a?.auth_time;if(!o)throw an(ZA);a6(o,r.maxAge)}return Sp.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,r,a)}}const PQ={sendGetRequestAsync:()=>Promise.reject(an($r)),sendPostRequestAsync:()=>Promise.reject(an($r))};function MQ(t,e,r,a){const o=e.correlationId,n=new Map;gE(n,e.embeddedClientId||e.extraQueryParameters?.[Cp]||t.clientId);const f=[...e.scopes||[],...e.extraScopesToConsent||[]];if(mE(n,f,!0,t.authority.options.OIDCOptions?.defaultScopes),yE(n,e.redirectUri),vE(n,o),qq(n,e.responseMode),wE(n),e.prompt&&(eQ(n,e.prompt),a?.addFields({prompt:e.prompt},o)),e.domainHint&&(Zq(n,e.domainHint),a?.addFields({domainHintFromRequest:!0},o)),e.prompt!==Us.SELECT_ACCOUNT)if(e.sid&&e.prompt===Us.NONE)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),v5(n,e.sid),a?.addFields({sidFromRequest:!0},o);else if(e.account){const m=FQ(e.account);let y=NQ(e.account);if(y&&e.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),y=null),y){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),_x(n,y),a?.addFields({loginHintFromClaim:!0},o);try{const C=Nm(e.account.homeAccountId);jy(n,C)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(m&&e.prompt===Us.NONE){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),v5(n,m),a?.addFields({sidFromClaim:!0},o);try{const C=Nm(e.account.homeAccountId);jy(n,C)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),_x(n,e.loginHint),U2(n,e.loginHint),a?.addFields({loginHintFromRequest:!0},o);else if(e.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),_x(n,e.account.username),a?.addFields({loginHintFromUpn:!0},o);try{const C=Nm(e.account.homeAccountId);jy(n,C)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),_x(n,e.loginHint),U2(n,e.loginHint),a?.addFields({loginHintFromRequest:!0},o));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&tQ(n,e.nonce),e.state&&m6(n,e.state),(e.claims||t.clientCapabilities&&t.clientCapabilities.length>0)&&bE(n,e.claims,t.clientCapabilities),e.embeddedClientId&&WC(n,t.clientId,t.redirectUri),t.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(DT))&&x6(n),n}function RE(t,e,r,a){const o=rb(e,r,a);return vo.appendQueryString(t.authorizationEndpoint,o)}function _Q(t,e){if(P6(t,e),!t.code)throw an(zP);return t}function P6(t,e){if(!t.state||!e)throw t.state?an(ST,"Cached State"):an(ST,"Server State");let r,a;try{r=decodeURIComponent(t.state)}catch{throw an(tg,t.state)}try{a=decodeURIComponent(e)}catch{throw an(tg,t.state)}if(r!==a)throw an(PP);if(t.error||t.error_description||t.suberror){const o=OQ(t);throw D6(t.error,t.error_description,t.suberror)?new Nc(t.error||"",t.error_description,t.suberror,t.timestamp||"",t.trace_id||"",t.correlation_id||"",t.claims||"",o):new Pp(t.error||"",t.error_description,t.suberror,o)}}function OQ(t){const e="code=",r=t.error_uri?.lastIndexOf(e);return r&&r>=0?t.error_uri?.substring(r+e.length):void 0}function FQ(t){return t.idTokenClaims?.sid||null}function NQ(t){return t.loginHint||t.idTokenClaims?.login_hint||null}const k5=",",M6="|";function jQ(t){const{skus:e,libraryName:r,libraryVersion:a,extensionName:o,extensionVersion:n}=t,f=new Map([[0,[r,a]],[2,[o,n]]]);let m=[];if(e?.length){if(m=e.split(k5),m.length<4)return e}else m=Array.from({length:4},()=>M6);return f.forEach((y,C)=>{y.length===2&&y[0]?.length&&y[1]?.length&&LQ({skuArr:m,index:C,skuName:y[0],skuVersion:y[1]})}),m.join(k5)}function LQ(t){const{skuArr:e,index:r,skuName:a,skuVersion:o}=t;r>=e.length||(e[r]=[a,o].join(M6))}class ob{constructor(e,r){this.cacheOutcome=rp.NOT_APPLICABLE,this.cacheManager=r,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||zt.EMPTY_STRING,this.wrapperVer=e.wrapperVer||zt.EMPTY_STRING,this.telemetryCacheKey=js.CACHE_KEY+nb.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${js.VALUE_SEPARATOR}${this.cacheOutcome}`,r=[this.wrapperSKU,this.wrapperVer],a=this.getNativeBrokerErrorCode();a?.length&&r.push(`broker_error=${a}`);const o=r.join(js.VALUE_SEPARATOR),n=this.getRegionDiscoveryFields(),f=[e,n].join(js.VALUE_SEPARATOR);return[js.SCHEMA_VERSION,f,o].join(js.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),r=ob.maxErrorsToSend(e),a=e.failedRequests.slice(0,2*r).join(js.VALUE_SEPARATOR),o=e.errors.slice(0,r).join(js.VALUE_SEPARATOR),n=e.errors.length,f=r<n?js.OVERFLOW_TRUE:js.OVERFLOW_FALSE,m=[n,f].join(js.VALUE_SEPARATOR);return[js.SCHEMA_VERSION,e.cacheHits,a,o,m].join(js.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const r=this.getLastRequests();r.errors.length>=js.MAX_CACHED_ERRORS&&(r.failedRequests.shift(),r.failedRequests.shift(),r.errors.shift()),r.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Vo?e.subError?r.errors.push(e.subError):e.errorCode?r.errors.push(e.errorCode):r.errors.push(e.toString()):r.errors.push(e.toString()):r.errors.push(js.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),r=ob.maxErrorsToSend(e),a=e.errors.length;if(r===a)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const o={failedRequests:e.failedRequests.slice(r*2),errors:e.errors.slice(r),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o,this.correlationId)}}static maxErrorsToSend(e){let r,a=0,o=0;const n=e.errors.length;for(r=0;r<n;r++){const f=e.failedRequests[2*r]||zt.EMPTY_STRING,m=e.failedRequests[2*r+1]||zt.EMPTY_STRING,y=e.errors[r]||zt.EMPTY_STRING;if(o+=f.toString().length+m.toString().length+y.length+3,o<js.MAX_LAST_HEADER_BYTES)a+=1;else break}return a}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||zt.EMPTY_STRING),e.push(this.regionSource||zt.EMPTY_STRING),e.push(this.regionOutcome||zt.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const r=this.getLastRequests();r.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return jQ(e)}}const _6="missing_kid_error",O6="missing_alg_error";const BQ={[_6]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[O6]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class IE extends Vo{constructor(e,r){super(e,r),this.name="JoseHeaderError",Object.setPrototypeOf(this,IE.prototype)}}function D5(t){return new IE(t,BQ[t])}class PE{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw D5(_6);if(!e.alg)throw D5(O6);const r=new PE({typ:e.typ||MY.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(r)}}const ME="pkce_not_created",_E="ear_jwk_empty",F6="ear_jwe_empty",RT="crypto_nonexistent",JC="empty_navigate_uri",N6="hash_empty_error",OE="no_state_in_hash",j6="hash_does_not_contain_known_properties",L6="unable_to_parse_state",B6="state_interaction_type_mismatch",z6="interaction_in_progress",U6="popup_window_error",$6="empty_window_error",ab="user_cancelled",zQ="monitor_popup_timeout",H6="monitor_window_timeout",W6="redirect_in_iframe",V6="block_iframe_reload",G6="block_nested_popups",UQ="iframe_closed_prematurely",ZC="silent_logout_unsupported",K6="no_account_error",$Q="silent_prompt_value_error",Y6="no_token_request_cache_error",q6="unable_to_parse_token_request_cache_error",HQ="auth_request_not_set_error",WQ="invalid_cache_type",eS="non_browser_environment",Dm="database_not_open",V2="no_network_connectivity",Q6="post_request_failed",X6="get_request_failed",IT="failed_to_parse_response",J6="unable_to_load_token",FE="crypto_key_not_found",Z6="auth_code_required",eM="auth_code_or_nativeAccountId_required",tM="spa_code_and_nativeAccountId_present",NE="database_unavailable",nM="unable_to_acquire_token_from_native_platform",rM="native_handshake_timeout",oM="native_extension_not_installed",jE="native_connection_not_established",Ly="uninitialized_public_client_application",aM="native_prompt_not_supported",sM="invalid_base64_string",iM="invalid_pop_token_request",lM="failed_to_build_headers",cM="failed_to_parse_headers",t2="failed_to_decrypt_ear_response",G2="timed_out";const md="For more visit: aka.ms/msaljs/browser-errors",VQ={[ME]:"The PKCE code challenge and verifier could not be generated.",[_E]:"No EAR encryption key provided. This is unexpected.",[F6]:"Server response does not contain ear_jwe property. This is unexpected.",[RT]:"The crypto object or function is not available.",[JC]:"Navigation URI is empty. Please check stack trace for more info.",[N6]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${md}`,[OE]:"Hash does not contain state. Please verify that the request originated from msal.",[j6]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${md}`,[L6]:"Unable to parse state. Please verify that the request originated from msal.",[B6]:"Hash contains state but the interaction type does not match the caller.",[z6]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${md}`,[U6]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[$6]:"window.open returned null or undefined window object.",[ab]:"User cancelled the flow.",[zQ]:`Token acquisition in popup failed due to timeout.  ${md}`,[H6]:`Token acquisition in iframe failed due to timeout.  ${md}`,[W6]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[V6]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${md}`,[G6]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[UQ]:"The iframe being monitored was closed prematurely.",[ZC]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[K6]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[$Q]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Y6]:"No token request found in cache.",[q6]:"The cached token request could not be parsed.",[HQ]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[WQ]:"Invalid cache type",[eS]:"Login and token requests are not supported in non-browser environments.",[Dm]:"Database is not open!",[V2]:"No network connectivity. Check your internet connection.",[Q6]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[X6]:"Network request failed. Please check the network trace to determine root cause.",[IT]:"Failed to parse network response. Check network trace.",[J6]:"Error loading token to cache.",[FE]:"Cryptographic Key or Keypair not found in browser storage.",[Z6]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[eM]:"An authorization code or nativeAccountId must be provided to this flow.",[tM]:"Request cannot contain both spa code and native account id.",[NE]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[nM]:`Unable to acquire token from native platform.  ${md}`,[rM]:"Timed out while attempting to establish connection to browser extension",[oM]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[jE]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${md}`,[Ly]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${md}`,[aM]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[sM]:"Invalid base64 encoded string.",[iM]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[lM]:"Failed to build request headers object.",[cM]:"Failed to parse response headers",[t2]:"Failed to decrypt ear response",[G2]:"The request timed out."};class kb extends Vo{constructor(e,r){super(e,VQ[e],r),Object.setPrototypeOf(this,kb.prototype),this.name="BrowserAuthError"}}function Nn(t,e){return new kb(t,e)}const Vi={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Yl={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS",MICROSOFT_ENTRA_BROKERID:"MicrosoftEntra",DOM_API_NAME:"DOM API",PLATFORM_DOM_APIS:"get-token-and-sign-out",PLATFORM_DOM_PROVIDER:"PlatformAuthDOMHandler",PLATFORM_EXTENSION_PROVIDER:"PlatformAuthExtensionHandler"},by={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},$s={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},R5={GET:"GET",POST:"POST"},Rf={SIGNIN:"signin",SIGNOUT:"signout"},cs={ORIGIN_URI:"request.origin",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",VERIFIER:"code.verifier",INTERACTION_STATUS_KEY:"interaction.status",NATIVE_REQUEST:"request.native"},Fx={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Po={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var br;(function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"})(br||(br={}));const I5={scopes:hg},uM="jwk",PT="msal.db",GQ=1,KQ=`${PT}.keys`,wi={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},YQ=[wi.Default,wi.Skip,wi.RefreshTokenAndNetwork];function Nx(t){return encodeURIComponent(sb(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function zf(t){return dM(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function sb(t){return dM(new TextEncoder().encode(t))}function dM(t){const e=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(e)}function ki(t){return new TextDecoder().decode(Nf(t))}function Nf(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Nn(sM)}const r=atob(e);return Uint8Array.from(r,a=>a.codePointAt(0)||0)}const qQ="RSASSA-PKCS1-v1_5",mg="AES-GCM",fM="HKDF",LE="SHA-256",QQ=2048,XQ=new Uint8Array([1,0,1]),P5="0123456789abcdef",M5=new Uint32Array(1),BE="raw",hM="encrypt",zE="decrypt",JQ="deriveKey",ZQ="crypto_subtle_undefined",UE={name:qQ,hash:LE,modulusLength:QQ,publicExponent:XQ};function eX(t){if(!window)throw Nn(eS);if(!window.crypto)throw Nn(RT);if(!t&&!window.crypto.subtle)throw Nn(RT,ZQ)}async function pM(t,e,r){e?.addQueueMeasurement(Je.Sha256Digest,r);const o=new TextEncoder().encode(t);return window.crypto.subtle.digest(LE,o)}function tX(t){return window.crypto.getRandomValues(t)}function Cw(){return window.crypto.getRandomValues(M5),M5[0]}function jc(){const t=Date.now(),e=Cw()*1024+(Cw()&1023),r=new Uint8Array(16),a=Math.trunc(e/2**30),o=e&2**30-1,n=Cw();r[0]=t/2**40,r[1]=t/2**32,r[2]=t/2**24,r[3]=t/2**16,r[4]=t/2**8,r[5]=t,r[6]=112|a>>>8,r[7]=a,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=n>>>24,r[13]=n>>>16,r[14]=n>>>8,r[15]=n;let f="";for(let m=0;m<r.length;m++)f+=P5.charAt(r[m]>>>4),f+=P5.charAt(r[m]&15),(m===3||m===5||m===7||m===9)&&(f+="-");return f}async function nX(t,e){return window.crypto.subtle.generateKey(UE,t,e)}async function Sw(t){return window.crypto.subtle.exportKey(uM,t)}async function rX(t,e,r){return window.crypto.subtle.importKey(uM,t,UE,e,r)}async function oX(t,e){return window.crypto.subtle.sign(UE,t,e)}async function $E(){const t=await mM(),r={alg:"dir",kty:"oct",k:zf(new Uint8Array(t))};return sb(JSON.stringify(r))}async function aX(t){const e=ki(t),a=JSON.parse(e).k,o=Nf(a);return window.crypto.subtle.importKey(BE,o,mg,!1,[zE])}async function sX(t,e){const r=e.split(".");if(r.length!==5)throw Nn(t2,"jwe_length");const a=await aX(t).catch(()=>{throw Nn(t2,"import_key")});try{const o=new TextEncoder().encode(r[0]),n=Nf(r[2]),f=Nf(r[3]),m=Nf(r[4]),y=m.byteLength*8,C=new Uint8Array(f.length+m.length);C.set(f),C.set(m,f.length);const w=await window.crypto.subtle.decrypt({name:mg,iv:n,tagLength:y,additionalData:o},a,C);return new TextDecoder().decode(w)}catch{throw Nn(t2,"decrypt")}}async function mM(){const t=await window.crypto.subtle.generateKey({name:mg,length:256},!0,[hM,zE]);return window.crypto.subtle.exportKey(BE,t)}async function _5(t){return window.crypto.subtle.importKey(BE,t,fM,!1,[JQ])}async function gM(t,e,r){return window.crypto.subtle.deriveKey({name:fM,salt:e,hash:LE,info:new TextEncoder().encode(r)},t,{name:mg,length:256},!1,[hM,zE])}async function iX(t,e,r){const a=new TextEncoder().encode(e),o=window.crypto.getRandomValues(new Uint8Array(16)),n=await gM(t,o,r),f=await window.crypto.subtle.encrypt({name:mg,iv:new Uint8Array(12)},n,a);return{data:zf(new Uint8Array(f)),nonce:zf(o)}}async function O5(t,e,r,a){const o=Nf(a),n=await gM(t,Nf(e),r),f=await window.crypto.subtle.decrypt({name:mg,iv:new Uint8Array(12)},n,o);return new TextDecoder().decode(f)}async function yM(t){const e=await pM(t),r=new Uint8Array(e);return zf(r)}const tS="storage_not_supported",bM="stubbed_public_client_application_called",HE="in_mem_redirect_unavailable";const n2={[tS]:"Given storage configuration option was not supported.",[bM]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[HE]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};n2[tS],n2[bM],n2[HE];class WE extends Vo{constructor(e,r){super(e,r),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,WE.prototype)}}function VE(t){return new WE(t,n2[t])}function vM(t){t.location.hash="",typeof t.history.replaceState=="function"&&t.history.replaceState(null,"",`${t.location.origin}${t.location.pathname}${t.location.search}`)}function lX(t){const e=t.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function GE(){return window.parent!==window}function cX(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Vi.POPUP_NAME_PREFIX}.`)===0}function yd(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function uX(){const e=new vo(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function dX(){if(vo.hashContainsKnownProperties(window.location.hash)&&GE())throw Nn(V6)}function fX(t){if(GE()&&!t)throw Nn(W6)}function hX(){if(cX())throw Nn(G6)}function xM(){if(typeof window>"u")throw Nn(eS)}function CM(t){if(!t)throw Nn(Ly)}function KE(t){xM(),dX(),hX(),CM(t)}function F5(t,e){if(KE(t),fX(e.system.allowRedirectInIframe),e.cache.cacheLocation===$s.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw VE(HE)}function SM(t){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(t).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function pX(){return jc()}class K2{navigateInternal(e,r){return K2.defaultNavigateWindow(e,r)}navigateExternal(e,r){return K2.defaultNavigateWindow(e,r)}static defaultNavigateWindow(e,r){return r.noHistory?window.location.replace(e):window.location.assign(e),new Promise((a,o)=>{setTimeout(()=>{o(Nn(G2,"failed_to_redirect"))},r.timeout)})}}class mX{async sendGetRequestAsync(e,r){let a,o={},n=0;const f=N5(r);try{a=await fetch(e,{method:R5.GET,headers:f})}catch(m){throw Ry(Nn(window.navigator.onLine?X6:V2),void 0,void 0,m)}o=j5(a.headers);try{return n=a.status,{headers:o,body:await a.json(),status:n}}catch(m){throw Ry(Nn(IT),n,o,m)}}async sendPostRequestAsync(e,r){const a=r&&r.body||"",o=N5(r);let n,f=0,m={};try{n=await fetch(e,{method:R5.POST,headers:o,body:a})}catch(y){throw Ry(Nn(window.navigator.onLine?Q6:V2),void 0,void 0,y)}m=j5(n.headers);try{return f=n.status,{headers:m,body:await n.json(),status:f}}catch(y){throw Ry(Nn(IT),f,m,y)}}}function N5(t){try{const e=new Headers;if(!(t&&t.headers))return e;const r=t.headers;return Object.entries(r).forEach(([a,o])=>{e.append(a,o)}),e}catch(e){throw Ry(Nn(lM),void 0,void 0,e)}}function j5(t){try{const e={};return t.forEach((r,a)=>{e[a]=r}),e}catch{throw Nn(cM)}}const gX=6e4,MT=1e4,yX=3e4,wM=2e3;function bX({auth:t,cache:e,system:r,telemetry:a},o){const n={clientId:zt.EMPTY_STRING,authority:`${zt.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:zt.EMPTY_STRING,authorityMetadata:zt.EMPTY_STRING,redirectUri:typeof window<"u"?yd():"",postLogoutRedirectUri:zt.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Xi.AAD,OIDCOptions:{serverResponseType:zC.FRAGMENT,defaultScopes:[zt.OPENID_SCOPE,zt.PROFILE_SCOPE,zt.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:aE.None,tenant:zt.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},f={cacheLocation:$s.SessionStorage,cacheRetentionDays:5,temporaryCacheLocation:$s.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===$s.LocalStorage),claimsBasedCachingEnabled:!1},m={loggerCallback:()=>{},logLevel:ya.Info,piiLoggingEnabled:!1},C={...{...u6,loggerOptions:m,networkClient:o?new mX:PQ,navigationClient:new K2,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||gX,iframeHashTimeout:r?.loadFrameTimeout||MT,navigateFrameWait:0,redirectNavigationTimeout:yX,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,allowPlatformBrokerWithDOM:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||wM,pollIntervalMilliseconds:Vi.DEFAULT_POLL_INTERVAL_MS},...r,loggerOptions:r?.loggerOptions||m},w={application:{appName:zt.EMPTY_STRING,appVersion:zt.EMPTY_STRING},client:new c6};if(t?.protocolMode!==Xi.OIDC&&t?.OIDCOptions&&new Bf(C.loggerOptions).warning(JSON.stringify(Wo(ZP))),t?.protocolMode&&t.protocolMode===Xi.OIDC&&C?.allowPlatformBroker)throw Wo(e6);return{auth:{...n,...t,OIDCOptions:{...n.OIDCOptions,...t?.OIDCOptions}},cache:{...f,...e},system:C,telemetry:{...w,...a}}}const vX="@azure/msal-browser",wp="4.27.0";const ti="msal",TM="browser",L5="|",Zs=2,r2=2,xX=`${ti}.${TM}.log.level`,CX=`${ti}.${TM}.log.pii`,B5=`${ti}.version`,z5="account.keys",U5="token.keys";function Bm(t=r2){return t<1?`${ti}.${z5}`:`${ti}.${t}.${z5}`}function zm(t,e=Zs){return e<1?`${ti}.${U5}.${t}`:`${ti}.${e}.${U5}.${t}`}class YE{static loggerCallback(e,r){switch(e){case ya.Error:console.error(r);return;case ya.Info:console.info(r);return;case ya.Verbose:console.debug(r);return;case ya.Warning:console.warn(r);return;default:console.log(r);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=bX(e,this.browserEnvironment);let r;try{r=window[$s.SessionStorage]}catch{}const a=r?.getItem(xX),o=r?.getItem(CX)?.toLowerCase(),n=o==="true"?!0:o==="false"?!1:void 0,f={...this.config.system.loggerOptions},m=a&&Object.keys(ya).includes(a)?ya[a]:void 0;m&&(f.loggerCallback=YE.loggerCallback,f.logLevel=m),n!==void 0&&(f.piiLoggingEnabled=n),this.logger=new Bf(f,vX,wp),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class Tp extends YE{getModuleName(){return Tp.MODULE_NAME}getId(){return Tp.ID}async initialize(){return this.available=typeof window<"u",this.available}}Tp.MODULE_NAME="";Tp.ID="StandardOperatingContext";class SX{constructor(){this.dbName=PT,this.version=GQ,this.tableName=KQ,this.dbOpen=!1}async open(){return new Promise((e,r)=>{const a=window.indexedDB.open(this.dbName,this.version);a.addEventListener("upgradeneeded",o=>{o.target.result.createObjectStore(this.tableName)}),a.addEventListener("success",o=>{const n=o;this.db=n.target.result,this.dbOpen=!0,e()}),a.addEventListener("error",()=>r(Nn(NE)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((r,a)=>{if(!this.db)return a(Nn(Dm));const f=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);f.addEventListener("success",m=>{const y=m;this.closeConnection(),r(y.target.result)}),f.addEventListener("error",m=>{this.closeConnection(),a(m)})})}async setItem(e,r){return await this.validateDbIsOpen(),new Promise((a,o)=>{if(!this.db)return o(Nn(Dm));const m=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(r,e);m.addEventListener("success",()=>{this.closeConnection(),a()}),m.addEventListener("error",y=>{this.closeConnection(),o(y)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((r,a)=>{if(!this.db)return a(Nn(Dm));const f=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);f.addEventListener("success",()=>{this.closeConnection(),r()}),f.addEventListener("error",m=>{this.closeConnection(),a(m)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,r)=>{if(!this.db)return r(Nn(Dm));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",f=>{const m=f;this.closeConnection(),e(m.target.result)}),n.addEventListener("error",f=>{this.closeConnection(),r(f)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((r,a)=>{if(!this.db)return a(Nn(Dm));const f=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);f.addEventListener("success",m=>{const y=m;this.closeConnection(),r(y.target.result===1)}),f.addEventListener("error",m=>{this.closeConnection(),a(m)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,r)=>{const a=window.indexedDB.deleteDatabase(PT),o=setTimeout(()=>r(!1),200);a.addEventListener("success",()=>(clearTimeout(o),e(!0))),a.addEventListener("blocked",()=>(clearTimeout(o),e(!0))),a.addEventListener("error",()=>(clearTimeout(o),r(!1)))})}}class nS{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,r){this.cache.set(e,r)}async setUserData(e,r){this.setItem(e,r)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((r,a)=>{e.push(a)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}class wX{constructor(e){this.inMemoryCache=new nS,this.indexedDBCache=new SX,this.logger=e}handleDatabaseAccessError(e){if(e instanceof kb&&e.errorCode===NE)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const r=this.inMemoryCache.getItem(e);if(!r)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(a){this.handleDatabaseAccessError(a)}return r}async setItem(e,r){this.inMemoryCache.setItem(e,r);try{await this.indexedDBCache.setItem(e,r)}catch(a){this.handleDatabaseAccessError(a)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(r){this.handleDatabaseAccessError(r)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(r){this.handleDatabaseAccessError(r)}return e}async containsKey(e){const r=this.inMemoryCache.containsKey(e);if(!r)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(a){this.handleDatabaseAccessError(a)}return r}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class Ad{constructor(e,r,a){this.logger=e,eX(a??!1),this.cache=new wX(this.logger),this.performanceClient=r}createNewGuid(){return jc()}base64Encode(e){return sb(e)}base64Decode(e){return ki(e)}base64UrlEncode(e){return Nx(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const r=this.performanceClient?.startMeasurement(Je.CryptoOptsGetPublicKeyThumbprint,e.correlationId),a=await nX(Ad.EXTRACTABLE,Ad.POP_KEY_USAGES),o=await Sw(a.publicKey),n={e:o.e,kty:o.kty,n:o.n},f=$5(n),m=await this.hashString(f),y=await Sw(a.privateKey),C=await rX(y,!1,["sign"]);return await this.cache.setItem(m,{privateKey:C,publicKey:a.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),r&&r.end({success:!0}),m}async removeTokenBindingKey(e){if(await this.cache.removeItem(e),await this.cache.containsKey(e))throw an(UP)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,r,a,o){const n=this.performanceClient?.startMeasurement(Je.CryptoOptsSignJwt,o),f=await this.cache.getItem(r);if(!f)throw Nn(FE);const m=await Sw(f.publicKey),y=$5(m),C=Nx(JSON.stringify({kid:r})),w=PE.getShrHeaderString({...a?.header,alg:m.alg,kid:C}),A=Nx(w);e.cnf={jwk:JSON.parse(y)};const R=Nx(JSON.stringify(e)),I=`${A}.${R}`,F=new TextEncoder().encode(I),O=await oX(f.privateKey,F),j=zf(new Uint8Array(O)),U=`${I}.${j}`;return n&&n.end({success:!0}),U}async hashString(e){return yM(e)}}Ad.POP_KEY_USAGES=["sign","verify"];Ad.EXTRACTABLE=!0;function $5(t){return JSON.stringify(t,Object.keys(t).sort())}const TX=1440*60*1e3,_T={Lax:"Lax",None:"None"};class AM{initialize(){return Promise.resolve()}getItem(e){const r=`${encodeURIComponent(e)}`,a=document.cookie.split(";");for(let o=0;o<a.length;o++){const n=a[o],[f,...m]=decodeURIComponent(n).trim().split("="),y=m.join("=");if(f===r)return y}return""}getUserData(){throw an($r)}setItem(e,r,a,o=!0,n=_T.Lax){let f=`${encodeURIComponent(e)}=${encodeURIComponent(r)};path=/;SameSite=${n};`;if(a){const m=AX(a);f+=`expires=${m};`}(o||n===_T.None)&&(f+="Secure;"),document.cookie=f}async setUserData(){return Promise.reject(an($r))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),r=[];return e.forEach(a=>{const o=decodeURIComponent(a).trim().split("=");r.push(o[0])}),r}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function AX(t){const e=new Date;return new Date(e.getTime()+t*TX).toUTCString()}function Af(t,e){const r=t.getItem(Bm(e));return r?JSON.parse(r):[]}function Mc(t,e,r){const a=e.getItem(zm(t,r));if(a){const o=JSON.parse(a);if(o&&o.hasOwnProperty("idToken")&&o.hasOwnProperty("accessToken")&&o.hasOwnProperty("refreshToken"))return o}return{idToken:[],accessToken:[],refreshToken:[]}}function o2(t){return t.hasOwnProperty("id")&&t.hasOwnProperty("nonce")&&t.hasOwnProperty("data")}const H5="msal.cache.encryption",EX="msal.broadcast.cache";class kX{constructor(e,r,a){if(!window.localStorage)throw VE(tS);this.memoryStorage=new nS,this.initialized=!1,this.clientId=e,this.logger=r,this.performanceClient=a,this.broadcast=new BroadcastChannel(EX)}async initialize(e){const r=new AM,a=r.getItem(H5);let o={key:"",id:""};if(a)try{o=JSON.parse(a)}catch{}if(o.key&&o.id){const n=wl(Nf,Je.Base64Decode,this.logger,this.performanceClient,e)(o.key);this.encryptionCookie={id:o.id,key:await Nt(_5,Je.GenerateHKDF,this.logger,this.performanceClient,e)(n)}}else{const n=jc(),f=await Nt(mM,Je.GenerateBaseKey,this.logger,this.performanceClient,e)(),m=wl(zf,Je.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(f));this.encryptionCookie={id:n,key:await Nt(_5,Je.GenerateHKDF,this.logger,this.performanceClient,e)(f)};const y={id:n,key:m};r.setItem(H5,JSON.stringify(y),0,!0,_T.None)}await Nt(this.importExistingCache.bind(this),Je.ImportExistingCache,this.logger,this.performanceClient,e)(e),this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Nn(Ly);return this.memoryStorage.getItem(e)}async decryptData(e,r,a){if(!this.initialized||!this.encryptionCookie)throw Nn(Ly);if(r.id!==this.encryptionCookie.id)return this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},a),null;const o=await Nt(O5,Je.Decrypt,this.logger,this.performanceClient,a)(this.encryptionCookie.key,r.nonce,this.getContext(e),r.data);if(!o)return null;try{return{...JSON.parse(o),lastUpdatedAt:r.lastUpdatedAt}}catch{return this.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},a),null}}setItem(e,r){window.localStorage.setItem(e,r)}async setUserData(e,r,a,o,n){if(!this.initialized||!this.encryptionCookie)throw Nn(Ly);if(n)this.setItem(e,r);else{const{data:f,nonce:m}=await Nt(iX,Je.Encrypt,this.logger,this.performanceClient,a)(this.encryptionCookie.key,r,this.getContext(e)),y={id:this.encryptionCookie.id,nonce:m,data:f,lastUpdatedAt:o};this.setItem(e,JSON.stringify(y))}this.memoryStorage.setItem(e,r),this.broadcast.postMessage({key:e,value:r,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),Af(this).forEach(a=>this.removeItem(a));const r=Mc(this.clientId,this);r.idToken.forEach(a=>this.removeItem(a)),r.accessToken.forEach(a=>this.removeItem(a)),r.refreshToken.forEach(a=>this.removeItem(a)),this.getKeys().forEach(a=>{(a.startsWith(ti)||a.indexOf(this.clientId)!==-1)&&this.removeItem(a)})}async importExistingCache(e){if(!this.encryptionCookie)return;let r=Af(this);r=await this.importArray(r,e),r.length?this.setItem(Bm(),JSON.stringify(r)):this.removeItem(Bm());const a=Mc(this.clientId,this);a.idToken=await this.importArray(a.idToken,e),a.accessToken=await this.importArray(a.accessToken,e),a.refreshToken=await this.importArray(a.refreshToken,e),a.idToken.length||a.accessToken.length||a.refreshToken.length?this.setItem(zm(this.clientId),JSON.stringify(a)):this.removeItem(zm(this.clientId))}async getItemFromEncryptedCache(e,r){if(!this.encryptionCookie)return null;const a=this.getItem(e);if(!a)return null;let o;try{o=JSON.parse(a)}catch{return null}return o2(o)?o.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},r),null):(this.performanceClient.incrementFields({encryptedCacheCount:1},r),Nt(O5,Je.Decrypt,this.logger,this.performanceClient,r)(this.encryptionCookie.key,o.nonce,this.getContext(e),o.data)):(this.performanceClient.incrementFields({unencryptedCacheCount:1},r),a)}async importArray(e,r){const a=[],o=[];return e.forEach(n=>{const f=this.getItemFromEncryptedCache(n,r).then(m=>{m?(this.memoryStorage.setItem(n,m),a.push(n)):this.removeItem(n)});o.push(f)}),await Promise.all(o),a}getContext(e){let r="";return e.includes(this.clientId)&&(r=this.clientId),r}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const r=this.performanceClient.startMeasurement(Je.LocalStorageUpdated);r.add({isBackground:!0});const{key:a,value:o,context:n}=e.data;if(!a){this.logger.error("Broadcast event missing key"),r.end({success:!1,errorCode:"noKey"});return}if(n&&n!==this.clientId){this.logger.trace(`Ignoring broadcast event from clientId: ${n}`),r.end({success:!1,errorCode:"contextMismatch"});return}o?(this.memoryStorage.setItem(a,o),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(a),this.logger.verbose("Removed item from internal cache")),r.end({success:!0})}}class DX{constructor(){if(!window.sessionStorage)throw VE(tS)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,r){window.sessionStorage.setItem(e,r)}async setUserData(e,r){this.setItem(e,r)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}const hr={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache",BROKER_CONNECTION_ESTABLISHED:"msal:brokerConnectionEstablished"};function wf(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}class OT extends kT{constructor(e,r,a,o,n,f,m){super(e,a,o,n,m),this.cacheConfig=r,this.logger=o,this.internalStorage=new nS,this.browserStorage=W5(e,r.cacheLocation,o,n),this.temporaryCacheStorage=W5(e,r.temporaryCacheLocation,o,n),this.cookieStorage=new AM,this.eventHandler=f}async initialize(e){this.performanceClient.addFields({cacheLocation:this.cacheConfig.cacheLocation,cacheRetentionDays:this.cacheConfig.cacheRetentionDays},e),await this.browserStorage.initialize(e),await this.migrateExistingCache(e),this.trackVersionChanges(e)}async migrateExistingCache(e){let r=Af(this.browserStorage),a=Mc(this.clientId,this.browserStorage);this.performanceClient.addFields({preMigrateAcntCount:r.length,preMigrateATCount:a.accessToken.length,preMigrateITCount:a.idToken.length,preMigrateRTCount:a.refreshToken.length},e);for(let n=0;n<r2;n++){const f=n;await this.removeStaleAccounts(n,f,e)}for(let n=0;n<Zs;n++){const f=n;await this.migrateIdTokens(n,f,e)}const o=this.getKMSIValues();for(let n=0;n<Zs;n++)await this.migrateAccessTokens(n,o,e),await this.migrateRefreshTokens(n,o,e);r=Af(this.browserStorage),a=Mc(this.clientId,this.browserStorage),this.performanceClient.addFields({postMigrateAcntCount:r.length,postMigrateATCount:a.accessToken.length,postMigrateITCount:a.idToken.length,postMigrateRTCount:a.refreshToken.length},e)}async updateOldEntry(e,r){const a=this.browserStorage.getItem(e),o=this.validateAndParseJson(a||"");if(!o)return this.browserStorage.removeItem(e),null;if(!o.lastUpdatedAt)o.lastUpdatedAt=Date.now().toString(),this.setItem(e,JSON.stringify(o),r);else if(C5(o.lastUpdatedAt,this.cacheConfig.cacheRetentionDays))return this.browserStorage.removeItem(e),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},r),null;const n=o2(o)?await this.browserStorage.decryptData(e,o,r):o;return!n||!YC(n)?(this.performanceClient.incrementFields({invalidCacheCount:1},r),null):(S5(n)||w5(n))&&n.expiresOn&&$2(n.expiresOn,AP)?(this.browserStorage.removeItem(e),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},r),null):n}async removeStaleAccounts(e,r,a){const o=Af(this.browserStorage,e);if(o.length!==0){for(const n of[...o]){this.performanceClient.incrementFields({oldAcntCount:1},a);const f=this.browserStorage.getItem(n),m=this.validateAndParseJson(f||"");if(!m){wf(o,n);continue}if(m.lastUpdatedAt)C5(m.lastUpdatedAt,this.cacheConfig.cacheRetentionDays)&&(await this.removeAccountOldSchema(n,m,r,a),wf(o,n));else{m.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(m),a);continue}}this.setAccountKeys(o,a,e)}}async removeAccountOldSchema(e,r,a,o){const f=(o2(r)?await this.browserStorage.decryptData(e,r,o):r)?.homeAccountId;if(f){const m=this.getTokenKeys(a);[...m.idToken].filter(y=>y.includes(f)).forEach(y=>{this.browserStorage.removeItem(y),wf(m.idToken,y)}),[...m.accessToken].filter(y=>y.includes(f)).forEach(y=>{this.browserStorage.removeItem(y),wf(m.accessToken,y)}),[...m.refreshToken].filter(y=>y.includes(f)).forEach(y=>{this.browserStorage.removeItem(y),wf(m.refreshToken,y)}),this.setTokenKeys(m,o,a)}this.performanceClient.incrementFields({expiredAcntRemovedCount:1},o),this.browserStorage.removeItem(e)}getKMSIValues(){const e={},r=this.getTokenKeys().idToken;for(const a of r){const o=this.browserStorage.getUserData(a);if(o){const n=JSON.parse(o),f=wu(n.secret,ki);f&&(e[n.homeAccountId]=ku(f))}}return e}async migrateIdTokens(e,r,a){const o=Mc(this.clientId,this.browserStorage,e);if(o.idToken.length===0)return;const n=Mc(this.clientId,this.browserStorage,Zs),f=Af(this.browserStorage),m=Af(this.browserStorage,r);for(const y of[...o.idToken]){this.performanceClient.incrementFields({oldITCount:1},a);const C=await this.updateOldEntry(y,a);if(!C){wf(o.idToken,y);continue}const w=f.find(U=>U.includes(C.homeAccountId)),A=m.find(U=>U.includes(C.homeAccountId));let R=null;if(w)R=this.getAccount(w,a);else if(A){const U=this.browserStorage.getItem(A),H=this.validateAndParseJson(U||"");R=H&&o2(H)?await this.browserStorage.decryptData(A,H,a):H}if(!R){this.performanceClient.incrementFields({skipITMigrateCount:1},a);continue}const I=wu(C.secret,ki),M=this.generateCredentialKey(C),F=this.getIdTokenCredential(M,a),O=Object.keys(I).includes("signin_state"),j=F&&Object.keys(wu(F.secret,ki)||{}).includes("signin_state");if(!F||C.lastUpdatedAt>F.lastUpdatedAt&&(O||!j)){const U=R.tenantProfiles||[],H=dE(I)||R.realm;if(H&&!U.find(X=>X.tenantId===H)){const X=$C(R.homeAccountId,R.localAccountId,H,I);U.push(X)}R.tenantProfiles=U;const K=this.generateAccountKey(Qa.getAccountInfo(R)),W=ku(I);await this.setUserData(K,JSON.stringify(R),a,R.lastUpdatedAt,W),f.includes(K)||f.push(K),await this.setUserData(M,JSON.stringify(C),a,C.lastUpdatedAt,W),this.performanceClient.incrementFields({migratedITCount:1},a),n.idToken.push(M)}}this.setTokenKeys(o,a,e),this.setTokenKeys(n,a),this.setAccountKeys(f,a)}async migrateAccessTokens(e,r,a){const o=Mc(this.clientId,this.browserStorage,e);if(o.accessToken.length===0)return;const n=Mc(this.clientId,this.browserStorage,Zs);for(const f of[...o.accessToken]){this.performanceClient.incrementFields({oldATCount:1},a);const m=await this.updateOldEntry(f,a);if(!m){wf(o.accessToken,f);continue}if(!Object.keys(r).includes(m.homeAccountId)){this.performanceClient.incrementFields({skipATMigrateCount:1},a);continue}const y=this.generateCredentialKey(m),C=r[m.homeAccountId];if(!n.accessToken.includes(y))await this.setUserData(y,JSON.stringify(m),a,m.lastUpdatedAt,C),this.performanceClient.incrementFields({migratedATCount:1},a),n.accessToken.push(y);else{const w=this.getAccessTokenCredential(y,a);(!w||m.lastUpdatedAt>w.lastUpdatedAt)&&(await this.setUserData(y,JSON.stringify(m),a,m.lastUpdatedAt,C),this.performanceClient.incrementFields({migratedATCount:1},a))}}this.setTokenKeys(o,a,e),this.setTokenKeys(n,a)}async migrateRefreshTokens(e,r,a){const o=Mc(this.clientId,this.browserStorage,e);if(o.refreshToken.length===0)return;const n=Mc(this.clientId,this.browserStorage,Zs);for(const f of[...o.refreshToken]){this.performanceClient.incrementFields({oldRTCount:1},a);const m=await this.updateOldEntry(f,a);if(!m){wf(o.refreshToken,f);continue}if(!Object.keys(r).includes(m.homeAccountId)){this.performanceClient.incrementFields({skipRTMigrateCount:1},a);continue}const y=this.generateCredentialKey(m),C=r[m.homeAccountId];if(!n.refreshToken.includes(y))await this.setUserData(y,JSON.stringify(m),a,m.lastUpdatedAt,C),this.performanceClient.incrementFields({migratedRTCount:1},a),n.refreshToken.push(y);else{const w=this.getRefreshTokenCredential(y,a);(!w||m.lastUpdatedAt>w.lastUpdatedAt)&&(await this.setUserData(y,JSON.stringify(m),a,m.lastUpdatedAt,C),this.performanceClient.incrementFields({migratedRTCount:1},a))}}this.setTokenKeys(o,a,e),this.setTokenKeys(n,a)}trackVersionChanges(e){const r=this.browserStorage.getItem(B5);r&&(this.logger.info(`MSAL.js was last initialized by version: ${r}`),this.performanceClient.addFields({previousLibraryVersion:r},e)),r!==wp&&this.setItem(B5,wp,e)}validateAndParseJson(e){if(!e)return null;try{const r=JSON.parse(e);return r&&typeof r=="object"?r:null}catch{return null}}setItem(e,r,a){const o=new Array(Zs+1).fill(0),n=[],f=20;for(let m=0;m<=f;m++)try{if(this.browserStorage.setItem(e,r),m>0)for(let y=0;y<=Zs;y++){const C=o.slice(0,y).reduce((A,R)=>A+R,0);if(C>=m)break;const w=m>C+o[y]?C+o[y]:m;m>C&&o[y]>0&&this.removeAccessTokenKeys(n.slice(C,w),a,y)}break}catch(y){const C=ET(y);if(C.errorCode===L2&&m<f){if(!n.length)for(let w=0;w<=Zs;w++)if(e===zm(this.clientId,w)){const A=JSON.parse(r).accessToken;n.push(...A),o[w]=A.length}else{const A=this.getTokenKeys(w).accessToken;n.push(...A),o[w]=A.length}if(n.length<=m)throw C;this.removeAccessToken(n[m],a,!1)}else throw C}}async setUserData(e,r,a,o,n){const f=new Array(Zs+1).fill(0),m=[],y=20;for(let C=0;C<=y;C++)try{if(await Nt(this.browserStorage.setUserData.bind(this.browserStorage),Je.SetUserData,this.logger,this.performanceClient)(e,r,a,o,n),C>0)for(let w=0;w<=Zs;w++){const A=f.slice(0,w).reduce((I,M)=>I+M,0);if(A>=C)break;const R=C>A+f[w]?A+f[w]:C;C>A&&f[w]>0&&this.removeAccessTokenKeys(m.slice(A,R),a,w)}break}catch(w){const A=ET(w);if(A.errorCode===L2&&C<y){if(!m.length)for(let R=0;R<=Zs;R++){const I=this.getTokenKeys(R).accessToken;m.push(...I),f[R]=I.length}if(m.length<=C)throw A;this.removeAccessToken(m[C],a,!1)}else throw A}}getAccount(e,r){this.logger.trace("BrowserCacheManager.getAccount called");const a=this.browserStorage.getUserData(e);if(!a)return this.removeAccountKeyFromMap(e,r),null;const o=this.validateAndParseJson(a);return!o||!Qa.isAccountEntity(o)?null:kT.toObject(new Qa,o)}async setAccount(e,r,a){this.logger.trace("BrowserCacheManager.setAccount called");const o=this.generateAccountKey(Qa.getAccountInfo(e)),n=Date.now().toString();e.lastUpdatedAt=n,await this.setUserData(o,JSON.stringify(e),r,n,a);const f=this.addAccountKeyToMap(o,r);this.performanceClient.addFields({kmsi:a},r),this.cacheConfig.cacheLocation===$s.LocalStorage&&f&&this.eventHandler.emitEvent(hr.ACCOUNT_ADDED,void 0,Qa.getAccountInfo(e))}getAccountKeys(){return Af(this.browserStorage)}setAccountKeys(e,r,a=r2){e.length===0?this.removeItem(Bm(a)):this.setItem(Bm(a),JSON.stringify(e),r)}addAccountKeyToMap(e,r){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const a=this.getAccountKeys();return a.indexOf(e)===-1?(a.push(e),this.setItem(Bm(),JSON.stringify(a),r),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,r){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const a=this.getAccountKeys(),o=a.indexOf(e);o>-1?(a.splice(o,1),this.setAccountKeys(a,r),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,r){const a=this.getActiveAccount(r);a?.homeAccountId===e.homeAccountId&&a?.environment===e.environment&&this.setActiveAccount(null,r),super.removeAccount(e,r),this.removeAccountKeyFromMap(this.generateAccountKey(e),r),this.browserStorage.getKeys().forEach(o=>{o.includes(e.homeAccountId)&&o.includes(e.environment)&&this.browserStorage.removeItem(o)}),this.cacheConfig.cacheLocation===$s.LocalStorage&&this.eventHandler.emitEvent(hr.ACCOUNT_REMOVED,void 0,e)}removeIdToken(e,r){super.removeIdToken(e,r);const a=this.getTokenKeys(),o=a.idToken.indexOf(e);o>-1&&(this.logger.info("idToken removed from tokenKeys map"),a.idToken.splice(o,1),this.setTokenKeys(a,r))}removeAccessToken(e,r,a=!0){super.removeAccessToken(e,r),a&&this.removeAccessTokenKeys([e],r)}removeAccessTokenKeys(e,r,a=Zs){this.logger.trace("removeAccessTokenKey called");const o=this.getTokenKeys(a);let n=0;if(e.forEach(f=>{const m=o.accessToken.indexOf(f);m>-1&&(o.accessToken.splice(m,1),n++)}),n>0){this.logger.info(`removed ${n} accessToken keys from tokenKeys map`),this.setTokenKeys(o,r,a);return}}removeRefreshToken(e,r){super.removeRefreshToken(e,r);const a=this.getTokenKeys(),o=a.refreshToken.indexOf(e);o>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),a.refreshToken.splice(o,1),this.setTokenKeys(a,r))}getTokenKeys(e=Zs){return Mc(this.clientId,this.browserStorage,e)}setTokenKeys(e,r,a=Zs){if(e.idToken.length===0&&e.accessToken.length===0&&e.refreshToken.length===0){this.removeItem(zm(this.clientId,a));return}else this.setItem(zm(this.clientId,a),JSON.stringify(e),r)}getIdTokenCredential(e,r){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,r),null;const o=this.validateAndParseJson(a);return!o||!hQ(o)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),o)}async setIdTokenCredential(e,r,a){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const o=this.generateCredentialKey(e),n=Date.now().toString();e.lastUpdatedAt=n,await this.setUserData(o,JSON.stringify(e),r,n,a);const f=this.getTokenKeys();f.idToken.indexOf(o)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),f.idToken.push(o),this.setTokenKeys(f,r))}getAccessTokenCredential(e,r){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],r),null;const o=this.validateAndParseJson(a);return!o||!S5(o)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),o)}async setAccessTokenCredential(e,r,a){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const o=this.generateCredentialKey(e),n=Date.now().toString();e.lastUpdatedAt=n,await this.setUserData(o,JSON.stringify(e),r,n,a);const f=this.getTokenKeys(),m=f.accessToken.indexOf(o);m!==-1&&f.accessToken.splice(m,1),this.logger.trace(`access token ${m===-1?"added to":"updated in"} map`),f.accessToken.push(o),this.setTokenKeys(f,r)}getRefreshTokenCredential(e,r){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,r),null;const o=this.validateAndParseJson(a);return!o||!w5(o)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),o)}async setRefreshTokenCredential(e,r,a){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const o=this.generateCredentialKey(e),n=Date.now().toString();e.lastUpdatedAt=n,await this.setUserData(o,JSON.stringify(e),r,n,a);const f=this.getTokenKeys();f.refreshToken.indexOf(o)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),f.refreshToken.push(o),this.setTokenKeys(f,r))}getAppMetadata(e){const r=this.browserStorage.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const a=this.validateAndParseJson(r);return!a||!yQ(e,a)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),a)}setAppMetadata(e,r){this.logger.trace("BrowserCacheManager.setAppMetadata called");const a=gQ(e);this.setItem(a,JSON.stringify(e),r)}getServerTelemetry(e){const r=this.browserStorage.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const a=this.validateAndParseJson(r);return!a||!pQ(e,a)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),a)}setServerTelemetry(e,r,a){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(r),a)}getAuthorityMetadata(e){const r=this.internalStorage.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const a=this.validateAndParseJson(r);return a&&bQ(e,a)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),a):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(r=>this.isAuthorityMetadata(r))}setWrapperMetadata(e,r){this.internalStorage.setItem(Fx.WRAPPER_SKU,e),this.internalStorage.setItem(Fx.WRAPPER_VER,r)}getWrapperMetadata(){const e=this.internalStorage.getItem(Fx.WRAPPER_SKU)||zt.EMPTY_STRING,r=this.internalStorage.getItem(Fx.WRAPPER_VER)||zt.EMPTY_STRING;return[e,r]}setAuthorityMetadata(e,r){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(r))}getActiveAccount(e){const r=this.generateCacheKey(l5.ACTIVE_ACCOUNT_FILTERS),a=this.browserStorage.getItem(r);if(!a)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const o=this.validateAndParseJson(a);return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:o.homeAccountId,localAccountId:o.localAccountId,tenantId:o.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,r){const a=this.generateCacheKey(l5.ACTIVE_ACCOUNT_FILTERS);if(e){this.logger.verbose("setActiveAccount: Active account set");const o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:nl().toString()};this.setItem(a,JSON.stringify(o),r)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(a);this.eventHandler.emitEvent(hr.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){const r=this.browserStorage.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const a=this.validateAndParseJson(r);return!a||!mQ(e,a)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),a)}setThrottlingCache(e,r,a){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(r),a)}getTemporaryCache(e,r){const a=r?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const n=this.cookieStorage.getItem(a);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}const o=this.temporaryCacheStorage.getItem(a);if(!o){if(this.cacheConfig.cacheLocation===$s.LocalStorage){const n=this.browserStorage.getItem(a);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),n}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,r,a){const o=a?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,r),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(o,r,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(r=>{(r.indexOf(ti)!==-1||r.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(r)}),this.browserStorage.getKeys().forEach(r=>{(r.indexOf(ti)!==-1||r.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(r)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(Je.ClearTokensAndKeysWithClaims,e);const r=this.getTokenKeys();let a=0;r.accessToken.forEach(o=>{const n=this.getAccessTokenCredential(o,e);n?.requestedClaimsHash&&o.includes(n.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(o,e),a++)}),a>0&&this.logger.warning(`${a} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return Sl.startsWith(e,ti)?e:`${ti}.${this.clientId}.${e}`}generateCredentialKey(e){const r=e.credentialType===Ls.REFRESH_TOKEN&&e.familyId||e.clientId,a=e.tokenType&&e.tokenType.toLowerCase()!==Lo.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return[`${ti}.${Zs}`,e.homeAccountId,e.environment,e.credentialType,r,e.realm||"",e.target||"",e.requestedClaimsHash||"",a].join(L5).toLowerCase()}generateAccountKey(e){const r=e.homeAccountId.split(".")[1];return[`${ti}.${r2}`,e.homeAccountId,e.environment,r||e.tenantId||""].join(L5).toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(cs.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(cs.VERIFIER)),this.removeTemporaryItem(this.generateCacheKey(cs.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(cs.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(cs.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,r){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const a=sb(JSON.stringify(e));if(this.setTemporaryCache(cs.REQUEST_PARAMS,a,!0),r){const o=sb(r);this.setTemporaryCache(cs.VERIFIER,o,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(cs.REQUEST_PARAMS,!0);if(!e)throw Nn(Y6);const r=this.getTemporaryCache(cs.VERIFIER,!0);let a,o="";try{a=JSON.parse(ki(e)),r&&(o=ki(r))}catch(n){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${n}`),Nn(q6)}return[a,o]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(cs.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const r=this.validateAndParseJson(e);return r||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const r=this.getInteractionInProgress()?.clientId;return e?r===this.clientId:!!r}getInteractionInProgress(){const e=`${ti}.${cs.INTERACTION_STATUS_KEY}`,r=this.getTemporaryCache(e,!1);try{return r?JSON.parse(r):null}catch{return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),vM(window),null}}setInteractionInProgress(e,r=Rf.SIGNIN){const a=`${ti}.${cs.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Nn(z6);this.setTemporaryCache(a,JSON.stringify({clientId:this.clientId,type:r}),!1)}else!e&&this.getInteractionInProgress()?.clientId===this.clientId&&this.removeTemporaryItem(a)}async hydrateCache(e,r){const a=GC(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let o;r.claims&&(o=await this.cryptoImpl.hashString(r.claims));const n=KC(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?x5(e.expiresOn):0,e.extExpiresOn?x5(e.extExpiresOn):0,ki,void 0,e.tokenType,void 0,r.sshKid,r.claims,o),f={idToken:a,accessToken:n};return this.saveCacheRecord(f,e.correlationId,ku(wu(e.idToken,ki)))}async saveCacheRecord(e,r,a,o){try{await super.saveCacheRecord(e,r,a,o)}catch(n){if(n instanceof jm&&this.performanceClient&&r)try{const f=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:f.refreshToken.length,cacheIdCount:f.idToken.length,cacheAtCount:f.accessToken.length},r)}catch{}throw n}}}function W5(t,e,r,a){try{switch(e){case $s.LocalStorage:return new kX(t,r,a);case $s.SessionStorage:return new DX;case $s.MemoryStorage:default:break}}catch(o){r.error(o)}return new nS}const RX=(t,e,r,a)=>{const o={cacheLocation:$s.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:$s.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new OT(t,o,O2,e,r,a)};function IX(t,e,r,a,o){return t.verbose("getAllAccounts called"),r?e.getAllAccounts(o||{},a):[]}function PX(t,e,r,a){const o=r.getAccountInfoFilteredBy(t,a);return o?(e.verbose("getAccount: Account matching provided filter found, returning"),o):(e.verbose("getAccount: No matching account found, returning null"),null)}function MX(t,e,r,a){if(e.trace("getAccountByUsername called"),!t)return e.warning("getAccountByUsername: No username provided"),null;const o=r.getAccountInfoFilteredBy({username:t},a);return o?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${t}`),o):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function _X(t,e,r,a){if(e.trace("getAccountByHomeId called"),!t)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const o=r.getAccountInfoFilteredBy({homeAccountId:t},a);return o?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${t}`),o):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function OX(t,e,r,a){if(e.trace("getAccountByLocalId called"),!t)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const o=r.getAccountInfoFilteredBy({localAccountId:t},a);return o?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${t}`),o):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function FX(t,e,r){e.setActiveAccount(t,r)}function NX(t,e){return t.getActiveAccount(e)}const jX="msal.broadcast.event";class LX{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Bf({}),typeof BroadcastChannel<"u"&&(this.broadcastChannel=new BroadcastChannel(jX)),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,r,a){if(typeof window<"u"){const o=a||pX();return this.eventCallbacks.has(o)?(this.logger.error(`Event callback with id: ${o} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(o,[e,r||[]]),this.logger.verbose(`Event callback registered with id: ${o}`),o)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,r,a,o){const n={eventType:e,interactionType:r||null,payload:a||null,error:o||null,timestamp:Date.now()};switch(e){case hr.ACCOUNT_ADDED:case hr.ACCOUNT_REMOVED:case hr.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel?.postMessage(n);break;default:this.invokeCallbacks(n);break}}invokeCallbacks(e){this.eventCallbacks.forEach(([r,a],o)=>{(a.length===0||a.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${o}: ${e.eventType}`),r.apply(null,[e]))})}invokeCrossTabCallbacks(e){const r=e.data;this.invokeCallbacks(r)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}class EM{constructor(e,r,a,o,n,f,m,y,C){this.config=e,this.browserStorage=r,this.browserCrypto=a,this.networkClient=this.config.system.networkClient,this.eventHandler=n,this.navigationClient=f,this.platformAuthProvider=y,this.correlationId=C||jc(),this.logger=o.clone(Vi.MSAL_SKU,wp,this.correlationId),this.performanceClient=m}async clearCacheOnLogout(e,r){if(r)try{this.browserStorage.removeAccount(r,e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const r=e||this.config.auth.redirectUri;return vo.getAbsoluteUrl(r,yd())}initializeServerTelemetryManager(e,r){this.logger.verbose("initializeServerTelemetryManager called");const a={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:r||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new ob(a,this.browserStorage)}async getDiscoveredAuthority(e){const{account:r}=e,a=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Je.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const o={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},n=e.requestAuthority||this.config.auth.authority,f=a?.length?a==="true":this.config.auth.instanceAware,m=r&&f?this.config.auth.authority.replace(vo.getDomainFromUrl(n),r.environment):n,y=ei.generateAuthority(m,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),C=await Nt(E6,Je.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(y,this.config.system.networkClient,this.browserStorage,o,this.logger,this.correlationId,this.performanceClient);if(r&&!C.isAlias(r.environment))throw Wo(t6);return C}}async function qE(t,e,r,a){r.addQueueMeasurement(Je.InitializeBaseRequest,t.correlationId);const o=t.authority||e.auth.authority,n=[...t&&t.scopes||[]],f={...t,correlationId:t.correlationId,authority:o,scopes:n};if(!f.authenticationScheme)f.authenticationScheme=Lo.BEARER,a.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(f.authenticationScheme===Lo.SSH){if(!t.sshJwk)throw Wo(UC);if(!t.sshKid)throw Wo(JP)}a.verbose(`Authentication Scheme set to "${f.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&t.claims&&!Sl.isEmptyObj(t.claims)&&(f.requestedClaimsHash=await yM(t.claims)),f}async function BX(t,e,r,a,o){a.addQueueMeasurement(Je.InitializeSilentRequest,t.correlationId);const n=await Nt(qE,Je.InitializeBaseRequest,o,a,t.correlationId)(t,r,a,o);return{...t,...n,account:e,forceRefresh:t.forceRefresh||!1}}function kM(t,e){let r;const a=t.httpMethod;if(e===Xi.EAR){if(r=a||dp.POST,r!==dp.POST)throw Wo(n6)}else r=a||dp.GET;if(t.authorizePostBodyParameters&&r!==dp.POST)throw Wo(r6);return r}class gg extends EM{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const r={correlationId:this.correlationId||jc(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const a=this.getLogoutHintFromIdTokenClaims(e.account);a&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),r.logoutHint=a)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",r.correlationId),r.postLogoutRedirectUri=vo.getAbsoluteUrl(e.postLogoutRedirectUri,yd())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",r.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",r.correlationId),r.postLogoutRedirectUri=vo.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,yd())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",r.correlationId),r.postLogoutRedirectUri=vo.getAbsoluteUrl(yd(),yd())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",r.correlationId),r}getLogoutHintFromIdTokenClaims(e){const r=e.idTokenClaims;if(r){if(r.login_hint)return r.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Je.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const r=await Nt(this.getClientConfiguration.bind(this),Je.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new I6(r,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:r,requestAuthority:a,requestAzureCloudOptions:o,requestExtraQueryParameters:n,account:f}=e;this.performanceClient.addQueueMeasurement(Je.StandardInteractionClientGetClientConfiguration,this.correlationId);const m=e.authority||await Nt(this.getDiscoveredAuthority.bind(this),Je.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:a,requestAzureCloudOptions:o,requestExtraQueryParameters:n,account:f}),y=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:m,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:y.loggerCallback,piiLoggingEnabled:y.piiLoggingEnabled,logLevel:y.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:r,libraryInfo:{sku:Vi.MSAL_SKU,version:wp,cpu:zt.EMPTY_STRING,os:zt.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,r){this.performanceClient.addQueueMeasurement(Je.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const a=this.getRedirectUri(e.redirectUri),o={interactionType:r},n=pg.setRequestState(this.browserCrypto,e&&e.state||zt.EMPTY_STRING,o),m={...await Nt(qE,Je.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:a,state:n,nonce:e.nonce||jc(),responseMode:this.config.auth.OIDCOptions.serverResponseType},y={...m,httpMethod:kM(m,this.config.auth.protocolMode)};if(e.loginHint||e.sid)return y;const C=e.account||this.browserStorage.getActiveAccount(this.correlationId);return C&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${C.homeAccountId}`,this.correlationId),y.account=C),y}}function zX(t,e){if(!e)return null;try{return pg.parseRequestState(t,e).libraryState.meta}catch{throw an(tg)}}function By(t,e,r){const a=N2(t);if(!a)throw s6(t)?(r.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${e} detected is: ${t}`),Nn(j6)):(r.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Nn(N6));return a}function UX(t,e,r){if(!t.state)throw Nn(OE);const a=zX(e,t.state);if(!a)throw Nn(L6);if(a.interactionType!==r)throw Nn(B6)}class DM{constructor(e,r,a,o,n){this.authModule=e,this.browserStorage=r,this.authCodeRequest=a,this.logger=o,this.performanceClient=n}async handleCodeResponse(e,r){this.performanceClient.addQueueMeasurement(Je.HandleCodeResponse,r.correlationId);let a;try{a=_Q(e,r.state)}catch(o){throw o instanceof Pp&&o.subError===ab?Nn(ab):o}return Nt(this.handleCodeResponseFromServer.bind(this),Je.HandleCodeResponseFromServer,this.logger,this.performanceClient,r.correlationId)(a,r)}async handleCodeResponseFromServer(e,r,a=!0){if(this.performanceClient.addQueueMeasurement(Je.HandleCodeResponseFromServer,r.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Nt(this.authModule.updateAuthority.bind(this.authModule),Je.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,r.correlationId)(e.cloud_instance_host_name,r.correlationId),a&&(e.nonce=r.nonce||void 0),e.state=r.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const n=this.createCcsCredentials(r);n&&(this.authCodeRequest.ccsCredential=n)}return await Nt(this.authModule.acquireToken.bind(this.authModule),Je.AuthClientAcquireToken,this.logger,this.performanceClient,r.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Oc.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Oc.UPN}:null}}const $X="ContentError",HX="PageException",RM="user_switch";const WX="USER_INTERACTION_REQUIRED",VX="USER_CANCEL",GX="NO_NETWORK",KX="DISABLED",YX="ACCOUNT_UNAVAILABLE",qX="UX_NOT_ALLOWED";const QX=-2147186943,XX={[RM]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Su extends Vo{constructor(e,r,a){super(e,r),Object.setPrototypeOf(this,Su.prototype),this.name="NativeAuthError",this.ext=a}}function Rm(t){if(t.ext&&t.ext.status&&t.ext.status===KX||t.ext&&t.ext.error&&t.ext.error===QX)return!0;switch(t.errorCode){case $X:case HX:return!0;default:return!1}}function Y2(t,e,r){if(r&&r.status)switch(r.status){case YX:return W2(k6);case WX:return new Nc(t,e);case VX:return Nn(ab);case GX:return Nn(V2);case qX:return W2(kE)}return new Su(t,XX[t]||e,r)}class IM extends gg{async acquireToken(e){this.performanceClient.addQueueMeasurement(Je.SilentCacheClientAcquireToken,e.correlationId);const r=this.initializeServerTelemetryManager(Po.acquireTokenSilent_silentFlow),a=await Nt(this.getClientConfiguration.bind(this),Je.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),o=new IQ(a,this.performanceClient);this.logger.verbose("Silent auth client created");try{const f=(await Nt(o.acquireCachedToken.bind(o),Je.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),f}catch(n){throw n instanceof kb&&n.errorCode===FE&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),n}}logout(e){this.logger.verbose("logoutRedirect called");const r=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(r.correlationId,r?.account)}}class a2 extends EM{constructor(e,r,a,o,n,f,m,y,C,w,A,R){super(e,r,a,o,n,f,y,C,R),this.apiId=m,this.accountId=w,this.platformAuthProvider=C,this.nativeStorageManager=A,this.silentCacheClient=new IM(e,this.nativeStorageManager,a,o,n,f,y,C,R);const I=this.platformAuthProvider.getExtensionName();this.skus=ob.makeExtraSkuString({libraryName:Vi.MSAL_SKU,libraryVersion:wp,extensionName:I,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[Gq]:this.skus}}async acquireToken(e,r){this.performanceClient.addQueueMeasurement(Je.NativeInteractionClientAcquireToken,this.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const a=this.performanceClient.startMeasurement(Je.NativeInteractionClientAcquireToken,this.correlationId),o=nl(),n=this.initializeServerTelemetryManager(this.apiId);try{const f=await this.initializeNativeRequest(e);try{const y=await this.acquireTokensFromCache(this.accountId,f);return a.end({success:!0,isNativeBroker:!1,fromCache:!0}),y}catch(y){if(r===wi.AccessToken)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),a.end({success:!1,brokerErrorCode:"cache_request_failed"}),y;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const m=await this.platformAuthProvider.sendMessage(f);return await this.handleNativeResponse(m,f,o).then(y=>(a.end({success:!0,isNativeBroker:!0,requestId:y.requestId}),n.clearNativeBrokerErrorCode(),y)).catch(y=>{throw a.end({success:!1,errorCode:y.errorCode,subErrorCode:y.subError}),y})}catch(f){throw f instanceof Su&&n.setNativeBrokerErrorCode(f.errorCode),a.end({success:!1}),f}}createSilentCacheRequest(e,r){return{authority:e.authority,correlationId:this.correlationId,scopes:ys.fromString(e.scope).asArray(),account:r,forceRefresh:!1}}async acquireTokensFromCache(e,r){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),an(TT);const a=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!a)throw an(TT);try{const o=this.createSilentCacheRequest(r,a),n=await this.silentCacheClient.acquireToken(o),f={...a,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:f}}catch(o){throw o}}async acquireTokenRedirect(e,r){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...a}=e;delete a.onRedirectNavigate;const o=await this.initializeNativeRequest(a);try{await this.platformAuthProvider.sendMessage(o)}catch(m){if(m instanceof Su&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(m.errorCode),Rm(m)))throw m}this.browserStorage.setTemporaryCache(cs.NATIVE_REQUEST,JSON.stringify(o),!0);const n={apiId:Po.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},f=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);r.end({success:!0}),await this.navigationClient.navigateExternal(f,n)}async handleRedirectPromise(e,r){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const a=this.browserStorage.getCachedNativeRequest();if(!a)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&r&&e?.addFields({errorCode:"no_cached_request"},r),null;const{prompt:o,...n}=a;o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(cs.NATIVE_REQUEST));const f=nl();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const m=await this.platformAuthProvider.sendMessage(n),y=await this.handleNativeResponse(m,n,f);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),e&&this.correlationId&&this.performanceClient.addFields({isNativeBroker:!0},this.correlationId),y}catch(m){throw m}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,r,a){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const o=wu(e.id_token,ki),n=this.createHomeAccountIdentifier(e,o),f=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:r.accountId},this.correlationId)?.homeAccountId;if(r.extraParameters?.child_client_id&&e.account.id!==r.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(n!==f&&e.account.id!==r.accountId)throw Y2(RM);const m=await this.getDiscoveredAuthority({requestAuthority:r.authority}),y=DE(this.browserStorage,m,n,ki,this.correlationId,o,e.client_info,void 0,o.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const C=await this.generateAuthenticationResult(e,r,o,y,m.canonicalAuthority,a);return await this.cacheAccount(y,this.correlationId,ku(o)),await this.cacheNativeTokens(e,r,n,o,e.access_token,C.tenantId,a),C}createHomeAccountIdentifier(e,r){return Qa.generateHomeAccountId(e.client_info||zt.EMPTY_STRING,_c.Default,this.logger,this.browserCrypto,r)}generateScopes(e,r){return r?ys.fromString(r):ys.fromString(e)}async generatePopAccessToken(e,r){if(r.tokenType===Lo.POP&&r.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const a=new ng(this.browserCrypto),o={resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,shrNonce:r.shrNonce};if(!r.keyId)throw an(nE);return a.signPopToken(e.access_token,r.keyId,o)}else return e.access_token}async generateAuthenticationResult(e,r,a,o,n,f){const m=this.addTelemetryFromNativeResponse(e.properties.MATS),y=this.generateScopes(r.scope,e.scope),C=e.account.properties||{},w=C.UID||a.oid||a.sub||zt.EMPTY_STRING,A=C.TenantId||a.tid||zt.EMPTY_STRING,R=uE(Qa.getAccountInfo(o),void 0,a,e.id_token);R.nativeAccountId!==e.account.id&&(R.nativeAccountId=e.account.id);const I=await this.generatePopAccessToken(e,r),M=r.tokenType===Lo.POP?Lo.POP:Lo.BEARER;return{authority:n,uniqueId:w,tenantId:A,scopes:y.asArray(),account:R,idToken:e.id_token,idTokenClaims:a,accessToken:I,fromCache:m?this.isResponseFromCache(m):!1,expiresOn:Lm(f+e.expires_in),tokenType:M,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,r,a){await this.browserStorage.setAccount(e,this.correlationId,a),this.browserStorage.removeAccountContext(Qa.getAccountInfo(e),r)}cacheNativeTokens(e,r,a,o,n,f,m){const y=GC(a,r.authority,e.id_token||"",r.clientId,o.tid||""),C=r.tokenType===Lo.POP?zt.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,w=m+C,A=this.generateScopes(e.scope,r.scope),R=KC(a,r.authority,n,r.clientId,o.tid||f,A.printScopes(),w,0,ki,void 0,r.tokenType,void 0,r.keyId),I={idToken:y,accessToken:R};return this.nativeStorageManager.saveCacheRecord(I,this.correlationId,ku(o),r.storeInCache)}getExpiresInValue(e,r){return e===Lo.POP?zt.SHR_NONCE_VALIDITY:(typeof r=="string"?parseInt(r,10):r)||0}addTelemetryFromNativeResponse(e){const r=this.getMATSFromResponse(e);return r?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:r.broker_version,matsAccountJoinOnStart:r.account_join_on_start,matsAccountJoinOnEnd:r.account_join_on_end,matsDeviceJoin:r.device_join,matsPromptBehavior:r.prompt_behavior,matsApiErrorCode:r.api_error_code,matsUiVisible:r.ui_visible,matsSilentCode:r.silent_code,matsSilentBiSubCode:r.silent_bi_sub_code,matsSilentMessage:r.silent_message,matsSilentStatus:r.silent_status,matsHttpStatus:r.http_status,matsHttpEventCount:r.http_event_count},this.correlationId),r):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const r=await this.getCanonicalAuthority(e),{scopes:a,...o}=e,n=new ys(a||[]);n.appendScopes(hg);const f={...o,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:n.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(f.signPopToken&&e.popKid)throw Nn(iM);if(this.handleExtraBrokerParams(f),f.extraParameters=f.extraParameters||{},f.extraParameters.telemetry=Yl.MATS_TELEMETRY,e.authenticationScheme===Lo.POP){const m={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},y=new ng(this.browserCrypto);let C;if(f.keyId)C=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:f.keyId})),f.signPopToken=!1;else{const w=await Nt(y.generateCnf.bind(y),Je.PopTokenGenerateCnf,this.logger,this.performanceClient,this.correlationId)(m,this.logger);C=w.reqCnfString,f.keyId=w.kid,f.signPopToken=!0}f.reqCnf=C}return this.addRequestSKUs(f),f}async getCanonicalAuthority(e){const r=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:r,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const a=new vo(r);return a.validateAsUri(),a}getPrompt(e){switch(this.apiId){case Po.ssoSilent:case Po.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Us.NONE}if(!e){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e){case Us.NONE:case Us.CONSENT:case Us.LOGIN:case Us.SELECT_ACCOUNT:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e} is not compatible with native flow`),Nn(aM)}}handleExtraBrokerParams(e){const r=e.extraParameters&&e.extraParameters.hasOwnProperty(B2)&&e.extraParameters.hasOwnProperty(z2)&&e.extraParameters.hasOwnProperty(Cp);if(!e.embeddedClientId&&!r)return;let a="";const o=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,a=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[z2],a=e.extraParameters[Cp]),e.extraParameters={child_client_id:a,child_redirect_uri:o},this.performanceClient?.addFields({embeddedClientId:a,embeddedRedirectUri:o},this.correlationId)}}async function QE(t,e,r,a,o){const n=MQ({...t.auth,authority:e},r,a,o);if(xE(n,{sku:Vi.MSAL_SKU,version:wp,os:"",cpu:""}),t.auth.protocolMode!==Xi.OIDC&&CE(n,t.telemetry.application),r.platformBroker&&(Qq(n),o.addFields({isPlatformAuthorizeRequest:!0},r.correlationId),r.authenticationScheme===Lo.POP)){const f=new Ad(a,o),m=new ng(f);let y;r.popKid?y=f.encodeKid(r.popKid):y=(await Nt(m.generateCnf.bind(m),Je.PopTokenGenerateCnf,a,o,r.correlationId)(r,a)).reqCnfString,TE(n,y)}return HC(n,r.correlationId,o),n}async function XE(t,e,r,a,o){if(!r.codeChallenge)throw Wo(iE);const n=await Nt(QE,Je.GetStandardParams,a,o,r.correlationId)(t,e,r,a,o);return pE(n,qA.CODE),SE(n,r.codeChallenge,zt.S256_CODE_CHALLENGE_METHOD),Ff(n,r.extraQueryParameters||{}),RE(e,n,t.auth.encodeExtraQueryParams,r.extraQueryParameters)}async function JE(t,e,r,a,o,n){if(!a.earJwk)throw Nn(_E);const f=await QE(e,r,a,o,n);pE(f,qA.IDTOKEN_TOKEN_REFRESHTOKEN),iQ(f,a.earJwk),SE(f,a.codeChallenge,zt.S256_CODE_CHALLENGE_METHOD);const m=new Map;Ff(m,a.extraQueryParameters||{});const y=RE(r,m,e.auth.encodeExtraQueryParams,a.extraQueryParameters);return PM(t,y,f)}async function ZE(t,e,r,a,o,n){const f=await QE(e,r,a,o,n);pE(f,qA.CODE),SE(f,a.codeChallenge,a.codeChallengeMethod||zt.S256_CODE_CHALLENGE_METHOD),lQ(f,a.authorizePostBodyParameters||{});const m=new Map;Ff(m,a.extraQueryParameters||{});const y=RE(r,m,e.auth.encodeExtraQueryParams,a.extraQueryParameters);return PM(t,y,f)}function PM(t,e,r){const a=t.createElement("form");return a.method="post",a.action=e,r.forEach((o,n)=>{const f=t.createElement("input");f.hidden=!0,f.name=n,f.value=o,a.appendChild(f)}),t.body.appendChild(a),a}async function MM(t,e,r,a,o,n,f,m,y,C){if(m.verbose("Account id found, calling WAM for token"),!C)throw Nn(jE);const w=new Ad(m,y),A=new a2(a,o,w,m,f,a.system.navigationClient,r,y,C,e,n,t.correlationId),{userRequestState:R}=pg.parseRequestState(w,t.state);return Nt(A.acquireToken.bind(A),Je.NativeInteractionClientAcquireToken,m,y,t.correlationId)({...t,state:R,prompt:void 0})}async function Um(t,e,r,a,o,n,f,m,y,C,w,A){if(Cu.removeThrottle(f,o.auth.clientId,t),e.accountId)return Nt(MM,Je.HandleResponsePlatformBroker,C,w,t.correlationId)(t,e.accountId,a,o,f,m,y,C,w,A);const R={...t,code:e.code||"",codeVerifier:r},I=new DM(n,f,R,C,w);return await Nt(I.handleCodeResponse.bind(I),Je.HandleCodeResponse,C,w,t.correlationId)(e,t)}async function ek(t,e,r,a,o,n,f,m,y,C,w){if(Cu.removeThrottle(n,a.auth.clientId,t),P6(e,t.state),!e.ear_jwe)throw Nn(F6);if(!t.earJwk)throw Nn(_E);const A=JSON.parse(await Nt(sX,Je.DecryptEarResponse,y,C,t.correlationId)(t.earJwk,e.ear_jwe));if(A.accountId)return Nt(MM,Je.HandleResponsePlatformBroker,y,C,t.correlationId)(t,A.accountId,r,a,n,f,m,y,C,w);const R=new Sp(a.auth.clientId,n,new Ad(y,C),y,null,null,C);R.validateTokenResponse(A);const I={code:"",state:t.state,nonce:t.nonce,client_info:A.client_info,cloud_graph_host_name:A.cloud_graph_host_name,cloud_instance_host_name:A.cloud_instance_host_name,cloud_instance_name:A.cloud_instance_name,msgraph_host:A.msgraph_host};return await Nt(R.handleServerTokenResponse.bind(R),Je.HandleServerTokenResponse,y,C,t.correlationId)(A,o,nl(),t,I,void 0,void 0,void 0,void 0)}const JX=32;async function Ap(t,e,r){t.addQueueMeasurement(Je.GeneratePkceCodes,r);const a=wl(ZX,Je.GenerateCodeVerifier,e,t,r)(t,e,r),o=await Nt(eJ,Je.GenerateCodeChallengeFromVerifier,e,t,r)(a,t,e,r);return{verifier:a,challenge:o}}function ZX(t,e,r){try{const a=new Uint8Array(JX);return wl(tX,Je.GetRandomValues,e,t,r)(a),zf(a)}catch{throw Nn(ME)}}async function eJ(t,e,r,a){e.addQueueMeasurement(Je.GenerateCodeChallengeFromVerifier,a);try{const o=await Nt(pM,Je.Sha256Digest,r,e,a)(t,e,a);return zf(new Uint8Array(o))}catch{throw Nn(ME)}}class q2{constructor(e,r,a,o){this.logger=e,this.handshakeTimeoutMs=r,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=a,this.handshakeEvent=a.startMeasurement(Je.NativeMessageHandlerHandshake),this.platformAuthType=Yl.PLATFORM_EXTENSION_PROVIDER}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const r={method:by.GetToken,request:e},a={channel:Yl.CHANNEL_ID,extensionId:this.extensionId,responseId:jc(),body:r};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+` - Sending request to browser extension: ${JSON.stringify(a)}`),this.messageChannel.port1.postMessage(a);const o=await new Promise((f,m)=>{this.resolvers.set(a.responseId,{resolve:f,reject:m})});return this.validatePlatformBrokerResponse(o)}static async createProvider(e,r,a){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const o=new q2(e,r,a,Yl.PREFERRED_EXTENSION_ID);return await o.sendHandshakeRequest(),o}catch{const n=new q2(e,r,a);return await n.sendHandshakeRequest(),n}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Yl.CHANNEL_ID,extensionId:this.extensionId,responseId:jc(),body:{method:by.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=r=>{this.onChannelMessage(r)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((r,a)=>{this.handshakeResolvers.set(e.responseId,{resolve:r,reject:a}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),a(Nn(rM)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const r=e.data;if(!(!r.channel||r.channel!==Yl.CHANNEL_ID)&&!(r.extensionId&&r.extensionId!==this.extensionId)&&r.body.method===by.HandshakeRequest){const a=this.handshakeResolvers.get(r.responseId);if(!a){this.logger.trace(this.platformAuthType+`.onWindowMessage - resolver can't be found for request ${r.responseId}`);return}this.logger.verbose(r.extensionId?`Extension with id: ${r.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),a.reject(Nn(oM))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const r=e.data,a=this.resolvers.get(r.responseId),o=this.handshakeResolvers.get(r.responseId);try{const n=r.body.method;if(n===by.Response){if(!a)return;const f=r.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+` - Received response from browser extension: ${JSON.stringify(f)}`),f.status!=="Success")a.reject(Y2(f.code,f.description,f.ext));else if(f.result)f.result.code&&f.result.description?a.reject(Y2(f.result.code,f.result.description,f.result.ext)):a.resolve(f.result);else throw CT(_2,"Event does not contain result.");this.resolvers.delete(r.responseId)}else if(n===by.HandshakeResponse){if(!o){this.logger.trace(this.platformAuthType+`.onChannelMessage - resolver can't be found for request ${r.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=r.extensionId,this.extensionVersion=r.body.version,this.logger.verbose(this.platformAuthType+` - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(r.responseId)}}catch(n){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${n}`),this.logger.errorPii(`Unable to parse ${e}`),a?a.reject(n):o&&o.reject(n)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw CT(_2,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){return this.getExtensionId()===Yl.PREFERRED_EXTENSION_ID?"chrome":this.getExtensionId()?.length?"unknown":void 0}}class tk{constructor(e,r,a){this.logger=e,this.performanceClient=r,this.correlationId=a,this.platformAuthType=Yl.PLATFORM_DOM_PROVIDER}static async createProvider(e,r,a){if(e.trace("PlatformAuthDOMHandler: createProvider called"),window.navigator?.platformAuthentication&&(await window.navigator.platformAuthentication.getSupportedContracts(Yl.MICROSOFT_ENTRA_BROKERID))?.includes(Yl.PLATFORM_DOM_APIS))return e.trace("Platform auth api available in DOM"),new tk(e,r,a)}getExtensionId(){return Yl.MICROSOFT_ENTRA_BROKERID}getExtensionVersion(){return""}getExtensionName(){return Yl.DOM_API_NAME}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const r=this.initializePlatformDOMRequest(e),a=await window.navigator.platformAuthentication.executeGetToken(r);return this.validatePlatformBrokerResponse(a)}catch(r){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),r}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:r,clientId:a,authority:o,scope:n,redirectUri:f,correlationId:m,state:y,storeInCache:C,embeddedClientId:w,extraParameters:A,...R}=e,I=this.getDOMExtraParams(R);return{accountId:r,brokerId:this.getExtensionId(),authority:o,clientId:a,correlationId:m||this.correlationId,extraParameters:{...A,...I},isSecurityTokenService:!1,redirectUri:f,scope:n,state:y,storeInCache:C,embeddedClientId:w}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const r=e;if(r.isSuccess===!1&&r.error&&r.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),Y2(r.error.code,r.error.description,{error:parseInt(r.error.errorCode),protocol_error:r.error.protocolError,status:r.error.status,properties:r.error.properties})}}throw CT(_2,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){return this.logger.trace(this.platformAuthType+" - convertToNativeResponse called"),{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:e.extendedLifetimeToken??!1,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return{...Object.entries(e).reduce((o,[n,f])=>(o[n]=String(f),o),{})}}}async function tJ(t,e,r,a,o){t.trace("getPlatformAuthProvider called",r),t.trace("Has client allowed platform auth via DOM API: "+o);let n;try{o&&(n=await tk.createProvider(t,e,r)),n||(t.trace("Platform auth via DOM API not available, checking for extension"),n=await q2.createProvider(t,a||wM,e))}catch(f){t.trace("Platform auth not available",f)}return n}function ib(t,e,r,a){if(e.trace("isPlatformAuthAllowed called"),!t.system.allowPlatformBroker&&t.system.allowPlatformBrokerWithDOM)throw Wo(o6);if(!t.system.allowPlatformBroker)return e.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return e.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(a)switch(a){case Lo.BEARER:case Lo.POP:return e.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return e.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}class nJ extends gg{constructor(e,r,a,o,n,f,m,y,C,w){super(e,r,a,o,n,f,m,C,w),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=y,this.eventHandler=n}acquireToken(e,r){let a;try{if(a={popupName:this.generatePopupName(e.scopes||hg,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,a,r);{const n={...e,httpMethod:kM(e,this.config.auth.protocolMode)};return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),a.popup=this.openSizedPopup("about:blank",a),this.acquireTokenPopupAsync(n,a,r)}}catch(o){return Promise.reject(o)}}logout(e){try{this.logger.verbose("logoutPopup called");const r=this.initializeLogoutRequest(e),a={popupName:this.generateLogoutPopupName(r),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},o=e&&e.authority,n=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(r,a,o,n)):(this.logger.verbose("asyncPopup set to false, opening popup"),a.popup=this.openSizedPopup("about:blank",a),this.logoutPopupAsync(r,a,o,n))}catch(r){return Promise.reject(r)}}async acquireTokenPopupAsync(e,r,a){this.logger.verbose("acquireTokenPopupAsync called");const o=await Nt(this.initializeAuthorizationRequest.bind(this),Je.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,br.Popup);r.popup&&SM(o.authority);const n=ib(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);return o.platformBroker=n,this.config.auth.protocolMode===Xi.EAR?this.executeEarFlow(o,r,a):this.executeCodeFlow(o,r,a)}async executeCodeFlow(e,r,a){const o=e.correlationId,n=this.initializeServerTelemetryManager(Po.acquireTokenPopup),f=a||await Nt(Ap,Je.GeneratePkceCodes,this.logger,this.performanceClient,o)(this.performanceClient,this.logger,o),m={...e,codeChallenge:f.challenge};try{const y=await Nt(this.createAuthCodeClient.bind(this),Je.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,o)({serverTelemetryManager:n,requestAuthority:m.authority,requestAzureCloudOptions:m.azureCloudOptions,requestExtraQueryParameters:m.extraQueryParameters,account:m.account});if(m.httpMethod===dp.POST)return await this.executeCodeFlowWithPost(m,r,y,f.verifier);{const C=await Nt(XE,Je.GetAuthCodeUrl,this.logger,this.performanceClient,o)(this.config,y.authority,m,this.logger,this.performanceClient),w=this.initiateAuthRequest(C,r);this.eventHandler.emitEvent(hr.POPUP_OPENED,br.Popup,{popupWindow:w},null);const A=await this.monitorPopupForHash(w,r.popupWindowParent),R=wl(By,Je.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(A,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await Nt(Um,Je.HandleResponseCode,this.logger,this.performanceClient,o)(e,R,f.verifier,Po.acquireTokenPopup,this.config,y,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}catch(y){throw r.popup?.close(),y instanceof Vo&&(y.setCorrelationId(this.correlationId),n.cacheFailedRequest(y)),y}}async executeEarFlow(e,r,a){const o=e.correlationId,n=await Nt(this.getDiscoveredAuthority.bind(this),Je.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,o)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),f=await Nt($E,Je.GenerateEarKey,this.logger,this.performanceClient,o)(),m=a||await Nt(Ap,Je.GeneratePkceCodes,this.logger,this.performanceClient,o)(this.performanceClient,this.logger,o),y={...e,earJwk:f,codeChallenge:m.challenge},C=r.popup||this.openPopup("about:blank",r);(await JE(C.document,this.config,n,y,this.logger,this.performanceClient)).submit();const A=await Nt(this.monitorPopupForHash.bind(this),Je.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,o)(C,r.popupWindowParent),R=wl(By,Je.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(A,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(!R.ear_jwe&&R.code){const I=await Nt(this.createAuthCodeClient.bind(this),Je.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,o)({serverTelemetryManager:this.initializeServerTelemetryManager(Po.acquireTokenPopup),requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account,authority:n});return Nt(Um,Je.HandleResponseCode,this.logger,this.performanceClient,o)(y,R,m.verifier,Po.acquireTokenPopup,this.config,I,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}else return Nt(ek,Je.HandleResponseEar,this.logger,this.performanceClient,o)(y,R,Po.acquireTokenPopup,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async executeCodeFlowWithPost(e,r,a,o){const n=e.correlationId,f=await Nt(this.getDiscoveredAuthority.bind(this),Je.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,n)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),m=r.popup||this.openPopup("about:blank",r);(await ZE(m.document,this.config,f,e,this.logger,this.performanceClient)).submit();const C=await Nt(this.monitorPopupForHash.bind(this),Je.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(m,r.popupWindowParent),w=wl(By,Je.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(C,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Nt(Um,Je.HandleResponseCode,this.logger,this.performanceClient,n)(e,w,o,Po.acquireTokenPopup,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(e,r,a,o){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(hr.LOGOUT_START,br.Popup,e);const n=this.initializeServerTelemetryManager(Po.logoutPopup);try{await this.clearCacheOnLogout(this.correlationId,e.account);const f=await Nt(this.createAuthCodeClient.bind(this),Je.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:a,account:e.account||void 0});try{f.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&f.authority.protocolMode===Xi.OIDC){if(this.eventHandler.emitEvent(hr.LOGOUT_SUCCESS,br.Popup,e),o){const C={apiId:Po.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},w=vo.getAbsoluteUrl(o,yd());await this.navigationClient.navigateInternal(w,C)}r.popup?.close();return}}const m=f.getLogoutUri(e);this.eventHandler.emitEvent(hr.LOGOUT_SUCCESS,br.Popup,e);const y=this.openPopup(m,r);if(this.eventHandler.emitEvent(hr.POPUP_OPENED,br.Popup,{popupWindow:y},null),await this.monitorPopupForHash(y,r.popupWindowParent).catch(()=>{}),o){const C={apiId:Po.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},w=vo.getAbsoluteUrl(o,yd());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${w}`),await this.navigationClient.navigateInternal(w,C)}else this.logger.verbose("No main window navigation requested")}catch(f){throw r.popup?.close(),f instanceof Vo&&(f.setCorrelationId(this.correlationId),n.cacheFailedRequest(f)),this.eventHandler.emitEvent(hr.LOGOUT_FAILURE,br.Popup,null,f),this.eventHandler.emitEvent(hr.LOGOUT_END,br.Popup),f}this.eventHandler.emitEvent(hr.LOGOUT_END,br.Popup)}initiateAuthRequest(e,r){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,r);throw this.logger.error("Navigate url is empty"),Nn(JC)}monitorPopupForHash(e,r){return new Promise((a,o)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),o(Nn(ab));return}let f="";try{f=e.location.href}catch{}if(!f||f==="about:blank")return;clearInterval(n);let m="";const y=this.config.auth.OIDCOptions.serverResponseType;e&&(y===zC.QUERY?m=e.location.search:m=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),a(m)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,r)})}openPopup(e,r){try{let a;if(r.popup?(a=r.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),a.location.assign(e)):typeof r.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),a=this.openSizedPopup(e,r)),!a)throw Nn($6);return a.focus&&a.focus(),this.currentWindow=a,r.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),a}catch(a){throw this.logger.error("error opening popup "+a.message),Nn(U6)}}openSizedPopup(e,{popupName:r,popupWindowAttributes:a,popupWindowParent:o}){const n=o.screenLeft?o.screenLeft:o.screenX,f=o.screenTop?o.screenTop:o.screenY,m=o.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,y=o.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let C=a.popupSize?.width,w=a.popupSize?.height,A=a.popupPosition?.top,R=a.popupPosition?.left;return(!C||C<0||C>m)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),C=Vi.POPUP_WIDTH),(!w||w<0||w>y)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),w=Vi.POPUP_HEIGHT),(!A||A<0||A>y)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),A=Math.max(0,y/2-Vi.POPUP_HEIGHT/2+f)),(!R||R<0||R>m)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),R=Math.max(0,m/2-Vi.POPUP_WIDTH/2+n)),o.open(e,r,`width=${C}, height=${w}, top=${A}, left=${R}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,r){e.close(),r.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,r){return`${Vi.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${r}.${this.correlationId}`}generateLogoutPopupName(e){const r=e.account&&e.account.homeAccountId;return`${Vi.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${r}.${this.correlationId}`}}function rJ(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const t=window.performance.getEntriesByType("navigation");return(t.length?t[0]:void 0)?.type}class oJ extends gg{constructor(e,r,a,o,n,f,m,y,C,w){super(e,r,a,o,n,f,m,C,w),this.nativeStorage=y}async acquireToken(e){const r=await Nt(this.initializeAuthorizationRequest.bind(this),Je.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,br.Redirect);r.platformBroker=ib(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);const a=n=>{n.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent(hr.RESTORE_FROM_BFCACHE,br.Redirect))},o=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${o}`),this.browserStorage.setTemporaryCache(cs.ORIGIN_URI,o,!0),window.addEventListener("pageshow",a);try{this.config.auth.protocolMode===Xi.EAR?await this.executeEarFlow(r):await this.executeCodeFlow(r,e.onRedirectNavigate)}catch(n){throw n instanceof Vo&&n.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",a),n}}async executeCodeFlow(e,r){const a=e.correlationId,o=this.initializeServerTelemetryManager(Po.acquireTokenRedirect),n=await Nt(Ap,Je.GeneratePkceCodes,this.logger,this.performanceClient,a)(this.performanceClient,this.logger,a),f={...e,codeChallenge:n.challenge};this.browserStorage.cacheAuthorizeRequest(f,n.verifier);try{if(f.httpMethod===dp.POST)return await this.executeCodeFlowWithPost(f);{const m=await Nt(this.createAuthCodeClient.bind(this),Je.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:f.authority,requestAzureCloudOptions:f.azureCloudOptions,requestExtraQueryParameters:f.extraQueryParameters,account:f.account}),y=await Nt(XE,Je.GetAuthCodeUrl,this.logger,this.performanceClient,e.correlationId)(this.config,m.authority,f,this.logger,this.performanceClient);return await this.initiateAuthRequest(y,r)}}catch(m){throw m instanceof Vo&&(m.setCorrelationId(this.correlationId),o.cacheFailedRequest(m)),m}}async executeEarFlow(e){const r=e.correlationId,a=await Nt(this.getDiscoveredAuthority.bind(this),Je.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await Nt($E,Je.GenerateEarKey,this.logger,this.performanceClient,r)(),n=await Nt(Ap,Je.GeneratePkceCodes,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),f={...e,earJwk:o,codeChallenge:n.challenge};return this.browserStorage.cacheAuthorizeRequest(f,n.verifier),(await JE(document,this.config,a,f,this.logger,this.performanceClient)).submit(),new Promise((y,C)=>{setTimeout(()=>{C(Nn(G2,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async executeCodeFlowWithPost(e){const r=e.correlationId,a=await Nt(this.getDiscoveredAuthority.bind(this),Je.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return this.browserStorage.cacheAuthorizeRequest(e),(await ZE(document,this.config,a,e,this.logger,this.performanceClient)).submit(),new Promise((n,f)=>{setTimeout(()=>{f(Nn(G2,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(e="",r,a,o){const n=this.initializeServerTelemetryManager(Po.handleRedirectPromise);try{const[f,m]=this.getRedirectResponse(e||"");if(!f)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),rJ()!=="back_forward"?o.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const y=this.browserStorage.getTemporaryCache(cs.ORIGIN_URI,!0)||zt.EMPTY_STRING,C=p5(y),w=p5(window.location.href);if(C===w&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),y.indexOf("#")>-1&&lX(y),await this.handleResponse(f,r,a,n);if(this.config.auth.navigateToLoginRequestUrl){if(!GE()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(cs.URL_HASH,m,!0);const A={apiId:Po.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let R=!0;if(!y||y==="null"){const I=uX();this.browserStorage.setTemporaryCache(cs.ORIGIN_URI,I,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),R=await this.navigationClient.navigateInternal(I,A)}else this.logger.verbose(`Navigating to loginRequestUrl: ${y}`),R=await this.navigationClient.navigateInternal(y,A);if(!R)return await this.handleResponse(f,r,a,n)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(f,r,a,n);return null}catch(f){throw f instanceof Vo&&(f.setCorrelationId(this.correlationId),n.cacheFailedRequest(f)),f}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let r=e;r||(this.config.auth.OIDCOptions.serverResponseType===zC.QUERY?r=window.location.search:r=window.location.hash);let a=N2(r);if(a){try{UX(a,this.browserCrypto,br.Redirect)}catch(n){return n instanceof Vo&&this.logger.error(`Interaction type validation failed due to ${n.errorCode}: ${n.errorMessage}`),[null,""]}return vM(window),this.logger.verbose("Hash contains known properties, returning response hash"),[a,r]}const o=this.browserStorage.getTemporaryCache(cs.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(cs.URL_HASH)),o&&(a=N2(o),a)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[a,o]):[null,""]}async handleResponse(e,r,a,o){if(!e.state)throw Nn(OE);if(e.ear_jwe){const m=await Nt(this.getDiscoveredAuthority.bind(this),Je.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,r.correlationId)({requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account});return Nt(ek,Je.HandleResponseEar,this.logger,this.performanceClient,r.correlationId)(r,e,Po.acquireTokenRedirect,this.config,m,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const f=await Nt(this.createAuthCodeClient.bind(this),Je.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r.authority});return Nt(Um,Je.HandleResponseCode,this.logger,this.performanceClient,r.correlationId)(r,e,a,Po.acquireTokenRedirect,this.config,f,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,r){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const a={apiId:Po.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=r||this.config.auth.onRedirectNavigate;if(typeof o=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),o(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await this.navigationClient.navigateExternal(e,a);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await this.navigationClient.navigateExternal(e,a);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Nn(JC)}async logout(e){this.logger.verbose("logoutRedirect called");const r=this.initializeLogoutRequest(e),a=this.initializeServerTelemetryManager(Po.logout);try{this.eventHandler.emitEvent(hr.LOGOUT_START,br.Redirect,e),await this.clearCacheOnLogout(this.correlationId,r.account);const o={apiId:Po.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},n=await Nt(this.createAuthCodeClient.bind(this),Je.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:a,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(n.authority.protocolMode===Xi.OIDC)try{n.authority.endSessionEndpoint}catch{if(r.account?.homeAccountId){this.eventHandler.emitEvent(hr.LOGOUT_SUCCESS,br.Redirect,r);return}}const f=n.getLogoutUri(r);if(this.eventHandler.emitEvent(hr.LOGOUT_SUCCESS,br.Redirect,r),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(f)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Rf.SIGNOUT),await this.navigationClient.navigateExternal(f,o);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Rf.SIGNOUT),await this.navigationClient.navigateExternal(f,o);return}}catch(o){throw o instanceof Vo&&(o.setCorrelationId(this.correlationId),a.cacheFailedRequest(o)),this.eventHandler.emitEvent(hr.LOGOUT_FAILURE,br.Redirect,null,o),this.eventHandler.emitEvent(hr.LOGOUT_END,br.Redirect),o}this.eventHandler.emitEvent(hr.LOGOUT_END,br.Redirect)}getRedirectStartPage(e){const r=e||window.location.href;return vo.getAbsoluteUrl(r,yd())}}async function aJ(t,e,r,a,o){if(e.addQueueMeasurement(Je.SilentHandlerInitiateAuthRequest,a),!t)throw r.info("Navigate url is empty"),Nn(JC);return o?Nt(lJ,Je.SilentHandlerLoadFrame,r,e,a)(t,o,e,a):wl(cJ,Je.SilentHandlerLoadFrameSync,r,e,a)(t)}async function sJ(t,e,r,a,o){const n=rS();if(!n.contentDocument)throw"No document associated with iframe!";return(await ZE(n.contentDocument,t,e,r,a,o)).submit(),n}async function iJ(t,e,r,a,o){const n=rS();if(!n.contentDocument)throw"No document associated with iframe!";return(await JE(n.contentDocument,t,e,r,a,o)).submit(),n}async function V5(t,e,r,a,o,n,f){return a.addQueueMeasurement(Je.SilentHandlerMonitorIframeForHash,n),new Promise((m,y)=>{e<MT&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${MT}ms). This may result in timeouts.`);const C=window.setTimeout(()=>{window.clearInterval(w),y(Nn(H6))},e),w=window.setInterval(()=>{let A="";const R=t.contentWindow;try{A=R?R.location.href:""}catch{}if(!A||A==="about:blank")return;let I="";R&&(f===zC.QUERY?I=R.location.search:I=R.location.hash),window.clearTimeout(C),window.clearInterval(w),m(I)},r)}).finally(()=>{wl(uJ,Je.RemoveHiddenIframe,o,a,n)(t)})}function lJ(t,e,r,a){return r.addQueueMeasurement(Je.SilentHandlerLoadFrame,a),new Promise((o,n)=>{const f=rS();window.setTimeout(()=>{if(!f){n("Unable to load iframe");return}f.src=t,o(f)},e)})}function cJ(t){const e=rS();return e.src=t,e}function rS(){const t=document.createElement("iframe");return t.className="msalSilentIframe",t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),t.setAttribute("allow","local-network-access *"),document.body.appendChild(t),t}function uJ(t){document.body===t.parentNode&&document.body.removeChild(t)}class dJ extends gg{constructor(e,r,a,o,n,f,m,y,C,w,A){super(e,r,a,o,n,f,y,w,A),this.apiId=m,this.nativeStorage=C}async acquireToken(e){this.performanceClient.addQueueMeasurement(Je.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const r={...e};r.prompt?r.prompt!==Us.NONE&&r.prompt!==Us.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${r.prompt} with ${Us.NONE}`),r.prompt=Us.NONE):r.prompt=Us.NONE;const a=await Nt(this.initializeAuthorizationRequest.bind(this),Je.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(r,br.Silent);return a.platformBroker=ib(this.config,this.logger,this.platformAuthProvider,a.authenticationScheme),SM(a.authority),this.config.auth.protocolMode===Xi.EAR?this.executeEarFlow(a):this.executeCodeFlow(a)}async executeCodeFlow(e){let r;const a=this.initializeServerTelemetryManager(this.apiId);try{return r=await Nt(this.createAuthCodeClient.bind(this),Je.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:a,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await Nt(this.silentTokenHelper.bind(this),Je.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(r,e)}catch(o){if(o instanceof Vo&&(o.setCorrelationId(this.correlationId),a.cacheFailedRequest(o)),!r||!(o instanceof Vo)||o.errorCode!==Vi.INVALID_GRANT_ERROR)throw o;return this.performanceClient.addFields({retryError:o.errorCode},this.correlationId),await Nt(this.silentTokenHelper.bind(this),Je.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(r,e)}}async executeEarFlow(e){const r=e.correlationId,a=await Nt(this.getDiscoveredAuthority.bind(this),Je.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await Nt($E,Je.GenerateEarKey,this.logger,this.performanceClient,r)(),n=await Nt(Ap,Je.GeneratePkceCodes,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),f={...e,earJwk:o,codeChallenge:n.challenge},m=await Nt(iJ,Je.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(this.config,a,f,this.logger,this.performanceClient),y=this.config.auth.OIDCOptions.serverResponseType,C=await Nt(V5,Je.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(m,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,y),w=wl(By,Je.DeserializeResponse,this.logger,this.performanceClient,r)(C,y,this.logger);if(!w.ear_jwe&&w.code){const A=await Nt(this.createAuthCodeClient.bind(this),Je.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,r)({serverTelemetryManager:this.initializeServerTelemetryManager(this.apiId),requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account,authority:a});return Nt(Um,Je.HandleResponseCode,this.logger,this.performanceClient,r)(f,w,n.verifier,this.apiId,this.config,A,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}else return Nt(ek,Je.HandleResponseEar,this.logger,this.performanceClient,r)(f,w,this.apiId,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(Nn(ZC))}async silentTokenHelper(e,r){const a=r.correlationId;this.performanceClient.addQueueMeasurement(Je.SilentIframeClientTokenHelper,a);const o=await Nt(Ap,Je.GeneratePkceCodes,this.logger,this.performanceClient,a)(this.performanceClient,this.logger,a),n={...r,codeChallenge:o.challenge};let f;if(r.httpMethod===dp.POST)f=await Nt(sJ,Je.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,a)(this.config,e.authority,n,this.logger,this.performanceClient);else{const w=await Nt(XE,Je.GetAuthCodeUrl,this.logger,this.performanceClient,a)(this.config,e.authority,n,this.logger,this.performanceClient);f=await Nt(aJ,Je.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,a)(w,this.performanceClient,this.logger,a,this.config.system.navigateFrameWait)}const m=this.config.auth.OIDCOptions.serverResponseType,y=await Nt(V5,Je.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,a)(f,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,a,m),C=wl(By,Je.DeserializeResponse,this.logger,this.performanceClient,a)(y,m,this.logger);return Nt(Um,Je.HandleResponseCode,this.logger,this.performanceClient,a)(r,C,o.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}class fJ extends gg{async acquireToken(e){this.performanceClient.addQueueMeasurement(Je.SilentRefreshClientAcquireToken,e.correlationId);const r=await Nt(qE,Je.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),a={...e,...r};e.redirectUri&&(a.redirectUri=this.getRedirectUri(e.redirectUri));const o=this.initializeServerTelemetryManager(Po.acquireTokenSilent_silentFlow),n=await this.createRefreshTokenClient({serverTelemetryManager:o,authorityUrl:a.authority,azureCloudOptions:a.azureCloudOptions,account:a.account});return Nt(n.acquireTokenByRefreshToken.bind(n),Je.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(a).catch(f=>{throw f.setCorrelationId(this.correlationId),o.cacheFailedRequest(f),f})}logout(){return Promise.reject(Nn(ZC))}async createRefreshTokenClient(e){const r=await Nt(this.getClientConfiguration.bind(this),Je.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new RQ(r,this.performanceClient)}}class hJ{constructor(e,r,a,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=r,this.logger=a,this.cryptoObj=o}async loadExternalTokens(e,r,a){if(!this.isBrowserEnvironment)throw Nn(eS);const o=e.correlationId||jc(),n=r.id_token?wu(r.id_token,ki):void 0,f=ku(n||{}),m={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},y=e.authority?new ei(ei.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,m,this.logger,e.correlationId||jc()):void 0,C=await this.loadAccount(e,a.clientInfo||r.client_info||"",o,n,y),w=await this.loadIdToken(r,C.homeAccountId,C.environment,C.realm,o,f),A=await this.loadAccessToken(e,r,C.homeAccountId,C.environment,C.realm,a,o,f),R=await this.loadRefreshToken(r,C.homeAccountId,C.environment,o,f);return this.generateAuthenticationResult(e,{account:C,idToken:w,accessToken:A,refreshToken:R},n,y)}async loadAccount(e,r,a,o,n){if(this.logger.verbose("TokenCache - loading account"),e.account){const C=Qa.createFromAccountInfo(e.account);return await this.storage.setAccount(C,a,ku(o||{})),C}else if(!n||!r&&!o)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Nn(J6);const f=Qa.generateHomeAccountId(r,n.authorityType,this.logger,this.cryptoObj,o),m=o?.tid,y=DE(this.storage,n,f,ki,a,o,r,n.hostnameAndPort,m,void 0,void 0,this.logger);return await this.storage.setAccount(y,a,ku(o||{})),y}async loadIdToken(e,r,a,o,n,f){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const m=GC(r,a,e.id_token,this.config.auth.clientId,o);return await this.storage.setIdTokenCredential(m,n,f),m}async loadAccessToken(e,r,a,o,n,f,m,y){if(r.access_token)if(r.expires_in){if(!r.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const C=r.scope?ys.fromString(r.scope):new ys(e.scopes),w=f.expiresOn||r.expires_in+nl(),A=f.extendedExpiresOn||(r.ext_expires_in||r.expires_in)+nl(),R=KC(a,o,r.access_token,this.config.auth.clientId,n,C.printScopes(),w,A,ki);return await this.storage.setAccessTokenCredential(R,m,y),R}async loadRefreshToken(e,r,a,o,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const f=T6(r,a,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(f,o,n),f}generateAuthenticationResult(e,r,a,o){let n="",f=[],m=null,y;r?.accessToken&&(n=r.accessToken.secret,f=ys.fromString(r.accessToken.target).asArray(),m=Lm(r.accessToken.expiresOn),y=Lm(r.accessToken.extendedExpiresOn));const C=r.account;return{authority:o?o.canonicalAuthority:"",uniqueId:r.account.localAccountId,tenantId:r.account.realm,scopes:f,account:Qa.getAccountInfo(C),idToken:r.idToken?.secret||"",idTokenClaims:a||{},accessToken:n,fromCache:!0,expiresOn:m,correlationId:e.correlationId||"",requestId:"",extExpiresOn:y,familyId:r.refreshToken?.familyId||"",tokenType:r?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:C.cloudGraphHostName||"",msGraphHost:C.msGraphHost||"",fromNativeBroker:!1}}}class pJ extends I6{constructor(e){super(e),this.includeRedirectUri=!1}}class mJ extends gg{constructor(e,r,a,o,n,f,m,y,C,w){super(e,r,a,o,n,f,y,C,w),this.apiId=m}async acquireToken(e){if(!e.code)throw Nn(Z6);const r=await Nt(this.initializeAuthorizationRequest.bind(this),Je.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,br.Silent),a=this.initializeServerTelemetryManager(this.apiId);try{const o={...r,code:e.code},n=await Nt(this.getClientConfiguration.bind(this),Je.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:a,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),f=new pJ(n);this.logger.verbose("Auth code client created");const m=new DM(f,this.browserStorage,o,this.logger,this.performanceClient);return await Nt(m.handleCodeResponseFromServer.bind(m),Je.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},r,!1)}catch(o){throw o instanceof Vo&&(o.setCorrelationId(this.correlationId),a.cacheFailedRequest(o)),o}}logout(){return Promise.reject(Nn(ZC))}}function gJ(t,e,r){const a=window.msal?.clientIds||[],o=a.length,n=a.filter(f=>f===t).length;n>1&&r.warning("There is already an instance of MSAL.js in the window with the same client id."),e.add({msalInstanceCount:o,sameClientIdInstanceCount:n})}function jx(t,e,r){try{KE(t)}catch(a){throw e.end({success:!1},a,r),a}}class oS{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Ad(this.logger,this.performanceClient):O2,this.eventHandler=new LX(this.logger),this.browserStorage=this.isBrowserEnvironment?new OT(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,xQ(this.config.auth)):RX(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const r={cacheLocation:$s.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:$s.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new OT(this.config.auth.clientId,r,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new hJ(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,r){const a=new oS(e);return await a.initialize(r),a}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,r){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(hr.INITIALIZE_END);return}const a=e?.correlationId||this.getRequestCorrelationId(),o=this.config.system.allowPlatformBroker,n=this.performanceClient.startMeasurement(Je.InitializeClientApplication,a);if(this.eventHandler.emitEvent(hr.INITIALIZE_START),!r)try{this.logMultipleInstances(n)}catch{}if(await Nt(this.browserStorage.initialize.bind(this.browserStorage),Je.InitializeCache,this.logger,this.performanceClient,a)(a),o)try{this.platformAuthProvider=await tJ(this.logger,this.performanceClient,a,this.config.system.nativeBrokerHandshakeTimeout,this.config.system.allowPlatformBrokerWithDOM)}catch(f){this.logger.verbose(f)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),wl(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Je.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,a)(a)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(a),this.initialized=!0,this.eventHandler.emitEvent(hr.INITIALIZE_END),n.end({allowPlatformBroker:o,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),CM(this.initialized),this.isBrowserEnvironment){const r=e||"";let a=this.redirectResponse.get(r);return typeof a>"u"?(a=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(r,a),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),a}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if(this.browserStorage.getInteractionInProgress()?.type===Rf.SIGNOUT)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const a=this.getAllAccounts(),o=this.browserStorage.getCachedNativeRequest(),n=o&&this.platformAuthProvider&&!e;let f;this.eventHandler.emitEvent(hr.HANDLE_REDIRECT_START,br.Redirect);let m;try{if(n&&this.platformAuthProvider){f=this.performanceClient.startMeasurement(Je.AcquireTokenRedirect,o?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform"),f.add({isPlatformBrokerRequest:!0});const y=new a2(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Po.handleRedirectPromise,this.performanceClient,this.platformAuthProvider,o.accountId,this.nativeInternalStorage,o.correlationId);m=Nt(y.handleRedirectPromise.bind(y),Je.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,f.event.correlationId)(this.performanceClient,f.event.correlationId)}else{const[y,C]=this.browserStorage.getCachedRequest(),w=y.correlationId;f=this.performanceClient.startMeasurement(Je.AcquireTokenRedirect,w),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const A=this.createRedirectClient(w);m=Nt(A.handleRedirectPromise.bind(A),Je.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,f.event.correlationId)(e,y,C,f)}}catch(y){throw this.browserStorage.resetRequestCache(),y}return m.then(y=>(y?(this.browserStorage.resetRequestCache(),a.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(hr.LOGIN_SUCCESS,br.Redirect,y),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_SUCCESS,br.Redirect,y),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),f.end({success:!0},void 0,y.account)):f.event.errorCode?f.end({success:!1},void 0):f.discard(),this.eventHandler.emitEvent(hr.HANDLE_REDIRECT_END,br.Redirect),y)).catch(y=>{this.browserStorage.resetRequestCache();const C=y;throw a.length>0?this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_FAILURE,br.Redirect,null,C):this.eventHandler.emitEvent(hr.LOGIN_FAILURE,br.Redirect,null,C),this.eventHandler.emitEvent(hr.HANDLE_REDIRECT_END,br.Redirect),f.end({success:!1},C),y})}async acquireTokenRedirect(e){const r=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",r);const a=this.performanceClient.startMeasurement(Je.AcquireTokenPreRedirect,r);a.add({scenarioId:e.scenarioId});const o=e.onRedirectNavigate;if(o)e.onRedirectNavigate=f=>{const m=typeof o=="function"?o(f):void 0;return a.add({navigateCallbackResult:m!==!1}),a.event=a.end({success:!0},void 0,e.account)||a.event,m};else{const f=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=m=>{const y=typeof f=="function"?f(m):void 0;return a.add({navigateCallbackResult:y!==!1}),a.event=a.end({success:!0},void 0,e.account)||a.event,y}}const n=this.getAllAccounts().length>0;try{F5(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Rf.SIGNIN),n?this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_START,br.Redirect,e):this.eventHandler.emitEvent(hr.LOGIN_START,br.Redirect,e);let f;return this.platformAuthProvider&&this.canUsePlatformBroker(e)?f=new a2(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Po.acquireTokenRedirect,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(e),this.nativeInternalStorage,r).acquireTokenRedirect(e,a).catch(y=>{if(a.add({brokerErrorName:y.name,brokerErrorCode:y.errorCode}),y instanceof Su&&Rm(y))return this.platformAuthProvider=void 0,this.createRedirectClient(r).acquireToken(e);if(y instanceof Nc)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(r).acquireToken(e);throw y}):f=this.createRedirectClient(r).acquireToken(e),await f}catch(f){throw this.browserStorage.resetRequestCache(),a.event.status===2?this.performanceClient.startMeasurement(Je.AcquireTokenRedirect,r).end({success:!1},f,e.account):a.end({success:!1},f,e.account),n?this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_FAILURE,br.Redirect,null,f):this.eventHandler.emitEvent(hr.LOGIN_FAILURE,br.Redirect,null,f),f}}acquireTokenPopup(e){const r=this.getRequestCorrelationId(e),a=this.performanceClient.startMeasurement(Je.AcquireTokenPopup,r);a.add({scenarioId:e.scenarioId});try{this.logger.verbose("acquireTokenPopup called",r),jx(this.initialized,a,e.account),this.browserStorage.setInteractionInProgress(!0,Rf.SIGNIN)}catch(m){return Promise.reject(m)}const o=this.getAllAccounts();o.length>0?this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_START,br.Popup,e):this.eventHandler.emitEvent(hr.LOGIN_START,br.Popup,e);let n;const f=this.getPreGeneratedPkceCodes(r);return this.canUsePlatformBroker(e)?(a.add({isPlatformBrokerRequest:!0}),n=this.acquireTokenNative({...e,correlationId:r},Po.acquireTokenPopup).then(m=>(a.end({success:!0},void 0,m.account),m)).catch(m=>{if(a.add({brokerErrorName:m.name,brokerErrorCode:m.errorCode}),m instanceof Su&&Rm(m))return this.platformAuthProvider=void 0,this.createPopupClient(r).acquireToken(e,f);if(m instanceof Nc)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(r).acquireToken(e,f);throw m})):n=this.createPopupClient(r).acquireToken(e,f),n.then(m=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(hr.LOGIN_SUCCESS,br.Popup,m):this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_SUCCESS,br.Popup,m),a.end({success:!0,accessTokenSize:m.accessToken.length,idTokenSize:m.idToken.length},void 0,m.account),m)).catch(m=>(o.length>0?this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_FAILURE,br.Popup,null,m):this.eventHandler.emitEvent(hr.LOGIN_FAILURE,br.Popup,null,m),a.end({success:!1},m,e.account),Promise.reject(m))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(r)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const r=this.getRequestCorrelationId(e),a={...e,prompt:e.prompt,correlationId:r};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Je.SsoSilent,r),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId}),jx(this.initialized,this.ssoSilentMeasurement,e.account),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(hr.SSO_SILENT_START,br.Silent,a);let o;return this.canUsePlatformBroker(a)?(this.ssoSilentMeasurement?.add({isPlatformBrokerRequest:!0}),o=this.acquireTokenNative(a,Po.ssoSilent).catch(n=>{if(this.ssoSilentMeasurement?.add({brokerErrorName:n.name,brokerErrorCode:n.errorCode}),n instanceof Su&&Rm(n))return this.platformAuthProvider=void 0,this.createSilentIframeClient(a.correlationId).acquireToken(a);throw n})):o=this.createSilentIframeClient(a.correlationId).acquireToken(a),o.then(n=>(this.eventHandler.emitEvent(hr.SSO_SILENT_SUCCESS,br.Silent,n),this.ssoSilentMeasurement?.end({success:!0,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length},void 0,n.account),n)).catch(n=>{throw this.eventHandler.emitEvent(hr.SSO_SILENT_FAILURE,br.Silent,null,n),this.ssoSilentMeasurement?.end({success:!1},n,e.account),n}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const r=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",r);const a=this.performanceClient.startMeasurement(Je.AcquireTokenByCode,r);jx(this.initialized,a),this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_BY_CODE_START,br.Silent,e),a.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Nn(tM);if(e.code){const o=e.code;let n=this.hybridAuthCodeResponses.get(o);return n?(this.logger.verbose("Existing acquireTokenByCode request found",r),a.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",r),n=this.acquireTokenByCodeAsync({...e,correlationId:r}).then(f=>(this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_BY_CODE_SUCCESS,br.Silent,f),this.hybridAuthCodeResponses.delete(o),a.end({success:!0,accessTokenSize:f.accessToken.length,idTokenSize:f.idToken.length},void 0,f.account),f)).catch(f=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_BY_CODE_FAILURE,br.Silent,null,f),a.end({success:!1},f),f}),this.hybridAuthCodeResponses.set(o,n)),await n}else if(e.nativeAccountId)if(this.canUsePlatformBroker(e,e.nativeAccountId)){a.add({isPlatformBrokerRequest:!0});const o=await this.acquireTokenNative({...e,correlationId:r},Po.acquireTokenByCode,e.nativeAccountId).catch(n=>{throw n instanceof Su&&Rm(n)&&(this.platformAuthProvider=void 0),a.add({brokerErrorName:n.name,brokerErrorCode:n.errorCode}),n});return a.end({success:!0},void 0,o.account),o}else throw Nn(nM);else throw Nn(eM)}catch(o){throw this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_BY_CODE_FAILURE,br.Silent,null,o),a.end({success:!1},o),o}}async acquireTokenByCodeAsync(e){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Je.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(o=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:o.fromCache}),o)).catch(o=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,r){switch(this.performanceClient.addQueueMeasurement(Je.AcquireTokenFromCache,e.correlationId),r){case wi.Default:case wi.AccessToken:case wi.AccessTokenAndRefreshToken:const a=this.createSilentCacheClient(e.correlationId);return Nt(a.acquireToken.bind(a),Je.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw an(Of)}}async acquireTokenByRefreshToken(e,r){switch(this.performanceClient.addQueueMeasurement(Je.AcquireTokenByRefreshToken,e.correlationId),r){case wi.Default:case wi.AccessTokenAndRefreshToken:case wi.RefreshToken:case wi.RefreshTokenAndNetwork:const a=this.createSilentRefreshClient(e.correlationId);return Nt(a.acquireToken.bind(a),Je.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw an(Of)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Je.AcquireTokenBySilentIframe,e.correlationId);const r=this.createSilentIframeClient(e.correlationId);return Nt(r.acquireToken.bind(r),Je.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const r=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",r),this.logoutRedirect({correlationId:r,...e})}async logoutRedirect(e){const r=this.getRequestCorrelationId(e);return F5(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Rf.SIGNOUT),this.createRedirectClient(r).logout(e)}logoutPopup(e){try{const r=this.getRequestCorrelationId(e);return KE(this.initialized),this.browserStorage.setInteractionInProgress(!0,Rf.SIGNOUT),this.createPopupClient(r).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(r){return Promise.reject(r)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const r=this.getRequestCorrelationId(e);return this.createSilentCacheClient(r).logout(e)}getAllAccounts(e){const r=this.getRequestCorrelationId();return IX(this.logger,this.browserStorage,this.isBrowserEnvironment,r,e)}getAccount(e){const r=this.getRequestCorrelationId();return PX(e,this.logger,this.browserStorage,r)}getAccountByUsername(e){const r=this.getRequestCorrelationId();return MX(e,this.logger,this.browserStorage,r)}getAccountByHomeId(e){const r=this.getRequestCorrelationId();return _X(e,this.logger,this.browserStorage,r)}getAccountByLocalId(e){const r=this.getRequestCorrelationId();return OX(e,this.logger,this.browserStorage,r)}setActiveAccount(e){const r=this.getRequestCorrelationId();FX(e,this.browserStorage,r)}getActiveAccount(){const e=this.getRequestCorrelationId();return NX(this.browserStorage,e)}async hydrateCache(e,r){this.logger.verbose("hydrateCache called");const a=Qa.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(a,e.correlationId,ku(e.idTokenClaims)),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,r)):this.browserStorage.hydrateCache(e,r)}async acquireTokenNative(e,r,a,o){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw Nn(jE);return new a2(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,r,this.performanceClient,this.platformAuthProvider,a||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,o)}canUsePlatformBroker(e,r){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!ib(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Us.NONE:case Us.CONSENT:case Us.LOGIN:case Us.SELECT_ACCOUNT:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!r&&!this.getNativeAccountId(e)?(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const r=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return r&&r.nativeAccountId||""}createPopupClient(e){return new nJ(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new oJ(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new dJ(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Po.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new IM(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new fJ(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new mJ(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Po.acquireTokenByCode,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,r){return this.eventHandler.addEventCallback(e,r)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return xM(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){if(this.config.cache.cacheLocation!==$s.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.subscribeCrossTab()}disableAccountStorageEvents(){if(this.config.cache.cacheLocation!==$s.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.unsubscribeCrossTab()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,r){this.browserStorage.setWrapperMetadata(e,r)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?jc():zt.EMPTY_STRING}async loginRedirect(e){const r=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",r),this.acquireTokenRedirect({correlationId:r,...e||I5})}loginPopup(e){const r=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",r),this.acquireTokenPopup({correlationId:r,...e||I5})}async acquireTokenSilent(e){const r=this.getRequestCorrelationId(e),a=this.performanceClient.startMeasurement(Je.AcquireTokenSilent,r);a.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),jx(this.initialized,a,e.account),this.logger.verbose("acquireTokenSilent called",r);const o=e.account||this.getActiveAccount();if(!o)throw Nn(K6);return this.acquireTokenSilentDeduped(e,o,r).then(n=>(a.end({success:!0,fromCache:n.fromCache,accessTokenSize:n.accessToken.length,idTokenSize:n.idToken.length},void 0,n.account),{...n,state:e.state,correlationId:r})).catch(n=>{throw n instanceof Vo&&n.setCorrelationId(r),a.end({success:!1},n,o),n})}async acquireTokenSilentDeduped(e,r,a){const o=qC(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority},r.homeAccountId),n=JSON.stringify(o),f=this.activeSilentTokenRequests.get(n);if(typeof f>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",a),this.performanceClient.addFields({deduped:!1},a);const m=Nt(this.acquireTokenSilentAsync.bind(this),Je.AcquireTokenSilentAsync,this.logger,this.performanceClient,a)({...e,correlationId:a},r);return this.activeSilentTokenRequests.set(n,m),m.finally(()=>{this.activeSilentTokenRequests.delete(n)})}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",a),this.performanceClient.addFields({deduped:!0},a),f}async acquireTokenSilentAsync(e,r){const a=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Je.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_START,br.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",a);const o=await Nt(BX,Je.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,r,this.config,this.performanceClient,this.logger),n=e.cacheLookupPolicy||wi.Default;return this.acquireTokenSilentNoIframe(o,n).catch(async m=>{if(yJ(m,n))if(this.activeIframeRequest)if(n!==wi.Skip){const[C,w]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${w}`,o.correlationId);const A=this.performanceClient.startMeasurement(Je.AwaitConcurrentIframe,o.correlationId);A.add({awaitIframeCorrelationId:w});const R=await C;if(A.end({success:R}),R)return this.logger.verbose(`Parallel iframe request with correlationId: ${w} succeeded. Retrying cache and/or RT redemption`,o.correlationId),this.acquireTokenSilentNoIframe(o,n);throw this.logger.info(`Iframe request with correlationId: ${w} failed. Interaction is required.`),m}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),Nt(this.acquireTokenBySilentIframe.bind(this),Je.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o);else{let C;return this.activeIframeRequest=[new Promise(w=>{C=w}),o.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),Nt(this.acquireTokenBySilentIframe.bind(this),Je.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o).then(w=>(C(!0),w)).catch(w=>{throw C(!1),w}).finally(()=>{this.activeIframeRequest=void 0})}else throw m}).then(m=>(this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_SUCCESS,br.Silent,m),this.performanceClient.addFields({fromCache:m.fromCache},e.correlationId),m)).catch(m=>{throw this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_FAILURE,br.Silent,null,m),m}).finally(()=>{document.removeEventListener("visibilitychange",a)})}async acquireTokenSilentNoIframe(e,r){return ib(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.performanceClient.addFields({isPlatformBrokerRequest:!0},e.correlationId),this.acquireTokenNative(e,Po.acquireTokenSilent_silentFlow,e.account.nativeAccountId,r).catch(async a=>{throw this.performanceClient.addFields({brokerErrorName:a.name,brokerErrorCode:a.errorCode},e.correlationId),a instanceof Su&&Rm(a)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,an(Of)):a})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),r===wi.AccessToken&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),Nt(this.acquireTokenFromCache.bind(this),Je.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,r).catch(a=>{if(r===wi.AccessToken)throw a;return this.eventHandler.emitEvent(hr.ACQUIRE_TOKEN_NETWORK_START,br.Silent,e),Nt(this.acquireTokenByRefreshToken.bind(this),Je.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,r)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await Nt(Ap,Je.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const r=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose(`${r?"Found":"Did not find"} pre-generated PKCE codes`),this.performanceClient.addFields({usePreGeneratedPkce:!!r},e),r}logMultipleInstances(e){const r=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(r),gJ(r,e,this.logger)}}function yJ(t,e){const r=!(t instanceof Nc&&t.subError!==XC),a=t.errorCode===Vi.INVALID_GRANT_ERROR||t.errorCode===Of,o=r&&a||t.errorCode===H2||t.errorCode===EE,n=YQ.includes(e);return o&&n}async function bJ(t,e){const r=new Tp(t);return await r.initialize(),oS.createController(r,e)}class nk{static async createPublicClientApplication(e){const r=await bJ(e);return new nk(e,r)}constructor(e,r){this.isBroker=!1,this.controller=r||new oS(new Tp(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,r){return this.controller.addEventCallback(e,r)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,r){return this.controller.initializeWrapperLibrary(e,r)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,r){return this.controller.hydrateCache(e,r)}clearCache(e){return this.controller.clearCache(e)}}const vJ="modulepreload",xJ=function(t){return"/"+t},G5={},K5=function(e,r,a){let o=Promise.resolve();if(r&&r.length>0){let C=function(w){return Promise.all(w.map(A=>Promise.resolve(A).then(R=>({status:"fulfilled",value:R}),R=>({status:"rejected",reason:R}))))};var f=C;document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),y=m?.nonce||m?.getAttribute("nonce");o=C(r.map(w=>{if(w=xJ(w),w in G5)return;G5[w]=!0;const A=w.endsWith(".css"),R=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${w}"]${R}`))return;const I=document.createElement("link");if(I.rel=A?"stylesheet":vJ,A||(I.as="script"),I.crossOrigin="",I.href=w,y&&I.setAttribute("nonce",y),document.head.appendChild(I),A)return new Promise((M,F)=>{I.addEventListener("load",M),I.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${w}`)))})}))}function n(m){const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=m,window.dispatchEvent(y),!y.defaultPrevented)throw m}return o.then(m=>{for(const y of m||[])y.status==="rejected"&&n(y.reason);return e().catch(n)})},CJ="0cdad176-903f-43a3-979b-8585f8149920",SJ="9f4e2976-b07e-4f8f-9c78-055f6c855a11",Y5={auth:{clientId:CJ,authority:`https://login.microsoftonline.com/${SJ}`,redirectUri:"https://stalo-h5d6djg6duahfkc9.canadacentral-01.azurewebsites.net",postLogoutRedirectUri:"https://stalo-h5d6djg6duahfkc9.canadacentral-01.azurewebsites.net",navigateToLoginRequestUrl:!0},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0},system:{loggerOptions:{loggerCallback:(t,e,r)=>{},piiLoggingEnabled:!1,logLevel:2}}},aS=["openid","profile","email","offline_access","Files.ReadWrite.All","Sites.ReadWrite.All"];let op=null,Tm=null;async function _M(){return op||Tm||(Tm=(async()=>{try{Y5.auth.clientId||console.warn("MSAL Client ID not configured. OAuth2 authentication disabled. Please configure VITE_MSAL_CLIENT_ID in .env.local to enable.");const t=new nk(Y5);return typeof t.initialize=="function"&&await t.initialize(),op=t,Tm=null,op}catch(t){throw Tm=null,op=null,t}})(),Tm)}async function Mp(){return op||await _M()}async function wJ(){const t=await Mp();try{const e=await t.handleRedirectPromise();return e?(console.log(" Redirect login successful:",e.account?.name),t.setActiveAccount(e.account),e):null}catch(e){throw console.error(" MSAL redirect error:",e),e}}async function TJ(){const t=await Mp(),e={scopes:aS,prompt:"select_account"};try{console.log("Starting redirect login..."),await t.loginRedirect(e)}catch(r){throw console.error(" Redirect login failed:",r),r}}async function AJ(){const t=await Mp(),e=t.getActiveAccount();try{console.log(" Clearing MSAL cache...");const r=[];for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);o&&o.startsWith("msal")&&r.push(o)}r.forEach(a=>localStorage.removeItem(a)),console.log(` Cleared ${r.length} localStorage entries`),e&&await t.logoutPopup({account:e}),console.log(" Logout complete - fresh login required next time")}catch(r){throw console.error(" Logout error:",r),localStorage.clear(),r}}async function rk(){const t=await Mp(),e=t.getAllAccounts();if(e.length===0)throw new Error("No user is currently signed in");const r=e[0],a={scopes:aS,account:r};try{const o=await t.acquireTokenSilent(a);return console.log(" Token acquired (from cache or refreshed)"),o.accessToken}catch(o){console.warn(" Silent token acquisition failed, falling back to popup:",o.errorCode);try{const n=await t.acquireTokenPopup(a);return console.log(" Token acquired via popup"),n.accessToken}catch(n){throw console.error(" Token acquisition via popup failed:",n),n}}}async function sS(){const e=(await Mp()).getAllAccounts();return e.length>0?e[0]:null}async function EJ(){return await sS()!==null}async function kJ(){return(await sS())?.name||"Unknown User"}async function DJ(){return(await sS())?.username||""}function OM(t,e){return function(){return t.apply(e,arguments)}}const{toString:RJ}=Object.prototype,{getPrototypeOf:ok}=Object,{iterator:iS,toStringTag:FM}=Symbol,lS=(t=>e=>{const r=RJ.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),zc=t=>(t=t.toLowerCase(),e=>lS(e)===t),cS=t=>e=>typeof e===t,{isArray:yg}=Array,rg=cS("undefined");function Db(t){return t!==null&&!rg(t)&&t.constructor!==null&&!rg(t.constructor)&&Ji(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const NM=zc("ArrayBuffer");function IJ(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&NM(t.buffer),e}const PJ=cS("string"),Ji=cS("function"),jM=cS("number"),Rb=t=>t!==null&&typeof t=="object",MJ=t=>t===!0||t===!1,s2=t=>{if(lS(t)!=="object")return!1;const e=ok(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(FM in t)&&!(iS in t)},_J=t=>{if(!Rb(t)||Db(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},OJ=zc("Date"),FJ=zc("File"),NJ=zc("Blob"),jJ=zc("FileList"),LJ=t=>Rb(t)&&Ji(t.pipe),BJ=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ji(t.append)&&((e=lS(t))==="formdata"||e==="object"&&Ji(t.toString)&&t.toString()==="[object FormData]"))},zJ=zc("URLSearchParams"),[UJ,$J,HJ,WJ]=["ReadableStream","Request","Response","Headers"].map(zc),VJ=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ib(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let a,o;if(typeof t!="object"&&(t=[t]),yg(t))for(a=0,o=t.length;a<o;a++)e.call(null,t[a],a,t);else{if(Db(t))return;const n=r?Object.getOwnPropertyNames(t):Object.keys(t),f=n.length;let m;for(a=0;a<f;a++)m=n[a],e.call(null,t[m],m,t)}}function LM(t,e){if(Db(t))return null;e=e.toLowerCase();const r=Object.keys(t);let a=r.length,o;for(;a-- >0;)if(o=r[a],e===o.toLowerCase())return o;return null}const fp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,BM=t=>!rg(t)&&t!==fp;function FT(){const{caseless:t,skipUndefined:e}=BM(this)&&this||{},r={},a=(o,n)=>{const f=t&&LM(r,n)||n;s2(r[f])&&s2(o)?r[f]=FT(r[f],o):s2(o)?r[f]=FT({},o):yg(o)?r[f]=o.slice():(!e||!rg(o))&&(r[f]=o)};for(let o=0,n=arguments.length;o<n;o++)arguments[o]&&Ib(arguments[o],a);return r}const GJ=(t,e,r,{allOwnKeys:a}={})=>(Ib(e,(o,n)=>{r&&Ji(o)?t[n]=OM(o,r):t[n]=o},{allOwnKeys:a}),t),KJ=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),YJ=(t,e,r,a)=>{t.prototype=Object.create(e.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},qJ=(t,e,r,a)=>{let o,n,f;const m={};if(e=e||{},t==null)return e;do{for(o=Object.getOwnPropertyNames(t),n=o.length;n-- >0;)f=o[n],(!a||a(f,t,e))&&!m[f]&&(e[f]=t[f],m[f]=!0);t=r!==!1&&ok(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},QJ=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const a=t.indexOf(e,r);return a!==-1&&a===r},XJ=t=>{if(!t)return null;if(yg(t))return t;let e=t.length;if(!jM(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},JJ=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&ok(Uint8Array)),ZJ=(t,e)=>{const a=(t&&t[iS]).call(t);let o;for(;(o=a.next())&&!o.done;){const n=o.value;e.call(t,n[0],n[1])}},eZ=(t,e)=>{let r;const a=[];for(;(r=t.exec(e))!==null;)a.push(r);return a},tZ=zc("HTMLFormElement"),nZ=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,o){return a.toUpperCase()+o}),q5=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),rZ=zc("RegExp"),zM=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),a={};Ib(r,(o,n)=>{let f;(f=e(o,n,t))!==!1&&(a[n]=f||o)}),Object.defineProperties(t,a)},oZ=t=>{zM(t,(e,r)=>{if(Ji(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=t[r];if(Ji(a)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},aZ=(t,e)=>{const r={},a=o=>{o.forEach(n=>{r[n]=!0})};return yg(t)?a(t):a(String(t).split(e)),r},sZ=()=>{},iZ=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function lZ(t){return!!(t&&Ji(t.append)&&t[FM]==="FormData"&&t[iS])}const cZ=t=>{const e=new Array(10),r=(a,o)=>{if(Rb(a)){if(e.indexOf(a)>=0)return;if(Db(a))return a;if(!("toJSON"in a)){e[o]=a;const n=yg(a)?[]:{};return Ib(a,(f,m)=>{const y=r(f,o+1);!rg(y)&&(n[m]=y)}),e[o]=void 0,n}}return a};return r(t,0)},uZ=zc("AsyncFunction"),dZ=t=>t&&(Rb(t)||Ji(t))&&Ji(t.then)&&Ji(t.catch),UM=((t,e)=>t?setImmediate:e?((r,a)=>(fp.addEventListener("message",({source:o,data:n})=>{o===fp&&n===r&&a.length&&a.shift()()},!1),o=>{a.push(o),fp.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ji(fp.postMessage)),fZ=typeof queueMicrotask<"u"?queueMicrotask.bind(fp):typeof process<"u"&&process.nextTick||UM,hZ=t=>t!=null&&Ji(t[iS]),wt={isArray:yg,isArrayBuffer:NM,isBuffer:Db,isFormData:BJ,isArrayBufferView:IJ,isString:PJ,isNumber:jM,isBoolean:MJ,isObject:Rb,isPlainObject:s2,isEmptyObject:_J,isReadableStream:UJ,isRequest:$J,isResponse:HJ,isHeaders:WJ,isUndefined:rg,isDate:OJ,isFile:FJ,isBlob:NJ,isRegExp:rZ,isFunction:Ji,isStream:LJ,isURLSearchParams:zJ,isTypedArray:JJ,isFileList:jJ,forEach:Ib,merge:FT,extend:GJ,trim:VJ,stripBOM:KJ,inherits:YJ,toFlatObject:qJ,kindOf:lS,kindOfTest:zc,endsWith:QJ,toArray:XJ,forEachEntry:ZJ,matchAll:eZ,isHTMLForm:tZ,hasOwnProperty:q5,hasOwnProp:q5,reduceDescriptors:zM,freezeMethods:oZ,toObjectSet:aZ,toCamelCase:nZ,noop:sZ,toFiniteNumber:iZ,findKey:LM,global:fp,isContextDefined:BM,isSpecCompliantForm:lZ,toJSONObject:cZ,isAsyncFn:uZ,isThenable:dZ,setImmediate:UM,asap:fZ,isIterable:hZ};function Mr(t,e,r,a,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),a&&(this.request=a),o&&(this.response=o,this.status=o.status?o.status:null)}wt.inherits(Mr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:wt.toJSONObject(this.config),code:this.code,status:this.status}}});const $M=Mr.prototype,HM={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{HM[t]={value:t}});Object.defineProperties(Mr,HM);Object.defineProperty($M,"isAxiosError",{value:!0});Mr.from=(t,e,r,a,o,n)=>{const f=Object.create($M);wt.toFlatObject(t,f,function(w){return w!==Error.prototype},C=>C!=="isAxiosError");const m=t&&t.message?t.message:"Error",y=e==null&&t?t.code:e;return Mr.call(f,m,y,r,a,o),t&&f.cause==null&&Object.defineProperty(f,"cause",{value:t,configurable:!0}),f.name=t&&t.name||"Error",n&&Object.assign(f,n),f};const pZ=null;function NT(t){return wt.isPlainObject(t)||wt.isArray(t)}function WM(t){return wt.endsWith(t,"[]")?t.slice(0,-2):t}function Q5(t,e,r){return t?t.concat(e).map(function(o,n){return o=WM(o),!r&&n?"["+o+"]":o}).join(r?".":""):e}function mZ(t){return wt.isArray(t)&&!t.some(NT)}const gZ=wt.toFlatObject(wt,{},null,function(e){return/^is[A-Z]/.test(e)});function uS(t,e,r){if(!wt.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=wt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(F,O){return!wt.isUndefined(O[F])});const a=r.metaTokens,o=r.visitor||w,n=r.dots,f=r.indexes,y=(r.Blob||typeof Blob<"u"&&Blob)&&wt.isSpecCompliantForm(e);if(!wt.isFunction(o))throw new TypeError("visitor must be a function");function C(M){if(M===null)return"";if(wt.isDate(M))return M.toISOString();if(wt.isBoolean(M))return M.toString();if(!y&&wt.isBlob(M))throw new Mr("Blob is not supported. Use a Buffer instead.");return wt.isArrayBuffer(M)||wt.isTypedArray(M)?y&&typeof Blob=="function"?new Blob([M]):Buffer.from(M):M}function w(M,F,O){let j=M;if(M&&!O&&typeof M=="object"){if(wt.endsWith(F,"{}"))F=a?F:F.slice(0,-2),M=JSON.stringify(M);else if(wt.isArray(M)&&mZ(M)||(wt.isFileList(M)||wt.endsWith(F,"[]"))&&(j=wt.toArray(M)))return F=WM(F),j.forEach(function(H,K){!(wt.isUndefined(H)||H===null)&&e.append(f===!0?Q5([F],K,n):f===null?F:F+"[]",C(H))}),!1}return NT(M)?!0:(e.append(Q5(O,F,n),C(M)),!1)}const A=[],R=Object.assign(gZ,{defaultVisitor:w,convertValue:C,isVisitable:NT});function I(M,F){if(!wt.isUndefined(M)){if(A.indexOf(M)!==-1)throw Error("Circular reference detected in "+F.join("."));A.push(M),wt.forEach(M,function(j,U){(!(wt.isUndefined(j)||j===null)&&o.call(e,j,wt.isString(U)?U.trim():U,F,R))===!0&&I(j,F?F.concat(U):[U])}),A.pop()}}if(!wt.isObject(t))throw new TypeError("data must be an object");return I(t),e}function X5(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return e[a]})}function ak(t,e){this._pairs=[],t&&uS(t,this,e)}const VM=ak.prototype;VM.append=function(e,r){this._pairs.push([e,r])};VM.toString=function(e){const r=e?function(a){return e.call(this,a,X5)}:X5;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function yZ(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function GM(t,e,r){if(!e)return t;const a=r&&r.encode||yZ;wt.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let n;if(o?n=o(e,r):n=wt.isURLSearchParams(e)?e.toString():new ak(e,r).toString(a),n){const f=t.indexOf("#");f!==-1&&(t=t.slice(0,f)),t+=(t.indexOf("?")===-1?"?":"&")+n}return t}class J5{constructor(){this.handlers=[]}use(e,r,a){return this.handlers.push({fulfilled:e,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){wt.forEach(this.handlers,function(a){a!==null&&e(a)})}}const KM={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bZ=typeof URLSearchParams<"u"?URLSearchParams:ak,vZ=typeof FormData<"u"?FormData:null,xZ=typeof Blob<"u"?Blob:null,CZ={isBrowser:!0,classes:{URLSearchParams:bZ,FormData:vZ,Blob:xZ},protocols:["http","https","file","blob","url","data"]},sk=typeof window<"u"&&typeof document<"u",jT=typeof navigator=="object"&&navigator||void 0,SZ=sk&&(!jT||["ReactNative","NativeScript","NS"].indexOf(jT.product)<0),wZ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",TZ=sk&&window.location.href||"http://localhost",AZ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sk,hasStandardBrowserEnv:SZ,hasStandardBrowserWebWorkerEnv:wZ,navigator:jT,origin:TZ},Symbol.toStringTag,{value:"Module"})),ni={...AZ,...CZ};function EZ(t,e){return uS(t,new ni.classes.URLSearchParams,{visitor:function(r,a,o,n){return ni.isNode&&wt.isBuffer(r)?(this.append(a,r.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)},...e})}function kZ(t){return wt.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function DZ(t){const e={},r=Object.keys(t);let a;const o=r.length;let n;for(a=0;a<o;a++)n=r[a],e[n]=t[n];return e}function YM(t){function e(r,a,o,n){let f=r[n++];if(f==="__proto__")return!0;const m=Number.isFinite(+f),y=n>=r.length;return f=!f&&wt.isArray(o)?o.length:f,y?(wt.hasOwnProp(o,f)?o[f]=[o[f],a]:o[f]=a,!m):((!o[f]||!wt.isObject(o[f]))&&(o[f]=[]),e(r,a,o[f],n)&&wt.isArray(o[f])&&(o[f]=DZ(o[f])),!m)}if(wt.isFormData(t)&&wt.isFunction(t.entries)){const r={};return wt.forEachEntry(t,(a,o)=>{e(kZ(a),o,r,0)}),r}return null}function RZ(t,e,r){if(wt.isString(t))try{return(e||JSON.parse)(t),wt.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(t)}const Pb={transitional:KM,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const a=r.getContentType()||"",o=a.indexOf("application/json")>-1,n=wt.isObject(e);if(n&&wt.isHTMLForm(e)&&(e=new FormData(e)),wt.isFormData(e))return o?JSON.stringify(YM(e)):e;if(wt.isArrayBuffer(e)||wt.isBuffer(e)||wt.isStream(e)||wt.isFile(e)||wt.isBlob(e)||wt.isReadableStream(e))return e;if(wt.isArrayBufferView(e))return e.buffer;if(wt.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let m;if(n){if(a.indexOf("application/x-www-form-urlencoded")>-1)return EZ(e,this.formSerializer).toString();if((m=wt.isFileList(e))||a.indexOf("multipart/form-data")>-1){const y=this.env&&this.env.FormData;return uS(m?{"files[]":e}:e,y&&new y,this.formSerializer)}}return n||o?(r.setContentType("application/json",!1),RZ(e)):e}],transformResponse:[function(e){const r=this.transitional||Pb.transitional,a=r&&r.forcedJSONParsing,o=this.responseType==="json";if(wt.isResponse(e)||wt.isReadableStream(e))return e;if(e&&wt.isString(e)&&(a&&!this.responseType||o)){const f=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(e,this.parseReviver)}catch(m){if(f)throw m.name==="SyntaxError"?Mr.from(m,Mr.ERR_BAD_RESPONSE,this,null,this.response):m}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ni.classes.FormData,Blob:ni.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};wt.forEach(["delete","get","head","post","put","patch"],t=>{Pb.headers[t]={}});const IZ=wt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),PZ=t=>{const e={};let r,a,o;return t&&t.split(`
`).forEach(function(f){o=f.indexOf(":"),r=f.substring(0,o).trim().toLowerCase(),a=f.substring(o+1).trim(),!(!r||e[r]&&IZ[r])&&(r==="set-cookie"?e[r]?e[r].push(a):e[r]=[a]:e[r]=e[r]?e[r]+", "+a:a)}),e},Z5=Symbol("internals");function vy(t){return t&&String(t).trim().toLowerCase()}function i2(t){return t===!1||t==null?t:wt.isArray(t)?t.map(i2):String(t)}function MZ(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(t);)e[a[1]]=a[2];return e}const _Z=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function ww(t,e,r,a,o){if(wt.isFunction(a))return a.call(this,e,r);if(o&&(e=r),!!wt.isString(e)){if(wt.isString(a))return e.indexOf(a)!==-1;if(wt.isRegExp(a))return a.test(e)}}function OZ(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,a)=>r.toUpperCase()+a)}function FZ(t,e){const r=wt.toCamelCase(" "+e);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+r,{value:function(o,n,f){return this[a].call(this,e,o,n,f)},configurable:!0})})}let Zi=class{constructor(e){e&&this.set(e)}set(e,r,a){const o=this;function n(m,y,C){const w=vy(y);if(!w)throw new Error("header name must be a non-empty string");const A=wt.findKey(o,w);(!A||o[A]===void 0||C===!0||C===void 0&&o[A]!==!1)&&(o[A||y]=i2(m))}const f=(m,y)=>wt.forEach(m,(C,w)=>n(C,w,y));if(wt.isPlainObject(e)||e instanceof this.constructor)f(e,r);else if(wt.isString(e)&&(e=e.trim())&&!_Z(e))f(PZ(e),r);else if(wt.isObject(e)&&wt.isIterable(e)){let m={},y,C;for(const w of e){if(!wt.isArray(w))throw TypeError("Object iterator must return a key-value pair");m[C=w[0]]=(y=m[C])?wt.isArray(y)?[...y,w[1]]:[y,w[1]]:w[1]}f(m,r)}else e!=null&&n(r,e,a);return this}get(e,r){if(e=vy(e),e){const a=wt.findKey(this,e);if(a){const o=this[a];if(!r)return o;if(r===!0)return MZ(o);if(wt.isFunction(r))return r.call(this,o,a);if(wt.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=vy(e),e){const a=wt.findKey(this,e);return!!(a&&this[a]!==void 0&&(!r||ww(this,this[a],a,r)))}return!1}delete(e,r){const a=this;let o=!1;function n(f){if(f=vy(f),f){const m=wt.findKey(a,f);m&&(!r||ww(a,a[m],m,r))&&(delete a[m],o=!0)}}return wt.isArray(e)?e.forEach(n):n(e),o}clear(e){const r=Object.keys(this);let a=r.length,o=!1;for(;a--;){const n=r[a];(!e||ww(this,this[n],n,e,!0))&&(delete this[n],o=!0)}return o}normalize(e){const r=this,a={};return wt.forEach(this,(o,n)=>{const f=wt.findKey(a,n);if(f){r[f]=i2(o),delete r[n];return}const m=e?OZ(n):String(n).trim();m!==n&&delete r[n],r[m]=i2(o),a[m]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return wt.forEach(this,(a,o)=>{a!=null&&a!==!1&&(r[o]=e&&wt.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const a=new this(e);return r.forEach(o=>a.set(o)),a}static accessor(e){const a=(this[Z5]=this[Z5]={accessors:{}}).accessors,o=this.prototype;function n(f){const m=vy(f);a[m]||(FZ(o,f),a[m]=!0)}return wt.isArray(e)?e.forEach(n):n(e),this}};Zi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);wt.reduceDescriptors(Zi.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(a){this[r]=a}}});wt.freezeMethods(Zi);function Tw(t,e){const r=this||Pb,a=e||r,o=Zi.from(a.headers);let n=a.data;return wt.forEach(t,function(m){n=m.call(r,n,o.normalize(),e?e.status:void 0)}),o.normalize(),n}function qM(t){return!!(t&&t.__CANCEL__)}function bg(t,e,r){Mr.call(this,t??"canceled",Mr.ERR_CANCELED,e,r),this.name="CanceledError"}wt.inherits(bg,Mr,{__CANCEL__:!0});function QM(t,e,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?t(r):e(new Mr("Request failed with status code "+r.status,[Mr.ERR_BAD_REQUEST,Mr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function NZ(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function jZ(t,e){t=t||10;const r=new Array(t),a=new Array(t);let o=0,n=0,f;return e=e!==void 0?e:1e3,function(y){const C=Date.now(),w=a[n];f||(f=C),r[o]=y,a[o]=C;let A=n,R=0;for(;A!==o;)R+=r[A++],A=A%t;if(o=(o+1)%t,o===n&&(n=(n+1)%t),C-f<e)return;const I=w&&C-w;return I?Math.round(R*1e3/I):void 0}}function LZ(t,e){let r=0,a=1e3/e,o,n;const f=(C,w=Date.now())=>{r=w,o=null,n&&(clearTimeout(n),n=null),t(...C)};return[(...C)=>{const w=Date.now(),A=w-r;A>=a?f(C,w):(o=C,n||(n=setTimeout(()=>{n=null,f(o)},a-A)))},()=>o&&f(o)]}const Q2=(t,e,r=3)=>{let a=0;const o=jZ(50,250);return LZ(n=>{const f=n.loaded,m=n.lengthComputable?n.total:void 0,y=f-a,C=o(y),w=f<=m;a=f;const A={loaded:f,total:m,progress:m?f/m:void 0,bytes:y,rate:C||void 0,estimated:C&&m&&w?(m-f)/C:void 0,event:n,lengthComputable:m!=null,[e?"download":"upload"]:!0};t(A)},r)},eR=(t,e)=>{const r=t!=null;return[a=>e[0]({lengthComputable:r,total:t,loaded:a}),e[1]]},tR=t=>(...e)=>wt.asap(()=>t(...e)),BZ=ni.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,ni.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(ni.origin),ni.navigator&&/(msie|trident)/i.test(ni.navigator.userAgent)):()=>!0,zZ=ni.hasStandardBrowserEnv?{write(t,e,r,a,o,n,f){if(typeof document>"u")return;const m=[`${t}=${encodeURIComponent(e)}`];wt.isNumber(r)&&m.push(`expires=${new Date(r).toUTCString()}`),wt.isString(a)&&m.push(`path=${a}`),wt.isString(o)&&m.push(`domain=${o}`),n===!0&&m.push("secure"),wt.isString(f)&&m.push(`SameSite=${f}`),document.cookie=m.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function UZ(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function $Z(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function XM(t,e,r){let a=!UZ(e);return t&&(a||r==!1)?$Z(t,e):e}const nR=t=>t instanceof Zi?{...t}:t;function Ep(t,e){e=e||{};const r={};function a(C,w,A,R){return wt.isPlainObject(C)&&wt.isPlainObject(w)?wt.merge.call({caseless:R},C,w):wt.isPlainObject(w)?wt.merge({},w):wt.isArray(w)?w.slice():w}function o(C,w,A,R){if(wt.isUndefined(w)){if(!wt.isUndefined(C))return a(void 0,C,A,R)}else return a(C,w,A,R)}function n(C,w){if(!wt.isUndefined(w))return a(void 0,w)}function f(C,w){if(wt.isUndefined(w)){if(!wt.isUndefined(C))return a(void 0,C)}else return a(void 0,w)}function m(C,w,A){if(A in e)return a(C,w);if(A in t)return a(void 0,C)}const y={url:n,method:n,data:n,baseURL:f,transformRequest:f,transformResponse:f,paramsSerializer:f,timeout:f,timeoutMessage:f,withCredentials:f,withXSRFToken:f,adapter:f,responseType:f,xsrfCookieName:f,xsrfHeaderName:f,onUploadProgress:f,onDownloadProgress:f,decompress:f,maxContentLength:f,maxBodyLength:f,beforeRedirect:f,transport:f,httpAgent:f,httpsAgent:f,cancelToken:f,socketPath:f,responseEncoding:f,validateStatus:m,headers:(C,w,A)=>o(nR(C),nR(w),A,!0)};return wt.forEach(Object.keys({...t,...e}),function(w){const A=y[w]||o,R=A(t[w],e[w],w);wt.isUndefined(R)&&A!==m||(r[w]=R)}),r}const JM=t=>{const e=Ep({},t);let{data:r,withXSRFToken:a,xsrfHeaderName:o,xsrfCookieName:n,headers:f,auth:m}=e;if(e.headers=f=Zi.from(f),e.url=GM(XM(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),m&&f.set("Authorization","Basic "+btoa((m.username||"")+":"+(m.password?unescape(encodeURIComponent(m.password)):""))),wt.isFormData(r)){if(ni.hasStandardBrowserEnv||ni.hasStandardBrowserWebWorkerEnv)f.setContentType(void 0);else if(wt.isFunction(r.getHeaders)){const y=r.getHeaders(),C=["content-type","content-length"];Object.entries(y).forEach(([w,A])=>{C.includes(w.toLowerCase())&&f.set(w,A)})}}if(ni.hasStandardBrowserEnv&&(a&&wt.isFunction(a)&&(a=a(e)),a||a!==!1&&BZ(e.url))){const y=o&&n&&zZ.read(n);y&&f.set(o,y)}return e},HZ=typeof XMLHttpRequest<"u",WZ=HZ&&function(t){return new Promise(function(r,a){const o=JM(t);let n=o.data;const f=Zi.from(o.headers).normalize();let{responseType:m,onUploadProgress:y,onDownloadProgress:C}=o,w,A,R,I,M;function F(){I&&I(),M&&M(),o.cancelToken&&o.cancelToken.unsubscribe(w),o.signal&&o.signal.removeEventListener("abort",w)}let O=new XMLHttpRequest;O.open(o.method.toUpperCase(),o.url,!0),O.timeout=o.timeout;function j(){if(!O)return;const H=Zi.from("getAllResponseHeaders"in O&&O.getAllResponseHeaders()),W={data:!m||m==="text"||m==="json"?O.responseText:O.response,status:O.status,statusText:O.statusText,headers:H,config:t,request:O};QM(function(ee){r(ee),F()},function(ee){a(ee),F()},W),O=null}"onloadend"in O?O.onloadend=j:O.onreadystatechange=function(){!O||O.readyState!==4||O.status===0&&!(O.responseURL&&O.responseURL.indexOf("file:")===0)||setTimeout(j)},O.onabort=function(){O&&(a(new Mr("Request aborted",Mr.ECONNABORTED,t,O)),O=null)},O.onerror=function(K){const W=K&&K.message?K.message:"Network Error",X=new Mr(W,Mr.ERR_NETWORK,t,O);X.event=K||null,a(X),O=null},O.ontimeout=function(){let K=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const W=o.transitional||KM;o.timeoutErrorMessage&&(K=o.timeoutErrorMessage),a(new Mr(K,W.clarifyTimeoutError?Mr.ETIMEDOUT:Mr.ECONNABORTED,t,O)),O=null},n===void 0&&f.setContentType(null),"setRequestHeader"in O&&wt.forEach(f.toJSON(),function(K,W){O.setRequestHeader(W,K)}),wt.isUndefined(o.withCredentials)||(O.withCredentials=!!o.withCredentials),m&&m!=="json"&&(O.responseType=o.responseType),C&&([R,M]=Q2(C,!0),O.addEventListener("progress",R)),y&&O.upload&&([A,I]=Q2(y),O.upload.addEventListener("progress",A),O.upload.addEventListener("loadend",I)),(o.cancelToken||o.signal)&&(w=H=>{O&&(a(!H||H.type?new bg(null,t,O):H),O.abort(),O=null)},o.cancelToken&&o.cancelToken.subscribe(w),o.signal&&(o.signal.aborted?w():o.signal.addEventListener("abort",w)));const U=NZ(o.url);if(U&&ni.protocols.indexOf(U)===-1){a(new Mr("Unsupported protocol "+U+":",Mr.ERR_BAD_REQUEST,t));return}O.send(n||null)})},VZ=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let a=new AbortController,o;const n=function(C){if(!o){o=!0,m();const w=C instanceof Error?C:this.reason;a.abort(w instanceof Mr?w:new bg(w instanceof Error?w.message:w))}};let f=e&&setTimeout(()=>{f=null,n(new Mr(`timeout ${e} of ms exceeded`,Mr.ETIMEDOUT))},e);const m=()=>{t&&(f&&clearTimeout(f),f=null,t.forEach(C=>{C.unsubscribe?C.unsubscribe(n):C.removeEventListener("abort",n)}),t=null)};t.forEach(C=>C.addEventListener("abort",n));const{signal:y}=a;return y.unsubscribe=()=>wt.asap(m),y}},GZ=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let a=0,o;for(;a<r;)o=a+e,yield t.slice(a,o),a=o},KZ=async function*(t,e){for await(const r of YZ(t))yield*GZ(r,e)},YZ=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:a}=await e.read();if(r)break;yield a}}finally{await e.cancel()}},rR=(t,e,r,a)=>{const o=KZ(t,e);let n=0,f,m=y=>{f||(f=!0,a&&a(y))};return new ReadableStream({async pull(y){try{const{done:C,value:w}=await o.next();if(C){m(),y.close();return}let A=w.byteLength;if(r){let R=n+=A;r(R)}y.enqueue(new Uint8Array(w))}catch(C){throw m(C),C}},cancel(y){return m(y),o.return()}},{highWaterMark:2})},oR=64*1024,{isFunction:Lx}=wt,qZ=(({Request:t,Response:e})=>({Request:t,Response:e}))(wt.global),{ReadableStream:aR,TextEncoder:sR}=wt.global,iR=(t,...e)=>{try{return!!t(...e)}catch{return!1}},QZ=t=>{t=wt.merge.call({skipUndefined:!0},qZ,t);const{fetch:e,Request:r,Response:a}=t,o=e?Lx(e):typeof fetch=="function",n=Lx(r),f=Lx(a);if(!o)return!1;const m=o&&Lx(aR),y=o&&(typeof sR=="function"?(M=>F=>M.encode(F))(new sR):async M=>new Uint8Array(await new r(M).arrayBuffer())),C=n&&m&&iR(()=>{let M=!1;const F=new r(ni.origin,{body:new aR,method:"POST",get duplex(){return M=!0,"half"}}).headers.has("Content-Type");return M&&!F}),w=f&&m&&iR(()=>wt.isReadableStream(new a("").body)),A={stream:w&&(M=>M.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(M=>{!A[M]&&(A[M]=(F,O)=>{let j=F&&F[M];if(j)return j.call(F);throw new Mr(`Response type '${M}' is not supported`,Mr.ERR_NOT_SUPPORT,O)})});const R=async M=>{if(M==null)return 0;if(wt.isBlob(M))return M.size;if(wt.isSpecCompliantForm(M))return(await new r(ni.origin,{method:"POST",body:M}).arrayBuffer()).byteLength;if(wt.isArrayBufferView(M)||wt.isArrayBuffer(M))return M.byteLength;if(wt.isURLSearchParams(M)&&(M=M+""),wt.isString(M))return(await y(M)).byteLength},I=async(M,F)=>{const O=wt.toFiniteNumber(M.getContentLength());return O??R(F)};return async M=>{let{url:F,method:O,data:j,signal:U,cancelToken:H,timeout:K,onDownloadProgress:W,onUploadProgress:X,responseType:ee,headers:ie,withCredentials:de="same-origin",fetchOptions:le}=JM(M),oe=e||fetch;ee=ee?(ee+"").toLowerCase():"text";let N=VZ([U,H&&H.toAbortSignal()],K),ce=null;const ne=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let Se;try{if(X&&C&&O!=="get"&&O!=="head"&&(Se=await I(ie,j))!==0){let V=new r(F,{method:"POST",body:j,duplex:"half"}),ue;if(wt.isFormData(j)&&(ue=V.headers.get("content-type"))&&ie.setContentType(ue),V.body){const[Ee,Ie]=eR(Se,Q2(tR(X)));j=rR(V.body,oR,Ee,Ie)}}wt.isString(de)||(de=de?"include":"omit");const se=n&&"credentials"in r.prototype,ye={...le,signal:N,method:O.toUpperCase(),headers:ie.normalize().toJSON(),body:j,duplex:"half",credentials:se?de:void 0};ce=n&&new r(F,ye);let ze=await(n?oe(ce,le):oe(F,ye));const Re=w&&(ee==="stream"||ee==="response");if(w&&(W||Re&&ne)){const V={};["status","statusText","headers"].forEach(ae=>{V[ae]=ze[ae]});const ue=wt.toFiniteNumber(ze.headers.get("content-length")),[Ee,Ie]=W&&eR(ue,Q2(tR(W),!0))||[];ze=new a(rR(ze.body,oR,Ee,()=>{Ie&&Ie(),ne&&ne()}),V)}ee=ee||"text";let ve=await A[wt.findKey(A,ee)||"text"](ze,M);return!Re&&ne&&ne(),await new Promise((V,ue)=>{QM(V,ue,{data:ve,headers:Zi.from(ze.headers),status:ze.status,statusText:ze.statusText,config:M,request:ce})})}catch(se){throw ne&&ne(),se&&se.name==="TypeError"&&/Load failed|fetch/i.test(se.message)?Object.assign(new Mr("Network Error",Mr.ERR_NETWORK,M,ce),{cause:se.cause||se}):Mr.from(se,se&&se.code,M,ce)}}},XZ=new Map,ZM=t=>{let e=t&&t.env||{};const{fetch:r,Request:a,Response:o}=e,n=[a,o,r];let f=n.length,m=f,y,C,w=XZ;for(;m--;)y=n[m],C=w.get(y),C===void 0&&w.set(y,C=m?new Map:QZ(e)),w=C;return C};ZM();const ik={http:pZ,xhr:WZ,fetch:{get:ZM}};wt.forEach(ik,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const lR=t=>`- ${t}`,JZ=t=>wt.isFunction(t)||t===null||t===!1;function ZZ(t,e){t=wt.isArray(t)?t:[t];const{length:r}=t;let a,o;const n={};for(let f=0;f<r;f++){a=t[f];let m;if(o=a,!JZ(a)&&(o=ik[(m=String(a)).toLowerCase()],o===void 0))throw new Mr(`Unknown adapter '${m}'`);if(o&&(wt.isFunction(o)||(o=o.get(e))))break;n[m||"#"+f]=o}if(!o){const f=Object.entries(n).map(([y,C])=>`adapter ${y} `+(C===!1?"is not supported by the environment":"is not available in the build"));let m=r?f.length>1?`since :
`+f.map(lR).join(`
`):" "+lR(f[0]):"as no adapter specified";throw new Mr("There is no suitable adapter to dispatch the request "+m,"ERR_NOT_SUPPORT")}return o}const e_={getAdapter:ZZ,adapters:ik};function Aw(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new bg(null,t)}function cR(t){return Aw(t),t.headers=Zi.from(t.headers),t.data=Tw.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),e_.getAdapter(t.adapter||Pb.adapter,t)(t).then(function(a){return Aw(t),a.data=Tw.call(t,t.transformResponse,a),a.headers=Zi.from(a.headers),a},function(a){return qM(a)||(Aw(t),a&&a.response&&(a.response.data=Tw.call(t,t.transformResponse,a.response),a.response.headers=Zi.from(a.response.headers))),Promise.reject(a)})}const t_="1.13.2",dS={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{dS[t]=function(a){return typeof a===t||"a"+(e<1?"n ":" ")+t}});const uR={};dS.transitional=function(e,r,a){function o(n,f){return"[Axios v"+t_+"] Transitional option '"+n+"'"+f+(a?". "+a:"")}return(n,f,m)=>{if(e===!1)throw new Mr(o(f," has been removed"+(r?" in "+r:"")),Mr.ERR_DEPRECATED);return r&&!uR[f]&&(uR[f]=!0,console.warn(o(f," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(n,f,m):!0}};dS.spelling=function(e){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${e}`),!0)};function eee(t,e,r){if(typeof t!="object")throw new Mr("options must be an object",Mr.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let o=a.length;for(;o-- >0;){const n=a[o],f=e[n];if(f){const m=t[n],y=m===void 0||f(m,n,t);if(y!==!0)throw new Mr("option "+n+" must be "+y,Mr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Mr("Unknown option "+n,Mr.ERR_BAD_OPTION)}}const l2={assertOptions:eee,validators:dS},fu=l2.validators;let pp=class{constructor(e){this.defaults=e||{},this.interceptors={request:new J5,response:new J5}}async request(e,r){try{return await this._request(e,r)}catch(a){if(a instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const n=o.stack?o.stack.replace(/^.+\n/,""):"";try{a.stack?n&&!String(a.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+n):a.stack=n}catch{}}throw a}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Ep(this.defaults,r);const{transitional:a,paramsSerializer:o,headers:n}=r;a!==void 0&&l2.assertOptions(a,{silentJSONParsing:fu.transitional(fu.boolean),forcedJSONParsing:fu.transitional(fu.boolean),clarifyTimeoutError:fu.transitional(fu.boolean)},!1),o!=null&&(wt.isFunction(o)?r.paramsSerializer={serialize:o}:l2.assertOptions(o,{encode:fu.function,serialize:fu.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),l2.assertOptions(r,{baseUrl:fu.spelling("baseURL"),withXsrfToken:fu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let f=n&&wt.merge(n.common,n[r.method]);n&&wt.forEach(["delete","get","head","post","put","patch","common"],M=>{delete n[M]}),r.headers=Zi.concat(f,n);const m=[];let y=!0;this.interceptors.request.forEach(function(F){typeof F.runWhen=="function"&&F.runWhen(r)===!1||(y=y&&F.synchronous,m.unshift(F.fulfilled,F.rejected))});const C=[];this.interceptors.response.forEach(function(F){C.push(F.fulfilled,F.rejected)});let w,A=0,R;if(!y){const M=[cR.bind(this),void 0];for(M.unshift(...m),M.push(...C),R=M.length,w=Promise.resolve(r);A<R;)w=w.then(M[A++],M[A++]);return w}R=m.length;let I=r;for(;A<R;){const M=m[A++],F=m[A++];try{I=M(I)}catch(O){F.call(this,O);break}}try{w=cR.call(this,I)}catch(M){return Promise.reject(M)}for(A=0,R=C.length;A<R;)w=w.then(C[A++],C[A++]);return w}getUri(e){e=Ep(this.defaults,e);const r=XM(e.baseURL,e.url,e.allowAbsoluteUrls);return GM(r,e.params,e.paramsSerializer)}};wt.forEach(["delete","get","head","options"],function(e){pp.prototype[e]=function(r,a){return this.request(Ep(a||{},{method:e,url:r,data:(a||{}).data}))}});wt.forEach(["post","put","patch"],function(e){function r(a){return function(n,f,m){return this.request(Ep(m||{},{method:e,headers:a?{"Content-Type":"multipart/form-data"}:{},url:n,data:f}))}}pp.prototype[e]=r(),pp.prototype[e+"Form"]=r(!0)});let tee=class n_{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(n){r=n});const a=this;this.promise.then(o=>{if(!a._listeners)return;let n=a._listeners.length;for(;n-- >0;)a._listeners[n](o);a._listeners=null}),this.promise.then=o=>{let n;const f=new Promise(m=>{a.subscribe(m),n=m}).then(o);return f.cancel=function(){a.unsubscribe(n)},f},e(function(n,f,m){a.reason||(a.reason=new bg(n,f,m),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=a=>{e.abort(a)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new n_(function(o){e=o}),cancel:e}}};function nee(t){return function(r){return t.apply(null,r)}}function ree(t){return wt.isObject(t)&&t.isAxiosError===!0}const LT={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(LT).forEach(([t,e])=>{LT[e]=t});function r_(t){const e=new pp(t),r=OM(pp.prototype.request,e);return wt.extend(r,pp.prototype,e,{allOwnKeys:!0}),wt.extend(r,e,null,{allOwnKeys:!0}),r.create=function(o){return r_(Ep(t,o))},r}const Za=r_(Pb);Za.Axios=pp;Za.CanceledError=bg;Za.CancelToken=tee;Za.isCancel=qM;Za.VERSION=t_;Za.toFormData=uS;Za.AxiosError=Mr;Za.Cancel=Za.CanceledError;Za.all=function(e){return Promise.all(e)};Za.spread=nee;Za.isAxiosError=ree;Za.mergeConfig=Ep;Za.AxiosHeaders=Zi;Za.formToJSON=t=>YM(wt.isHTMLForm(t)?new FormData(t):t);Za.getAdapter=e_.getAdapter;Za.HttpStatusCode=LT;Za.default=Za;const{Axios:Hie,AxiosError:Wie,CanceledError:Vie,isCancel:Gie,CancelToken:Kie,VERSION:Yie,all:qie,Cancel:Qie,isAxiosError:Xie,spread:Jie,toFormData:Zie,AxiosHeaders:ele,HttpStatusCode:tle,formToJSON:nle,getAdapter:rle,mergeConfig:ole}=Za,Xn=Za.create({baseURL:"https://stalo-h5d6djg6duahfkc9.canadacentral-01.azurewebsites.net/api",headers:{"Content-Type":"application/json"}});Xn.interceptors.request.use(async t=>{try{const e=await Mp(),r=e.getAllAccounts();if(r.length>0){const a={account:r[0],scopes:aS};try{const o=await e.acquireTokenSilent(a);t.headers.Authorization=`Bearer ${o.idToken}`}catch{console.warn("Silent token acquisition failed, request will proceed without token")}}}catch{console.warn("Could not acquire token for API request")}return t},t=>Promise.reject(t));Xn.interceptors.response.use(t=>t,async t=>{const e=t.config;if(t.response?.status===401&&!e._retry){e._retry=!0;try{const r=await Mp(),a=r.getAllAccounts();if(a.length>0){const o={account:a[0],scopes:aS,forceRefresh:!0};try{const n=await r.acquireTokenSilent(o);return e.headers.Authorization=`Bearer ${n.accessToken}`,Xn(e)}catch{console.error("Token refresh failed, user needs to re-login"),window.dispatchEvent(new CustomEvent("auth:token-expired"))}}}catch{console.error("Error handling 401 response")}}return t.response?.status===403&&(console.error("Access denied - insufficient permissions"),window.dispatchEvent(new CustomEvent("auth:permission-denied",{detail:t.response?.data}))),Promise.reject(t)});const oee=async t=>{const e=new URLSearchParams;t?.startMonth&&e.append("startMonth",t.startMonth),t?.endMonth&&e.append("endMonth",t.endMonth);const r=e.toString(),a=r?`/positions/combined?${r}`:"/positions/combined";return(await Xn.get(a)).data},lk=async()=>(await Xn.get("/projects")).data,aee=async t=>(await Xn.post("/projects",t)).data,see=async(t,e)=>(await Xn.put(`/projects/${t}`,e)).data,iee=async t=>{await Xn.delete(`/projects/${t}`)},o_=async()=>(await Xn.get("/resources")).data,lee=async()=>(await Xn.get("/allocations")).data,a_=async t=>(await Xn.post("/allocations",t)).data,cee=async t=>(await Xn.post("/allocations",t)).data,BT=async t=>{await Xn.delete(`/allocations/${t}`)},fS=async()=>(await Xn.get("/system-users")).data,uee=async(t,e)=>(await Xn.put(`/system-users/${t}`,e)).data,s_=async t=>(await Xn.post("/system-users",t)).data,dee=async t=>{await Xn.delete(`/system-users/${t}`)},ck=async()=>(await Xn.get("/entities")).data,fee=async t=>(await Xn.post("/entities",t)).data,hee=async(t,e)=>(await Xn.put(`/entities/${t}`,e)).data,pee=async t=>{await Xn.delete(`/entities/${t}`)},mee=async()=>(await Xn.get("/positions")).data,gee=async()=>(await Xn.post("/positions/validate-allocations")).data,yee=async t=>(await Xn.post("/positions",t)).data,Ew=async(t,e)=>(await Xn.put(`/positions/${t}`,e)).data,bee=async t=>{console.log("checkPositionDeletion called for id:",t);const e=await Xn.delete(`/positions/${t}`);return console.log("checkPositionDeletion response:",e.data),e.data},vee=async(t,e=!1)=>{await Xn.delete(`/positions/${t}`,{params:{confirm:e?"true":"false"}})},xee=async t=>(await Xn.post("/allocations/validate-positions",{monthYears:t})).data,Cee=async t=>(await Xn.post("/resources",t)).data,See=async(t,e)=>(await Xn.put(`/resources/${t}`,e)).data,wee=async t=>{await Xn.delete(`/resources/${t}`)},Tee=async t=>(await Xn.get("/payroll/projects",{params:{month:t}})).data,Aee=async t=>(await Xn.get("/payroll",{params:{month:t}})).data,Eee=async t=>(await Xn.get("/payroll/all",{params:{month:t}})).data,kee=async t=>(await Xn.get("/payroll/allocations",{params:{month:t}})).data,dR=async t=>(await Xn.post("/payroll",t)).data,Dee=async(t,e)=>(await Xn.patch("/payroll/lock-month",{month:t,locked:e})).data,Ree=async t=>(await Xn.get("/bc/posted-sales-invoices",{params:t})).data,i_=E.createContext(void 0),Iee=({children:t})=>{const[e,r]=E.useState(!1),[a,o]=E.useState(!0),[n,f]=E.useState(null),[m,y]=E.useState(null),[C,w]=E.useState(""),[A,R]=E.useState(""),I=async(U,H)=>{try{const X=Date.now();for(;Date.now()-X<3e4;)try{if(!(await fS()).find(de=>de.EmailAddress.toLowerCase()===H.toLowerCase())){const de={Name:U,EmailAddress:H,StartDate:new Date().toISOString().split("T")[0],EndDate:null,Active:!0,Role:""};await s_(de),console.log(` New user added to system: ${U} (${H})`)}return}catch{const ie=Math.round((Date.now()-X)/1e3);console.log(` Waiting for database connection... (${ie}s elapsed)`),await new Promise(de=>setTimeout(de,2e3))}console.error(" Database connection timeout. User can still log in, but role assignment may be delayed")}catch(K){console.error("Error ensuring user in database:",K)}};E.useEffect(()=>{let U=!0,H=!1;return(async()=>{if(H){console.log("Initialization already in progress, skipping duplicate call");return}H=!0;try{if(await _M(),!U){console.log("Component unmounted during MSAL init, skipping state updates");return}const W=await wJ();if(!U)return;if(W&&W.account){const X=W.account.name||"",ee=W.account.username||"";r(!0),y(W.account),w(X),R(ee),await I(X,ee),console.log(` Redirect login completed: ${X} (${ee})`)}else{const X=await EJ(),ee=await sS();if(!U)return;if(r(X),y(ee),ee){const ie=await kJ(),de=await DJ();w(ie),R(de),await I(ie,de),console.log(` User auto-logged in: ${ie} (${de})`)}}}catch(W){console.error("MSAL initialization error:",W),U&&f(`Auth setup: ${W.message||"Configuration missing"}`)}finally{U&&o(!1)}})(),()=>{U=!1}},[]);const j={isAuthenticated:e,isLoading:a,error:n,user:m,userDisplayName:C,userEmail:A,login:async()=>{try{f(null),o(!0),!0&&(console.log("Using redirect login flow for production..."),await TJ())}catch(U){if(U.errorCode==="user_cancelled"||U.errorCode==="user_cancelled_login"){console.log("User cancelled login"),o(!1);return}const H=U.message||JSON.stringify(U);H.includes("Client ID")||H.includes("not configured")||H.includes("AADB2C")?f(" OAuth2 Configuration Issue: Please fill in VITE_MSAL_CLIENT_ID and VITE_MSAL_TENANT_ID in frontend/.env.local, then restart the dev server (npm run dev)"):f(` Login failed: ${U.message||"Unknown error"}`),console.error("Login error details:",U),o(!1)}},logout:async()=>{try{f(null),await AJ(),r(!1),y(null),w(""),R(""),console.log(" Logout successful - cache cleared, fresh login required")}catch(U){r(!1),y(null),w(""),R(""),f(U.message||"Logout failed"),console.error("Logout error:",U)}},clearError:()=>f(null)};return d.jsx(i_.Provider,{value:j,children:t})},_p=()=>{const t=E.useContext(i_);if(t===void 0)throw new Error("useAuth must be used within AuthProvider");return t},fR="sinan.mecit@arkgroupdmcc.com",l_=E.createContext(void 0),Pee=({children:t})=>{const{isAuthenticated:e,userEmail:r,isLoading:a}=_p(),[o,n]=E.useState(null),[f,m]=E.useState(null),[y,C]=E.useState(null),[w,A]=E.useState(!0),R=async ee=>{if(!e||!r){n(null),C(null),A(!1);return}if(r.toLowerCase()===fR.toLowerCase()){n("Admin"),A(!1);return}try{A(!0);const ie=3e4,de=2e3,le=Date.now();for(;Date.now()-le<ie;){if(ee.aborted){console.log("Permission fetch cancelled");return}try{const N=(await fS()).find(ce=>ce.EmailAddress.toLowerCase()===r.toLowerCase());if(ee.aborted){console.log("Permission fetch cancelled");return}if(N){C(N);const ce=N.Role?.trim();n(ce&&ce!==""?ce:null)}else C(null),n(null);A(!1);return}catch{const N=Math.round((Date.now()-le)/1e3);console.log(` Waiting for database connection... (${N}s elapsed)`),await new Promise(ce=>setTimeout(ce,de))}}console.error(" Database connection timeout. Unable to fetch user permissions"),C(null),n(null)}catch(ie){console.error("Error fetching user permissions:",ie),C(null),n(null)}finally{ee.aborted||A(!1)}};E.useEffect(()=>{if(a)return;const ee=new AbortController;return R(ee.signal),()=>{ee.abort()}},[e,r,a]);const I=r?.toLowerCase()===fR.toLowerCase(),M=I&&f?f:o,F=!!M,O=M==="Admin",j=M==="BudgetManager",U=M==="Viewer",H=M==="Editor",X={userRole:M,systemUser:y,isLoadingPermissions:w,hasAccess:F,isAdmin:O,isBudgetManager:j,isViewer:U,isEditor:H,canAccessSettings:()=>O,getPagePermissions:ee=>{const ie={canView:!1,canEdit:!1,canDelete:!1,canExport:!1};if(!F)return ie;if(O)return{canView:!0,canEdit:!0,canDelete:!0,canExport:!0};if(j)switch(ee.toLowerCase()){case"scheduled-records":case"scheduledrecords":return{canView:!0,canEdit:!0,canDelete:!0,canExport:!0};case"glidepath":return{canView:!0,canEdit:!0,canDelete:!0,canExport:!0};case"payments":return{canView:!0,canEdit:!1,canDelete:!1,canExport:!0};case"report":case"reports":return{canView:!0,canEdit:!1,canDelete:!1,canExport:!0};case"home":case"projects":case"resources":case"positions":case"gantt":case"payroll":return{canView:!0,canEdit:!1,canDelete:!1,canExport:!1};case"settings":return ie;default:return{canView:!0,canEdit:!1,canDelete:!1,canExport:!1}}return U?ee.toLowerCase()==="home"||ee.toLowerCase()==="gantt"?{canView:!0,canEdit:!1,canDelete:!1,canExport:!1}:(ee.toLowerCase()==="payments",ie):H?ee.toLowerCase()==="settings"?ie:{canView:!0,canEdit:!0,canDelete:!0,canExport:!0}:ie},refreshPermissions:async()=>{const ee=new AbortController;await R(ee.signal)},viewingAsRole:f,setViewingAsRole:m,isSuperAdmin:I,actualRole:o};return d.jsx(l_.Provider,{value:X,children:t})},Gf=()=>{const t=E.useContext(l_);if(t===void 0)throw new Error("usePermissions must be used within PermissionsProvider");return t};function Ic({children:t,page:e}){const{isAuthenticated:r,isLoading:a}=_p(),{hasAccess:o,isLoadingPermissions:n,getPagePermissions:f}=Gf();return a||n?d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:[d.jsx(Ri,{}),d.jsx(We,{sx:{mt:2},children:"Loading..."})]}):r?!n&&!o?d.jsx(hw,{to:"/no-access",replace:!0}):e&&!f(e).canView?d.jsx(hw,{to:"/permission-denied",replace:!0}):d.jsx(d.Fragment,{children:t}):d.jsx(hw,{to:"/login",replace:!0})}function Mee(){const{isAuthenticated:t,isLoading:e,error:r,login:a,clearError:o}=_p(),n=Ab();E.useEffect(()=>{t&&n("/")},[t,n]);const f=async()=>{await a()};return e?d.jsx(nT,{maxWidth:"sm",children:d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:[d.jsx(Ri,{}),d.jsx(We,{sx:{mt:2},children:"Loading..."})]})}):d.jsx(nT,{maxWidth:"sm",children:d.jsx(_e,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:d.jsxs(ua,{elevation:3,sx:{p:4,width:"100%",textAlign:"center"},children:[d.jsx(We,{variant:"h4",gutterBottom:!0,children:"Welcome to Stalo"}),d.jsx(We,{variant:"body1",color:"text.secondary",sx:{mb:4},children:"Sign in with your Microsoft account to continue"}),r&&d.jsx(Hs,{severity:"error",onClose:o,sx:{mb:3,textAlign:"left"},children:r}),d.jsx(Un,{variant:"contained",size:"large",startIcon:d.jsx(zH,{}),onClick:f,sx:{py:1.5,px:4},fullWidth:!0,children:"Sign in with Microsoft"}),d.jsx(We,{variant:"caption",color:"text.secondary",sx:{mt:3,display:"block"},children:"You must have a valid Microsoft account to access this application"})]})})})}var c2={exports:{}},_ee=c2.exports,hR;function Oee(){return hR||(hR=1,(function(t,e){(function(r,a){a()})(_ee,function(){function r(C,w){return typeof w>"u"?w={autoBom:!1}:typeof w!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),w={autoBom:!w}),w.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(C.type)?new Blob(["\uFEFF",C],{type:C.type}):C}function a(C,w,A){var R=new XMLHttpRequest;R.open("GET",C),R.responseType="blob",R.onload=function(){y(R.response,w,A)},R.onerror=function(){console.error("could not download file")},R.send()}function o(C){var w=new XMLHttpRequest;w.open("HEAD",C,!1);try{w.send()}catch{}return 200<=w.status&&299>=w.status}function n(C){try{C.dispatchEvent(new MouseEvent("click"))}catch{var w=document.createEvent("MouseEvents");w.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),C.dispatchEvent(w)}}var f=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof px=="object"&&px.global===px?px:void 0,m=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),y=f.saveAs||(typeof window!="object"||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!m?function(C,w,A){var R=f.URL||f.webkitURL,I=document.createElement("a");w=w||C.name||"download",I.download=w,I.rel="noopener",typeof C=="string"?(I.href=C,I.origin===location.origin?n(I):o(I.href)?a(C,w,A):n(I,I.target="_blank")):(I.href=R.createObjectURL(C),setTimeout(function(){R.revokeObjectURL(I.href)},4e4),setTimeout(function(){n(I)},0))}:"msSaveOrOpenBlob"in navigator?function(C,w,A){if(w=w||C.name||"download",typeof C!="string")navigator.msSaveOrOpenBlob(r(C,A),w);else if(o(C))a(C,w,A);else{var R=document.createElement("a");R.href=C,R.target="_blank",setTimeout(function(){n(R)})}}:function(C,w,A,R){if(R=R||open("","_blank"),R&&(R.document.title=R.document.body.innerText="downloading..."),typeof C=="string")return a(C,w,A);var I=C.type==="application/octet-stream",M=/constructor/i.test(f.HTMLElement)||f.safari,F=/CriOS\/[\d]+/.test(navigator.userAgent);if((F||I&&M||m)&&typeof FileReader<"u"){var O=new FileReader;O.onloadend=function(){var H=O.result;H=F?H:H.replace(/^data:[^;]*;/,"data:attachment/file;"),R?R.location.href=H:location=H,R=null},O.readAsDataURL(C)}else{var j=f.URL||f.webkitURL,U=j.createObjectURL(C);R?R.location=U:location.href=U,R=null,setTimeout(function(){j.revokeObjectURL(U)},4e4)}});f.saveAs=y.saveAs=y,t.exports=y})})(c2)),c2.exports}var X2=Oee();const hS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function vg(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function uk(t){return"nodeType"in t}function Mi(t){var e,r;return t?vg(t)?t:uk(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function dk(t){const{Document:e}=Mi(t);return t instanceof e}function Mb(t){return vg(t)?!1:t instanceof Mi(t).HTMLElement}function c_(t){return t instanceof Mi(t).SVGElement}function xg(t){return t?vg(t)?t.document:uk(t)?dk(t)?t:Mb(t)||c_(t)?t.ownerDocument:document:document:document}const Ed=hS?E.useLayoutEffect:E.useEffect;function pS(t){const e=E.useRef(t);return Ed(()=>{e.current=t}),E.useCallback(function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e.current==null?void 0:e.current(...a)},[])}function Fee(){const t=E.useRef(null),e=E.useCallback((a,o)=>{t.current=setInterval(a,o)},[]),r=E.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function lb(t,e){e===void 0&&(e=[t]);const r=E.useRef(t);return Ed(()=>{r.current!==t&&(r.current=t)},e),r}function _b(t,e){const r=E.useRef();return E.useMemo(()=>{const a=t(r.current);return r.current=a,a},[...e])}function J2(t){const e=pS(t),r=E.useRef(null),a=E.useCallback(o=>{o!==r.current&&e?.(o,r.current),r.current=o},[]);return[r,a]}function Z2(t){const e=E.useRef();return E.useEffect(()=>{e.current=t},[t]),e.current}let kw={};function mS(t,e){return E.useMemo(()=>{if(e)return e;const r=kw[t]==null?0:kw[t]+1;return kw[t]=r,t+"-"+r},[t,e])}function u_(t){return function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return a.reduce((n,f)=>{const m=Object.entries(f);for(const[y,C]of m){const w=n[y];w!=null&&(n[y]=w+t*C)}return n},{...e})}}const $m=u_(1),eC=u_(-1);function Nee(t){return"clientX"in t&&"clientY"in t}function fk(t){if(!t)return!1;const{KeyboardEvent:e}=Mi(t.target);return e&&t instanceof e}function jee(t){if(!t)return!1;const{TouchEvent:e}=Mi(t.target);return e&&t instanceof e}function tC(t){if(jee(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return Nee(t)?{x:t.clientX,y:t.clientY}:null}const cb=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:r}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:r}=t;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(t){if(t)return[cb.Translate.toString(t),cb.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:r,easing:a}=t;return e+" "+r+"ms "+a}}}),pR="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Lee(t){return t.matches(pR)?t:t.querySelector(pR)}const Bee={display:"none"};function zee(t){let{id:e,value:r}=t;return Jr.createElement("div",{id:e,style:Bee},r)}function Uee(t){let{id:e,announcement:r,ariaLiveType:a="assertive"}=t;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Jr.createElement("div",{id:e,style:o,role:"status","aria-live":a,"aria-atomic":!0},r)}function $ee(){const[t,e]=E.useState("");return{announce:E.useCallback(a=>{a!=null&&e(a)},[]),announcement:t}}const d_=E.createContext(null);function Hee(t){const e=E.useContext(d_);E.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function Wee(){const[t]=E.useState(()=>new Set),e=E.useCallback(a=>(t.add(a),()=>t.delete(a)),[t]);return[E.useCallback(a=>{let{type:o,event:n}=a;t.forEach(f=>{var m;return(m=f[o])==null?void 0:m.call(f,n)})},[t]),e]}const Vee={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Gee={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function Kee(t){let{announcements:e=Gee,container:r,hiddenTextDescribedById:a,screenReaderInstructions:o=Vee}=t;const{announce:n,announcement:f}=$ee(),m=mS("DndLiveRegion"),[y,C]=E.useState(!1);if(E.useEffect(()=>{C(!0)},[]),Hee(E.useMemo(()=>({onDragStart(A){let{active:R}=A;n(e.onDragStart({active:R}))},onDragMove(A){let{active:R,over:I}=A;e.onDragMove&&n(e.onDragMove({active:R,over:I}))},onDragOver(A){let{active:R,over:I}=A;n(e.onDragOver({active:R,over:I}))},onDragEnd(A){let{active:R,over:I}=A;n(e.onDragEnd({active:R,over:I}))},onDragCancel(A){let{active:R,over:I}=A;n(e.onDragCancel({active:R,over:I}))}}),[n,e])),!y)return null;const w=Jr.createElement(Jr.Fragment,null,Jr.createElement(zee,{id:a,value:o.draggable}),Jr.createElement(Uee,{id:m,announcement:f}));return r?sp.createPortal(w,r):w}var ms;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(ms||(ms={}));function nC(){}function Yee(t,e){return E.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function qee(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return E.useMemo(()=>[...e].filter(a=>a!=null),[...e])}const Lc=Object.freeze({x:0,y:0});function Qee(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Xee(t,e){const r=tC(t);if(!r)return"0 0";const a={x:(r.x-e.left)/e.width*100,y:(r.y-e.top)/e.height*100};return a.x+"% "+a.y+"%"}function Jee(t,e){let{data:{value:r}}=t,{data:{value:a}}=e;return r-a}function Zee(t,e){let{data:{value:r}}=t,{data:{value:a}}=e;return a-r}function ete(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function mR(t,e,r){return e===void 0&&(e=t.left),r===void 0&&(r=t.top),{x:e+t.width*.5,y:r+t.height*.5}}const tte=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:a}=t;const o=mR(e,e.left,e.top),n=[];for(const f of a){const{id:m}=f,y=r.get(m);if(y){const C=Qee(mR(y),o);n.push({id:m,data:{droppableContainer:f,value:C}})}}return n.sort(Jee)};function nte(t,e){const r=Math.max(e.top,t.top),a=Math.max(e.left,t.left),o=Math.min(e.left+e.width,t.left+t.width),n=Math.min(e.top+e.height,t.top+t.height),f=o-a,m=n-r;if(a<o&&r<n){const y=e.width*e.height,C=t.width*t.height,w=f*m,A=w/(y+C-w);return Number(A.toFixed(4))}return 0}const rte=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:a}=t;const o=[];for(const n of a){const{id:f}=n,m=r.get(f);if(m){const y=nte(m,e);y>0&&o.push({id:f,data:{droppableContainer:n,value:y}})}}return o.sort(Zee)};function ote(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function f_(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:Lc}function ate(t){return function(r){for(var a=arguments.length,o=new Array(a>1?a-1:0),n=1;n<a;n++)o[n-1]=arguments[n];return o.reduce((f,m)=>({...f,top:f.top+t*m.y,bottom:f.bottom+t*m.y,left:f.left+t*m.x,right:f.right+t*m.x}),{...r})}}const ste=ate(1);function h_(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function ite(t,e,r){const a=h_(e);if(!a)return t;const{scaleX:o,scaleY:n,x:f,y:m}=a,y=t.left-f-(1-o)*parseFloat(r),C=t.top-m-(1-n)*parseFloat(r.slice(r.indexOf(" ")+1)),w=o?t.width/o:t.width,A=n?t.height/n:t.height;return{width:w,height:A,top:C,right:y+w,bottom:C+A,left:y}}const lte={ignoreTransform:!1};function Ob(t,e){e===void 0&&(e=lte);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:C,transformOrigin:w}=Mi(t).getComputedStyle(t);C&&(r=ite(r,C,w))}const{top:a,left:o,width:n,height:f,bottom:m,right:y}=r;return{top:a,left:o,width:n,height:f,bottom:m,right:y}}function gR(t){return Ob(t,{ignoreTransform:!0})}function cte(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function ute(t,e){return e===void 0&&(e=Mi(t).getComputedStyle(t)),e.position==="fixed"}function dte(t,e){e===void 0&&(e=Mi(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const n=e[o];return typeof n=="string"?r.test(n):!1})}function hk(t,e){const r=[];function a(o){if(e!=null&&r.length>=e||!o)return r;if(dk(o)&&o.scrollingElement!=null&&!r.includes(o.scrollingElement))return r.push(o.scrollingElement),r;if(!Mb(o)||c_(o)||r.includes(o))return r;const n=Mi(t).getComputedStyle(o);return o!==t&&dte(o,n)&&r.push(o),ute(o,n)?r:a(o.parentNode)}return t?a(t):r}function p_(t){const[e]=hk(t,1);return e??null}function Dw(t){return!hS||!t?null:vg(t)?t:uk(t)?dk(t)||t===xg(t).scrollingElement?window:Mb(t)?t:null:null}function m_(t){return vg(t)?t.scrollX:t.scrollLeft}function g_(t){return vg(t)?t.scrollY:t.scrollTop}function zT(t){return{x:m_(t),y:g_(t)}}var Es;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Es||(Es={}));function y_(t){return!hS||!t?!1:t===document.scrollingElement}function b_(t){const e={x:0,y:0},r=y_(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},a={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},o=t.scrollTop<=e.y,n=t.scrollLeft<=e.x,f=t.scrollTop>=a.y,m=t.scrollLeft>=a.x;return{isTop:o,isLeft:n,isBottom:f,isRight:m,maxScroll:a,minScroll:e}}const fte={x:.2,y:.2};function hte(t,e,r,a,o){let{top:n,left:f,right:m,bottom:y}=r;a===void 0&&(a=10),o===void 0&&(o=fte);const{isTop:C,isBottom:w,isLeft:A,isRight:R}=b_(t),I={x:0,y:0},M={x:0,y:0},F={height:e.height*o.y,width:e.width*o.x};return!C&&n<=e.top+F.height?(I.y=Es.Backward,M.y=a*Math.abs((e.top+F.height-n)/F.height)):!w&&y>=e.bottom-F.height&&(I.y=Es.Forward,M.y=a*Math.abs((e.bottom-F.height-y)/F.height)),!R&&m>=e.right-F.width?(I.x=Es.Forward,M.x=a*Math.abs((e.right-F.width-m)/F.width)):!A&&f<=e.left+F.width&&(I.x=Es.Backward,M.x=a*Math.abs((e.left+F.width-f)/F.width)),{direction:I,speed:M}}function pte(t){if(t===document.scrollingElement){const{innerWidth:n,innerHeight:f}=window;return{top:0,left:0,right:n,bottom:f,width:n,height:f}}const{top:e,left:r,right:a,bottom:o}=t.getBoundingClientRect();return{top:e,left:r,right:a,bottom:o,width:t.clientWidth,height:t.clientHeight}}function v_(t){return t.reduce((e,r)=>$m(e,zT(r)),Lc)}function mte(t){return t.reduce((e,r)=>e+m_(r),0)}function gte(t){return t.reduce((e,r)=>e+g_(r),0)}function x_(t,e){if(e===void 0&&(e=Ob),!t)return;const{top:r,left:a,bottom:o,right:n}=e(t);p_(t)&&(o<=0||n<=0||r>=window.innerHeight||a>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const yte=[["x",["left","right"],mte],["y",["top","bottom"],gte]];class pk{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const a=hk(r),o=v_(a);this.rect={...e},this.width=e.width,this.height=e.height;for(const[n,f,m]of yte)for(const y of f)Object.defineProperty(this,y,{get:()=>{const C=m(a),w=o[n]-C;return this.rect[y]+w},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class zy{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var a;return(a=this.target)==null?void 0:a.removeEventListener(...r)})},this.target=e}add(e,r,a){var o;(o=this.target)==null||o.addEventListener(e,r,a),this.listeners.push([e,r,a])}}function bte(t){const{EventTarget:e}=Mi(t);return t instanceof e?t:xg(t)}function Rw(t,e){const r=Math.abs(t.x),a=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+a**2)>e:"x"in e&&"y"in e?r>e.x&&a>e.y:"x"in e?r>e.x:"y"in e?a>e.y:!1}var Gl;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Gl||(Gl={}));function yR(t){t.preventDefault()}function vte(t){t.stopPropagation()}var Qo;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Qo||(Qo={}));const C_={start:[Qo.Space,Qo.Enter],cancel:[Qo.Esc],end:[Qo.Space,Qo.Enter,Qo.Tab]},xte=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case Qo.Right:return{...r,x:r.x+25};case Qo.Left:return{...r,x:r.x-25};case Qo.Down:return{...r,y:r.y+25};case Qo.Up:return{...r,y:r.y-25}}};class S_{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new zy(xg(r)),this.windowListeners=new zy(Mi(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Gl.Resize,this.handleCancel),this.windowListeners.add(Gl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Gl.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,a=e.node.current;a&&x_(a),r(Lc)}handleKeyDown(e){if(fk(e)){const{active:r,context:a,options:o}=this.props,{keyboardCodes:n=C_,coordinateGetter:f=xte,scrollBehavior:m="smooth"}=o,{code:y}=e;if(n.end.includes(y)){this.handleEnd(e);return}if(n.cancel.includes(y)){this.handleCancel(e);return}const{collisionRect:C}=a.current,w=C?{x:C.left,y:C.top}:Lc;this.referenceCoordinates||(this.referenceCoordinates=w);const A=f(e,{active:r,context:a.current,currentCoordinates:w});if(A){const R=eC(A,w),I={x:0,y:0},{scrollableAncestors:M}=a.current;for(const F of M){const O=e.code,{isTop:j,isRight:U,isLeft:H,isBottom:K,maxScroll:W,minScroll:X}=b_(F),ee=pte(F),ie={x:Math.min(O===Qo.Right?ee.right-ee.width/2:ee.right,Math.max(O===Qo.Right?ee.left:ee.left+ee.width/2,A.x)),y:Math.min(O===Qo.Down?ee.bottom-ee.height/2:ee.bottom,Math.max(O===Qo.Down?ee.top:ee.top+ee.height/2,A.y))},de=O===Qo.Right&&!U||O===Qo.Left&&!H,le=O===Qo.Down&&!K||O===Qo.Up&&!j;if(de&&ie.x!==A.x){const oe=F.scrollLeft+R.x,N=O===Qo.Right&&oe<=W.x||O===Qo.Left&&oe>=X.x;if(N&&!R.y){F.scrollTo({left:oe,behavior:m});return}N?I.x=F.scrollLeft-oe:I.x=O===Qo.Right?F.scrollLeft-W.x:F.scrollLeft-X.x,I.x&&F.scrollBy({left:-I.x,behavior:m});break}else if(le&&ie.y!==A.y){const oe=F.scrollTop+R.y,N=O===Qo.Down&&oe<=W.y||O===Qo.Up&&oe>=X.y;if(N&&!R.x){F.scrollTo({top:oe,behavior:m});return}N?I.y=F.scrollTop-oe:I.y=O===Qo.Down?F.scrollTop-W.y:F.scrollTop-X.y,I.y&&F.scrollBy({top:-I.y,behavior:m});break}}this.handleMove(e,$m(eC(A,this.referenceCoordinates),I))}}}handleMove(e,r){const{onMove:a}=this.props;e.preventDefault(),a(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}S_.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:a=C_,onActivation:o}=e,{active:n}=r;const{code:f}=t.nativeEvent;if(a.start.includes(f)){const m=n.activatorNode.current;return m&&t.target!==m?!1:(t.preventDefault(),o?.({event:t.nativeEvent}),!0)}return!1}}];function bR(t){return!!(t&&"distance"in t)}function vR(t){return!!(t&&"delay"in t)}class mk{constructor(e,r,a){var o;a===void 0&&(a=bte(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:n}=e,{target:f}=n;this.props=e,this.events=r,this.document=xg(f),this.documentListeners=new zy(this.document),this.listeners=new zy(a),this.windowListeners=new zy(Mi(f)),this.initialCoordinates=(o=tC(n))!=null?o:Lc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:a}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Gl.Resize,this.handleCancel),this.windowListeners.add(Gl.DragStart,yR),this.windowListeners.add(Gl.VisibilityChange,this.handleCancel),this.windowListeners.add(Gl.ContextMenu,yR),this.documentListeners.add(Gl.Keydown,this.handleKeydown),r){if(a!=null&&a({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(vR(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(bR(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:a,onPending:o}=this.props;o(a,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(Gl.Click,vte,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Gl.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:a,initialCoordinates:o,props:n}=this,{onMove:f,options:{activationConstraint:m}}=n;if(!o)return;const y=(r=tC(e))!=null?r:Lc,C=eC(o,y);if(!a&&m){if(bR(m)){if(m.tolerance!=null&&Rw(C,m.tolerance))return this.handleCancel();if(Rw(C,m.distance))return this.handleStart()}if(vR(m)&&Rw(C,m.tolerance))return this.handleCancel();this.handlePending(m,C);return}e.cancelable&&e.preventDefault(),f(y)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===Qo.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const Cte={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class gk extends mk{constructor(e){const{event:r}=e,a=xg(r.target);super(e,Cte,a)}}gk.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:a}=e;return!r.isPrimary||r.button!==0?!1:(a?.({event:r}),!0)}}];const Ste={move:{name:"mousemove"},end:{name:"mouseup"}};var UT;(function(t){t[t.RightClick=2]="RightClick"})(UT||(UT={}));class wte extends mk{constructor(e){super(e,Ste,xg(e.event.target))}}wte.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:a}=e;return r.button===UT.RightClick?!1:(a?.({event:r}),!0)}}];const Iw={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Tte extends mk{constructor(e){super(e,Iw)}static setup(){return window.addEventListener(Iw.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Iw.move.name,e)};function e(){}}}Tte.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:a}=e;const{touches:o}=r;return o.length>1?!1:(a?.({event:r}),!0)}}];var Uy;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Uy||(Uy={}));var rC;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(rC||(rC={}));function Ate(t){let{acceleration:e,activator:r=Uy.Pointer,canScroll:a,draggingRect:o,enabled:n,interval:f=5,order:m=rC.TreeOrder,pointerCoordinates:y,scrollableAncestors:C,scrollableAncestorRects:w,delta:A,threshold:R}=t;const I=kte({delta:A,disabled:!n}),[M,F]=Fee(),O=E.useRef({x:0,y:0}),j=E.useRef({x:0,y:0}),U=E.useMemo(()=>{switch(r){case Uy.Pointer:return y?{top:y.y,bottom:y.y,left:y.x,right:y.x}:null;case Uy.DraggableRect:return o}},[r,o,y]),H=E.useRef(null),K=E.useCallback(()=>{const X=H.current;if(!X)return;const ee=O.current.x*j.current.x,ie=O.current.y*j.current.y;X.scrollBy(ee,ie)},[]),W=E.useMemo(()=>m===rC.TreeOrder?[...C].reverse():C,[m,C]);E.useEffect(()=>{if(!n||!C.length||!U){F();return}for(const X of W){if(a?.(X)===!1)continue;const ee=C.indexOf(X),ie=w[ee];if(!ie)continue;const{direction:de,speed:le}=hte(X,ie,U,e,R);for(const oe of["x","y"])I[oe][de[oe]]||(le[oe]=0,de[oe]=0);if(le.x>0||le.y>0){F(),H.current=X,M(K,f),O.current=le,j.current=de;return}}O.current={x:0,y:0},j.current={x:0,y:0},F()},[e,K,a,F,n,f,JSON.stringify(U),JSON.stringify(I),M,C,W,w,JSON.stringify(R)])}const Ete={x:{[Es.Backward]:!1,[Es.Forward]:!1},y:{[Es.Backward]:!1,[Es.Forward]:!1}};function kte(t){let{delta:e,disabled:r}=t;const a=Z2(e);return _b(o=>{if(r||!a||!o)return Ete;const n={x:Math.sign(e.x-a.x),y:Math.sign(e.y-a.y)};return{x:{[Es.Backward]:o.x[Es.Backward]||n.x===-1,[Es.Forward]:o.x[Es.Forward]||n.x===1},y:{[Es.Backward]:o.y[Es.Backward]||n.y===-1,[Es.Forward]:o.y[Es.Forward]||n.y===1}}},[r,e,a])}function Dte(t,e){const r=e!=null?t.get(e):void 0,a=r?r.node.current:null;return _b(o=>{var n;return e==null?null:(n=a??o)!=null?n:null},[a,e])}function Rte(t,e){return E.useMemo(()=>t.reduce((r,a)=>{const{sensor:o}=a,n=o.activators.map(f=>({eventName:f.eventName,handler:e(f.handler,a)}));return[...r,...n]},[]),[t,e])}var ub;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(ub||(ub={}));var $T;(function(t){t.Optimized="optimized"})($T||($T={}));const xR=new Map;function Ite(t,e){let{dragging:r,dependencies:a,config:o}=e;const[n,f]=E.useState(null),{frequency:m,measure:y,strategy:C}=o,w=E.useRef(t),A=O(),R=lb(A),I=E.useCallback(function(j){j===void 0&&(j=[]),!R.current&&f(U=>U===null?j:U.concat(j.filter(H=>!U.includes(H))))},[R]),M=E.useRef(null),F=_b(j=>{if(A&&!r)return xR;if(!j||j===xR||w.current!==t||n!=null){const U=new Map;for(let H of t){if(!H)continue;if(n&&n.length>0&&!n.includes(H.id)&&H.rect.current){U.set(H.id,H.rect.current);continue}const K=H.node.current,W=K?new pk(y(K),K):null;H.rect.current=W,W&&U.set(H.id,W)}return U}return j},[t,n,r,A,y]);return E.useEffect(()=>{w.current=t},[t]),E.useEffect(()=>{A||I()},[r,A]),E.useEffect(()=>{n&&n.length>0&&f(null)},[JSON.stringify(n)]),E.useEffect(()=>{A||typeof m!="number"||M.current!==null||(M.current=setTimeout(()=>{I(),M.current=null},m))},[m,A,I,...a]),{droppableRects:F,measureDroppableContainers:I,measuringScheduled:n!=null};function O(){switch(C){case ub.Always:return!1;case ub.BeforeDragging:return r;default:return!r}}}function yk(t,e){return _b(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function Pte(t,e){return yk(t,e)}function Mte(t){let{callback:e,disabled:r}=t;const a=pS(e),o=E.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:n}=window;return new n(a)},[a,r]);return E.useEffect(()=>()=>o?.disconnect(),[o]),o}function gS(t){let{callback:e,disabled:r}=t;const a=pS(e),o=E.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:n}=window;return new n(a)},[r]);return E.useEffect(()=>()=>o?.disconnect(),[o]),o}function _te(t){return new pk(Ob(t),t)}function CR(t,e,r){e===void 0&&(e=_te);const[a,o]=E.useState(null);function n(){o(y=>{if(!t)return null;if(t.isConnected===!1){var C;return(C=y??r)!=null?C:null}const w=e(t);return JSON.stringify(y)===JSON.stringify(w)?y:w})}const f=Mte({callback(y){if(t)for(const C of y){const{type:w,target:A}=C;if(w==="childList"&&A instanceof HTMLElement&&A.contains(t)){n();break}}}}),m=gS({callback:n});return Ed(()=>{n(),t?(m?.observe(t),f?.observe(document.body,{childList:!0,subtree:!0})):(m?.disconnect(),f?.disconnect())},[t]),a}function Ote(t){const e=yk(t);return f_(t,e)}const SR=[];function Fte(t){const e=E.useRef(t),r=_b(a=>t?a&&a!==SR&&t&&e.current&&t.parentNode===e.current.parentNode?a:hk(t):SR,[t]);return E.useEffect(()=>{e.current=t},[t]),r}function Nte(t){const[e,r]=E.useState(null),a=E.useRef(t),o=E.useCallback(n=>{const f=Dw(n.target);f&&r(m=>m?(m.set(f,zT(f)),new Map(m)):null)},[]);return E.useEffect(()=>{const n=a.current;if(t!==n){f(n);const m=t.map(y=>{const C=Dw(y);return C?(C.addEventListener("scroll",o,{passive:!0}),[C,zT(C)]):null}).filter(y=>y!=null);r(m.length?new Map(m):null),a.current=t}return()=>{f(t),f(n)};function f(m){m.forEach(y=>{const C=Dw(y);C?.removeEventListener("scroll",o)})}},[o,t]),E.useMemo(()=>t.length?e?Array.from(e.values()).reduce((n,f)=>$m(n,f),Lc):v_(t):Lc,[t,e])}function wR(t,e){e===void 0&&(e=[]);const r=E.useRef(null);return E.useEffect(()=>{r.current=null},e),E.useEffect(()=>{const a=t!==Lc;a&&!r.current&&(r.current=t),!a&&r.current&&(r.current=null)},[t]),r.current?eC(t,r.current):Lc}function jte(t){E.useEffect(()=>{if(!hS)return;const e=t.map(r=>{let{sensor:a}=r;return a.setup==null?void 0:a.setup()});return()=>{for(const r of e)r?.()}},t.map(e=>{let{sensor:r}=e;return r}))}function Lte(t,e){return E.useMemo(()=>t.reduce((r,a)=>{let{eventName:o,handler:n}=a;return r[o]=f=>{n(f,e)},r},{}),[t,e])}function w_(t){return E.useMemo(()=>t?cte(t):null,[t])}const TR=[];function Bte(t,e){e===void 0&&(e=Ob);const[r]=t,a=w_(r?Mi(r):null),[o,n]=E.useState(TR);function f(){n(()=>t.length?t.map(y=>y_(y)?a:new pk(e(y),y)):TR)}const m=gS({callback:f});return Ed(()=>{m?.disconnect(),f(),t.forEach(y=>m?.observe(y))},[t]),o}function T_(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Mb(e)?e:t}function zte(t){let{measure:e}=t;const[r,a]=E.useState(null),o=E.useCallback(C=>{for(const{target:w}of C)if(Mb(w)){a(A=>{const R=e(w);return A?{...A,width:R.width,height:R.height}:R});break}},[e]),n=gS({callback:o}),f=E.useCallback(C=>{const w=T_(C);n?.disconnect(),w&&n?.observe(w),a(w?e(w):null)},[e,n]),[m,y]=J2(f);return E.useMemo(()=>({nodeRef:m,rect:r,setRef:y}),[r,m,y])}const Ute=[{sensor:gk,options:{}},{sensor:S_,options:{}}],$te={current:{}},u2={draggable:{measure:gR},droppable:{measure:gR,strategy:ub.WhileDragging,frequency:$T.Optimized},dragOverlay:{measure:Ob}};class $y extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,a;return(r=(a=this.get(e))==null?void 0:a.node.current)!=null?r:void 0}}const Hte={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new $y,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:nC},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:u2,measureDroppableContainers:nC,windowRect:null,measuringScheduled:!1},A_={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:nC,draggableNodes:new Map,over:null,measureDroppableContainers:nC},Fb=E.createContext(A_),E_=E.createContext(Hte);function Wte(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new $y}}}function Vte(t,e){switch(e.type){case ms.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case ms.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case ms.DragEnd:case ms.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ms.RegisterDroppable:{const{element:r}=e,{id:a}=r,o=new $y(t.droppable.containers);return o.set(a,r),{...t,droppable:{...t.droppable,containers:o}}}case ms.SetDroppableDisabled:{const{id:r,key:a,disabled:o}=e,n=t.droppable.containers.get(r);if(!n||a!==n.key)return t;const f=new $y(t.droppable.containers);return f.set(r,{...n,disabled:o}),{...t,droppable:{...t.droppable,containers:f}}}case ms.UnregisterDroppable:{const{id:r,key:a}=e,o=t.droppable.containers.get(r);if(!o||a!==o.key)return t;const n=new $y(t.droppable.containers);return n.delete(r),{...t,droppable:{...t.droppable,containers:n}}}default:return t}}function Gte(t){let{disabled:e}=t;const{active:r,activatorEvent:a,draggableNodes:o}=E.useContext(Fb),n=Z2(a),f=Z2(r?.id);return E.useEffect(()=>{if(!e&&!a&&n&&f!=null){if(!fk(n)||document.activeElement===n.target)return;const m=o.get(f);if(!m)return;const{activatorNode:y,node:C}=m;if(!y.current&&!C.current)return;requestAnimationFrame(()=>{for(const w of[y.current,C.current]){if(!w)continue;const A=Lee(w);if(A){A.focus();break}}})}},[a,e,o,f,n]),null}function k_(t,e){let{transform:r,...a}=e;return t!=null&&t.length?t.reduce((o,n)=>n({transform:o,...a}),r):r}function Kte(t){return E.useMemo(()=>({draggable:{...u2.draggable,...t?.draggable},droppable:{...u2.droppable,...t?.droppable},dragOverlay:{...u2.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function Yte(t){let{activeNode:e,measure:r,initialRect:a,config:o=!0}=t;const n=E.useRef(!1),{x:f,y:m}=typeof o=="boolean"?{x:o,y:o}:o;Ed(()=>{if(!f&&!m||!e){n.current=!1;return}if(n.current||!a)return;const C=e?.node.current;if(!C||C.isConnected===!1)return;const w=r(C),A=f_(w,a);if(f||(A.x=0),m||(A.y=0),n.current=!0,Math.abs(A.x)>0||Math.abs(A.y)>0){const R=p_(C);R&&R.scrollBy({top:A.y,left:A.x})}},[e,f,m,a,r])}const yS=E.createContext({...Lc,scaleX:1,scaleY:1});var Ef;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Ef||(Ef={}));const qte=E.memo(function(e){var r,a,o,n;let{id:f,accessibility:m,autoScroll:y=!0,children:C,sensors:w=Ute,collisionDetection:A=rte,measuring:R,modifiers:I,...M}=e;const F=E.useReducer(Vte,void 0,Wte),[O,j]=F,[U,H]=Wee(),[K,W]=E.useState(Ef.Uninitialized),X=K===Ef.Initialized,{draggable:{active:ee,nodes:ie,translate:de},droppable:{containers:le}}=O,oe=ee!=null?ie.get(ee):null,N=E.useRef({initial:null,translated:null}),ce=E.useMemo(()=>{var Zt;return ee!=null?{id:ee,data:(Zt=oe?.data)!=null?Zt:$te,rect:N}:null},[ee,oe]),ne=E.useRef(null),[Se,se]=E.useState(null),[ye,ze]=E.useState(null),Re=lb(M,Object.values(M)),ve=mS("DndDescribedBy",f),V=E.useMemo(()=>le.getEnabled(),[le]),ue=Kte(R),{droppableRects:Ee,measureDroppableContainers:Ie,measuringScheduled:ae}=Ite(V,{dragging:X,dependencies:[de.x,de.y],config:ue.droppable}),be=Dte(ie,ee),Te=E.useMemo(()=>ye?tC(ye):null,[ye]),tt=Sn(),je=Pte(be,ue.draggable.measure);Yte({activeNode:ee!=null?ie.get(ee):null,config:tt.layoutShiftCompensation,initialRect:je,measure:ue.draggable.measure});const Pe=CR(be,ue.draggable.measure,je),Be=CR(be?be.parentElement:null),Fe=E.useRef({activatorEvent:null,active:null,activeNode:be,collisionRect:null,collisions:null,droppableRects:Ee,draggableNodes:ie,draggingNode:null,draggingNodeRect:null,droppableContainers:le,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ge=le.getNodeFor((r=Fe.current.over)==null?void 0:r.id),Oe=zte({measure:ue.dragOverlay.measure}),mt=(a=Oe.nodeRef.current)!=null?a:be,qe=X?(o=Oe.rect)!=null?o:Pe:null,Ae=!!(Oe.nodeRef.current&&Oe.rect),te=Ote(Ae?null:Pe),pe=w_(mt?Mi(mt):null),J=Fte(X?Ge??be:null),fe=Bte(J),xe=k_(I,{transform:{x:de.x-te.x,y:de.y-te.y,scaleX:1,scaleY:1},activatorEvent:ye,active:ce,activeNodeRect:Pe,containerNodeRect:Be,draggingNodeRect:qe,over:Fe.current.over,overlayNodeRect:Oe.rect,scrollableAncestors:J,scrollableAncestorRects:fe,windowRect:pe}),Ne=Te?$m(Te,de):null,Me=Nte(J),Ve=wR(Me),Qe=wR(Me,[Pe]),rt=$m(xe,Ve),st=qe?ste(qe,xe):null,it=ce&&st?A({active:ce,collisionRect:st,droppableRects:Ee,droppableContainers:V,pointerCoordinates:Ne}):null,xt=ete(it,"id"),[pt,Yt]=E.useState(null),Kt=Ae?xe:$m(xe,Qe),tn=ote(Kt,(n=pt?.rect)!=null?n:null,Pe),Wt=E.useRef(null),_t=E.useCallback((Zt,Kn)=>{let{sensor:$t,options:Cr}=Kn;if(ne.current==null)return;const tr=ie.get(ne.current);if(!tr)return;const Bt=Zt.nativeEvent,gr=new $t({active:ne.current,activeNode:tr,event:Bt,options:Cr,context:Fe,onAbort(un){if(!ie.get(un))return;const{onDragAbort:En}=Re.current,fr={id:un};En?.(fr),U({type:"onDragAbort",event:fr})},onPending(un,Yn,En,fr){if(!ie.get(un))return;const{onDragPending:xo}=Re.current,Qn={id:un,constraint:Yn,initialCoordinates:En,offset:fr};xo?.(Qn),U({type:"onDragPending",event:Qn})},onStart(un){const Yn=ne.current;if(Yn==null)return;const En=ie.get(Yn);if(!En)return;const{onDragStart:fr}=Re.current,fo={activatorEvent:Bt,active:{id:Yn,data:En.data,rect:N}};sp.unstable_batchedUpdates(()=>{fr?.(fo),W(Ef.Initializing),j({type:ms.DragStart,initialCoordinates:un,active:Yn}),U({type:"onDragStart",event:fo}),se(Wt.current),ze(Bt)})},onMove(un){j({type:ms.DragMove,coordinates:un})},onEnd:en(ms.DragEnd),onCancel:en(ms.DragCancel)});Wt.current=gr;function en(un){return async function(){const{active:En,collisions:fr,over:fo,scrollAdjustedTranslate:xo}=Fe.current;let Qn=null;if(En&&xo){const{cancelDrop:Or}=Re.current;Qn={activatorEvent:Bt,active:En,collisions:fr,delta:xo,over:fo},un===ms.DragEnd&&typeof Or=="function"&&await Promise.resolve(Or(Qn))&&(un=ms.DragCancel)}ne.current=null,sp.unstable_batchedUpdates(()=>{j({type:un}),W(Ef.Uninitialized),Yt(null),se(null),ze(null),Wt.current=null;const Or=un===ms.DragEnd?"onDragEnd":"onDragCancel";if(Qn){const Ko=Re.current[Or];Ko?.(Qn),U({type:Or,event:Qn})}})}}},[ie]),at=E.useCallback((Zt,Kn)=>($t,Cr)=>{const tr=$t.nativeEvent,Bt=ie.get(Cr);if(ne.current!==null||!Bt||tr.dndKit||tr.defaultPrevented)return;const gr={active:Bt};Zt($t,Kn.options,gr)===!0&&(tr.dndKit={capturedBy:Kn.sensor},ne.current=Cr,_t($t,Kn))},[ie,_t]),Et=Rte(w,at);jte(w),Ed(()=>{Pe&&K===Ef.Initializing&&W(Ef.Initialized)},[Pe,K]),E.useEffect(()=>{const{onDragMove:Zt}=Re.current,{active:Kn,activatorEvent:$t,collisions:Cr,over:tr}=Fe.current;if(!Kn||!$t)return;const Bt={active:Kn,activatorEvent:$t,collisions:Cr,delta:{x:rt.x,y:rt.y},over:tr};sp.unstable_batchedUpdates(()=>{Zt?.(Bt),U({type:"onDragMove",event:Bt})})},[rt.x,rt.y]),E.useEffect(()=>{const{active:Zt,activatorEvent:Kn,collisions:$t,droppableContainers:Cr,scrollAdjustedTranslate:tr}=Fe.current;if(!Zt||ne.current==null||!Kn||!tr)return;const{onDragOver:Bt}=Re.current,gr=Cr.get(xt),en=gr&&gr.rect.current?{id:gr.id,rect:gr.rect.current,data:gr.data,disabled:gr.disabled}:null,un={active:Zt,activatorEvent:Kn,collisions:$t,delta:{x:tr.x,y:tr.y},over:en};sp.unstable_batchedUpdates(()=>{Yt(en),Bt?.(un),U({type:"onDragOver",event:un})})},[xt]),Ed(()=>{Fe.current={activatorEvent:ye,active:ce,activeNode:be,collisionRect:st,collisions:it,droppableRects:Ee,draggableNodes:ie,draggingNode:mt,draggingNodeRect:qe,droppableContainers:le,over:pt,scrollableAncestors:J,scrollAdjustedTranslate:rt},N.current={initial:qe,translated:st}},[ce,be,it,st,ie,mt,qe,Ee,le,pt,J,rt]),Ate({...tt,delta:de,draggingRect:st,pointerCoordinates:Ne,scrollableAncestors:J,scrollableAncestorRects:fe});const qt=E.useMemo(()=>({active:ce,activeNode:be,activeNodeRect:Pe,activatorEvent:ye,collisions:it,containerNodeRect:Be,dragOverlay:Oe,draggableNodes:ie,droppableContainers:le,droppableRects:Ee,over:pt,measureDroppableContainers:Ie,scrollableAncestors:J,scrollableAncestorRects:fe,measuringConfiguration:ue,measuringScheduled:ae,windowRect:pe}),[ce,be,Pe,ye,it,Be,Oe,ie,le,Ee,pt,Ie,J,fe,ue,ae,pe]),gn=E.useMemo(()=>({activatorEvent:ye,activators:Et,active:ce,activeNodeRect:Pe,ariaDescribedById:{draggable:ve},dispatch:j,draggableNodes:ie,over:pt,measureDroppableContainers:Ie}),[ye,Et,ce,Pe,j,ve,ie,pt,Ie]);return Jr.createElement(d_.Provider,{value:H},Jr.createElement(Fb.Provider,{value:gn},Jr.createElement(E_.Provider,{value:qt},Jr.createElement(yS.Provider,{value:tn},C)),Jr.createElement(Gte,{disabled:m?.restoreFocus===!1})),Jr.createElement(Kee,{...m,hiddenTextDescribedById:ve}));function Sn(){const Zt=Se?.autoScrollEnabled===!1,Kn=typeof y=="object"?y.enabled===!1:y===!1,$t=X&&!Zt&&!Kn;return typeof y=="object"?{...y,enabled:$t}:{enabled:$t}}}),Qte=E.createContext(null),AR="button",Xte="Draggable";function Jte(t){let{id:e,data:r,disabled:a=!1,attributes:o}=t;const n=mS(Xte),{activators:f,activatorEvent:m,active:y,activeNodeRect:C,ariaDescribedById:w,draggableNodes:A,over:R}=E.useContext(Fb),{role:I=AR,roleDescription:M="draggable",tabIndex:F=0}=o??{},O=y?.id===e,j=E.useContext(O?yS:Qte),[U,H]=J2(),[K,W]=J2(),X=Lte(f,e),ee=lb(r);Ed(()=>(A.set(e,{id:e,key:n,node:U,activatorNode:K,data:ee}),()=>{const de=A.get(e);de&&de.key===n&&A.delete(e)}),[A,e]);const ie=E.useMemo(()=>({role:I,tabIndex:F,"aria-disabled":a,"aria-pressed":O&&I===AR?!0:void 0,"aria-roledescription":M,"aria-describedby":w.draggable}),[a,I,F,O,M,w.draggable]);return{active:y,activatorEvent:m,activeNodeRect:C,attributes:ie,isDragging:O,listeners:a?void 0:X,node:U,over:R,setNodeRef:H,setActivatorNodeRef:W,transform:j}}function Zte(){return E.useContext(E_)}const ene="Droppable",tne={timeout:25};function nne(t){let{data:e,disabled:r=!1,id:a,resizeObserverConfig:o}=t;const n=mS(ene),{active:f,dispatch:m,over:y,measureDroppableContainers:C}=E.useContext(Fb),w=E.useRef({disabled:r}),A=E.useRef(!1),R=E.useRef(null),I=E.useRef(null),{disabled:M,updateMeasurementsFor:F,timeout:O}={...tne,...o},j=lb(F??a),U=E.useCallback(()=>{if(!A.current){A.current=!0;return}I.current!=null&&clearTimeout(I.current),I.current=setTimeout(()=>{C(Array.isArray(j.current)?j.current:[j.current]),I.current=null},O)},[O]),H=gS({callback:U,disabled:M||!f}),K=E.useCallback((ie,de)=>{H&&(de&&(H.unobserve(de),A.current=!1),ie&&H.observe(ie))},[H]),[W,X]=J2(K),ee=lb(e);return E.useEffect(()=>{!H||!W.current||(H.disconnect(),A.current=!1,H.observe(W.current))},[W,H]),E.useEffect(()=>(m({type:ms.RegisterDroppable,element:{id:a,key:n,disabled:r,node:W,rect:R,data:ee}}),()=>m({type:ms.UnregisterDroppable,key:n,id:a})),[a]),E.useEffect(()=>{r!==w.current.disabled&&(m({type:ms.SetDroppableDisabled,id:a,key:n,disabled:r}),w.current.disabled=r)},[a,n,r,m]),{active:f,rect:R,isOver:y?.id===a,node:W,over:y,setNodeRef:X}}function rne(t){let{animation:e,children:r}=t;const[a,o]=E.useState(null),[n,f]=E.useState(null),m=Z2(r);return!r&&!a&&m&&o(m),Ed(()=>{if(!n)return;const y=a?.key,C=a?.props.id;if(y==null||C==null){o(null);return}Promise.resolve(e(C,n)).then(()=>{o(null)})},[e,a,n]),Jr.createElement(Jr.Fragment,null,r,a?E.cloneElement(a,{ref:f}):null)}const one={x:0,y:0,scaleX:1,scaleY:1};function ane(t){let{children:e}=t;return Jr.createElement(Fb.Provider,{value:A_},Jr.createElement(yS.Provider,{value:one},e))}const sne={position:"fixed",touchAction:"none"},ine=t=>fk(t)?"transform 250ms ease":void 0,lne=E.forwardRef((t,e)=>{let{as:r,activatorEvent:a,adjustScale:o,children:n,className:f,rect:m,style:y,transform:C,transition:w=ine}=t;if(!m)return null;const A=o?C:{...C,scaleX:1,scaleY:1},R={...sne,width:m.width,height:m.height,top:m.top,left:m.left,transform:cb.Transform.toString(A),transformOrigin:o&&a?Xee(a,m):void 0,transition:typeof w=="function"?w(a):w,...y};return Jr.createElement(r,{className:f,style:R,ref:e},n)}),cne=t=>e=>{let{active:r,dragOverlay:a}=e;const o={},{styles:n,className:f}=t;if(n!=null&&n.active)for(const[m,y]of Object.entries(n.active))y!==void 0&&(o[m]=r.node.style.getPropertyValue(m),r.node.style.setProperty(m,y));if(n!=null&&n.dragOverlay)for(const[m,y]of Object.entries(n.dragOverlay))y!==void 0&&a.node.style.setProperty(m,y);return f!=null&&f.active&&r.node.classList.add(f.active),f!=null&&f.dragOverlay&&a.node.classList.add(f.dragOverlay),function(){for(const[y,C]of Object.entries(o))r.node.style.setProperty(y,C);f!=null&&f.active&&r.node.classList.remove(f.active)}},une=t=>{let{transform:{initial:e,final:r}}=t;return[{transform:cb.Transform.toString(e)},{transform:cb.Transform.toString(r)}]},dne={duration:250,easing:"ease",keyframes:une,sideEffects:cne({styles:{active:{opacity:"0"}}})};function fne(t){let{config:e,draggableNodes:r,droppableContainers:a,measuringConfiguration:o}=t;return pS((n,f)=>{if(e===null)return;const m=r.get(n);if(!m)return;const y=m.node.current;if(!y)return;const C=T_(f);if(!C)return;const{transform:w}=Mi(f).getComputedStyle(f),A=h_(w);if(!A)return;const R=typeof e=="function"?e:hne(e);return x_(y,o.draggable.measure),R({active:{id:n,data:m.data,node:y,rect:o.draggable.measure(y)},draggableNodes:r,dragOverlay:{node:f,rect:o.dragOverlay.measure(C)},droppableContainers:a,measuringConfiguration:o,transform:A})})}function hne(t){const{duration:e,easing:r,sideEffects:a,keyframes:o}={...dne,...t};return n=>{let{active:f,dragOverlay:m,transform:y,...C}=n;if(!e)return;const w={x:m.rect.left-f.rect.left,y:m.rect.top-f.rect.top},A={scaleX:y.scaleX!==1?f.rect.width*y.scaleX/m.rect.width:1,scaleY:y.scaleY!==1?f.rect.height*y.scaleY/m.rect.height:1},R={x:y.x-w.x,y:y.y-w.y,...A},I=o({...C,active:f,dragOverlay:m,transform:{initial:y,final:R}}),[M]=I,F=I[I.length-1];if(JSON.stringify(M)===JSON.stringify(F))return;const O=a?.({active:f,dragOverlay:m,...C}),j=m.node.animate(I,{duration:e,easing:r,fill:"forwards"});return new Promise(U=>{j.onfinish=()=>{O?.(),U()}})}}let ER=0;function pne(t){return E.useMemo(()=>{if(t!=null)return ER++,ER},[t])}const mne=Jr.memo(t=>{let{adjustScale:e=!1,children:r,dropAnimation:a,style:o,transition:n,modifiers:f,wrapperElement:m="div",className:y,zIndex:C=999}=t;const{activatorEvent:w,active:A,activeNodeRect:R,containerNodeRect:I,draggableNodes:M,droppableContainers:F,dragOverlay:O,over:j,measuringConfiguration:U,scrollableAncestors:H,scrollableAncestorRects:K,windowRect:W}=Zte(),X=E.useContext(yS),ee=pne(A?.id),ie=k_(f,{activatorEvent:w,active:A,activeNodeRect:R,containerNodeRect:I,draggingNodeRect:O.rect,over:j,overlayNodeRect:O.rect,scrollableAncestors:H,scrollableAncestorRects:K,transform:X,windowRect:W}),de=yk(R),le=fne({config:a,draggableNodes:M,droppableContainers:F,measuringConfiguration:U}),oe=de?O.setRef:void 0;return Jr.createElement(ane,null,Jr.createElement(rne,{animation:le},A&&ee?Jr.createElement(lne,{key:ee,id:A.id,ref:oe,as:m,activatorEvent:w,adjustScale:e,className:y,transition:n,rect:de,style:{zIndex:C,...o},transform:ie},r):null))});function gne({selectedDate:t}){const e=Ab(),r=Dd(),{isViewer:a,isBudgetManager:o}=Gf(),n=!a&&!o,[f,m]=E.useState("1Q"),y=J=>{switch(J){case"1Q":return 3;case"2Q":return 6;case"3Q":return 9;default:return 6}},C=Array.from({length:y(f)},(J,fe)=>BC(t,fe)),w=()=>{switch(y(f)){case 3:return"400px";case 6:return"200px";case 9:return"130px";default:return"200px"}},[A,R]=E.useState("percentage"),[I,M]=E.useState("all"),F=J=>Math.round(J/100*20),O=(J,fe)=>{const xe=fe?.toLowerCase()?.trim();return xe==="days"||xe==="day"?A==="days"?`${J}d`:`${Math.round(J/20*100)}%`:A==="days"?`${F(J)}d`:`${J}%`},j=(J,fe)=>{const xe=fe?.toLowerCase()?.trim();return xe==="days"||xe==="day"?A==="days"?J:Math.round(J/20*100):A==="days"?F(J):J},U=(J,fe)=>{const xe=j(J,fe);return A==="days"?xe>=17&&xe<=24?"#a5d6a7":xe<17?"#fff59d":"#ef9a9a":xe>=85&&xe<=120?"#a5d6a7":xe<85?"#fff59d":"#ef9a9a"},[H,K]=E.useState({open:!1,resourceId:"",monthIndex:0,monthYear:""}),[W,X]=E.useState({open:!1,monthIndex:0,monthYear:""}),[ee,ie]=E.useState({ProjectName:"",ResourceName:"",PositionName:"",MonthYear:"",AllocationMode:"",LoE:0}),[de,le]=E.useState(null),[oe,N]=E.useState(null),ce=qee(Yee(gk,{activationConstraint:{distance:8}})),ne=J=>{if(!n)return;const{active:fe}=J;console.log("Drag start event:",{activeId:fe.id}),le(fe.id);const xe=Te.find(Ne=>Ne.ID===fe.id);console.log("Found position:",xe),N(xe||null)},Se=J=>{if(!n){le(null),N(null);return}const{over:fe}=J;if(console.log("Drag end event:",{over:fe,draggedPosition:oe}),!fe){console.log("No drop target - clearing drag state"),le(null),N(null);return}const xe=fe.id;if(console.log("Drop ID:",xe),xe.startsWith("cell-")){const Ne=xe.split("-");console.log("Drop ID parts:",Ne);const Me=parseInt(Ne[Ne.length-1]),Ve=Ne.slice(1,Ne.length-1).join("-");if(console.log("Parsed:",{resourceId:Ve,monthIndex:Me}),isNaN(Me)||Me<0||Me>=C.length){console.error("Invalid month index:",Me),le(null),N(null);return}const Qe=C[Me];if(console.log("Dropping on cell:",{resourceId:Ve,monthIndex:Me,month:Qe,draggedPosition:oe}),oe){const rt=ga(new Date(oe.MonthYear)),st=ga(Qe);if(rt.getTime()!==st.getTime()){console.log("Cannot allocate: Position month does not match target cell month"),console.log("Position month:",In(rt,"MMM yyyy")),console.log("Target month:",In(st,"MMM yyyy")),le(null),N(null);return}let it=oe.LoE;const xt=oe?.AllocationMode?.toLowerCase()?.trim();(xt==="days"||xt==="day")&&(it=Math.round(oe.LoE/20*100));const Yt={PositionID:oe.ID,ResourceName:be.find(Kt=>Kt.ID===Ve)?.Name||"",MonthYear:In(Qe,"yyyy-MM-dd"),AllocationMode:"%",LoE:it};console.log("Creating allocation:",Yt),console.log("Original position LoE:",oe.LoE,"Mode:",oe.AllocationMode,"Converted to:",it),Ie.mutate(Yt)}}else console.log("Dropping on non-cell target:",xe);le(null),N(null)},se=({position:J})=>{const{attributes:fe,listeners:xe,setNodeRef:Ne,transform:Me,isDragging:Ve}=Jte({id:J.ID,disabled:!n}),Qe={transform:Me?`translate3d(${Me.x}px, ${Me.y}px, 0)`:void 0,opacity:Ve?.5:1};return d.jsxs(_e,{ref:Ne,style:Qe,...n?xe:{},...n?fe:{},sx:{backgroundColor:"#dbeafe",p:.5,borderRadius:.5,fontSize:"0.60rem",fontWeight:"normal",lineHeight:1.2,whiteSpace:"normal",wordBreak:"break-word",border:"1px solid #93c5fd",color:"#1e40af",cursor:n?Ve?"grabbing":"grab":"default",opacity:n?1:.6,"&:hover":n?{backgroundColor:"#bfdbfe",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}:{}},children:[J.ProjectName," - ",J.PositionName," - ",O(J.LoE,J.AllocationMode||"%")]})},ye=({resourceId:J,monthIndex:fe,children:xe,isActive:Ne,isValidDropTarget:Me})=>{const{isOver:Ve,setNodeRef:Qe}=nne({id:`cell-${J}-${fe}`,disabled:!Ne||Me===!1||!n});return d.jsx(Q,{ref:Qe,align:"center",onClick:()=>Ne&&n&&Fe(J,fe),sx:{cursor:Ne&&n?"pointer":"default",backgroundColor:Ne?Me===!1?"#ffebee":Ve?"#e3f2fd":"white":"white","&:hover":Ne&&n?{backgroundColor:Me===!1?"#ffebee":Ve?"#e3f2fd":"#f5f5f5"}:{},p:.5,width:w(),minWidth:w(),height:"16px",position:"relative",overflow:"hidden",border:"1px solid #e0e0e0"},children:xe})},{data:ze,isLoading:Re}=zs({queryKey:["resources"],queryFn:o_,staleTime:1e3*60*5,refetchOnWindowFocus:!1,refetchOnReconnect:!1}),{data:ve}=zs({queryKey:["positions"],queryFn:mee,staleTime:1e3*60*5,refetchOnWindowFocus:!1,refetchOnReconnect:!1}),{data:V}=zs({queryKey:["allocations"],queryFn:lee,staleTime:1e3*60*5,refetchOnWindowFocus:!1,refetchOnReconnect:!1}),{data:ue}=zs({queryKey:["projects"],queryFn:lk,staleTime:1e3*60*5,refetchOnWindowFocus:!1,refetchOnReconnect:!1}),Ee=Ua({mutationFn:a_,onSuccess:()=>{r.invalidateQueries({queryKey:["allocations"]}),r.invalidateQueries({queryKey:["positions"]}),K({open:!1,resourceId:"",monthIndex:0,monthYear:""}),ie({ProjectName:"",ResourceName:"",PositionName:"",MonthYear:"",AllocationMode:"",LoE:0})},onError:J=>{console.error("Allocation creation failed:",J),alert("Failed to create allocation: "+(J.response?.data?.error||J.message))}}),Ie=Ua({mutationFn:cee,onSuccess:()=>{r.invalidateQueries({queryKey:["allocations"]}),r.invalidateQueries({queryKey:["positions"]})},onError:J=>{console.error("Drag allocation failed:",J),alert("Failed to create allocation: "+(J.response?.data?.error||J.message))}}),ae=Ua({mutationFn:BT,onSuccess:()=>{r.invalidateQueries({queryKey:["allocations"]}),r.invalidateQueries({queryKey:["positions"]}),K({open:!1,resourceId:"",monthIndex:0,monthYear:""}),ie({ProjectName:"",ResourceName:"",PositionName:"",MonthYear:"",AllocationMode:"",LoE:0})}}),be=ze??[],Te=ve??[],tt=V??[],je=ue??[],Pe=E.useMemo(()=>{if(!je.length||!C.length)return[];const J=ga(C[0]),fe=Ti(C[C.length-1]);return je.filter(xe=>{if(!xe.StartDate)return!1;const Ne=new Date(xe.StartDate),Me=xe.EndDate?new Date(xe.EndDate):new Date("2099-12-31");return Ne<=fe&&Me>=J})},[je,C]);E.useEffect(()=>{const J=async()=>{try{const fe=C.map(Ne=>In(ga(Ne),"yyyy-MM-dd"));console.log("Running position validation for months:",fe);const xe=await xee(fe);xe.changesCount>0?(console.log("Position validation made changes:",xe),r.invalidateQueries({queryKey:["allocations"]}),r.invalidateQueries({queryKey:["positions"]})):console.log("Position validation: no changes needed")}catch(fe){console.error("Position validation failed:",fe)}};ve&&ve.length>=0&&J()},[t]);const Be=J=>{const fe=C[J],xe=In(fe,"MMMM yyyy");X({open:!0,monthIndex:J,monthYear:xe})},Fe=(J,fe)=>{if(!n)return;const xe=C[fe],Ne=In(xe,"MMMM yyyy"),Me={ProjectName:"",ResourceName:be.find(Ve=>Ve.ID===J)?.Name||"",PositionName:"",MonthYear:In(xe,"yyyy-MM-dd"),AllocationMode:"",LoE:0};ie(Me),K({open:!0,resourceId:J,monthIndex:fe,monthYear:Ne})},Ge=J=>{let fe=J.LoE;const xe=J?.AllocationMode?.toLowerCase()?.trim();(xe==="days"||xe==="day")&&(fe=Math.round(J.LoE/20*100)),ie({ProjectName:J.ProjectName||"",ResourceName:ee.ResourceName,PositionName:J.PositionName,MonthYear:J.MonthYear,AllocationMode:"%",LoE:fe})},Oe=()=>{if(!Te.find(fe=>fe.PositionName===ee.PositionName&&fe.Allocated==="No")){alert("Please select a valid position");return}Ee.mutate(ee)},mt=E.useMemo(()=>be.filter(J=>{if(J.Track===!1||!J.StartDate)return!1;const fe=new Date(J.StartDate),xe=J.EndDate?new Date(J.EndDate):null;let Ne=!1;for(const Me of C){const Ve=ga(Me),Qe=Ti(Me);if(Ya(Ve,{start:fe,end:xe||new Date("2099-12-31")})||Ya(Qe,{start:fe,end:xe||new Date("2099-12-31")})||bu(fe,Ve)&&(!xe||yu(xe||new Date("2099-12-31"),Qe))){Ne=!0;break}}return Ne?I!=="all"?tt.some(Ve=>Ve.ResourceID===J.ID&&Ve.ProjectID===I):!0:!1}),[be,C,I,tt,f]),qe=E.useMemo(()=>{const J=mt.reduce((fe,xe)=>{const Ne=xe.Department||"Unknown Department";return fe[Ne]||(fe[Ne]=[]),fe[Ne].push(xe),fe},{});return Object.entries(J).sort((fe,xe)=>fe[0].localeCompare(xe[0])).map(([fe,xe])=>[fe,xe.sort((Ne,Me)=>Ne.Name.localeCompare(Me.Name))])},[mt]),Ae=E.useMemo(()=>C.map(J=>{const fe=ga(J),xe=Ti(J);return Te.filter(Ne=>{if(!Ne.MonthYear||Ne.Allocated!=="No")return!1;const Me=ga(new Date(Ne.MonthYear));return Ya(Me,{start:fe,end:xe})?I!=="all"?Ne.Project===I:!0:!1}).sort((Ne,Me)=>Ne.PositionName.localeCompare(Me.PositionName))}),[C,Te,I,f]),te=async()=>{const J=await K5(()=>Promise.resolve().then(()=>qR),[]),fe=J.utils.book_new(),xe=C[W.monthIndex],Ne=ga(xe),Me=Ti(xe),Ve=[...new Set(tt.filter(Wt=>{const _t=new Date(Wt.MonthYear);return Ya(_t,{start:Ne,end:Me})}).map(Wt=>Wt.ProjectName||"Unknown Project"))],Qe=[],rt=[],st=["Resource Name","Department",...Ve,"Total"];Qe.push(st),rt.push("header"),qe.forEach(([Wt,_t])=>{Qe.push([Wt,"",...Array(Ve.length+1).fill("")]),rt.push("department"),_t.forEach(at=>{const Et=[at.Name,at.Department||""],qt=tt.filter(Sn=>Sn.ResourceID===at.ID&&(()=>{const Zt=new Date(Sn.MonthYear);return Ya(Zt,{start:Ne,end:Me})})());Ve.forEach(Sn=>{const Zt=qt.find(Kn=>Kn.ProjectName===Sn);if(Zt){let Kn;A==="days"?Kn=F(Zt.LoE):Kn=Zt.LoE,Et.push(A==="days"?`${Kn}d`:`${Kn}%`)}else Et.push("-")});const gn=qt.reduce((Sn,Zt)=>Sn+Zt.LoE,0);if(gn>0){let Sn;A==="days"?Sn=qt.reduce((Zt,Kn)=>Zt+F(Kn.LoE),0):Sn=gn,Et.push(A==="days"?`${Sn}d`:`${Sn}%`)}else Et.push("-");Qe.push(Et),rt.push("resource")})});const it=J.utils.aoa_to_sheet(Qe),xt={header:{fill:"005272",font:"FFFFFF",bold:!0},department:{fill:"ADD8E6",font:"000000",bold:!0},resource:{fill:"FFFFFF",font:"000000",bold:!1}},pt=2+Ve.length+1;Qe.forEach((Wt,_t)=>{const at=rt[_t],Et=xt[at];for(let qt=0;qt<pt;qt++){const gn=J.utils.encode_cell({r:_t,c:qt});it[gn]||(it[gn]={v:"",t:"s"});let Sn="left";(at==="header"||qt>=2)&&(Sn="center"),it[gn].s={fill:{patternType:"solid",fgColor:{rgb:Et.fill}},font:{name:"Arial",sz:8,bold:Et.bold,color:{rgb:Et.font}},border:{top:{style:"thin",color:{rgb:"CCCCCC"}},bottom:{style:"thin",color:{rgb:"CCCCCC"}},left:{style:"thin",color:{rgb:"CCCCCC"}},right:{style:"thin",color:{rgb:"CCCCCC"}}},alignment:{horizontal:Sn,vertical:"center",wrapText:!1}}}}),it["!cols"]=[{wch:25},{wch:20},...Array(Ve.length).fill({wch:18}),{wch:12}],it["!rows"]=Qe.map(()=>({hpx:25})),J.utils.book_append_sheet(fe,it,`Monthly Allocation ${In(xe,"MMM yyyy")}`);const Yt=J.write(fe,{bookType:"xlsx",type:"array",cellStyles:!0}),Kt=new Blob([Yt],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),tn=`Monthly_Allocation_${In(xe,"yyyy-MM")}_${In(new Date,"yyyy-MM-dd")}.xlsx`;X2.saveAs(Kt,tn)},pe=async()=>{const J=await K5(()=>Promise.resolve().then(()=>qR),void 0),fe=J.utils.book_new(),xe=[],Ne=[],Me=["Resource Name","Department",...C.map(Kt=>In(Kt,"MMM yyyy"))];xe.push(Me),Ne.push("header");const Ve=["Unallocated",""];C.forEach((Kt,tn)=>{const Wt=Ae[tn];Wt.length>0?Ve.push(Wt.map(_t=>`${_t.PositionName} (${O(_t.LoE,_t.AllocationMode)})`).join(", ")):Ve.push("")}),xe.push(Ve),Ne.push("unallocated"),qe.forEach(([Kt,tn])=>{xe.push([Kt,"",...Array(C.length).fill("")]),Ne.push("department"),tn.forEach(Wt=>{const _t=[Wt.Name,Wt.Department||""];C.forEach(at=>{const Et=ga(at),qt=Ti(at),gn=new Date(Wt.StartDate),Sn=Wt.EndDate?new Date(Wt.EndDate):null;if(!(Ya(Et,{start:gn,end:Sn||new Date("2099-12-31")})||Ya(qt,{start:gn,end:Sn||new Date("2099-12-31")})||bu(gn,Et)&&(!Sn||yu(Sn||new Date("2099-12-31"),qt)))){_t.push("Not Active");return}const Kn=tt.filter($t=>$t.ResourceID===Wt.ID&&(()=>{const Cr=new Date($t.MonthYear);return Ya(Cr,{start:Et,end:qt})})());if(Kn.length>0){const $t=Kn.map(Cr=>`${Cr.ProjectName} - ${Cr.PositionName} (${O(Cr.LoE,Cr.AllocationMode)})`).join(", ");_t.push($t)}else _t.push("0%")}),xe.push(_t),Ne.push("resource")})});const Qe=J.utils.aoa_to_sheet(xe),rt={header:{fill:"005272",font:"FFFFFF",bold:!0},unallocated:{fill:"FFE4E1",font:"000000",bold:!0},department:{fill:"ADD8E6",font:"000000",bold:!0},resource:{fill:"FFFFFF",font:"000000",bold:!1}},st=2+C.length;xe.forEach((Kt,tn)=>{const Wt=Ne[tn],_t=rt[Wt];for(let at=0;at<st;at++){const Et=J.utils.encode_cell({r:tn,c:at});Qe[Et]||(Qe[Et]={v:"",t:"s"});let qt="left";(Wt==="header"||at>=2)&&(qt="center"),Qe[Et].s={fill:{patternType:"solid",fgColor:{rgb:_t.fill}},font:{name:"Arial",sz:8,bold:_t.bold,color:{rgb:_t.font}},border:{top:{style:"thin",color:{rgb:"CCCCCC"}},bottom:{style:"thin",color:{rgb:"CCCCCC"}},left:{style:"thin",color:{rgb:"CCCCCC"}},right:{style:"thin",color:{rgb:"CCCCCC"}}},alignment:{horizontal:qt,vertical:"center",wrapText:!0}}}}),Qe["!cols"]=[{wch:25},{wch:20},...Array(C.length).fill({wch:30})],Qe["!rows"]=xe.map(()=>({hpx:25})),J.utils.book_append_sheet(fe,Qe,"Resource Allocation");const it=[["Project Name","Position Name","Month","LoE","Allocation Mode"]];if(Ae.forEach((Kt,tn)=>{Kt.forEach(Wt=>{it.push([Wt.ProjectName,Wt.PositionName,In(C[tn],"MMM yyyy"),Wt.LoE,Wt.AllocationMode])})}),it.length>1){const Kt=J.utils.aoa_to_sheet(it),tn=5;it.forEach((Wt,_t)=>{const at=_t===0,Et=at?rt.header:rt.resource;for(let qt=0;qt<tn;qt++){const gn=J.utils.encode_cell({r:_t,c:qt});Kt[gn]||(Kt[gn]={v:"",t:"s"}),Kt[gn].s={fill:{patternType:"solid",fgColor:{rgb:Et.fill}},font:{name:"Arial",sz:8,bold:Et.bold,color:{rgb:Et.font}},border:{top:{style:"thin",color:{rgb:"CCCCCC"}},bottom:{style:"thin",color:{rgb:"CCCCCC"}},left:{style:"thin",color:{rgb:"CCCCCC"}},right:{style:"thin",color:{rgb:"CCCCCC"}}},alignment:{horizontal:at?"center":"left",vertical:"center",wrapText:!1}}}}),Kt["!cols"]=[{wch:25},{wch:30},{wch:15},{wch:10},{wch:18}],Kt["!rows"]=it.map(()=>({hpx:25})),J.utils.book_append_sheet(fe,Kt,"Unallocated Positions")}const xt=J.write(fe,{bookType:"xlsx",type:"array",cellStyles:!0}),pt=new Blob([xt],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Yt=`Resource_Allocation_${In(new Date,"yyyy-MM-dd")}.xlsx`;X2.saveAs(pt,Yt)};return d.jsx(qte,{sensors:ce,collisionDetection:tte,onDragStart:ne,onDragEnd:Se,children:d.jsxs(_e,{sx:{px:0,py:2},children:[d.jsxs(_e,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"white",p:2,borderRadius:1,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",border:"1px solid rgba(0, 0, 0, 0.12)"},children:[d.jsx(We,{variant:"h6",component:"h2",sx:{fontWeight:600,color:"#1f2937"},children:"Resource Allocation Table"}),d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:2},children:[d.jsxs(Hr,{size:"small",sx:{minWidth:120},children:[d.jsx(Qi,{id:"quarter-filter-label",children:"Quarter"}),d.jsxs(Wr,{labelId:"quarter-filter-label",value:f,label:"Quarter",onChange:J=>m(J.target.value),sx:{backgroundColor:"white"},children:[d.jsx(ln,{value:"1Q",children:"1Q (3 months)"}),d.jsx(ln,{value:"2Q",children:"2Q (6 months)"}),d.jsx(ln,{value:"3Q",children:"3Q (9 months)"})]})]}),d.jsxs(Hr,{size:"small",sx:{minWidth:200},children:[d.jsx(Qi,{id:"project-filter-label",children:d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:.5},children:[d.jsx(MC,{sx:{fontSize:18}}),"Project Filter"]})}),d.jsxs(Wr,{labelId:"project-filter-label",value:I,label:"Project Filter",onChange:J=>M(J.target.value),sx:{backgroundColor:"white"},children:[d.jsx(ln,{value:"all",children:"All Projects"}),Pe.map(J=>d.jsx(ln,{value:J.ID,children:J.Name},J.ID))]})]}),d.jsx(Mo,{title:"Open Gantt Chart",children:d.jsx(_r,{onClick:()=>e("/gantt"),sx:{backgroundColor:"white",border:"1px solid rgba(0,0,0,0.12)","&:hover":{backgroundColor:"#f3f4f6"},p:1},children:d.jsx(Jy,{})})}),d.jsxs(MD,{value:A,exclusive:!0,onChange:(J,fe)=>fe&&R(fe),size:"small",sx:{"& .MuiToggleButton-root":{px:3,py:1,fontSize:"0.875rem",fontWeight:500,border:"1px solid rgba(0, 0, 0, 0.23)","&:not(:first-of-type)":{borderRadius:"0 4px 4px 0"},"&:first-of-type":{borderRadius:"4px 0 0 4px"},"&.Mui-selected":{backgroundColor:"#3b82f6",color:"white","&:hover":{backgroundColor:"#2563eb"}},"&:not(.Mui-selected)":{backgroundColor:"white",color:"#374151","&:hover":{backgroundColor:"#f3f4f6"}}}},children:[d.jsx(Ex,{value:"percentage",children:"%"}),d.jsx(Ex,{value:"days",children:"Days"})]}),d.jsx(Mo,{title:"Download to Excel",children:d.jsx(_r,{onClick:pe,sx:{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},children:d.jsx(yp,{})})})]})]}),d.jsx(qa,{component:ua,sx:{mt:1,maxWidth:"none",width:"100%",ml:0,mr:0,pl:0,pr:0,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",borderRadius:1,border:"1px solid rgba(0, 0, 0, 0.12)",maxHeight:"80vh",overflow:"auto"},children:d.jsxs(Ba,{size:"small",sx:{width:"auto",minWidth:"100%",tableLayout:"auto"},stickyHeader:!0,children:[d.jsx(wa,{sx:{backgroundColor:"#f9fafb"},children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{width:"200px",minWidth:"200px",fontWeight:600,color:"#374151",border:"1px solid rgba(0, 0, 0, 0.12)",fontSize:"0.875rem",position:"sticky",left:0,zIndex:3,backgroundColor:"#f3f4f6"},children:"Name"}),C.map((J,fe)=>d.jsx(Q,{align:"center",sx:{width:w(),minWidth:w(),cursor:"pointer",backgroundColor:"#f3f4f6",fontWeight:600,color:"#374151",border:"1px solid rgba(0, 0, 0, 0.12)",fontSize:"0.875rem","&:hover":{backgroundColor:"#e5e7eb"},textDecoration:"underline"},onClick:()=>Be(fe),children:d.jsx(_e,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:d.jsx(We,{variant:"body2",sx:{fontWeight:600},children:In(J,"MMM yyyy")})})},fe))]})}),d.jsxs(za,{children:[d.jsxs(hn,{children:[d.jsx(Q,{sx:{width:"200px",minWidth:"200px",fontWeight:600,color:"#6b7280",border:"1px solid rgba(0, 0, 0, 0.12)",fontSize:"0.75rem",position:"sticky",left:0,zIndex:1,backgroundColor:"#f9fafb"},children:"Unallocated"}),C.map((J,fe)=>d.jsx(Q,{align:"center",sx:{p:.5,width:w(),minWidth:w(),backgroundColor:"#f9fafb",border:"1px solid rgba(0, 0, 0, 0.12)",verticalAlign:"top"},children:Ae[fe].length>0?d.jsx(_e,{sx:{display:"flex",flexDirection:"column",gap:.5,maxHeight:"120px",overflowY:"auto"},children:Ae[fe].map(xe=>d.jsx(se,{position:xe},xe.ID))}):d.jsx(We,{variant:"body2",sx:{color:"#9ca3af",fontSize:"0.75rem"},children:"-"})},fe))]}),qe.map(([J,fe])=>d.jsxs(Jr.Fragment,{children:[d.jsx(hn,{children:d.jsx(Q,{colSpan:10,sx:{backgroundColor:"grey.300",fontWeight:"bold",fontSize:"0.75rem",p:.5,height:"24px"},children:J})}),fe.map(xe=>d.jsxs(hn,{hover:!0,children:[d.jsx(Q,{component:"th",scope:"row",sx:{pl:2,pr:1,py:.25,width:"200px",minWidth:"200px",fontSize:"0.8rem",position:"sticky",left:0,zIndex:1,backgroundColor:"white"},children:xe.Name}),C.map((Ne,Me)=>{const Ve=ga(Ne),Qe=Ti(Ne),rt=new Date(xe.StartDate),st=xe.EndDate?new Date(xe.EndDate):null,it=Ya(Ve,{start:rt,end:st||new Date("2099-12-31")})||Ya(Qe,{start:rt,end:st||new Date("2099-12-31")})||bu(rt,Ve)&&(!st||yu(st||new Date("2099-12-31"),Qe));return d.jsx(ye,{resourceId:xe.ID,monthIndex:Me,isActive:it,isValidDropTarget:oe?ga(new Date(oe.MonthYear)).getTime()===ga(Ne).getTime():void 0,children:(()=>{const xt=new Date(xe.StartDate),pt=xe.EndDate?new Date(xe.EndDate):null,Yt=bu(Qe,xt),Kt=pt&&yu(Ve,pt),tn=!Yt&&!Kt;if(Yt)return d.jsx(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.6rem",color:"text.secondary"},children:"Not Started"})});if(Kt)return d.jsx(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.6rem",color:"text.secondary"},children:"Ended"})});const Wt=tt.filter(_t=>_t.ResourceID===xe.ID&&(()=>{const at=new Date(_t.MonthYear);return Ya(at,{start:Ve,end:Qe})})()&&(I==="all"||_t.ProjectID===I));if(Wt.length>0){let _t=0;Wt.forEach(gn=>{_t+=gn.LoE});let at=_t,Et=_t;A==="days"&&(at=_t*20/100,Et=at*100/20);const qt=U(at,A==="days"?"days":"%");return d.jsx(Mo,{title:d.jsx("div",{children:Wt.map(gn=>d.jsxs("div",{children:[gn.ProjectName," - ",gn.PositionName," - ",O(gn.LoE,gn.AllocationMode)]},gn.ID))}),arrow:!0,placement:"top",children:d.jsx(_e,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"transparent",borderRadius:1,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsx(_e,{sx:{position:"absolute",top:0,left:0,height:"100%",width:`${Math.min(100,Math.max(0,Et))}%`,backgroundColor:qt,transition:"width 0.3s ease",zIndex:0,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:1},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.5rem",fontWeight:"bold",color:"black",lineHeight:1,position:"relative",zIndex:1},children:A==="days"?`${at}d`:`${at}%`})})})})}else if(tn)return d.jsx(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.5rem",color:"text.secondary"},children:A==="days"?"0d":"0%"})});return null})()},Me)})]},xe.ID))]},J)),Object.keys(qe).length===0&&!Re&&d.jsx(hn,{children:d.jsx(Q,{colSpan:10,align:"center",children:"No resources found for the displayed period"})})]})]})}),d.jsxs(oi,{open:H.open,onClose:()=>K({...H,open:!1}),maxWidth:"sm",fullWidth:!0,sx:{"& .MuiDialog-paper":{p:2}},children:[d.jsxs(Ii,{children:["Create Allocation - ",H.monthYear]}),d.jsx(ai,{sx:{p:2},children:d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[d.jsx(On,{label:"Project Name",value:ee.ProjectName,fullWidth:!0,disabled:!0,size:"small"}),d.jsx(On,{label:"Resource Name",value:ee.ResourceName,fullWidth:!0,disabled:!0,size:"small"}),d.jsx(On,{label:"Position Name",value:ee.PositionName,fullWidth:!0,disabled:!0,size:"small"}),d.jsx(On,{label:"Month Year",value:H.monthYear,fullWidth:!0,disabled:!0,size:"small"}),d.jsx(On,{label:"Allocation Mode",value:ee.AllocationMode,fullWidth:!0,disabled:!0,size:"small"}),d.jsx(On,{label:"LoE",value:`${ee.LoE}%${A==="days"?` (${F(ee.LoE)} days)`:""}`,fullWidth:!0,disabled:!0,size:"small"}),(()=>{const J=C[H.monthIndex],fe=ga(J),xe=Ti(J),Ne=tt.filter(Me=>Me.ResourceID===H.resourceId&&(()=>{const Ve=new Date(Me.MonthYear);return Ya(Ve,{start:fe,end:xe})})());return Ne.length>0?d.jsxs(d.Fragment,{children:[d.jsxs(We,{variant:"h6",sx:{mt:1,mb:1},children:["Existing Allocations for ",H.monthYear]}),d.jsx(_e,{sx:{display:"flex",flexDirection:"column",gap:.5},children:Ne.map(Me=>{const Ve=Me.ProjectName||"Unknown Project",Qe=Me.PositionName||"Unknown Position";let rt=Me.LoE;A==="days"&&(rt=Me.LoE*20/100);const st=U(rt,A==="days"?"days":"%");return d.jsxs(_e,{sx:{p:.5,border:1,borderColor:"divider",borderRadius:.5,backgroundColor:"grey.50"},children:[d.jsxs(_e,{sx:{position:"relative",height:"16px",backgroundColor:"rgba(0,0,0,0.1)",borderRadius:.5,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",mb:.25},children:[d.jsx(_e,{sx:{position:"absolute",top:0,left:0,height:"100%",width:`${Math.min(100,Math.max(0,Me.LoE))}%`,backgroundColor:st,transition:"width 0.3s ease",zIndex:0}}),d.jsxs(We,{variant:"caption",sx:{fontSize:"0.5rem",fontWeight:"bold",color:"text.primary",lineHeight:1,position:"relative",zIndex:1,textAlign:"center",px:.5},children:[Ve,"  ",Qe,"  ",A==="days"?`${rt}d`:`${rt}%`]})]}),d.jsx(_e,{sx:{display:"flex",justifyContent:"flex-end"},children:d.jsx(Un,{size:"small",variant:"outlined",color:"error",onClick:()=>ae.mutate(Me.ID),sx:{fontSize:"0.6rem",minHeight:"18px",px:1,py:.25},children:"Remove"})})]},Me.ID)})})]}):null})(),(()=>{const J=be.find(rt=>rt.ID===H.resourceId),fe=C[H.monthIndex],xe=ga(fe),Ne=Ti(fe),Me=new Date(J?.StartDate||""),Ve=J?.EndDate?new Date(J.EndDate):null;return J&&Ya(xe,{start:Me,end:Ve||new Date("2099-12-31")})||Ya(Ne,{start:Me,end:Ve||new Date("2099-12-31")})||bu(Me,xe)&&(!Ve||yu(Ve||new Date("2099-12-31"),Ne))?d.jsxs(d.Fragment,{children:[d.jsxs(We,{variant:"h6",sx:{mt:1,mb:1},children:["Unallocated Positions for ",H.monthYear]}),Ae[H.monthIndex]?.length>0?d.jsx(_e,{sx:{display:"flex",flexDirection:"column",gap:.5},children:Ae[H.monthIndex].map(rt=>d.jsxs(_e,{sx:{p:1.5,border:1,borderColor:"divider",borderRadius:1,cursor:"pointer","&:hover":{backgroundColor:"action.hover"},transition:"background-color 0.2s"},onClick:()=>Ge(rt),children:[d.jsx(We,{variant:"body2",sx:{fontWeight:"medium"},children:rt.PositionName}),d.jsxs(We,{variant:"caption",color:"text.secondary",children:[rt.ProjectName,"  ",rt.AllocationMode,"  LoE: ",(()=>{const st=rt?.AllocationMode?.toLowerCase()?.trim(),it=st==="days"||st==="day";return O(rt.LoE,it?"days":"%")})()]})]},rt.ID))}):d.jsx(We,{color:"text.secondary",children:"No unallocated positions available for this month"})]}):d.jsxs(We,{color:"text.secondary",children:["Resource is not active for ",H.monthYear]})})(),d.jsxs(_e,{sx:{display:"flex",gap:2,mt:2},children:[d.jsx(Un,{variant:"contained",onClick:Oe,disabled:!ee.PositionName,children:"Apply Allocation"}),d.jsx(Un,{variant:"outlined",onClick:()=>K({...H,open:!1}),children:"Cancel"})]})]})})]}),d.jsxs(oi,{open:W.open,onClose:()=>X({...W,open:!1}),maxWidth:"xl",fullWidth:!0,fullScreen:!0,sx:{"& .MuiDialog-paper":{p:2}},children:[d.jsxs(Ii,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("span",{children:["Monthly Allocation View - ",W.monthYear]}),d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:2},children:[d.jsxs(MD,{value:A,exclusive:!0,onChange:(J,fe)=>fe&&R(fe),size:"small",sx:{"& .MuiToggleButton-root":{px:2,py:.5,fontSize:"0.875rem",fontWeight:500,border:"1px solid rgba(0, 0, 0, 0.23)","&:not(:first-of-type)":{borderRadius:"0 4px 4px 0"},"&:first-of-type":{borderRadius:"4px 0 0 4px"},"&.Mui-selected":{backgroundColor:"#3b82f6",color:"white","&:hover":{backgroundColor:"#2563eb"}},"&:not(.Mui-selected)":{backgroundColor:"white",color:"#374151","&:hover":{backgroundColor:"#f3f4f6"}}}},children:[d.jsx(Ex,{value:"percentage",children:"%"}),d.jsx(Ex,{value:"days",children:"Days"})]}),d.jsx(Mo,{title:"Download to Excel",children:d.jsx(_r,{onClick:te,sx:{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},children:d.jsx(yp,{})})}),d.jsx(Mo,{title:"Close",children:d.jsx(_r,{onClick:()=>X({...W,open:!1}),sx:{backgroundColor:"grey.600",color:"white","&:hover":{backgroundColor:"grey.700"}},children:d.jsx(LH,{})})})]})]}),d.jsx(ai,{sx:{p:0,maxHeight:"70vh",overflow:"auto"},children:d.jsxs(Ba,{size:"small",sx:{"& .MuiTableCell-root":{py:0,px:0},"& .MuiTableRow-root":{height:"auto"}},children:[d.jsx(wa,{sx:{position:"sticky",top:0,zIndex:10,backgroundColor:"#f8f9fa",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{width:"150px",minWidth:"150px",py:1,px:1,backgroundColor:"#f8f9fa",fontSize:"0.75rem",fontWeight:600},children:"Resource"}),(()=>{const J=C[W.monthIndex],fe=ga(J),xe=Ti(J);return[...new Set(tt.filter(Me=>{const Ve=new Date(Me.MonthYear);return Ya(Ve,{start:fe,end:xe})}).map(Me=>Te.find(Qe=>Qe.ID===Me.PositionID)?.ProjectName||"Unknown Project"))].map((Me,Ve)=>d.jsx(Q,{align:"center",sx:{width:"100px",minWidth:"100px",py:1,px:.5,backgroundColor:"#f8f9fa",fontSize:"0.75rem",fontWeight:600},children:Me},Ve))})(),d.jsx(Q,{align:"center",sx:{width:"100px",minWidth:"100px",py:1,px:.5,backgroundColor:"#f8f9fa",fontSize:"0.75rem",fontWeight:600},children:"Total"})]})}),d.jsx(za,{children:qe.map(([J,fe])=>d.jsxs(Jr.Fragment,{children:[d.jsx(hn,{children:d.jsx(Q,{colSpan:20,sx:{backgroundColor:"#e9ecef",fontWeight:600,fontSize:"0.7rem",py:.5,px:1,color:"#495057"},children:J})}),fe.map(xe=>{const Ne=C[W.monthIndex],Me=ga(Ne),Ve=Ti(Ne),Qe=tt.filter(it=>it.ResourceID===xe.ID&&(()=>{const xt=new Date(it.MonthYear);return Ya(xt,{start:Me,end:Ve})})()&&(I==="all"||it.ProjectID===I)),rt=[...new Set(tt.filter(it=>{const xt=new Date(it.MonthYear);return Ya(xt,{start:Me,end:Ve})}).map(it=>it.ProjectName||"Unknown Project"))],st=Qe.reduce((it,xt)=>it+xt.LoE,0);return d.jsxs(hn,{hover:!0,sx:{"&:hover":{backgroundColor:"#f8f9fa"}},children:[d.jsx(Q,{component:"th",scope:"row",sx:{pl:2,py:.5,px:1,fontSize:"0.75rem"},children:xe.Name}),rt.map(it=>{const xt=Qe.find(pt=>pt.ProjectName===it);return d.jsx(Q,{align:"center",sx:{p:.25,py:.5},children:xt?d.jsx(_e,{sx:{backgroundColor:"#1976d2",color:"white",px:.75,py:.25,borderRadius:1,fontSize:"0.65rem",fontWeight:600,display:"inline-block"},children:(()=>{let pt;return A==="days"?pt=F(xt.LoE):pt=xt.LoE,A==="days"?`${pt}d`:`${pt}%`})()}):"-"},it)}),d.jsx(Q,{align:"center",sx:{p:.25,py:.5,width:"100px",minWidth:"100px"},children:st>0?d.jsxs(_e,{sx:{position:"relative",width:"100%"},children:[d.jsx($z,{variant:"determinate",value:Math.min(st,100),sx:{width:"100%",height:20,borderRadius:2,backgroundColor:"grey.300","& .MuiLinearProgress-bar":{backgroundColor:A==="days"?F(st)>=17&&F(st)<=24?"#4caf50":F(st)>24?"#f44336":"#ffb300":st>=85&&st<=120?"#4caf50":st>120?"#f44336":"#ffb300",borderRadius:2}}}),d.jsx(We,{variant:"caption",sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.7rem",fontWeight:"bold",color:"white",textShadow:"0 0 2px rgba(0,0,0,0.5)"},children:(()=>{let it;return A==="days"?it=Qe.reduce((xt,pt)=>xt+F(pt.LoE),0):it=Qe.reduce((xt,pt)=>xt+pt.LoE,0),A==="days"?`${it}d`:`${it}%`})()})]}):"-"})]},xe.ID)})]},J))})]})})]}),d.jsx(mne,{children:de&&oe?d.jsxs(_e,{sx:{backgroundColor:"#dbeafe",p:1,borderRadius:.5,fontSize:"0.60rem",fontWeight:"normal",lineHeight:1.2,whiteSpace:"normal",wordBreak:"break-word",border:"1px solid #93c5fd",color:"#1e40af",boxShadow:"0 4px 8px rgba(0,0,0,0.2)",opacity:.9},children:[oe.ProjectName," - ",oe.PositionName," - ",O(oe.LoE,oe.AllocationMode||"%")]}):null})]})})}function D_({selectedDate:t}){const{data:e,isLoading:r,error:a}=zs({queryKey:["projects"],queryFn:lk,staleTime:3e5}),o=e??[],n=E.useMemo(()=>Array.from({length:18},(R,I)=>BC(ga(t),I)),[t]),f=R=>{if(!R)return null;if(R.includes("T")||R.includes("Z")||R.match(/\+\d{2}:?\d{2}/))return new Date(R);try{return YA(R,"yyyy-MM-dd",new Date)}catch{return new Date(R)}},m=(R,I)=>{if(!R||!I)return"unknown";const M=new Date;M.setHours(0,0,0,0);const F=new Date(R);F.setHours(0,0,0,0);const O=new Date(I);return O.setHours(0,0,0,0),O<M?"completed":F>M?"upcoming":"active"},y=(R,I)=>{switch(m(R,I)){case"completed":return"#616161";case"upcoming":return"#2196f3";case"active":return"#4caf50";default:return"#9e9e9e"}},C=E.useMemo(()=>{const R=[],I=[],M=[];return o.forEach(F=>{const O=f(F.StartDate),j=f(F.EndDate);switch(m(O,j)){case"active":R.push(F);break;case"upcoming":I.push(F);break;case"completed":M.push(F);break;default:M.push(F)}}),{active:R,upcoming:I,completed:M}},[o]),w=(R,I)=>{const M=f(R.StartDate),F=f(R.EndDate);if(!M||!F)return!1;const O=ga(I),j=Ti(I);return!(yu(M,j)||bu(F,O))},A=(R,I)=>{const M=f(R.StartDate),F=f(R.EndDate);return!M||!F||!w(R,I)?null:{backgroundColor:y(M,F),height:"100%",minHeight:"20px",borderRadius:"0",width:"100%"}};return a?d.jsx(_e,{sx:{p:3,display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:d.jsxs(We,{color:"error",children:["Error loading projects: ",a.message]})}):r?d.jsx(_e,{sx:{p:3,display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:d.jsx(We,{children:"Loading Gantt Chart..."})}):o.length===0?d.jsxs(_e,{sx:{p:3},children:[d.jsxs(_e,{sx:{mb:3,display:"flex",alignItems:"center",gap:2},children:[d.jsx(Un,{variant:"outlined",startIcon:d.jsx(_D,{}),onClick:()=>window.history.back(),children:"Back"}),d.jsxs(We,{variant:"h4",sx:{fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:[d.jsx(Jy,{}),"Gantt Chart"]})]}),d.jsx(Ta,{children:d.jsx(Aa,{sx:{textAlign:"center",py:8},children:d.jsx(We,{variant:"h6",color:"text.secondary",children:"No projects found. Create some projects first to see the Gantt chart."})})})]}):d.jsxs(_e,{sx:{p:2,backgroundColor:"#f8f9fa",minHeight:"100vh"},children:[d.jsxs(_e,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:2},children:[d.jsx(Un,{variant:"outlined",size:"small",startIcon:d.jsx(_D,{}),onClick:()=>window.history.back(),children:"Back"}),d.jsxs(We,{variant:"h5",sx:{fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:[d.jsx(Jy,{}),"Project Gantt Chart"]})]}),d.jsxs(_e,{sx:{display:"flex",gap:1},children:[d.jsx(Sa,{label:"Active",sx:{backgroundColor:"#4caf50",color:"white"},size:"small"}),d.jsx(Sa,{label:"Upcoming",sx:{backgroundColor:"#2196f3",color:"white"},size:"small"}),d.jsx(Sa,{label:"Completed",sx:{backgroundColor:"#616161",color:"white"},size:"small"})]})]}),d.jsx(qa,{component:ua,sx:{boxShadow:2},children:d.jsxs(Ba,{size:"small",sx:{tableLayout:"fixed"},children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{backgroundColor:"#f5f5f5"},children:[d.jsx(Q,{sx:{width:"280px",fontWeight:"bold",borderRight:"2px solid #e0e0e0",py:.75,fontSize:"0.8rem"},children:"Project Name"}),n.map((R,I)=>d.jsxs(Q,{align:"center",sx:{fontWeight:"bold",borderRight:"1px solid #e0e0e0",py:.5,px:.5,fontSize:"0.7rem",minWidth:"55px"},children:[d.jsx(_e,{children:In(R,"MMM")}),d.jsx(_e,{sx:{fontSize:"0.6rem",color:"text.secondary"},children:In(R,"yyyy")})]},I))]})}),d.jsxs(za,{children:[C.active.length>0&&d.jsxs(d.Fragment,{children:[d.jsx(hn,{children:d.jsxs(Q,{colSpan:n.length+1,sx:{backgroundColor:"#e8f5e9",fontWeight:"bold",fontSize:"0.8rem",py:.5,color:"#2e7d32"},children:["Active (",C.active.length,")"]})}),C.active.map(R=>{const I=f(R.StartDate),M=f(R.EndDate);return d.jsxs(hn,{sx:{"&:hover":{backgroundColor:"#f8f9fa"},"& td":{py:.25}},children:[d.jsx(Q,{sx:{borderRight:"2px solid #e0e0e0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",py:.5},children:d.jsx(Mo,{title:`${R.Name} (${I?In(I,"MMM dd, yyyy"):"N/A"} - ${M?In(M,"MMM dd, yyyy"):"N/A"})`,children:d.jsxs(_e,{children:[d.jsx(We,{component:"span",sx:{fontSize:"0.75rem",fontWeight:500},children:R.Name}),d.jsxs(We,{component:"span",sx:{fontSize:"0.65rem",fontStyle:"italic",color:"text.secondary",ml:.5},children:["(",I?In(I,"MMM yy"):"?"," - ",M?In(M,"MMM yy"):"?",")"]})]})})}),n.map((F,O)=>{const j=A(R,F);return d.jsx(Q,{align:"center",sx:{borderRight:"1px solid #e0e0e0",p:0,height:"24px"},children:j&&d.jsx(Mo,{title:`${R.Name}: ${I?In(I,"MMM dd, yyyy"):"N/A"} - ${M?In(M,"MMM dd, yyyy"):"N/A"}`,children:d.jsx(_e,{sx:j})})},O)})]},R.ID)})]}),C.upcoming.length>0&&d.jsxs(d.Fragment,{children:[d.jsx(hn,{children:d.jsxs(Q,{colSpan:n.length+1,sx:{backgroundColor:"#e3f2fd",fontWeight:"bold",fontSize:"0.8rem",py:.5,color:"#1565c0"},children:["Upcoming (",C.upcoming.length,")"]})}),C.upcoming.map(R=>{const I=f(R.StartDate),M=f(R.EndDate);return d.jsxs(hn,{sx:{"&:hover":{backgroundColor:"#f8f9fa"},"& td":{py:.25}},children:[d.jsx(Q,{sx:{borderRight:"2px solid #e0e0e0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",py:.5},children:d.jsx(Mo,{title:`${R.Name} (${I?In(I,"MMM dd, yyyy"):"N/A"} - ${M?In(M,"MMM dd, yyyy"):"N/A"})`,children:d.jsxs(_e,{children:[d.jsx(We,{component:"span",sx:{fontSize:"0.75rem",fontWeight:500},children:R.Name}),d.jsxs(We,{component:"span",sx:{fontSize:"0.65rem",fontStyle:"italic",color:"text.secondary",ml:.5},children:["(",I?In(I,"MMM yy"):"?"," - ",M?In(M,"MMM yy"):"?",")"]})]})})}),n.map((F,O)=>{const j=A(R,F);return d.jsx(Q,{align:"center",sx:{borderRight:"1px solid #e0e0e0",p:0,height:"24px"},children:j&&d.jsx(Mo,{title:`${R.Name}: ${I?In(I,"MMM dd, yyyy"):"N/A"} - ${M?In(M,"MMM dd, yyyy"):"N/A"}`,children:d.jsx(_e,{sx:j})})},O)})]},R.ID)})]}),C.completed.length>0&&d.jsxs(d.Fragment,{children:[d.jsx(hn,{children:d.jsxs(Q,{colSpan:n.length+1,sx:{backgroundColor:"#f5f5f5",fontWeight:"bold",fontSize:"0.8rem",py:.5,color:"#616161"},children:["Completed (",C.completed.length,")"]})}),C.completed.map(R=>{const I=f(R.StartDate),M=f(R.EndDate);return d.jsxs(hn,{sx:{"&:hover":{backgroundColor:"#f8f9fa"},"& td":{py:.25}},children:[d.jsx(Q,{sx:{borderRight:"2px solid #e0e0e0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",py:.5},children:d.jsx(Mo,{title:`${R.Name} (${I?In(I,"MMM dd, yyyy"):"N/A"} - ${M?In(M,"MMM dd, yyyy"):"N/A"})`,children:d.jsxs(_e,{children:[d.jsx(We,{component:"span",sx:{fontSize:"0.75rem",fontWeight:500},children:R.Name}),d.jsxs(We,{component:"span",sx:{fontSize:"0.65rem",fontStyle:"italic",color:"text.secondary",ml:.5},children:["(",I?In(I,"MMM yy"):"?"," - ",M?In(M,"MMM yy"):"?",")"]})]})})}),n.map((F,O)=>{const j=A(R,F);return d.jsx(Q,{align:"center",sx:{borderRight:"1px solid #e0e0e0",p:0,height:"24px"},children:j&&d.jsx(Mo,{title:`${R.Name}: ${I?In(I,"MMM dd, yyyy"):"N/A"} - ${M?In(M,"MMM dd, yyyy"):"N/A"}`,children:d.jsx(_e,{sx:j})})},O)})]},R.ID)})]})]})]})})]})}const Qh=["%","Days"];function yne(){const t=Dd(),{isAuthenticated:e,login:r,logout:a,userDisplayName:o,isLoading:n}=_p(),{getPagePermissions:f}=Gf(),m=f("projects"),[y,C]=E.useState({open:!1,message:"",severity:"success"}),[w,A]=E.useState(""),[R,I]=E.useState("all"),[M,F]=E.useState(!1),[O,j]=E.useState(null),U=(ne,Se="success")=>{C({open:!0,message:ne,severity:Se})},{data:H}=zs({queryKey:["projects"],queryFn:lk,staleTime:1e3*60*5}),{data:K}=zs({queryKey:["systemUsers"],queryFn:fS,staleTime:1e3*60*5}),W=Ua({mutationFn:ne=>aee(ne),onSuccess:()=>{t.invalidateQueries({queryKey:["projects"]}),U("Project created successfully!","success")},onError:ne=>{U(`Error creating project: ${ne.message}`,"error")}}),X=Ua({mutationFn:({id:ne,payload:Se})=>see(ne,Se),onSuccess:()=>{t.invalidateQueries({queryKey:["projects"]}),U("Project updated successfully!","success")},onError:ne=>{U(`Error updating project: ${ne.message}`,"error")}}),ee=Ua({mutationFn:ne=>iee(ne),onSuccess:()=>{t.invalidateQueries({queryKey:["projects"]}),U("Project deleted successfully!","success")},onError:ne=>{console.error("Delete project error:",ne);let Se="Failed to delete project";ne.response?.data?Se=ne.response.data.details||ne.response.data.error||ne.response.data.message||Se:ne.message&&(Se=ne.message),U(Se,"error")}}),[ie,de]=E.useState({Name:"",StartDate:"",EndDate:"",ProjectCurrency:"",ProjectBudget:void 0,BudgetManager:"",AllocationMode:Qh[0],Fringe:"No"}),le=H??[],oe=E.useMemo(()=>K??[],[K]),N=()=>{if(!ie.Name){U("Project name is required!","error");return}W.mutate(ie),de({Name:"",StartDate:"",EndDate:"",ProjectCurrency:"",ProjectBudget:void 0,BudgetManager:"",AllocationMode:Qh[0],Fringe:"No"})},ce=E.useMemo(()=>le.filter(ne=>{const Se=ne.Name.toLowerCase().includes(w.toLowerCase())||ne.ProjectCurrency?.toLowerCase().includes(w.toLowerCase())||oe.find(Re=>Re.ID===ne.BudgetManager)?.Name.toLowerCase().includes(w.toLowerCase()),se=new Date,ye=ne.StartDate&&ne.EndDate&&new Date(ne.StartDate)<=se&&new Date(ne.EndDate)>=se,ze=ne.EndDate&&new Date(ne.EndDate)<se;switch(R){case"active":return Se&&ye;case"completed":return Se&&ze;default:return Se}}).sort((ne,Se)=>{const se=ne.EndDate?new Date(ne.EndDate).getTime():0;return(Se.EndDate?new Date(Se.EndDate).getTime():0)-se}),[le,w,R,oe]);return d.jsxs(_e,{sx:{p:2,backgroundColor:"#f8f9fa",minHeight:"100vh"},children:[d.jsxs(_e,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx(We,{variant:"h5",component:"h1",sx:{fontWeight:"bold",color:"#333"},children:"Projects"}),d.jsxs(_e,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e&&d.jsx(Sa,{label:`Connected: ${o}`,color:"success",variant:"filled",size:"small",sx:{fontWeight:"bold"}}),d.jsx(Mo,{title:e?"Disconnect from Business Central":"Connect to Business Central",children:d.jsx(Un,{variant:e?"contained":"outlined",color:e?"success":"primary",size:"small",startIcon:d.jsx(PI,{}),onClick:()=>e?a():r(),disabled:n,children:n?"Connecting...":e?"Disconnect":"Connect to BC"})}),d.jsx(Mo,{title:"View Gantt Chart",children:d.jsx(Un,{variant:"outlined",size:"small",startIcon:d.jsx(Jy,{}),onClick:()=>F(!0),children:"Gantt"})}),d.jsx(Sa,{label:`${ce.length}/${le.length}`,color:"primary",variant:"outlined",size:"small"})]})]}),m.canEdit&&d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsxs(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",mb:1,display:"block",color:"#666"},children:"ADD NEW PROJECT"}),d.jsxs(_e,{sx:{display:"flex",gap:1,mb:.5,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 200px",minWidth:"200px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"PROJECT *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"START *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"END *"})}),d.jsx(_e,{sx:{flex:"0 1 90px",minWidth:"90px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"CURRENCY"})}),d.jsx(_e,{sx:{flex:"0 1 90px",minWidth:"90px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"BUDGET"})}),d.jsx(_e,{sx:{flex:"0 1 140px",minWidth:"140px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"MANAGER"})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"MODE"})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"FRINGE"})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ACTION"})})]}),d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:1,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 200px",minWidth:"200px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Project name",value:ie.Name??"",onChange:ne=>de({...ie,Name:ne.target.value}),variant:"outlined",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",type:"date",InputLabelProps:{shrink:!0},value:ie.StartDate??"",onChange:ne=>de({...ie,StartDate:ne.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",type:"date",InputLabelProps:{shrink:!0},value:ie.EndDate??"",onChange:ne=>de({...ie,EndDate:ne.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 90px",minWidth:"90px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"USD",value:ie.ProjectCurrency??"",onChange:ne=>de({...ie,ProjectCurrency:ne.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 90px",minWidth:"90px"},children:d.jsx(On,{fullWidth:!0,size:"small",type:"number",placeholder:"0",value:ie.ProjectBudget??"",onChange:ne=>de({...ie,ProjectBudget:Number(ne.target.value)}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 140px",minWidth:"140px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:ie.BudgetManager??"",onChange:ne=>de({...ie,BudgetManager:String(ne.target.value)}),displayEmpty:!0,renderValue:ne=>{if(!ne)return d.jsx("em",{style:{fontSize:"0.75rem"},children:"Select manager"});const Se=oe.find(se=>se.ID===ne);return d.jsx("span",{style:{fontSize:"0.75rem"},children:Se?.Name||ne})},sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"",children:d.jsx("em",{style:{fontSize:"0.75rem"},children:"None"})}),oe.map(ne=>d.jsx(ln,{value:ne.ID,sx:{fontSize:"0.75rem"},children:ne.Name},ne.ID))]})})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsx(Wr,{value:ie.AllocationMode??Qh[0],onChange:ne=>de({...ie,AllocationMode:String(ne.target.value)}),sx:{fontSize:"0.75rem"},children:Qh.map(ne=>d.jsx(ln,{value:ne,sx:{fontSize:"0.75rem"},children:ne},ne))})})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:ie.Fringe??"No",onChange:ne=>de({...ie,Fringe:String(ne.target.value)}),sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"Yes",sx:{fontSize:"0.75rem"},children:"Yes"}),d.jsx(ln,{value:"No",sx:{fontSize:"0.75rem"},children:"No"})]})})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(Un,{variant:"contained",fullWidth:!0,onClick:N,disabled:W.isPending,startIcon:d.jsx(sg,{}),size:"small",sx:{fontSize:"0.75rem",minHeight:"32px"},children:"Add"})})]})]})}),"\\n",d.jsx(Ta,{sx:{boxShadow:1},children:d.jsxs(Aa,{sx:{p:0,"&:last-child":{pb:0}},children:[d.jsx(_e,{sx:{p:2,borderBottom:1,borderColor:"divider",backgroundColor:"#fafafa"},children:d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 300px",minWidth:"250px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Search projects...",value:w,onChange:ne=>A(ne.target.value),InputProps:{startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(ig,{})})}})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:R,onChange:ne=>I(ne.target.value),startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(MC,{})}),children:[d.jsx(ln,{value:"all",children:"All Projects"}),d.jsx(ln,{value:"active",children:"Active"}),d.jsx(ln,{value:"completed",children:"Completed"})]})})}),d.jsx(_e,{sx:{flex:"0 1 auto"},children:d.jsxs(We,{variant:"body2",color:"text.secondary",children:[ce.length," of ",le.length," projects"]})})]})}),d.jsx(qa,{sx:{maxHeight:"60vh"},children:d.jsxs(Ba,{size:"small",stickyHeader:!0,sx:{"& .MuiTableCell-root":{py:.5}},children:[d.jsx(wa,{children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Project"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Start Date"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"End Date"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Currency"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Budget"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Manager"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Mode"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Fringe"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5,textAlign:"center"},children:"Actions"})]})}),d.jsx(za,{children:ce.length===0?d.jsx(hn,{children:d.jsx(Q,{colSpan:9,align:"center",sx:{py:2},children:d.jsx(We,{variant:"body2",color:"text.secondary",children:le.length===0?"No projects found. Create your first project above!":"No projects match your filters."})})}):ce.map(ne=>d.jsxs(hn,{hover:!0,sx:{"&:hover":{backgroundColor:"#f8f9fa"}},children:[d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"body2",sx:{fontSize:"0.7rem"},children:ne.Name})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:ne.StartDate?In(new Date(ne.StartDate),"MMM dd, yyyy"):"No start date"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:ne.EndDate?In(new Date(ne.EndDate),"MMM dd, yyyy"):"No end date"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:ne.ProjectCurrency||"No currency"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:ne.ProjectBudget?`${ne.ProjectBudget.toLocaleString()}`:"No budget"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:oe.find(se=>se.ID===ne.BudgetManager)?.Name||"No manager"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:ne.AllocationMode||Qh[0]})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:ne.Fringe||"No"})}),d.jsx(Q,{sx:{p:.5,textAlign:"center"},children:d.jsxs(_e,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:[m.canEdit&&d.jsx(_r,{size:"small",color:"primary",onClick:()=>j(ne),disabled:X.isPending,children:d.jsx(bp,{fontSize:"small"})}),m.canDelete&&d.jsx(_r,{size:"small",color:"error",onClick:()=>ee.mutate(ne.ID),disabled:ee.isPending,children:d.jsx(Rp,{fontSize:"small"})})]})})]},ne.ID))})]})})]})}),d.jsx(Wf,{open:y.open,autoHideDuration:y.severity==="error"?8e3:4e3,onClose:()=>C({...y,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:d.jsx(Hs,{onClose:()=>C({...y,open:!1}),severity:y.severity,sx:{width:"100%"},children:y.message})}),d.jsxs(oi,{open:!!O,onClose:()=>j(null),maxWidth:"md",fullWidth:!0,children:[d.jsx(Ii,{children:"Edit Project"}),d.jsx(ai,{children:O&&d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[d.jsx(On,{label:"Project Name",fullWidth:!0,defaultValue:O.Name,onBlur:ne=>{ne.target.value!==O.Name&&X.mutate({id:O.ID,payload:{Name:ne.target.value}})}}),d.jsxs(_e,{sx:{display:"flex",gap:2},children:[d.jsx(On,{label:"Start Date",type:"date",InputLabelProps:{shrink:!0},defaultValue:O.StartDate?.substring(0,10),onBlur:ne=>{ne.target.value!==O.StartDate?.substring(0,10)&&X.mutate({id:O.ID,payload:{StartDate:ne.target.value}})}}),d.jsx(On,{label:"End Date",type:"date",InputLabelProps:{shrink:!0},defaultValue:O.EndDate?.substring(0,10),onBlur:ne=>{ne.target.value!==O.EndDate?.substring(0,10)&&X.mutate({id:O.ID,payload:{EndDate:ne.target.value}})}})]}),d.jsxs(_e,{sx:{display:"flex",gap:2},children:[d.jsx(On,{label:"Currency",defaultValue:O.ProjectCurrency||"",onBlur:ne=>{ne.target.value!==(O.ProjectCurrency||"")&&X.mutate({id:O.ID,payload:{ProjectCurrency:ne.target.value}})}}),d.jsx(On,{label:"Budget",type:"number",defaultValue:O.ProjectBudget||"",onBlur:ne=>{const Se=Number(ne.target.value);Se!==(O.ProjectBudget||0)&&X.mutate({id:O.ID,payload:{ProjectBudget:Se}})}})]}),d.jsxs(Hr,{fullWidth:!0,children:[d.jsx(Qi,{children:"Budget Manager"}),d.jsxs(Wr,{value:O.BudgetManager||"",onChange:ne=>{X.mutate({id:O.ID,payload:{BudgetManager:String(ne.target.value)}})},children:[d.jsx(ln,{value:"",children:d.jsx("em",{children:"None"})}),oe.map(ne=>d.jsx(ln,{value:ne.ID,children:ne.Name},ne.ID))]})]}),d.jsxs(_e,{sx:{display:"flex",gap:2},children:[d.jsxs(Hr,{fullWidth:!0,children:[d.jsx(Qi,{children:"Allocation Mode"}),d.jsx(Wr,{value:O.AllocationMode||Qh[0],onChange:ne=>{X.mutate({id:O.ID,payload:{AllocationMode:String(ne.target.value)}})},children:Qh.map(ne=>d.jsx(ln,{value:ne,children:ne},ne))})]}),d.jsxs(Hr,{fullWidth:!0,children:[d.jsx(Qi,{children:"Fringe"}),d.jsxs(Wr,{value:O.Fringe||"No",onChange:ne=>{X.mutate({id:O.ID,payload:{Fringe:String(ne.target.value)}})},children:[d.jsx(ln,{value:"Yes",children:"Yes"}),d.jsx(ln,{value:"No",children:"No"})]})]})]})]})}),d.jsx(tl,{children:d.jsx(Un,{onClick:()=>j(null),children:"Close"})})]}),d.jsxs(oi,{open:M,onClose:()=>F(!1),maxWidth:"xl",fullWidth:!0,PaperProps:{sx:{height:"90vh",maxHeight:"90vh"}},children:[d.jsxs(Ii,{sx:{display:"flex",alignItems:"center",gap:1},children:[d.jsx(Jy,{}),"Project Gantt Chart"]}),d.jsx(ai,{sx:{p:0,height:"calc(90vh - 120px)",overflow:"hidden"},children:d.jsx(D_,{selectedDate:new Date})}),d.jsx(tl,{children:d.jsx(Un,{onClick:()=>F(!1),children:"Close"})})]})]})}function bne({open:t,onClose:e,onSave:r,currentVersionName:a,changeCount:o=0,mode:n,isSaving:f=!1}){const[m,y]=E.useState("update"),[C,w]=E.useState(""),[A,R]=E.useState(""),[I,M]=E.useState(""),F=()=>{if(m==="new"&&!C.trim()){M("Version name is required");return}M(""),r(m==="new",C.trim(),A.trim()),w(""),R(""),y("update")},O=()=>{M(""),w(""),R(""),y("update"),e()};return d.jsxs(oi,{open:t,onClose:O,maxWidth:"sm",fullWidth:!0,children:[d.jsx(Ii,{children:n==="upload"?"Save Budget Data":"Save Budget Changes"}),d.jsx(ai,{children:d.jsxs(_e,{sx:{pt:1},children:[n==="upload"?d.jsx(We,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"You have uploaded new budget data. How would you like to save it?"}):d.jsxs(We,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["You have modified ",o," ",o===1?"cell":"cells","."]}),d.jsxs(QU,{value:m,onChange:j=>y(j.target.value),children:[a&&d.jsxs(d.Fragment,{children:[d.jsx(oT,{value:"update",control:d.jsx(xD,{}),label:d.jsxs(_e,{children:[d.jsx(We,{variant:"body2",fontWeight:"bold",children:"Update Existing Version"}),d.jsxs(We,{variant:"caption",color:"text.secondary",children:["Version: ",a]})]})}),n==="upload"&&d.jsx(Hs,{severity:"warning",sx:{ml:4,mr:2,mb:2},children:"This will overwrite existing data"})]}),d.jsx(oT,{value:"new",control:d.jsx(xD,{}),label:d.jsx(We,{variant:"body2",fontWeight:"bold",children:"Save as New Version"})})]}),m==="new"&&d.jsxs(_e,{sx:{ml:4,mr:2,mt:2},children:[d.jsx(On,{label:"Version Name",fullWidth:!0,size:"small",value:C,onChange:j=>w(j.target.value),error:!!I,helperText:I,sx:{mb:2},placeholder:"e.g., 2025 Q1 Budget",required:!0}),d.jsx(On,{label:"Description (Optional)",fullWidth:!0,size:"small",multiline:!0,rows:2,value:A,onChange:j=>R(j.target.value),placeholder:"Add notes about this version..."})]})]})}),d.jsxs(tl,{children:[d.jsx(Un,{onClick:O,disabled:f,children:"Cancel"}),d.jsx(Un,{onClick:F,variant:"contained",disabled:f||m==="new"&&!C.trim(),startIcon:f?d.jsx(Ri,{size:20,color:"inherit"}):void 0,children:f?"Saving...":m==="update"?"Update Version":"Create Version"})]})]})}const Hy="arkgroupdmcc.sharepoint.com,a0fcec48-543a-44d0-8f5d-08e813e3212f,f0a32ebf-b746-4634-bb78-4a63f402d4fe",Wy="b!SOz8oDpU0ESPXQjoE-MhL78uo_BGtzRGu3hKY_QC1P4FRbUL6YvvTZYUUL0WDLRP",kR="Scheduled Records";async function vne(t,e,r){try{const a=await rk();if(!a)return{success:!1,error:"Not authenticated. Please login first."};const o=r||kR,n=e.includes("_")?e:`${t}_${e}`,f=o?`${o}/${n}`:n;return await R_(a,f,e,kR)}catch(a){return console.error("SharePoint folder error:",a),{success:!1,error:a.message||"Failed to access SharePoint"}}}async function xne(t,e){try{const r=await rk();if(!r)return{success:!1,error:"Not authenticated. Please login first."};const a=`${t}_${e}`,o="Project_Budget_Version",n=`${o}/${a}`;return await R_(r,n,a,o)}catch(r){return console.error("SharePoint budget version folder error:",r),{success:!1,error:r.message||"Failed to access SharePoint"}}}async function R_(t,e,r,a){try{const o=`https://graph.microsoft.com/v1.0/sites/${Hy}/drives/${Wy}/root:/${encodeURIComponent(e)}`;let n=!1,f="";try{const m=await fetch(o,{headers:{Authorization:`Bearer ${t}`}});if(m.ok){const y=await m.json();n=!0,f=y.webUrl,console.log(` Folder exists: ${r}`)}}catch{console.log(` Folder doesn't exist, will create: ${r}`)}if(!n){if(a)try{const A=`https://graph.microsoft.com/v1.0/sites/${Hy}/drives/${Wy}/root/children`;await fetch(A,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({name:a,folder:{},"@microsoft.graph.conflictBehavior":"fail"})})}catch{}const m=a?`root:/${encodeURIComponent(a)}:`:"root",y=`https://graph.microsoft.com/v1.0/sites/${Hy}/drives/${Wy}/${m}/children`,C=await fetch(y,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({name:r,folder:{},"@microsoft.graph.conflictBehavior":"rename"})});if(!C.ok){const A=await C.json();throw new Error(A.error?.message||"Failed to create folder")}return f=(await C.json()).webUrl,console.log(` Folder created: ${r}`),{success:!0,folderUrl:f,created:!0}}return{success:!0,folderUrl:f,created:!1}}catch(o){return console.error("SharePoint folder error:",o),{success:!1,error:o.message||"Failed to access SharePoint"}}}async function Cne(t){try{const e=await rk();if(!e)throw new Error("Not authenticated");const r=`https://graph.microsoft.com/v1.0/sites?search=${encodeURIComponent(t)}`,o=await(await fetch(r,{headers:{Authorization:`Bearer ${e}`}})).json();if(o.value&&o.value.length>0){const n=o.value[0],f=`https://graph.microsoft.com/v1.0/sites/${n.id}/drives`,y=await(await fetch(f,{headers:{Authorization:`Bearer ${e}`}})).json();return{siteId:n.id,siteName:n.displayName,siteUrl:n.webUrl,drives:y.value.map(C=>({id:C.id,name:C.name,type:C.driveType}))}}throw new Error("Site not found")}catch(e){throw console.error("SharePoint info error:",e),e}}const I_={createOrOpenFolder:vne,createOrOpenBudgetVersionFolder:xne,getSharePointInfo:Cne};function Sne(){const{isAuthenticated:t,userEmail:e}=_p(),[r,a]=E.useState([]),[o,n]=E.useState(null),[f,m]=E.useState([]),[y,C]=E.useState([]),[w,A]=E.useState(null),[R,I]=E.useState(new Map),[M,F]=E.useState(new Map),[O,j]=E.useState(!1),[U,H]=E.useState(!1),[K,W]=E.useState(!1),[X,ee]=E.useState(!1),[ie,de]=E.useState(null),[le,oe]=E.useState(!1),[N,ce]=E.useState("edit"),[ne,Se]=E.useState({open:!1,message:"",severity:"success"});E.useEffect(()=>{t&&se()},[t]),E.useEffect(()=>{o?(A(null),I(new Map),F(new Map),ye(o.No),ze(o.No)):(m([]),C([]),A(null),I(new Map),F(new Map))},[o]),E.useEffect(()=>{w?Re(w.Version_ID):(I(new Map),F(new Map))},[w]);const se=async()=>{j(!0),de(null);try{const Be=(await Xn.get("/bc/project-cards")).data;a(Be.projectCards),console.log(` Loaded ${Be.count} project cards`)}catch(Pe){console.error("Failed to fetch projects:",Pe),de(Pe.message)}finally{j(!1)}},ye=async Pe=>{H(!0),de(null);try{const Fe=(await Xn.get(`/bc/job-task-lines?jobNo=${encodeURIComponent(Pe)}`)).data;m(Fe.taskLines),console.log(` Loaded ${Fe.count} job task lines for project ${Pe}`)}catch(Be){console.error("Failed to fetch job task lines:",Be),de(Be.message)}finally{H(!1)}},ze=async Pe=>{W(!0);try{const Fe=(await Xn.get(`/budget/versions/${encodeURIComponent(Pe)}`)).data;C(Fe.versions),Fe.versions.length>0&&A(Fe.versions[0]),console.log(` Loaded ${Fe.count} budget versions`)}catch(Be){console.error("Failed to fetch versions:",Be),Be.message.includes("No versions found")||de(Be.message)}finally{W(!1)}},Re=async Pe=>{try{const Fe=(await Xn.get(`/budget/data/${Pe}`)).data,Ge=new Map;Fe.budgetData.forEach(Oe=>{const mt=Hl(Oe.Budget_Month.split("T")[0]),qe=In(mt,"yyyy-MM-dd"),Ae=`${Oe.Job_Task_No}|${qe}`;Ge.set(Ae,Oe.Budget_Amount),console.log(`Loaded: ${Oe.Job_Task_No} | ${qe} = ${Oe.Budget_Amount}`)}),I(Ge),F(new Map),console.log(` Loaded ${Fe.count} budget records from Version ${Pe}`)}catch(Be){console.error("Failed to fetch budget data:",Be),de(Be.message)}},ve=(Pe,Be)=>`${Pe}|${In(Be,"yyyy-MM-dd")}`,V=async()=>{if(!o||!w){Se({open:!0,message:"Please select a project and version first",severity:"info"});return}try{const Pe=await I_.createOrOpenBudgetVersionFolder(o.No,w.Version_Name);Pe.success&&Pe.folderUrl?(window.open(Pe.folderUrl,"_blank"),Se({open:!0,message:Pe.created?"Budget folder created and opened":"Budget folder opened",severity:"success"})):Se({open:!0,message:Pe.error||"Failed to access SharePoint folder",severity:"error"})}catch(Pe){console.error("Error opening budget folder:",Pe),Se({open:!0,message:"Failed to open folder: "+Pe.message,severity:"error"})}},ue=(Pe,Be)=>{const Fe=ve(Pe,Be);return M.get(Fe)??R.get(Fe)??0},Ee=async(Pe,Be,Fe)=>{if(!(!o||!e)){ee(!0);try{let Ge;if(Pe)Ge=(await Xn.post("/budget/versions",{jobNo:o.No,versionName:Be,versionDescription:Fe,sourceType:N==="upload"?"Excel Upload":"Manual Edit",createdBy:e})).data.version.Version_ID;else{if(!w)throw new Error("No version selected");Ge=w.Version_ID}const Oe=[];if(M.forEach((qe,Ae)=>{const[te,pe]=Ae.split("|");Oe.push({jobNo:o.No,jobTaskNo:te,budgetMonth:pe,budgetAmount:qe})}),Oe.length>0){const qe=`/budget/data/${Ge}`;await Xn.post(qe,{budgetData:Oe,modifiedBy:e})}if(await ze(o.No),Pe){const Ae=(await Xn.get(`/budget/versions/${encodeURIComponent(o.No)}`)).data;C(Ae.versions);const te=Ae.versions.find(pe=>pe.Version_ID===Ge);te&&A(te)}else await Re(Ge);F(new Map),oe(!1),ee(!1);const mt=Pe?` Created version '${Be}'${Oe.length>0?` with ${Oe.length} records`:""}`:` Updated version with ${Oe.length} records`;Se({open:!0,message:mt,severity:"success"})}catch(Ge){console.error("Failed to save budget:",Ge),ee(!1),Se({open:!0,message:` ${Ge.message}`,severity:"error"})}}},Ie=()=>{o&&(ce("edit"),oe(!0))},ae=Pe=>{const Be=Pe.trim(),Fe={jan:0,january:0,feb:1,february:1,mar:2,march:2,apr:3,april:3,may:4,jun:5,june:5,jul:6,july:6,aug:7,august:7,sep:8,sept:8,september:8,oct:9,october:9,nov:10,november:10,dec:11,december:11},Ge=[/^([a-z]{3,})[- ]?(\d{2,4})$/i];for(const Oe of Ge){const mt=Be.match(Oe);if(mt){const qe=mt[1].toLowerCase();let Ae=mt[2];if(Fe.hasOwnProperty(qe)){const te=Fe[qe];let pe=parseInt(Ae);return pe<100&&(pe+=pe<50?2e3:1900),{month:te,year:pe}}}}return null},be=Pe=>{const Be=Pe.target.files?.[0];if(!Be||!o)return;const Fe=new FileReader;Fe.onload=Ge=>{try{const mt=(Ge.target?.result).split(`
`).filter(J=>J.trim());if(mt.length<2)throw new Error("File is empty or invalid");const qe=J=>{const fe=[];let xe="",Ne=!1;for(let Me=0;Me<J.length;Me++){const Ve=J[Me];Ve==='"'?Ne&&J[Me+1]==='"'?(xe+='"',Me++):Ne=!Ne:Ve===","&&!Ne?(fe.push(xe.trim()),xe=""):xe+=Ve}return fe.push(xe.trim()),fe},Ae=qe(mt[0]);if(console.log("CSV Headers:",Ae),console.log("Month Columns:",tt.map(J=>J.label)),!Ae[0]?.includes("Job Task")||!Ae[1]?.includes("Description"))throw new Error("Invalid file format. Expected columns: Job Task No, Description, [months]");const te=new Map;let pe=0;for(let J=1;J<mt.length;J++){const fe=qe(mt[J]),xe=fe[0];if(xe){console.log(`Processing Task ${xe}:`,fe);for(let Ne=2;Ne<Math.min(Ae.length,fe.length);Ne++){const Me=fe[Ne],Ve=parseFloat(Me);if(Me&&Me!==""&&!isNaN(Ve)){const Qe=Ae[Ne];let rt=tt.find(st=>st.label===Qe);if(!rt){const st=ae(Qe);st&&(rt=tt.find(it=>it.date.getFullYear()===st.year&&it.date.getMonth()===st.month))}if(rt){const st=ve(xe,rt.date);te.set(st,Ve),pe++,console.log(`Imported: ${xe} | ${Qe} = ${Ve}`)}else console.warn(`Month not found: "${Qe}" - Available months:`,tt.map(st=>`"${st.label}"`))}}}}if(pe===0)throw console.error("No data imported. Headers:",Ae),console.error("Available months:",tt.map(J=>J.label)),new Error("No valid budget data found in file. Check that month columns match exactly.");F(te),ce("upload"),oe(!0),Se({open:!0,message:` Imported ${pe} budget values from Excel`,severity:"success"})}catch(Oe){console.error("Failed to parse Excel file:",Oe),Se({open:!0,message:` Failed to import: ${Oe.message}`,severity:"error"})}},Fe.onerror=()=>{Se({open:!0,message:" Failed to read file",severity:"error"})},Fe.readAsText(Be),Pe.target.value=""},Te=()=>{if(!o||f.length===0)return;const Pe=["Job Task No","Description",...tt.map(Ae=>Ae.label)];console.log(" Download - Headers:",Pe),console.log(" Download - Month columns:",tt.map(Ae=>`"${Ae.label}"`));const Be=f.filter(Ae=>Ae.Job_Task_Type!=="Total").map(Ae=>{const te=[Ae.Job_Task_No,Ae.Description];return tt.forEach(pe=>{const J=ue(Ae.Job_Task_No,pe.date);te.push(J?J.toString():"")}),te}),Fe=[Pe.join(","),...Be.map(Ae=>Ae.map(te=>{const pe=String(te);return pe.includes(",")||pe.includes('"')||pe.includes(`
`)?`"${pe.replace(/"/g,'""')}"`:pe}).join(","))].join(`
`),Ge=new Blob([Fe],{type:"text/csv;charset=utf-8;"}),Oe=document.createElement("a"),mt=URL.createObjectURL(Ge);Oe.setAttribute("href",mt);const qe=w?`_${w.Version_Name.replace(/[^a-zA-Z0-9]/g,"_")}`:"";Oe.setAttribute("download",`${o.No}${qe}_Budget.csv`),Oe.style.visibility="hidden",document.body.appendChild(Oe),Oe.click(),document.body.removeChild(Oe),Se({open:!0,message:` Downloaded budget template for ${o.No}`,severity:"success"})},tt=E.useMemo(()=>{if(!o?.Starting_Date||!o?.Ending_Date)return[];try{const Pe=Hl(o.Starting_Date),Be=Hl(o.Ending_Date);return dP({start:Pe,end:Be}).map(Ge=>({date:Ge,label:In(Ge,"MMM yyyy")}))}catch(Pe){return console.error("Error parsing dates:",Pe),[]}},[o]),je=(Pe,Be)=>f.filter(Ge=>Ge.Job_Task_No.startsWith(Pe+".")&&Ge.Job_Task_Type!=="Total").reduce((Ge,Oe)=>Ge+ue(Oe.Job_Task_No,Be),0);return d.jsxs(_e,{sx:{p:2},children:[d.jsx(We,{variant:"h5",gutterBottom:!0,sx:{mb:2},children:"Glidepath - Project Budget Planning"}),d.jsx(Ta,{sx:{mb:3,backgroundColor:"#f5f5f5",border:"2px solid #1976d2"},children:d.jsxs(Aa,{sx:{py:2,px:2},children:[d.jsxs(_e,{sx:{display:"flex",gap:2,alignItems:"center",mb:2,flexWrap:"wrap"},children:[d.jsx(w2,{options:r,getOptionLabel:Pe=>Pe.No,value:o,onChange:(Pe,Be)=>n(Be),loading:O,disabled:!t,renderInput:Pe=>d.jsx(On,{...Pe,label:"Select Project",placeholder:"Choose a project...",size:"small",InputProps:{...Pe.InputProps,endAdornment:d.jsxs(d.Fragment,{children:[O?d.jsx(Ri,{color:"inherit",size:20}):null,Pe.InputProps.endAdornment]})}}),sx:{minWidth:300,flex:1}}),o&&d.jsxs(d.Fragment,{children:[d.jsxs(Hr,{size:"small",sx:{minWidth:250},children:[d.jsx(Qi,{children:"Version"}),d.jsx(Wr,{value:w?.Version_ID||"",onChange:Pe=>{const Be=y.find(Fe=>Fe.Version_ID===Pe.target.value);A(Be||null)},label:"Version",disabled:K||y.length===0,children:y.map(Pe=>d.jsxs(ln,{value:Pe.Version_ID,children:[Pe.Version_Name,Pe.Is_Baseline&&" "]},Pe.Version_ID))})]}),d.jsx(Un,{variant:"outlined",startIcon:d.jsx(sg,{}),onClick:Ie,size:"small",children:"New Version"})]})]}),o&&d.jsxs(_e,{sx:{display:"flex",gap:3,flexWrap:"wrap",mb:2},children:[d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"text.secondary",display:"block",children:"Budget Manager"}),d.jsx(We,{variant:"body2",fontWeight:"bold",children:o.Budget_Manager_Name||"N/A"})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"text.secondary",display:"block",children:"Starting Date"}),d.jsx(We,{variant:"body2",fontWeight:"bold",children:o.Starting_Date?new Date(o.Starting_Date).toLocaleDateString():"N/A"})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"text.secondary",display:"block",children:"Ending Date"}),d.jsx(We,{variant:"body2",fontWeight:"bold",children:o.Ending_Date?new Date(o.Ending_Date).toLocaleDateString():"N/A"})]})]}),w&&d.jsxs(_e,{sx:{display:"flex",gap:2,alignItems:"center",justifyContent:"space-between",pt:1,borderTop:"1px solid #ddd"},children:[d.jsx(_e,{children:d.jsxs(We,{variant:"caption",color:"text.secondary",children:["Current Version: ",d.jsx("strong",{children:w.Version_Name}),w.Modified_Date&&d.jsxs(d.Fragment,{children:[" (Modified: ",new Date(w.Modified_Date).toLocaleDateString()," by ",w.Modified_By,")"]})]})}),d.jsxs(_e,{sx:{display:"flex",gap:1},children:[d.jsx(Un,{variant:"outlined",color:"secondary",startIcon:d.jsx(MI,{}),size:"small",onClick:V,disabled:!o||!w,children:"Open Folder"}),d.jsx(Un,{variant:"outlined",startIcon:d.jsx(yp,{}),size:"small",onClick:Te,disabled:!o||f.length===0,children:"Download Excel"}),d.jsxs(Un,{variant:"outlined",startIcon:d.jsx(_C,{}),size:"small",component:"label",disabled:!o||f.length===0,children:["Upload Excel",d.jsx("input",{type:"file",hidden:!0,accept:".csv,.xlsx,.xls",onChange:be})]})]})]})]})}),ie&&d.jsx(Ta,{sx:{mb:2,backgroundColor:"#ffebee"},children:d.jsx(Aa,{sx:{py:1.5},children:d.jsxs(We,{color:"error",variant:"body2",children:[" ",ie]})})}),d.jsx(Ta,{children:d.jsx(Aa,{children:d.jsx(qa,{component:ua,sx:{maxHeight:600,border:"1px solid #ddd",overflowX:"auto"},children:d.jsxs(Ba,{stickyHeader:!0,"aria-label":"job task lines table",sx:{minWidth:650},size:"small",children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{backgroundColor:"#0078D7"},children:[d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",border:"1px solid #ddd",minWidth:100,fontSize:"0.7rem",py:.5,px:1},children:"Job Task No"}),d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",border:"1px solid #ddd",minWidth:180,fontSize:"0.7rem",py:.5,px:1},children:"Description"}),tt.map((Pe,Be)=>d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",border:"1px solid #ddd",minWidth:80,textAlign:"center",fontSize:"0.7rem",py:.5,px:1},children:Pe.label},Be)),d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",border:"1px solid #ddd",minWidth:100,textAlign:"center",fontSize:"0.7rem",py:.5,px:1},children:"Total"})]})}),d.jsxs(za,{children:[o?U?d.jsx(hn,{children:d.jsxs(Q,{colSpan:3+tt.length,align:"center",sx:{py:4},children:[d.jsx(Ri,{size:24}),d.jsx(We,{variant:"body2",sx:{mt:1,fontSize:"0.75rem"},children:"Loading job task lines..."})]})}):f.length===0?d.jsx(hn,{children:d.jsx(Q,{colSpan:3+tt.length,align:"center",sx:{py:4,color:"text.secondary",fontSize:"0.75rem"},children:d.jsx(We,{variant:"body2",children:"No job task lines found for this project."})})}):f.map((Pe,Be)=>{const Fe=Pe.Job_Task_Type==="Total";return d.jsxs(hn,{hover:!Fe,sx:{backgroundColor:Fe?"#ADD8E6":"inherit","&:hover":{backgroundColor:Fe?"#ADD8E6":void 0}},children:[d.jsx(Q,{sx:{py:.5,px:1,border:"1px solid #ddd",fontSize:"0.7rem",fontWeight:Fe?"bold":"normal"},children:Pe.Job_Task_No}),d.jsx(Q,{sx:{py:.5,px:1,border:"1px solid #ddd",fontSize:"0.7rem",fontWeight:Fe?"bold":"normal"},children:Pe.Description}),tt.map((Ge,Oe)=>{const mt=Fe?je(Pe.Job_Task_No,Ge.date):ue(Pe.Job_Task_No,Ge.date);return d.jsx(Q,{sx:{py:.5,px:1,border:"1px solid #ddd",textAlign:"center",fontSize:"0.7rem",fontWeight:Fe?"bold":"normal",backgroundColor:Fe?"#ADD8E6":M.has(ve(Pe.Job_Task_No,Ge.date))?"#fff9c4":void 0},children:mt>0?mt.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"-"},Oe)}),d.jsx(Q,{sx:{py:.5,px:1,border:"1px solid #ddd",textAlign:"center",fontSize:"0.7rem",fontWeight:"bold",backgroundColor:"#f5f5f5"},children:(()=>{const Ge=tt.reduce((Oe,mt)=>{const qe=Fe?je(Pe.Job_Task_No,mt.date):ue(Pe.Job_Task_No,mt.date);return Oe+(qe||0)},0);return Ge>0?Ge.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"-"})()})]},`${Pe.Job_No}-${Pe.Job_Task_No}-${Be}`)}):d.jsx(hn,{children:d.jsx(Q,{colSpan:3+tt.length,align:"center",sx:{py:4,color:"text.secondary",fontSize:"0.75rem"},children:d.jsx(We,{variant:"body2",children:"Please select a project to view job task lines."})})}),f.length>0&&tt.length>0&&d.jsxs(hn,{sx:{backgroundColor:"#90EE90",fontWeight:"bold"},children:[d.jsx(Q,{sx:{py:.5,px:1,border:"1px solid #ddd",fontSize:"0.7rem",fontWeight:"bold"},colSpan:2,children:"GRAND TOTAL"}),tt.map((Pe,Be)=>{const Fe=f.filter(Ge=>Ge.Job_Task_Type!=="Total").reduce((Ge,Oe)=>Ge+(ue(Oe.Job_Task_No,Pe.date)||0),0);return d.jsx(Q,{sx:{py:.5,px:1,border:"1px solid #ddd",textAlign:"center",fontSize:"0.7rem",fontWeight:"bold"},children:Fe>0?Fe.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"-"},Be)}),d.jsx(Q,{sx:{py:.5,px:1,border:"1px solid #ddd",textAlign:"center",fontSize:"0.7rem",fontWeight:"bold",backgroundColor:"#FFA500"},children:(()=>{const Pe=tt.reduce((Be,Fe)=>{const Ge=f.filter(Oe=>Oe.Job_Task_Type!=="Total").reduce((Oe,mt)=>Oe+(ue(mt.Job_Task_No,Fe.date)||0),0);return Be+Ge},0);return Pe>0?Pe.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"-"})()})]})]})]})})})}),d.jsx(bne,{open:le,onClose:()=>oe(!1),onSave:Ee,currentVersionName:w?.Version_Name,changeCount:M.size,mode:N,isSaving:X}),d.jsx(Wf,{open:ne.open,autoHideDuration:6e3,onClose:()=>Se({...ne,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:d.jsx(Hs,{onClose:()=>Se({...ne,open:!1}),severity:ne.severity,children:ne.message})})]})}async function wne(t=!1){try{return(await Xn.get("/bc/personnel-expenses",{params:{showAll:t}})).data.expenses||[]}catch(e){throw console.error("Error fetching personnel expenses:",e),e}}async function Tne(t=!1){try{const e=new URLSearchParams;return t&&e.append("showAll","true"),(await Xn.get(`/bc/prepayments?${e.toString()}`)).data.prepayments||[]}catch(e){throw console.error("Error fetching prepayments:",e),e}}async function Ane(){try{return(await Xn.get("/bc/purchase-invoices")).data.invoices||[]}catch(t){throw console.error("Error fetching purchase invoices:",t),t}}async function Ene(){try{return(await Xn.get("/bc/salary-payments")).data.salaries||[]}catch(t){throw console.error("Error fetching salary payments:",t),t}}async function kne(){try{return(await Xn.get("/bc/vendors")).data.vendors||[]}catch(t){throw console.error("Error fetching vendors:",t),t}}async function Bx(){try{return(await Xn.get("/bc/bank-accounts")).data.bankAccounts||[]}catch(t){throw console.error("Error fetching bank accounts:",t),t}}async function bk(t){try{return(await Xn.post("/bc/payment-journal-line",t)).data}catch(e){return console.error("Error creating payment journal line:",e),{success:!1,message:e.response?.data?.error||"Failed to create payment journal line",error:e.response?.data?.details||e.message}}}async function Dne(t,e,r,a){return bk({vendorNo:t.Buy_from_Vendor_No,vendorName:t.Buy_from_Vendor_Name,amount:t.Amount,documentNo:t.No,invoiceReference:t.External_Document_No||"",bankAccountNo:e,paymentReference:r,bankCurrencyCode:a})}async function Rne(t,e,r,a){return bk({vendorNo:t.Vendor,vendorName:t.Vendor_Name,amount:t.Amount,documentNo:t.No,invoiceReference:t.Invoice_Number||t.Payment_Reference||"",bankAccountNo:e,paymentReference:r,bankCurrencyCode:a})}async function Ine(t,e,r,a,o){return bk({vendorNo:e,vendorName:t.Vendor_Name,amount:t.Prepayment_Amount,documentNo:t.No,invoiceReference:t.Payment_Reference||"",bankAccountNo:r,paymentReference:a,bankCurrencyCode:o})}async function Pne(){try{return(await Xn.get("/bc/vendor-cards")).data.vendors||[]}catch(t){throw console.error("Error fetching vendor cards:",t),t}}async function Mne(t,e,r,a){try{return(await Xn.post("/bc/salary-payment-journal-lines",{bankAccountNo:t,bankCurrencyCode:e,payrollMonth:r,employees:a})).data}catch(o){return console.error("Error creating salary payment journal lines:",o),{success:!1,message:o.response?.data?.error||"Failed to create salary payment journal lines"}}}let Pw=null,Mw=null;const _ne=3600*1e3;async function One(){if(Pw&&Mw&&Date.now()-Mw<_ne)return Pw;try{const t=await fetch("https://api.exchangerate-api.com/v4/latest/USD");if(!t.ok)throw new Error(`Exchange rate API error: ${t.statusText}`);const e=await t.json();return Pw=e.rates,Mw=Date.now(),e.rates}catch(t){return console.error("Failed to fetch exchange rates:",t),Nne()}}async function Fne(t,e){if(e==="USD"||e==="N/A")return t;try{const a=(await One())[e];return a?t/a:(console.warn(`No exchange rate found for ${e}, using fallback`),t)}catch(r){return console.error(`Failed to convert ${e} to USD:`,r),t}}function Nne(){return{AED:3.67,EUR:.92,GBP:.79,USD:1,INR:83.12,SAR:3.75,QAR:3.64,OMR:.38,KWD:.31,BHD:.38}}function Am(t){const{children:e,value:r,index:a,...o}=t;return d.jsx("div",{role:"tabpanel",hidden:r!==a,...o,children:r===a&&d.jsx(_e,{sx:{py:3},children:e})})}function jne(){const[t,e]=E.useState(0),[r,a]=E.useState(!1),[o,n]=E.useState(null),[f,m]=E.useState(""),[y,C]=E.useState(null),[w,A]=E.useState(null),[R,I]=E.useState(null),[M,F]=E.useState(null),[O,j]=E.useState({open:!1,message:"",severity:"info"}),[U,H]=E.useState(!1),[K,W]=E.useState(!1),[X,ee]=E.useState(null),[ie,de]=E.useState(null),[le,oe]=E.useState(null),[N,ce]=E.useState("invoice"),[ne,Se]=E.useState([]),[se,ye]=E.useState(""),[ze,Re]=E.useState(""),[ve,V]=E.useState(!1),[ue,Ee]=E.useState(!1),[Ie,ae]=E.useState([]),[be,Te]=E.useState(!1),[tt,je]=E.useState(""),[Pe,Be]=E.useState([]),[Fe,Ge]=E.useState(null),[Oe,mt]=E.useState(""),[qe,Ae]=E.useState(""),[te,pe]=E.useState([]),[J,fe]=E.useState([]),[xe,Ne]=E.useState([]),[Me,Ve]=E.useState([]),[Qe,rt]=E.useState([]),[st,it]=E.useState(new Map),[xt,pt]=E.useState({}),Yt=(ke,Ke)=>{e(Ke)},Kt=[...xe].sort((ke,Ke)=>{const cn=new Date(ke.Posting_Date||"1900-01-01").getTime(),$n=new Date(Ke.Posting_Date||"1900-01-01").getTime();return cn-$n}),tn=Kt.reduce((ke,Ke)=>{const cn=Ke.Payment_Method_Code?.trim()||"BANK TRAN";return ke[cn]||(ke[cn]=[]),ke[cn].push(Ke),ke},{}),Wt=Object.keys(tn).sort(),_t=async()=>{a(!0),n(null);try{const[ke,Ke,cn,$n,Zo,Ra]=await Promise.all([wne(!1),Tne(!0),Ane(),Ene(),Ree({$top:500}),kne()]),sr=new Map;Ra.forEach(Ks=>{Ks.name&&Ks.number&&sr.set(Ks.name.trim(),Ks.number)}),it(sr),pe(ke),fe(Ke);const Gs=cn.filter(Ks=>!Ks.Closed&&Ks.Amount&&Ks.Amount!==0);Ne(Gs);const Rd=$n.filter(Ks=>Ks.Status!=="Complete");Ve(Rd),rt(Zo.invoices||[])}catch(ke){n(ke.message||"Failed to fetch payment data"),console.error("Error fetching payment data:",ke)}finally{a(!1)}};E.useEffect(()=>{_t()},[]);const at=ke=>{ke&&window.open(ke,"_blank")},Et=(ke,Ke)=>new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(ke)+" "+Ke,qt=ke=>{const Ke=ke.Approver_One_Datetime,cn=ke.Approver_Two_Datetime,$n=Ke&&String(Ke).trim().length>0&&!String(Ke).startsWith("0001-01-01")&&!String(Ke).startsWith("1900-01-01"),Zo=cn&&String(cn).trim().length>0&&!String(cn).startsWith("0001-01-01")&&!String(cn).startsWith("1900-01-01");return $n&&Zo?{label:"Approved",color:"success"}:{label:"Pending Approval",color:"warning"}},gn=ke=>{const Ke=ke.Approver_One_Datetime,cn=ke.Approver_Two_Datetime,$n=Ke&&String(Ke).trim().length>0&&!String(Ke).startsWith("0001-01-01")&&!String(Ke).startsWith("1900-01-01"),Zo=cn&&String(cn).trim().length>0&&!String(cn).startsWith("0001-01-01")&&!String(cn).startsWith("1900-01-01");return $n&&Zo?{label:"Approved",color:"success"}:{label:"Pending Approval",color:"warning"}},Sn=ke=>{if(!ke||ke==="0001-01-01T00:00:00"||ke==="1900-01-01T00:00:00")return"-";try{return new Date(ke).toLocaleDateString("en-GB")}catch{return"-"}},Zt=ke=>{if(!ke||ke==="0001-01-01T00:00:00"||ke==="1900-01-01T00:00:00")return"-";try{const Ke=new Date(ke),$n=new Date().getTime()-Ke.getTime();return Math.floor($n/(1e3*60*60*24))}catch{return"-"}},Kn=(ke,Ke)=>{ke.preventDefault(),C(y===null?{mouseX:ke.clientX+2,mouseY:ke.clientY-6,expense:Ke}:null)},$t=()=>{C(null)},Cr=async()=>{const ke=y?.expense;if(!ke){$t();return}if(ce("personnel"),de(ke),ee(null),oe(null),ye(""),Re(""),W(!0),$t(),ne.length===0){V(!0);try{const Ke=await Bx();Se(Ke)}catch(Ke){console.error("Error loading bank accounts:",Ke),j({open:!0,message:"Failed to load bank accounts",severity:"error"})}finally{V(!1)}}},tr=()=>{if(y?.expense?.No){const Ke=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=63103&filter=%27Personnel%20Expenses%27.%27No.%27%20IS%20%27${encodeURIComponent(y.expense.No)}%27&dc=0`;window.open(Ke,"_blank")}$t()},Bt=()=>{if(y?.expense){const ke=y.expense.Vendor;if(ke){const Ke=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=29&filter=%27Vendor%20Ledger%20Entry%27.%27Vendor%20No.%27%20IS%20%27${ke}%27&dc=0`;window.open(Ke,"_blank")}}$t()},gr=()=>{if(y?.expense){const ke=y.expense.Vendor;if(ke){const Ke=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=425&filter=%27Vendor%20Bank%20Account%27.%27Vendor%20No.%27%20IS%20%27${ke}%27&dc=0`;window.open(Ke,"_blank")}}$t()},en=(ke,Ke)=>{ke.preventDefault(),A(w===null?{mouseX:ke.clientX+2,mouseY:ke.clientY-6,prepayment:Ke}:null)},un=()=>{A(null)},Yn=async()=>{const ke=w?.prepayment;if(!ke){un();return}if(ce("prepayment"),oe(ke),ee(null),de(null),ye(""),Re(""),W(!0),un(),ne.length===0){V(!0);try{const Ke=await Bx();Se(Ke)}catch(Ke){console.error("Error loading bank accounts:",Ke),j({open:!0,message:"Failed to load bank accounts",severity:"error"})}finally{V(!1)}}},En=()=>{if(w?.prepayment){const ke=w.prepayment,Ke=ke.Vendor_Name?st.get(ke.Vendor_Name.trim()):void 0;if(Ke){const cn=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=29&filter=%27Vendor%20Ledger%20Entry%27.%27Vendor%20No.%27%20IS%20%27${Ke}%27&dc=0`;window.open(cn,"_blank")}}un()},fr=()=>{if(w?.prepayment){const ke=w.prepayment,Ke=ke.Vendor_Name?st.get(ke.Vendor_Name.trim()):void 0;if(Ke){const cn=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=425&filter=%27Vendor%20Bank%20Account%27.%27Vendor%20No.%27%20IS%20%27${Ke}%27&dc=0`;window.open(cn,"_blank")}}un()},fo=()=>{if(w?.prepayment){const Ke=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=61100&filter=Prepayment.%27No.%27%20IS%20%27${w.prepayment.No}%27&dc=0`;window.open(Ke,"_blank")}un()},xo=()=>{if(w?.prepayment){const ke=w.prepayment.Folder;ke&&ke.trim()!==""&&window.open(ke,"_blank")}un()},Qn=(ke,Ke)=>{ke.preventDefault(),I(R===null?{mouseX:ke.clientX+2,mouseY:ke.clientY-6,invoice:Ke}:null)},Or=()=>{I(null)},Ko=async()=>{const ke=R?.invoice;if(!ke){Or();return}if(ce("invoice"),ee(ke),de(null),oe(null),ye(""),Re(""),W(!0),Or(),ne.length===0){V(!0);try{const Ke=await Bx();Se(Ke)}catch(Ke){console.error("Error loading bank accounts:",Ke),j({open:!0,message:"Failed to load bank accounts",severity:"error"})}finally{V(!1)}}},Rr=()=>{W(!1),ee(null),de(null),oe(null),ye(""),Re("")},Jn=async()=>{if(!se){j({open:!0,message:"Please select a bank account",severity:"error"});return}const ke=ne.find(Ke=>Ke.No===se);if(!ke){j({open:!0,message:"Invalid bank account selected",severity:"error"});return}W(!1),H(!0);try{let Ke,cn="";if(N==="invoice"&&X)Ke=await Dne(X,se,ze,ke.Currency_Code),cn=X.Buy_from_Vendor_Name;else if(N==="personnel"&&ie)Ke=await Rne(ie,se,ze,ke.Currency_Code),cn=ie.Vendor_Name;else if(N==="prepayment"&&le){const $n=st.get(le.Vendor_Name?.trim()||"")||"";Ke=await Ine(le,$n,se,ze,ke.Currency_Code),cn=le.Vendor_Name}else{j({open:!0,message:"No payment data selected",severity:"error"});return}Ke.success?(j({open:!0,message:`Payment journal lines created for ${cn}`,severity:"success"}),Ke.paymentUrl&&window.open(Ke.paymentUrl,"_blank")):(j({open:!0,message:Ke.message||"Failed to create payment journal line",severity:"error"}),window.open("https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production?company=ARK%20Group%20Live&page=39&filter=%27Gen.%20Journal%20Line%27.%27Journal%20Template%20Name%27%20IS%20%27GENERAL%27%20AND%20%27Gen.%20Journal%20Line%27.%27Journal%20Batch%20Name%27%20IS%20%27PAYMENT%27&dc=0","_blank"))}catch(Ke){console.error("Error creating payment journal line:",Ke),j({open:!0,message:"Error creating payment journal line",severity:"error"})}finally{H(!1),ee(null),de(null),oe(null),ye(""),Re("")}},aa=()=>{if(R?.invoice){const ke=R.invoice.Buy_from_Vendor_No;if(ke){const Ke=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=29&filter=%27Vendor%20Ledger%20Entry%27.%27Vendor%20No.%27%20IS%20%27${ke}%27&dc=0`;window.open(Ke,"_blank")}}Or()},qr=()=>{if(R?.invoice){const ke=R.invoice.Buy_from_Vendor_No;if(ke){const Ke=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=425&filter=%27Vendor%20Bank%20Account%27.%27Vendor%20No.%27%20IS%20%27${ke}%27&dc=0`;window.open(Ke,"_blank")}}Or()},ho=()=>{if(R?.invoice){const Ke=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&page=138&filter=%27Purch.%20Inv.%20Header%27.%27No.%27%20IS%20%27${R.invoice.No}%27&dc=0`;window.open(Ke,"_blank")}Or()},ts=()=>{if(R?.invoice?.Folder_Link){const ke=R.invoice.Folder_Link;ke&&ke.trim()!==""&&window.open(ke,"_blank")}Or()},Pt=(ke,Ke)=>{ke.preventDefault(),F({mouseX:ke.clientX+2,mouseY:ke.clientY-6,salary:Ke})},Tt=()=>{F(null)},Dn=()=>{window.open("https://arkgroupdmcc.sharepoint.com/sites/BusinessCentral-Data/Business%20Central%20Payroll/Forms/AllItems.aspx","_blank"),Tt()},nr=()=>{if(M?.salary?.No){const Ke=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production/?company=ARK%20Group%20Live&view=aa49406f-6f68-4565-b857-496faa0e77aa_test88647&page=63102&filter=Salaries.%27No.%27%20IS%20%27${M.salary.No}%27&dc=0`;window.open(Ke,"_blank")}Tt()},or=async()=>{if(Tt(),Ee(!0),ye(""),je(""),Be([]),Ge(null),mt(""),Ae(""),ne.length===0){V(!0);try{const ke=await Bx();Se(ke)}catch(ke){console.error("Error loading bank accounts:",ke),j({open:!0,message:"Failed to load bank accounts",severity:"error"})}finally{V(!1)}}if(Ie.length===0){Te(!0);try{const ke=await Pne();ae(ke)}catch(ke){console.error("Error loading vendor cards:",ke),j({open:!0,message:"Failed to load vendor list",severity:"error"})}finally{Te(!1)}}},Ao=()=>{Ee(!1),je(""),Be([]),Ge(null),mt(""),Ae(""),ye("")},kr=()=>{if(!Fe||!qe||parseFloat(qe)<=0){j({open:!0,message:"Please select an employee and enter a valid amount",severity:"error"});return}if(Pe.some(Ke=>Ke.vendorNo===Fe.No)){j({open:!0,message:"This employee has already been added",severity:"error"});return}const ke={vendorNo:Fe.No,vendorName:Fe.Name,paymentReference:Oe,amount:parseFloat(qe)};Be([...Pe,ke]),Ge(null),mt(""),Ae("")},Zr=ke=>{Be(Pe.filter(Ke=>Ke.vendorNo!==ke))},Eo=async()=>{if(!se){j({open:!0,message:"Please select a bank account",severity:"error"});return}if(!tt){j({open:!0,message:"Please enter the payroll month",severity:"error"});return}if(Pe.length===0){j({open:!0,message:"Please add at least one employee",severity:"error"});return}const ke=ne.find(Ke=>Ke.No===se);if(!ke){j({open:!0,message:"Invalid bank account selected",severity:"error"});return}Ee(!1),H(!0);try{const Ke=await Mne(se,ke.Currency_Code,tt,Pe);Ke.success?(j({open:!0,message:Ke.message||`Payment journal lines created for ${Pe.length} employees`,severity:"success"}),Ke.paymentUrl&&window.open(Ke.paymentUrl,"_blank")):j({open:!0,message:Ke.message||"Failed to create payment journal lines",severity:"error"})}catch(Ke){console.error("Error creating salary payment journal lines:",Ke),j({open:!0,message:"Error creating payment journal lines",severity:"error"})}finally{H(!1),je(""),Be([]),ye("")}},da=()=>{const ke={};return bs.forEach(Ke=>{const cn=Ke.Currency||"N/A";ke[cn]||(ke[cn]={}),ke[cn].Personnel||(ke[cn].Personnel=0),ke[cn].Personnel+=Ke.Amount||0}),ar.forEach(Ke=>{const cn=Ke.Currency||"N/A";ke[cn]||(ke[cn]={}),ke[cn].Prepayments||(ke[cn].Prepayments=0),ke[cn].Prepayments+=Ke.Prepayment_Amount||0}),xe.forEach(Ke=>{const cn=Ke.Currency_Code||"N/A";ke[cn]||(ke[cn]={}),ke[cn]["Purchase Invoices"]||(ke[cn]["Purchase Invoices"]=0),ke[cn]["Purchase Invoices"]+=Ke.Amount||0}),Me.forEach(Ke=>{const cn=Ke.Currency||"N/A";ke[cn]||(ke[cn]={}),ke[cn].Salary||(ke[cn].Salary=0),ke[cn].Salary+=Ke.Payroll_Amount||0}),ke};E.useEffect(()=>{r||(async()=>{const Ke=da(),cn={};for(const[$n,Zo]of Object.entries(Ke)){const Ra=Object.values(Zo).reduce((sr,Gs)=>sr+Gs,0);cn[$n]=await Fne(Ra,$n)}pt(cn)})()},[te,J,xe,Me,r]);const bs=te.filter(ke=>{const Ke=!ke.Payment_Reference||ke.Payment_Reference.trim()==="",cn=ke.Status!=="Draft";if(!Ke||!cn)return!1;if(!f)return!0;const $n=f.toLowerCase();return(ke.Vendor||"").toLowerCase().includes($n)||(ke.Vendor_Name||"").toLowerCase().includes($n)||(ke.Type||"").toLowerCase().includes($n)||(ke.Project||"").toLowerCase().includes($n)}).sort((ke,Ke)=>{const cn=new Date(ke.Approval_Requested_By_Datetime||"1900-01-01").getTime(),$n=new Date(Ke.Approval_Requested_By_Datetime||"1900-01-01").getTime();return cn-$n}),ar=J.filter(ke=>{if(!(!ke.Payment_Reference||ke.Payment_Reference.trim()==="")||gn(ke).label!=="Approved")return!1;if(!f)return!0;const $n=f.toLowerCase();return(ke.Vendor||"").toLowerCase().includes($n)||(ke.Vendor_Name||"").toLowerCase().includes($n)||(ke.No||"").toLowerCase().includes($n)}).sort((ke,Ke)=>{const cn=new Date(ke.Advance_Submission_Date||"1900-01-01").getTime(),$n=new Date(Ke.Advance_Submission_Date||"1900-01-01").getTime();return cn-$n}),Fr=ar.reduce((ke,Ke)=>{const cn=Ke.Payment_Method?.trim()||"BANK TRAN";return ke[cn]||(ke[cn]=[]),ke[cn].push(Ke),ke},{}),Vs=Object.keys(Fr).sort();return d.jsxs(_e,{children:[d.jsxs(_e,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[d.jsx(We,{variant:"h4",gutterBottom:!0,children:"Payments"}),d.jsxs(_e,{sx:{display:"flex",gap:2,alignItems:"center"},children:[d.jsx(On,{size:"small",placeholder:"Search...",value:f,onChange:ke=>m(ke.target.value),InputProps:{startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(ig,{fontSize:"small"})})},sx:{minWidth:250}}),d.jsx(_r,{onClick:()=>_t(),disabled:r,color:"primary",children:d.jsx(OI,{})})]})]}),o&&d.jsx(Hs,{severity:"error",sx:{mb:3},onClose:()=>n(null),children:o}),d.jsxs(ua,{sx:{width:"100%"},children:[d.jsxs(wH,{value:t,onChange:Yt,sx:{borderBottom:1,borderColor:"divider"},children:[d.jsx(Cm,{label:"Summary"}),d.jsx(Cm,{label:`Personnel (${bs.length})`}),d.jsx(Cm,{label:`Prepayments (${ar.length})`}),d.jsx(Cm,{label:`Purchase Invoices (${xe.length})`}),d.jsx(Cm,{label:`Salary (${Me.length})`}),d.jsx(Cm,{label:`Receivables (${Qe.length})`})]}),r&&d.jsx(_e,{sx:{display:"flex",justifyContent:"center",p:4},children:d.jsx(Ri,{})}),d.jsx(Am,{value:t,index:0,children:d.jsx(qa,{children:d.jsxs(Ba,{size:"small",sx:{"& .MuiTableCell-root":{py:.5,fontSize:"0.75rem"}},children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{bgcolor:"primary.main"},children:[d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Currency"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Personnel"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Prepayments"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Purchase Invoices"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Salary"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Total"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"USD Amount"})]})}),d.jsxs(za,{children:[Object.entries(da()).map(([ke,Ke],cn)=>{const $n=Object.values(Ke).reduce((Zo,Ra)=>Zo+Ra,0);return d.jsxs(hn,{sx:{bgcolor:cn%2===0?"action.hover":"transparent","&:hover":{bgcolor:"action.selected"}},children:[d.jsx(Q,{sx:{fontWeight:"bold"},children:ke}),d.jsx(Q,{align:"right",children:Et(Ke.Personnel||0,ke)}),d.jsx(Q,{align:"right",children:Et(Ke.Prepayments||0,ke)}),d.jsx(Q,{align:"right",children:Et(Ke["Purchase Invoices"]||0,ke)}),d.jsx(Q,{align:"right",children:Et(Ke.Salary||0,ke)}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold"},children:Et($n,ke)}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",color:"primary.main"},children:xt[ke]?Et(xt[ke],"USD"):"-"})]},ke)}),Object.keys(da()).length===0&&d.jsx(hn,{children:d.jsx(Q,{colSpan:7,align:"center",children:d.jsx(We,{variant:"body2",color:"text.secondary",children:"No pending payments"})})}),Object.keys(da()).length>0&&d.jsxs(hn,{sx:{bgcolor:"action.selected",borderTop:2,borderColor:"primary.main"},children:[d.jsx(Q,{colSpan:6,align:"right",sx:{fontWeight:"bold",fontSize:"0.85rem"},children:"Grand Total:"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",fontSize:"0.85rem",color:"primary.main"},children:Et(Object.values(xt).reduce((ke,Ke)=>ke+Ke,0),"USD")})]})]})]})})}),d.jsx(Am,{value:t,index:1,children:d.jsx(qa,{children:d.jsxs(Ba,{size:"small",sx:{"& .MuiTableCell-root":{py:.5,fontSize:"0.75rem"}},children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{bgcolor:"primary.main"},children:[d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"No"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Vendor ID"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Vendor Name"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Type"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Reference"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Project"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Requested Date"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Currency"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Amount"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Status"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Aging"})]})}),d.jsxs(za,{children:[bs.length===0&&!r&&d.jsx(hn,{children:d.jsx(Q,{colSpan:11,align:"center",children:d.jsx(We,{variant:"body2",color:"text.secondary",children:f?"No results found":"No personnel expenses found"})})}),bs.map((ke,Ke)=>{const cn=qt(ke);return d.jsxs(hn,{hover:!0,onContextMenu:$n=>Kn($n,ke),sx:{cursor:"context-menu",bgcolor:Ke%2===0?"action.hover":"transparent","&:hover":{bgcolor:"action.selected"}},children:[d.jsx(Q,{children:ke.No||"-"}),d.jsx(Q,{children:ke.Vendor||"-"}),d.jsx(Q,{children:ke.Vendor_Name||"-"}),d.jsx(Q,{children:ke.Type||"-"}),d.jsx(Q,{children:ke.Invoice_Number||"-"}),d.jsx(Q,{children:ke.Project||"-"}),d.jsx(Q,{children:Sn(ke.Approval_Requested_By_Datetime)}),d.jsx(Q,{children:ke.Currency||"-"}),d.jsx(Q,{align:"right",children:ke.Amount?Et(ke.Amount,ke.Currency):"-"}),d.jsx(Q,{children:d.jsx(Sa,{label:cn.label,color:cn.color,size:"small"})}),d.jsx(Q,{align:"right",children:typeof Zt(ke.Approval_Requested_By_Datetime)=="number"?`${Zt(ke.Approval_Requested_By_Datetime)} days`:Zt(ke.Approval_Requested_By_Datetime)})]},Ke)})]})]})})}),d.jsx(Am,{value:t,index:2,children:ar.length===0&&!r?d.jsx(We,{variant:"body2",color:"text.secondary",align:"center",sx:{py:3},children:f?"No results found":"No prepayments found"}):Vs.map(ke=>d.jsxs(_e,{sx:{mb:4},children:[d.jsx(We,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"primary.main"},children:ke}),d.jsx(qa,{children:d.jsxs(Ba,{size:"small",sx:{"& .MuiTableCell-root":{py:.5,fontSize:"0.75rem"}},children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{bgcolor:"primary.main"},children:[d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"No"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Vendor ID"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Vendor Name"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Posting Date"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Currency"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Amount"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Status"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Aging"})]})}),d.jsx(za,{children:Fr[ke].map((Ke,cn)=>{const $n=gn(Ke),Zo=Ke.Vendor_Name?st.get(Ke.Vendor_Name.trim()):void 0;return d.jsxs(hn,{hover:!0,onContextMenu:Ra=>en(Ra,Ke),sx:{cursor:"context-menu"},children:[d.jsx(Q,{children:Ke.No||"-"}),d.jsx(Q,{children:Zo||"-"}),d.jsx(Q,{children:Ke.Vendor_Name||"-"}),d.jsx(Q,{children:Sn(Ke.Advance_Submission_Date)}),d.jsx(Q,{children:Ke.Currency||"-"}),d.jsx(Q,{align:"right",children:Ke.Prepayment_Amount?Et(Ke.Prepayment_Amount,Ke.Currency):"-"}),d.jsx(Q,{children:d.jsx(Sa,{label:$n.label,color:$n.color,size:"small"})}),d.jsx(Q,{align:"right",children:typeof Zt(Ke.Advance_Submission_Date)=="number"?`${Zt(Ke.Advance_Submission_Date)} days`:Zt(Ke.Advance_Submission_Date)})]},cn)})})]})})]},ke))}),d.jsx(Am,{value:t,index:3,children:Kt.length===0&&!r?d.jsx(We,{variant:"body2",color:"text.secondary",align:"center",sx:{py:3},children:"No purchase invoices found"}):Wt.map(ke=>d.jsxs(_e,{sx:{mb:4},children:[d.jsx(We,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"primary.main"},children:ke}),d.jsx(qa,{children:d.jsxs(Ba,{size:"small",sx:{"& .MuiTableCell-root":{py:.5,fontSize:"0.75rem"}},children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{bgcolor:"primary.main"},children:[d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"No"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Vendor ID"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Vendor Name"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Reference"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Posting Date"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Project"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Currency"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Amount"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Closed"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Aging"})]})}),d.jsx(za,{children:tn[ke].map((Ke,cn)=>d.jsxs(hn,{hover:!0,onContextMenu:$n=>Qn($n,Ke),sx:{cursor:"context-menu",bgcolor:cn%2===0?"action.hover":"transparent","&:hover":{bgcolor:"action.selected"}},children:[d.jsx(Q,{children:Ke.No||"-"}),d.jsx(Q,{children:Ke.Buy_from_Vendor_No||"-"}),d.jsx(Q,{children:Ke.Buy_from_Vendor_Name||"-"}),d.jsx(Q,{children:Ke.External_Document_No||"-"}),d.jsx(Q,{children:Sn(Ke.Posting_Date)}),d.jsx(Q,{children:Ke.Project||"-"}),d.jsx(Q,{children:Ke.Currency_Code||"-"}),d.jsx(Q,{align:"right",children:Ke.Amount?Et(Ke.Amount,Ke.Currency_Code):"-"}),d.jsx(Q,{children:Ke.Closed?"Yes":"No"}),d.jsx(Q,{align:"right",children:typeof Zt(Ke.Posting_Date)=="number"?`${Zt(Ke.Posting_Date)} days`:Zt(Ke.Posting_Date)})]},cn))})]})})]},ke))}),d.jsx(Am,{value:t,index:4,children:d.jsx(qa,{children:d.jsxs(Ba,{size:"small",sx:{"& .MuiTableCell-root":{py:.5,fontSize:"0.75rem"}},children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{bgcolor:"primary.main"},children:[d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"No"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Period"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Location"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Currency"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Payroll Amount"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Status"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Aging"})]})}),d.jsxs(za,{children:[Me.length===0&&!r&&d.jsx(hn,{children:d.jsx(Q,{colSpan:7,align:"center",children:d.jsx(We,{variant:"body2",color:"text.secondary",children:"No salary payments found"})})}),Me.map((ke,Ke)=>d.jsxs(hn,{hover:!0,onContextMenu:cn=>Pt(cn,ke),sx:{cursor:"context-menu",bgcolor:Ke%2===0?"action.hover":"transparent","&:hover":{bgcolor:"action.selected"}},children:[d.jsx(Q,{children:ke.No||"-"}),d.jsx(Q,{children:ke.Period||"-"}),d.jsx(Q,{children:ke.Location||"-"}),d.jsx(Q,{children:ke.Currency||"-"}),d.jsx(Q,{align:"right",children:ke.Payroll_Amount?Et(ke.Payroll_Amount,ke.Currency):"-"}),d.jsx(Q,{children:ke.Status||"-"}),d.jsx(Q,{align:"right",children:typeof Zt(ke.Period)=="number"?`${Zt(ke.Period)} days`:Zt(ke.Period)})]},Ke))]})]})})}),d.jsx(Am,{value:t,index:5,children:d.jsx(qa,{children:d.jsxs(Ba,{size:"small",sx:{"& .MuiTableCell-root":{py:.5,fontSize:"0.75rem"}},children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{bgcolor:"primary.main"},children:[d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"No"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Customer No"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Customer Name"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Document Date"}),d.jsx(Q,{sx:{color:"white",fontWeight:"bold"},children:"Currency Code"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Amount"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Remaining Amount"}),d.jsx(Q,{align:"right",sx:{color:"white",fontWeight:"bold"},children:"Aging (Days)"})]})}),d.jsxs(za,{children:[Qe.filter(ke=>!ke.Closed).length===0&&!r&&d.jsx(hn,{children:d.jsx(Q,{colSpan:8,align:"center",children:d.jsx(We,{variant:"body2",color:"text.secondary",children:"No open sales invoices found"})})}),Qe.filter(ke=>!ke.Closed).map((ke,Ke)=>{const cn=ke.Document_Date?new Date(ke.Document_Date):null,Zo=cn?Math.floor((new Date().getTime()-cn.getTime())/(1e3*60*60*24)):"-";return d.jsxs(hn,{hover:!0,sx:{bgcolor:Ke%2===0?"action.hover":"transparent","&:hover":{bgcolor:"action.selected"}},children:[d.jsx(Q,{children:ke.No||"-"}),d.jsx(Q,{children:ke.Sell_to_Customer_No||"-"}),d.jsx(Q,{children:ke.Sell_to_Customer_Name||"-"}),d.jsx(Q,{children:Sn(ke.Document_Date)}),d.jsx(Q,{children:ke.Currency_Code||"-"}),d.jsx(Q,{align:"right",children:ke.Amount?Et(ke.Amount,ke.Currency_Code):"-"}),d.jsx(Q,{align:"right",children:ke.Remaining_Amount?Et(ke.Remaining_Amount,ke.Currency_Code):"-"}),d.jsx(Q,{align:"right",children:Zo})]},ke.No||Ke)})]})]})})})]}),d.jsxs(lp,{open:y!==null,onClose:$t,anchorReference:"anchorPosition",anchorPosition:y!==null?{top:y.mouseY,left:y.mouseX}:void 0,children:[d.jsxs(ln,{onClick:Cr,children:[d.jsx(Ts,{children:d.jsx(qh,{fontSize:"small"})}),d.jsx(As,{children:"Pay"})]}),d.jsxs(ln,{onClick:tr,children:[d.jsx(Ts,{children:d.jsx(Tf,{fontSize:"small"})}),d.jsx(As,{children:"See Transaction"})]}),d.jsxs(ln,{onClick:Bt,children:[d.jsx(Ts,{children:d.jsx(Tf,{fontSize:"small"})}),d.jsx(As,{children:"Show Vendor"})]}),d.jsxs(ln,{onClick:gr,children:[d.jsx(Ts,{children:d.jsx(qh,{fontSize:"small"})}),d.jsx(As,{children:"Bank Account"})]}),d.jsxs(ln,{onClick:()=>{if(y?.expense){const Ke=Object.values(y.expense)[3];Ke&&typeof Ke=="string"&&Ke.trim()!==""&&at(Ke)}$t()},disabled:(()=>{if(!y?.expense)return!0;const Ke=Object.values(y.expense)[3];return!Ke||typeof Ke!="string"||Ke.trim()===""})(),children:[d.jsx(Ts,{children:d.jsx(kx,{fontSize:"small"})}),d.jsx(As,{children:"Open Folder"})]})]}),d.jsxs(lp,{open:w!==null,onClose:un,anchorReference:"anchorPosition",anchorPosition:w!==null?{top:w.mouseY,left:w.mouseX}:void 0,children:[d.jsxs(ln,{onClick:Yn,children:[d.jsx(Ts,{children:d.jsx(qh,{fontSize:"small"})}),d.jsx(As,{children:"Pay"})]}),d.jsxs(ln,{onClick:En,children:[d.jsx(Ts,{children:d.jsx(Tf,{fontSize:"small"})}),d.jsx(As,{children:"Show Vendor"})]}),d.jsxs(ln,{onClick:fr,children:[d.jsx(Ts,{children:d.jsx(qh,{fontSize:"small"})}),d.jsx(As,{children:"Bank Account"})]}),d.jsxs(ln,{onClick:fo,children:[d.jsx(Ts,{children:d.jsx(Tf,{fontSize:"small"})}),d.jsx(As,{children:"See Transaction"})]}),d.jsxs(ln,{onClick:xo,disabled:!w?.prepayment?.Folder||w.prepayment.Folder.trim()==="",children:[d.jsx(Ts,{children:d.jsx(kx,{fontSize:"small"})}),d.jsx(As,{children:"Open Folder"})]})]}),d.jsxs(lp,{open:R!==null,onClose:Or,anchorReference:"anchorPosition",anchorPosition:R!==null?{top:R.mouseY,left:R.mouseX}:void 0,children:[d.jsxs(ln,{onClick:Ko,children:[d.jsx(Ts,{children:d.jsx(qh,{fontSize:"small"})}),d.jsx(As,{children:"Pay"})]}),d.jsxs(ln,{onClick:aa,children:[d.jsx(Ts,{children:d.jsx(Tf,{fontSize:"small"})}),d.jsx(As,{children:"Show Vendor"})]}),d.jsxs(ln,{onClick:qr,children:[d.jsx(Ts,{children:d.jsx(qh,{fontSize:"small"})}),d.jsx(As,{children:"Bank Account"})]}),d.jsxs(ln,{onClick:ho,children:[d.jsx(Ts,{children:d.jsx(Tf,{fontSize:"small"})}),d.jsx(As,{children:"See Transaction"})]}),d.jsxs(ln,{onClick:ts,disabled:!R?.invoice?.Folder_Link||R.invoice.Folder_Link.trim()==="",children:[d.jsx(Ts,{children:d.jsx(kx,{fontSize:"small"})}),d.jsx(As,{children:"Open Folder"})]})]}),d.jsxs(lp,{open:M!==null,onClose:Tt,anchorReference:"anchorPosition",anchorPosition:M!==null?{top:M.mouseY,left:M.mouseX}:void 0,children:[d.jsxs(ln,{onClick:or,children:[d.jsx(Ts,{children:d.jsx(qh,{fontSize:"small"})}),d.jsx(As,{children:"Pay"})]}),d.jsxs(ln,{onClick:nr,children:[d.jsx(Ts,{children:d.jsx(Tf,{fontSize:"small"})}),d.jsx(As,{children:"Show Transaction"})]}),d.jsxs(ln,{onClick:Dn,children:[d.jsx(Ts,{children:d.jsx(kx,{fontSize:"small"})}),d.jsx(As,{children:"Open Folder"})]})]}),d.jsx(Wf,{open:O.open,autoHideDuration:6e3,onClose:()=>j({...O,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:d.jsx(Hs,{onClose:()=>j({...O,open:!1}),severity:O.severity,sx:{width:"100%"},children:O.message})}),d.jsxs(oi,{open:K,onClose:Rr,maxWidth:"sm",fullWidth:!0,children:[d.jsx(Ii,{children:"Create Payment Journal"}),d.jsx(ai,{children:d.jsxs(_e,{sx:{mt:1},children:[N==="invoice"&&X&&d.jsxs(We,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[d.jsx("strong",{children:"Vendor:"})," ",X.Buy_from_Vendor_Name,d.jsx("br",{}),d.jsx("strong",{children:"Invoice:"})," ",X.No,d.jsx("br",{}),d.jsx("strong",{children:"Reference:"})," ",X.External_Document_No||"-",d.jsx("br",{}),d.jsx("strong",{children:"Amount:"})," ",X.Currency_Code," ",X.Amount?.toLocaleString()]}),N==="personnel"&&ie&&d.jsxs(We,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[d.jsx("strong",{children:"Vendor:"})," ",ie.Vendor_Name,d.jsx("br",{}),d.jsx("strong",{children:"Expense No:"})," ",ie.No,d.jsx("br",{}),d.jsx("strong",{children:"Reference:"})," ",ie.Invoice_Number||"-",d.jsx("br",{}),d.jsx("strong",{children:"Amount:"})," ",ie.Currency," ",ie.Amount?.toLocaleString()]}),N==="prepayment"&&le&&d.jsxs(We,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[d.jsx("strong",{children:"Vendor:"})," ",le.Vendor_Name,d.jsx("br",{}),d.jsx("strong",{children:"Prepayment No:"})," ",le.No,d.jsx("br",{}),d.jsx("strong",{children:"Reference:"})," ",le.Payment_Reference||"-",d.jsx("br",{}),d.jsx("strong",{children:"Amount:"})," ",le.Currency," ",le.Prepayment_Amount?.toLocaleString()]}),d.jsxs(Hr,{fullWidth:!0,sx:{mb:2},children:[d.jsx(Qi,{id:"bank-account-label",children:"Bank Account"}),d.jsx(Wr,{labelId:"bank-account-label",value:se,label:"Bank Account",onChange:ke=>ye(ke.target.value),disabled:ve,children:ve?d.jsx(ln,{disabled:!0,children:"Loading bank accounts..."}):ne.map(ke=>d.jsxs(ln,{value:ke.No,children:[ke.Name," ",ke.Currency_Code?`(${ke.Currency_Code})`:""]},ke.No))})]}),d.jsx(On,{fullWidth:!0,label:"Payment Reference",value:ze,onChange:ke=>Re(ke.target.value),placeholder:"Enter payment reference (Document No.)",helperText:"This will be used as Document No. in the journal"})]})}),d.jsxs(tl,{children:[d.jsx(Un,{onClick:Rr,children:"Cancel"}),d.jsx(Un,{onClick:Jn,variant:"contained",disabled:!se||ve,children:"Submit"})]})]}),d.jsxs(oi,{open:ue,onClose:Ao,maxWidth:"md",fullWidth:!0,children:[d.jsx(Ii,{children:"Create Salary Payment Journal"}),d.jsx(ai,{children:d.jsxs(_e,{sx:{mt:1},children:[d.jsxs(Hr,{fullWidth:!0,sx:{mb:2},children:[d.jsx(Qi,{id:"salary-bank-account-label",children:"Bank Account"}),d.jsx(Wr,{labelId:"salary-bank-account-label",value:se,label:"Bank Account",onChange:ke=>ye(ke.target.value),disabled:ve,children:ve?d.jsx(ln,{disabled:!0,children:"Loading bank accounts..."}):ne.map(ke=>d.jsxs(ln,{value:ke.No,children:[ke.Name," ",ke.Currency_Code?`(${ke.Currency_Code})`:""]},ke.No))})]}),d.jsx(On,{fullWidth:!0,label:"Payroll Month",value:tt,onChange:ke=>je(ke.target.value),placeholder:"MM/YYYY (e.g., 01/2026)",helperText:"This will be used as External Document No. (Vendor Invoice Ref)",sx:{mb:3}}),d.jsx(T2,{sx:{my:2}}),d.jsx(We,{variant:"subtitle1",sx:{mb:2,fontWeight:"bold"},children:"Add Employees"}),d.jsxs(_e,{sx:{display:"flex",gap:2,mb:2,alignItems:"flex-start"},children:[d.jsx(w2,{sx:{flex:2},options:Ie,getOptionLabel:ke=>`${ke.No} - ${ke.Name}`,value:Fe,onChange:(ke,Ke)=>Ge(Ke),loading:be,filterOptions:(ke,{inputValue:Ke})=>{const cn=Ke.toLowerCase();return ke.filter($n=>$n.No.toLowerCase().includes(cn)||$n.Name.toLowerCase().includes(cn)).slice(0,50)},renderInput:ke=>d.jsx(On,{...ke,label:"Employee (Vendor)",placeholder:"Search by ID or name...",InputProps:{...ke.InputProps,endAdornment:d.jsxs(d.Fragment,{children:[be?d.jsx(Ri,{color:"inherit",size:20}):null,ke.InputProps.endAdornment]})}}),renderOption:(ke,Ke)=>{const{key:cn,...$n}=ke;return d.jsx("li",{...$n,children:d.jsxs(_e,{children:[d.jsxs(We,{variant:"body2",children:[Ke.No," - ",Ke.Name]}),Ke.Currency_Code&&d.jsxs(We,{variant:"caption",color:"text.secondary",children:["Currency: ",Ke.Currency_Code]})]})},cn)}}),d.jsx(On,{sx:{flex:1},label:"Payment Reference",value:Oe,onChange:ke=>mt(ke.target.value),placeholder:"Document No.",size:"medium"}),d.jsx(On,{sx:{flex:1},label:"Amount",type:"number",value:qe,onChange:ke=>Ae(ke.target.value),placeholder:"0.00",size:"medium",InputProps:{inputProps:{min:0,step:.01}}}),d.jsx(Un,{variant:"outlined",startIcon:d.jsx(sg,{}),onClick:kr,disabled:!Fe||!qe,sx:{height:56},children:"Add"})]}),Pe.length>0&&d.jsxs(d.Fragment,{children:[d.jsx(T2,{sx:{my:2}}),d.jsxs(We,{variant:"subtitle1",sx:{mb:2,fontWeight:"bold"},children:["Employees to Pay (",Pe.length,")"]}),d.jsx(qa,{component:ua,variant:"outlined",children:d.jsxs(Ba,{size:"small",children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{bgcolor:"action.hover"},children:[d.jsx(Q,{children:"Vendor ID"}),d.jsx(Q,{children:"Employee Name"}),d.jsx(Q,{children:"Payment Ref"}),d.jsx(Q,{align:"right",children:"Amount"}),d.jsx(Q,{align:"center",children:"Action"})]})}),d.jsxs(za,{children:[Pe.map(ke=>d.jsxs(hn,{children:[d.jsx(Q,{children:ke.vendorNo}),d.jsx(Q,{children:ke.vendorName}),d.jsx(Q,{children:ke.paymentReference||"-"}),d.jsx(Q,{align:"right",children:ke.amount.toLocaleString()}),d.jsx(Q,{align:"center",children:d.jsx(_r,{size:"small",color:"error",onClick:()=>Zr(ke.vendorNo),children:d.jsx(Rp,{fontSize:"small"})})})]},ke.vendorNo)),d.jsxs(hn,{sx:{bgcolor:"action.selected"},children:[d.jsx(Q,{colSpan:3,align:"right",sx:{fontWeight:"bold"},children:"Total:"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold"},children:Pe.reduce((ke,Ke)=>ke+Ke.amount,0).toLocaleString()}),d.jsx(Q,{})]})]})]})})]})]})}),d.jsxs(tl,{children:[d.jsx(Un,{onClick:Ao,children:"Cancel"}),d.jsxs(Un,{onClick:Eo,variant:"contained",disabled:!se||!tt||Pe.length===0,children:["Submit (",Pe.length," employees)"]})]})]}),U&&d.jsx(_e,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:d.jsxs(ua,{sx:{p:3,display:"flex",alignItems:"center",gap:2},children:[d.jsx(Ri,{size:24}),d.jsx(We,{children:"Creating payment journal line..."})]})})]})}const xy=(t,e)=>t.length!==e.length?!1:e.every(r=>t.includes(r)),Lne=({openTo:t,defaultOpenTo:e,views:r,defaultViews:a})=>{const o=r??a;let n;if(t!=null)n=t;else if(o.includes(e))n=e;else if(o.length>0)n=o[0];else throw new Error("MUI X: The `views` prop must contain at least one view.");return{views:o,openTo:n}},oC=(t,e,r)=>{let a=e;return a=t.setHours(a,t.getHours(r)),a=t.setMinutes(a,t.getMinutes(r)),a=t.setSeconds(a,t.getSeconds(r)),a=t.setMilliseconds(a,t.getMilliseconds(r)),a},db=({date:t,disableFuture:e,disablePast:r,maxDate:a,minDate:o,isDateDisabled:n,adapter:f,timezone:m})=>{const y=oC(f,f.date(void 0,m),t);r&&f.isBefore(o,y)&&(o=y),e&&f.isAfter(a,y)&&(a=y);let C=t,w=t;for(f.isBefore(t,o)&&(C=o,w=null),f.isAfter(t,a)&&(w&&(w=a),C=null);C||w;){if(C&&f.isAfter(C,a)&&(C=null),w&&f.isBefore(w,o)&&(w=null),C){if(!n(C))return C;C=f.addDays(C,1)}if(w){if(!n(w))return w;w=f.addDays(w,-1)}}return null},Bne=(t,e)=>t.isValid(e)?e:null,DR=(t,e,r)=>e==null||!t.isValid(e)?r:e,zne=(t,e,r)=>!t.isValid(e)&&e!=null&&!t.isValid(r)&&r!=null?!0:t.isEqual(e,r),vk=(t,e)=>{const a=[t.startOfYear(e)];for(;a.length<12;){const o=a[a.length-1];a.push(t.addMonths(o,1))}return a},P_=(t,e,r)=>r==="date"?t.startOfDay(t.date(void 0,e)):t.date(void 0,e),Une=["year","month","day"],RR=t=>Une.includes(t),xk=(t,{format:e,views:r},a)=>{if(e!=null)return e;const o=t.formats;return xy(r,["year"])?o.year:xy(r,["month"])?o.month:xy(r,["day"])?o.dayOfMonth:xy(r,["month","year"])?`${o.month} ${o.year}`:xy(r,["day","month"])?`${o.month} ${o.dayOfMonth}`:a?/en/.test(t.getCurrentLocaleCode())?o.normalDateWithWeekday:o.normalDate:o.keyboardDate},$ne=(t,e)=>{const r=t.startOfWeek(e);return[0,1,2,3,4,5,6].map(a=>t.addDays(r,a))},Hne=["hours","minutes","seconds"],Wne=t=>Hne.includes(t),IR=(t,e)=>e.getHours(t)*3600+e.getMinutes(t)*60+e.getSeconds(t),Vne=(t,e)=>(r,a)=>t?e.isAfter(r,a):IR(r,e)>IR(a,e),mu={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},Gne=t=>Math.max(...t.map(e=>mu[e.type]??1)),Cy=(t,e,r)=>{if(e===mu.year)return t.startOfYear(r);if(e===mu.month)return t.startOfMonth(r);if(e===mu.day)return t.startOfDay(r);let a=r;return e<mu.minutes&&(a=t.setMinutes(a,0)),e<mu.seconds&&(a=t.setSeconds(a,0)),e<mu.milliseconds&&(a=t.setMilliseconds(a,0)),a},Kne=({props:t,adapter:e,granularity:r,timezone:a,getTodayDate:o})=>{let n=o?o():Cy(e,r,P_(e,a));t.minDate!=null&&e.isAfterDay(t.minDate,n)&&(n=Cy(e,r,t.minDate)),t.maxDate!=null&&e.isBeforeDay(t.maxDate,n)&&(n=Cy(e,r,t.maxDate));const f=Vne(t.disableIgnoringDatePartForTimeValidation??!1,e);return t.minTime!=null&&f(t.minTime,n)&&(n=Cy(e,r,t.disableIgnoringDatePartForTimeValidation?t.minTime:oC(e,n,t.minTime))),t.maxTime!=null&&f(n,t.maxTime)&&(n=Cy(e,r,t.disableIgnoringDatePartForTimeValidation?t.maxTime:oC(e,n,t.maxTime))),n},M_=(t,e)=>{const r=t.formatTokenMap[e];if(r==null)throw new Error([`MUI X: The token "${e}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join(`
`));return typeof r=="string"?{type:r,contentType:r==="meridiem"?"letter":"digit",maxLength:void 0}:{type:r.sectionType,contentType:r.contentType,maxLength:r.maxLength}},bS=(t,e)=>{const r=[],a=t.date(void 0,"default"),o=t.startOfWeek(a),n=t.endOfWeek(a);let f=o;for(;t.isBefore(f,n);)r.push(f),f=t.addDays(f,1);return r.map(m=>t.formatByString(m,e))},__=(t,e,r,a)=>{switch(r){case"month":return vk(t,t.date(void 0,e)).map(o=>t.formatByString(o,a));case"weekDay":return bS(t,a);case"meridiem":{const o=t.date(void 0,e);return[t.startOfDay(o),t.endOfDay(o)].map(n=>t.formatByString(n,a))}default:return[]}},PR="s",Yne=["0","1","2","3","4","5","6","7","8","9"],qne=t=>{const e=t.date(void 0);return t.formatByString(t.setSeconds(e,0),PR)==="0"?Yne:Array.from({length:10}).map((a,o)=>t.formatByString(t.setSeconds(e,o),PR))},kp=(t,e)=>{if(e[0]==="0")return t;const r=[];let a="";for(let o=0;o<t.length;o+=1){a+=t[o];const n=e.indexOf(a);n>-1&&(r.push(n.toString()),a="")}return r.join("")},Ck=(t,e)=>e[0]==="0"?t:t.split("").map(r=>e[Number(r)]).join(""),MR=(t,e)=>{const r=kp(t,e);return r!==" "&&!Number.isNaN(Number(r))},Sk=(t,e)=>Number(t).toString().padStart(e,"0"),O_=(t,e,r,a,o)=>{if(o.type==="day"&&o.contentType==="digit-with-letter"){const f=t.setDate(r.longestMonth,e);return t.formatByString(f,o.format)}let n=e.toString();return o.hasLeadingZerosInInput&&(n=Sk(n,o.maxLength)),Ck(n,a)},wk=(t,e,r)=>{let a=t.value||t.placeholder;const o=e==="non-input"?t.hasLeadingZerosInFormat:t.hasLeadingZerosInInput;return e==="non-input"&&t.hasLeadingZerosInInput&&!t.hasLeadingZerosInFormat&&(a=Number(kp(a,r)).toString()),["input-rtl","input-ltr"].includes(e)&&t.contentType==="digit"&&!o&&a.length===1&&(a=`${a}`),e==="input-rtl"&&(a=`${a}`),a},_R=(t,e,r,a)=>t.formatByString(t.parse(e,r),a),Qne=(t,e)=>t.formatByString(t.date(void 0,"system"),e).length===4,F_=(t,e,r,a)=>{if(e!=="digit")return!1;const o=t.date(void 0,"default");switch(r){case"year":return t.lib==="dayjs"&&a==="YY"?!0:t.formatByString(t.setYear(o,1),a).startsWith("0");case"month":return t.formatByString(t.startOfYear(o),a).length>1;case"day":return t.formatByString(t.startOfMonth(o),a).length>1;case"weekDay":return t.formatByString(t.startOfWeek(o),a).length>1;case"hours":return t.formatByString(t.setHours(o,1),a).length>1;case"minutes":return t.formatByString(t.setMinutes(o,1),a).length>1;case"seconds":return t.formatByString(t.setSeconds(o,1),a).length>1;default:throw new Error("Invalid section type")}},Xne=(t,e,r)=>{const a=e.some(y=>y.type==="day"),o=[],n=[];for(let y=0;y<e.length;y+=1){const C=e[y];a&&C.type==="weekDay"||(o.push(C.format),n.push(wk(C,"non-input",r)))}const f=o.join(" "),m=n.join(" ");return t.parse(m,f)},Jne=t=>t.map(e=>`${e.startSeparator}${e.value||e.placeholder}${e.endSeparator}`).join(""),Zne=(t,e,r)=>{const o=t.map(n=>{const f=wk(n,r?"input-rtl":"input-ltr",e);return`${n.startSeparator}${f}${n.endSeparator}`}).join("");return r?`${o}`:o},ere=(t,e,r)=>{const a=t.date(void 0,r),o=t.endOfYear(a),n=t.endOfDay(a),{maxDaysInMonth:f,longestMonth:m}=vk(t,a).reduce((y,C)=>{const w=t.getDaysInMonth(C);return w>y.maxDaysInMonth?{maxDaysInMonth:w,longestMonth:C}:y},{maxDaysInMonth:0,longestMonth:null});return{year:({format:y})=>({minimum:0,maximum:Qne(t,y)?9999:99}),month:()=>({minimum:1,maximum:t.getMonth(o)+1}),day:({currentDate:y})=>({minimum:1,maximum:t.isValid(y)?t.getDaysInMonth(y):f,longestMonth:m}),weekDay:({format:y,contentType:C})=>{if(C==="digit"){const w=bS(t,y).map(Number);return{minimum:Math.min(...w),maximum:Math.max(...w)}}return{minimum:1,maximum:7}},hours:({format:y})=>{const C=t.getHours(n);return kp(t.formatByString(t.endOfDay(a),y),e)!==C.toString()?{minimum:1,maximum:Number(kp(t.formatByString(t.startOfDay(a),y),e))}:{minimum:0,maximum:C}},minutes:()=>({minimum:0,maximum:t.getMinutes(n)}),seconds:()=>({minimum:0,maximum:t.getSeconds(n)}),meridiem:()=>({minimum:0,maximum:1}),empty:()=>({minimum:0,maximum:0})}},tre=(t,e,r,a)=>{switch(e.type){case"year":return t.setYear(a,t.getYear(r));case"month":return t.setMonth(a,t.getMonth(r));case"weekDay":{let o=t.formatByString(r,e.format);e.hasLeadingZerosInInput&&(o=Sk(o,e.maxLength));const n=bS(t,e.format),f=n.indexOf(o),y=n.indexOf(e.value)-f;return t.addDays(r,y)}case"day":return t.setDate(a,t.getDate(r));case"meridiem":{const o=t.getHours(r)<12,n=t.getHours(a);return o&&n>=12?t.addHours(a,-12):!o&&n<12?t.addHours(a,12):a}case"hours":return t.setHours(a,t.getHours(r));case"minutes":return t.setMinutes(a,t.getMinutes(r));case"seconds":return t.setSeconds(a,t.getSeconds(r));default:return a}},OR={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8,empty:9},FR=(t,e,r,a,o)=>[...r].sort((n,f)=>OR[n.type]-OR[f.type]).reduce((n,f)=>!o||f.modified?tre(t,f,e,n):n,a),nre=()=>navigator.userAgent.toLowerCase().includes("android"),rre=(t,e)=>{const r={};if(!e)return t.forEach((y,C)=>{const w=C===0?null:C-1,A=C===t.length-1?null:C+1;r[C]={leftIndex:w,rightIndex:A}}),{neighbors:r,startIndex:0,endIndex:t.length-1};const a={},o={};let n=0,f=0,m=t.length-1;for(;m>=0;){f=t.findIndex((y,C)=>C>=n&&y.endSeparator?.includes(" ")&&y.endSeparator!==" / "),f===-1&&(f=t.length-1);for(let y=f;y>=n;y-=1)o[y]=m,a[m]=y,m-=1;n=f+1}return t.forEach((y,C)=>{const w=o[C],A=w===0?null:a[w-1],R=w===t.length-1?null:a[w+1];r[C]={leftIndex:A,rightIndex:R}}),{neighbors:r,startIndex:a[0],endIndex:a[t.length-1]}},HT=(t,e)=>{if(t==null)return null;if(t==="all")return"all";if(typeof t=="string"){const r=e.findIndex(a=>a.type===t);return r===-1?null:r}return t},ore=["value","referenceDate"],Mu={emptyValue:null,getTodayValue:P_,getInitialReferenceValue:t=>{let{value:e,referenceDate:r}=t,a=vr(t,ore);return a.adapter.isValid(e)?e:r??Kne(a)},cleanValue:Bne,areValuesEqual:zne,isSameError:(t,e)=>t===e,hasError:t=>t!=null,defaultErrorState:null,getTimezone:(t,e)=>t.isValid(e)?t.getTimezone(e):null,setTimezone:(t,e,r)=>r==null?null:t.setTimezone(r,e)},are={updateReferenceValue:(t,e,r)=>t.isValid(e)?e:r,getSectionsFromValue:(t,e)=>e(t),getV7HiddenInputValueFromSections:Jne,getV6InputValueFromSections:Zne,parseValueStr:(t,e,r)=>r(t.trim(),e),getDateFromSection:t=>t,getDateSectionsFromValue:t=>t,updateDateInValue:(t,e,r)=>r,clearDateSections:t=>t.map(e=>Xe({},e,{value:""}))};function sre(t){return Cn("MuiPickersToolbar",t)}bn("MuiPickersToolbar",["root","title","content"]);const ire=["localeText"],WT=E.createContext(null),Nb=function(e){const{localeText:r}=e,a=vr(e,ire),{adapter:o,localeText:n}=E.useContext(WT)??{adapter:void 0,localeText:void 0},f=Da({props:a,name:"MuiLocalizationProvider"}),{children:m,dateAdapter:y,dateFormats:C,dateLibInstance:w,adapterLocale:A,localeText:R}=f,I=E.useMemo(()=>Xe({},R,n,r),[R,n,r]),M=E.useMemo(()=>{if(!y)return o||null;const j=new y({locale:A,formats:C,instance:w});if(!j.isMUIAdapter)throw new Error(["MUI X: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/quickstart/#installation"].join(`
`));return j},[y,A,C,w,o]),F=E.useMemo(()=>M?{minDate:M.date("1900-01-01T00:00:00.000"),maxDate:M.date("2099-12-31T00:00:00.000")}:null,[M]),O=E.useMemo(()=>({utils:M,adapter:M,defaultDates:F,localeText:I}),[F,M,I]);return d.jsx(WT.Provider,{value:O,children:m})},N_=E.createContext(()=>!0);function lre(){return E.useContext(N_)}const j_=E.createContext(null);function L_(){return E.useContext(j_)}const Tk=E.createContext(null),Cg=()=>{const t=E.useContext(Tk);if(t==null)throw new Error("MUI X: The `usePickerContext` hook can only be called inside the context of a Picker component");return t},B_=E.createContext(null),z_=E.createContext({ownerState:{isPickerDisabled:!1,isPickerReadOnly:!1,isPickerValueEmpty:!1,isPickerOpen:!1,pickerVariant:"desktop",pickerOrientation:"portrait"},rootRefObject:{current:null},labelId:void 0,dismissViews:()=>{},hasUIView:!0,getCurrentViewMode:()=>"UI",triggerElement:null,viewContainerRole:null,defaultActionBarActions:[],onPopperExited:void 0});function U_(t){const{contextValue:e,actionsContextValue:r,privateContextValue:a,fieldPrivateContextValue:o,isValidContextValue:n,localeText:f,children:m}=t;return d.jsx(Tk.Provider,{value:e,children:d.jsx(B_.Provider,{value:r,children:d.jsx(z_.Provider,{value:a,children:d.jsx(j_.Provider,{value:o,children:d.jsx(N_.Provider,{value:n,children:d.jsx(Nb,{localeText:f,children:m})})})})})})}const Ws=()=>E.useContext(z_);function $_(){const{ownerState:t}=Ws(),e=Pi();return E.useMemo(()=>Xe({},t,{toolbarDirection:e?"rtl":"ltr"}),[t,e])}const cre=["children","className","classes","toolbarTitle","hidden","titleId","classes","landscapeDirection"],ure=t=>pn({root:["root"],title:["title"],content:["content"]},sre,t),dre=nt("div",{name:"MuiPickersToolbar",slot:"Root"})(({theme:t})=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:t.spacing(2,3),variants:[{props:{pickerOrientation:"landscape"},style:{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"}}]})),fre=nt("div",{name:"MuiPickersToolbar",slot:"Content",shouldForwardProp:t=>Au(t)&&t!=="landscapeDirection"})({display:"flex",flexWrap:"wrap",width:"100%",flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row",variants:[{props:{pickerOrientation:"landscape"},style:{justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"}},{props:{pickerOrientation:"landscape",landscapeDirection:"row"},style:{flexDirection:"row"}}]}),hre=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersToolbar"}),{children:o,className:n,classes:f,toolbarTitle:m,hidden:y,titleId:C,landscapeDirection:w}=a,A=vr(a,cre),R=$_(),I=ure(f);return y?null:d.jsxs(dre,Xe({ref:r,className:Ht(I.root,n),ownerState:R},A,{children:[d.jsx(We,{color:"text.secondary",variant:"overline",id:C,className:I.title,children:m}),d.jsx(fre,{className:I.content,ownerState:R,landscapeDirection:w,children:o})]}))}),pre=t=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:Xe({},t)}}}}),H_={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"Open previous view",openNextView:"Open next view",calendarViewSwitchingButtonAriaLabel:t=>t==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",startDate:"Start date",startTime:"Start time",endDate:"End date",endTime:"End time",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",nextStepButtonLabel:"Next",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",timeRangePickerToolbarTitle:"Select time range",clockLabelText:(t,e)=>`Select ${t}. ${e?`Selected time is ${e}`:"No time selected"}`,hoursClockNumberText:t=>`${t} hours`,minutesClockNumberText:t=>`${t} minutes`,secondsClockNumberText:t=>`${t} seconds`,selectViewText:t=>`Select ${t}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:t=>`Week ${t}`,calendarWeekNumberText:t=>`${t}`,openDatePickerDialogue:t=>t?`Choose date, selected date is ${t}`:"Choose date",openTimePickerDialogue:t=>t?`Choose time, selected time is ${t}`:"Choose time",openRangePickerDialogue:t=>t?`Choose range, selected range is ${t}`:"Choose range",fieldClearLabel:"Clear",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:t=>"Y".repeat(t.digitAmount),fieldMonthPlaceholder:t=>t.contentType==="letter"?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:t=>t.contentType==="letter"?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa",year:"Year",month:"Month",day:"Day",weekDay:"Week day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",meridiem:"Meridiem",empty:"Empty"},mre=H_;pre(H_);const Ak=()=>{const t=E.useContext(WT);if(t===null)throw new Error(["MUI X: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join(`
`));if(t.adapter===null)throw new Error(["MUI X: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join(`
`));const e=E.useMemo(()=>Xe({},mre,t.localeText),[t.localeText]);return E.useMemo(()=>Xe({},t,{localeText:e}),[t,e])},Jo=()=>Ak().adapter,Kf=()=>Ak().localeText,VT=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],GT=["disablePast","disableFuture","minTime","maxTime","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],W_=["minDateTime","maxDateTime"],gre=[...VT,...GT,...W_],V_=t=>gre.reduce((e,r)=>(t.hasOwnProperty(r)&&(e[r]=t[r]),e),{}),yre=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef","unstableStartFieldRef","unstableEndFieldRef","enableAccessibleFieldDOMStructure","disabled","readOnly","dateSeparator","autoFocus","focused"],G_=(t,e)=>E.useMemo(()=>{const r=Xe({},t),a={},o=n=>{r.hasOwnProperty(n)&&(a[n]=r[n],delete r[n])};return yre.forEach(o),e==="date"?VT.forEach(o):e==="time"?GT.forEach(o):e==="date-time"&&(VT.forEach(o),GT.forEach(o),W_.forEach(o)),{forwardedProps:r,internalProps:a}},[t,e]),bre=({adapter:t,format:e})=>{let r=10,a=e,o=t.expandFormat(e);for(;o!==a;)if(a=o,o=t.expandFormat(a),r-=1,r<0)throw new Error("MUI X: The format expansion seems to be in an infinite loop. Please open an issue with the format passed to the component.");return o},vre=({adapter:t,expandedFormat:e})=>{const r=[],{start:a,end:o}=t.escapedCharacters,n=new RegExp(`(\\${a}[^\\${o}]*\\${o})+`,"g");let f=null;for(;f=n.exec(e);)r.push({start:f.index,end:n.lastIndex-1});return r},xre=(t,e,r,a)=>{switch(r.type){case"year":return e.fieldYearPlaceholder({digitAmount:t.formatByString(t.date(void 0,"default"),a).length,format:a});case"month":return e.fieldMonthPlaceholder({contentType:r.contentType,format:a});case"day":return e.fieldDayPlaceholder({format:a});case"weekDay":return e.fieldWeekDayPlaceholder({contentType:r.contentType,format:a});case"hours":return e.fieldHoursPlaceholder({format:a});case"minutes":return e.fieldMinutesPlaceholder({format:a});case"seconds":return e.fieldSecondsPlaceholder({format:a});case"meridiem":return e.fieldMeridiemPlaceholder({format:a});default:return a}},Cre=({adapter:t,date:e,shouldRespectLeadingZeros:r,localeText:a,localizedDigits:o,now:n,token:f,startSeparator:m})=>{if(f==="")throw new Error("MUI X: Should not call `commitToken` with an empty token");const y=M_(t,f),C=F_(t,y.contentType,y.type,f),w=r?C:y.contentType==="digit",A=t.isValid(e);let R=A?t.formatByString(e,f):"",I=null;if(w)if(C)I=R===""?t.formatByString(n,f).length:R.length;else{if(y.maxLength==null)throw new Error(`MUI X: The token ${f} should have a 'maxLength' property on it's adapter`);I=y.maxLength,A&&(R=Ck(Sk(kp(R,o),I),o))}return Xe({},y,{format:f,maxLength:I,value:R,placeholder:xre(t,a,y,f),hasLeadingZerosInFormat:C,hasLeadingZerosInInput:w,startSeparator:m,endSeparator:"",modified:!1})},Sre=t=>{const{adapter:e,expandedFormat:r,escapedParts:a}=t,o=e.date(void 0),n=[];let f="";const m=Object.keys(e.formatTokenMap).sort((I,M)=>M.length-I.length),y=/^([a-zA-Z]+)/,C=new RegExp(`^(${m.join("|")})*$`),w=new RegExp(`^(${m.join("|")})`),A=I=>a.find(M=>M.start<=I&&M.end>=I);let R=0;for(;R<r.length;){const I=A(R),M=I!=null,F=y.exec(r.slice(R))?.[1];if(!M&&F!=null&&C.test(F)){let O=F;for(;O.length>0;){const j=w.exec(O)[1];O=O.slice(j.length),n.push(Cre(Xe({},t,{now:o,token:j,startSeparator:f}))),f=""}R+=F.length}else{const O=r[R];M&&I?.start===R||I?.end===R||(n.length===0?f+=O:(n[n.length-1].endSeparator+=O,n[n.length-1].isEndFormatSeparator=!0)),R+=1}}return n.length===0&&f.length>0&&n.push({type:"empty",contentType:"letter",maxLength:null,format:"",value:"",placeholder:"",hasLeadingZerosInFormat:!1,hasLeadingZerosInInput:!1,startSeparator:f,endSeparator:"",modified:!1}),n},wre=({isRtl:t,formatDensity:e,sections:r})=>r.map(a=>{const o=n=>{let f=n;return t&&f!==null&&f.includes(" ")&&(f=`${f}`),e==="spacious"&&["/",".","-"].includes(f)&&(f=` ${f} `),f};return a.startSeparator=o(a.startSeparator),a.endSeparator=o(a.endSeparator),a}),NR=t=>{let e=bre(t);t.isRtl&&t.enableAccessibleFieldDOMStructure&&(e=e.split(" ").reverse().join(" "));const r=vre(Xe({},t,{expandedFormat:e})),a=Sre(Xe({},t,{expandedFormat:e,escapedParts:r}));return wre(Xe({},t,{sections:a}))},Ek=()=>E.useContext(Tk),Tre=()=>{const t=E.useContext(B_);if(t==null)throw new Error(["MUI X: The `usePickerActionsContext` can only be called in fields that are used as a slot of a Picker component"].join(`
`));return t};function Are(t){return Cn("MuiDatePickerToolbar",t)}bn("MuiDatePickerToolbar",["root","title"]);const Ere=["toolbarFormat","toolbarPlaceholder","className","classes"],kre=t=>pn({root:["root"],title:["title"]},Are,t),Dre=nt(hre,{name:"MuiDatePickerToolbar",slot:"Root"})({}),Rre=nt(We,{name:"MuiDatePickerToolbar",slot:"Title"})({variants:[{props:{pickerOrientation:"landscape"},style:{margin:"auto 16px auto auto"}}]}),Ire=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiDatePickerToolbar"}),{toolbarFormat:o,toolbarPlaceholder:n="",className:f,classes:m}=a,y=vr(a,Ere),C=Jo(),{value:w,views:A,orientation:R}=Cg(),I=Kf(),M=$_(),F=kre(m),O=E.useMemo(()=>{if(!C.isValid(w))return n;const j=xk(C,{format:o,views:A},!0);return C.formatByString(w,j)},[w,o,n,C,A]);return d.jsx(Dre,Xe({ref:r,toolbarTitle:I.datePickerToolbarTitle,className:Ht(F.root,f)},y,{children:d.jsx(Rre,{variant:"h4",align:R==="landscape"?"left":"center",ownerState:M,className:F.title,children:O})}))}),jb=({props:t,value:e,timezone:r,adapter:a})=>{if(e===null)return null;const{shouldDisableDate:o,shouldDisableMonth:n,shouldDisableYear:f,disablePast:m,disableFuture:y,minDate:C,maxDate:w}=t,A=a.date(void 0,r);switch(!0){case!a.isValid(e):return"invalidDate";case!!(o&&o(e)):return"shouldDisableDate";case!!(n&&n(e)):return"shouldDisableMonth";case!!(f&&f(e)):return"shouldDisableYear";case!!(y&&a.isAfterDay(e,A)):return"disableFuture";case!!(m&&a.isBeforeDay(e,A)):return"disablePast";case!!(C&&a.isBeforeDay(e,C)):return"minDate";case!!(w&&a.isAfterDay(e,w)):return"maxDate";default:return null}};jb.valueManager=Mu;function K_(t){const{props:e,validator:r,value:a,timezone:o,onError:n}=t,f=Jo(),m=E.useRef(r.valueManager.defaultErrorState),y=r({adapter:f,value:a,timezone:o,props:e}),C=r.valueManager.hasError(y);E.useEffect(()=>{n&&!r.valueManager.isSameError(y,m.current)&&n(y,a),m.current=y},[r,n,y,a]);const w=yn(A=>r({adapter:f,value:A,timezone:o,props:e}));return{validationError:y,hasValidationError:C,getValidationErrorForNewValue:w}}const Pre=()=>Ak().defaultDates,vS=t=>{const e=Jo(),r=E.useRef(void 0);return r.current===void 0&&(r.current=e.date(void 0,t)),r.current};function Mre(t={}){const{enableAccessibleFieldDOMStructure:e=!0}=t;return E.useMemo(()=>({valueType:"date",validator:jb,internal_valueManager:Mu,internal_fieldValueManager:are,internal_enableAccessibleFieldDOMStructure:e,internal_useApplyDefaultValuesToFieldInternalProps:Ore,internal_useOpenPickerButtonAriaLabel:_re}),[e])}function _re(t){const e=Jo(),r=Kf();return E.useMemo(()=>{const a=e.isValid(t)?e.format(t,"fullDate"):null;return r.openDatePickerDialogue(a)},[t,r,e])}function Ore(t){const e=Jo(),r=Lb(t);return E.useMemo(()=>Xe({},t,r,{format:t.format??e.formats.keyboardDate}),[t,r,e])}function Lb(t){const e=Jo(),r=Pre();return E.useMemo(()=>({disablePast:t.disablePast??!1,disableFuture:t.disableFuture??!1,minDate:DR(e,t.minDate,r.minDate),maxDate:DR(e,t.maxDate,r.maxDate)}),[t.minDate,t.maxDate,t.disableFuture,t.disablePast,e,r])}function Y_(t,e){const r=Da({props:t,name:e}),a=Lb(r),o=E.useMemo(()=>r.localeText?.toolbarTitle==null?r.localeText:Xe({},r.localeText,{datePickerToolbarTitle:r.localeText.toolbarTitle}),[r.localeText]);return Xe({},r,a,{localeText:o},Lne({views:r.views,openTo:r.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{slots:Xe({toolbar:Ire},r.slots)})}function Fre(t){return Cn("MuiPickerPopper",t)}bn("MuiPickerPopper",["root","paper"]);function Nre(t,e){return Array.isArray(e)?e.every(r=>t.indexOf(r)!==-1):t.indexOf(e)!==-1}const jre=t=>{setTimeout(t,0)},q_=(t=document)=>{const e=t.activeElement;return e?e.shadowRoot?q_(e.shadowRoot):e:null},Di=t=>q_($a(t)),Lre="@media (pointer: fine)",Bre=["PaperComponent","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],zre=t=>pn({root:["root"],paper:["paper"]},Fre,t),Ure=nt(wb,{name:"MuiPickerPopper",slot:"Root"})(({theme:t})=>({zIndex:t.zIndex.modal})),$re=nt(ua,{name:"MuiPickerPopper",slot:"Paper"})({outline:0,transformOrigin:"top center",variants:[{props:({popperPlacement:t})=>new Set(["top","top-start","top-end"]).has(t),style:{transformOrigin:"bottom center"}}]});function Hre(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function Wre(t,e){const r=E.useRef(!1),a=E.useRef(!1),o=E.useRef(null),n=E.useRef(!1);E.useEffect(()=>{if(!t)return;function y(){n.current=!0}return document.addEventListener("mousedown",y,!0),document.addEventListener("touchstart",y,!0),()=>{document.removeEventListener("mousedown",y,!0),document.removeEventListener("touchstart",y,!0),n.current=!1}},[t]);const f=yn(y=>{if(!n.current)return;const C=a.current;a.current=!1;const w=$a(o.current);if(!o.current||"clientX"in y&&Hre(y,w))return;if(r.current){r.current=!1;return}let A;y.composedPath?A=y.composedPath().indexOf(o.current)>-1:A=!w.documentElement.contains(y.target)||o.current.contains(y.target),!A&&!C&&e(y)}),m=y=>{y.defaultMuiPrevented||(a.current=!0)};return E.useEffect(()=>{if(t){const y=$a(o.current),C=()=>{r.current=!0};return y.addEventListener("touchstart",f),y.addEventListener("touchmove",C),()=>{y.removeEventListener("touchstart",f),y.removeEventListener("touchmove",C)}}},[t,f]),E.useEffect(()=>{if(t){const y=$a(o.current);return y.addEventListener("click",f),()=>{y.removeEventListener("click",f),a.current=!1}}},[t,f]),[o,m,m]}const Vre=E.forwardRef((t,e)=>{const{PaperComponent:r,ownerState:a,children:o,paperSlotProps:n,paperClasses:f,onPaperClick:m,onPaperTouchStart:y}=t,C=vr(t,Bre),w=no({elementType:r,externalSlotProps:n,additionalProps:{tabIndex:-1,elevation:8,ref:e},className:f,ownerState:a});return d.jsx(r,Xe({},C,w,{onClick:A=>{m(A),w.onClick?.(A)},onTouchStart:A=>{y(A),w.onTouchStart?.(A)},ownerState:a,children:o}))});function Gre(t){const e=Da({props:t,name:"MuiPickerPopper"}),{children:r,placement:a="bottom-start",slots:o,slotProps:n,classes:f}=e,{open:m,popupRef:y,reduceAnimations:C}=Cg(),{ownerState:w,rootRefObject:A}=Ws(),{dismissViews:R,getCurrentViewMode:I,onPopperExited:M,triggerElement:F,viewContainerRole:O}=Ws();E.useEffect(()=>{function ye(ze){m&&ze.key==="Escape"&&R()}return document.addEventListener("keydown",ye),()=>{document.removeEventListener("keydown",ye)}},[R,m]);const j=E.useRef(null);E.useEffect(()=>{O==="tooltip"||I()==="field"||(m?j.current=Di(A.current):j.current&&j.current instanceof HTMLElement&&setTimeout(()=>{j.current instanceof HTMLElement&&j.current.focus()}))},[m,O,I,A]);const U=zre(f),H=yn(()=>{O==="tooltip"?jre(()=>{A.current?.contains(Di(A.current))||y.current?.contains(Di(y.current))||R()}):R()}),[K,W,X]=Wre(m,H),ee=E.useRef(null),ie=ro(ee,y),de=ro(ie,K),le=ye=>{ye.key==="Escape"&&(ye.stopPropagation(),R())},oe=o?.desktopTransition??C?gp:Zm,N=o?.desktopTrapFocus??pI,ce=o?.desktopPaper??$re,ne=o?.popper??Ure,Se=no({elementType:ne,externalSlotProps:n?.popper,additionalProps:{transition:!0,role:O??void 0,open:m,placement:a,anchorEl:F,onKeyDown:le},className:U.root,ownerState:w}),se=E.useMemo(()=>Xe({},w,{popperPlacement:Se.placement}),[w,Se.placement]);return d.jsx(ne,Xe({},Se,{children:({TransitionProps:ye})=>d.jsx(N,Xe({open:m,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:O==="tooltip",isEnabled:()=>!0},n?.desktopTrapFocus,{children:d.jsx(oe,Xe({},ye,n?.desktopTransition,{onExited:ze=>{M?.(),n?.desktopTransition?.onExited?.(ze),ye?.onExited?.()},children:d.jsx(Vre,{PaperComponent:ce,ownerState:se,ref:de,onPaperClick:W,onPaperTouchStart:X,paperClasses:U.paper,paperSlotProps:n?.desktopPaper,children:r})}))}))}))}const Kre="@media (prefers-reduced-motion: reduce)",Hm=typeof navigator<"u"&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),jR=Hm&&Hm[1]?parseInt(Hm[1],10):null,LR=Hm&&Hm[2]?parseInt(Hm[2],10):null,Yre=jR&&jR<10||LR&&LR<13||!1;function Q_(t){const e=II(Kre,{defaultMatches:!1});return t??(e||Yre)}const X_={hasNextStep:!1,hasSeveralSteps:!1,goToNextStep:()=>{},areViewsInSameStep:()=>!0};function qre(t){const{steps:e,isViewMatchingStep:r,onStepChange:a}=t;return o=>{if(e==null)return X_;const n=e.findIndex(m=>r(o.view,m)),f=n===-1||n===e.length-1?null:e[n+1];return{hasNextStep:f!=null,hasSeveralSteps:e.length>1,goToNextStep:()=>{f!=null&&a(Xe({},o,{step:f}))},areViewsInSameStep:(m,y)=>{const C=e.find(A=>r(m,A)),w=e.find(A=>r(y,A));return C===w}}}}function J_({onChange:t,onViewChange:e,openTo:r,view:a,views:o,autoFocus:n,focusedView:f,onFocusedViewChange:m,getStepNavigation:y}){const C=E.useRef(r),w=E.useRef(o),A=E.useRef(o.includes(r)?r:o[0]),[R,I]=Ki({name:"useViews",state:"view",controlled:a,default:A.current}),M=E.useRef(n?R:null),[F,O]=Ki({name:"useViews",state:"focusedView",controlled:f,default:M.current}),j=y?y({setView:I,view:R,defaultView:A.current,views:o}):X_;E.useEffect(()=>{(C.current&&C.current!==r||w.current&&w.current.some(de=>!o.includes(de)))&&(I(o.includes(r)?r:o[0]),w.current=o,C.current=r)},[r,I,R,o]);const U=o.indexOf(R),H=o[U-1]??null,K=o[U+1]??null,W=yn((de,le)=>{O(le?de:oe=>de===oe?null:oe),m?.(de,le)}),X=yn(de=>{W(de,!0),de!==R&&(I(de),e&&e(de))}),ee=yn(()=>{K&&X(K)}),ie=yn((de,le,oe)=>{const N=le==="finish",ce=oe?o.indexOf(oe)<o.length-1:!!K;t(de,N&&ce?"partial":le,oe);let Se=null;if(oe!=null&&oe!==R?Se=oe:N&&(Se=R),Se==null)return;const se=o[o.indexOf(Se)+1];se==null||!j.areViewsInSameStep(Se,se)||X(se)});return Xe({},j,{view:R,setView:X,focusedView:F,setFocusedView:W,nextView:K,previousView:H,defaultView:o.includes(r)?r:o[0],goToNextView:ee,setValueAndGoToNextView:ie})}function BR(){return typeof window>"u"?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?Math.abs(window.screen.orientation.angle)===90?"landscape":"portrait":window.orientation&&Math.abs(Number(window.orientation))===90?"landscape":"portrait"}function Qre(t,e){const[r,a]=E.useState(BR);return ka(()=>{const o=()=>{a(BR())};return window.addEventListener("orientationchange",o),()=>{window.removeEventListener("orientationchange",o)}},[]),Nre(t,["hours","minutes","seconds"])?"portrait":e??r}const Bb=({name:t,timezone:e,value:r,defaultValue:a,referenceDate:o,onChange:n,valueManager:f})=>{const m=Jo(),[y,C]=Ki({name:t,state:"value",controlled:r,default:a??f.emptyValue}),w=E.useMemo(()=>f.getTimezone(m,y),[m,f,y]),A=yn(F=>w==null?F:f.setTimezone(m,w,F)),R=E.useMemo(()=>e||w||(o?m.getTimezone(Array.isArray(o)?o[0]:o):"default"),[e,w,o,m]),I=E.useMemo(()=>f.setTimezone(m,R,y),[f,m,R,y]),M=yn((F,...O)=>{const j=A(F);C(j),n?.(j,...O)});return{value:I,handleValueChange:M,timezone:R}};function Xre(t){const{props:e,valueManager:r,validator:a}=t,{value:o,defaultValue:n,onChange:f,referenceDate:m,timezone:y,onAccept:C,closeOnSelect:w,open:A,onOpen:R,onClose:I}=e,{current:M}=E.useRef(n),{current:F}=E.useRef(o!==void 0),{current:O}=E.useRef(A!==void 0),j=Jo(),{timezone:U,value:H,handleValueChange:K}=Bb({name:"a picker component",timezone:y,value:o,defaultValue:M,referenceDate:m,onChange:f,valueManager:r}),[W,X]=E.useState(()=>({open:!1,lastExternalValue:H,clockShallowValue:void 0,lastCommittedValue:H,hasBeenModifiedSinceMount:!1})),{getValidationErrorForNewValue:ee}=K_({props:e,validator:a,timezone:U,value:H,onError:e.onError}),ie=yn(N=>{const ce=typeof N=="function"?N(W.open):N;O||X(ne=>Xe({},ne,{open:ce})),ce&&R&&R(),ce||I?.()}),de=yn((N,ce)=>{const{changeImportance:ne="accept",skipPublicationIfPristine:Se=!1,validationError:se,shortcut:ye,source:ze,shouldClose:Re=ne==="accept"}=ce??{};let ve,V;!Se&&!F&&!W.hasBeenModifiedSinceMount?(ve=!0,V=ne==="accept"):(ve=!r.areValuesEqual(j,N,H),V=ne==="accept"&&!r.areValuesEqual(j,N,W.lastCommittedValue)),X(Ie=>Xe({},Ie,{clockShallowValue:ve?void 0:Ie.clockShallowValue,lastCommittedValue:V?N:Ie.lastCommittedValue,hasBeenModifiedSinceMount:!0}));let ue=null;const Ee=()=>{if(!ue){let Ie;ze?Ie=ze:ye?Ie="view":Ie="unknown",ue={validationError:se??ee(N),source:Ie},ye&&(ue.shortcut=ye)}return ue};ve&&K(N,Ee()),V&&C&&C(N,Ee()),Re&&ie(!1)});H!==W.lastExternalValue&&X(N=>Xe({},N,{lastExternalValue:H,clockShallowValue:void 0,hasBeenModifiedSinceMount:!0}));const le=yn((N,ce="partial")=>{if(ce==="shallow"){X(ne=>Xe({},ne,{clockShallowValue:N,hasBeenModifiedSinceMount:!0}));return}de(N,{changeImportance:ce==="finish"&&w?"accept":"set",source:"view"})});E.useEffect(()=>{if(O){if(A===void 0)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");X(N=>Xe({},N,{open:A}))}},[O,A]);const oe=E.useMemo(()=>r.cleanValue(j,W.clockShallowValue===void 0?H:W.clockShallowValue),[j,r,W.clockShallowValue,H]);return{timezone:U,state:W,setValue:de,setValueFromView:le,setOpen:ie,value:H,viewValue:oe}}const Jre=["className","sx"],Z_=({ref:t,props:e,valueManager:r,valueType:a,variant:o,validator:n,onPopperExited:f,autoFocusView:m,rendererInterceptor:y,localeText:C,viewContainerRole:w,getStepNavigation:A})=>{const{views:R,view:I,openTo:M,onViewChange:F,viewRenderers:O,reduceAnimations:j,orientation:U,disableOpenPicker:H,closeOnSelect:K,disabled:W,readOnly:X,formatDensity:ee,enableAccessibleFieldDOMStructure:ie,selectedSections:de,onSelectedSectionsChange:le,format:oe,label:N,autoFocus:ce,name:ne}=e,{className:Se,sx:se}=e,ye=vr(e,Jre),ze=nc(),Re=Jo(),ve=Q_(j),V=Qre(R,U),{current:ue}=E.useRef(M??null),[Ee,Ie]=E.useState(null),ae=E.useRef(null),be=E.useRef(null),Te=E.useRef(null),tt=ro(t,Te),{timezone:je,state:Pe,setOpen:Be,setValue:Fe,setValueFromView:Ge,value:Oe,viewValue:mt}=Xre({props:e,valueManager:r,validator:n}),{view:qe,setView:Ae,defaultView:te,focusedView:pe,setFocusedView:J,setValueAndGoToNextView:fe,goToNextStep:xe,hasNextStep:Ne,hasSeveralSteps:Me}=J_({view:I,views:R,openTo:M,onChange:Ge,onViewChange:F,autoFocus:m,getStepNavigation:A}),Ve=yn(()=>Fe(r.emptyValue,{source:"view"})),Qe=yn(()=>Fe(r.getTodayValue(Re,je,a),{source:"view"})),rt=yn(()=>Fe(Oe,{source:"view"})),st=yn(()=>Fe(Pe.lastCommittedValue,{skipPublicationIfPristine:!0,source:"view"})),it=yn(()=>{Fe(Oe,{skipPublicationIfPristine:!0,source:"view"})}),{hasUIView:xt,viewModeLookup:pt,timeViewsCount:Yt}=E.useMemo(()=>R.reduce((Bt,gr)=>{const en=O[gr]==null?"field":"UI";return Bt.viewModeLookup[gr]=en,en==="UI"&&(Bt.hasUIView=!0,Wne(gr)&&(Bt.timeViewsCount+=1)),Bt},{hasUIView:!1,viewModeLookup:{},timeViewsCount:0}),[O,R]),Kt=pt[qe],tn=yn(()=>Kt),[Wt,_t]=E.useState(Kt==="UI"?qe:null);Wt!==qe&&pt[qe]==="UI"&&_t(qe),ka(()=>{Kt==="field"&&Pe.open&&(Be(!1),setTimeout(()=>{be?.current?.setSelectedSections(qe),be?.current?.focusField(qe)}))},[qe]),ka(()=>{if(!Pe.open)return;let Bt=qe;Kt==="field"&&Wt!=null&&(Bt=Wt),Bt!==te&&pt[Bt]==="UI"&&pt[te]==="UI"&&(Bt=te),Bt!==qe&&Ae(Bt),J(Bt,!0)},[Pe.open]);const at=E.useMemo(()=>({isPickerValueEmpty:r.areValuesEqual(Re,Oe,r.emptyValue),isPickerOpen:Pe.open,isPickerDisabled:e.disabled??!1,isPickerReadOnly:e.readOnly??!1,pickerOrientation:V,pickerVariant:o}),[Re,r,Oe,Pe.open,V,o,e.disabled,e.readOnly]),Et=E.useMemo(()=>H||!xt?"hidden":W||X?"disabled":"enabled",[H,xt,W,X]),qt=yn(xe),gn=E.useMemo(()=>K&&!Me?[]:["cancel","nextOrAccept"],[K,Me]),Sn=E.useMemo(()=>({setValue:Fe,setOpen:Be,clearValue:Ve,setValueToToday:Qe,acceptValueChanges:rt,cancelValueChanges:st,setView:Ae,goToNextStep:qt}),[Fe,Be,Ve,Qe,rt,st,Ae,qt]),Zt=E.useMemo(()=>Xe({},Sn,{value:Oe,timezone:je,open:Pe.open,views:R,view:Wt,initialView:ue,disabled:W??!1,readOnly:X??!1,autoFocus:ce??!1,variant:o,orientation:V,popupRef:ae,reduceAnimations:ve,triggerRef:Ie,triggerStatus:Et,hasNextStep:Ne,fieldFormat:oe??"",name:ne,label:N,rootSx:se,rootRef:tt,rootClassName:Se}),[Sn,Oe,tt,o,V,ve,W,X,oe,Se,ne,N,se,Et,Ne,je,Pe.open,Wt,R,ue,ce]),Kn=E.useMemo(()=>({dismissViews:it,ownerState:at,hasUIView:xt,getCurrentViewMode:tn,rootRefObject:Te,labelId:ze,triggerElement:Ee,viewContainerRole:w,defaultActionBarActions:gn,onPopperExited:f}),[it,at,xt,tn,ze,Ee,w,gn,f]),$t=E.useMemo(()=>({formatDensity:ee,enableAccessibleFieldDOMStructure:ie,selectedSections:de,onSelectedSectionsChange:le,fieldRef:be}),[ee,ie,de,le,be]);return{providerProps:{localeText:C,contextValue:Zt,privateContextValue:Kn,actionsContextValue:Sn,fieldPrivateContextValue:$t,isValidContextValue:Bt=>{const gr=n({adapter:Re,value:Bt,timezone:je,props:e});return!r.hasError(gr)}},renderCurrentView:()=>{if(Wt==null)return null;const Bt=O[Wt];if(Bt==null)return null;const gr=Xe({},ye,{views:R,timezone:je,value:mt,onChange:fe,view:Wt,onViewChange:Ae,showViewSwitcher:Yt>1,timeViewsCount:Yt},w==="tooltip"?{focusedView:null,onFocusedViewChange:()=>{}}:{focusedView:pe,onFocusedViewChange:J});return y?d.jsx(y,{viewRenderers:O,popperView:Wt,rendererProps:gr}):Bt(gr)},ownerState:at}};function eO(t){return Cn("MuiPickersLayout",t)}const Xh=bn("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),Zre=["actions"],eoe=nt(tl,{name:"MuiPickersLayout",slot:"ActionBar"})({});function toe(t){const{actions:e}=t,r=vr(t,Zre),a=Kf(),{clearValue:o,setValueToToday:n,acceptValueChanges:f,cancelValueChanges:m,goToNextStep:y,hasNextStep:C}=Cg();if(e==null||e.length===0)return null;const w=e?.map(A=>{switch(A){case"clear":return d.jsx(Un,{onClick:o,children:a.clearButtonLabel},A);case"cancel":return d.jsx(Un,{onClick:m,children:a.cancelButtonLabel},A);case"accept":return d.jsx(Un,{onClick:f,children:a.okButtonLabel},A);case"today":return d.jsx(Un,{onClick:n,children:a.todayButtonLabel},A);case"next":return d.jsx(Un,{onClick:y,children:a.nextStepButtonLabel},A);case"nextOrAccept":return C?d.jsx(Un,{onClick:y,children:a.nextStepButtonLabel},A):d.jsx(Un,{onClick:f,children:a.okButtonLabel},A);default:return null}});return d.jsx(eoe,Xe({},r,{children:w}))}const noe=E.memo(toe),fb=36,xS=2,CS=320,roe=280,kk=336,ooe=["items","changeImportance"],aoe=["getValue"],soe=nt(bI,{name:"MuiPickersLayout",slot:"Shortcuts"})({});function ioe(t){const{items:e,changeImportance:r="accept"}=t,a=vr(t,ooe),{setValue:o}=Tre(),n=lre();if(e==null||e.length===0)return null;const f=e.map(m=>{let{getValue:y}=m,C=vr(m,aoe);const w=y({isValid:n});return Xe({},C,{label:C.label,onClick:()=>{o(w,{changeImportance:r,shortcut:C,source:"view"})},disabled:!n(w)})});return d.jsx(soe,Xe({dense:!0,sx:[{maxHeight:kk,maxWidth:200,overflow:"auto"},...Array.isArray(a.sx)?a.sx:[a.sx]]},a,{children:f.map(m=>d.jsx(tU,{children:d.jsx(Sa,Xe({},m))},m.id??m.label))}))}const loe=["ownerState"];function coe(t){return t.view!==null}const uoe=(t,e)=>{const{pickerOrientation:r}=e;return pn({root:["root",r==="landscape"&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},eO,t)},doe=t=>{const{ownerState:e,defaultActionBarActions:r}=Ws(),{view:a}=Cg(),o=Pi(),{children:n,slots:f,slotProps:m,classes:y}=t,C=E.useMemo(()=>Xe({},e,{layoutDirection:o?"rtl":"ltr",hasShortcuts:!1}),[e,o]),w=uoe(y,C),A=f?.actionBar??noe,R=no({elementType:A,externalSlotProps:m?.actionBar,additionalProps:{actions:r},className:w.actionBar,ownerState:C}),I=vr(R,loe),M=d.jsx(A,Xe({},I)),F=f?.toolbar,O=no({elementType:F,externalSlotProps:m?.toolbar,className:w.toolbar,ownerState:C}),j=coe(O)&&F?d.jsx(F,Xe({},O)):null,U=n,H=f?.tabs,K=a&&H?d.jsx(H,Xe({className:w.tabs},m?.tabs)):null,W=f?.shortcuts??ioe,X=no({elementType:W,externalSlotProps:m?.shortcuts,className:w.shortcuts,ownerState:C}),ee=Array.isArray(X?.items)&&X.items.length>0,ie=a&&W?d.jsx(W,Xe({},X)):null;return{toolbar:j,content:U,tabs:K,actionBar:M,shortcuts:ie,ownerState:Xe({},C,{hasShortcuts:ee})}},foe=(t,e)=>{const{pickerOrientation:r}=e;return pn({root:["root",r==="landscape"&&"landscape"],contentWrapper:["contentWrapper"]},eO,t)},hoe=nt("div",{name:"MuiPickersLayout",slot:"Root"})({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${Xh.actionBar}`]:{gridColumn:"1 / 4",gridRow:3},variants:[{props:{pickerOrientation:"landscape",hasShortcuts:!1},style:{[`& .${Xh.toolbar}`]:{gridColumn:1,gridRow:"1 / 3"}}},{props:{pickerOrientation:"landscape",hasShortcuts:!0},style:{[`& .${Xh.toolbar}`]:{gridColumn:"2 / 4",gridRow:1,maxWidth:"max-content"},[`& .${Xh.shortcuts}`]:{gridColumn:1,gridRow:2}}},{props:{pickerOrientation:"portrait"},style:{[`& .${Xh.toolbar}`]:{gridColumn:"2 / 4",gridRow:1},[`& .${Xh.shortcuts}`]:{gridColumn:1,gridRow:"2 / 3"}}},{props:{hasShortcuts:!0,layoutDirection:"rtl"},style:{[`& .${Xh.shortcuts}`]:{gridColumn:4}}}]}),poe=nt("div",{name:"MuiPickersLayout",slot:"ContentWrapper"})({gridColumn:"2 / 4",gridRow:2,display:"flex",flexDirection:"column"}),tO=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersLayout"}),{toolbar:o,content:n,tabs:f,actionBar:m,shortcuts:y,ownerState:C}=doe(a),{orientation:w,variant:A}=Cg(),{sx:R,className:I,classes:M}=a,F=foe(M,C);return d.jsxs(hoe,{ref:r,sx:R,className:Ht(F.root,I),ownerState:C,children:[w==="landscape"?y:o,w==="landscape"?o:y,d.jsx(poe,{className:F.contentWrapper,ownerState:C,children:A==="desktop"?d.jsxs(E.Fragment,{children:[n,f]}):d.jsxs(E.Fragment,{children:[f,n]})}),m]})});function nO(t){const{steps:e}=t;return qre({steps:e,isViewMatchingStep:(r,a)=>a.views==null||a.views.includes(r),onStepChange:({step:r,defaultView:a,setView:o,view:n,views:f})=>{const m=r.views==null?a:r.views.find(y=>f.includes(y));m!==n&&o(m)}})}const moe=["props","steps"],goe=["ownerState"],yoe=t=>{let{props:e,steps:r}=t,a=vr(t,moe);const{slots:o,slotProps:n,label:f,inputRef:m,localeText:y}=e,C=nO({steps:r}),{providerProps:w,renderCurrentView:A,ownerState:R}=Z_(Xe({},a,{props:e,localeText:y,autoFocusView:!0,viewContainerRole:"dialog",variant:"desktop",getStepNavigation:C})),I=w.privateContextValue.labelId,M=n?.toolbar?.hidden??!1,F=o.field,O=no({elementType:F,externalSlotProps:n?.field,additionalProps:Xe({},M&&{id:I}),ownerState:R}),j=vr(O,goe),U=o.layout??tO;let H=I;M&&(f?H=`${I}-label`:H=void 0);const K=Xe({},n,{toolbar:Xe({},n?.toolbar,{titleId:I}),popper:Xe({"aria-labelledby":H},n?.popper)});return{renderPicker:()=>d.jsxs(U_,Xe({},w,{children:[d.jsx(F,Xe({},j,{slots:Xe({},o,j.slots),slotProps:Xe({},K,j.slotProps),inputRef:m})),d.jsx(Gre,{slots:o,slotProps:K,children:d.jsx(U,Xe({},K?.layout,{slots:o,slotProps:K,children:A()}))})]}))}},Em=t=>t.saveQuery!=null,rO=({stateResponse:{localizedDigits:t,sectionsValueBoundaries:e,state:r,timezone:a,setCharacterQuery:o,setTempAndroidValueStr:n,updateSectionValue:f}})=>{const m=Jo(),y=({keyPressed:A,sectionIndex:R},I,M)=>{const F=A.toLowerCase(),O=r.sections[R];if(r.characterQuery!=null&&(!M||M(r.characterQuery.value))&&r.characterQuery.sectionIndex===R){const U=`${r.characterQuery.value}${F}`,H=I(U,O);if(!Em(H))return o({sectionIndex:R,value:U,sectionType:O.type}),H}const j=I(F,O);return Em(j)&&!j.saveQuery?(o(null),null):(o({sectionIndex:R,value:F,sectionType:O.type}),Em(j)?null:j)},C=A=>{const R=(F,O,j)=>{const U=O.filter(H=>H.toLowerCase().startsWith(j));return U.length===0?{saveQuery:!1}:{sectionValue:U[0],shouldGoToNextSection:U.length===1}},I=(F,O,j,U)=>{const H=K=>__(m,a,O.type,K);if(O.contentType==="letter")return R(O.format,H(O.format),F);if(j&&U!=null&&M_(m,j).contentType==="letter"){const K=H(j),W=R(j,K,F);return Em(W)?{saveQuery:!1}:Xe({},W,{sectionValue:U(W.sectionValue,K)})}return{saveQuery:!1}};return y(A,(F,O)=>{switch(O.type){case"month":{const j=U=>_R(m,U,m.formats.month,O.format);return I(F,O,m.formats.month,j)}case"weekDay":{const j=(U,H)=>H.indexOf(U).toString();return I(F,O,m.formats.weekday,j)}case"meridiem":return I(F,O);default:return{saveQuery:!1}}})},w=A=>{const R=({queryValue:M,skipIfBelowMinimum:F,section:O})=>{const j=kp(M,t),U=Number(j),H=e[O.type]({currentDate:null,format:O.format,contentType:O.contentType});if(U>H.maximum)return{saveQuery:!1};if(F&&U<H.minimum)return{saveQuery:!0};const K=U*10>H.maximum||j.length===H.maximum.toString().length;return{sectionValue:O_(m,U,H,t,O),shouldGoToNextSection:K}};return y(A,(M,F)=>{if(F.contentType==="digit"||F.contentType==="digit-with-letter")return R({queryValue:M,skipIfBelowMinimum:!1,section:F});if(F.type==="month"){F_(m,"digit","month","MM");const O=R({queryValue:M,skipIfBelowMinimum:!0,section:{type:F.type,format:"MM",hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2}});if(Em(O))return O;const j=_R(m,O.sectionValue,"MM",F.format);return Xe({},O,{sectionValue:j})}if(F.type==="weekDay"){const O=R({queryValue:M,skipIfBelowMinimum:!0,section:F});if(Em(O))return O;const j=bS(m,F.format)[Number(O.sectionValue)-1];return Xe({},O,{sectionValue:j})}return{saveQuery:!1}},M=>MR(M,t))};return yn(A=>{const R=r.sections[A.sectionIndex],M=MR(A.keyPressed,t)?w(Xe({},A,{keyPressed:Ck(A.keyPressed,t)})):C(A);if(M==null){n(null);return}f({section:R,newSectionValue:M.sectionValue,shouldGoToNextSection:M.shouldGoToNextSection})})},boe=5e3,oO=t=>{const e=Jo(),r=Kf(),a=Pi(),{manager:{validator:o,valueType:n,internal_valueManager:f,internal_fieldValueManager:m},internalPropsWithDefaults:y,internalPropsWithDefaults:{value:C,defaultValue:w,referenceDate:A,onChange:R,format:I,formatDensity:M="dense",selectedSections:F,onSelectedSectionsChange:O,shouldRespectLeadingZeros:j=!1,timezone:U,enableAccessibleFieldDOMStructure:H=!0},forwardedProps:{error:K}}=t,{value:W,handleValueChange:X,timezone:ee}=Bb({name:"a field component",timezone:U,value:C,defaultValue:w,referenceDate:A,onChange:R,valueManager:f}),ie=E.useRef(W);E.useEffect(()=>{ie.current=W},[W]);const{hasValidationError:de}=K_({props:y,validator:o,timezone:ee,value:W,onError:y.onError}),le=E.useMemo(()=>qne(e),[e]),oe=E.useMemo(()=>ere(e,le,ee),[e,le,ee]),N=E.useCallback(Ae=>m.getSectionsFromValue(Ae,te=>NR({adapter:e,localeText:r,localizedDigits:le,format:I,date:te,formatDensity:M,shouldRespectLeadingZeros:j,enableAccessibleFieldDOMStructure:H,isRtl:a})),[m,I,r,le,a,j,e,M,H]),[ce,ne]=E.useState(()=>{const Ae=N(W),te={sections:Ae,lastExternalValue:W,lastSectionsDependencies:{format:I,isRtl:a,locale:e.locale},tempValueStrAndroid:null,characterQuery:null},pe=Gne(Ae),J=f.getInitialReferenceValue({referenceDate:A,value:W,adapter:e,props:y,granularity:pe,timezone:ee});return Xe({},te,{referenceValue:J})}),[Se,se]=Ki({controlled:F,default:null,name:"useField",state:"selectedSections"}),ye=Ae=>{se(Ae),O?.(Ae)},ze=E.useMemo(()=>HT(Se,ce.sections),[Se,ce.sections]),Re=ze==="all"?0:ze,ve=E.useMemo(()=>rre(ce.sections,a&&!H),[ce.sections,a,H]),V=E.useMemo(()=>ce.sections.every(Ae=>Ae.value===""),[ce.sections]),ue=E.useMemo(()=>{if(Re!=null)return!1;const Ae=ce.sections.filter(te=>te.value!=="");return Ae.length>0&&ce.sections.length-Ae.length>0},[ce.sections,Re]),Ee=E.useMemo(()=>K!==void 0?K:de||ue,[de,ue,K]),Ie=Ae=>{const te={validationError:o({adapter:e,value:Ae,timezone:ee,props:y})};X(Ae,te)},ae=(Ae,te)=>{const pe=[...ce.sections];return pe[Ae]=Xe({},pe[Ae],{value:te,modified:!0}),pe},be=E.useRef(null),Te=xl(),tt=Ae=>{Re!=null&&(be.current={sectionIndex:Re,value:Ae},Te.start(0,()=>{be.current=null}))},je=()=>{f.areValuesEqual(e,W,f.emptyValue)?ne(Ae=>Xe({},Ae,{sections:Ae.sections.map(te=>Xe({},te,{value:""})),tempValueStrAndroid:null,characterQuery:null})):(ne(Ae=>Xe({},Ae,{characterQuery:null})),Ie(f.emptyValue))},Pe=()=>{if(Re==null)return;const Ae=ce.sections[Re];Ae.value!==""&&(tt(""),m.getDateFromSection(W,Ae)===null?ne(te=>Xe({},te,{sections:ae(Re,""),tempValueStrAndroid:null,characterQuery:null})):(ne(te=>Xe({},te,{characterQuery:null})),Ie(m.updateDateInValue(W,Ae,null))))},Be=Ae=>{const te=(J,fe)=>{const xe=e.parse(J,I);if(!e.isValid(xe))return null;const Ne=NR({adapter:e,localeText:r,localizedDigits:le,format:I,date:xe,formatDensity:M,shouldRespectLeadingZeros:j,enableAccessibleFieldDOMStructure:H,isRtl:a});return FR(e,xe,Ne,fe,!1)},pe=m.parseValueStr(Ae,ce.referenceValue,te);Ie(pe)},Fe=xl(),Ge=({section:Ae,newSectionValue:te,shouldGoToNextSection:pe})=>{Te.clear(),Fe.clear();const J=m.getDateFromSection(W,Ae);pe&&Re<ce.sections.length-1&&ye(Re+1);const fe=ae(Re,te),xe=m.getDateSectionsFromValue(fe,Ae),Ne=Xne(e,xe,le);if(e.isValid(Ne)){const Me=FR(e,Ne,xe,m.getDateFromSection(ce.referenceValue,Ae),!0);return J==null&&Fe.start(0,()=>{ie.current===W&&ne(Ve=>Xe({},Ve,{sections:m.clearDateSections(ce.sections,Ae),tempValueStrAndroid:null}))}),Ie(m.updateDateInValue(W,Ae,Me))}return xe.every(Me=>Me.value!=="")&&(J==null||e.isValid(J))?(tt(te),Ie(m.updateDateInValue(W,Ae,Ne))):(J!=null&&(tt(te),Ie(m.updateDateInValue(W,Ae,Ne))),ne(Me=>Xe({},Me,{sections:fe,tempValueStrAndroid:null})))},Oe=Ae=>ne(te=>Xe({},te,{tempValueStrAndroid:Ae})),mt=yn(Ae=>{ne(te=>Xe({},te,{characterQuery:Ae}))});if(W!==ce.lastExternalValue){const Ae=be.current!=null&&!e.isValid(m.getDateFromSection(W,ce.sections[be.current.sectionIndex]));let te;Ae?te=ae(be.current.sectionIndex,be.current.value):te=N(W),ne(pe=>Xe({},pe,{lastExternalValue:W,sections:te,sectionsDependencies:{format:I,isRtl:a,locale:e.locale},referenceValue:Ae?pe.referenceValue:m.updateReferenceValue(e,W,pe.referenceValue),tempValueStrAndroid:null}))}if(a!==ce.lastSectionsDependencies.isRtl||I!==ce.lastSectionsDependencies.format||e.locale!==ce.lastSectionsDependencies.locale){const Ae=N(W);ne(te=>Xe({},te,{lastSectionsDependencies:{format:I,isRtl:a,locale:e.locale},sections:Ae,tempValueStrAndroid:null,characterQuery:null}))}ce.characterQuery!=null&&!Ee&&Re==null&&mt(null),ce.characterQuery!=null&&ce.sections[ce.characterQuery.sectionIndex]?.type!==ce.characterQuery.sectionType&&mt(null),E.useEffect(()=>{be.current!=null&&(be.current=null)});const qe=xl();return E.useEffect(()=>(ce.characterQuery!=null&&qe.start(boe,()=>mt(null)),()=>{}),[ce.characterQuery,mt,qe]),E.useEffect(()=>{ce.tempValueStrAndroid!=null&&Re!=null&&Pe()},[ce.sections]),{activeSectionIndex:Re,areAllSectionsEmpty:V,error:Ee,localizedDigits:le,parsedSelectedSections:ze,sectionOrder:ve,sectionsValueBoundaries:oe,state:ce,timezone:ee,value:W,clearValue:je,clearActiveSection:Pe,setCharacterQuery:mt,setSelectedSections:ye,setTempAndroidValueStr:Oe,updateSectionValue:Ge,updateValueFromValueStr:Be,getSectionsFromValue:N}};function aO(t){const{manager:{internal_useApplyDefaultValuesToFieldInternalProps:e},internalProps:r,skipContextFieldRefAssignment:a}=t,o=Ek(),n=L_(),f=ro(r.unstableFieldRef,a?null:n?.fieldRef),m=o?.setValue,y=E.useCallback((w,A)=>m?.(w,{validationError:A.validationError,shouldClose:!1}),[m]),C=E.useMemo(()=>n!=null&&o!=null?Xe({value:o.value,onChange:y,timezone:o.timezone,disabled:o.disabled,readOnly:o.readOnly,autoFocus:o.autoFocus&&!o.open,focused:o.open?!0:void 0,format:o.fieldFormat,formatDensity:n.formatDensity,enableAccessibleFieldDOMStructure:n.enableAccessibleFieldDOMStructure,selectedSections:n.selectedSections,onSelectedSectionsChange:n.onSelectedSectionsChange,unstableFieldRef:f},r):r,[o,n,r,y,f]);return e(C)}function Dk(t){const{focused:e,domGetters:r,stateResponse:{parsedSelectedSections:a,state:o}}=t;if(!r.isReady())return;const n=$a(r.getRoot()).getSelection();if(!n)return;if(a==null){n.rangeCount>0&&n.getRangeAt(0).startContainer instanceof Node&&r.getRoot().contains(n.getRangeAt(0).startContainer)&&n.removeAllRanges(),e&&r.getRoot().blur();return}if(!r.getRoot().contains(Di(r.getRoot())))return;const f=new window.Range;let m;a==="all"?m=r.getRoot():o.sections[a].type==="empty"?m=r.getSectionContainer(a):m=r.getSectionContent(a),f.selectNodeContents(m),m.focus(),n.removeAllRanges(),n.addRange(f)}function sO(t){const e=Jo(),{manager:{internal_fieldValueManager:r},internalPropsWithDefaults:{minutesStep:a,disabled:o,readOnly:n},stateResponse:{state:f,value:m,activeSectionIndex:y,parsedSelectedSections:C,sectionsValueBoundaries:w,localizedDigits:A,timezone:R,sectionOrder:I,clearValue:M,clearActiveSection:F,setSelectedSections:O,updateSectionValue:j}}=t;return yn(U=>{if(!o)switch(!0){case((U.ctrlKey||U.metaKey)&&String.fromCharCode(U.keyCode)==="A"&&!U.shiftKey&&!U.altKey):{U.preventDefault(),O("all");break}case U.key==="ArrowRight":{if(U.preventDefault(),C==null)O(I.startIndex);else if(C==="all")O(I.endIndex);else{const H=I.neighbors[C].rightIndex;H!==null&&O(H)}break}case U.key==="ArrowLeft":{if(U.preventDefault(),C==null)O(I.endIndex);else if(C==="all")O(I.startIndex);else{const H=I.neighbors[C].leftIndex;H!==null&&O(H)}break}case U.key==="Delete":{if(U.preventDefault(),n)break;C==null||C==="all"?M():F();break}case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(U.key):{if(U.preventDefault(),n||y==null)break;C==="all"&&O(y);const H=f.sections[y],K=xoe(e,R,H,U.key,w,A,r.getDateFromSection(m,H),{minutesStep:a});j({section:H,newSectionValue:K,shouldGoToNextSection:!1});break}}})}function voe(t){switch(t){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}}function xoe(t,e,r,a,o,n,f,m){const y=voe(a),C=a==="Home",w=a==="End",A=r.value===""||C||w,R=()=>{const M=o[r.type]({currentDate:f,format:r.format,contentType:r.contentType}),F=U=>O_(t,U,M,n,r),O=r.type==="minutes"&&m?.minutesStep?m.minutesStep:1;let j;if(A){if(r.type==="year"&&!w&&!C)return t.formatByString(t.date(void 0,e),r.format);y>0||C?j=M.minimum:j=M.maximum}else j=parseInt(kp(r.value,n),10)+y*O;return j%O!==0&&((y<0||C)&&(j+=O-(O+j)%O),(y>0||w)&&(j-=j%O)),j>M.maximum?F(M.minimum+(j-M.maximum-1)%(M.maximum-M.minimum+1)):j<M.minimum?F(M.maximum-(M.minimum-j-1)%(M.maximum-M.minimum+1)):F(j)},I=()=>{const M=__(t,e,r.type,r.format);if(M.length===0)return r.value;if(A)return y>0||C?M[0]:M[M.length-1];const j=((M.indexOf(r.value)+y)%M.length+M.length)%M.length;return M[j]};return r.contentType==="digit"||r.contentType==="digit-with-letter"?R():I()}function Coe(t){const{manager:e,focused:r,setFocused:a,domGetters:o,stateResponse:n,applyCharacterEditing:f,internalPropsWithDefaults:m,stateResponse:{parsedSelectedSections:y,sectionOrder:C,state:w,clearValue:A,setCharacterQuery:R,setSelectedSections:I,updateValueFromValueStr:M},internalPropsWithDefaults:{disabled:F=!1,readOnly:O=!1}}=t,j=sO({manager:e,internalPropsWithDefaults:m,stateResponse:n}),U=xl(),H=yn(ie=>{F||!o.isReady()||(a(!0),y==="all"?U.start(0,()=>{const de=document.getSelection().getRangeAt(0).startOffset;if(de===0){I(C.startIndex);return}let le=0,oe=0;for(;oe<de&&le<w.sections.length;){const N=w.sections[le];le+=1,oe+=`${N.startSeparator}${N.value||N.placeholder}${N.endSeparator}`.length}I(le-1)}):r?o.getRoot().contains(ie.target)||I(C.startIndex):(a(!0),I(C.startIndex)))}),K=yn(ie=>{if(!o.isReady()||y!=="all")return;const le=ie.target.textContent??"";o.getRoot().innerHTML=w.sections.map(oe=>`${oe.startSeparator}${oe.value||oe.placeholder}${oe.endSeparator}`).join(""),Dk({focused:r,domGetters:o,stateResponse:n}),le.length===0||le.charCodeAt(0)===10?(A(),I("all")):le.length>1?M(le):(y==="all"&&I(0),f({keyPressed:le,sectionIndex:0}))}),W=yn(ie=>{if(O||y!=="all"){ie.preventDefault();return}const de=ie.clipboardData.getData("text");ie.preventDefault(),R(null),M(de)}),X=yn(()=>{if(r||F||!o.isReady())return;const ie=Di(o.getRoot());a(!0),o.getSectionIndexFromDOMElement(ie)!=null||I(C.startIndex)}),ee=yn(()=>{setTimeout(()=>{if(!o.isReady())return;const ie=Di(o.getRoot());!o.getRoot().contains(ie)&&(a(!1),I(null))})});return{onKeyDown:j,onBlur:ee,onFocus:X,onClick:H,onPaste:W,onInput:K,contentEditable:y==="all",tabIndex:m.disabled||y===0?-1:0}}function Soe(t){const{manager:{internal_fieldValueManager:e},stateResponse:{areAllSectionsEmpty:r,state:a,updateValueFromValueStr:o}}=t,n=yn(m=>{o(m.target.value)});return{value:E.useMemo(()=>r?"":e.getV7HiddenInputValueFromSections(a.sections),[r,a.sections,e]),onChange:n}}function woe(t){const{stateResponse:{setSelectedSections:e},internalPropsWithDefaults:{disabled:r=!1}}=t,a=E.useCallback(o=>n=>{r||n.isDefaultPrevented()||e(o)},[r,e]);return E.useCallback(o=>({"data-sectionindex":o,onClick:a(o)}),[a])}function Toe(t){const e=Jo(),r=Kf(),{focused:a,domGetters:o,stateResponse:n,applyCharacterEditing:f,manager:{internal_fieldValueManager:m},stateResponse:{parsedSelectedSections:y,sectionsValueBoundaries:C,state:w,value:A,clearActiveSection:R,setCharacterQuery:I,setSelectedSections:M,updateSectionValue:F,updateValueFromValueStr:O},internalPropsWithDefaults:{disabled:j=!1,readOnly:U=!1}}=t,H=y==="all",K=!H&&!j&&!U,W=yn(oe=>{if(!o.isReady())return;const N=w.sections[oe];o.getSectionContent(oe).innerHTML=N.value||N.placeholder,Dk({focused:a,domGetters:o,stateResponse:n})}),X=yn(oe=>{if(!o.isReady())return;const N=oe.target,ce=N.textContent??"",ne=o.getSectionIndexFromDOMElement(N),Se=w.sections[ne];if(U){W(ne);return}if(ce.length===0){if(Se.value===""){W(ne);return}const se=oe.nativeEvent.inputType;if(se==="insertParagraph"||se==="insertLineBreak"){W(ne);return}W(ne),R();return}f({keyPressed:ce,sectionIndex:ne}),W(ne)}),ee=yn(oe=>{oe.preventDefault()}),ie=yn(oe=>{if(oe.preventDefault(),U||j||typeof y!="number")return;const N=w.sections[y],ce=oe.clipboardData.getData("text"),ne=/^[a-zA-Z]+$/.test(ce),Se=/^[0-9]+$/.test(ce),se=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(ce);N.contentType==="letter"&&ne||N.contentType==="digit"&&Se||N.contentType==="digit-with-letter"&&se?(I(null),F({section:N,newSectionValue:ce,shouldGoToNextSection:!0})):!ne&&!Se&&(I(null),O(ce))}),de=yn(oe=>{oe.preventDefault(),oe.dataTransfer.dropEffect="none"}),le=E.useCallback(oe=>()=>{j||M(oe)},[j,M]);return E.useCallback((oe,N)=>{const ce=C[oe.type]({currentDate:m.getDateFromSection(A,oe),contentType:oe.contentType,format:oe.format});return{onInput:X,onPaste:ie,onMouseUp:ee,onDragOver:de,onFocus:le(N),"aria-readonly":U,"aria-valuenow":Eoe(oe,e),"aria-valuemin":ce.minimum,"aria-valuemax":ce.maximum,"aria-valuetext":oe.value?Aoe(oe,e):r.empty,"aria-label":r[oe.type],"aria-disabled":j,tabIndex:!K||H||N>0?-1:0,contentEditable:!H&&!j&&!U,role:"spinbutton","data-range-position":oe.dateName||void 0,spellCheck:K?!1:void 0,autoCapitalize:K?"none":void 0,autoCorrect:K?"off":void 0,children:oe.value||oe.placeholder,inputMode:oe.contentType==="letter"?"text":"numeric"}},[C,H,j,U,K,r,e,X,ie,ee,de,le,m,A])}function Aoe(t,e){if(t.value)switch(t.type){case"month":{if(t.contentType==="digit"){const a=e.setMonth(e.date(),Number(t.value)-1);return e.isValid(a)?e.format(a,"month"):""}const r=e.parse(t.value,t.format);return r&&e.isValid(r)?e.format(r,"month"):void 0}case"day":if(t.contentType==="digit"){const r=e.setDate(e.startOfYear(e.date()),Number(t.value));return e.isValid(r)?e.format(r,"dayOfMonthFull"):""}return t.value;case"weekDay":return;default:return}}function Eoe(t,e){if(t.value)switch(t.type){case"weekDay":return t.contentType==="letter"?void 0:Number(t.value);case"meridiem":{const r=e.parse(`01:00 ${t.value}`,`${e.formats.hours12h}:${e.formats.minutes} ${t.format}`);return r?e.getHours(r)>=12?1:0:void 0}case"day":return t.contentType==="digit-with-letter"?parseInt(t.value,10):Number(t.value);case"month":{if(t.contentType==="digit")return Number(t.value);const r=e.parse(t.value,t.format);return r?e.getMonth(r)+1:void 0}default:return t.contentType!=="letter"?Number(t.value):void 0}}const koe=t=>{const{props:e,manager:r,skipContextFieldRefAssignment:a,manager:{valueType:o,internal_useOpenPickerButtonAriaLabel:n}}=t,{internalProps:f,forwardedProps:m}=G_(e,o),y=aO({manager:r,internalProps:f,skipContextFieldRefAssignment:a}),{sectionListRef:C,onBlur:w,onClick:A,onFocus:R,onInput:I,onPaste:M,onKeyDown:F,onClear:O,clearable:j}=m,{disabled:U=!1,readOnly:H=!1,autoFocus:K=!1,focused:W,unstableFieldRef:X}=y,ee=E.useRef(null),ie=ro(C,ee),de=E.useMemo(()=>({isReady:()=>ee.current!=null,getRoot:()=>ee.current.getRoot(),getSectionContainer:qe=>ee.current.getSectionContainer(qe),getSectionContent:qe=>ee.current.getSectionContent(qe),getSectionIndexFromDOMElement:qe=>ee.current.getSectionIndexFromDOMElement(qe)}),[ee]),le=oO({manager:r,internalPropsWithDefaults:y,forwardedProps:m}),{areAllSectionsEmpty:oe,error:N,parsedSelectedSections:ce,sectionOrder:ne,state:Se,value:se,clearValue:ye,setSelectedSections:ze}=le,Re=rO({stateResponse:le}),ve=n(se),[V,ue]=E.useState(!1);function Ee(qe=0){if(U||!ee.current||zR(ee)!=null)return;const Ae=HT(qe,Se.sections);ue(!0),ee.current.getSectionContent(Ae).focus()}const Ie=Coe({manager:r,internalPropsWithDefaults:y,stateResponse:le,applyCharacterEditing:Re,focused:V,setFocused:ue,domGetters:de}),ae=Soe({manager:r,stateResponse:le}),be=woe({stateResponse:le,internalPropsWithDefaults:y}),Te=Toe({manager:r,stateResponse:le,applyCharacterEditing:Re,internalPropsWithDefaults:y,domGetters:de,focused:V}),tt=yn(qe=>{F?.(qe),Ie.onKeyDown(qe)}),je=yn(qe=>{w?.(qe),Ie.onBlur(qe)}),Pe=yn(qe=>{R?.(qe),Ie.onFocus(qe)}),Be=yn(qe=>{qe.isDefaultPrevented()||(A?.(qe),Ie.onClick(qe))}),Fe=yn(qe=>{M?.(qe),Ie.onPaste(qe)}),Ge=yn(qe=>{I?.(qe),Ie.onInput(qe)}),Oe=yn((qe,...Ae)=>{qe.preventDefault(),O?.(qe,...Ae),ye(),UR(ee)?ze(ne.startIndex):Ee(0)}),mt=E.useMemo(()=>Se.sections.map((qe,Ae)=>{const te=Te(qe,Ae);return{container:be(Ae),content:Te(qe,Ae),before:{children:qe.startSeparator},after:{children:qe.endSeparator,"data-range-position":qe.isEndFormatSeparator?te["data-range-position"]:void 0}}}),[Se.sections,be,Te]);return E.useEffect(()=>{if(ee.current==null)throw new Error(["MUI X: The `sectionListRef` prop has not been initialized by `PickersSectionList`","You probably tried to pass a component to the `textField` slot that contains an `<input />` element instead of a `PickersSectionList`.","","If you want to keep using an `<input />` HTML element for the editing, please add the `enableAccessibleFieldDOMStructure={false}` prop to your Picker or Field component:","","<DatePicker enableAccessibleFieldDOMStructure={false} slots={{ textField: MyCustomTextField }} />","","Learn more about the field accessible DOM structure on the MUI documentation: https://mui.com/x/react-date-pickers/fields/#fields-to-edit-a-single-element"].join(`
`));K&&!U&&ee.current&&ee.current.getSectionContent(ne.startIndex).focus()},[]),ka(()=>{if(!(!V||!ee.current)){if(ce==="all")ee.current.getRoot().focus();else if(typeof ce=="number"){const qe=ee.current.getSectionContent(ce);qe&&qe.focus()}}},[ce,V]),ka(()=>{Dk({focused:V,domGetters:de,stateResponse:le})}),E.useImperativeHandle(X,()=>({getSections:()=>Se.sections,getActiveSectionIndex:()=>zR(ee),setSelectedSections:qe=>{if(U||!ee.current)return;const Ae=HT(qe,Se.sections);ue((Ae==="all"?0:Ae)!==null),ze(qe)},focusField:Ee,isFieldFocused:()=>UR(ee)})),Xe({},m,Ie,{onBlur:je,onClick:Be,onFocus:Pe,onInput:Ge,onPaste:Fe,onKeyDown:tt,onClear:Oe},ae,{error:N,clearable:!!(j&&!oe&&!H&&!U),focused:W??V,sectionListRef:ie,enableAccessibleFieldDOMStructure:!0,elements:mt,areAllSectionsEmpty:oe,disabled:U,readOnly:H,autoFocus:K,openPickerAriaLabel:ve})};function zR(t){const e=Di(t.current?.getRoot());return!e||!t.current||!t.current.getRoot().contains(e)?null:t.current.getSectionIndexFromDOMElement(e)}function UR(t){const e=Di(t.current?.getRoot());return!!t.current&&t.current.getRoot().contains(e)}const _m=t=>t.replace(/[\u2066\u2067\u2068\u2069]/g,""),Doe=(t,e,r)=>{let a=0,o=r?1:0;const n=[];for(let f=0;f<t.length;f+=1){const m=t[f],y=wk(m,r?"input-rtl":"input-ltr",e),C=`${m.startSeparator}${y}${m.endSeparator}`,w=_m(C).length,A=C.length,R=_m(y),I=o+(R===""?0:y.indexOf(R[0]))+m.startSeparator.length,M=I+R.length;n.push(Xe({},m,{start:a,end:a+w,startInInput:I,endInInput:M})),a+=w,o+=A}return n},Roe=t=>{const e=Pi(),r=xl(),a=xl(),{props:o,manager:n,skipContextFieldRefAssignment:f,manager:{valueType:m,internal_valueManager:y,internal_fieldValueManager:C,internal_useOpenPickerButtonAriaLabel:w}}=t,{internalProps:A,forwardedProps:R}=G_(o,m),I=aO({manager:n,internalProps:A,skipContextFieldRefAssignment:f}),{onFocus:M,onClick:F,onPaste:O,onBlur:j,onKeyDown:U,onClear:H,clearable:K,inputRef:W,placeholder:X}=R,{readOnly:ee=!1,disabled:ie=!1,autoFocus:de=!1,focused:le,unstableFieldRef:oe}=I,N=E.useRef(null),ce=ro(W,N),ne=oO({manager:n,internalPropsWithDefaults:I,forwardedProps:R}),{activeSectionIndex:Se,areAllSectionsEmpty:se,error:ye,localizedDigits:ze,parsedSelectedSections:Re,sectionOrder:ve,state:V,value:ue,clearValue:Ee,clearActiveSection:Ie,setCharacterQuery:ae,setSelectedSections:be,setTempAndroidValueStr:Te,updateSectionValue:tt,updateValueFromValueStr:je,getSectionsFromValue:Pe}=ne,Be=rO({stateResponse:ne}),Fe=w(ue),Ge=E.useMemo(()=>Doe(V.sections,ze,e),[V.sections,ze,e]);function Oe(){const it=N.current.selectionStart??0;let xt;it<=Ge[0].startInInput||it>=Ge[Ge.length-1].endInInput?xt=1:xt=Ge.findIndex(Yt=>Yt.startInInput-Yt.startSeparator.length>it);const pt=xt===-1?Ge.length-1:xt-1;be(pt)}function mt(it=0){Di(N.current)!==N.current&&(N.current?.focus(),be(it))}const qe=yn(it=>{M?.(it);const xt=N.current;r.start(0,()=>{!xt||xt!==N.current||Se==null&&(xt.value.length&&Number(xt.selectionEnd)-Number(xt.selectionStart)===xt.value.length?be("all"):Oe())})}),Ae=yn((it,...xt)=>{it.isDefaultPrevented()||(F?.(it,...xt),Oe())}),te=yn(it=>{if(O?.(it),it.preventDefault(),ee||ie)return;const xt=it.clipboardData.getData("text");if(typeof Re=="number"){const pt=V.sections[Re],Yt=/^[a-zA-Z]+$/.test(xt),Kt=/^[0-9]+$/.test(xt),tn=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(xt);if(pt.contentType==="letter"&&Yt||pt.contentType==="digit"&&Kt||pt.contentType==="digit-with-letter"&&tn){ae(null),tt({section:pt,newSectionValue:xt,shouldGoToNextSection:!0});return}if(Yt||Kt)return}ae(null),je(xt)}),pe=yn(it=>{j?.(it),be(null)}),J=yn(it=>{if(ee)return;const xt=it.target.value;if(xt===""){Ee();return}const pt=it.nativeEvent.data,Yt=pt&&pt.length>1,Kt=Yt?pt:xt,tn=_m(Kt);if(Re==="all"&&be(Se),Se==null||Yt){je(Yt?pt:tn);return}let Wt;if(Re==="all"&&tn.length===1)Wt=tn;else{const _t=_m(C.getV6InputValueFromSections(Ge,ze,e));let at=-1,Et=-1;for(let Zt=0;Zt<_t.length;Zt+=1)at===-1&&_t[Zt]!==tn[Zt]&&(at=Zt),Et===-1&&_t[_t.length-Zt-1]!==tn[tn.length-Zt-1]&&(Et=Zt);const qt=Ge[Se];if(at<qt.start||_t.length-Et-1>qt.end)return;const Sn=tn.length-_t.length+qt.end-_m(qt.endSeparator||"").length;Wt=tn.slice(qt.start+_m(qt.startSeparator||"").length,Sn)}if(Wt.length===0){nre()&&Te(Kt),Ie();return}Be({keyPressed:Wt,sectionIndex:Se})}),fe=yn((it,...xt)=>{it.preventDefault(),H?.(it,...xt),Ee(),$R(N)?be(ve.startIndex):mt(0)}),xe=sO({manager:n,internalPropsWithDefaults:I,stateResponse:ne}),Ne=yn(it=>{U?.(it),xe(it)}),Me=E.useMemo(()=>X!==void 0?X:C.getV6InputValueFromSections(Pe(y.emptyValue),ze,e),[X,C,Pe,y.emptyValue,ze,e]),Ve=E.useMemo(()=>V.tempValueStrAndroid??C.getV6InputValueFromSections(V.sections,ze,e),[V.sections,C,V.tempValueStrAndroid,ze,e]);E.useEffect(()=>{N.current&&N.current===Di(N.current)&&be("all")},[]),ka(()=>{function it(){if(!N.current)return;if(Re==null){N.current.scrollLeft&&(N.current.scrollLeft=0);return}if(N.current!==Di(N.current))return;const xt=N.current.scrollTop;if(Re==="all")N.current.select();else{const pt=Ge[Re],Yt=pt.type==="empty"?pt.startInInput-pt.startSeparator.length:pt.startInInput,Kt=pt.type==="empty"?pt.endInInput+pt.endSeparator.length:pt.endInInput;(Yt!==N.current.selectionStart||Kt!==N.current.selectionEnd)&&N.current===Di(N.current)&&N.current.setSelectionRange(Yt,Kt),a.start(0,()=>{N.current&&N.current===Di(N.current)&&N.current.selectionStart===N.current.selectionEnd&&(N.current.selectionStart!==Yt||N.current.selectionEnd!==Kt)&&it()})}N.current.scrollTop=xt}it()});const Qe=E.useMemo(()=>Se==null||V.sections[Se].contentType==="letter"?"text":"numeric",[Se,V.sections]),st=!(N.current&&N.current===Di(N.current))&&se;return E.useImperativeHandle(oe,()=>({getSections:()=>V.sections,getActiveSectionIndex:()=>{const it=N.current.selectionStart??0,xt=N.current.selectionEnd??0;if(it===0&&xt===0)return null;const pt=it<=Ge[0].startInInput?1:Ge.findIndex(Yt=>Yt.startInInput-Yt.startSeparator.length>it);return pt===-1?Ge.length-1:pt-1},setSelectedSections:it=>be(it),focusField:mt,isFieldFocused:()=>$R(N)})),Xe({},R,{error:ye,"aria-invalid":ye,clearable:!!(K&&!se&&!ee&&!ie),onBlur:pe,onClick:Ae,onFocus:qe,onPaste:te,onKeyDown:Ne,onClear:fe,inputRef:ce,enableAccessibleFieldDOMStructure:!1,placeholder:Me,inputMode:Qe,autoComplete:"off",value:st?"":Ve,onChange:J,focused:le,disabled:ie,readOnly:ee,autoFocus:de,openPickerAriaLabel:Fe})};function $R(t){return t.current===Di(t.current)}const Ioe=t=>{const e=L_();return(t.props.enableAccessibleFieldDOMStructure??e?.enableAccessibleFieldDOMStructure??!0?koe:Roe)(t)},Poe=t=>{const e=Mre(t);return Ioe({manager:e,props:t})};function Rk(t){const{ownerState:e}=Ws(),r=Pi();return E.useMemo(()=>Xe({},e,{isFieldDisabled:t.disabled??!1,isFieldReadOnly:t.readOnly??!1,isFieldRequired:t.required??!1,fieldDirection:r?"rtl":"ltr"}),[e,t.disabled,t.readOnly,t.required,r])}const Moe=dr(d.jsx("path",{d:"M7 10l5 5 5-5z"})),_oe=dr(d.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"})),Ooe=dr(d.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})),Foe=dr(d.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}));dr(d.jsxs(E.Fragment,{children:[d.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),d.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}));dr(d.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}));dr(d.jsxs(E.Fragment,{children:[d.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),d.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}));const Noe=dr(d.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}));function joe(t){return Cn("MuiPickersTextField",t)}bn("MuiPickersTextField",["root","focused","disabled","error","required"]);function Loe(t){return Cn("MuiPickersInputBase",t)}const Wm=bn("MuiPickersInputBase",["root","focused","disabled","error","notchedOutline","sectionContent","sectionBefore","sectionAfter","adornedStart","adornedEnd","input","inputSizeSmall","activeBar"]);function Boe(t){return Cn("MuiPickersSectionList",t)}const Im=bn("MuiPickersSectionList",["root","section","sectionContent"]),zoe=["slots","slotProps","elements","sectionListRef","classes"],iO=nt("div",{name:"MuiPickersSectionList",slot:"Root"})({direction:"ltr /*! @noflip */",outline:"none"}),lO=nt("span",{name:"MuiPickersSectionList",slot:"Section"})({}),cO=nt("span",{name:"MuiPickersSectionList",slot:"SectionSeparator"})({whiteSpace:"pre"}),uO=nt("span",{name:"MuiPickersSectionList",slot:"SectionContent"})({outline:"none"}),Uoe=t=>pn({root:["root"],section:["section"],sectionContent:["sectionContent"]},Boe,t);function $oe(t){const{slots:e,slotProps:r,element:a,classes:o}=t,{ownerState:n}=Ws(),f=e?.section??lO,m=no({elementType:f,externalSlotProps:r?.section,externalForwardedProps:a.container,className:o.section,ownerState:n}),y=e?.sectionContent??uO,C=no({elementType:y,externalSlotProps:r?.sectionContent,externalForwardedProps:a.content,additionalProps:{suppressContentEditableWarning:!0},className:o.sectionContent,ownerState:n}),w=e?.sectionSeparator??cO,A=no({elementType:w,externalSlotProps:r?.sectionSeparator,externalForwardedProps:a.before,ownerState:Xe({},n,{separatorPosition:"before"})}),R=no({elementType:w,externalSlotProps:r?.sectionSeparator,externalForwardedProps:a.after,ownerState:Xe({},n,{separatorPosition:"after"})}),I=E.useRef(null),M=ro(C.ref,I),F=O=>{const j=O.relatedTarget,U=O.currentTarget.closest(`.${Im.root}`);if(U&&j instanceof Node&&U.contains(j)){O.stopPropagation();return}};return d.jsxs(f,Xe({},m,{children:[d.jsx(w,Xe({},A)),d.jsx(y,Xe({},C,{ref:M,onBlur:F})),d.jsx(w,Xe({},R))]}))}const Hoe=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersSectionList"}),{slots:o,slotProps:n,elements:f,sectionListRef:m,classes:y}=a,C=vr(a,zoe),w=Uoe(y),{ownerState:A}=Ws(),R=E.useRef(null),I=ro(r,R),M=j=>{if(!R.current)throw new Error(`MUI X: Cannot call sectionListRef.${j} before the mount of the component.`);return R.current};E.useImperativeHandle(m,()=>({getRoot(){return M("getRoot")},getSectionContainer(j){return M("getSectionContainer").querySelector(`.${Im.section}[data-sectionindex="${j}"]`)},getSectionContent(j){return M("getSectionContent").querySelector(`.${Im.section}[data-sectionindex="${j}"] .${Im.sectionContent}`)},getSectionIndexFromDOMElement(j){const U=M("getSectionIndexFromDOMElement");if(j==null||!U.contains(j))return null;let H=null;return j.classList.contains(Im.section)?H=j:j.classList.contains(Im.sectionContent)&&(H=j.parentElement),H==null?null:Number(H.dataset.sectionindex)}}));const F=o?.root??iO,O=no({elementType:F,externalSlotProps:n?.root,externalForwardedProps:C,additionalProps:{ref:I,suppressContentEditableWarning:!0},className:w.root,ownerState:A});return d.jsx(F,Xe({},O,{children:O.contentEditable?f.map(({content:j,before:U,after:H})=>`${U.children}${j.children}${H.children}`).join(""):d.jsx(E.Fragment,{children:f.map((j,U)=>d.jsx($oe,{slots:o,slotProps:n,element:j,classes:w},U))})}))}),dO=E.createContext(null),SS=()=>{const t=E.useContext(dO);if(t==null)throw new Error(["MUI X: The `usePickerTextFieldOwnerState` can only be called in components that are used inside a PickerTextField component"].join(`
`));return t},Woe=["elements","areAllSectionsEmpty","defaultValue","label","value","onChange","id","autoFocus","endAdornment","startAdornment","renderSuffix","slots","slotProps","contentEditable","tabIndex","onInput","onPaste","onKeyDown","fullWidth","name","readOnly","inputProps","inputRef","sectionListRef","onFocus","onBlur","classes","ownerState"],Voe=t=>Math.round(t*1e5)/1e5,wS=nt("div",{name:"MuiPickersInputBase",slot:"Root"})(({theme:t})=>Xe({},t.typography.body1,{color:(t.vars||t).palette.text.primary,cursor:"text",padding:0,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",boxSizing:"border-box",letterSpacing:`${Voe(.15/16)}em`,variants:[{props:{isInputInFullWidth:!0},style:{width:"100%"}}]})),Ik=nt(iO,{name:"MuiPickersInputBase",slot:"SectionsContainer"})(({theme:t})=>({padding:"4px 0 5px",fontFamily:t.typography.fontFamily,fontSize:"inherit",lineHeight:"1.4375em",flexGrow:1,outline:"none",display:"flex",flexWrap:"nowrap",overflow:"hidden",letterSpacing:"inherit",width:"182px",variants:[{props:{fieldDirection:"rtl"},style:{justifyContent:"end"}},{props:{inputSize:"small"},style:{paddingTop:1}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0},style:{color:"currentColor",opacity:0}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0,inputHasLabel:!1},style:t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:t.palette.mode==="light"?.42:.5}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0,inputHasLabel:!0,isLabelShrunk:!0},style:t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:t.palette.mode==="light"?.42:.5}}]})),Goe=nt(lO,{name:"MuiPickersInputBase",slot:"Section"})(({theme:t})=>({fontFamily:t.typography.fontFamily,fontSize:"inherit",letterSpacing:"inherit",lineHeight:"1.4375em",display:"inline-block",whiteSpace:"nowrap"})),Koe=nt(uO,{name:"MuiPickersInputBase",slot:"SectionContent",overridesResolver:(t,e)=>e.content})(({theme:t})=>({fontFamily:t.typography.fontFamily,lineHeight:"1.4375em",letterSpacing:"inherit",width:"fit-content",outline:"none"})),Yoe=nt(cO,{name:"MuiPickersInputBase",slot:"Separator"})(()=>({whiteSpace:"pre",letterSpacing:"inherit"})),qoe=nt("input",{name:"MuiPickersInputBase",slot:"Input",overridesResolver:(t,e)=>e.hiddenInput})(Xe({},XU)),Qoe=nt("div",{name:"MuiPickersInputBase",slot:"ActiveBar"})(({theme:t,ownerState:e})=>({display:"none",position:"absolute",height:2,bottom:2,borderTopLeftRadius:2,borderTopRightRadius:2,transition:t.transitions.create(["width","left"],{duration:t.transitions.duration.shortest}),backgroundColor:(t.vars||t).palette.primary.main,'[data-active-range-position="start"] &, [data-active-range-position="end"] &':{display:"block"},'[data-active-range-position="start"] &':{left:e.sectionOffsets[0]},'[data-active-range-position="end"] &':{left:e.sectionOffsets[1]}})),Xoe=(t,e)=>{const{isFieldFocused:r,isFieldDisabled:a,isFieldReadOnly:o,hasFieldError:n,inputSize:f,isInputInFullWidth:m,inputColor:y,hasStartAdornment:C,hasEndAdornment:w}=e,A={root:["root",r&&!a&&"focused",a&&"disabled",o&&"readOnly",n&&"error",m&&"fullWidth",`color${At(y)}`,f==="small"&&"inputSizeSmall",C&&"adornedStart",w&&"adornedEnd"],notchedOutline:["notchedOutline"],input:["input"],sectionsContainer:["sectionsContainer"],sectionContent:["sectionContent"],sectionBefore:["sectionBefore"],sectionAfter:["sectionAfter"],activeBar:["activeBar"]};return pn(A,Loe,t)};function HR(t,e,r,a){if(t.content.id){const o=e.current?.querySelectorAll(`[data-sectionindex="${r}"] [data-range-position="${a}"]`);if(o)return Array.from(o).reduce((n,f)=>n+f.offsetWidth,0)}return 0}function Joe(t,e){let r=0;if(e.current?.getAttribute("data-active-range-position")==="end")for(let o=t.length-1;o>=t.length/2;o-=1)r+=HR(t[o],e,o,"end");else for(let o=0;o<t.length/2;o+=1)r+=HR(t[o],e,o,"start");return{activeBarWidth:r,sectionOffsets:[e.current?.querySelector('[data-sectionindex="0"]')?.offsetLeft||0,e.current?.querySelector(`[data-sectionindex="${t.length/2}"]`)?.offsetLeft||0]}}const Pk=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersInputBase"}),{elements:o,areAllSectionsEmpty:n,value:f,onChange:m,id:y,endAdornment:C,startAdornment:w,renderSuffix:A,slots:R,slotProps:I,contentEditable:M,tabIndex:F,onInput:O,onPaste:j,onKeyDown:U,name:H,readOnly:K,inputProps:W,inputRef:X,sectionListRef:ee,onFocus:ie,onBlur:de,classes:le,ownerState:oe}=a,N=vr(a,Woe),ce=SS(),ne=E.useRef(null),Se=E.useRef(null),se=E.useRef([]),ye=ro(r,ne),ze=ro(W?.ref,X),Re=Al();if(!Re)throw new Error("MUI X: PickersInputBase should always be used inside a PickersTextField component");const ve=oe??ce,V=Pe=>{Re.onFocus?.(Pe),ie?.(Pe)},ue=Pe=>{V(Pe)},Ee=Pe=>{if(U?.(Pe),Pe.key==="Enter"&&!Pe.defaultMuiPrevented){if(ne.current?.dataset.multiInput)return;const Be=ne.current?.closest("form"),Fe=Be?.querySelector('[type="submit"]');if(!Be||!Fe)return;Pe.preventDefault(),Be.requestSubmit(Fe)}},Ie=Pe=>{Re.onBlur?.(Pe),de?.(Pe)};E.useEffect(()=>{Re&&Re.setAdornedStart(!!w)},[Re,w]),E.useEffect(()=>{Re&&(n?Re.onEmpty():Re.onFilled())},[Re,n]);const ae=Xoe(le,ve),be=R?.root||wS,Te=no({elementType:be,externalSlotProps:I?.root,externalForwardedProps:N,additionalProps:{"aria-invalid":Re.error,ref:ye},className:ae.root,ownerState:ve}),tt=R?.input||Ik,je=o.some(Pe=>Pe.content["data-range-position"]!==void 0);return E.useEffect(()=>{if(!je||!ve.isPickerOpen)return;const{activeBarWidth:Pe,sectionOffsets:Be}=Joe(o,ne);se.current=[Be[0],Be[1]],Se.current&&(Se.current.style.width=`${Pe}px`)},[o,je,ve.isPickerOpen]),d.jsxs(be,Xe({},Te,{children:[w,d.jsx(Hoe,{sectionListRef:ee,elements:o,contentEditable:M,tabIndex:F,className:ae.sectionsContainer,onFocus:V,onBlur:Ie,onInput:O,onPaste:j,onKeyDown:Ee,slots:{root:tt,section:Goe,sectionContent:Koe,sectionSeparator:Yoe},slotProps:{root:Xe({},I?.input,{ownerState:ve}),sectionContent:{className:Wm.sectionContent},sectionSeparator:({separatorPosition:Pe})=>({className:Pe==="before"?Wm.sectionBefore:Wm.sectionAfter})}}),C,A?A(Xe({},Re)):null,d.jsx(qoe,Xe({name:H,className:ae.input,value:f,onChange:m,id:y,"aria-hidden":"true",tabIndex:-1,readOnly:K,required:Re.required,disabled:Re.disabled,onFocus:ue},W,{ref:ze})),je&&d.jsx(Qoe,{className:ae.activeBar,ref:Se,ownerState:{sectionOffsets:se.current}})]}))});function Zoe(t){return Cn("MuiPickersOutlinedInput",t)}const Pc=Xe({},Wm,bn("MuiPickersOutlinedInput",["root","notchedOutline","input"])),eae=["children","className","label","notched","shrink"],tae=nt("fieldset",{name:"MuiPickersOutlinedInput",slot:"NotchedOutline"})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%",borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),WR=nt("span")(({theme:t})=>({fontFamily:t.typography.fontFamily,fontSize:"inherit"})),nae=nt("legend",{shouldForwardProp:t=>Au(t)&&t!=="notched"})(({theme:t})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:{inputHasLabel:!1},style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:{inputHasLabel:!0},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:{inputHasLabel:!0,notched:!0},style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]}));function rae(t){const{className:e,label:r,notched:a}=t,o=vr(t,eae),n=SS();return d.jsx(tae,Xe({"aria-hidden":!0,className:e},o,{ownerState:n,children:d.jsx(nae,{ownerState:n,notched:a,children:r?d.jsx(WR,{children:r}):d.jsx(WR,{className:"notranslate",children:""})})}))}const oae=["label","autoFocus","ownerState","classes","notched"],aae=nt(wS,{name:"MuiPickersOutlinedInput",slot:"Root"})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{padding:"0 14px",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Pc.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Pc.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}},[`&.${Pc.focused} .${Pc.notchedOutline}`]:{borderStyle:"solid",borderWidth:2},[`&.${Pc.disabled}`]:{[`& .${Pc.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled},"*":{color:(t.vars||t).palette.action.disabled}},[`&.${Pc.error} .${Pc.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},variants:Object.keys((t.vars??t).palette).filter(r=>(t.vars??t).palette[r]?.main??!1).map(r=>({props:{inputColor:r},style:{[`&.${Pc.focused}:not(.${Pc.error}) .${Pc.notchedOutline}`]:{borderColor:(t.vars||t).palette[r].main}}}))}}),sae=nt(Ik,{name:"MuiPickersOutlinedInput",slot:"SectionsContainer"})({padding:"16.5px 0",variants:[{props:{inputSize:"small"},style:{padding:"8.5px 0"}}]}),iae=t=>{const r=pn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Zoe,t);return Xe({},t,r)},fO=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersOutlinedInput"}),{label:o,classes:n,notched:f}=a,m=vr(a,oae),y=Al(),C=iae(n);return d.jsx(Pk,Xe({slots:{root:aae,input:sae},renderSuffix:w=>d.jsx(rae,{shrink:!!(f||w.adornedStart||w.focused||w.filled),notched:!!(f||w.adornedStart||w.focused||w.filled),className:C.notchedOutline,label:o!=null&&o!==""&&y?.required?d.jsxs(E.Fragment,{children:[o,"","*"]}):o})},m,{label:o,classes:C,ref:r}))});fO.muiName="Input";function lae(t){return Cn("MuiPickersFilledInput",t)}const Jh=Xe({},Wm,bn("MuiPickersFilledInput",["root","underline","input"])),cae=["label","autoFocus","disableUnderline","hiddenLabel","classes"],uae=nt(wS,{name:"MuiPickersFilledInput",slot:"Root",shouldForwardProp:t=>Au(t)&&t!=="disableUnderline"})(({theme:t})=>{const e=t.palette.mode==="light",r=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",a=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",o=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",n=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:o,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a}},[`&.${Jh.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a},[`&.${Jh.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:n},variants:[...Object.keys((t.vars??t).palette).filter(f=>(t.vars??t).palette[f].main).map(f=>({props:{inputColor:f,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[f]?.main}`}}})),{props:{disableUnderline:!1},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Jh.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Jh.error}`]:{"&:before, &:after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Jh.disabled}, .${Jh.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${Jh.disabled}:before`]:{borderBottomStyle:"dotted"}}},{props:{hasStartAdornment:!0},style:{paddingLeft:12}},{props:{hasEndAdornment:!0},style:{paddingRight:12}}]}}),dae=nt(Ik,{name:"MuiPickersFilledInput",slot:"sectionsContainer",shouldForwardProp:t=>Au(t)&&t!=="hiddenLabel"})({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,variants:[{props:{inputSize:"small"},style:{paddingTop:21,paddingBottom:4}},{props:{hasStartAdornment:!0},style:{paddingLeft:0}},{props:{hasEndAdornment:!0},style:{paddingRight:0}},{props:{hiddenLabel:!0},style:{paddingTop:16,paddingBottom:17}},{props:{hiddenLabel:!0,inputSize:"small"},style:{paddingTop:8,paddingBottom:9}}]}),fae=(t,e)=>{const{inputHasUnderline:r}=e,o=pn({root:["root",r&&"underline"],input:["input"]},lae,t);return Xe({},t,o)},hO=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersFilledInput"}),{label:o,disableUnderline:n=!1,hiddenLabel:f=!1,classes:m}=a,y=vr(a,cae),C=SS(),w=Xe({},C,{inputHasUnderline:!n}),A=fae(m,w);return d.jsx(Pk,Xe({slots:{root:uae,input:dae},slotProps:{root:{disableUnderline:n},input:{hiddenLabel:f}}},y,{label:o,classes:A,ref:r,ownerState:w}))});hO.muiName="Input";function hae(t){return Cn("MuiPickersFilledInput",t)}const Sy=Xe({},Wm,bn("MuiPickersInput",["root","underline","input"])),pae=["label","autoFocus","disableUnderline","ownerState","classes"],mae=nt(wS,{name:"MuiPickersInput",slot:"Root",shouldForwardProp:t=>Au(t)&&t!=="disableUnderline"})(({theme:t})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),{"label + &":{marginTop:16},variants:[...Object.keys((t.vars??t).palette).filter(a=>(t.vars??t).palette[a].main).map(a=>({props:{inputColor:a,inputHasUnderline:!0},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[a].main}`}}})),{props:{inputHasUnderline:!0},style:{"&::after":{background:"red",left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Sy.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Sy.error}`]:{"&:before, &:after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Sy.disabled}, .${Sy.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${Sy.disabled}:before`]:{borderBottomStyle:"dotted"}}}]}}),gae=(t,e)=>{const{inputHasUnderline:r}=e,o=pn({root:["root",!r&&"underline"],input:["input"]},hae,t);return Xe({},t,o)},pO=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersInput"}),{label:o,disableUnderline:n=!1,classes:f}=a,m=vr(a,pae),y=SS(),C=Xe({},y,{inputHasUnderline:!n}),w=gae(f,C);return d.jsx(Pk,Xe({slots:{root:mae},slotProps:{root:{disableUnderline:n}}},m,{ownerState:C,label:o,classes:w,ref:r}))});pO.muiName="Input";const yae=["onFocus","onBlur","className","classes","color","disabled","error","variant","required","hiddenLabel","InputProps","inputProps","inputRef","sectionListRef","elements","areAllSectionsEmpty","onClick","onKeyDown","onKeyUp","onPaste","onInput","endAdornment","startAdornment","tabIndex","contentEditable","focused","value","onChange","fullWidth","id","name","helperText","FormHelperTextProps","label","InputLabelProps","data-active-range-position"],bae={standard:pO,filled:hO,outlined:fO},vae=nt(Hr,{name:"MuiPickersTextField",slot:"Root"})({maxWidth:"100%"}),xae=(t,e)=>{const{isFieldFocused:r,isFieldDisabled:a,isFieldRequired:o}=e;return pn({root:["root",r&&!a&&"focused",a&&"disabled",o&&"required"]},joe,t)},mO=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersTextField"}),{onFocus:o,onBlur:n,className:f,classes:m,color:y="primary",disabled:C=!1,error:w=!1,variant:A="outlined",required:R=!1,hiddenLabel:I=!1,InputProps:M,inputProps:F,inputRef:O,sectionListRef:j,elements:U,areAllSectionsEmpty:H,onClick:K,onKeyDown:W,onKeyUp:X,onPaste:ee,onInput:ie,endAdornment:de,startAdornment:le,tabIndex:oe,contentEditable:N,focused:ce,value:ne,onChange:Se,fullWidth:se,id:ye,name:ze,helperText:Re,FormHelperTextProps:ve,label:V,InputLabelProps:ue,"data-active-range-position":Ee}=a,Ie=vr(a,yae),ae=E.useRef(null),be=ro(r,ae),Te=nc(ye),tt=Re&&Te?`${Te}-helper-text`:void 0,je=V&&Te?`${Te}-label`:void 0,Pe=Rk({disabled:a.disabled,required:a.required,readOnly:M?.readOnly}),Be=E.useMemo(()=>Xe({},Pe,{isFieldValueEmpty:H,isFieldFocused:ce??!1,hasFieldError:w??!1,inputSize:a.size??"medium",inputColor:y??"primary",isInputInFullWidth:se??!1,hasStartAdornment:!!(le??M?.startAdornment),hasEndAdornment:!!(de??M?.endAdornment),inputHasLabel:!!V,isLabelShrunk:!!ue?.shrink}),[Pe,H,ce,w,a.size,y,se,le,de,M?.startAdornment,M?.endAdornment,V,ue?.shrink]),Fe=xae(m,Be),Ge=bae[A],Oe={};return A==="outlined"?(ue&&typeof ue.shrink<"u"&&(Oe.notched=ue.shrink),Oe.label=V):A==="filled"&&(Oe.hiddenLabel=I),d.jsx(dO.Provider,{value:Be,children:d.jsxs(vae,Xe({className:Ht(Fe.root,f),ref:be,focused:ce,disabled:C,variant:A,error:w,color:y,fullWidth:se,required:R,ownerState:Be},Ie,{children:[V!=null&&V!==""&&d.jsx(Qi,Xe({htmlFor:Te,id:je},ue,{children:V})),d.jsx(Ge,Xe({elements:U,areAllSectionsEmpty:H,onClick:K,onKeyDown:W,onKeyUp:X,onInput:ie,onPaste:ee,onFocus:o,onBlur:n,endAdornment:de,startAdornment:le,tabIndex:oe,contentEditable:N,value:ne,onChange:Se,id:Te,fullWidth:se,inputProps:F,inputRef:O,sectionListRef:j,label:V,name:ze,role:"group","aria-labelledby":je,"aria-describedby":tt,"aria-live":tt?"polite":void 0,"data-active-range-position":Ee},Oe,M)),Re&&d.jsx(yI,Xe({id:tt},ve,{children:Re}))]}))})}),Cae=["enableAccessibleFieldDOMStructure"],Sae=["InputProps","readOnly","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],wae=["onPaste","onKeyDown","inputMode","readOnly","InputProps","inputProps","inputRef","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],Tae=["ownerState"],Aae=["ownerState"],Eae=["ownerState"],kae=["ownerState"],Dae=["InputProps","inputProps"],_w=()=>{},Rae=t=>{let{enableAccessibleFieldDOMStructure:e}=t,r=vr(t,Cae);if(e){const{InputProps:U,readOnly:H,onClear:K,clearable:W,clearButtonPosition:X,openPickerButtonPosition:ee,openPickerAriaLabel:ie}=r,de=vr(r,Sae),le=Df>=6&&de?.slotProps?.input?Vy(de?.slotProps?.input,U):_w;return{clearable:W,onClear:K,clearButtonPosition:X,openPickerButtonPosition:ee,openPickerAriaLabel:ie,textFieldProps:Xe({},de,Df>=6&&de?.slotProps?.input?{slotProps:Xe({},de?.slotProps,{input:oe=>Xe({},Ql(le,oe),{readOnly:H})})}:{InputProps:Xe({},U??{},{readOnly:H})})}}const{onPaste:a,onKeyDown:o,inputMode:n,readOnly:f,InputProps:m,inputProps:y,inputRef:C,onClear:w,clearable:A,clearButtonPosition:R,openPickerButtonPosition:I,openPickerAriaLabel:M}=r,F=vr(r,wae),O=Df>=6&&F?.slotProps?.input?Vy(F?.slotProps?.input,m):_w,j=Df>=6&&F?.slotProps?.htmlInput?Vy(F?.slotProps?.htmlInput,y):_w;return{clearable:A,onClear:w,clearButtonPosition:R,openPickerButtonPosition:I,openPickerAriaLabel:M,textFieldProps:Xe({},F,Df>=6&&(F?.slotProps?.input||F?.slotProps?.htmlInput)?{slotProps:Xe({},F?.slotProps,{input:U=>Xe({},Ql(O,U),{readOnly:f}),htmlInput:U=>Xe({},Ql(j,U),{inputMode:n,onPaste:a,onKeyDown:o,ref:C})})}:{InputProps:Xe({},m??{},{readOnly:f}),inputProps:Xe({},y??{},{inputMode:n,onPaste:a,onKeyDown:o,ref:C})})}},Mk=E.createContext({slots:{},slotProps:{},inputRef:void 0});function Iae(t){const{fieldResponse:e,defaultOpenPickerIcon:r}=t,a=Kf(),o=Ek(),n=E.useContext(Mk),{textFieldProps:f,onClear:m,clearable:y,openPickerAriaLabel:C,clearButtonPosition:w="end",openPickerButtonPosition:A="end"}=Rae(e),R=Rk(f),I=yn(ve=>{ve.preventDefault(),o?.setOpen(V=>!V)}),M=o?o.triggerStatus:"hidden",F=y?w:null,O=M!=="hidden"?A:null,j=n.slots.textField??(e.enableAccessibleFieldDOMStructure===!1?On:mO),U=n.slots.inputAdornment??Pu,H=no({elementType:U,externalSlotProps:n.slotProps.inputAdornment,additionalProps:{position:"start"},ownerState:Xe({},R,{position:"start"})}),K=vr(H,Tae),W=no({elementType:U,externalSlotProps:n.slotProps.inputAdornment,additionalProps:{position:"end"},ownerState:Xe({},R,{position:"end"})}),X=vr(W,Aae),ee=n.slots.openPickerButton??_r,ie=no({elementType:ee,externalSlotProps:n.slotProps.openPickerButton,additionalProps:{disabled:M==="disabled",onClick:I,"aria-label":C,edge:f.variant!=="standard"?O:!1},ownerState:R}),de=vr(ie,Eae),le=n.slots.openPickerIcon??r,oe=no({elementType:le,externalSlotProps:n.slotProps.openPickerIcon,ownerState:R}),N=n.slots.clearButton??_r,ce=no({elementType:N,externalSlotProps:n.slotProps.clearButton,className:"clearButton",additionalProps:{title:a.fieldClearLabel,tabIndex:-1,onClick:m,disabled:e.disabled||e.readOnly,edge:f.variant!=="standard"&&F!==O?F:!1},ownerState:R}),ne=vr(ce,kae),Se=n.slots.clearIcon??Noe,se=no({elementType:Se,externalSlotProps:n.slotProps.clearIcon,additionalProps:{fontSize:"small"},ownerState:R});f.ref=ro(f.ref,o?.rootRef);const ye={},ze=Ql((Df>=6&&f?.slotProps?.input)??f.InputProps,R);o&&(ye.ref=o.triggerRef),!ze?.startAdornment&&(F==="start"||O==="start")&&(ye.startAdornment=d.jsxs(U,Xe({},K,{children:[O==="start"&&d.jsx(ee,Xe({},de,{children:d.jsx(le,Xe({},oe))})),F==="start"&&d.jsx(N,Xe({},ne,{children:d.jsx(Se,Xe({},se))}))]}))),!ze?.endAdornment&&(F==="end"||O==="end")&&(ye.endAdornment=d.jsxs(U,Xe({},X,{children:[F==="end"&&d.jsx(N,Xe({},ne,{children:d.jsx(Se,Xe({},se))})),O==="end"&&d.jsx(ee,Xe({},de,{children:d.jsx(le,Xe({},oe))}))]}))),!ye?.endAdornment&&!ye?.startAdornment&&n.slots.inputAdornment&&(ye.endAdornment=d.jsx(U,Xe({},X))),F!=null&&(f.sx=[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(f.sx)?f.sx:[f.sx]]);const Re=Df>=6&&f?.slotProps?.input?Ql(Vy(ze,ye),R):Xe({},ze,ye);return f.inputProps=Df>=6&&f?.slotProps?.htmlInput?Ql(f.slotProps.htmlInput,R):f.inputProps,delete f?.slotProps?.input,e.enableAccessibleFieldDOMStructure&&delete f?.slotProps,d.jsx(j,Xe({},f,{InputProps:Re}))}function Vy(t,e){return t?e?r=>Xe({},Ql(e,r),Ql(t,r)):t:e}function Pae(t){const{ref:e,externalForwardedProps:r,slotProps:a}=t,o=E.useContext(Mk),n=Ek(),f=Rk(r),{InputProps:m,inputProps:y}=r,C=vr(r,Dae),w=no({elementType:mO,externalSlotProps:Vy(o.slotProps.textField,a?.textField),externalForwardedProps:C,additionalProps:{ref:e,sx:n?.rootSx,label:n?.label,name:n?.name,className:n?.rootClassName,inputRef:o.inputRef},ownerState:f});return w.inputProps=Xe({},y,w.inputProps),w.InputProps=Xe({},m,w.InputProps),w}function Mae(t){const{slots:e={},slotProps:r={},inputRef:a,children:o}=t,n=E.useMemo(()=>({inputRef:a,slots:{openPickerButton:e.openPickerButton,openPickerIcon:e.openPickerIcon,textField:e.textField,inputAdornment:e.inputAdornment,clearIcon:e.clearIcon,clearButton:e.clearButton},slotProps:{openPickerButton:r.openPickerButton,openPickerIcon:r.openPickerIcon,textField:r.textField,inputAdornment:r.inputAdornment,clearIcon:r.clearIcon,clearButton:r.clearButton}}),[a,e.openPickerButton,e.openPickerIcon,e.textField,e.inputAdornment,e.clearIcon,e.clearButton,r.openPickerButton,r.openPickerIcon,r.textField,r.inputAdornment,r.clearIcon,r.clearButton]);return d.jsx(Mk.Provider,{value:n,children:o})}const _ae=["slots","slotProps"],gO=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiDateField"}),{slots:o,slotProps:n}=a,f=vr(a,_ae),m=Pae({slotProps:n,ref:r,externalForwardedProps:f}),y=Poe(m);return d.jsx(Mae,{slots:o,slotProps:n,inputRef:f.inputRef,children:d.jsx(Iae,{fieldResponse:y,defaultOpenPickerIcon:Foe})})}),yO=({shouldDisableDate:t,shouldDisableMonth:e,shouldDisableYear:r,minDate:a,maxDate:o,disableFuture:n,disablePast:f,timezone:m})=>{const y=Jo();return E.useCallback(C=>jb({adapter:y,value:C,timezone:m,props:{shouldDisableDate:t,shouldDisableMonth:e,shouldDisableYear:r,minDate:a,maxDate:o,disableFuture:n,disablePast:f}})!==null,[y,t,e,r,a,o,n,f,m])},Oae=(t,e)=>(r,a)=>{switch(a.type){case"setVisibleDate":return Xe({},r,{slideDirection:a.direction,currentMonth:a.month,isMonthSwitchingAnimating:!e.isSameMonth(a.month,r.currentMonth)&&!t&&!a.skipAnimation,focusedDay:a.focusedDay});case"changeMonthTimezone":{const o=a.newTimezone;if(e.getTimezone(r.currentMonth)===o)return r;let n=e.setTimezone(r.currentMonth,o);return e.getMonth(n)!==e.getMonth(r.currentMonth)&&(n=e.setMonth(n,e.getMonth(r.currentMonth))),Xe({},r,{currentMonth:n})}case"finishMonthSwitchingAnimation":return Xe({},r,{isMonthSwitchingAnimating:!1});default:throw new Error("missing support")}},Fae=t=>{const{value:e,referenceDate:r,disableFuture:a,disablePast:o,maxDate:n,minDate:f,onMonthChange:m,onYearChange:y,reduceAnimations:C,shouldDisableDate:w,timezone:A,getCurrentMonthFromVisibleDate:R}=t,I=Jo(),M=E.useRef(Oae(!!C,I)).current,F=E.useMemo(()=>Mu.getInitialReferenceValue({value:e,adapter:I,timezone:A,props:t,referenceDate:r,granularity:mu.day}),[r,A]),[O,j]=E.useReducer(M,{isMonthSwitchingAnimating:!1,focusedDay:F,currentMonth:I.startOfMonth(F),slideDirection:"left"}),U=yO({shouldDisableDate:w,minDate:f,maxDate:n,disableFuture:a,disablePast:o,timezone:A});E.useEffect(()=>{j({type:"changeMonthTimezone",newTimezone:I.getTimezone(F)})},[F,I]);const H=yn(({target:W,reason:X})=>{if(X==="cell-interaction"&&O.focusedDay!=null&&I.isSameDay(W,O.focusedDay))return;const ee=X==="cell-interaction";let ie,de;if(X==="cell-interaction")ie=R(W,O.currentMonth),de=W;else if(ie=I.isSameMonth(W,O.currentMonth)?O.currentMonth:I.startOfMonth(W),de=W,U(de)){const N=I.startOfMonth(W),ce=I.endOfMonth(W);de=db({adapter:I,date:de,minDate:I.isBefore(f,N)?N:f,maxDate:I.isAfter(n,ce)?ce:n,disablePast:o,disableFuture:a,isDateDisabled:U,timezone:A})}const le=!I.isSameMonth(O.currentMonth,ie),oe=!I.isSameYear(O.currentMonth,ie);le&&m?.(ie),oe&&y?.(I.startOfYear(ie)),j({type:"setVisibleDate",month:ie,direction:I.isAfterDay(ie,O.currentMonth)?"left":"right",focusedDay:O.focusedDay!=null&&de!=null&&I.isSameDay(de,O.focusedDay)?O.focusedDay:de,skipAnimation:ee})}),K=E.useCallback(()=>{j({type:"finishMonthSwitchingAnimation"})},[]);return{referenceDate:F,calendarState:O,setVisibleDate:H,isDateDisabled:U,onMonthSwitchingAnimationEnd:K}},Nae=t=>Cn("MuiPickersFadeTransitionGroup",t);bn("MuiPickersFadeTransitionGroup",["root"]);const jae=["children"],Lae=t=>pn({root:["root"]},Nae,t),Bae=nt(xb,{name:"MuiPickersFadeTransitionGroup",slot:"Root"})({display:"block",position:"relative"});function bO(t){const e=Da({props:t,name:"MuiPickersFadeTransitionGroup"}),{className:r,reduceAnimations:a,transKey:o,classes:n}=e,{children:f}=e,m=vr(e,jae),y=Lae(n),C=kd();return a?f:d.jsx(Bae,{className:Ht(y.root,r),ownerState:m,children:d.jsx(gp,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:C.transitions.duration.enteringScreen,enter:C.transitions.duration.enteringScreen,exit:0},children:f},o)})}function zae(t){return Cn("MuiPickersDay",t)}const Zh=bn("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]);function vO(t){const{disabled:e,selected:r,today:a,outsideCurrentMonth:o,day:n,disableMargin:f,disableHighlightToday:m,showDaysOutsideCurrentMonth:y}=t,C=Jo(),{ownerState:w}=Ws();return E.useMemo(()=>Xe({},w,{day:n,isDaySelected:r??!1,isDayDisabled:e??!1,isDayCurrent:a??!1,isDayOutsideMonth:o??!1,isDayStartOfWeek:C.isSameDay(n,C.startOfWeek(n)),isDayEndOfWeek:C.isSameDay(n,C.endOfWeek(n)),disableMargin:f??!1,disableHighlightToday:m??!1,showDaysOutsideCurrentMonth:y??!1}),[C,w,n,r,e,a,o,f,m,y])}const Uae=["autoFocus","className","classes","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","children","isFirstVisibleCell","isLastVisibleCell","day","selected","disabled","today","outsideCurrentMonth","disableMargin","disableHighlightToday","showDaysOutsideCurrentMonth"],$ae=(t,e)=>{const{isDaySelected:r,isDayDisabled:a,isDayCurrent:o,isDayOutsideMonth:n,disableMargin:f,disableHighlightToday:m,showDaysOutsideCurrentMonth:y}=e,C=n&&!y;return pn({root:["root",r&&!C&&"selected",a&&"disabled",!f&&"dayWithMargin",!m&&o&&"today",n&&y&&"dayOutsideMonth",C&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},zae,t)},xO=({theme:t})=>Xe({},t.typography.caption,{width:fb,height:fb,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:t.transitions.create("background-color",{duration:t.transitions.duration.short}),color:(t.vars||t).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Du(t.palette.primary.main,t.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.focusOpacity})`:Du(t.palette.primary.main,t.palette.action.focusOpacity),[`&.${Zh.selected}`]:{willChange:"background-color",backgroundColor:(t.vars||t).palette.primary.dark}},[`&.${Zh.selected}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,fontWeight:t.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(t.vars||t).palette.primary.dark}},[`&.${Zh.disabled}:not(.${Zh.selected})`]:{color:(t.vars||t).palette.text.disabled},[`&.${Zh.disabled}&.${Zh.selected}`]:{opacity:.6},variants:[{props:{disableMargin:!1},style:{margin:`0 ${xS}px`}},{props:{isDayOutsideMonth:!0,showDaysOutsideCurrentMonth:!0},style:{color:(t.vars||t).palette.text.secondary}},{props:{disableHighlightToday:!1,isDayCurrent:!0},style:{[`&:not(.${Zh.selected})`]:{border:`1px solid ${(t.vars||t).palette.text.secondary}`}}}]}),CO=(t,e)=>{const{ownerState:r}=t;return[e.root,!r.disableMargin&&e.dayWithMargin,!r.disableHighlightToday&&r.isDayCurrent&&e.today,!r.isDayOutsideMonth&&r.showDaysOutsideCurrentMonth&&e.dayOutsideMonth,r.isDayOutsideMonth&&!r.showDaysOutsideCurrentMonth&&e.hiddenDaySpacingFiller]},Hae=nt(Ru,{name:"MuiPickersDay",slot:"Root",overridesResolver:CO})(xO),Wae=nt("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:CO})(({theme:t})=>Xe({},xO({theme:t}),{opacity:0,pointerEvents:"none"})),wy=()=>{},Vae=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiPickersDay"}),{autoFocus:o=!1,className:n,classes:f,isAnimating:m,onClick:y,onDaySelect:C,onFocus:w=wy,onBlur:A=wy,onKeyDown:R=wy,onMouseDown:I=wy,onMouseEnter:M=wy,children:F,day:O,selected:j,disabled:U,today:H,outsideCurrentMonth:K,disableMargin:W,disableHighlightToday:X,showDaysOutsideCurrentMonth:ee}=a,ie=vr(a,Uae),de=vO({day:O,selected:j,disabled:U,today:H,outsideCurrentMonth:K,disableMargin:W,disableHighlightToday:X,showDaysOutsideCurrentMonth:ee}),le=$ae(f,de),oe=Jo(),N=E.useRef(null),ce=ro(N,r);ka(()=>{o&&!U&&!m&&!K&&N.current.focus()},[o,U,m,K]);const ne=se=>{I(se),K&&se.preventDefault()},Se=se=>{se.defaultMuiPrevented=!0,U||C(O),K&&se.currentTarget.focus(),y&&y(se)};return K&&!ee?d.jsx(Wae,{className:Ht(le.root,le.hiddenDaySpacingFiller,n),ownerState:de,role:ie.role}):d.jsx(Hae,Xe({className:Ht(le.root,n),ref:ce,centerRipple:!0,disabled:U,tabIndex:j?0:-1,onKeyDown:se=>R(se,O),onFocus:se=>w(se,O),onBlur:se=>A(se,O),onMouseEnter:se=>M(se,O),onClick:Se,onMouseDown:ne},ie,{ownerState:de,children:F??oe.format(O,"dayOfMonth")}))}),Gae=E.memo(Vae),Kae=t=>Cn("MuiPickersSlideTransition",t),Ul=bn("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),Yae=["children","className","reduceAnimations","slideDirection","transKey","classes"],qae=(t,e)=>{const{slideDirection:r}=e,a={root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${r}`],exitActive:[`slideExitActiveLeft-${r}`]};return pn(a,Kae,t)},Qae=nt(xb,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(t,e)=>[e.root,{[`.${Ul["slideEnter-left"]}`]:e["slideEnter-left"]},{[`.${Ul["slideEnter-right"]}`]:e["slideEnter-right"]},{[`.${Ul.slideEnterActive}`]:e.slideEnterActive},{[`.${Ul.slideExit}`]:e.slideExit},{[`.${Ul["slideExitActiveLeft-left"]}`]:e["slideExitActiveLeft-left"]},{[`.${Ul["slideExitActiveLeft-right"]}`]:e["slideExitActiveLeft-right"]}]})(({theme:t})=>{const e=t.transitions.create("transform",{duration:t.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${Ul["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${Ul["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${Ul.slideEnterActive}`]:{transform:"translate(0%)",transition:e},[`& .${Ul.slideExit}`]:{transform:"translate(0%)"},[`& .${Ul["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:e,zIndex:0},[`& .${Ul["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:e,zIndex:0}}});function Xae(t){const e=Da({props:t,name:"MuiPickersSlideTransition"}),{children:r,className:a,reduceAnimations:o,slideDirection:n,transKey:f,classes:m}=e,y=vr(e,Yae),{ownerState:C}=Ws(),w=Xe({},C,{slideDirection:n}),A=qae(m,w),R=kd();if(o)return d.jsx("div",{className:Ht(A.root,a),children:r});const I={exit:A.exit,enterActive:A.enterActive,enter:A.enter,exitActive:A.exitActive};return d.jsx(Qae,{className:Ht(A.root,a),childFactory:M=>E.cloneElement(M,{classNames:I}),role:"presentation",ownerState:w,children:d.jsx(fA,Xe({mountOnEnter:!0,unmountOnExit:!0,timeout:R.transitions.duration.complex,classNames:I},y,{children:r}),f)})}const Jae=t=>Cn("MuiDayCalendar",t);bn("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const Zae=["parentProps","day","focusedDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],ese=["ownerState"],tse=t=>pn({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},Jae,t),SO=(fb+xS*2)*6,nse=nt("div",{name:"MuiDayCalendar",slot:"Root"})({}),rse=nt("div",{name:"MuiDayCalendar",slot:"Header"})({display:"flex",justifyContent:"center",alignItems:"center"}),ose=nt(We,{name:"MuiDayCalendar",slot:"WeekDayLabel"})(({theme:t})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(t.vars||t).palette.text.secondary})),ase=nt(We,{name:"MuiDayCalendar",slot:"WeekNumberLabel"})(({theme:t})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(t.vars||t).palette.text.disabled})),sse=nt(We,{name:"MuiDayCalendar",slot:"WeekNumber"})(({theme:t})=>Xe({},t.typography.caption,{width:fb,height:fb,padding:0,margin:`0 ${xS}px`,color:(t.vars||t).palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),ise=nt("div",{name:"MuiDayCalendar",slot:"LoadingContainer"})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:SO}),lse=nt(Xae,{name:"MuiDayCalendar",slot:"SlideTransition"})({minHeight:SO}),cse=nt("div",{name:"MuiDayCalendar",slot:"MonthContainer"})({overflow:"hidden"}),use=nt("div",{name:"MuiDayCalendar",slot:"WeekContainer"})({margin:`${xS}px 0`,display:"flex",justifyContent:"center"});function dse(t){let{parentProps:e,day:r,focusedDay:a,selectedDays:o,isDateDisabled:n,currentMonthNumber:f,isViewFocused:m}=t,y=vr(t,Zae);const{disabled:C,disableHighlightToday:w,isMonthSwitchingAnimating:A,showDaysOutsideCurrentMonth:R,slots:I,slotProps:M,timezone:F}=e,O=Jo(),j=vS(F),U=a!=null&&O.isSameDay(r,a),H=m&&U,K=o.some(ne=>O.isSameDay(ne,r)),W=O.isSameDay(r,j),X=E.useMemo(()=>C||n(r),[C,n,r]),ee=E.useMemo(()=>O.getMonth(r)!==f,[O,r,f]),ie=vO({day:r,selected:K,disabled:X,today:W,outsideCurrentMonth:ee,disableMargin:void 0,disableHighlightToday:w,showDaysOutsideCurrentMonth:R}),de=I?.day??Gae,le=no({elementType:de,externalSlotProps:M?.day,additionalProps:Xe({disableHighlightToday:w,showDaysOutsideCurrentMonth:R,role:"gridcell",isAnimating:A,"data-timestamp":O.toJsDate(r).valueOf()},y),ownerState:Xe({},ie,{day:r,isDayDisabled:X,isDaySelected:K})}),oe=vr(le,ese),N=E.useMemo(()=>{const ne=O.startOfMonth(O.setMonth(r,f));return R?O.isSameDay(r,O.startOfWeek(ne)):O.isSameDay(r,ne)},[f,r,R,O]),ce=E.useMemo(()=>{const ne=O.endOfMonth(O.setMonth(r,f));return R?O.isSameDay(r,O.endOfWeek(ne)):O.isSameDay(r,ne)},[f,r,R,O]);return d.jsx(de,Xe({},oe,{day:r,disabled:X,autoFocus:!ee&&H,today:W,outsideCurrentMonth:ee,isFirstVisibleCell:N,isLastVisibleCell:ce,selected:K,tabIndex:U?0:-1,"aria-selected":K,"aria-current":W?"date":void 0}))}function fse(t){const e=Da({props:t,name:"MuiDayCalendar"}),r=Jo(),{onFocusedDayChange:a,className:o,classes:n,currentMonth:f,selectedDays:m,focusedDay:y,loading:C,onSelectedDaysChange:w,onMonthSwitchingAnimationEnd:A,readOnly:R,reduceAnimations:I,renderLoading:M=()=>d.jsx("span",{children:"..."}),slideDirection:F,TransitionProps:O,disablePast:j,disableFuture:U,minDate:H,maxDate:K,shouldDisableDate:W,shouldDisableMonth:X,shouldDisableYear:ee,dayOfWeekFormatter:ie=Be=>r.format(Be,"weekdayShort").charAt(0).toUpperCase(),hasFocus:de,onFocusedViewChange:le,gridLabelId:oe,displayWeekNumber:N,fixedWeekNumber:ce,timezone:ne}=e,Se=vS(ne),se=tse(n),ye=Pi(),ze=yO({shouldDisableDate:W,shouldDisableMonth:X,shouldDisableYear:ee,minDate:H,maxDate:K,disablePast:j,disableFuture:U,timezone:ne}),Re=Kf(),ve=yn(Be=>{R||w(Be)}),V=Be=>{ze(Be)||(a(Be),le?.(!0))},ue=yn((Be,Fe)=>{switch(Be.key){case"ArrowUp":V(r.addDays(Fe,-7)),Be.preventDefault();break;case"ArrowDown":V(r.addDays(Fe,7)),Be.preventDefault();break;case"ArrowLeft":{const Ge=r.addDays(Fe,ye?1:-1),Oe=r.addMonths(Fe,ye?1:-1),mt=db({adapter:r,date:Ge,minDate:ye?Ge:r.startOfMonth(Oe),maxDate:ye?r.endOfMonth(Oe):Ge,isDateDisabled:ze,timezone:ne});V(mt||Ge),Be.preventDefault();break}case"ArrowRight":{const Ge=r.addDays(Fe,ye?-1:1),Oe=r.addMonths(Fe,ye?-1:1),mt=db({adapter:r,date:Ge,minDate:ye?r.startOfMonth(Oe):Ge,maxDate:ye?Ge:r.endOfMonth(Oe),isDateDisabled:ze,timezone:ne});V(mt||Ge),Be.preventDefault();break}case"Home":V(r.startOfWeek(Fe)),Be.preventDefault();break;case"End":V(r.endOfWeek(Fe)),Be.preventDefault();break;case"PageUp":V(r.addMonths(Fe,1)),Be.preventDefault();break;case"PageDown":V(r.addMonths(Fe,-1)),Be.preventDefault();break}}),Ee=yn((Be,Fe)=>V(Fe)),Ie=yn((Be,Fe)=>{y!=null&&r.isSameDay(y,Fe)&&le?.(!1)}),ae=r.getMonth(f),be=r.getYear(f),Te=E.useMemo(()=>m.filter(Be=>!!Be).map(Be=>r.startOfDay(Be)),[r,m]),tt=`${be}-${ae}`,je=E.useMemo(()=>E.createRef(),[tt]),Pe=E.useMemo(()=>{const Be=r.getWeekArray(f);let Fe=r.addMonths(f,1);for(;ce&&Be.length<ce;){const Ge=r.getWeekArray(Fe),Oe=r.isSameDay(Be[Be.length-1][0],Ge[0][0]);Ge.slice(Oe?1:0).forEach(mt=>{Be.length<ce&&Be.push(mt)}),Fe=r.addMonths(Fe,1)}return Be},[f,ce,r]);return d.jsxs(nse,{role:"grid","aria-labelledby":oe,className:se.root,children:[d.jsxs(rse,{role:"row",className:se.header,children:[N&&d.jsx(ase,{variant:"caption",role:"columnheader","aria-label":Re.calendarWeekNumberHeaderLabel,className:se.weekNumberLabel,children:Re.calendarWeekNumberHeaderText}),$ne(r,Se).map((Be,Fe)=>d.jsx(ose,{variant:"caption",role:"columnheader","aria-label":r.format(Be,"weekday"),className:se.weekDayLabel,children:ie(Be)},Fe.toString()))]}),C?d.jsx(ise,{className:se.loadingContainer,children:M()}):d.jsx(lse,Xe({transKey:tt,onExited:A,reduceAnimations:I,slideDirection:F,className:Ht(o,se.slideTransition)},O,{nodeRef:je,children:d.jsx(cse,{ref:je,role:"rowgroup",className:se.monthContainer,children:Pe.map((Be,Fe)=>d.jsxs(use,{role:"row",className:se.weekContainer,"aria-rowindex":Fe+1,children:[N&&d.jsx(sse,{className:se.weekNumber,role:"rowheader","aria-label":Re.calendarWeekNumberAriaLabelText(r.getWeekNumber(Be[0])),children:Re.calendarWeekNumberText(r.getWeekNumber(Be[0]))}),Be.map((Ge,Oe)=>d.jsx(dse,{parentProps:e,day:Ge,selectedDays:Te,isViewFocused:de,focusedDay:y,onKeyDown:ue,onFocus:Ee,onBlur:Ie,onDaySelect:ve,isDateDisabled:ze,currentMonthNumber:ae,"aria-colindex":Oe+1},Ge.toString()))]},`week-${Be[0]}`))})}))]})}function wO(t){return Cn("MuiMonthCalendar",t)}const zx=bn("MuiMonthCalendar",["root","button","disabled","selected"]),hse=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],pse=(t,e)=>{const r={button:["button",e.isMonthDisabled&&"disabled",e.isMonthSelected&&"selected"]};return pn(r,wO,t)},mse=nt("button",{name:"MuiMonthCalendar",slot:"Button",overridesResolver:(t,e)=>[e.button,{[`&.${zx.disabled}`]:e.disabled},{[`&.${zx.selected}`]:e.selected}]})(({theme:t})=>Xe({color:"unset",backgroundColor:"transparent",border:0,outline:0},t.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Du(t.palette.action.active,t.palette.action.hoverOpacity)},"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Du(t.palette.action.active,t.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${zx.disabled}`]:{color:(t.vars||t).palette.text.secondary},[`&.${zx.selected}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,"&:focus, &:hover":{backgroundColor:(t.vars||t).palette.primary.dark}}})),gse=E.memo(function(e){const{autoFocus:r,classes:a,disabled:o,selected:n,value:f,onClick:m,onKeyDown:y,onFocus:C,onBlur:w,slots:A,slotProps:R}=e,I=vr(e,hse),M=E.useRef(null),{ownerState:F}=Ws(),O=Xe({},F,{isMonthDisabled:o,isMonthSelected:n}),j=pse(a,O);ka(()=>{r&&M.current?.focus()},[r]);const U=A?.monthButton??mse,H=no({elementType:U,externalSlotProps:R?.monthButton,externalForwardedProps:I,additionalProps:{disabled:o,ref:M,type:"button",role:"radio","aria-checked":n,onClick:K=>m(K,f),onKeyDown:K=>y(K,f),onFocus:K=>C(K,f),onBlur:K=>w(K,f)},ownerState:O,className:j.button});return d.jsx(U,Xe({},H))}),yse=["autoFocus","className","currentMonth","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId","slots","slotProps"],bse=t=>pn({root:["root"]},wO,t);function vse(t,e){const r=Da({props:t,name:e}),a=Lb(r);return Xe({},r,a,{monthsPerRow:r.monthsPerRow??3})}const VR=(t,e,r,a,o)=>!!(t===e&&a&&o.isSameYear(r,a)),xse=nt("div",{name:"MuiMonthCalendar",slot:"Root",shouldForwardProp:t=>Au(t)&&t!=="monthsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:16,padding:"8px 0",width:CS,boxSizing:"border-box",variants:[{props:{monthsPerRow:3},style:{columnGap:24}},{props:{monthsPerRow:4},style:{columnGap:0}}]}),Cse=E.forwardRef(function(e,r){const a=vse(e,"MuiMonthCalendar"),{autoFocus:o,className:n,currentMonth:f,classes:m,value:y,defaultValue:C,referenceDate:w,disabled:A,disableFuture:R,disablePast:I,maxDate:M,minDate:F,onChange:O,shouldDisableMonth:j,readOnly:U,onMonthFocus:H,hasFocus:K,onFocusedViewChange:W,monthsPerRow:X,timezone:ee,gridLabelId:ie,slots:de,slotProps:le}=a,oe=vr(a,yse),{value:N,handleValueChange:ce,timezone:ne}=Bb({name:"MonthCalendar",timezone:ee,value:y,defaultValue:C,referenceDate:w,onChange:O,valueManager:Mu}),Se=vS(ne),se=Pi(),ye=Jo(),{ownerState:ze}=Ws(),Re=E.useMemo(()=>Mu.getInitialReferenceValue({value:N,adapter:ye,props:a,timezone:ne,referenceDate:w,granularity:mu.month}),[]),ve=bse(m),V=E.useMemo(()=>ye.getMonth(Se),[ye,Se]),ue=E.useMemo(()=>N!=null?ye.getMonth(N):null,[N,ye]),[Ee,Ie]=E.useState(()=>ue||ye.getMonth(Re)),[ae,be]=Ki({name:"MonthCalendar",state:"hasFocus",controlled:K,default:o??!1}),Te=yn(Oe=>{be(Oe),W&&W(Oe)}),tt=E.useCallback(Oe=>{const mt=ye.startOfMonth(I&&ye.isAfter(Se,F)?Se:F),qe=ye.startOfMonth(R&&ye.isBefore(Se,M)?Se:M),Ae=ye.startOfMonth(Oe);return ye.isBefore(Ae,mt)||ye.isAfter(Ae,qe)?!0:j?j(Ae):!1},[R,I,M,F,Se,j,ye]),je=yn((Oe,mt)=>{if(U)return;const qe=N&&f&&!ye.isSameYear(N,f)?ye.setYear(N,ye.getYear(f)):N,Ae=ye.setMonth(qe??Re,mt);ce(Ae)}),Pe=yn(Oe=>{tt(ye.setMonth(N??f??Re,Oe))||(Ie(Oe),Te(!0),H&&H(Oe))});E.useEffect(()=>{Ie(Oe=>ue!==null&&Oe!==ue?ue:Oe)},[ue]);const Be=yn((Oe,mt)=>{switch(Oe.key){case"ArrowUp":Pe((12+mt-3)%12),Oe.preventDefault();break;case"ArrowDown":Pe((12+mt+3)%12),Oe.preventDefault();break;case"ArrowLeft":Pe((12+mt+(se?1:-1))%12),Oe.preventDefault();break;case"ArrowRight":Pe((12+mt+(se?-1:1))%12),Oe.preventDefault();break}}),Fe=yn((Oe,mt)=>{Pe(mt)}),Ge=yn((Oe,mt)=>{Ee===mt&&Te(!1)});return d.jsx(xse,Xe({ref:r,className:Ht(ve.root,n),ownerState:ze,role:"radiogroup","aria-labelledby":ie,monthsPerRow:X},oe,{children:vk(ye,f??N??Re).map(Oe=>{const mt=ye.getMonth(Oe),qe=ye.format(Oe,"monthShort"),Ae=ye.format(Oe,"month"),te=VR(mt,ue,Oe,N,ye),pe=A||tt(Oe);return d.jsx(gse,{selected:te,value:mt,onClick:je,onKeyDown:Be,autoFocus:ae&&mt===Ee,disabled:pe,tabIndex:mt===Ee&&!pe?0:-1,onFocus:Fe,onBlur:Ge,"aria-current":VR(mt,V,Oe,Se,ye)?"date":void 0,"aria-label":Ae,slots:de,slotProps:le,classes:m,children:qe},qe)})}))});function TO(t){return Cn("MuiYearCalendar",t)}const Ux=bn("MuiYearCalendar",["root","button","disabled","selected"]),Sse=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],wse=(t,e)=>{const r={button:["button",e.isYearDisabled&&"disabled",e.isYearSelected&&"selected"]};return pn(r,TO,t)},Tse=nt("button",{name:"MuiYearCalendar",slot:"Button",overridesResolver:(t,e)=>[e.button,{[`&.${Ux.disabled}`]:e.disabled},{[`&.${Ux.selected}`]:e.selected}]})(({theme:t})=>Xe({color:"unset",backgroundColor:"transparent",border:0,outline:0},t.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.focusOpacity})`:Du(t.palette.action.active,t.palette.action.focusOpacity)},"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Du(t.palette.action.active,t.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Ux.disabled}`]:{color:(t.vars||t).palette.text.secondary},[`&.${Ux.selected}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.main,"&:focus, &:hover":{backgroundColor:(t.vars||t).palette.primary.dark}}})),Ase=E.memo(function(e){const{autoFocus:r,classes:a,disabled:o,selected:n,value:f,onClick:m,onKeyDown:y,onFocus:C,onBlur:w,slots:A,slotProps:R}=e,I=vr(e,Sse),M=E.useRef(null),{ownerState:F}=Ws(),O=Xe({},F,{isYearDisabled:o,isYearSelected:n}),j=wse(a,O);ka(()=>{r&&M.current?.focus()},[r]);const U=A?.yearButton??Tse,H=no({elementType:U,externalSlotProps:R?.yearButton,externalForwardedProps:I,additionalProps:{disabled:o,ref:M,type:"button",role:"radio","aria-checked":n,onClick:K=>m(K,f),onKeyDown:K=>y(K,f),onFocus:K=>C(K,f),onBlur:K=>w(K,f)},ownerState:O,className:j.button});return d.jsx(U,Xe({},H))}),Ese=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsOrder","yearsPerRow","timezone","gridLabelId","slots","slotProps"],kse=t=>pn({root:["root"]},TO,t);function Dse(t,e){const r=Da({props:t,name:e}),a=Lb(r);return Xe({},r,a,{yearsPerRow:r.yearsPerRow??3,yearsOrder:r.yearsOrder??"asc"})}const Rse=nt("div",{name:"MuiYearCalendar",slot:"Root",shouldForwardProp:t=>Au(t)&&t!=="yearsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:12,padding:"6px 0",overflowY:"auto",height:"100%",width:CS,maxHeight:roe,boxSizing:"border-box",position:"relative",variants:[{props:{yearsPerRow:3},style:{columnGap:24}},{props:{yearsPerRow:4},style:{columnGap:0,padding:"0 2px"}}]}),Ise=nt("div",{name:"MuiYearCalendar",slot:"ButtonFiller"})({height:36,width:72}),Pse=E.forwardRef(function(e,r){const a=Dse(e,"MuiYearCalendar"),{autoFocus:o,className:n,classes:f,value:m,defaultValue:y,referenceDate:C,disabled:w,disableFuture:A,disablePast:R,maxDate:I,minDate:M,onChange:F,readOnly:O,shouldDisableYear:j,onYearFocus:U,hasFocus:H,onFocusedViewChange:K,yearsOrder:W,yearsPerRow:X,timezone:ee,gridLabelId:ie,slots:de,slotProps:le}=a,oe=vr(a,Ese),{value:N,handleValueChange:ce,timezone:ne}=Bb({name:"YearCalendar",timezone:ee,value:m,defaultValue:y,referenceDate:C,onChange:F,valueManager:Mu}),Se=vS(ne),se=Pi(),ye=Jo(),{ownerState:ze}=Ws(),Re=E.useMemo(()=>Mu.getInitialReferenceValue({value:N,adapter:ye,props:a,timezone:ne,referenceDate:C,granularity:mu.year}),[]),ve=kse(f),V=E.useMemo(()=>ye.getYear(Se),[ye,Se]),ue=E.useMemo(()=>N!=null?ye.getYear(N):null,[N,ye]),[Ee,Ie]=E.useState(()=>ue||ye.getYear(Re)),[ae,be]=Ki({name:"YearCalendar",state:"hasFocus",controlled:H,default:o??!1}),Te=yn(J=>{be(J),K&&K(J)}),tt=E.useCallback(J=>{if(R&&ye.isBeforeYear(J,Se)||A&&ye.isAfterYear(J,Se)||M&&ye.isBeforeYear(J,M)||I&&ye.isAfterYear(J,I))return!0;if(!j)return!1;const fe=ye.startOfYear(J);return j(fe)},[A,R,I,M,Se,j,ye]),je=yn((J,fe)=>{if(O)return;const xe=ye.setYear(N??Re,fe);ce(xe)}),Pe=yn(J=>{tt(ye.setYear(N??Re,J))||(Ie(J),Te(!0),U?.(J))});E.useEffect(()=>{Ie(J=>ue!==null&&J!==ue?ue:J)},[ue]);const Be=W!=="desc"?X*1:X*-1,Fe=se&&W==="asc"||!se&&W==="desc"?-1:1,Ge=yn((J,fe)=>{switch(J.key){case"ArrowUp":Pe(fe-Be),J.preventDefault();break;case"ArrowDown":Pe(fe+Be),J.preventDefault();break;case"ArrowLeft":Pe(fe-Fe),J.preventDefault();break;case"ArrowRight":Pe(fe+Fe),J.preventDefault();break}}),Oe=yn((J,fe)=>{Pe(fe)}),mt=yn((J,fe)=>{Ee===fe&&Te(!1)}),qe=E.useRef(null),Ae=ro(r,qe);E.useEffect(()=>{if(o||qe.current===null)return;const J=qe.current.querySelector('[tabindex="0"]');if(!J)return;const fe=J.offsetHeight,xe=J.offsetTop,Ne=qe.current.clientHeight,Me=qe.current.scrollTop,Ve=xe+fe;fe>Ne||xe<Me||(qe.current.scrollTop=Ve-Ne/2-fe/2)},[o]);const te=ye.getYearRange([M,I]);W==="desc"&&te.reverse();let pe=X-te.length%X;return pe===X&&(pe=0),d.jsxs(Rse,Xe({ref:Ae,className:Ht(ve.root,n),ownerState:ze,role:"radiogroup","aria-labelledby":ie,yearsPerRow:X},oe,{children:[te.map(J=>{const fe=ye.getYear(J),xe=fe===ue,Ne=w||tt(J);return d.jsx(Ase,{selected:xe,value:fe,onClick:je,onKeyDown:Ge,autoFocus:ae&&fe===Ee,disabled:Ne,tabIndex:fe===Ee&&!Ne?0:-1,onFocus:Oe,onBlur:mt,"aria-current":V===fe?"date":void 0,slots:de,slotProps:le,classes:f,children:ye.format(J,"year")},ye.format(J,"year"))}),Array.from({length:pe},(J,fe)=>d.jsx(Ise,{},fe))]}))}),Mse=t=>Cn("MuiPickersCalendarHeader",t),_se=bn("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]);function Ose(t){return Cn("MuiPickersArrowSwitcher",t)}bn("MuiPickersArrowSwitcher",["root","spacer","button","previousIconButton","nextIconButton","leftArrowIcon","rightArrowIcon"]);const Fse=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel","labelId","classes"],Nse=["ownerState"],jse=["ownerState"],Lse=nt("div",{name:"MuiPickersArrowSwitcher",slot:"Root"})({display:"flex"}),Bse=nt("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer"})(({theme:t})=>({width:t.spacing(3)})),GR=nt(_r,{name:"MuiPickersArrowSwitcher",slot:"Button"})({variants:[{props:{isButtonHidden:!0},style:{visibility:"hidden"}}]}),zse=t=>pn({root:["root"],spacer:["spacer"],button:["button"],previousIconButton:["previousIconButton"],nextIconButton:["nextIconButton"],leftArrowIcon:["leftArrowIcon"],rightArrowIcon:["rightArrowIcon"]},Ose,t),Use=E.forwardRef(function(e,r){const a=Pi(),o=Da({props:e,name:"MuiPickersArrowSwitcher"}),{children:n,className:f,slots:m,slotProps:y,isNextDisabled:C,isNextHidden:w,onGoToNext:A,nextLabel:R,isPreviousDisabled:I,isPreviousHidden:M,onGoToPrevious:F,previousLabel:O,labelId:j,classes:U}=o,H=vr(o,Fse),{ownerState:K}=Ws(),W=zse(U),X={isDisabled:C,isHidden:w,goTo:A,label:R},ee={isDisabled:I,isHidden:M,goTo:F,label:O},ie=m?.previousIconButton??GR,de=no({elementType:ie,externalSlotProps:y?.previousIconButton,additionalProps:{size:"medium",title:ee.label,"aria-label":ee.label,disabled:ee.isDisabled,edge:"end",onClick:ee.goTo},ownerState:Xe({},K,{isButtonHidden:ee.isHidden??!1}),className:Ht(W.button,W.previousIconButton)}),le=m?.nextIconButton??GR,oe=no({elementType:le,externalSlotProps:y?.nextIconButton,additionalProps:{size:"medium",title:X.label,"aria-label":X.label,disabled:X.isDisabled,edge:"start",onClick:X.goTo},ownerState:Xe({},K,{isButtonHidden:X.isHidden??!1}),className:Ht(W.button,W.nextIconButton)}),N=m?.leftArrowIcon??_oe,ce=no({elementType:N,externalSlotProps:y?.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:K,className:W.leftArrowIcon}),ne=vr(ce,Nse),Se=m?.rightArrowIcon??Ooe,se=no({elementType:Se,externalSlotProps:y?.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:K,className:W.rightArrowIcon}),ye=vr(se,jse);return d.jsxs(Lse,Xe({ref:r,className:Ht(W.root,f),ownerState:K},H,{children:[d.jsx(ie,Xe({},de,{children:a?d.jsx(Se,Xe({},ye)):d.jsx(N,Xe({},ne))})),n?d.jsx(We,{variant:"subtitle1",component:"span",id:j,children:n}):d.jsx(Bse,{className:W.spacer,ownerState:K}),d.jsx(le,Xe({},oe,{children:a?d.jsx(N,Xe({},ne)):d.jsx(Se,Xe({},ye))}))]}))});function $se(t,{disableFuture:e,maxDate:r,timezone:a}){const o=Jo();return E.useMemo(()=>{const n=o.date(void 0,a),f=o.startOfMonth(e&&o.isBefore(n,r)?n:r);return!o.isAfter(f,t)},[e,r,t,o,a])}function Hse(t,{disablePast:e,minDate:r,timezone:a}){const o=Jo();return E.useMemo(()=>{const n=o.date(void 0,a),f=o.startOfMonth(e&&o.isAfter(n,r)?n:r);return!o.isBefore(f,t)},[e,r,t,o,a])}const Wse=["slots","slotProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","classes","timezone","format"],Vse=["ownerState"],Gse=t=>pn({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},Mse,t),Kse=nt("div",{name:"MuiPickersCalendarHeader",slot:"Root"})({display:"flex",alignItems:"center",marginTop:12,marginBottom:4,paddingLeft:24,paddingRight:12,maxHeight:40,minHeight:40}),Yse=nt("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer"})(({theme:t})=>Xe({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},t.typography.body1,{fontWeight:t.typography.fontWeightMedium})),qse=nt("div",{name:"MuiPickersCalendarHeader",slot:"Label"})({marginRight:6}),Qse=nt(_r,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton"})({marginRight:"auto",variants:[{props:{view:"year"},style:{[`.${_se.switchViewIcon}`]:{transform:"rotate(180deg)"}}}]}),Xse=nt(Moe,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon"})(({theme:t})=>({willChange:"transform",transition:t.transitions.create("transform"),transform:"rotate(0deg)"})),Jse=E.forwardRef(function(e,r){const a=Kf(),o=Jo(),n=Da({props:e,name:"MuiPickersCalendarHeader"}),{slots:f,slotProps:m,currentMonth:y,disabled:C,disableFuture:w,disablePast:A,maxDate:R,minDate:I,onMonthChange:M,onViewChange:F,view:O,reduceAnimations:j,views:U,labelId:H,className:K,classes:W,timezone:X,format:ee=`${o.formats.month} ${o.formats.year}`}=n,ie=vr(n,Wse),{ownerState:de}=Ws(),le=Gse(W),oe=f?.switchViewButton??Qse,N=no({elementType:oe,externalSlotProps:m?.switchViewButton,additionalProps:{size:"small","aria-label":a.calendarViewSwitchingButtonAriaLabel(O)},ownerState:Xe({},de,{view:O}),className:le.switchViewButton}),ce=f?.switchViewIcon??Xse,ne=no({elementType:ce,externalSlotProps:m?.switchViewIcon,ownerState:de,className:le.switchViewIcon}),Se=vr(ne,Vse),se=()=>M(o.addMonths(y,1)),ye=()=>M(o.addMonths(y,-1)),ze=$se(y,{disableFuture:w,maxDate:R,timezone:X}),Re=Hse(y,{disablePast:A,minDate:I,timezone:X}),ve=()=>{if(!(U.length===1||!F||C))if(U.length===2)F(U.find(ue=>ue!==O)||U[0]);else{const ue=U.indexOf(O)!==0?0:1;F(U[ue])}};if(U.length===1&&U[0]==="year")return null;const V=o.formatByString(y,ee);return d.jsxs(Kse,Xe({},ie,{ownerState:de,className:Ht(le.root,K),ref:r,children:[d.jsxs(Yse,{role:"presentation",onClick:ve,ownerState:de,"aria-live":"polite",className:le.labelContainer,children:[d.jsx(bO,{reduceAnimations:j,transKey:V,children:d.jsx(qse,{id:H,ownerState:de,className:le.label,children:V})}),U.length>1&&!C&&d.jsx(oe,Xe({},N,{children:d.jsx(ce,Xe({},Se))}))]}),d.jsx(gp,{in:O==="day",appear:!j,enter:!j,children:d.jsx(Use,{slots:f,slotProps:m,onGoToPrevious:ye,isPreviousDisabled:Re,previousLabel:a.previousMonth,onGoToNext:se,isNextDisabled:ze,nextLabel:a.nextMonth})})]}))}),Zse=nt("div")({overflow:"hidden",width:CS,maxHeight:kk,display:"flex",flexDirection:"column",margin:"0 auto"}),eie=t=>Cn("MuiDateCalendar",t);bn("MuiDateCalendar",["root","viewTransitionContainer"]);const tie=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","classes","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsOrder","yearsPerRow","monthsPerRow","timezone"],nie=t=>pn({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},eie,t);function rie(t,e){const r=Da({props:t,name:e}),a=Q_(r.reduceAnimations),o=Lb(r);return Xe({},r,o,{loading:r.loading??!1,openTo:r.openTo??"day",views:r.views??["year","day"],reduceAnimations:a,renderLoading:r.renderLoading??(()=>d.jsx("span",{children:"..."}))})}const oie=nt(Zse,{name:"MuiDateCalendar",slot:"Root"})({display:"flex",flexDirection:"column",height:kk}),aie=nt(bO,{name:"MuiDateCalendar",slot:"ViewTransitionContainer"})({}),sie=E.forwardRef(function(e,r){const a=Jo(),{ownerState:o}=Ws(),n=nc(),f=rie(e,"MuiDateCalendar"),{autoFocus:m,onViewChange:y,value:C,defaultValue:w,referenceDate:A,disableFuture:R,disablePast:I,onChange:M,onMonthChange:F,reduceAnimations:O,shouldDisableDate:j,shouldDisableMonth:U,shouldDisableYear:H,view:K,views:W,openTo:X,className:ee,classes:ie,disabled:de,readOnly:le,minDate:oe,maxDate:N,disableHighlightToday:ce,focusedView:ne,onFocusedViewChange:Se,showDaysOutsideCurrentMonth:se,fixedWeekNumber:ye,dayOfWeekFormatter:ze,slots:Re,slotProps:ve,loading:V,renderLoading:ue,displayWeekNumber:Ee,yearsOrder:Ie,yearsPerRow:ae,monthsPerRow:be,timezone:Te}=f,tt=vr(f,tie),{value:je,handleValueChange:Pe,timezone:Be}=Bb({name:"DateCalendar",timezone:Te,value:C,defaultValue:w,referenceDate:A,onChange:M,valueManager:Mu}),{view:Fe,setView:Ge,focusedView:Oe,setFocusedView:mt,goToNextView:qe,setValueAndGoToNextView:Ae}=J_({view:K,views:W,openTo:X,onChange:Pe,onViewChange:y,autoFocus:m,focusedView:ne,onFocusedViewChange:Se}),{referenceDate:te,calendarState:pe,setVisibleDate:J,isDateDisabled:fe,onMonthSwitchingAnimationEnd:xe}=Fae({value:je,referenceDate:A,reduceAnimations:O,onMonthChange:F,minDate:oe,maxDate:N,shouldDisableDate:j,disablePast:I,disableFuture:R,timezone:Be,getCurrentMonthFromVisibleDate:(at,Et)=>a.isSameMonth(at,Et)?Et:a.startOfMonth(at)}),Ne=de&&je||oe,Me=de&&je||N,Ve=`${n}-grid-label`,Qe=Oe!==null,rt=Re?.calendarHeader??Jse,st=no({elementType:rt,externalSlotProps:ve?.calendarHeader,additionalProps:{views:W,view:Fe,currentMonth:pe.currentMonth,onViewChange:Ge,onMonthChange:at=>J({target:at,reason:"header-navigation"}),minDate:Ne,maxDate:Me,disabled:de,disablePast:I,disableFuture:R,reduceAnimations:O,timezone:Be,labelId:Ve},ownerState:o}),it=yn(at=>{const Et=a.startOfMonth(at),qt=a.endOfMonth(at),gn=fe(at)?db({adapter:a,date:at,minDate:a.isBefore(oe,Et)?Et:oe,maxDate:a.isAfter(N,qt)?qt:N,disablePast:I,disableFuture:R,isDateDisabled:fe,timezone:Be}):at;gn?(Ae(gn,"finish"),J({target:gn,reason:"cell-interaction"})):(qe(),J({target:Et,reason:"cell-interaction"}))}),xt=yn(at=>{const Et=a.startOfYear(at),qt=a.endOfYear(at),gn=fe(at)?db({adapter:a,date:at,minDate:a.isBefore(oe,Et)?Et:oe,maxDate:a.isAfter(N,qt)?qt:N,disablePast:I,disableFuture:R,isDateDisabled:fe,timezone:Be}):at;gn?(Ae(gn,"finish"),J({target:gn,reason:"cell-interaction"})):(qe(),J({target:Et,reason:"cell-interaction"}))}),pt=yn(at=>Pe(at&&oC(a,at,je??te),"finish",Fe));E.useEffect(()=>{a.isValid(je)&&J({target:je,reason:"controlled-value-change"})},[je]);const Yt=nie(ie),Kt={disablePast:I,disableFuture:R,maxDate:N,minDate:oe},tn={disableHighlightToday:ce,readOnly:le,disabled:de,timezone:Be,gridLabelId:Ve,slots:Re,slotProps:ve},Wt=E.useRef(Fe);E.useEffect(()=>{Wt.current!==Fe&&(Oe===Wt.current&&mt(Fe,!0),Wt.current=Fe)},[Oe,mt,Fe]);const _t=E.useMemo(()=>[je],[je]);return d.jsxs(oie,Xe({ref:r,className:Ht(Yt.root,ee),ownerState:o},tt,{children:[d.jsx(rt,Xe({},st,{slots:Re,slotProps:ve})),d.jsx(aie,{reduceAnimations:O,className:Yt.viewTransitionContainer,transKey:Fe,ownerState:o,children:d.jsxs("div",{children:[Fe==="year"&&d.jsx(Pse,Xe({},Kt,tn,{value:je,onChange:xt,shouldDisableYear:H,hasFocus:Qe,onFocusedViewChange:at=>mt("year",at),yearsOrder:Ie,yearsPerRow:ae,referenceDate:te})),Fe==="month"&&d.jsx(Cse,Xe({},Kt,tn,{currentMonth:pe.currentMonth,hasFocus:Qe,className:ee,value:je,onChange:it,shouldDisableMonth:U,onFocusedViewChange:at=>mt("month",at),monthsPerRow:be,referenceDate:te})),Fe==="day"&&d.jsx(fse,Xe({},pe,Kt,tn,{onMonthSwitchingAnimationEnd:xe,hasFocus:Qe,onFocusedDayChange:at=>J({target:at,reason:"cell-interaction"}),reduceAnimations:O,selectedDays:_t,onSelectedDaysChange:pt,shouldDisableDate:j,shouldDisableMonth:U,shouldDisableYear:H,onFocusedViewChange:at=>mt("day",at),showDaysOutsideCurrentMonth:se,fixedWeekNumber:ye,dayOfWeekFormatter:ze,displayWeekNumber:Ee,loading:V,renderLoading:ue}))]})})]}))}),Vm=({view:t,onViewChange:e,views:r,focusedView:a,onFocusedViewChange:o,value:n,defaultValue:f,referenceDate:m,onChange:y,className:C,classes:w,disableFuture:A,disablePast:R,minDate:I,maxDate:M,shouldDisableDate:F,shouldDisableMonth:O,shouldDisableYear:j,reduceAnimations:U,onMonthChange:H,monthsPerRow:K,onYearChange:W,yearsOrder:X,yearsPerRow:ee,slots:ie,slotProps:de,loading:le,renderLoading:oe,disableHighlightToday:N,readOnly:ce,disabled:ne,showDaysOutsideCurrentMonth:Se,dayOfWeekFormatter:se,sx:ye,autoFocus:ze,fixedWeekNumber:Re,displayWeekNumber:ve,timezone:V})=>d.jsx(sie,{view:t,onViewChange:e,views:r.filter(RR),focusedView:a&&RR(a)?a:null,onFocusedViewChange:o,value:n,defaultValue:f,referenceDate:m,onChange:y,className:C,classes:w,disableFuture:A,disablePast:R,minDate:I,maxDate:M,shouldDisableDate:F,shouldDisableMonth:O,shouldDisableYear:j,reduceAnimations:U,onMonthChange:H,monthsPerRow:K,onYearChange:W,yearsOrder:X,yearsPerRow:ee,slots:ie,slotProps:de,loading:le,renderLoading:oe,disableHighlightToday:N,readOnly:ce,disabled:ne,showDaysOutsideCurrentMonth:Se,dayOfWeekFormatter:se,sx:ye,autoFocus:ze,fixedWeekNumber:Re,displayWeekNumber:ve,timezone:V}),AO=E.forwardRef(function(e,r){const a=Jo(),o=Y_(e,"MuiDesktopDatePicker"),n=Xe({day:Vm,month:Vm,year:Vm},o.viewRenderers),f=Xe({},o,{closeOnSelect:o.closeOnSelect??!0,viewRenderers:n,format:xk(a,o,!1),yearsPerRow:o.yearsPerRow??4,slots:Xe({field:gO},o.slots),slotProps:Xe({},o.slotProps,{field:y=>Xe({},Ql(o.slotProps?.field,y),V_(o)),toolbar:Xe({hidden:!0},o.slotProps?.toolbar)})}),{renderPicker:m}=yoe({ref:r,props:f,valueManager:Mu,valueType:"date",validator:jb,steps:null});return m()});AO.propTypes={autoFocus:kt.bool,className:kt.string,closeOnSelect:kt.bool,dayOfWeekFormatter:kt.func,defaultValue:kt.object,disabled:kt.bool,disableFuture:kt.bool,disableHighlightToday:kt.bool,disableOpenPicker:kt.bool,disablePast:kt.bool,displayWeekNumber:kt.bool,enableAccessibleFieldDOMStructure:kt.any,fixedWeekNumber:kt.number,format:kt.string,formatDensity:kt.oneOf(["dense","spacious"]),inputRef:X3,label:kt.node,loading:kt.bool,localeText:kt.object,maxDate:kt.object,minDate:kt.object,monthsPerRow:kt.oneOf([3,4]),name:kt.string,onAccept:kt.func,onChange:kt.func,onClose:kt.func,onError:kt.func,onMonthChange:kt.func,onOpen:kt.func,onSelectedSectionsChange:kt.func,onViewChange:kt.func,onYearChange:kt.func,open:kt.bool,openTo:kt.oneOf(["day","month","year"]),orientation:kt.oneOf(["landscape","portrait"]),readOnly:kt.bool,reduceAnimations:kt.bool,referenceDate:kt.object,renderLoading:kt.func,selectedSections:kt.oneOfType([kt.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),kt.number]),shouldDisableDate:kt.func,shouldDisableMonth:kt.func,shouldDisableYear:kt.func,showDaysOutsideCurrentMonth:kt.bool,slotProps:kt.object,slots:kt.object,sx:kt.oneOfType([kt.arrayOf(kt.oneOfType([kt.func,kt.object,kt.bool])),kt.func,kt.object]),timezone:kt.string,value:kt.object,view:kt.oneOf(["day","month","year"]),viewRenderers:kt.shape({day:kt.func,month:kt.func,year:kt.func}),views:kt.arrayOf(kt.oneOf(["day","month","year"]).isRequired),yearsOrder:kt.oneOf(["asc","desc"]),yearsPerRow:kt.oneOf([3,4])};const iie=nt(oi)({[`& .${Oy.container}`]:{outline:0},[`& .${Oy.paper}`]:{outline:0,minWidth:CS}}),lie=nt(ai)({"&:first-of-type":{padding:0}});function cie(t){const{children:e,slots:r,slotProps:a}=t,{open:o}=Cg(),{dismissViews:n,onPopperExited:f}=Ws(),m=r?.dialog??iie,y=r?.mobileTransition??gp;return d.jsx(m,Xe({open:o,onClose:()=>{n(),f?.()}},a?.dialog,{TransitionComponent:y,TransitionProps:a?.mobileTransition,PaperComponent:r?.mobilePaper,PaperProps:a?.mobilePaper,children:d.jsx(lie,{children:e})}))}const uie=["props","steps"],die=["ownerState"],fie=t=>{let{props:e,steps:r}=t,a=vr(t,uie);const{slots:o,slotProps:n,label:f,inputRef:m,localeText:y}=e,C=nO({steps:r}),{providerProps:w,renderCurrentView:A,ownerState:R}=Z_(Xe({},a,{props:e,localeText:y,autoFocusView:!0,viewContainerRole:"dialog",variant:"mobile",getStepNavigation:C})),I=w.privateContextValue.labelId,M=n?.toolbar?.hidden??!1,F=o.field,O=no({elementType:F,externalSlotProps:n?.field,additionalProps:Xe({},M&&{id:I}),ownerState:R}),j=vr(O,die),U=o.layout??tO;let H=I;M&&(f?H=`${I}-label`:H=void 0);const K=Xe({},n,{toolbar:Xe({},n?.toolbar,{titleId:I}),mobilePaper:Xe({"aria-labelledby":H},n?.mobilePaper)});return{renderPicker:()=>d.jsxs(U_,Xe({},w,{children:[d.jsx(F,Xe({},j,{slots:Xe({},o,j.slots),slotProps:Xe({},K,j.slotProps),inputRef:m})),d.jsx(cie,{slots:o,slotProps:K,children:d.jsx(U,Xe({},K?.layout,{slots:o,slotProps:K,children:A()}))})]}))}},EO=E.forwardRef(function(e,r){const a=Jo(),o=Y_(e,"MuiMobileDatePicker"),n=Xe({day:Vm,month:Vm,year:Vm},o.viewRenderers),f=Xe({},o,{viewRenderers:n,format:xk(a,o,!1),slots:Xe({field:gO},o.slots),slotProps:Xe({},o.slotProps,{field:y=>Xe({},Ql(o.slotProps?.field,y),V_(o)),toolbar:Xe({hidden:!1},o.slotProps?.toolbar)})}),{renderPicker:m}=fie({ref:r,props:f,valueManager:Mu,valueType:"date",validator:jb,steps:null});return m()});EO.propTypes={autoFocus:kt.bool,className:kt.string,closeOnSelect:kt.bool,dayOfWeekFormatter:kt.func,defaultValue:kt.object,disabled:kt.bool,disableFuture:kt.bool,disableHighlightToday:kt.bool,disableOpenPicker:kt.bool,disablePast:kt.bool,displayWeekNumber:kt.bool,enableAccessibleFieldDOMStructure:kt.any,fixedWeekNumber:kt.number,format:kt.string,formatDensity:kt.oneOf(["dense","spacious"]),inputRef:X3,label:kt.node,loading:kt.bool,localeText:kt.object,maxDate:kt.object,minDate:kt.object,monthsPerRow:kt.oneOf([3,4]),name:kt.string,onAccept:kt.func,onChange:kt.func,onClose:kt.func,onError:kt.func,onMonthChange:kt.func,onOpen:kt.func,onSelectedSectionsChange:kt.func,onViewChange:kt.func,onYearChange:kt.func,open:kt.bool,openTo:kt.oneOf(["day","month","year"]),orientation:kt.oneOf(["landscape","portrait"]),readOnly:kt.bool,reduceAnimations:kt.bool,referenceDate:kt.object,renderLoading:kt.func,selectedSections:kt.oneOfType([kt.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),kt.number]),shouldDisableDate:kt.func,shouldDisableMonth:kt.func,shouldDisableYear:kt.func,showDaysOutsideCurrentMonth:kt.bool,slotProps:kt.object,slots:kt.object,sx:kt.oneOfType([kt.arrayOf(kt.oneOfType([kt.func,kt.object,kt.bool])),kt.func,kt.object]),timezone:kt.string,value:kt.object,view:kt.oneOf(["day","month","year"]),viewRenderers:kt.shape({day:kt.func,month:kt.func,year:kt.func}),views:kt.arrayOf(kt.oneOf(["day","month","year"]).isRequired),yearsOrder:kt.oneOf(["asc","desc"]),yearsPerRow:kt.oneOf([3,4])};const hie=["desktopModeMediaQuery"],Gi=E.forwardRef(function(e,r){const a=Da({props:e,name:"MuiDatePicker"}),{desktopModeMediaQuery:o=Lre}=a,n=vr(a,hie);return II(o,{defaultMatches:!0})?d.jsx(AO,Xe({ref:r},n)):d.jsx(EO,Xe({ref:r},n))}),pie={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},mie={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",dayOfMonthFull:"do",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class gie{isMUIAdapter=!0;isTimezoneCompatible=!1;formatTokenMap=pie;escapedCharacters={start:"'",end:"'"};constructor(e){const{locale:r,formats:a,longFormatters:o,lib:n}=e;this.locale=r,this.formats=Xe({},mie,a),this.longFormatters=o,this.lib=n||"date-fns"}date=e=>typeof e>"u"?new Date:e===null?null:new Date(e);getInvalidDate=()=>new Date("Invalid Date");getTimezone=()=>"default";setTimezone=e=>e;toJsDate=e=>e;getCurrentLocaleCode=()=>this.locale.code;is12HourCycleInCurrentLocale=()=>/a/.test(this.locale.formatLong.time({width:"short"}));expandFormat=e=>{const r=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;return e.match(r).map(a=>{const o=a[0];if(o==="p"||o==="P"){const n=this.longFormatters[o];return n(a,this.locale.formatLong)}return a}).join("")};formatNumber=e=>e;getDayOfWeek=e=>e.getDay()+1}class TS extends gie{constructor({locale:e,formats:r}={}){super({locale:e??HA,formats:r,longFormatters:R2})}parse=(e,r)=>e===""?null:YA(e,r,new Date,{locale:this.locale});isValid=e=>e==null?!1:cP(e);format=(e,r)=>this.formatByString(e,this.formats[r]);formatByString=(e,r)=>In(e,r,{locale:this.locale});isEqual=(e,r)=>e===null&&r===null?!0:e===null||r===null?!1:cK(e,r);isSameYear=(e,r)=>iY(e,r);isSameMonth=(e,r)=>sY(e,r);isSameDay=(e,r)=>iG(e,r);isSameHour=(e,r)=>aY(e,r);isAfter=(e,r)=>yu(e,r);isAfterYear=(e,r)=>yu(e,t5(r));isAfterDay=(e,r)=>yu(e,e5(r));isBefore=(e,r)=>bu(e,r);isBeforeYear=(e,r)=>bu(e,this.startOfYear(r));isBeforeDay=(e,r)=>bu(e,this.startOfDay(r));isWithinRange=(e,[r,a])=>Ya(e,{start:r,end:a});startOfYear=e=>fP(e);startOfMonth=e=>ga(e);startOfWeek=e=>Td(e,{locale:this.locale});startOfDay=e=>tb(e);endOfYear=e=>t5(e);endOfMonth=e=>Ti(e);endOfWeek=e=>uG(e,{locale:this.locale});endOfDay=e=>e5(e);addYears=(e,r)=>sG(e,r);addMonths=(e,r)=>BC(e,r);addWeeks=(e,r)=>aG(e,r);addDays=(e,r)=>LC(e,r);addHours=(e,r)=>ZV(e,r);addMinutes=(e,r)=>rG(e,r);addSeconds=(e,r)=>oG(e,r);getYear=e=>xT(e);getMonth=e=>bP(e);getDate=e=>nK(e);getHours=e=>oK(e);getMinutes=e=>iK(e);getSeconds=e=>lK(e);getMilliseconds=e=>sK(e);setYear=(e,r)=>RY(e,r);setMonth=(e,r)=>wY(e,r);setDate=(e,r)=>TY(e,r);setHours=(e,r)=>AY(e,r);setMinutes=(e,r)=>kY(e,r);setSeconds=(e,r)=>DY(e,r);setMilliseconds=(e,r)=>EY(e,r);getDaysInMonth=e=>yP(e);getWeekArray=e=>{const r=this.startOfWeek(this.startOfMonth(e)),a=this.endOfWeek(this.endOfMonth(e));let o=0,n=r;const f=[];for(;this.isBefore(n,a);){const m=Math.floor(o/7);f[m]=f[m]||[],f[m].push(n),n=this.addDays(n,1),o+=1}return f};getWeekNumber=e=>VA(e,{locale:this.locale});getYearRange=([e,r])=>{const a=this.startOfYear(e),o=this.endOfYear(r),n=[];let f=a;for(;this.isBefore(f,o);)n.push(f),f=this.addYears(f,1);return n}}function yie(){const t=Dd(),{getPagePermissions:e}=Gf(),r=e("positions"),[a,o]=E.useState({open:!1,message:"",severity:"success"}),[n,f]=E.useState({open:!1,positionId:null}),[m,y]=E.useState(""),[C,w]=E.useState("all"),[A,R]=E.useState("all"),[I,M]=E.useState(null),O=(()=>{const te=localStorage.getItem("selectedDate");if(te)try{return new Date(JSON.parse(te))}catch{return new Date}return new Date})(),[j,U]=E.useState(ga(O)),[H,K]=E.useState(Ti(O)),W=(te,pe="success")=>{o({open:!0,message:te,severity:pe})},X=E.useMemo(()=>({startMonth:In(j,"yyyy-MM"),endMonth:In(H,"yyyy-MM")}),[j,H]),{data:ee}=zs({queryKey:["positionsCombined",X.startMonth,X.endMonth],queryFn:()=>oee(X),staleTime:1e3*60*5,refetchOnWindowFocus:!1,refetchOnReconnect:!1}),ie=ee?.positions,de=ee?.projects,le=ee?.resources,oe=ee?.allocations,N=Ua({mutationFn:te=>yee(te),onSuccess:()=>{t.invalidateQueries({queryKey:["positionsCombined"]}),W("Position created successfully!","success")},onError:te=>{W(`Error creating position: ${te.message}`,"error")}}),ce=Ua({mutationFn:({id:te,payload:pe})=>Ew(te,pe),onSuccess:()=>{t.invalidateQueries({queryKey:["positionsCombined"]}),W("Position updated successfully!","success")},onError:te=>{W(`Error updating position: ${te.message}`,"error")}}),ne=Ua({mutationFn:async({id:te,confirmed:pe})=>{if(console.log("Delete mutation called with confirmed:",pe),!pe){const J=await bee(te);if(console.log("Check deletion response:",J),J.requiresConfirmation&&J.impact)throw console.log("Showing confirmation dialog"),f({open:!0,positionId:te,impact:J.impact}),new Error("CONFIRMATION_REQUIRED");console.log("No confirmation required, position deleted");return}console.log("Proceeding with confirmed deletion"),await vee(te,!0)},onSuccess:()=>{console.log("Delete mutation onSuccess called"),t.invalidateQueries({queryKey:["positionsCombined"]}),t.invalidateQueries({queryKey:["allocations"]}),t.invalidateQueries({queryKey:["resources"]}),t.invalidateQueries({queryKey:["projects"]}),W("Position deleted successfully!","success"),f({open:!1,positionId:null})},onError:te=>{console.log("Delete mutation onError called:",te.message),te.message!=="CONFIRMATION_REQUIRED"&&W(`Error deleting position: ${te.message}`,"error")}}),Se=Ua({mutationFn:async({positionId:te,resourceId:pe,existingAllocationId:J})=>{J&&await BT(J);const fe=Re.find(st=>st.ID===te),xe=V.find(st=>st.ID===pe);if(!fe||!xe)throw new Error("Position or resource not found");let Ne=fe.LoE||0;const Me=fe?.AllocationMode?.toLowerCase()?.trim();(Me==="days"||Me==="day")&&(Ne=Math.round(fe.LoE/20*100));const Qe={PositionID:fe.ID,ProjectName:fe.ProjectName||"",PositionName:fe.PositionName,ResourceName:xe.Name,MonthYear:fe.MonthYear,AllocationMode:"%",LoE:Ne},rt=await a_(Qe);return await Ew(te,{Allocated:"Yes"}),rt},onSuccess:()=>{t.invalidateQueries({queryKey:["positionsCombined"]}),W("Position allocated successfully!","success")},onError:te=>{W(`Error allocating position: ${te.message}`,"error")}}),se=Ua({mutationFn:async({allocationId:te,positionId:pe})=>{await BT(te),pe&&await Ew(pe,{Allocated:"No"})},onSuccess:()=>{t.invalidateQueries({queryKey:["positionsCombined"]}),W("Position deallocated successfully!","success")},onError:te=>{W(`Error deallocating position: ${te.message}`,"error")}}),[ye,ze]=E.useState({Project:"",TaskID:"",Fringe_Task:"",PositionName:"",MonthYear:"",AllocationMode:"",LoE:0,Allocated:"No"}),Re=ie??[],ve=de??[],V=le??[],ue=oe??[],Ee=E.useMemo(()=>{const te=new Map;return ue.forEach(pe=>te.set(pe.PositionID,pe)),te},[ue]),Ie=E.useMemo(()=>new Set(ue.map(te=>te.PositionID)),[ue]),ae=E.useMemo(()=>{const te=new Map;return new Set(Re.map(J=>J.MonthYear).filter(Boolean)).forEach(J=>{const fe=new Date(J),xe=new Date(fe.getFullYear(),fe.getMonth(),1),Ne=new Date(fe.getFullYear(),fe.getMonth()+1,0),Ve=V.filter(Qe=>{const rt=new Date(Qe.StartDate),st=Qe.EndDate?new Date(Qe.EndDate):null;return Ya(xe,{start:rt,end:st||new Date("2099-12-31")})||Ya(Ne,{start:rt,end:st||new Date("2099-12-31")})||bu(rt,xe)&&(!st||yu(st,Ne))}).sort((Qe,rt)=>Qe.Name.localeCompare(rt.Name));te.set(J,Ve)}),te},[Re,V]),be=E.useMemo(()=>{const te=new Map;return V.forEach(pe=>te.set(pe.ID,pe)),te},[V]),[Te,tt]=E.useState(!1);E.useEffect(()=>{const te=async()=>{if(!Te)try{console.log("Running position allocation validation...");const pe=await gee();pe.changesCount>0?(console.log("Position allocation validation made changes:",pe),t.invalidateQueries({queryKey:["positionsCombined"]})):console.log("Position allocation validation: no changes needed"),tt(!0)}catch(pe){console.error("Position allocation validation failed:",pe)}};ie&&ie.length>=0&&!Te&&te()},[ie,Te,t]);const je=E.useMemo(()=>m.toLowerCase(),[m]),Pe=E.useMemo(()=>({start:j,end:H}),[j,H]),Be=E.useMemo(()=>Re.filter(te=>{const pe=te.PositionName.toLowerCase().includes(je)||te.TaskID.toLowerCase().includes(je)||te.ProjectName?.toLowerCase().includes(je),J=A==="all"||te.Project===A,fe=!te.MonthYear||Ya(new Date(te.MonthYear),Pe),xe=Ie.has(te.ID);switch(C){case"allocated":return pe&&J&&fe&&xe;case"unallocated":return pe&&J&&fe&&!xe;default:return pe&&J&&fe}}).sort((te,pe)=>{const J=te.MonthYear?new Date(te.MonthYear).getTime():0;return(pe.MonthYear?new Date(pe.MonthYear).getTime():0)-J}),[Re,je,C,A,Ie,Pe]),Fe=()=>{if(!ye.Project||!ye.TaskID||!ye.PositionName||!ye.MonthYear){W("Please fill in all required fields!","error");return}N.mutate(ye),ze({Project:"",TaskID:"",Fringe_Task:"",PositionName:"",MonthYear:"",AllocationMode:"",LoE:0,Allocated:"No"})},Ge=te=>{const J=ve.find(fe=>fe.ID===te)?.AllocationMode||"";ze({...ye,Project:te,AllocationMode:J})},Oe=te=>{if(te){const pe=te.toISOString().split("T")[0];ze({...ye,MonthYear:pe})}},mt=()=>{const te=[],J=new Date().getFullYear();for(let fe=J;fe<=J+1;fe++)for(let xe=0;xe<12;xe++){const Ne=new Date(fe,xe,1);te.push(In(Ne,"MMM yyyy"))}return te},qe=()=>{const te=mt(),pe=Array.from(new Set(Be.map(Me=>`${Me.ProjectName||Me.Project}|${Me.TaskID}|${Me.Fringe_Task||""}|${Me.PositionName}|${Me.Allocated}`))).map(Me=>{const[Ve,Qe,rt,st,it]=Me.split("|");return{project:Ve,taskId:Qe,fringeTask:rt,positionName:st,allocated:it}});let J="Project,Task ID,Fringe Task,Position Name,Allocated";te.forEach(Me=>{J+=`,${Me}`}),J+=`
`,pe.forEach(({project:Me,taskId:Ve,fringeTask:Qe,positionName:rt,allocated:st})=>{let it=`"${Me}","${Ve}","${Qe}","${rt}","${st}"`;te.forEach(xt=>{const pt=Be.find(Yt=>(Yt.ProjectName||Yt.Project)===Me&&Yt.TaskID===Ve&&(Yt.Fringe_Task||"")===Qe&&Yt.PositionName===rt&&Yt.Allocated===st&&Yt.MonthYear&&In(new Date(Yt.MonthYear),"MMM yyyy")===xt);it+=`,${pt&&pt.LoE||0}`}),J+=it+`
`});const fe=new Blob([J],{type:"text/csv"}),xe=window.URL.createObjectURL(fe),Ne=document.createElement("a");Ne.href=xe,Ne.download=`positions_table_${In(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne),window.URL.revokeObjectURL(xe),W(`Downloaded ${Be.length} filtered positions!`,"success")},Ae=te=>{const pe=te.target.files?.[0];if(!pe)return;const J=new FileReader;J.onload=fe=>{const Ne=(fe.target?.result).split(`
`);if(Ne.length<2){W("Invalid file format","error");return}const Me=Ne[0].split(",").slice(5);console.log("Month columns from CSV:",Me);const Ve=new Map;Me.forEach((rt,st)=>{Ve.set(rt.trim(),String(st))});const Qe=[];for(let rt=1;rt<Ne.length;rt++){const st=Ne[rt].trim();if(!st)continue;const it=st.match(/(".*?"|[^,]+)(?=\s*,|\s*$)/g);if(!it||it.length<5)continue;const xt=it[0].replace(/"/g,"").trim(),pt=it[1].replace(/"/g,"").trim(),Yt=it[2].replace(/"/g,"").trim(),Kt=it[3].replace(/"/g,"").trim(),tn=it[4].replace(/"/g,"").trim(),Wt=ve.find(_t=>_t.Name===xt);if(Wt)for(let _t=5;_t<it.length&&_t-5<Me.length;_t++){const at=parseFloat(it[_t].replace(/"/g,"").trim())||0;if(at>0){const Et=Me[_t-5].trim();console.log("Parsing month column:",Et);const qt=YA(Et,"MMM-yy",new Date("2000-01-01"));if(console.log("Parsed date:",qt,"Year:",qt.getFullYear(),"Month:",qt.getMonth()),isNaN(qt.getTime())){console.error("Failed to parse date:",Et);continue}const gn=qt.getFullYear(),Sn=qt.getMonth(),Zt=`${gn}-${String(Sn+1).padStart(2,"0")}-01`;console.log("ISO String:",Zt),Qe.push({Project:Wt.ID,TaskID:pt,Fringe_Task:Yt,PositionName:Kt,MonthYear:Zt,AllocationMode:Wt.AllocationMode||"%",LoE:at,Allocated:tn})}}}if(Qe.length>0){const rt=[],st=[];Qe.forEach(it=>{const xt=Re.find(pt=>pt.Project===it.Project&&pt.TaskID===it.TaskID&&pt.PositionName===it.PositionName&&pt.MonthYear&&it.MonthYear&&new Date(pt.MonthYear).getFullYear()===new Date(it.MonthYear).getFullYear()&&new Date(pt.MonthYear).getMonth()===new Date(it.MonthYear).getMonth());xt?rt.push(ce.mutateAsync({id:xt.ID,payload:{LoE:it.LoE,Allocated:it.Allocated,Fringe_Task:it.Fringe_Task,AllocationMode:it.AllocationMode}})):st.push(N.mutateAsync(it))}),Promise.all([...rt,...st]).then(()=>{const it=rt.length>0&&st.length>0?`Updated ${rt.length} and created ${st.length} positions!`:rt.length>0?`Updated ${rt.length} positions!`:`Created ${st.length} positions!`;W(it,"success")}).catch(it=>{W(`Error uploading positions: ${it.message}`,"error")})}else W("No valid positions found in file","error")},J.readAsText(pe),te.target.value=""};return d.jsx(Nb,{dateAdapter:TS,children:d.jsxs(_e,{sx:{p:2,backgroundColor:"#f8f9fa",minHeight:"100vh"},children:[d.jsxs(_e,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx(We,{variant:"h5",component:"h1",sx:{fontWeight:"bold",color:"#333"},children:"Positions"}),d.jsxs(_e,{sx:{display:"flex",gap:1,alignItems:"center"},children:[d.jsx(Un,{variant:"outlined",size:"small",startIcon:d.jsx(yp,{}),onClick:qe,disabled:Re.length===0,children:"Download Table"}),d.jsxs(Un,{variant:"outlined",size:"small",component:"label",startIcon:d.jsx(_C,{}),children:["Upload Table",d.jsx("input",{type:"file",accept:".csv",onChange:Ae,style:{display:"none"}})]}),d.jsx(Sa,{label:`${Be.length}/${Re.length}`,color:"primary",variant:"outlined",size:"small"})]})]}),r.canEdit&&d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsxs(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",mb:1,display:"block",color:"#666"},children:"ADD NEW POSITION"}),d.jsxs(_e,{sx:{display:"flex",gap:1,mb:.5,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"PROJECT *"})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"TASK ID *"})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"FRINGE TASK"})}),d.jsx(_e,{sx:{flex:"1 1 200px",minWidth:"200px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"POSITION *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"MONTH *"})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"MODE"})}),d.jsx(_e,{sx:{flex:"0 1 70px",minWidth:"70px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"LoE"})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ALLOCATED"})}),d.jsx(_e,{sx:{flex:"0 1 60px",minWidth:"60px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ACTION"})})]}),d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:1,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:ye.Project||"",displayEmpty:!0,onChange:te=>Ge(te.target.value),renderValue:te=>{if(!te)return d.jsx("em",{style:{fontSize:"0.75rem"},children:"Select project"});const pe=ve.find(J=>J.ID===te);return d.jsx("span",{style:{fontSize:"0.75rem"},children:pe?.Name||te})},sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"",children:d.jsx("em",{style:{fontSize:"0.75rem"},children:"Select project"})}),ve.map(te=>d.jsx(ln,{value:te.ID,sx:{fontSize:"0.75rem"},children:te.Name},te.ID))]})})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Task ID",value:ye.TaskID||"",onChange:te=>ze({...ye,TaskID:te.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Fringe Task",value:ye.Fringe_Task||"",onChange:te=>ze({...ye,Fringe_Task:te.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"1 1 200px",minWidth:"200px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Position name",value:ye.PositionName||"",onChange:te=>ze({...ye,PositionName:te.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(Gi,{value:ye.MonthYear?new Date(ye.MonthYear):null,onChange:te=>Oe(te),views:["year","month"],slotProps:{textField:{size:"small",placeholder:"Month",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}}})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(On,{fullWidth:!0,size:"small",value:ye.AllocationMode||"",disabled:!0,placeholder:"Auto",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 70px",minWidth:"70px"},children:d.jsx(On,{fullWidth:!0,size:"small",type:"number",placeholder:"0",value:ye.LoE||"",onChange:te=>ze({...ye,LoE:parseFloat(te.target.value)||0}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:ye.Allocated||"No",onChange:te=>ze({...ye,Allocated:te.target.value}),sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"Yes",sx:{fontSize:"0.75rem"},children:"Yes"}),d.jsx(ln,{value:"No",sx:{fontSize:"0.75rem"},children:"No"})]})})}),d.jsx(_e,{sx:{flex:"0 1 60px",minWidth:"60px"},children:d.jsx(Un,{variant:"contained",fullWidth:!0,onClick:Fe,disabled:N.isPending,startIcon:d.jsx(sg,{}),size:"small",sx:{fontSize:"0.75rem",minHeight:"32px"},children:"Add"})})]})]})}),d.jsx(Ta,{sx:{boxShadow:1},children:d.jsxs(Aa,{sx:{p:0,"&:last-child":{pb:0}},children:[d.jsx(_e,{sx:{p:2,borderBottom:1,borderColor:"divider",backgroundColor:"#fafafa"},children:d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 300px",minWidth:"250px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Search positions...",value:m,onChange:te=>y(te.target.value),InputProps:{startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(ig,{})})}})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:A,onChange:te=>R(te.target.value),startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(MC,{})}),children:[d.jsx(ln,{value:"all",children:"All Projects"}),ve.map(te=>d.jsx(ln,{value:te.ID,children:te.Name},te.ID))]})})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:C,onChange:te=>w(te.target.value),children:[d.jsx(ln,{value:"all",children:"All Positions"}),d.jsx(ln,{value:"allocated",children:"Allocated"}),d.jsx(ln,{value:"unallocated",children:"Unallocated"})]})})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Gi,{label:"From Date",value:j,onChange:te=>te&&U(te),views:["year","month"],slotProps:{textField:{size:"small",sx:{fontSize:"0.75rem"}}}})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Gi,{label:"To Date",value:H,onChange:te=>te&&K(te),views:["year","month"],slotProps:{textField:{size:"small",sx:{fontSize:"0.75rem"}}}})}),d.jsx(_e,{sx:{flex:"0 1 auto"},children:d.jsxs(We,{variant:"body2",color:"text.secondary",children:[Be.length," of ",Re.length," positions"]})})]})}),d.jsx(qa,{sx:{maxHeight:"60vh"},children:d.jsxs(Ba,{size:"small",stickyHeader:!0,sx:{"& .MuiTableCell-root":{py:.5}},children:[d.jsx(wa,{children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Project"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Task ID"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Fringe Task"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Position"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Month"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Mode"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"LoE"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Allocated"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Resource"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5,textAlign:"center"},children:"Actions"})]})}),d.jsx(za,{children:Be.length===0?d.jsx(hn,{children:d.jsx(Q,{colSpan:10,align:"center",sx:{py:2},children:d.jsx(We,{variant:"body2",color:"text.secondary",children:Re.length===0?"No positions found. Create your first position above!":"No positions match your filters."})})}):Be.map(te=>d.jsxs(hn,{hover:!0,sx:{"&:hover":{backgroundColor:"#f8f9fa"}},children:[d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:te.ProjectName||te.Project})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:te.TaskID})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:te.Fringe_Task})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:te.PositionName})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:te.MonthYear?In(new Date(te.MonthYear),"MMM yyyy"):"No month"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:te.AllocationMode||"Auto"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:te.LoE||0})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:Ie.has(te.ID)?"Yes":"No"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:Ee.get(te.ID)?.ResourceID||"",displayEmpty:!0,onChange:pe=>{const J=Ee.get(te.ID);pe.target.value===""?J&&se.mutate({positionId:te.ID,allocationId:J.ID}):Se.mutate({positionId:te.ID,resourceId:pe.target.value,existingAllocationId:J?.ID})},renderValue:pe=>{if(!pe)return d.jsx("span",{style:{fontSize:"0.75rem"},children:"Select resource"});const J=be.get(pe);return d.jsx("span",{style:{fontSize:"0.75rem"},children:J?.Name||pe})},sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"",children:d.jsx("em",{style:{fontSize:"0.75rem"},children:"Clear allocation"})}),(te.MonthYear?ae.get(te.MonthYear)||[]:[]).map(pe=>d.jsx(ln,{value:pe.ID,sx:{fontSize:"0.75rem"},children:pe.Name},pe.ID))]})})}),d.jsx(Q,{sx:{p:.5,textAlign:"center"},children:d.jsxs(_e,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:[r.canEdit&&d.jsx(_r,{size:"small",color:"primary",onClick:()=>M(te),disabled:ce.isPending,children:d.jsx(bp,{fontSize:"small"})}),r.canDelete&&d.jsx(_r,{size:"small",color:"error",onClick:()=>ne.mutate({id:te.ID,confirmed:!1}),disabled:ne.isPending,children:d.jsx(Rp,{fontSize:"small"})})]})})]},te.ID))})]})})]})}),d.jsx(Wf,{open:a.open,autoHideDuration:4e3,onClose:()=>o({...a,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:d.jsx(Hs,{onClose:()=>o({...a,open:!1}),severity:a.severity,sx:{width:"100%"},children:a.message})}),d.jsxs(oi,{open:!!I,onClose:()=>M(null),maxWidth:"md",fullWidth:!0,children:[d.jsx(Ii,{children:"Edit Position"}),d.jsx(ai,{children:I&&d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[d.jsx(Hr,{fullWidth:!0,children:d.jsxs(Wr,{value:I.Project||"",onChange:te=>{const J=ve.find(fe=>fe.ID===te.target.value)?.AllocationMode||"";ce.mutate({id:I.ID,payload:{Project:String(te.target.value),AllocationMode:J}})},children:[d.jsx(ln,{value:"",children:"Select Project"}),ve.map(te=>d.jsx(ln,{value:te.ID,children:te.Name},te.ID))]})}),d.jsx(On,{label:"Task ID",fullWidth:!0,defaultValue:I.TaskID,onBlur:te=>{te.target.value!==I.TaskID&&ce.mutate({id:I.ID,payload:{TaskID:te.target.value}})}}),d.jsx(On,{label:"Fringe Task",fullWidth:!0,defaultValue:I.Fringe_Task||"",onBlur:te=>{te.target.value!==(I.Fringe_Task||"")&&ce.mutate({id:I.ID,payload:{Fringe_Task:te.target.value}})}}),d.jsx(On,{label:"Position Name",fullWidth:!0,defaultValue:I.PositionName,onBlur:te=>{te.target.value!==I.PositionName&&ce.mutate({id:I.ID,payload:{PositionName:te.target.value}})}}),d.jsx(Gi,{label:"Month",value:I.MonthYear?new Date(I.MonthYear):null,onChange:te=>{if(te){const pe=te.toISOString().split("T")[0];ce.mutate({id:I.ID,payload:{MonthYear:pe}})}},views:["year","month"]}),d.jsx(On,{label:"LoE",type:"number",fullWidth:!0,defaultValue:I.LoE||0,onBlur:te=>{const pe=parseFloat(te.target.value)||0;pe!==(I.LoE||0)&&ce.mutate({id:I.ID,payload:{LoE:pe}})}}),d.jsx(Hr,{fullWidth:!0,children:d.jsxs(Wr,{value:I.Allocated||"No",onChange:te=>{ce.mutate({id:I.ID,payload:{Allocated:String(te.target.value)}})},children:[d.jsx(ln,{value:"Yes",children:"Yes"}),d.jsx(ln,{value:"No",children:"No"})]})})]})}),d.jsx(tl,{children:d.jsx(Un,{onClick:()=>M(null),children:"Close"})})]}),d.jsxs(oi,{open:n.open,onClose:()=>f({open:!1,positionId:null}),maxWidth:"sm",fullWidth:!0,children:[d.jsx(Ii,{children:"Confirm Position Deletion"}),d.jsx(ai,{children:n.impact&&d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[d.jsxs(Hs,{severity:"warning",children:[d.jsx(We,{variant:"body2",sx:{mb:1},children:d.jsx("strong",{children:n.impact.message})}),d.jsxs(We,{variant:"body2",children:[d.jsx("strong",{children:"Position:"})," ",n.impact.positionName]}),d.jsxs(We,{variant:"body2",children:[d.jsx("strong",{children:"Project:"})," ",n.impact.projectName]}),d.jsxs(We,{variant:"body2",children:[d.jsx("strong",{children:"Affected Resources:"})," ",n.impact.resourceNames]})]}),d.jsx(We,{variant:"body2",color:"text.secondary",children:"Are you sure you want to delete this position? This action cannot be undone."})]})}),d.jsxs(tl,{children:[d.jsx(Un,{onClick:()=>f({open:!1,positionId:null}),color:"inherit",children:"Cancel"}),d.jsx(Un,{onClick:()=>{n.positionId&&ne.mutate({id:n.positionId,confirmed:!0})},color:"error",variant:"contained",disabled:ne.isPending,children:"Delete Position"})]})]})]})})}function d2(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $x={exports:{}},f2={exports:{}};var bie=f2.exports,KR;function vie(){return KR||(KR=1,(function(t){var e={version:"1.15.0"};e[437]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[620]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[737]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[850]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[852]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[857]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[861]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[865]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[866]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[874]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[895]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[932]=(function(){var r=[],a={},o=[],n;for(o[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=o[0].length;++n)o[0][n].charCodeAt(0)!==65533&&(a[o[0][n]]=0+n,r[0+n]=o[0][n]);for(o[129]="".split(""),n=0;n!=o[129].length;++n)o[129][n].charCodeAt(0)!==65533&&(a[o[129][n]]=33024+n,r[33024+n]=o[129][n]);for(o[130]="".split(""),n=0;n!=o[130].length;++n)o[130][n].charCodeAt(0)!==65533&&(a[o[130][n]]=33280+n,r[33280+n]=o[130][n]);for(o[131]="".split(""),n=0;n!=o[131].length;++n)o[131][n].charCodeAt(0)!==65533&&(a[o[131][n]]=33536+n,r[33536+n]=o[131][n]);for(o[132]="".split(""),n=0;n!=o[132].length;++n)o[132][n].charCodeAt(0)!==65533&&(a[o[132][n]]=33792+n,r[33792+n]=o[132][n]);for(o[135]="".split(""),n=0;n!=o[135].length;++n)o[135][n].charCodeAt(0)!==65533&&(a[o[135][n]]=34560+n,r[34560+n]=o[135][n]);for(o[136]="".split(""),n=0;n!=o[136].length;++n)o[136][n].charCodeAt(0)!==65533&&(a[o[136][n]]=34816+n,r[34816+n]=o[136][n]);for(o[137]="".split(""),n=0;n!=o[137].length;++n)o[137][n].charCodeAt(0)!==65533&&(a[o[137][n]]=35072+n,r[35072+n]=o[137][n]);for(o[138]="".split(""),n=0;n!=o[138].length;++n)o[138][n].charCodeAt(0)!==65533&&(a[o[138][n]]=35328+n,r[35328+n]=o[138][n]);for(o[139]="".split(""),n=0;n!=o[139].length;++n)o[139][n].charCodeAt(0)!==65533&&(a[o[139][n]]=35584+n,r[35584+n]=o[139][n]);for(o[140]="".split(""),n=0;n!=o[140].length;++n)o[140][n].charCodeAt(0)!==65533&&(a[o[140][n]]=35840+n,r[35840+n]=o[140][n]);for(o[141]="".split(""),n=0;n!=o[141].length;++n)o[141][n].charCodeAt(0)!==65533&&(a[o[141][n]]=36096+n,r[36096+n]=o[141][n]);for(o[142]="".split(""),n=0;n!=o[142].length;++n)o[142][n].charCodeAt(0)!==65533&&(a[o[142][n]]=36352+n,r[36352+n]=o[142][n]);for(o[143]="".split(""),n=0;n!=o[143].length;++n)o[143][n].charCodeAt(0)!==65533&&(a[o[143][n]]=36608+n,r[36608+n]=o[143][n]);for(o[144]="".split(""),n=0;n!=o[144].length;++n)o[144][n].charCodeAt(0)!==65533&&(a[o[144][n]]=36864+n,r[36864+n]=o[144][n]);for(o[145]="".split(""),n=0;n!=o[145].length;++n)o[145][n].charCodeAt(0)!==65533&&(a[o[145][n]]=37120+n,r[37120+n]=o[145][n]);for(o[146]="".split(""),n=0;n!=o[146].length;++n)o[146][n].charCodeAt(0)!==65533&&(a[o[146][n]]=37376+n,r[37376+n]=o[146][n]);for(o[147]="".split(""),n=0;n!=o[147].length;++n)o[147][n].charCodeAt(0)!==65533&&(a[o[147][n]]=37632+n,r[37632+n]=o[147][n]);for(o[148]="".split(""),n=0;n!=o[148].length;++n)o[148][n].charCodeAt(0)!==65533&&(a[o[148][n]]=37888+n,r[37888+n]=o[148][n]);for(o[149]="".split(""),n=0;n!=o[149].length;++n)o[149][n].charCodeAt(0)!==65533&&(a[o[149][n]]=38144+n,r[38144+n]=o[149][n]);for(o[150]="".split(""),n=0;n!=o[150].length;++n)o[150][n].charCodeAt(0)!==65533&&(a[o[150][n]]=38400+n,r[38400+n]=o[150][n]);for(o[151]="".split(""),n=0;n!=o[151].length;++n)o[151][n].charCodeAt(0)!==65533&&(a[o[151][n]]=38656+n,r[38656+n]=o[151][n]);for(o[152]="".split(""),n=0;n!=o[152].length;++n)o[152][n].charCodeAt(0)!==65533&&(a[o[152][n]]=38912+n,r[38912+n]=o[152][n]);for(o[153]="".split(""),n=0;n!=o[153].length;++n)o[153][n].charCodeAt(0)!==65533&&(a[o[153][n]]=39168+n,r[39168+n]=o[153][n]);for(o[154]="".split(""),n=0;n!=o[154].length;++n)o[154][n].charCodeAt(0)!==65533&&(a[o[154][n]]=39424+n,r[39424+n]=o[154][n]);for(o[155]="".split(""),n=0;n!=o[155].length;++n)o[155][n].charCodeAt(0)!==65533&&(a[o[155][n]]=39680+n,r[39680+n]=o[155][n]);for(o[156]="".split(""),n=0;n!=o[156].length;++n)o[156][n].charCodeAt(0)!==65533&&(a[o[156][n]]=39936+n,r[39936+n]=o[156][n]);for(o[157]="".split(""),n=0;n!=o[157].length;++n)o[157][n].charCodeAt(0)!==65533&&(a[o[157][n]]=40192+n,r[40192+n]=o[157][n]);for(o[158]="".split(""),n=0;n!=o[158].length;++n)o[158][n].charCodeAt(0)!==65533&&(a[o[158][n]]=40448+n,r[40448+n]=o[158][n]);for(o[159]="".split(""),n=0;n!=o[159].length;++n)o[159][n].charCodeAt(0)!==65533&&(a[o[159][n]]=40704+n,r[40704+n]=o[159][n]);for(o[224]="".split(""),n=0;n!=o[224].length;++n)o[224][n].charCodeAt(0)!==65533&&(a[o[224][n]]=57344+n,r[57344+n]=o[224][n]);for(o[225]="".split(""),n=0;n!=o[225].length;++n)o[225][n].charCodeAt(0)!==65533&&(a[o[225][n]]=57600+n,r[57600+n]=o[225][n]);for(o[226]="".split(""),n=0;n!=o[226].length;++n)o[226][n].charCodeAt(0)!==65533&&(a[o[226][n]]=57856+n,r[57856+n]=o[226][n]);for(o[227]="".split(""),n=0;n!=o[227].length;++n)o[227][n].charCodeAt(0)!==65533&&(a[o[227][n]]=58112+n,r[58112+n]=o[227][n]);for(o[228]="".split(""),n=0;n!=o[228].length;++n)o[228][n].charCodeAt(0)!==65533&&(a[o[228][n]]=58368+n,r[58368+n]=o[228][n]);for(o[229]="".split(""),n=0;n!=o[229].length;++n)o[229][n].charCodeAt(0)!==65533&&(a[o[229][n]]=58624+n,r[58624+n]=o[229][n]);for(o[230]="".split(""),n=0;n!=o[230].length;++n)o[230][n].charCodeAt(0)!==65533&&(a[o[230][n]]=58880+n,r[58880+n]=o[230][n]);for(o[231]="".split(""),n=0;n!=o[231].length;++n)o[231][n].charCodeAt(0)!==65533&&(a[o[231][n]]=59136+n,r[59136+n]=o[231][n]);for(o[232]="".split(""),n=0;n!=o[232].length;++n)o[232][n].charCodeAt(0)!==65533&&(a[o[232][n]]=59392+n,r[59392+n]=o[232][n]);for(o[233]="".split(""),n=0;n!=o[233].length;++n)o[233][n].charCodeAt(0)!==65533&&(a[o[233][n]]=59648+n,r[59648+n]=o[233][n]);for(o[234]="".split(""),n=0;n!=o[234].length;++n)o[234][n].charCodeAt(0)!==65533&&(a[o[234][n]]=59904+n,r[59904+n]=o[234][n]);for(o[237]="".split(""),n=0;n!=o[237].length;++n)o[237][n].charCodeAt(0)!==65533&&(a[o[237][n]]=60672+n,r[60672+n]=o[237][n]);for(o[238]="".split(""),n=0;n!=o[238].length;++n)o[238][n].charCodeAt(0)!==65533&&(a[o[238][n]]=60928+n,r[60928+n]=o[238][n]);for(o[250]="".split(""),n=0;n!=o[250].length;++n)o[250][n].charCodeAt(0)!==65533&&(a[o[250][n]]=64e3+n,r[64e3+n]=o[250][n]);for(o[251]="".split(""),n=0;n!=o[251].length;++n)o[251][n].charCodeAt(0)!==65533&&(a[o[251][n]]=64256+n,r[64256+n]=o[251][n]);for(o[252]="".split(""),n=0;n!=o[252].length;++n)o[252][n].charCodeAt(0)!==65533&&(a[o[252][n]]=64512+n,r[64512+n]=o[252][n]);return{enc:a,dec:r}})(),e[936]=(function(){var r=[],a={},o=[],n;for(o[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=o[0].length;++n)o[0][n].charCodeAt(0)!==65533&&(a[o[0][n]]=0+n,r[0+n]=o[0][n]);for(o[129]="".split(""),n=0;n!=o[129].length;++n)o[129][n].charCodeAt(0)!==65533&&(a[o[129][n]]=33024+n,r[33024+n]=o[129][n]);for(o[130]="".split(""),n=0;n!=o[130].length;++n)o[130][n].charCodeAt(0)!==65533&&(a[o[130][n]]=33280+n,r[33280+n]=o[130][n]);for(o[131]="".split(""),n=0;n!=o[131].length;++n)o[131][n].charCodeAt(0)!==65533&&(a[o[131][n]]=33536+n,r[33536+n]=o[131][n]);for(o[132]="".split(""),n=0;n!=o[132].length;++n)o[132][n].charCodeAt(0)!==65533&&(a[o[132][n]]=33792+n,r[33792+n]=o[132][n]);for(o[133]="".split(""),n=0;n!=o[133].length;++n)o[133][n].charCodeAt(0)!==65533&&(a[o[133][n]]=34048+n,r[34048+n]=o[133][n]);for(o[134]="".split(""),n=0;n!=o[134].length;++n)o[134][n].charCodeAt(0)!==65533&&(a[o[134][n]]=34304+n,r[34304+n]=o[134][n]);for(o[135]="".split(""),n=0;n!=o[135].length;++n)o[135][n].charCodeAt(0)!==65533&&(a[o[135][n]]=34560+n,r[34560+n]=o[135][n]);for(o[136]="".split(""),n=0;n!=o[136].length;++n)o[136][n].charCodeAt(0)!==65533&&(a[o[136][n]]=34816+n,r[34816+n]=o[136][n]);for(o[137]="".split(""),n=0;n!=o[137].length;++n)o[137][n].charCodeAt(0)!==65533&&(a[o[137][n]]=35072+n,r[35072+n]=o[137][n]);for(o[138]="".split(""),n=0;n!=o[138].length;++n)o[138][n].charCodeAt(0)!==65533&&(a[o[138][n]]=35328+n,r[35328+n]=o[138][n]);for(o[139]="".split(""),n=0;n!=o[139].length;++n)o[139][n].charCodeAt(0)!==65533&&(a[o[139][n]]=35584+n,r[35584+n]=o[139][n]);for(o[140]="".split(""),n=0;n!=o[140].length;++n)o[140][n].charCodeAt(0)!==65533&&(a[o[140][n]]=35840+n,r[35840+n]=o[140][n]);for(o[141]="".split(""),n=0;n!=o[141].length;++n)o[141][n].charCodeAt(0)!==65533&&(a[o[141][n]]=36096+n,r[36096+n]=o[141][n]);for(o[142]="".split(""),n=0;n!=o[142].length;++n)o[142][n].charCodeAt(0)!==65533&&(a[o[142][n]]=36352+n,r[36352+n]=o[142][n]);for(o[143]="".split(""),n=0;n!=o[143].length;++n)o[143][n].charCodeAt(0)!==65533&&(a[o[143][n]]=36608+n,r[36608+n]=o[143][n]);for(o[144]="".split(""),n=0;n!=o[144].length;++n)o[144][n].charCodeAt(0)!==65533&&(a[o[144][n]]=36864+n,r[36864+n]=o[144][n]);for(o[145]="".split(""),n=0;n!=o[145].length;++n)o[145][n].charCodeAt(0)!==65533&&(a[o[145][n]]=37120+n,r[37120+n]=o[145][n]);for(o[146]="".split(""),n=0;n!=o[146].length;++n)o[146][n].charCodeAt(0)!==65533&&(a[o[146][n]]=37376+n,r[37376+n]=o[146][n]);for(o[147]="".split(""),n=0;n!=o[147].length;++n)o[147][n].charCodeAt(0)!==65533&&(a[o[147][n]]=37632+n,r[37632+n]=o[147][n]);for(o[148]="".split(""),n=0;n!=o[148].length;++n)o[148][n].charCodeAt(0)!==65533&&(a[o[148][n]]=37888+n,r[37888+n]=o[148][n]);for(o[149]="".split(""),n=0;n!=o[149].length;++n)o[149][n].charCodeAt(0)!==65533&&(a[o[149][n]]=38144+n,r[38144+n]=o[149][n]);for(o[150]="".split(""),n=0;n!=o[150].length;++n)o[150][n].charCodeAt(0)!==65533&&(a[o[150][n]]=38400+n,r[38400+n]=o[150][n]);for(o[151]="".split(""),n=0;n!=o[151].length;++n)o[151][n].charCodeAt(0)!==65533&&(a[o[151][n]]=38656+n,r[38656+n]=o[151][n]);for(o[152]="".split(""),n=0;n!=o[152].length;++n)o[152][n].charCodeAt(0)!==65533&&(a[o[152][n]]=38912+n,r[38912+n]=o[152][n]);for(o[153]="".split(""),n=0;n!=o[153].length;++n)o[153][n].charCodeAt(0)!==65533&&(a[o[153][n]]=39168+n,r[39168+n]=o[153][n]);for(o[154]="".split(""),n=0;n!=o[154].length;++n)o[154][n].charCodeAt(0)!==65533&&(a[o[154][n]]=39424+n,r[39424+n]=o[154][n]);for(o[155]="".split(""),n=0;n!=o[155].length;++n)o[155][n].charCodeAt(0)!==65533&&(a[o[155][n]]=39680+n,r[39680+n]=o[155][n]);for(o[156]="".split(""),n=0;n!=o[156].length;++n)o[156][n].charCodeAt(0)!==65533&&(a[o[156][n]]=39936+n,r[39936+n]=o[156][n]);for(o[157]="".split(""),n=0;n!=o[157].length;++n)o[157][n].charCodeAt(0)!==65533&&(a[o[157][n]]=40192+n,r[40192+n]=o[157][n]);for(o[158]="".split(""),n=0;n!=o[158].length;++n)o[158][n].charCodeAt(0)!==65533&&(a[o[158][n]]=40448+n,r[40448+n]=o[158][n]);for(o[159]="".split(""),n=0;n!=o[159].length;++n)o[159][n].charCodeAt(0)!==65533&&(a[o[159][n]]=40704+n,r[40704+n]=o[159][n]);for(o[160]="".split(""),n=0;n!=o[160].length;++n)o[160][n].charCodeAt(0)!==65533&&(a[o[160][n]]=40960+n,r[40960+n]=o[160][n]);for(o[161]="".split(""),n=0;n!=o[161].length;++n)o[161][n].charCodeAt(0)!==65533&&(a[o[161][n]]=41216+n,r[41216+n]=o[161][n]);for(o[162]="".split(""),n=0;n!=o[162].length;++n)o[162][n].charCodeAt(0)!==65533&&(a[o[162][n]]=41472+n,r[41472+n]=o[162][n]);for(o[163]="".split(""),n=0;n!=o[163].length;++n)o[163][n].charCodeAt(0)!==65533&&(a[o[163][n]]=41728+n,r[41728+n]=o[163][n]);for(o[164]="".split(""),n=0;n!=o[164].length;++n)o[164][n].charCodeAt(0)!==65533&&(a[o[164][n]]=41984+n,r[41984+n]=o[164][n]);for(o[165]="".split(""),n=0;n!=o[165].length;++n)o[165][n].charCodeAt(0)!==65533&&(a[o[165][n]]=42240+n,r[42240+n]=o[165][n]);for(o[166]="".split(""),n=0;n!=o[166].length;++n)o[166][n].charCodeAt(0)!==65533&&(a[o[166][n]]=42496+n,r[42496+n]=o[166][n]);for(o[167]="".split(""),n=0;n!=o[167].length;++n)o[167][n].charCodeAt(0)!==65533&&(a[o[167][n]]=42752+n,r[42752+n]=o[167][n]);for(o[168]="".split(""),n=0;n!=o[168].length;++n)o[168][n].charCodeAt(0)!==65533&&(a[o[168][n]]=43008+n,r[43008+n]=o[168][n]);for(o[169]="".split(""),n=0;n!=o[169].length;++n)o[169][n].charCodeAt(0)!==65533&&(a[o[169][n]]=43264+n,r[43264+n]=o[169][n]);for(o[170]="".split(""),n=0;n!=o[170].length;++n)o[170][n].charCodeAt(0)!==65533&&(a[o[170][n]]=43520+n,r[43520+n]=o[170][n]);for(o[171]="".split(""),n=0;n!=o[171].length;++n)o[171][n].charCodeAt(0)!==65533&&(a[o[171][n]]=43776+n,r[43776+n]=o[171][n]);for(o[172]="".split(""),n=0;n!=o[172].length;++n)o[172][n].charCodeAt(0)!==65533&&(a[o[172][n]]=44032+n,r[44032+n]=o[172][n]);for(o[173]="".split(""),n=0;n!=o[173].length;++n)o[173][n].charCodeAt(0)!==65533&&(a[o[173][n]]=44288+n,r[44288+n]=o[173][n]);for(o[174]="".split(""),n=0;n!=o[174].length;++n)o[174][n].charCodeAt(0)!==65533&&(a[o[174][n]]=44544+n,r[44544+n]=o[174][n]);for(o[175]="".split(""),n=0;n!=o[175].length;++n)o[175][n].charCodeAt(0)!==65533&&(a[o[175][n]]=44800+n,r[44800+n]=o[175][n]);for(o[176]="".split(""),n=0;n!=o[176].length;++n)o[176][n].charCodeAt(0)!==65533&&(a[o[176][n]]=45056+n,r[45056+n]=o[176][n]);for(o[177]="".split(""),n=0;n!=o[177].length;++n)o[177][n].charCodeAt(0)!==65533&&(a[o[177][n]]=45312+n,r[45312+n]=o[177][n]);for(o[178]="".split(""),n=0;n!=o[178].length;++n)o[178][n].charCodeAt(0)!==65533&&(a[o[178][n]]=45568+n,r[45568+n]=o[178][n]);for(o[179]="".split(""),n=0;n!=o[179].length;++n)o[179][n].charCodeAt(0)!==65533&&(a[o[179][n]]=45824+n,r[45824+n]=o[179][n]);for(o[180]="".split(""),n=0;n!=o[180].length;++n)o[180][n].charCodeAt(0)!==65533&&(a[o[180][n]]=46080+n,r[46080+n]=o[180][n]);for(o[181]="".split(""),n=0;n!=o[181].length;++n)o[181][n].charCodeAt(0)!==65533&&(a[o[181][n]]=46336+n,r[46336+n]=o[181][n]);for(o[182]="".split(""),n=0;n!=o[182].length;++n)o[182][n].charCodeAt(0)!==65533&&(a[o[182][n]]=46592+n,r[46592+n]=o[182][n]);for(o[183]="".split(""),n=0;n!=o[183].length;++n)o[183][n].charCodeAt(0)!==65533&&(a[o[183][n]]=46848+n,r[46848+n]=o[183][n]);for(o[184]="".split(""),n=0;n!=o[184].length;++n)o[184][n].charCodeAt(0)!==65533&&(a[o[184][n]]=47104+n,r[47104+n]=o[184][n]);for(o[185]="".split(""),n=0;n!=o[185].length;++n)o[185][n].charCodeAt(0)!==65533&&(a[o[185][n]]=47360+n,r[47360+n]=o[185][n]);for(o[186]="".split(""),n=0;n!=o[186].length;++n)o[186][n].charCodeAt(0)!==65533&&(a[o[186][n]]=47616+n,r[47616+n]=o[186][n]);for(o[187]="".split(""),n=0;n!=o[187].length;++n)o[187][n].charCodeAt(0)!==65533&&(a[o[187][n]]=47872+n,r[47872+n]=o[187][n]);for(o[188]="".split(""),n=0;n!=o[188].length;++n)o[188][n].charCodeAt(0)!==65533&&(a[o[188][n]]=48128+n,r[48128+n]=o[188][n]);for(o[189]="".split(""),n=0;n!=o[189].length;++n)o[189][n].charCodeAt(0)!==65533&&(a[o[189][n]]=48384+n,r[48384+n]=o[189][n]);for(o[190]="".split(""),n=0;n!=o[190].length;++n)o[190][n].charCodeAt(0)!==65533&&(a[o[190][n]]=48640+n,r[48640+n]=o[190][n]);for(o[191]="".split(""),n=0;n!=o[191].length;++n)o[191][n].charCodeAt(0)!==65533&&(a[o[191][n]]=48896+n,r[48896+n]=o[191][n]);for(o[192]="".split(""),n=0;n!=o[192].length;++n)o[192][n].charCodeAt(0)!==65533&&(a[o[192][n]]=49152+n,r[49152+n]=o[192][n]);for(o[193]="".split(""),n=0;n!=o[193].length;++n)o[193][n].charCodeAt(0)!==65533&&(a[o[193][n]]=49408+n,r[49408+n]=o[193][n]);for(o[194]="".split(""),n=0;n!=o[194].length;++n)o[194][n].charCodeAt(0)!==65533&&(a[o[194][n]]=49664+n,r[49664+n]=o[194][n]);for(o[195]="".split(""),n=0;n!=o[195].length;++n)o[195][n].charCodeAt(0)!==65533&&(a[o[195][n]]=49920+n,r[49920+n]=o[195][n]);for(o[196]="".split(""),n=0;n!=o[196].length;++n)o[196][n].charCodeAt(0)!==65533&&(a[o[196][n]]=50176+n,r[50176+n]=o[196][n]);for(o[197]="".split(""),n=0;n!=o[197].length;++n)o[197][n].charCodeAt(0)!==65533&&(a[o[197][n]]=50432+n,r[50432+n]=o[197][n]);for(o[198]="".split(""),n=0;n!=o[198].length;++n)o[198][n].charCodeAt(0)!==65533&&(a[o[198][n]]=50688+n,r[50688+n]=o[198][n]);for(o[199]="".split(""),n=0;n!=o[199].length;++n)o[199][n].charCodeAt(0)!==65533&&(a[o[199][n]]=50944+n,r[50944+n]=o[199][n]);for(o[200]="".split(""),n=0;n!=o[200].length;++n)o[200][n].charCodeAt(0)!==65533&&(a[o[200][n]]=51200+n,r[51200+n]=o[200][n]);for(o[201]="".split(""),n=0;n!=o[201].length;++n)o[201][n].charCodeAt(0)!==65533&&(a[o[201][n]]=51456+n,r[51456+n]=o[201][n]);for(o[202]="".split(""),n=0;n!=o[202].length;++n)o[202][n].charCodeAt(0)!==65533&&(a[o[202][n]]=51712+n,r[51712+n]=o[202][n]);for(o[203]="".split(""),n=0;n!=o[203].length;++n)o[203][n].charCodeAt(0)!==65533&&(a[o[203][n]]=51968+n,r[51968+n]=o[203][n]);for(o[204]="".split(""),n=0;n!=o[204].length;++n)o[204][n].charCodeAt(0)!==65533&&(a[o[204][n]]=52224+n,r[52224+n]=o[204][n]);for(o[205]="".split(""),n=0;n!=o[205].length;++n)o[205][n].charCodeAt(0)!==65533&&(a[o[205][n]]=52480+n,r[52480+n]=o[205][n]);for(o[206]="".split(""),n=0;n!=o[206].length;++n)o[206][n].charCodeAt(0)!==65533&&(a[o[206][n]]=52736+n,r[52736+n]=o[206][n]);for(o[207]="".split(""),n=0;n!=o[207].length;++n)o[207][n].charCodeAt(0)!==65533&&(a[o[207][n]]=52992+n,r[52992+n]=o[207][n]);for(o[208]="".split(""),n=0;n!=o[208].length;++n)o[208][n].charCodeAt(0)!==65533&&(a[o[208][n]]=53248+n,r[53248+n]=o[208][n]);for(o[209]="".split(""),n=0;n!=o[209].length;++n)o[209][n].charCodeAt(0)!==65533&&(a[o[209][n]]=53504+n,r[53504+n]=o[209][n]);for(o[210]="".split(""),n=0;n!=o[210].length;++n)o[210][n].charCodeAt(0)!==65533&&(a[o[210][n]]=53760+n,r[53760+n]=o[210][n]);for(o[211]="".split(""),n=0;n!=o[211].length;++n)o[211][n].charCodeAt(0)!==65533&&(a[o[211][n]]=54016+n,r[54016+n]=o[211][n]);for(o[212]="".split(""),n=0;n!=o[212].length;++n)o[212][n].charCodeAt(0)!==65533&&(a[o[212][n]]=54272+n,r[54272+n]=o[212][n]);for(o[213]="".split(""),n=0;n!=o[213].length;++n)o[213][n].charCodeAt(0)!==65533&&(a[o[213][n]]=54528+n,r[54528+n]=o[213][n]);for(o[214]="".split(""),n=0;n!=o[214].length;++n)o[214][n].charCodeAt(0)!==65533&&(a[o[214][n]]=54784+n,r[54784+n]=o[214][n]);for(o[215]="".split(""),n=0;n!=o[215].length;++n)o[215][n].charCodeAt(0)!==65533&&(a[o[215][n]]=55040+n,r[55040+n]=o[215][n]);for(o[216]="".split(""),n=0;n!=o[216].length;++n)o[216][n].charCodeAt(0)!==65533&&(a[o[216][n]]=55296+n,r[55296+n]=o[216][n]);for(o[217]="".split(""),n=0;n!=o[217].length;++n)o[217][n].charCodeAt(0)!==65533&&(a[o[217][n]]=55552+n,r[55552+n]=o[217][n]);for(o[218]="".split(""),n=0;n!=o[218].length;++n)o[218][n].charCodeAt(0)!==65533&&(a[o[218][n]]=55808+n,r[55808+n]=o[218][n]);for(o[219]="".split(""),n=0;n!=o[219].length;++n)o[219][n].charCodeAt(0)!==65533&&(a[o[219][n]]=56064+n,r[56064+n]=o[219][n]);for(o[220]="".split(""),n=0;n!=o[220].length;++n)o[220][n].charCodeAt(0)!==65533&&(a[o[220][n]]=56320+n,r[56320+n]=o[220][n]);for(o[221]="".split(""),n=0;n!=o[221].length;++n)o[221][n].charCodeAt(0)!==65533&&(a[o[221][n]]=56576+n,r[56576+n]=o[221][n]);for(o[222]="".split(""),n=0;n!=o[222].length;++n)o[222][n].charCodeAt(0)!==65533&&(a[o[222][n]]=56832+n,r[56832+n]=o[222][n]);for(o[223]="".split(""),n=0;n!=o[223].length;++n)o[223][n].charCodeAt(0)!==65533&&(a[o[223][n]]=57088+n,r[57088+n]=o[223][n]);for(o[224]="".split(""),n=0;n!=o[224].length;++n)o[224][n].charCodeAt(0)!==65533&&(a[o[224][n]]=57344+n,r[57344+n]=o[224][n]);for(o[225]="".split(""),n=0;n!=o[225].length;++n)o[225][n].charCodeAt(0)!==65533&&(a[o[225][n]]=57600+n,r[57600+n]=o[225][n]);for(o[226]="".split(""),n=0;n!=o[226].length;++n)o[226][n].charCodeAt(0)!==65533&&(a[o[226][n]]=57856+n,r[57856+n]=o[226][n]);for(o[227]="".split(""),n=0;n!=o[227].length;++n)o[227][n].charCodeAt(0)!==65533&&(a[o[227][n]]=58112+n,r[58112+n]=o[227][n]);for(o[228]="".split(""),n=0;n!=o[228].length;++n)o[228][n].charCodeAt(0)!==65533&&(a[o[228][n]]=58368+n,r[58368+n]=o[228][n]);for(o[229]="".split(""),n=0;n!=o[229].length;++n)o[229][n].charCodeAt(0)!==65533&&(a[o[229][n]]=58624+n,r[58624+n]=o[229][n]);for(o[230]="".split(""),n=0;n!=o[230].length;++n)o[230][n].charCodeAt(0)!==65533&&(a[o[230][n]]=58880+n,r[58880+n]=o[230][n]);for(o[231]="".split(""),n=0;n!=o[231].length;++n)o[231][n].charCodeAt(0)!==65533&&(a[o[231][n]]=59136+n,r[59136+n]=o[231][n]);for(o[232]="".split(""),n=0;n!=o[232].length;++n)o[232][n].charCodeAt(0)!==65533&&(a[o[232][n]]=59392+n,r[59392+n]=o[232][n]);for(o[233]="".split(""),n=0;n!=o[233].length;++n)o[233][n].charCodeAt(0)!==65533&&(a[o[233][n]]=59648+n,r[59648+n]=o[233][n]);for(o[234]="".split(""),n=0;n!=o[234].length;++n)o[234][n].charCodeAt(0)!==65533&&(a[o[234][n]]=59904+n,r[59904+n]=o[234][n]);for(o[235]="".split(""),n=0;n!=o[235].length;++n)o[235][n].charCodeAt(0)!==65533&&(a[o[235][n]]=60160+n,r[60160+n]=o[235][n]);for(o[236]="".split(""),n=0;n!=o[236].length;++n)o[236][n].charCodeAt(0)!==65533&&(a[o[236][n]]=60416+n,r[60416+n]=o[236][n]);for(o[237]="".split(""),n=0;n!=o[237].length;++n)o[237][n].charCodeAt(0)!==65533&&(a[o[237][n]]=60672+n,r[60672+n]=o[237][n]);for(o[238]="".split(""),n=0;n!=o[238].length;++n)o[238][n].charCodeAt(0)!==65533&&(a[o[238][n]]=60928+n,r[60928+n]=o[238][n]);for(o[239]="".split(""),n=0;n!=o[239].length;++n)o[239][n].charCodeAt(0)!==65533&&(a[o[239][n]]=61184+n,r[61184+n]=o[239][n]);for(o[240]="".split(""),n=0;n!=o[240].length;++n)o[240][n].charCodeAt(0)!==65533&&(a[o[240][n]]=61440+n,r[61440+n]=o[240][n]);for(o[241]="".split(""),n=0;n!=o[241].length;++n)o[241][n].charCodeAt(0)!==65533&&(a[o[241][n]]=61696+n,r[61696+n]=o[241][n]);for(o[242]="".split(""),n=0;n!=o[242].length;++n)o[242][n].charCodeAt(0)!==65533&&(a[o[242][n]]=61952+n,r[61952+n]=o[242][n]);for(o[243]="".split(""),n=0;n!=o[243].length;++n)o[243][n].charCodeAt(0)!==65533&&(a[o[243][n]]=62208+n,r[62208+n]=o[243][n]);for(o[244]="".split(""),n=0;n!=o[244].length;++n)o[244][n].charCodeAt(0)!==65533&&(a[o[244][n]]=62464+n,r[62464+n]=o[244][n]);for(o[245]="".split(""),n=0;n!=o[245].length;++n)o[245][n].charCodeAt(0)!==65533&&(a[o[245][n]]=62720+n,r[62720+n]=o[245][n]);for(o[246]="".split(""),n=0;n!=o[246].length;++n)o[246][n].charCodeAt(0)!==65533&&(a[o[246][n]]=62976+n,r[62976+n]=o[246][n]);for(o[247]="".split(""),n=0;n!=o[247].length;++n)o[247][n].charCodeAt(0)!==65533&&(a[o[247][n]]=63232+n,r[63232+n]=o[247][n]);for(o[248]="".split(""),n=0;n!=o[248].length;++n)o[248][n].charCodeAt(0)!==65533&&(a[o[248][n]]=63488+n,r[63488+n]=o[248][n]);for(o[249]="".split(""),n=0;n!=o[249].length;++n)o[249][n].charCodeAt(0)!==65533&&(a[o[249][n]]=63744+n,r[63744+n]=o[249][n]);for(o[250]="".split(""),n=0;n!=o[250].length;++n)o[250][n].charCodeAt(0)!==65533&&(a[o[250][n]]=64e3+n,r[64e3+n]=o[250][n]);for(o[251]="".split(""),n=0;n!=o[251].length;++n)o[251][n].charCodeAt(0)!==65533&&(a[o[251][n]]=64256+n,r[64256+n]=o[251][n]);for(o[252]="".split(""),n=0;n!=o[252].length;++n)o[252][n].charCodeAt(0)!==65533&&(a[o[252][n]]=64512+n,r[64512+n]=o[252][n]);for(o[253]="".split(""),n=0;n!=o[253].length;++n)o[253][n].charCodeAt(0)!==65533&&(a[o[253][n]]=64768+n,r[64768+n]=o[253][n]);for(o[254]="".split(""),n=0;n!=o[254].length;++n)o[254][n].charCodeAt(0)!==65533&&(a[o[254][n]]=65024+n,r[65024+n]=o[254][n]);return{enc:a,dec:r}})(),e[949]=(function(){var r=[],a={},o=[],n;for(o[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=o[0].length;++n)o[0][n].charCodeAt(0)!==65533&&(a[o[0][n]]=0+n,r[0+n]=o[0][n]);for(o[129]="".split(""),n=0;n!=o[129].length;++n)o[129][n].charCodeAt(0)!==65533&&(a[o[129][n]]=33024+n,r[33024+n]=o[129][n]);for(o[130]="".split(""),n=0;n!=o[130].length;++n)o[130][n].charCodeAt(0)!==65533&&(a[o[130][n]]=33280+n,r[33280+n]=o[130][n]);for(o[131]="".split(""),n=0;n!=o[131].length;++n)o[131][n].charCodeAt(0)!==65533&&(a[o[131][n]]=33536+n,r[33536+n]=o[131][n]);for(o[132]="".split(""),n=0;n!=o[132].length;++n)o[132][n].charCodeAt(0)!==65533&&(a[o[132][n]]=33792+n,r[33792+n]=o[132][n]);for(o[133]="".split(""),n=0;n!=o[133].length;++n)o[133][n].charCodeAt(0)!==65533&&(a[o[133][n]]=34048+n,r[34048+n]=o[133][n]);for(o[134]="".split(""),n=0;n!=o[134].length;++n)o[134][n].charCodeAt(0)!==65533&&(a[o[134][n]]=34304+n,r[34304+n]=o[134][n]);for(o[135]="".split(""),n=0;n!=o[135].length;++n)o[135][n].charCodeAt(0)!==65533&&(a[o[135][n]]=34560+n,r[34560+n]=o[135][n]);for(o[136]="".split(""),n=0;n!=o[136].length;++n)o[136][n].charCodeAt(0)!==65533&&(a[o[136][n]]=34816+n,r[34816+n]=o[136][n]);for(o[137]="".split(""),n=0;n!=o[137].length;++n)o[137][n].charCodeAt(0)!==65533&&(a[o[137][n]]=35072+n,r[35072+n]=o[137][n]);for(o[138]="".split(""),n=0;n!=o[138].length;++n)o[138][n].charCodeAt(0)!==65533&&(a[o[138][n]]=35328+n,r[35328+n]=o[138][n]);for(o[139]="".split(""),n=0;n!=o[139].length;++n)o[139][n].charCodeAt(0)!==65533&&(a[o[139][n]]=35584+n,r[35584+n]=o[139][n]);for(o[140]="".split(""),n=0;n!=o[140].length;++n)o[140][n].charCodeAt(0)!==65533&&(a[o[140][n]]=35840+n,r[35840+n]=o[140][n]);for(o[141]="".split(""),n=0;n!=o[141].length;++n)o[141][n].charCodeAt(0)!==65533&&(a[o[141][n]]=36096+n,r[36096+n]=o[141][n]);for(o[142]="".split(""),n=0;n!=o[142].length;++n)o[142][n].charCodeAt(0)!==65533&&(a[o[142][n]]=36352+n,r[36352+n]=o[142][n]);for(o[143]="".split(""),n=0;n!=o[143].length;++n)o[143][n].charCodeAt(0)!==65533&&(a[o[143][n]]=36608+n,r[36608+n]=o[143][n]);for(o[144]="".split(""),n=0;n!=o[144].length;++n)o[144][n].charCodeAt(0)!==65533&&(a[o[144][n]]=36864+n,r[36864+n]=o[144][n]);for(o[145]="".split(""),n=0;n!=o[145].length;++n)o[145][n].charCodeAt(0)!==65533&&(a[o[145][n]]=37120+n,r[37120+n]=o[145][n]);for(o[146]="".split(""),n=0;n!=o[146].length;++n)o[146][n].charCodeAt(0)!==65533&&(a[o[146][n]]=37376+n,r[37376+n]=o[146][n]);for(o[147]="".split(""),n=0;n!=o[147].length;++n)o[147][n].charCodeAt(0)!==65533&&(a[o[147][n]]=37632+n,r[37632+n]=o[147][n]);for(o[148]="".split(""),n=0;n!=o[148].length;++n)o[148][n].charCodeAt(0)!==65533&&(a[o[148][n]]=37888+n,r[37888+n]=o[148][n]);for(o[149]="".split(""),n=0;n!=o[149].length;++n)o[149][n].charCodeAt(0)!==65533&&(a[o[149][n]]=38144+n,r[38144+n]=o[149][n]);for(o[150]="".split(""),n=0;n!=o[150].length;++n)o[150][n].charCodeAt(0)!==65533&&(a[o[150][n]]=38400+n,r[38400+n]=o[150][n]);for(o[151]="".split(""),n=0;n!=o[151].length;++n)o[151][n].charCodeAt(0)!==65533&&(a[o[151][n]]=38656+n,r[38656+n]=o[151][n]);for(o[152]="".split(""),n=0;n!=o[152].length;++n)o[152][n].charCodeAt(0)!==65533&&(a[o[152][n]]=38912+n,r[38912+n]=o[152][n]);for(o[153]="".split(""),n=0;n!=o[153].length;++n)o[153][n].charCodeAt(0)!==65533&&(a[o[153][n]]=39168+n,r[39168+n]=o[153][n]);for(o[154]="".split(""),n=0;n!=o[154].length;++n)o[154][n].charCodeAt(0)!==65533&&(a[o[154][n]]=39424+n,r[39424+n]=o[154][n]);for(o[155]="".split(""),n=0;n!=o[155].length;++n)o[155][n].charCodeAt(0)!==65533&&(a[o[155][n]]=39680+n,r[39680+n]=o[155][n]);for(o[156]="".split(""),n=0;n!=o[156].length;++n)o[156][n].charCodeAt(0)!==65533&&(a[o[156][n]]=39936+n,r[39936+n]=o[156][n]);for(o[157]="".split(""),n=0;n!=o[157].length;++n)o[157][n].charCodeAt(0)!==65533&&(a[o[157][n]]=40192+n,r[40192+n]=o[157][n]);for(o[158]="".split(""),n=0;n!=o[158].length;++n)o[158][n].charCodeAt(0)!==65533&&(a[o[158][n]]=40448+n,r[40448+n]=o[158][n]);for(o[159]="".split(""),n=0;n!=o[159].length;++n)o[159][n].charCodeAt(0)!==65533&&(a[o[159][n]]=40704+n,r[40704+n]=o[159][n]);for(o[160]="".split(""),n=0;n!=o[160].length;++n)o[160][n].charCodeAt(0)!==65533&&(a[o[160][n]]=40960+n,r[40960+n]=o[160][n]);for(o[161]="".split(""),n=0;n!=o[161].length;++n)o[161][n].charCodeAt(0)!==65533&&(a[o[161][n]]=41216+n,r[41216+n]=o[161][n]);for(o[162]="".split(""),n=0;n!=o[162].length;++n)o[162][n].charCodeAt(0)!==65533&&(a[o[162][n]]=41472+n,r[41472+n]=o[162][n]);for(o[163]="".split(""),n=0;n!=o[163].length;++n)o[163][n].charCodeAt(0)!==65533&&(a[o[163][n]]=41728+n,r[41728+n]=o[163][n]);for(o[164]="".split(""),n=0;n!=o[164].length;++n)o[164][n].charCodeAt(0)!==65533&&(a[o[164][n]]=41984+n,r[41984+n]=o[164][n]);for(o[165]="".split(""),n=0;n!=o[165].length;++n)o[165][n].charCodeAt(0)!==65533&&(a[o[165][n]]=42240+n,r[42240+n]=o[165][n]);for(o[166]="".split(""),n=0;n!=o[166].length;++n)o[166][n].charCodeAt(0)!==65533&&(a[o[166][n]]=42496+n,r[42496+n]=o[166][n]);for(o[167]="".split(""),n=0;n!=o[167].length;++n)o[167][n].charCodeAt(0)!==65533&&(a[o[167][n]]=42752+n,r[42752+n]=o[167][n]);for(o[168]="".split(""),n=0;n!=o[168].length;++n)o[168][n].charCodeAt(0)!==65533&&(a[o[168][n]]=43008+n,r[43008+n]=o[168][n]);for(o[169]="".split(""),n=0;n!=o[169].length;++n)o[169][n].charCodeAt(0)!==65533&&(a[o[169][n]]=43264+n,r[43264+n]=o[169][n]);for(o[170]="".split(""),n=0;n!=o[170].length;++n)o[170][n].charCodeAt(0)!==65533&&(a[o[170][n]]=43520+n,r[43520+n]=o[170][n]);for(o[171]="".split(""),n=0;n!=o[171].length;++n)o[171][n].charCodeAt(0)!==65533&&(a[o[171][n]]=43776+n,r[43776+n]=o[171][n]);for(o[172]="".split(""),n=0;n!=o[172].length;++n)o[172][n].charCodeAt(0)!==65533&&(a[o[172][n]]=44032+n,r[44032+n]=o[172][n]);for(o[173]="".split(""),n=0;n!=o[173].length;++n)o[173][n].charCodeAt(0)!==65533&&(a[o[173][n]]=44288+n,r[44288+n]=o[173][n]);for(o[174]="".split(""),n=0;n!=o[174].length;++n)o[174][n].charCodeAt(0)!==65533&&(a[o[174][n]]=44544+n,r[44544+n]=o[174][n]);for(o[175]="".split(""),n=0;n!=o[175].length;++n)o[175][n].charCodeAt(0)!==65533&&(a[o[175][n]]=44800+n,r[44800+n]=o[175][n]);for(o[176]="".split(""),n=0;n!=o[176].length;++n)o[176][n].charCodeAt(0)!==65533&&(a[o[176][n]]=45056+n,r[45056+n]=o[176][n]);for(o[177]="".split(""),n=0;n!=o[177].length;++n)o[177][n].charCodeAt(0)!==65533&&(a[o[177][n]]=45312+n,r[45312+n]=o[177][n]);for(o[178]="".split(""),n=0;n!=o[178].length;++n)o[178][n].charCodeAt(0)!==65533&&(a[o[178][n]]=45568+n,r[45568+n]=o[178][n]);for(o[179]="".split(""),n=0;n!=o[179].length;++n)o[179][n].charCodeAt(0)!==65533&&(a[o[179][n]]=45824+n,r[45824+n]=o[179][n]);for(o[180]="".split(""),n=0;n!=o[180].length;++n)o[180][n].charCodeAt(0)!==65533&&(a[o[180][n]]=46080+n,r[46080+n]=o[180][n]);for(o[181]="".split(""),n=0;n!=o[181].length;++n)o[181][n].charCodeAt(0)!==65533&&(a[o[181][n]]=46336+n,r[46336+n]=o[181][n]);for(o[182]="".split(""),n=0;n!=o[182].length;++n)o[182][n].charCodeAt(0)!==65533&&(a[o[182][n]]=46592+n,r[46592+n]=o[182][n]);for(o[183]="".split(""),n=0;n!=o[183].length;++n)o[183][n].charCodeAt(0)!==65533&&(a[o[183][n]]=46848+n,r[46848+n]=o[183][n]);for(o[184]="".split(""),n=0;n!=o[184].length;++n)o[184][n].charCodeAt(0)!==65533&&(a[o[184][n]]=47104+n,r[47104+n]=o[184][n]);for(o[185]="".split(""),n=0;n!=o[185].length;++n)o[185][n].charCodeAt(0)!==65533&&(a[o[185][n]]=47360+n,r[47360+n]=o[185][n]);for(o[186]="".split(""),n=0;n!=o[186].length;++n)o[186][n].charCodeAt(0)!==65533&&(a[o[186][n]]=47616+n,r[47616+n]=o[186][n]);for(o[187]="".split(""),n=0;n!=o[187].length;++n)o[187][n].charCodeAt(0)!==65533&&(a[o[187][n]]=47872+n,r[47872+n]=o[187][n]);for(o[188]="".split(""),n=0;n!=o[188].length;++n)o[188][n].charCodeAt(0)!==65533&&(a[o[188][n]]=48128+n,r[48128+n]=o[188][n]);for(o[189]="".split(""),n=0;n!=o[189].length;++n)o[189][n].charCodeAt(0)!==65533&&(a[o[189][n]]=48384+n,r[48384+n]=o[189][n]);for(o[190]="".split(""),n=0;n!=o[190].length;++n)o[190][n].charCodeAt(0)!==65533&&(a[o[190][n]]=48640+n,r[48640+n]=o[190][n]);for(o[191]="".split(""),n=0;n!=o[191].length;++n)o[191][n].charCodeAt(0)!==65533&&(a[o[191][n]]=48896+n,r[48896+n]=o[191][n]);for(o[192]="".split(""),n=0;n!=o[192].length;++n)o[192][n].charCodeAt(0)!==65533&&(a[o[192][n]]=49152+n,r[49152+n]=o[192][n]);for(o[193]="".split(""),n=0;n!=o[193].length;++n)o[193][n].charCodeAt(0)!==65533&&(a[o[193][n]]=49408+n,r[49408+n]=o[193][n]);for(o[194]="".split(""),n=0;n!=o[194].length;++n)o[194][n].charCodeAt(0)!==65533&&(a[o[194][n]]=49664+n,r[49664+n]=o[194][n]);for(o[195]="".split(""),n=0;n!=o[195].length;++n)o[195][n].charCodeAt(0)!==65533&&(a[o[195][n]]=49920+n,r[49920+n]=o[195][n]);for(o[196]="".split(""),n=0;n!=o[196].length;++n)o[196][n].charCodeAt(0)!==65533&&(a[o[196][n]]=50176+n,r[50176+n]=o[196][n]);for(o[197]="".split(""),n=0;n!=o[197].length;++n)o[197][n].charCodeAt(0)!==65533&&(a[o[197][n]]=50432+n,r[50432+n]=o[197][n]);for(o[198]="".split(""),n=0;n!=o[198].length;++n)o[198][n].charCodeAt(0)!==65533&&(a[o[198][n]]=50688+n,r[50688+n]=o[198][n]);for(o[199]="".split(""),n=0;n!=o[199].length;++n)o[199][n].charCodeAt(0)!==65533&&(a[o[199][n]]=50944+n,r[50944+n]=o[199][n]);for(o[200]="".split(""),n=0;n!=o[200].length;++n)o[200][n].charCodeAt(0)!==65533&&(a[o[200][n]]=51200+n,r[51200+n]=o[200][n]);for(o[202]="".split(""),n=0;n!=o[202].length;++n)o[202][n].charCodeAt(0)!==65533&&(a[o[202][n]]=51712+n,r[51712+n]=o[202][n]);for(o[203]="".split(""),n=0;n!=o[203].length;++n)o[203][n].charCodeAt(0)!==65533&&(a[o[203][n]]=51968+n,r[51968+n]=o[203][n]);for(o[204]="".split(""),n=0;n!=o[204].length;++n)o[204][n].charCodeAt(0)!==65533&&(a[o[204][n]]=52224+n,r[52224+n]=o[204][n]);for(o[205]="".split(""),n=0;n!=o[205].length;++n)o[205][n].charCodeAt(0)!==65533&&(a[o[205][n]]=52480+n,r[52480+n]=o[205][n]);for(o[206]="".split(""),n=0;n!=o[206].length;++n)o[206][n].charCodeAt(0)!==65533&&(a[o[206][n]]=52736+n,r[52736+n]=o[206][n]);for(o[207]="".split(""),n=0;n!=o[207].length;++n)o[207][n].charCodeAt(0)!==65533&&(a[o[207][n]]=52992+n,r[52992+n]=o[207][n]);for(o[208]="".split(""),n=0;n!=o[208].length;++n)o[208][n].charCodeAt(0)!==65533&&(a[o[208][n]]=53248+n,r[53248+n]=o[208][n]);for(o[209]="".split(""),n=0;n!=o[209].length;++n)o[209][n].charCodeAt(0)!==65533&&(a[o[209][n]]=53504+n,r[53504+n]=o[209][n]);for(o[210]="".split(""),n=0;n!=o[210].length;++n)o[210][n].charCodeAt(0)!==65533&&(a[o[210][n]]=53760+n,r[53760+n]=o[210][n]);for(o[211]="".split(""),n=0;n!=o[211].length;++n)o[211][n].charCodeAt(0)!==65533&&(a[o[211][n]]=54016+n,r[54016+n]=o[211][n]);for(o[212]="".split(""),n=0;n!=o[212].length;++n)o[212][n].charCodeAt(0)!==65533&&(a[o[212][n]]=54272+n,r[54272+n]=o[212][n]);for(o[213]="".split(""),n=0;n!=o[213].length;++n)o[213][n].charCodeAt(0)!==65533&&(a[o[213][n]]=54528+n,r[54528+n]=o[213][n]);for(o[214]="".split(""),n=0;n!=o[214].length;++n)o[214][n].charCodeAt(0)!==65533&&(a[o[214][n]]=54784+n,r[54784+n]=o[214][n]);for(o[215]="".split(""),n=0;n!=o[215].length;++n)o[215][n].charCodeAt(0)!==65533&&(a[o[215][n]]=55040+n,r[55040+n]=o[215][n]);for(o[216]="".split(""),n=0;n!=o[216].length;++n)o[216][n].charCodeAt(0)!==65533&&(a[o[216][n]]=55296+n,r[55296+n]=o[216][n]);for(o[217]="".split(""),n=0;n!=o[217].length;++n)o[217][n].charCodeAt(0)!==65533&&(a[o[217][n]]=55552+n,r[55552+n]=o[217][n]);for(o[218]="".split(""),n=0;n!=o[218].length;++n)o[218][n].charCodeAt(0)!==65533&&(a[o[218][n]]=55808+n,r[55808+n]=o[218][n]);for(o[219]="".split(""),n=0;n!=o[219].length;++n)o[219][n].charCodeAt(0)!==65533&&(a[o[219][n]]=56064+n,r[56064+n]=o[219][n]);for(o[220]="".split(""),n=0;n!=o[220].length;++n)o[220][n].charCodeAt(0)!==65533&&(a[o[220][n]]=56320+n,r[56320+n]=o[220][n]);for(o[221]="".split(""),n=0;n!=o[221].length;++n)o[221][n].charCodeAt(0)!==65533&&(a[o[221][n]]=56576+n,r[56576+n]=o[221][n]);for(o[222]="".split(""),n=0;n!=o[222].length;++n)o[222][n].charCodeAt(0)!==65533&&(a[o[222][n]]=56832+n,r[56832+n]=o[222][n]);for(o[223]="".split(""),n=0;n!=o[223].length;++n)o[223][n].charCodeAt(0)!==65533&&(a[o[223][n]]=57088+n,r[57088+n]=o[223][n]);for(o[224]="".split(""),n=0;n!=o[224].length;++n)o[224][n].charCodeAt(0)!==65533&&(a[o[224][n]]=57344+n,r[57344+n]=o[224][n]);for(o[225]="".split(""),n=0;n!=o[225].length;++n)o[225][n].charCodeAt(0)!==65533&&(a[o[225][n]]=57600+n,r[57600+n]=o[225][n]);for(o[226]="".split(""),n=0;n!=o[226].length;++n)o[226][n].charCodeAt(0)!==65533&&(a[o[226][n]]=57856+n,r[57856+n]=o[226][n]);for(o[227]="".split(""),n=0;n!=o[227].length;++n)o[227][n].charCodeAt(0)!==65533&&(a[o[227][n]]=58112+n,r[58112+n]=o[227][n]);for(o[228]="".split(""),n=0;n!=o[228].length;++n)o[228][n].charCodeAt(0)!==65533&&(a[o[228][n]]=58368+n,r[58368+n]=o[228][n]);for(o[229]="".split(""),n=0;n!=o[229].length;++n)o[229][n].charCodeAt(0)!==65533&&(a[o[229][n]]=58624+n,r[58624+n]=o[229][n]);for(o[230]="".split(""),n=0;n!=o[230].length;++n)o[230][n].charCodeAt(0)!==65533&&(a[o[230][n]]=58880+n,r[58880+n]=o[230][n]);for(o[231]="".split(""),n=0;n!=o[231].length;++n)o[231][n].charCodeAt(0)!==65533&&(a[o[231][n]]=59136+n,r[59136+n]=o[231][n]);for(o[232]="".split(""),n=0;n!=o[232].length;++n)o[232][n].charCodeAt(0)!==65533&&(a[o[232][n]]=59392+n,r[59392+n]=o[232][n]);for(o[233]="".split(""),n=0;n!=o[233].length;++n)o[233][n].charCodeAt(0)!==65533&&(a[o[233][n]]=59648+n,r[59648+n]=o[233][n]);for(o[234]="".split(""),n=0;n!=o[234].length;++n)o[234][n].charCodeAt(0)!==65533&&(a[o[234][n]]=59904+n,r[59904+n]=o[234][n]);for(o[235]="".split(""),n=0;n!=o[235].length;++n)o[235][n].charCodeAt(0)!==65533&&(a[o[235][n]]=60160+n,r[60160+n]=o[235][n]);for(o[236]="".split(""),n=0;n!=o[236].length;++n)o[236][n].charCodeAt(0)!==65533&&(a[o[236][n]]=60416+n,r[60416+n]=o[236][n]);for(o[237]="".split(""),n=0;n!=o[237].length;++n)o[237][n].charCodeAt(0)!==65533&&(a[o[237][n]]=60672+n,r[60672+n]=o[237][n]);for(o[238]="".split(""),n=0;n!=o[238].length;++n)o[238][n].charCodeAt(0)!==65533&&(a[o[238][n]]=60928+n,r[60928+n]=o[238][n]);for(o[239]="".split(""),n=0;n!=o[239].length;++n)o[239][n].charCodeAt(0)!==65533&&(a[o[239][n]]=61184+n,r[61184+n]=o[239][n]);for(o[240]="".split(""),n=0;n!=o[240].length;++n)o[240][n].charCodeAt(0)!==65533&&(a[o[240][n]]=61440+n,r[61440+n]=o[240][n]);for(o[241]="".split(""),n=0;n!=o[241].length;++n)o[241][n].charCodeAt(0)!==65533&&(a[o[241][n]]=61696+n,r[61696+n]=o[241][n]);for(o[242]="".split(""),n=0;n!=o[242].length;++n)o[242][n].charCodeAt(0)!==65533&&(a[o[242][n]]=61952+n,r[61952+n]=o[242][n]);for(o[243]="".split(""),n=0;n!=o[243].length;++n)o[243][n].charCodeAt(0)!==65533&&(a[o[243][n]]=62208+n,r[62208+n]=o[243][n]);for(o[244]="".split(""),n=0;n!=o[244].length;++n)o[244][n].charCodeAt(0)!==65533&&(a[o[244][n]]=62464+n,r[62464+n]=o[244][n]);for(o[245]="".split(""),n=0;n!=o[245].length;++n)o[245][n].charCodeAt(0)!==65533&&(a[o[245][n]]=62720+n,r[62720+n]=o[245][n]);for(o[246]="".split(""),n=0;n!=o[246].length;++n)o[246][n].charCodeAt(0)!==65533&&(a[o[246][n]]=62976+n,r[62976+n]=o[246][n]);for(o[247]="".split(""),n=0;n!=o[247].length;++n)o[247][n].charCodeAt(0)!==65533&&(a[o[247][n]]=63232+n,r[63232+n]=o[247][n]);for(o[248]="".split(""),n=0;n!=o[248].length;++n)o[248][n].charCodeAt(0)!==65533&&(a[o[248][n]]=63488+n,r[63488+n]=o[248][n]);for(o[249]="".split(""),n=0;n!=o[249].length;++n)o[249][n].charCodeAt(0)!==65533&&(a[o[249][n]]=63744+n,r[63744+n]=o[249][n]);for(o[250]="".split(""),n=0;n!=o[250].length;++n)o[250][n].charCodeAt(0)!==65533&&(a[o[250][n]]=64e3+n,r[64e3+n]=o[250][n]);for(o[251]="".split(""),n=0;n!=o[251].length;++n)o[251][n].charCodeAt(0)!==65533&&(a[o[251][n]]=64256+n,r[64256+n]=o[251][n]);for(o[252]="".split(""),n=0;n!=o[252].length;++n)o[252][n].charCodeAt(0)!==65533&&(a[o[252][n]]=64512+n,r[64512+n]=o[252][n]);for(o[253]="".split(""),n=0;n!=o[253].length;++n)o[253][n].charCodeAt(0)!==65533&&(a[o[253][n]]=64768+n,r[64768+n]=o[253][n]);return{enc:a,dec:r}})(),e[950]=(function(){var r=[],a={},o=[],n;for(o[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=o[0].length;++n)o[0][n].charCodeAt(0)!==65533&&(a[o[0][n]]=0+n,r[0+n]=o[0][n]);for(o[161]="".split(""),n=0;n!=o[161].length;++n)o[161][n].charCodeAt(0)!==65533&&(a[o[161][n]]=41216+n,r[41216+n]=o[161][n]);for(o[162]="".split(""),n=0;n!=o[162].length;++n)o[162][n].charCodeAt(0)!==65533&&(a[o[162][n]]=41472+n,r[41472+n]=o[162][n]);for(o[163]="".split(""),n=0;n!=o[163].length;++n)o[163][n].charCodeAt(0)!==65533&&(a[o[163][n]]=41728+n,r[41728+n]=o[163][n]);for(o[164]="".split(""),n=0;n!=o[164].length;++n)o[164][n].charCodeAt(0)!==65533&&(a[o[164][n]]=41984+n,r[41984+n]=o[164][n]);for(o[165]="".split(""),n=0;n!=o[165].length;++n)o[165][n].charCodeAt(0)!==65533&&(a[o[165][n]]=42240+n,r[42240+n]=o[165][n]);for(o[166]="".split(""),n=0;n!=o[166].length;++n)o[166][n].charCodeAt(0)!==65533&&(a[o[166][n]]=42496+n,r[42496+n]=o[166][n]);for(o[167]="".split(""),n=0;n!=o[167].length;++n)o[167][n].charCodeAt(0)!==65533&&(a[o[167][n]]=42752+n,r[42752+n]=o[167][n]);for(o[168]="".split(""),n=0;n!=o[168].length;++n)o[168][n].charCodeAt(0)!==65533&&(a[o[168][n]]=43008+n,r[43008+n]=o[168][n]);for(o[169]="".split(""),n=0;n!=o[169].length;++n)o[169][n].charCodeAt(0)!==65533&&(a[o[169][n]]=43264+n,r[43264+n]=o[169][n]);for(o[170]="".split(""),n=0;n!=o[170].length;++n)o[170][n].charCodeAt(0)!==65533&&(a[o[170][n]]=43520+n,r[43520+n]=o[170][n]);for(o[171]="".split(""),n=0;n!=o[171].length;++n)o[171][n].charCodeAt(0)!==65533&&(a[o[171][n]]=43776+n,r[43776+n]=o[171][n]);for(o[172]="".split(""),n=0;n!=o[172].length;++n)o[172][n].charCodeAt(0)!==65533&&(a[o[172][n]]=44032+n,r[44032+n]=o[172][n]);for(o[173]="".split(""),n=0;n!=o[173].length;++n)o[173][n].charCodeAt(0)!==65533&&(a[o[173][n]]=44288+n,r[44288+n]=o[173][n]);for(o[174]="".split(""),n=0;n!=o[174].length;++n)o[174][n].charCodeAt(0)!==65533&&(a[o[174][n]]=44544+n,r[44544+n]=o[174][n]);for(o[175]="".split(""),n=0;n!=o[175].length;++n)o[175][n].charCodeAt(0)!==65533&&(a[o[175][n]]=44800+n,r[44800+n]=o[175][n]);for(o[176]="".split(""),n=0;n!=o[176].length;++n)o[176][n].charCodeAt(0)!==65533&&(a[o[176][n]]=45056+n,r[45056+n]=o[176][n]);for(o[177]="".split(""),n=0;n!=o[177].length;++n)o[177][n].charCodeAt(0)!==65533&&(a[o[177][n]]=45312+n,r[45312+n]=o[177][n]);for(o[178]="".split(""),n=0;n!=o[178].length;++n)o[178][n].charCodeAt(0)!==65533&&(a[o[178][n]]=45568+n,r[45568+n]=o[178][n]);for(o[179]="".split(""),n=0;n!=o[179].length;++n)o[179][n].charCodeAt(0)!==65533&&(a[o[179][n]]=45824+n,r[45824+n]=o[179][n]);for(o[180]="".split(""),n=0;n!=o[180].length;++n)o[180][n].charCodeAt(0)!==65533&&(a[o[180][n]]=46080+n,r[46080+n]=o[180][n]);for(o[181]="".split(""),n=0;n!=o[181].length;++n)o[181][n].charCodeAt(0)!==65533&&(a[o[181][n]]=46336+n,r[46336+n]=o[181][n]);for(o[182]="".split(""),n=0;n!=o[182].length;++n)o[182][n].charCodeAt(0)!==65533&&(a[o[182][n]]=46592+n,r[46592+n]=o[182][n]);for(o[183]="".split(""),n=0;n!=o[183].length;++n)o[183][n].charCodeAt(0)!==65533&&(a[o[183][n]]=46848+n,r[46848+n]=o[183][n]);for(o[184]="".split(""),n=0;n!=o[184].length;++n)o[184][n].charCodeAt(0)!==65533&&(a[o[184][n]]=47104+n,r[47104+n]=o[184][n]);for(o[185]="".split(""),n=0;n!=o[185].length;++n)o[185][n].charCodeAt(0)!==65533&&(a[o[185][n]]=47360+n,r[47360+n]=o[185][n]);for(o[186]="".split(""),n=0;n!=o[186].length;++n)o[186][n].charCodeAt(0)!==65533&&(a[o[186][n]]=47616+n,r[47616+n]=o[186][n]);for(o[187]="".split(""),n=0;n!=o[187].length;++n)o[187][n].charCodeAt(0)!==65533&&(a[o[187][n]]=47872+n,r[47872+n]=o[187][n]);for(o[188]="".split(""),n=0;n!=o[188].length;++n)o[188][n].charCodeAt(0)!==65533&&(a[o[188][n]]=48128+n,r[48128+n]=o[188][n]);for(o[189]="".split(""),n=0;n!=o[189].length;++n)o[189][n].charCodeAt(0)!==65533&&(a[o[189][n]]=48384+n,r[48384+n]=o[189][n]);for(o[190]="".split(""),n=0;n!=o[190].length;++n)o[190][n].charCodeAt(0)!==65533&&(a[o[190][n]]=48640+n,r[48640+n]=o[190][n]);for(o[191]="".split(""),n=0;n!=o[191].length;++n)o[191][n].charCodeAt(0)!==65533&&(a[o[191][n]]=48896+n,r[48896+n]=o[191][n]);for(o[192]="".split(""),n=0;n!=o[192].length;++n)o[192][n].charCodeAt(0)!==65533&&(a[o[192][n]]=49152+n,r[49152+n]=o[192][n]);for(o[193]="".split(""),n=0;n!=o[193].length;++n)o[193][n].charCodeAt(0)!==65533&&(a[o[193][n]]=49408+n,r[49408+n]=o[193][n]);for(o[194]="".split(""),n=0;n!=o[194].length;++n)o[194][n].charCodeAt(0)!==65533&&(a[o[194][n]]=49664+n,r[49664+n]=o[194][n]);for(o[195]="".split(""),n=0;n!=o[195].length;++n)o[195][n].charCodeAt(0)!==65533&&(a[o[195][n]]=49920+n,r[49920+n]=o[195][n]);for(o[196]="".split(""),n=0;n!=o[196].length;++n)o[196][n].charCodeAt(0)!==65533&&(a[o[196][n]]=50176+n,r[50176+n]=o[196][n]);for(o[197]="".split(""),n=0;n!=o[197].length;++n)o[197][n].charCodeAt(0)!==65533&&(a[o[197][n]]=50432+n,r[50432+n]=o[197][n]);for(o[198]="".split(""),n=0;n!=o[198].length;++n)o[198][n].charCodeAt(0)!==65533&&(a[o[198][n]]=50688+n,r[50688+n]=o[198][n]);for(o[201]="".split(""),n=0;n!=o[201].length;++n)o[201][n].charCodeAt(0)!==65533&&(a[o[201][n]]=51456+n,r[51456+n]=o[201][n]);for(o[202]="".split(""),n=0;n!=o[202].length;++n)o[202][n].charCodeAt(0)!==65533&&(a[o[202][n]]=51712+n,r[51712+n]=o[202][n]);for(o[203]="".split(""),n=0;n!=o[203].length;++n)o[203][n].charCodeAt(0)!==65533&&(a[o[203][n]]=51968+n,r[51968+n]=o[203][n]);for(o[204]="".split(""),n=0;n!=o[204].length;++n)o[204][n].charCodeAt(0)!==65533&&(a[o[204][n]]=52224+n,r[52224+n]=o[204][n]);for(o[205]="".split(""),n=0;n!=o[205].length;++n)o[205][n].charCodeAt(0)!==65533&&(a[o[205][n]]=52480+n,r[52480+n]=o[205][n]);for(o[206]="".split(""),n=0;n!=o[206].length;++n)o[206][n].charCodeAt(0)!==65533&&(a[o[206][n]]=52736+n,r[52736+n]=o[206][n]);for(o[207]="".split(""),n=0;n!=o[207].length;++n)o[207][n].charCodeAt(0)!==65533&&(a[o[207][n]]=52992+n,r[52992+n]=o[207][n]);for(o[208]="".split(""),n=0;n!=o[208].length;++n)o[208][n].charCodeAt(0)!==65533&&(a[o[208][n]]=53248+n,r[53248+n]=o[208][n]);for(o[209]="".split(""),n=0;n!=o[209].length;++n)o[209][n].charCodeAt(0)!==65533&&(a[o[209][n]]=53504+n,r[53504+n]=o[209][n]);for(o[210]="".split(""),n=0;n!=o[210].length;++n)o[210][n].charCodeAt(0)!==65533&&(a[o[210][n]]=53760+n,r[53760+n]=o[210][n]);for(o[211]="".split(""),n=0;n!=o[211].length;++n)o[211][n].charCodeAt(0)!==65533&&(a[o[211][n]]=54016+n,r[54016+n]=o[211][n]);for(o[212]="".split(""),n=0;n!=o[212].length;++n)o[212][n].charCodeAt(0)!==65533&&(a[o[212][n]]=54272+n,r[54272+n]=o[212][n]);for(o[213]="".split(""),n=0;n!=o[213].length;++n)o[213][n].charCodeAt(0)!==65533&&(a[o[213][n]]=54528+n,r[54528+n]=o[213][n]);for(o[214]="".split(""),n=0;n!=o[214].length;++n)o[214][n].charCodeAt(0)!==65533&&(a[o[214][n]]=54784+n,r[54784+n]=o[214][n]);for(o[215]="".split(""),n=0;n!=o[215].length;++n)o[215][n].charCodeAt(0)!==65533&&(a[o[215][n]]=55040+n,r[55040+n]=o[215][n]);for(o[216]="".split(""),n=0;n!=o[216].length;++n)o[216][n].charCodeAt(0)!==65533&&(a[o[216][n]]=55296+n,r[55296+n]=o[216][n]);for(o[217]="".split(""),n=0;n!=o[217].length;++n)o[217][n].charCodeAt(0)!==65533&&(a[o[217][n]]=55552+n,r[55552+n]=o[217][n]);for(o[218]="".split(""),n=0;n!=o[218].length;++n)o[218][n].charCodeAt(0)!==65533&&(a[o[218][n]]=55808+n,r[55808+n]=o[218][n]);for(o[219]="".split(""),n=0;n!=o[219].length;++n)o[219][n].charCodeAt(0)!==65533&&(a[o[219][n]]=56064+n,r[56064+n]=o[219][n]);for(o[220]="".split(""),n=0;n!=o[220].length;++n)o[220][n].charCodeAt(0)!==65533&&(a[o[220][n]]=56320+n,r[56320+n]=o[220][n]);for(o[221]="".split(""),n=0;n!=o[221].length;++n)o[221][n].charCodeAt(0)!==65533&&(a[o[221][n]]=56576+n,r[56576+n]=o[221][n]);for(o[222]="".split(""),n=0;n!=o[222].length;++n)o[222][n].charCodeAt(0)!==65533&&(a[o[222][n]]=56832+n,r[56832+n]=o[222][n]);for(o[223]="".split(""),n=0;n!=o[223].length;++n)o[223][n].charCodeAt(0)!==65533&&(a[o[223][n]]=57088+n,r[57088+n]=o[223][n]);for(o[224]="".split(""),n=0;n!=o[224].length;++n)o[224][n].charCodeAt(0)!==65533&&(a[o[224][n]]=57344+n,r[57344+n]=o[224][n]);for(o[225]="".split(""),n=0;n!=o[225].length;++n)o[225][n].charCodeAt(0)!==65533&&(a[o[225][n]]=57600+n,r[57600+n]=o[225][n]);for(o[226]="".split(""),n=0;n!=o[226].length;++n)o[226][n].charCodeAt(0)!==65533&&(a[o[226][n]]=57856+n,r[57856+n]=o[226][n]);for(o[227]="".split(""),n=0;n!=o[227].length;++n)o[227][n].charCodeAt(0)!==65533&&(a[o[227][n]]=58112+n,r[58112+n]=o[227][n]);for(o[228]="".split(""),n=0;n!=o[228].length;++n)o[228][n].charCodeAt(0)!==65533&&(a[o[228][n]]=58368+n,r[58368+n]=o[228][n]);for(o[229]="".split(""),n=0;n!=o[229].length;++n)o[229][n].charCodeAt(0)!==65533&&(a[o[229][n]]=58624+n,r[58624+n]=o[229][n]);for(o[230]="".split(""),n=0;n!=o[230].length;++n)o[230][n].charCodeAt(0)!==65533&&(a[o[230][n]]=58880+n,r[58880+n]=o[230][n]);for(o[231]="".split(""),n=0;n!=o[231].length;++n)o[231][n].charCodeAt(0)!==65533&&(a[o[231][n]]=59136+n,r[59136+n]=o[231][n]);for(o[232]="".split(""),n=0;n!=o[232].length;++n)o[232][n].charCodeAt(0)!==65533&&(a[o[232][n]]=59392+n,r[59392+n]=o[232][n]);for(o[233]="".split(""),n=0;n!=o[233].length;++n)o[233][n].charCodeAt(0)!==65533&&(a[o[233][n]]=59648+n,r[59648+n]=o[233][n]);for(o[234]="".split(""),n=0;n!=o[234].length;++n)o[234][n].charCodeAt(0)!==65533&&(a[o[234][n]]=59904+n,r[59904+n]=o[234][n]);for(o[235]="".split(""),n=0;n!=o[235].length;++n)o[235][n].charCodeAt(0)!==65533&&(a[o[235][n]]=60160+n,r[60160+n]=o[235][n]);for(o[236]="".split(""),n=0;n!=o[236].length;++n)o[236][n].charCodeAt(0)!==65533&&(a[o[236][n]]=60416+n,r[60416+n]=o[236][n]);for(o[237]="".split(""),n=0;n!=o[237].length;++n)o[237][n].charCodeAt(0)!==65533&&(a[o[237][n]]=60672+n,r[60672+n]=o[237][n]);for(o[238]="".split(""),n=0;n!=o[238].length;++n)o[238][n].charCodeAt(0)!==65533&&(a[o[238][n]]=60928+n,r[60928+n]=o[238][n]);for(o[239]="".split(""),n=0;n!=o[239].length;++n)o[239][n].charCodeAt(0)!==65533&&(a[o[239][n]]=61184+n,r[61184+n]=o[239][n]);for(o[240]="".split(""),n=0;n!=o[240].length;++n)o[240][n].charCodeAt(0)!==65533&&(a[o[240][n]]=61440+n,r[61440+n]=o[240][n]);for(o[241]="".split(""),n=0;n!=o[241].length;++n)o[241][n].charCodeAt(0)!==65533&&(a[o[241][n]]=61696+n,r[61696+n]=o[241][n]);for(o[242]="".split(""),n=0;n!=o[242].length;++n)o[242][n].charCodeAt(0)!==65533&&(a[o[242][n]]=61952+n,r[61952+n]=o[242][n]);for(o[243]="".split(""),n=0;n!=o[243].length;++n)o[243][n].charCodeAt(0)!==65533&&(a[o[243][n]]=62208+n,r[62208+n]=o[243][n]);for(o[244]="".split(""),n=0;n!=o[244].length;++n)o[244][n].charCodeAt(0)!==65533&&(a[o[244][n]]=62464+n,r[62464+n]=o[244][n]);for(o[245]="".split(""),n=0;n!=o[245].length;++n)o[245][n].charCodeAt(0)!==65533&&(a[o[245][n]]=62720+n,r[62720+n]=o[245][n]);for(o[246]="".split(""),n=0;n!=o[246].length;++n)o[246][n].charCodeAt(0)!==65533&&(a[o[246][n]]=62976+n,r[62976+n]=o[246][n]);for(o[247]="".split(""),n=0;n!=o[247].length;++n)o[247][n].charCodeAt(0)!==65533&&(a[o[247][n]]=63232+n,r[63232+n]=o[247][n]);for(o[248]="".split(""),n=0;n!=o[248].length;++n)o[248][n].charCodeAt(0)!==65533&&(a[o[248][n]]=63488+n,r[63488+n]=o[248][n]);for(o[249]="".split(""),n=0;n!=o[249].length;++n)o[249][n].charCodeAt(0)!==65533&&(a[o[249][n]]=63744+n,r[63744+n]=o[249][n]);return{enc:a,dec:r}})(),e[1250]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1251]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1252]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1253]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1254]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1255]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1256]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1257]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1258]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[1e4]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[10006]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[10007]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[10008]=(function(){var r=[],a={},o=[],n;for(o[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=o[0].length;++n)o[0][n].charCodeAt(0)!==65533&&(a[o[0][n]]=0+n,r[0+n]=o[0][n]);for(o[161]="".split(""),n=0;n!=o[161].length;++n)o[161][n].charCodeAt(0)!==65533&&(a[o[161][n]]=41216+n,r[41216+n]=o[161][n]);for(o[162]="".split(""),n=0;n!=o[162].length;++n)o[162][n].charCodeAt(0)!==65533&&(a[o[162][n]]=41472+n,r[41472+n]=o[162][n]);for(o[163]="".split(""),n=0;n!=o[163].length;++n)o[163][n].charCodeAt(0)!==65533&&(a[o[163][n]]=41728+n,r[41728+n]=o[163][n]);for(o[164]="".split(""),n=0;n!=o[164].length;++n)o[164][n].charCodeAt(0)!==65533&&(a[o[164][n]]=41984+n,r[41984+n]=o[164][n]);for(o[165]="".split(""),n=0;n!=o[165].length;++n)o[165][n].charCodeAt(0)!==65533&&(a[o[165][n]]=42240+n,r[42240+n]=o[165][n]);for(o[166]="".split(""),n=0;n!=o[166].length;++n)o[166][n].charCodeAt(0)!==65533&&(a[o[166][n]]=42496+n,r[42496+n]=o[166][n]);for(o[167]="".split(""),n=0;n!=o[167].length;++n)o[167][n].charCodeAt(0)!==65533&&(a[o[167][n]]=42752+n,r[42752+n]=o[167][n]);for(o[168]="".split(""),n=0;n!=o[168].length;++n)o[168][n].charCodeAt(0)!==65533&&(a[o[168][n]]=43008+n,r[43008+n]=o[168][n]);for(o[169]="".split(""),n=0;n!=o[169].length;++n)o[169][n].charCodeAt(0)!==65533&&(a[o[169][n]]=43264+n,r[43264+n]=o[169][n]);for(o[176]="".split(""),n=0;n!=o[176].length;++n)o[176][n].charCodeAt(0)!==65533&&(a[o[176][n]]=45056+n,r[45056+n]=o[176][n]);for(o[177]="".split(""),n=0;n!=o[177].length;++n)o[177][n].charCodeAt(0)!==65533&&(a[o[177][n]]=45312+n,r[45312+n]=o[177][n]);for(o[178]="".split(""),n=0;n!=o[178].length;++n)o[178][n].charCodeAt(0)!==65533&&(a[o[178][n]]=45568+n,r[45568+n]=o[178][n]);for(o[179]="".split(""),n=0;n!=o[179].length;++n)o[179][n].charCodeAt(0)!==65533&&(a[o[179][n]]=45824+n,r[45824+n]=o[179][n]);for(o[180]="".split(""),n=0;n!=o[180].length;++n)o[180][n].charCodeAt(0)!==65533&&(a[o[180][n]]=46080+n,r[46080+n]=o[180][n]);for(o[181]="".split(""),n=0;n!=o[181].length;++n)o[181][n].charCodeAt(0)!==65533&&(a[o[181][n]]=46336+n,r[46336+n]=o[181][n]);for(o[182]="".split(""),n=0;n!=o[182].length;++n)o[182][n].charCodeAt(0)!==65533&&(a[o[182][n]]=46592+n,r[46592+n]=o[182][n]);for(o[183]="".split(""),n=0;n!=o[183].length;++n)o[183][n].charCodeAt(0)!==65533&&(a[o[183][n]]=46848+n,r[46848+n]=o[183][n]);for(o[184]="".split(""),n=0;n!=o[184].length;++n)o[184][n].charCodeAt(0)!==65533&&(a[o[184][n]]=47104+n,r[47104+n]=o[184][n]);for(o[185]="".split(""),n=0;n!=o[185].length;++n)o[185][n].charCodeAt(0)!==65533&&(a[o[185][n]]=47360+n,r[47360+n]=o[185][n]);for(o[186]="".split(""),n=0;n!=o[186].length;++n)o[186][n].charCodeAt(0)!==65533&&(a[o[186][n]]=47616+n,r[47616+n]=o[186][n]);for(o[187]="".split(""),n=0;n!=o[187].length;++n)o[187][n].charCodeAt(0)!==65533&&(a[o[187][n]]=47872+n,r[47872+n]=o[187][n]);for(o[188]="".split(""),n=0;n!=o[188].length;++n)o[188][n].charCodeAt(0)!==65533&&(a[o[188][n]]=48128+n,r[48128+n]=o[188][n]);for(o[189]="".split(""),n=0;n!=o[189].length;++n)o[189][n].charCodeAt(0)!==65533&&(a[o[189][n]]=48384+n,r[48384+n]=o[189][n]);for(o[190]="".split(""),n=0;n!=o[190].length;++n)o[190][n].charCodeAt(0)!==65533&&(a[o[190][n]]=48640+n,r[48640+n]=o[190][n]);for(o[191]="".split(""),n=0;n!=o[191].length;++n)o[191][n].charCodeAt(0)!==65533&&(a[o[191][n]]=48896+n,r[48896+n]=o[191][n]);for(o[192]="".split(""),n=0;n!=o[192].length;++n)o[192][n].charCodeAt(0)!==65533&&(a[o[192][n]]=49152+n,r[49152+n]=o[192][n]);for(o[193]="".split(""),n=0;n!=o[193].length;++n)o[193][n].charCodeAt(0)!==65533&&(a[o[193][n]]=49408+n,r[49408+n]=o[193][n]);for(o[194]="".split(""),n=0;n!=o[194].length;++n)o[194][n].charCodeAt(0)!==65533&&(a[o[194][n]]=49664+n,r[49664+n]=o[194][n]);for(o[195]="".split(""),n=0;n!=o[195].length;++n)o[195][n].charCodeAt(0)!==65533&&(a[o[195][n]]=49920+n,r[49920+n]=o[195][n]);for(o[196]="".split(""),n=0;n!=o[196].length;++n)o[196][n].charCodeAt(0)!==65533&&(a[o[196][n]]=50176+n,r[50176+n]=o[196][n]);for(o[197]="".split(""),n=0;n!=o[197].length;++n)o[197][n].charCodeAt(0)!==65533&&(a[o[197][n]]=50432+n,r[50432+n]=o[197][n]);for(o[198]="".split(""),n=0;n!=o[198].length;++n)o[198][n].charCodeAt(0)!==65533&&(a[o[198][n]]=50688+n,r[50688+n]=o[198][n]);for(o[199]="".split(""),n=0;n!=o[199].length;++n)o[199][n].charCodeAt(0)!==65533&&(a[o[199][n]]=50944+n,r[50944+n]=o[199][n]);for(o[200]="".split(""),n=0;n!=o[200].length;++n)o[200][n].charCodeAt(0)!==65533&&(a[o[200][n]]=51200+n,r[51200+n]=o[200][n]);for(o[201]="".split(""),n=0;n!=o[201].length;++n)o[201][n].charCodeAt(0)!==65533&&(a[o[201][n]]=51456+n,r[51456+n]=o[201][n]);for(o[202]="".split(""),n=0;n!=o[202].length;++n)o[202][n].charCodeAt(0)!==65533&&(a[o[202][n]]=51712+n,r[51712+n]=o[202][n]);for(o[203]="".split(""),n=0;n!=o[203].length;++n)o[203][n].charCodeAt(0)!==65533&&(a[o[203][n]]=51968+n,r[51968+n]=o[203][n]);for(o[204]="".split(""),n=0;n!=o[204].length;++n)o[204][n].charCodeAt(0)!==65533&&(a[o[204][n]]=52224+n,r[52224+n]=o[204][n]);for(o[205]="".split(""),n=0;n!=o[205].length;++n)o[205][n].charCodeAt(0)!==65533&&(a[o[205][n]]=52480+n,r[52480+n]=o[205][n]);for(o[206]="".split(""),n=0;n!=o[206].length;++n)o[206][n].charCodeAt(0)!==65533&&(a[o[206][n]]=52736+n,r[52736+n]=o[206][n]);for(o[207]="".split(""),n=0;n!=o[207].length;++n)o[207][n].charCodeAt(0)!==65533&&(a[o[207][n]]=52992+n,r[52992+n]=o[207][n]);for(o[208]="".split(""),n=0;n!=o[208].length;++n)o[208][n].charCodeAt(0)!==65533&&(a[o[208][n]]=53248+n,r[53248+n]=o[208][n]);for(o[209]="".split(""),n=0;n!=o[209].length;++n)o[209][n].charCodeAt(0)!==65533&&(a[o[209][n]]=53504+n,r[53504+n]=o[209][n]);for(o[210]="".split(""),n=0;n!=o[210].length;++n)o[210][n].charCodeAt(0)!==65533&&(a[o[210][n]]=53760+n,r[53760+n]=o[210][n]);for(o[211]="".split(""),n=0;n!=o[211].length;++n)o[211][n].charCodeAt(0)!==65533&&(a[o[211][n]]=54016+n,r[54016+n]=o[211][n]);for(o[212]="".split(""),n=0;n!=o[212].length;++n)o[212][n].charCodeAt(0)!==65533&&(a[o[212][n]]=54272+n,r[54272+n]=o[212][n]);for(o[213]="".split(""),n=0;n!=o[213].length;++n)o[213][n].charCodeAt(0)!==65533&&(a[o[213][n]]=54528+n,r[54528+n]=o[213][n]);for(o[214]="".split(""),n=0;n!=o[214].length;++n)o[214][n].charCodeAt(0)!==65533&&(a[o[214][n]]=54784+n,r[54784+n]=o[214][n]);for(o[215]="".split(""),n=0;n!=o[215].length;++n)o[215][n].charCodeAt(0)!==65533&&(a[o[215][n]]=55040+n,r[55040+n]=o[215][n]);for(o[216]="".split(""),n=0;n!=o[216].length;++n)o[216][n].charCodeAt(0)!==65533&&(a[o[216][n]]=55296+n,r[55296+n]=o[216][n]);for(o[217]="".split(""),n=0;n!=o[217].length;++n)o[217][n].charCodeAt(0)!==65533&&(a[o[217][n]]=55552+n,r[55552+n]=o[217][n]);for(o[218]="".split(""),n=0;n!=o[218].length;++n)o[218][n].charCodeAt(0)!==65533&&(a[o[218][n]]=55808+n,r[55808+n]=o[218][n]);for(o[219]="".split(""),n=0;n!=o[219].length;++n)o[219][n].charCodeAt(0)!==65533&&(a[o[219][n]]=56064+n,r[56064+n]=o[219][n]);for(o[220]="".split(""),n=0;n!=o[220].length;++n)o[220][n].charCodeAt(0)!==65533&&(a[o[220][n]]=56320+n,r[56320+n]=o[220][n]);for(o[221]="".split(""),n=0;n!=o[221].length;++n)o[221][n].charCodeAt(0)!==65533&&(a[o[221][n]]=56576+n,r[56576+n]=o[221][n]);for(o[222]="".split(""),n=0;n!=o[222].length;++n)o[222][n].charCodeAt(0)!==65533&&(a[o[222][n]]=56832+n,r[56832+n]=o[222][n]);for(o[223]="".split(""),n=0;n!=o[223].length;++n)o[223][n].charCodeAt(0)!==65533&&(a[o[223][n]]=57088+n,r[57088+n]=o[223][n]);for(o[224]="".split(""),n=0;n!=o[224].length;++n)o[224][n].charCodeAt(0)!==65533&&(a[o[224][n]]=57344+n,r[57344+n]=o[224][n]);for(o[225]="".split(""),n=0;n!=o[225].length;++n)o[225][n].charCodeAt(0)!==65533&&(a[o[225][n]]=57600+n,r[57600+n]=o[225][n]);for(o[226]="".split(""),n=0;n!=o[226].length;++n)o[226][n].charCodeAt(0)!==65533&&(a[o[226][n]]=57856+n,r[57856+n]=o[226][n]);for(o[227]="".split(""),n=0;n!=o[227].length;++n)o[227][n].charCodeAt(0)!==65533&&(a[o[227][n]]=58112+n,r[58112+n]=o[227][n]);for(o[228]="".split(""),n=0;n!=o[228].length;++n)o[228][n].charCodeAt(0)!==65533&&(a[o[228][n]]=58368+n,r[58368+n]=o[228][n]);for(o[229]="".split(""),n=0;n!=o[229].length;++n)o[229][n].charCodeAt(0)!==65533&&(a[o[229][n]]=58624+n,r[58624+n]=o[229][n]);for(o[230]="".split(""),n=0;n!=o[230].length;++n)o[230][n].charCodeAt(0)!==65533&&(a[o[230][n]]=58880+n,r[58880+n]=o[230][n]);for(o[231]="".split(""),n=0;n!=o[231].length;++n)o[231][n].charCodeAt(0)!==65533&&(a[o[231][n]]=59136+n,r[59136+n]=o[231][n]);for(o[232]="".split(""),n=0;n!=o[232].length;++n)o[232][n].charCodeAt(0)!==65533&&(a[o[232][n]]=59392+n,r[59392+n]=o[232][n]);for(o[233]="".split(""),n=0;n!=o[233].length;++n)o[233][n].charCodeAt(0)!==65533&&(a[o[233][n]]=59648+n,r[59648+n]=o[233][n]);for(o[234]="".split(""),n=0;n!=o[234].length;++n)o[234][n].charCodeAt(0)!==65533&&(a[o[234][n]]=59904+n,r[59904+n]=o[234][n]);for(o[235]="".split(""),n=0;n!=o[235].length;++n)o[235][n].charCodeAt(0)!==65533&&(a[o[235][n]]=60160+n,r[60160+n]=o[235][n]);for(o[236]="".split(""),n=0;n!=o[236].length;++n)o[236][n].charCodeAt(0)!==65533&&(a[o[236][n]]=60416+n,r[60416+n]=o[236][n]);for(o[237]="".split(""),n=0;n!=o[237].length;++n)o[237][n].charCodeAt(0)!==65533&&(a[o[237][n]]=60672+n,r[60672+n]=o[237][n]);for(o[238]="".split(""),n=0;n!=o[238].length;++n)o[238][n].charCodeAt(0)!==65533&&(a[o[238][n]]=60928+n,r[60928+n]=o[238][n]);for(o[239]="".split(""),n=0;n!=o[239].length;++n)o[239][n].charCodeAt(0)!==65533&&(a[o[239][n]]=61184+n,r[61184+n]=o[239][n]);for(o[240]="".split(""),n=0;n!=o[240].length;++n)o[240][n].charCodeAt(0)!==65533&&(a[o[240][n]]=61440+n,r[61440+n]=o[240][n]);for(o[241]="".split(""),n=0;n!=o[241].length;++n)o[241][n].charCodeAt(0)!==65533&&(a[o[241][n]]=61696+n,r[61696+n]=o[241][n]);for(o[242]="".split(""),n=0;n!=o[242].length;++n)o[242][n].charCodeAt(0)!==65533&&(a[o[242][n]]=61952+n,r[61952+n]=o[242][n]);for(o[243]="".split(""),n=0;n!=o[243].length;++n)o[243][n].charCodeAt(0)!==65533&&(a[o[243][n]]=62208+n,r[62208+n]=o[243][n]);for(o[244]="".split(""),n=0;n!=o[244].length;++n)o[244][n].charCodeAt(0)!==65533&&(a[o[244][n]]=62464+n,r[62464+n]=o[244][n]);for(o[245]="".split(""),n=0;n!=o[245].length;++n)o[245][n].charCodeAt(0)!==65533&&(a[o[245][n]]=62720+n,r[62720+n]=o[245][n]);for(o[246]="".split(""),n=0;n!=o[246].length;++n)o[246][n].charCodeAt(0)!==65533&&(a[o[246][n]]=62976+n,r[62976+n]=o[246][n]);for(o[247]="".split(""),n=0;n!=o[247].length;++n)o[247][n].charCodeAt(0)!==65533&&(a[o[247][n]]=63232+n,r[63232+n]=o[247][n]);return{enc:a,dec:r}})(),e[10029]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[10079]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[10081]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),e[28591]=(function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,a=[],o={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(o[r.charAt(n)]=n),a[n]=r.charAt(n);return{enc:o,dec:a}})(),t.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(t.exports=e);(function(r,a){if(typeof e>"u")if(typeof d2<"u"){var o=e;t.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?t.exports=a(o):r.cptable=a(o)}else throw new Error("cptable not found");else e=a(e)})(bie,function(r){var a={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},o=[874,1250,1251,1252,1253,1254,1255,1256,1e4],n=[932,936,949,950],f=[65001],m={},y={},C={},w={},A=function(ve){return String.fromCharCode(ve)},R=function(ve){return ve.charCodeAt(0)},I=typeof Buffer<"u",M=function(){};if(I){var F=!Buffer.from;if(!F)try{Buffer.from("foo","utf8")}catch{F=!0}M=F?function(Re,ve){return ve?new Buffer(Re,ve):new Buffer(Re)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(Re){return new Buffer(Re)});var O=1024,j=Buffer.allocUnsafe(O),U=function(ve){for(var V=Buffer.allocUnsafe(65536),ue=0;ue<65536;++ue)V[ue]=0;for(var Ee=Object.keys(ve),Ie=Ee.length,ae=0,be=Ee[ae];ae<Ie;++ae)(be=Ee[ae])&&(V[be.charCodeAt(0)]=ve[be]);return V},H=function(ve){var V=U(r[ve].enc);return function(Ee,Ie){var ae=Ee.length,be,Te=0,tt=0,je=0,Pe=0;if(typeof Ee=="string")for(be=Buffer.allocUnsafe(ae),Te=0;Te<ae;++Te)be[Te]=V[Ee.charCodeAt(Te)];else if(Buffer.isBuffer(Ee)){for(be=Buffer.allocUnsafe(2*ae),tt=0,Te=0;Te<ae;++Te)je=Ee[Te],je<128?be[tt++]=V[je]:je<224?(be[tt++]=V[((je&31)<<6)+(Ee[Te+1]&63)],++Te):je<240?(be[tt++]=V[((je&15)<<12)+((Ee[Te+1]&63)<<6)+(Ee[Te+2]&63)],Te+=2):(Pe=((je&7)<<18)+((Ee[Te+1]&63)<<12)+((Ee[Te+2]&63)<<6)+(Ee[Te+3]&63),Te+=3,Pe<65536?be[tt++]=V[Pe]:(Pe-=65536,be[tt++]=V[55296+(Pe>>10&1023)],be[tt++]=V[56320+(Pe&1023)]));be=be.slice(0,tt)}else for(be=Buffer.allocUnsafe(ae),Te=0;Te<ae;++Te)be[Te]=V[Ee[Te].charCodeAt(0)];return!Ie||Ie==="buf"?be:Ie!=="arr"?be.toString("binary"):[].slice.call(be)}},K=function(ve){var V=r[ve].dec,ue=Buffer.allocUnsafe(131072),Ee=0,Ie="";for(Ee=0;Ee<V.length;++Ee)if(Ie=V[Ee]){var ae=Ie.charCodeAt(0);ue[2*Ee]=ae&255,ue[2*Ee+1]=ae>>8}return function(Te){var tt=Te.length,je=0,Pe=0;if(2*tt>O&&(O=2*tt,j=Buffer.allocUnsafe(O)),Buffer.isBuffer(Te))for(je=0;je<tt;je++)Pe=2*Te[je],j[2*je]=ue[Pe],j[2*je+1]=ue[Pe+1];else if(typeof Te=="string")for(je=0;je<tt;je++)Pe=2*Te.charCodeAt(je),j[2*je]=ue[Pe],j[2*je+1]=ue[Pe+1];else for(je=0;je<tt;je++)Pe=2*Te[je],j[2*je]=ue[Pe],j[2*je+1]=ue[Pe+1];return j.slice(0,2*tt).toString("ucs2")}},W=function(ve){for(var V=r[ve].enc,ue=Buffer.allocUnsafe(131072),Ee=0;Ee<131072;++Ee)ue[Ee]=0;for(var Ie=Object.keys(V),ae=0,be=Ie[ae];ae<Ie.length;++ae)if(be=Ie[ae]){var Te=be.charCodeAt(0);ue[2*Te]=V[be]&255,ue[2*Te+1]=V[be]>>8}return function(je,Pe){var Be=je.length,Fe=Buffer.allocUnsafe(2*Be),Ge=0,Oe=0,mt=0,qe=0,Ae=0;if(typeof je=="string"){for(Ge=qe=0;Ge<Be;++Ge)Oe=je.charCodeAt(Ge)*2,Fe[qe++]=ue[Oe+1]||ue[Oe],ue[Oe+1]>0&&(Fe[qe++]=ue[Oe]);Fe=Fe.slice(0,qe)}else if(Buffer.isBuffer(je)){for(Ge=qe=0;Ge<Be;++Ge)Ae=je[Ge],Ae<128?Oe=Ae:Ae<224?(Oe=((Ae&31)<<6)+(je[Ge+1]&63),++Ge):Ae<240?(Oe=((Ae&15)<<12)+((je[Ge+1]&63)<<6)+(je[Ge+2]&63),Ge+=2):(Oe=((Ae&7)<<18)+((je[Ge+1]&63)<<12)+((je[Ge+2]&63)<<6)+(je[Ge+3]&63),Ge+=3),Oe<65536?(Oe*=2,Fe[qe++]=ue[Oe+1]||ue[Oe],ue[Oe+1]>0&&(Fe[qe++]=ue[Oe])):(mt=Oe-65536,Oe=2*(55296+(mt>>10&1023)),Fe[qe++]=ue[Oe+1]||ue[Oe],ue[Oe+1]>0&&(Fe[qe++]=ue[Oe]),Oe=2*(56320+(mt&1023)),Fe[qe++]=ue[Oe+1]||ue[Oe],ue[Oe+1]>0&&(Fe[qe++]=ue[Oe]));Fe=Fe.slice(0,qe)}else for(Ge=qe=0;Ge<Be;Ge++)Oe=je[Ge].charCodeAt(0)*2,Fe[qe++]=ue[Oe+1]||ue[Oe],ue[Oe+1]>0&&(Fe[qe++]=ue[Oe]);return!Pe||Pe==="buf"?Fe:Pe!=="arr"?Fe.toString("binary"):[].slice.call(Fe)}},X=function(ve){var V=r[ve].dec,ue=Buffer.allocUnsafe(131072),Ee=0,Ie,ae=0,be=0,Te=0;for(Te=0;Te<65536;++Te)ue[2*Te]=255,ue[2*Te+1]=253;for(Ee=0;Ee<V.length;++Ee)(Ie=V[Ee])&&(ae=Ie.charCodeAt(0),be=2*Ee,ue[be]=ae&255,ue[be+1]=ae>>8);return function(je){var Pe=je.length,Be=Buffer.allocUnsafe(2*Pe),Fe=0,Ge=0,Oe=0;if(Buffer.isBuffer(je))for(Fe=0;Fe<Pe;Fe++)Ge=2*je[Fe],ue[Ge]===255&&ue[Ge+1]===253&&(Ge=2*((je[Fe]<<8)+je[Fe+1]),++Fe),Be[Oe++]=ue[Ge],Be[Oe++]=ue[Ge+1];else if(typeof je=="string")for(Fe=0;Fe<Pe;Fe++)Ge=2*je.charCodeAt(Fe),ue[Ge]===255&&ue[Ge+1]===253&&(Ge=2*((je.charCodeAt(Fe)<<8)+je.charCodeAt(Fe+1)),++Fe),Be[Oe++]=ue[Ge],Be[Oe++]=ue[Ge+1];else for(Fe=0;Fe<Pe;Fe++)Ge=2*je[Fe],ue[Ge]===255&&ue[Ge+1]===253&&(Ge=2*((je[Fe]<<8)+je[Fe+1]),++Fe),Be[Oe++]=ue[Ge],Be[Oe++]=ue[Ge+1];return Be.slice(0,Oe).toString("ucs2")}};m[65001]=function Re(ve){if(typeof ve=="string")return Re(ve.split("").map(R));var V=ve.length,ue=0,Ee=0;4*V>O&&(O=4*V,j=Buffer.allocUnsafe(O));var Ie=0;V>=3&&ve[0]==239&&ve[1]==187&&ve[2]==191&&(Ie=3);for(var ae=1,be=0,Te=0;Ie<V;Ie+=ae)ae=1,Te=ve[Ie],Te<128?ue=Te:Te<224?(ue=(Te&31)*64+(ve[Ie+1]&63),ae=2):Te<240?(ue=((Te&15)<<12)+(ve[Ie+1]&63)*64+(ve[Ie+2]&63),ae=3):(ue=(Te&7)*262144+((ve[Ie+1]&63)<<12)+(ve[Ie+2]&63)*64+(ve[Ie+3]&63),ae=4),ue<65536?(j[be++]=ue&255,j[be++]=ue>>8):(ue-=65536,Ee=55296+(ue>>10&1023),ue=56320+(ue&1023),j[be++]=Ee&255,j[be++]=Ee>>>8,j[be++]=ue&255,j[be++]=ue>>>8&255);return j.slice(0,be).toString("ucs2")},y[65001]=function(ve,V){if(I&&Buffer.isBuffer(ve))return!V||V==="buf"?ve:V!=="arr"?ve.toString("binary"):[].slice.call(ve);var ue=ve.length,Ee=0,Ie=0,ae=0,be=typeof ve=="string";4*ue>O&&(O=4*ue,j=Buffer.allocUnsafe(O));for(var Te=0;Te<ue;++Te)Ee=be?ve.charCodeAt(Te):ve[Te].charCodeAt(0),Ee<=127?j[ae++]=Ee:Ee<=2047?(j[ae++]=192+(Ee>>6),j[ae++]=128+(Ee&63)):Ee>=55296&&Ee<=57343?(Ee-=55296,++Te,Ie=(be?ve.charCodeAt(Te):ve[Te].charCodeAt(0))-56320+(Ee<<10),j[ae++]=240+(Ie>>>18&7),j[ae++]=144+(Ie>>>12&63),j[ae++]=128+(Ie>>>6&63),j[ae++]=128+(Ie&63)):(j[ae++]=224+(Ee>>12),j[ae++]=128+(Ee>>6&63),j[ae++]=128+(Ee&63));return!V||V==="buf"?j.slice(0,ae):V!=="arr"?j.slice(0,ae).toString("binary"):[].slice.call(j,0,ae)}}var ee=function(){if(I){if(C[o[0]])return;var ve=0,V=0;for(ve=0;ve<o.length;++ve)V=o[ve],r[V]&&(C[V]=K(V),w[V]=H(V));for(ve=0;ve<n.length;++ve)V=n[ve],r[V]&&(C[V]=X(V),w[V]=W(V));for(ve=0;ve<f.length;++ve)V=f[ve],m[V]&&(C[V]=m[V]),y[V]&&(w[V]=y[V])}},ie=function(Re,ve){return""},de=function(ve){delete C[ve],delete w[ve]},le=function(){if(I){if(!C[o[0]])return;o.forEach(de),n.forEach(de),f.forEach(de)}ne=ie,Se=0},oe={encache:ee,decache:le,sbcs:o,dbcs:n};ee();var N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",ne=ie,Se=0,se=function Re(ve,V,ue){if(ve===Se&&ne)return ne(V,ue);if(w[ve])return ne=w[Se=ve],ne(V,ue);I&&Buffer.isBuffer(V)&&(V=V.toString("utf8"));var Ee=V.length,Ie=I?Buffer.allocUnsafe(4*Ee):[],ae=0,be=0,Te=0,tt=0,je=r[ve],Pe,Be="",Fe=typeof V=="string";if(je&&(Pe=je.enc))for(be=0;be<Ee;++be,++Te)ae=Pe[Fe?V.charAt(be):V[be]],ae>255?(Ie[Te]=ae>>8,Ie[++Te]=ae&255):Ie[Te]=ae&255;else if(Be=a[ve])switch(Be){case"utf8":if(I&&Fe){Ie=M(V,Be),Te=Ie.length;break}for(be=0;be<Ee;++be,++Te)ae=Fe?V.charCodeAt(be):V[be].charCodeAt(0),ae<=127?Ie[Te]=ae:ae<=2047?(Ie[Te]=192+(ae>>6),Ie[++Te]=128+(ae&63)):ae>=55296&&ae<=57343?(ae-=55296,tt=(Fe?V.charCodeAt(++be):V[++be].charCodeAt(0))-56320+(ae<<10),Ie[Te]=240+(tt>>>18&7),Ie[++Te]=144+(tt>>>12&63),Ie[++Te]=128+(tt>>>6&63),Ie[++Te]=128+(tt&63)):(Ie[Te]=224+(ae>>12),Ie[++Te]=128+(ae>>6&63),Ie[++Te]=128+(ae&63));break;case"ascii":if(I&&typeof V=="string"){Ie=M(V,Be),Te=Ie.length;break}for(be=0;be<Ee;++be,++Te)if(ae=Fe?V.charCodeAt(be):V[be].charCodeAt(0),ae<=127)Ie[Te]=ae;else throw new Error("bad ascii "+ae);break;case"utf16le":if(I&&typeof V=="string"){Ie=M(V,Be),Te=Ie.length;break}for(be=0;be<Ee;++be)ae=Fe?V.charCodeAt(be):V[be].charCodeAt(0),Ie[Te++]=ae&255,Ie[Te++]=ae>>8;break;case"utf16be":for(be=0;be<Ee;++be)ae=Fe?V.charCodeAt(be):V[be].charCodeAt(0),Ie[Te++]=ae>>8,Ie[Te++]=ae&255;break;case"utf32le":for(be=0;be<Ee;++be)ae=Fe?V.charCodeAt(be):V[be].charCodeAt(0),ae>=55296&&ae<=57343&&(ae=65536+(ae-55296<<10)+(V[++be].charCodeAt(0)-56320)),Ie[Te++]=ae&255,ae>>=8,Ie[Te++]=ae&255,ae>>=8,Ie[Te++]=ae&255,ae>>=8,Ie[Te++]=ae&255;break;case"utf32be":for(be=0;be<Ee;++be)ae=Fe?V.charCodeAt(be):V[be].charCodeAt(0),ae>=55296&&ae<=57343&&(ae=65536+(ae-55296<<10)+(V[++be].charCodeAt(0)-56320)),Ie[Te+3]=ae&255,ae>>=8,Ie[Te+2]=ae&255,ae>>=8,Ie[Te+1]=ae&255,ae>>=8,Ie[Te]=ae&255,Te+=4;break;case"utf7":for(be=0;be<Ee;be++){var Ge=Fe?V.charAt(be):V[be].charAt(0);if(Ge==="+"){Ie[Te++]=43,Ie[Te++]=45;continue}if(ce.indexOf(Ge)>-1){Ie[Te++]=Ge.charCodeAt(0);continue}var Oe=Re(1201,Ge);Ie[Te++]=43,Ie[Te++]=N.charCodeAt(Oe[0]>>2),Ie[Te++]=N.charCodeAt(((Oe[0]&3)<<4)+((Oe[1]||0)>>4)),Ie[Te++]=N.charCodeAt(((Oe[1]&15)<<2)+((Oe[2]||0)>>6)),Ie[Te++]=45}break;default:throw new Error("Unsupported magic: "+ve+" "+a[ve])}else throw new Error("Unrecognized CP: "+ve);return Ie=Ie.slice(0,Te),I?!ue||ue==="buf"?Ie:ue!=="arr"?Ie.toString("binary"):[].slice.call(Ie):ue=="str"?Ie.map(A).join(""):Ie},ye=function Re(ve,V){var ue;if(ue=C[ve])return ue(V);if(typeof V=="string")return Re(ve,V.split("").map(R));var Ee=V.length,Ie=new Array(Ee),ae="",be=0,Te=0,tt=1,je=0,Pe=0,Be=r[ve],Fe,Ge="";if(Be&&(Fe=Be.dec))for(Te=0;Te<Ee;Te+=tt){if(tt=2,ae=Fe[(V[Te]<<8)+V[Te+1]],ae||(tt=1,ae=Fe[V[Te]]),!ae)throw new Error("Unrecognized code: "+V[Te]+" "+V[Te+tt-1]+" "+Te+" "+tt+" "+Fe[V[Te]]);Ie[je++]=ae}else if(Ge=a[ve])switch(Ge){case"utf8":for(Ee>=3&&V[0]==239&&V[1]==187&&V[2]==191&&(Te=3);Te<Ee;Te+=tt)tt=1,V[Te]<128?be=V[Te]:V[Te]<224?(be=(V[Te]&31)*64+(V[Te+1]&63),tt=2):V[Te]<240?(be=((V[Te]&15)<<12)+(V[Te+1]&63)*64+(V[Te+2]&63),tt=3):(be=(V[Te]&7)*262144+((V[Te+1]&63)<<12)+(V[Te+2]&63)*64+(V[Te+3]&63),tt=4),be<65536||(be-=65536,Pe=55296+(be>>10&1023),be=56320+(be&1023),Ie[je++]=String.fromCharCode(Pe)),Ie[je++]=String.fromCharCode(be);break;case"ascii":if(I&&Buffer.isBuffer(V))return V.toString(Ge);for(Te=0;Te<Ee;Te++)Ie[Te]=String.fromCharCode(V[Te]);je=Ee;break;case"utf16le":if(Ee>=2&&V[0]==255&&V[1]==254&&(Te=2),I&&Buffer.isBuffer(V))return V.toString(Ge);for(tt=2;Te+1<Ee;Te+=tt)Ie[je++]=String.fromCharCode((V[Te+1]<<8)+V[Te]);break;case"utf16be":for(Ee>=2&&V[0]==254&&V[1]==255&&(Te=2),tt=2;Te+1<Ee;Te+=tt)Ie[je++]=String.fromCharCode((V[Te]<<8)+V[Te+1]);break;case"utf32le":for(Ee>=4&&V[0]==255&&V[1]==254&&V[2]===0&&V[3]===0&&(Te=4),tt=4;Te<Ee;Te+=tt)be=(V[Te+3]<<24)+(V[Te+2]<<16)+(V[Te+1]<<8)+V[Te],be>65535?(be-=65536,Ie[je++]=String.fromCharCode(55296+(be>>10&1023)),Ie[je++]=String.fromCharCode(56320+(be&1023))):Ie[je++]=String.fromCharCode(be);break;case"utf32be":for(Ee>=4&&V[3]==255&&V[2]==254&&V[1]===0&&V[0]===0&&(Te=4),tt=4;Te<Ee;Te+=tt)be=(V[Te]<<24)+(V[Te+1]<<16)+(V[Te+2]<<8)+V[Te+3],be>65535?(be-=65536,Ie[je++]=String.fromCharCode(55296+(be>>10&1023)),Ie[je++]=String.fromCharCode(56320+(be&1023))):Ie[je++]=String.fromCharCode(be);break;case"utf7":for(Ee>=4&&V[0]==43&&V[1]==47&&V[2]==118&&(Ee>=5&&V[3]==56&&V[4]==45?Te=5:(V[3]==56||V[3]==57||V[3]==43||V[3]==47)&&(Te=4));Te<Ee;Te+=tt){if(V[Te]!==43){tt=1,Ie[je++]=String.fromCharCode(V[Te]);continue}if(tt=1,V[Te+1]===45){tt=2,Ie[je++]="+";continue}for(;String.fromCharCode(V[Te+tt]).match(/[A-Za-z0-9+\/]/);)tt++;var Oe=0;V[Te+tt]===45&&(++tt,Oe=1);for(var mt=[],qe="",Ae=0,te=0,pe=0,J=0,fe=0,xe=0,Ne=0,Me=1;Me<tt-Oe&&(J=N.indexOf(String.fromCharCode(V[Te+Me++])),fe=N.indexOf(String.fromCharCode(V[Te+Me++])),Ae=J<<2|fe>>4,mt.push(Ae),xe=N.indexOf(String.fromCharCode(V[Te+Me++])),!(xe===-1||(te=(fe&15)<<4|xe>>2,mt.push(te),Ne=N.indexOf(String.fromCharCode(V[Te+Me++])),Ne===-1)));)pe=(xe&3)<<6|Ne,Ne<64&&mt.push(pe);for(qe=Re(1201,mt),Me=0;Me<qe.length;++Me)Ie[je++]=qe.charAt(Me)}break;default:throw new Error("Unsupported magic: "+ve+" "+a[ve])}else throw new Error("Unrecognized CP: "+ve);return Ie.slice(0,je).join("")},ze=function(ve){return!!(r[ve]||a[ve])};return r.utils={decode:ye,encode:se,hascp:ze,magic:a,cache:oe},r})})(f2)),f2.exports}const xie={},Cie=Object.freeze(Object.defineProperty({__proto__:null,default:xie},Symbol.toStringTag,{value:"Module"})),Ow=DO(Cie);var YR;function Sie(){return YR||(YR=1,(function(t,e){var r={};function a(o){o.version="0.18.5",o.style_version="1.2.0";var n,f=1200,m=1252;typeof cptable<"u"?n=cptable:typeof d2<"u"&&(n=vie());var y=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],C={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},w=function(s){y.indexOf(s)!=-1&&(m=C[0]=s)},A=function(s){w(f=s)};function R(){A(1200),w(1252)}function I(s){for(var c=[],u=0,h=s.length;u<h;++u)c[u]=s.charCodeAt(u);return c}function M(s){for(var c=[],u=0;u<s.length>>1;++u)c[u]=String.fromCharCode(s.charCodeAt(2*u+1)+(s.charCodeAt(2*u)<<8));return c.join("")}var F=function(s){var c=s.charCodeAt(0),u=s.charCodeAt(1);return c==255&&u==254?(function(h){for(var g=[],x=0;x<h.length>>1;++x)g[x]=String.fromCharCode(h.charCodeAt(2*x)+(h.charCodeAt(2*x+1)<<8));return g.join("")})(s.slice(2)):c==254&&u==255?M(s.slice(2)):c==65279?s.slice(1):s},O=function(s){return String.fromCharCode(s)},j=function(s){return String.fromCharCode(s)};n!==void 0&&(A=function(s){w(f=s)},F=function(s){return s.charCodeAt(0)===255&&s.charCodeAt(1)===254?n.utils.decode(1200,I(s.slice(2))):s},O=function(s){return f===1200?String.fromCharCode(s):n.utils.decode(f,[255&s,s>>8])[0]},j=function(s){return n.utils.decode(m,[s])[0]});var U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function H(s){for(var c,u,h,g,x,v="",S=0,T=0,k=0;k<s.length;)g=(c=s.charCodeAt(k++))>>2,x=(3&c)<<4|(u=s.charCodeAt(k++))>>4,S=(15&u)<<2|(h=s.charCodeAt(k++))>>6,T=63&h,isNaN(u)?S=T=64:isNaN(h)&&(T=64),v+=U.charAt(g)+U.charAt(x)+U.charAt(S)+U.charAt(T);return v}function K(s){var c,u,h,g,x,v,S="";s=s.replace(/[^\w\+\/\=]/g,"");for(var T=0;T<s.length;)c=U.indexOf(s.charAt(T++))<<2|(g=U.indexOf(s.charAt(T++)))>>4,S+=String.fromCharCode(c),u=(15&g)<<4|(x=U.indexOf(s.charAt(T++)))>>2,x!==64&&(S+=String.fromCharCode(u)),h=(3&x)<<6|(v=U.indexOf(s.charAt(T++))),v!==64&&(S+=String.fromCharCode(h));return S}var W=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,X=(function(){if(typeof Buffer>"u")return function(){};var s=!Buffer.from;if(!s)try{Buffer.from("foo","utf8")}catch{s=!0}return s?function(c,u){return u?new Buffer(c,u):new Buffer(c)}:Buffer.from.bind(Buffer)})();function ee(s){return W?Buffer.alloc?Buffer.alloc(s):new Buffer(s):new(typeof Uint8Array<"u"?Uint8Array:Array)(s)}function ie(s){return W?Buffer.allocUnsafe?Buffer.allocUnsafe(s):new Buffer(s):new(typeof Uint8Array<"u"?Uint8Array:Array)(s)}var de=function(s){return W?X(s,"binary"):s.split("").map(function(c){return 255&c.charCodeAt(0)})};function le(s){if(typeof ArrayBuffer>"u")return de(s);for(var c=new ArrayBuffer(s.length),u=new Uint8Array(c),h=0;h!=s.length;++h)u[h]=255&s.charCodeAt(h);return c}function oe(s){if(Array.isArray(s))return s.map(function(h){return String.fromCharCode(h)}).join("");for(var c=[],u=0;u<s.length;++u)c[u]=String.fromCharCode(s[u]);return c.join("")}function N(s){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(s instanceof ArrayBuffer)return N(new Uint8Array(s));for(var c=new Array(s.length),u=0;u<s.length;++u)c[u]=s[u];return c}var ce=W?function(s){return Buffer.concat(s.map(function(c){return Buffer.isBuffer(c)?c:X(c)}))}:function(s){if(typeof Uint8Array>"u")return[].concat.apply([],s.map(function(x){return Array.isArray(x)?x:[].slice.call(x)}));for(var u=0,c=0,u=0;u<s.length;++u)c+=s[u].length;for(var h,g=new Uint8Array(c),c=u=0;u<s.length;c+=h,++u)if(h=s[u].length,s[u]instanceof Uint8Array)g.set(s[u],c);else{if(typeof s[u]=="string")throw"wtf";g.set(new Uint8Array(s[u]),c)}return g},ne=/\u0000/g,Se=/[\u0001-\u0006]/g;function se(s){for(var c="",u=s.length-1;0<=u;)c+=s.charAt(u--);return c}function ye(s,c){return s=""+s,c<=s.length?s:ho("0",c-s.length)+s}function ze(s,c){return s=""+s,c<=s.length?s:ho(" ",c-s.length)+s}function Re(s,c){return s=""+s,c<=s.length?s:s+ho(" ",c-s.length)}var ve=Math.pow(2,32);function V(g,c){if(ve<g||g<-ve)return u=g,h=c,u=""+Math.round(u),h<=u.length?u:ho("0",h-u.length)+u;var u,h,g=Math.round(g);return(c=c)<=(g=""+(g=g)).length?g:ho("0",c-g.length)+g}function ue(s,c){return c=c||0,s.length>=7+c&&(32|s.charCodeAt(c))==103&&(32|s.charCodeAt(c+1))==101&&(32|s.charCodeAt(c+2))==110&&(32|s.charCodeAt(c+3))==101&&(32|s.charCodeAt(c+4))==114&&(32|s.charCodeAt(c+5))==97&&(32|s.charCodeAt(c+6))==108}var Ee=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ie=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],ae={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},be={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Te={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function tt(s,c,u){for(var h=s<0?-1:1,g=s*h,x=0,v=1,S=0,T=1,k=0,_=0,L=Math.floor(g);k<c&&(S=(L=Math.floor(g))*v+x,_=L*k+T,!(g-L<5e-8));)g=1/(g-L),x=v,v=S,T=k,k=_;return c<_&&(S=c<k?(_=T,x):(_=k,v)),u?(u=Math.floor(h*S/_),[u,h*S-u*_,_]):[0,h*S,_]}function je(S,c,u){if(2958465<S||S<0)return null;var h=0|S,g=Math.floor(86400*(S-h)),x=0,v=[],S={D:h,T:g,u:86400*(S-h)-g,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(S.u)<1e-6&&(S.u=0),c&&c.date1904&&(h+=1462),.9999<S.u&&(S.u=0,++g==86400&&(S.T=g=0,++h,++S.D)),h===60?(v=u?[1317,10,29]:[1900,2,29],x=3):h===0?(v=u?[1317,8,29]:[1900,1,0],x=6):(60<h&&--h,(c=new Date(1900,0,1)).setDate(c.getDate()+h-1),v=[c.getFullYear(),c.getMonth()+1,c.getDate()],x=c.getDay(),h<60&&(x=(x+6)%7),u&&(x=(function(T,k){return k[0]-=581,k=T.getDay(),T<60&&(k=(k+6)%7),k})(c,v))),S.y=v[0],S.m=v[1],S.d=v[2],S.S=g%60,g=Math.floor(g/60),S.M=g%60,g=Math.floor(g/60),S.H=g,S.q=x,S}var Pe=new Date(1899,11,31,0,0,0),Be=Pe.getTime(),Fe=new Date(1900,2,1,0,0,0);function Ge(s,c){var u=s.getTime();return c?u-=1262304e5:Fe<=s&&(u+=864e5),(u-(Be+6e4*(s.getTimezoneOffset()-Pe.getTimezoneOffset())))/864e5}function Oe(s){return s.indexOf(".")==-1?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mt(s){var c,u,h,g=Math.floor(Math.log(Math.abs(s))*Math.LOG10E),x=-4<=g&&g<=-1?s.toPrecision(10+g):Math.abs(g)<=9?(u=(c=s)<0?12:11,(h=Oe(c.toFixed(12))).length<=u||(h=c.toPrecision(10)).length<=u?h:c.toExponential(5)):g===10?s.toFixed(10).substr(0,12):(x=Oe((s=s).toFixed(11))).length>(s<0?12:11)||x==="0"||x==="-0"?s.toPrecision(6):x;return Oe((x=x.toUpperCase()).indexOf("E")==-1?x:x.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function qe(s,c){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(0|s)===s?s.toString(10):mt(s);case"undefined":return"";case"object":if(s==null)return"";if(s instanceof Date)return Wt(14,Ge(s,c&&c.date1904),c)}throw new Error("unsupported value in General format: "+s)}function Ae(s){if(s.length<=3)return s;for(var c=s.length%3,u=s.substr(0,c);c!=s.length;c+=3)u+=(0<u.length?",":"")+s.substr(c,3);return u}var te=/%/g,pe=/# (\?+)( ?)\/( ?)(\d+)/,J=/^#*0*\.([0#]+)/,fe=/\).*[0#]/,xe=/\(###\) ###\\?-####/;function Ne(s){for(var c,u="",h=0;h!=s.length;++h)switch(c=s.charCodeAt(h)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(c)}return u}function Me(s,c){return c=Math.pow(10,c),""+Math.round(s*c)/c}function Ve(h,c){var u=h-Math.floor(h),h=Math.pow(10,c);return c<(""+Math.round(u*h)).length?0:Math.round(u*h)}function Qe(s,c,u){if(s.charCodeAt(0)===40&&!c.match(fe)){var h=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?Qe("n",h,u):"("+Qe("n",h,-u)+")"}if(c.charCodeAt(c.length-1)===44)return(function(Y,he,Ce){for(var we=he.length-1;he.charCodeAt(we-1)===44;)--we;return st(Y,he.substr(0,we),Ce/Math.pow(10,3*(he.length-we)))})(s,c,u);if(c.indexOf("%")!==-1)return S=s,k=u,T=(_=c).replace(te,""),_=_.length-T.length,st(S,T,k*Math.pow(10,2*_))+ho("%",_);var g;if(c.indexOf("E")!==-1)return(function Y(he,Ce){var we,$e=he.indexOf("E")-he.indexOf(".")-1;if(he.match(/^#+0.0E\+0$/)){if(Ce==0)return"0.0E+0";if(Ce<0)return"-"+Y(he,-Ce);var ot=he.indexOf(".");ot===-1&&(ot=he.indexOf("E"));var et=Math.floor(Math.log(Ce)*Math.LOG10E)%ot;if(et<0&&(et+=ot),(we=(Ce/Math.pow(10,et)).toPrecision(1+$e+(ot+et)%ot)).indexOf("e")===-1){var dt=Math.floor(Math.log(Ce)*Math.LOG10E);for(we.indexOf(".")===-1?we=we.charAt(0)+"."+we.substr(1)+"E+"+(dt-we.length+et):we+="E+"+(dt-et);we.substr(0,2)==="0.";)we=(we=we.charAt(0)+we.substr(2,ot)+"."+we.substr(2+ot)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");we=we.replace(/\+-/,"-")}we=we.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Ot,jt,bt,Qt){return jt+bt+Qt.substr(0,(ot+et)%ot)+"."+Qt.substr(et)+"E"})}else we=Ce.toExponential($e);return he.match(/E\+00$/)&&we.match(/e[+-]\d$/)&&(we=we.substr(0,we.length-1)+"0"+we.charAt(we.length-1)),(we=he.match(/E\-/)&&we.match(/e\+/)?we.replace(/e\+/,"e"):we).replace("e","E")})(c,u);if(c.charCodeAt(0)===36)return"$"+Qe(s,c.substr(c.charAt(1)==" "?2:1),u);var x,v,S,T,k,_,L,B=Math.abs(u),z=u<0?"-":"";if(c.match(/^00+$/))return z+V(B,c.length);if(c.match(/^[#?]+$/))return(g=(g=V(u,0))==="0"?"":g).length>c.length?g:Ne(c.substr(0,c.length-g.length))+g;if(x=c.match(pe))return L=x,S=B,T=z,k=parseInt(L[4],10),_=Math.round(S*k),S=Math.floor(_/k),T+(S===0?"":""+S)+" "+((_-=S*k)==0?ho(" ",L[1].length+1+L[4].length):ze(_,L[1].length)+L[2]+"/"+L[3]+ye(k,L[4].length));if(c.match(/^#+0+$/))return z+V(B,c.length-c.indexOf("0"));if(x=c.match(J))return g=Me(u,x[1].length).replace(/^([^\.]+)$/,"$1."+Ne(x[1])).replace(/\.$/,"."+Ne(x[1])).replace(/\.(\d*)$/,function(Y,he){return"."+he+ho("0",Ne(x[1]).length-he.length)}),c.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),x=c.match(/^(0*)\.(#*)$/))return z+Me(B,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=c.match(/^#{1,3},##0(\.?)$/))return z+Ae(V(B,0));if(x=c.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+Qe(s,c,-u):Ae(""+(Math.floor(u)+(L=u,(Z=x[1].length)<(""+Math.round((L-Math.floor(L))*Math.pow(10,Z))).length?1:0)))+"."+ye(Ve(u,x[1].length),x[1].length);if(x=c.match(/^#,#*,#0/))return Qe(s,c.replace(/^#,#*,/,""),u);if(x=c.match(/^([0#]+)(\\?-([0#]+))+$/))return g=se(Qe(s,c.replace(/[\\-]/g,""),u)),v=0,se(se(c.replace(/\\/g,"")).replace(/[0#]/g,function(Y){return v<g.length?g.charAt(v++):Y==="0"?"0":""}));if(c.match(xe))return"("+(g=Qe(s,"##########",u)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var Z="";if(x=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(x[4].length,7),G=tt(B,Math.pow(10,v)-1,!1),g=z,(Z=st("n",x[1],G[1])).charAt(Z.length-1)==" "&&(Z=Z.substr(0,Z.length-1)+"0"),g+=Z+x[2]+"/"+x[3],(Z=Re(G[2],v)).length<x[4].length&&(Z=Ne(x[4].substr(x[4].length-Z.length))+Z),g+=Z;if(x=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(Math.max(x[1].length,x[4].length),7),z+((G=tt(B,Math.pow(10,v)-1,!0))[0]||(G[1]?"":"0"))+" "+(G[1]?ze(G[1],v)+x[2]+"/"+x[3]+Re(G[2],v):ho(" ",2*v+1+x[2].length+x[3].length));if(x=c.match(/^[#0?]+$/))return g=V(u,0),c.length<=g.length?g:Ne(c.substr(0,c.length-g.length))+g;if(x=c.match(/^([#0?]+)\.([#0]+)$/)){g=""+u.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),v=g.indexOf(".");var G=c.indexOf(".")-v,me=c.length-g.length-G;return Ne(c.substr(0,G)+g+c.substr(c.length-me))}if(x=c.match(/^00,000\.([#0]*0)$/))return v=Ve(u,x[1].length),u<0?"-"+Qe(s,c,-u):Ae((me=u)<2147483647&&-2147483648<me?""+(0<=me?0|me:me-1|0):""+Math.floor(me)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Y){return"00,"+(Y.length<3?ye(0,3-Y.length):"")+Y})+"."+ye(v,x[1].length);switch(c){case"###,##0.00":return Qe(s,"#,##0.00",u);case"###,###":case"##,###":case"#,###":var re=Ae(V(B,0));return re!=="0"?z+re:"";case"###,###.00":return Qe(s,"###,##0.00",u).replace(/^0\./,".");case"#,###.00":return Qe(s,"#,##0.00",u).replace(/^0\./,".")}throw new Error("unsupported format |"+c+"|")}function rt(s,c,u){if(s.charCodeAt(0)===40&&!c.match(fe)){var h=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?rt("n",h,u):"("+rt("n",h,-u)+")"}if(c.charCodeAt(c.length-1)===44)return(function(G,me,re){for(var Y=me.length-1;me.charCodeAt(Y-1)===44;)--Y;return st(G,me.substr(0,Y),re/Math.pow(10,3*(me.length-Y)))})(s,c,u);if(c.indexOf("%")!==-1)return g=s,v=u,h=(x=c).replace(te,""),x=x.length-h.length,st(g,h,v*Math.pow(10,2*x))+ho("%",x);var g,x,v,S;if(c.indexOf("E")!==-1)return(function G(me,re){var Y,he=me.indexOf("E")-me.indexOf(".")-1;if(me.match(/^#+0.0E\+0$/)){if(re==0)return"0.0E+0";if(re<0)return"-"+G(me,-re);var Ce=me.indexOf(".");Ce===-1&&(Ce=me.indexOf("E"));var we,$e=Math.floor(Math.log(re)*Math.LOG10E)%Ce;$e<0&&($e+=Ce),(Y=(re/Math.pow(10,$e)).toPrecision(1+he+(Ce+$e)%Ce)).match(/[Ee]/)||(we=Math.floor(Math.log(re)*Math.LOG10E),Y.indexOf(".")===-1?Y=Y.charAt(0)+"."+Y.substr(1)+"E+"+(we-Y.length+$e):Y+="E+"+(we-$e),Y=Y.replace(/\+-/,"-")),Y=Y.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(ot,et,dt,Ot){return et+dt+Ot.substr(0,(Ce+$e)%Ce)+"."+Ot.substr($e)+"E"})}else Y=re.toExponential(he);return me.match(/E\+00$/)&&Y.match(/e[+-]\d$/)&&(Y=Y.substr(0,Y.length-1)+"0"+Y.charAt(Y.length-1)),(Y=me.match(/E\-/)&&Y.match(/e\+/)?Y.replace(/e\+/,"e"):Y).replace("e","E")})(c,u);if(c.charCodeAt(0)===36)return"$"+rt(s,c.substr(c.charAt(1)==" "?2:1),u);var T,k,_=Math.abs(u),L=u<0?"-":"";if(c.match(/^00+$/))return L+ye(_,c.length);if(c.match(/^[#?]+$/))return(S=u===0?"":""+u).length>c.length?S:Ne(c.substr(0,c.length-S.length))+S;if(T=c.match(pe))return L+((B=_)===0?"":""+B)+ho(" ",(B=T)[1].length+2+B[4].length);if(c.match(/^#+0+$/))return L+ye(_,c.length-c.indexOf("0"));if(T=c.match(J))return S=(S=(""+u).replace(/^([^\.]+)$/,"$1."+Ne(T[1])).replace(/\.$/,"."+Ne(T[1]))).replace(/\.(\d*)$/,function(G,me){return"."+me+ho("0",Ne(T[1]).length-me.length)}),c.indexOf("0.")!==-1?S:S.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),T=c.match(/^(0*)\.(#*)$/))return L+(""+_).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,T[1].length?"0.":".");if(T=c.match(/^#{1,3},##0(\.?)$/))return L+Ae(""+_);if(T=c.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+rt(s,c,-u):Ae(""+u)+"."+ho("0",T[1].length);if(T=c.match(/^#,#*,#0/))return rt(s,c.replace(/^#,#*,/,""),u);if(T=c.match(/^([0#]+)(\\?-([0#]+))+$/))return S=se(rt(s,c.replace(/[\\-]/g,""),u)),k=0,se(se(c.replace(/\\/g,"")).replace(/[0#]/g,function(G){return k<S.length?S.charAt(k++):G==="0"?"0":""}));if(c.match(xe))return"("+(S=rt(s,"##########",u)).substr(0,3)+") "+S.substr(3,3)+"-"+S.substr(6);var B="";if(T=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(T[4].length,7),z=tt(_,Math.pow(10,k)-1,!1),S=L,(B=st("n",T[1],z[1])).charAt(B.length-1)==" "&&(B=B.substr(0,B.length-1)+"0"),S+=B+T[2]+"/"+T[3],(B=Re(z[2],k)).length<T[4].length&&(B=Ne(T[4].substr(T[4].length-B.length))+B),S+=B;if(T=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return k=Math.min(Math.max(T[1].length,T[4].length),7),L+((z=tt(_,Math.pow(10,k)-1,!0))[0]||(z[1]?"":"0"))+" "+(z[1]?ze(z[1],k)+T[2]+"/"+T[3]+Re(z[2],k):ho(" ",2*k+1+T[2].length+T[3].length));if(T=c.match(/^[#0?]+$/))return S=""+u,c.length<=S.length?S:Ne(c.substr(0,c.length-S.length))+S;if(T=c.match(/^([#0]+)\.([#0]+)$/)){S=""+u.toFixed(Math.min(T[2].length,10)).replace(/([^0])0+$/,"$1"),k=S.indexOf(".");var B=c.indexOf(".")-k,z=c.length-S.length-B;return Ne(c.substr(0,B)+S+c.substr(c.length-z))}if(T=c.match(/^00,000\.([#0]*0)$/))return u<0?"-"+rt(s,c,-u):Ae(""+u).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(G){return"00,"+(G.length<3?ye(0,3-G.length):"")+G})+"."+ye(0,T[1].length);switch(c){case"###,###":case"##,###":case"#,###":var Z=Ae(""+_);return Z!=="0"?L+Z:"";default:if(c.match(/\.[0#?]*$/))return rt(s,c.slice(0,c.lastIndexOf(".")),u)+Ne(c.slice(c.lastIndexOf(".")))}throw new Error("unsupported format |"+c+"|")}function st(s,c,u){return((0|u)===u?rt:Qe)(s,c,u)}var it=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xt(s){for(var c=0,u="",h="";c<s.length;)switch(u=s.charAt(c)){case"G":ue(s,c)&&(c+=6),c++;break;case'"':for(;s.charCodeAt(++c)!==34&&c<s.length;);++c;break;case"\\":case"_":c+=2;break;case"@":++c;break;case"B":case"b":if(s.charAt(c+1)==="1"||s.charAt(c+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(s.substr(c,3).toUpperCase()==="A/P"||s.substr(c,5).toUpperCase()==="AM/PM"||s.substr(c,5).toUpperCase()==="/")return!0;++c;break;case"[":for(h=u;s.charAt(c++)!=="]"&&c<s.length;)h+=s.charAt(c);if(h.match(it))return!0;break;case".":case"0":case"#":for(;c<s.length&&(-1<"0#?.,E+-%".indexOf(u=s.charAt(++c))||u=="\\"&&s.charAt(c+1)=="-"&&-1<"0#".indexOf(s.charAt(c+2))););break;case"?":for(;s.charAt(++c)===u;);break;case"*":++c,s.charAt(c)!=" "&&s.charAt(c)!="*"||++c;break;case"(":case")":++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;c<s.length&&-1<"0123456789".indexOf(s.charAt(++c)););break;case" ":default:++c}return!1}function pt(s,c,u,h){for(var g,x,v,S=[],T="",k=0,_="",L="t",B="H";k<s.length;)switch(_=s.charAt(k)){case"G":if(!ue(s,k))throw new Error("unrecognized character "+_+" in "+s);S[S.length]={t:"G",v:"General"},k+=7;break;case'"':for(T="";(v=s.charCodeAt(++k))!==34&&k<s.length;)T+=String.fromCharCode(v);S[S.length]={t:"t",v:T},++k;break;case"\\":var z=s.charAt(++k),Z=z==="("||z===")"?z:"t";S[S.length]={t:Z,v:z},++k;break;case"_":S[S.length]={t:"t",v:" "},k+=2;break;case"@":S[S.length]={t:"T",v:c},++k;break;case"B":case"b":if(s.charAt(k+1)==="1"||s.charAt(k+1)==="2"){if(g==null&&(g=je(c,u,s.charAt(k+1)==="2"))==null)return"";S[S.length]={t:"X",v:s.substr(k,2)},L=_,k+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":_=_.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(c<0||g==null&&(g=je(c,u))==null)return"";for(T=_;++k<s.length&&s.charAt(k).toLowerCase()===_;)T+=_;(_=_==="m"&&L.toLowerCase()==="h"?"M":_)==="h"&&(_=B),S[S.length]={t:_,v:T},L=_;break;case"A":case"a":case"":if(z={t:_,v:_},g==null&&(g=je(c,u)),s.substr(k,3).toUpperCase()==="A/P"?(g!=null&&(z.v=12<=g.H?"P":"A"),z.t="T",B="h",k+=3):s.substr(k,5).toUpperCase()==="AM/PM"?(g!=null&&(z.v=12<=g.H?"PM":"AM"),z.t="T",k+=5,B="h"):s.substr(k,5).toUpperCase()==="/"?(g!=null&&(z.v=12<=g.H?"":""),z.t="T",k+=5,B="h"):(z.t="t",++k),g==null&&z.t==="T")return"";S[S.length]=z,L=_;break;case"[":for(T=_;s.charAt(k++)!=="]"&&k<s.length;)T+=s.charAt(k);if(T.slice(-1)!=="]")throw'unterminated "[" block: |'+T+"|";if(T.match(it)){if(g==null&&(g=je(c,u))==null)return"";S[S.length]={t:"Z",v:T.toLowerCase()},L=T.charAt(1)}else-1<T.indexOf("$")&&(T=(T.match(/\$([^-\[\]]*)/)||[])[1]||"$",xt(s)||(S[S.length]={t:"t",v:T}));break;case".":if(g!=null){for(T=_;++k<s.length&&(_=s.charAt(k))==="0";)T+=_;S[S.length]={t:"s",v:T};break}case"0":case"#":for(T=_;++k<s.length&&-1<"0#?.,E+-%".indexOf(_=s.charAt(k));)T+=_;S[S.length]={t:"n",v:T};break;case"?":for(T=_;s.charAt(++k)===_;)T+=_;S[S.length]={t:_,v:T},L=_;break;case"*":++k,s.charAt(k)!=" "&&s.charAt(k)!="*"||++k;break;case"(":case")":S[S.length]={t:h===1?"t":_,v:_},++k;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(T=_;k<s.length&&-1<"0123456789".indexOf(s.charAt(++k));)T+=s.charAt(k);S[S.length]={t:"D",v:T};break;case" ":S[S.length]={t:_,v:_},++k;break;case"$":S[S.length]={t:"t",v:"$"},++k;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(_)===-1)throw new Error("unrecognized character "+_+" in "+s);S[S.length]={t:"t",v:_},++k}var G,me=0,re=0;for(k=S.length-1,L="t";0<=k;--k)switch(S[k].t){case"h":case"H":S[k].t=B,L="h",me<1&&(me=1);break;case"s":(G=S[k].v.match(/\.0+$/))&&(re=Math.max(re,G[0].length-1)),me<3&&(me=3);case"d":case"y":case"M":case"e":L=S[k].t;break;case"m":L==="s"&&(S[k].t="M",me<2&&(me=2));break;case"X":break;case"Z":(me=(me=me<1&&S[k].v.match(/[Hh]/)?1:me)<2&&S[k].v.match(/[Mm]/)?2:me)<3&&S[k].v.match(/[Ss]/)&&(me=3)}switch(me){case 0:break;case 1:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M),60<=g.M&&(g.M=0,++g.H);break;case 2:.5<=g.u&&(g.u=0,++g.S),60<=g.S&&(g.S=0,++g.M)}var Y,he="";for(k=0;k<S.length;++k)switch(S[k].t){case"t":case"T":case" ":case"D":break;case"X":S[k].v="",S[k].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":S[k].v=(function(Ot,jt,bt,Qt){var Tn,wn="",sn=0,dn=0,rn=bt.y,Vt=0;switch(Ot){case 98:rn=bt.y+543;case 121:switch(jt.length){case 1:case 2:Tn=rn%100,Vt=2;break;default:Tn=rn%1e4,Vt=4}break;case 109:switch(jt.length){case 1:case 2:Tn=bt.m,Vt=jt.length;break;case 3:return Ie[bt.m-1][1];case 5:return Ie[bt.m-1][0];default:return Ie[bt.m-1][2]}break;case 100:switch(jt.length){case 1:case 2:Tn=bt.d,Vt=jt.length;break;case 3:return Ee[bt.q][0];default:return Ee[bt.q][1]}break;case 104:switch(jt.length){case 1:case 2:Tn=1+(bt.H+11)%12,Vt=jt.length;break;default:throw"bad hour format: "+jt}break;case 72:switch(jt.length){case 1:case 2:Tn=bt.H,Vt=jt.length;break;default:throw"bad hour format: "+jt}break;case 77:switch(jt.length){case 1:case 2:Tn=bt.M,Vt=jt.length;break;default:throw"bad minute format: "+jt}break;case 115:if(jt!="s"&&jt!="ss"&&jt!=".0"&&jt!=".00"&&jt!=".000")throw"bad second format: "+jt;return bt.u!==0||jt!="s"&&jt!="ss"?(60*(dn=2<=Qt?Qt===3?1e3:100:Qt===1?10:1)<=(sn=Math.round(dn*(bt.S+bt.u)))&&(sn=0),jt==="s"?sn===0?"0":""+sn/dn:(wn=ye(sn,2+Qt),jt==="ss"?wn.substr(0,2):"."+wn.substr(2,jt.length-1))):ye(bt.S,jt.length);case 90:switch(jt){case"[h]":case"[hh]":Tn=24*bt.D+bt.H;break;case"[m]":case"[mm]":Tn=60*(24*bt.D+bt.H)+bt.M;break;case"[s]":case"[ss]":Tn=60*(60*(24*bt.D+bt.H)+bt.M)+Math.round(bt.S+bt.u);break;default:throw"bad abstime format: "+jt}Vt=jt.length===3?1:2;break;case 101:Tn=rn,Vt=1}return 0<Vt?ye(Tn,Vt):""})(S[k].t.charCodeAt(0),S[k].v,g,re),S[k].t="t";break;case"n":case"?":for(Y=k+1;S[Y]!=null&&((_=S[Y].t)==="?"||_==="D"||(_===" "||_==="t")&&S[Y+1]!=null&&(S[Y+1].t==="?"||S[Y+1].t==="t"&&S[Y+1].v==="/")||S[k].t==="("&&(_===" "||_==="n"||_===")")||_==="t"&&(S[Y].v==="/"||S[Y].v===" "&&S[Y+1]!=null&&S[Y+1].t=="?"));)S[k].v+=S[Y].v,S[Y]={v:"",t:";"},++Y;he+=S[k].v,k=Y-1;break;case"G":S[k].t="t",S[k].v=qe(c,u)}var Ce,we,$e="";if(0<he.length){he.charCodeAt(0)==40?(Ce=c<0&&he.charCodeAt(0)===45?-c:c,we=st("n",he,Ce)):(we=st("n",he,Ce=c<0&&1<h?-c:c),Ce<0&&S[0]&&S[0].t=="t"&&(we=we.substr(1),S[0].v="-"+S[0].v)),Y=we.length-1;for(var ot=S.length,k=0;k<S.length;++k)if(S[k]!=null&&S[k].t!="t"&&-1<S[k].v.indexOf(".")){ot=k;break}var et=S.length;if(ot===S.length&&we.indexOf("E")===-1){for(k=S.length-1;0<=k;--k)S[k]!=null&&"n?".indexOf(S[k].t)!==-1&&(Y>=S[k].v.length-1?(Y-=S[k].v.length,S[k].v=we.substr(Y+1,S[k].v.length)):Y<0?S[k].v="":(S[k].v=we.substr(0,Y+1),Y=-1),S[k].t="t",et=k);0<=Y&&et<S.length&&(S[et].v=we.substr(0,Y+1)+S[et].v)}else if(ot!==S.length&&we.indexOf("E")===-1){for(Y=we.indexOf(".")-1,k=ot;0<=k;--k)if(S[k]!=null&&"n?".indexOf(S[k].t)!==-1){for(x=-1<S[k].v.indexOf(".")&&k===ot?S[k].v.indexOf(".")-1:S[k].v.length-1,$e=S[k].v.substr(x+1);0<=x;--x)0<=Y&&(S[k].v.charAt(x)==="0"||S[k].v.charAt(x)==="#")&&($e=we.charAt(Y--)+$e);S[k].v=$e,S[k].t="t",et=k}for(0<=Y&&et<S.length&&(S[et].v=we.substr(0,Y+1)+S[et].v),Y=we.indexOf(".")+1,k=ot;k<S.length;++k)if(S[k]!=null&&("n?(".indexOf(S[k].t)!==-1||k===ot)){for(x=-1<S[k].v.indexOf(".")&&k===ot?S[k].v.indexOf(".")+1:0,$e=S[k].v.substr(0,x);x<S[k].v.length;++x)Y<we.length&&($e+=we.charAt(Y++));S[k].v=$e,S[k].t="t",et=k}}}for(k=0;k<S.length;++k)S[k]!=null&&-1<"n?".indexOf(S[k].t)&&(Ce=1<h&&c<0&&0<k&&S[k-1].v==="-"?-c:c,S[k].v=st(S[k].t,S[k].v,Ce),S[k].t="t");var dt="";for(k=0;k!==S.length;++k)S[k]!=null&&(dt+=S[k].v);return dt}var Yt=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Kt(s,c){if(c!=null){var u=parseFloat(c[2]);switch(c[1]){case"=":if(s==u)return 1;break;case">":if(u<s)return 1;break;case"<":if(s<u)return 1;break;case"<>":if(s!=u)return 1;break;case">=":if(u<=s)return 1;break;case"<=":if(s<=u)return 1}}}function tn(s,c){var u=(function(v){for(var S=[],T=!1,k=0,_=0;k<v.length;++k)switch(v.charCodeAt(k)){case 34:T=!T;break;case 95:case 42:case 92:++k;break;case 59:S[S.length]=v.substr(_,k-_),_=k+1}if(S[S.length]=v.substr(_),T===!0)throw new Error("Format |"+v+"| unterminated string ");return S})(s),h=u.length,g=u[h-1].indexOf("@");if(h<4&&-1<g&&--h,4<u.length)throw new Error("cannot find right format for |"+u.join("|")+"|");if(typeof c!="number")return[4,u.length===4||-1<g?u[u.length-1]:"@"];switch(u.length){case 1:u=-1<g?["General","General","General",u[0]]:[u[0],u[0],u[0],"@"];break;case 2:u=-1<g?[u[0],u[0],u[0],u[1]]:[u[0],u[1],u[0],"@"];break;case 3:u=-1<g?[u[0],u[1],u[0],u[2]]:[u[0],u[1],u[2],"@"]}var x=0<c?u[0]:c<0?u[1]:u[2];return u[0].indexOf("[")===-1&&u[1].indexOf("[")===-1?[h,x]:u[0].match(/\[[=<>]/)==null&&u[1].match(/\[[=<>]/)==null?[h,x]:(s=u[0].match(Yt),x=u[1].match(Yt),Kt(c,s)?[h,u[0]]:Kt(c,x)?[h,u[1]]:[h,u[s!=null&&x!=null?2:1]])}function Wt(s,c,u){u==null&&(u={});var h="";switch(typeof s){case"string":h=s=="m/d/yy"&&u.dateNF?u.dateNF:s;break;case"number":(h=(h=s==14&&u.dateNF?u.dateNF:(u.table!=null?u.table:ae)[s])==null?u.table&&u.table[be[s]]||ae[be[s]]:h)==null&&(h=Te[s]||"General")}if(ue(h,0))return qe(c,u);var g=tn(h,c=c instanceof Date?Ge(c,u.date1904):c);if(ue(g[1]))return qe(c,u);if(c===!0)c="TRUE";else if(c===!1)c="FALSE";else if(c===""||c==null)return"";return pt(g[1],c,u,g[0])}function _t(s,c){if(typeof c!="number"){c=+c||-1;for(var u=0;u<392;++u)if(ae[u]!=null){if(ae[u]==s){c=u;break}}else c<0&&(c=u);c<0&&(c=391)}return ae[c]=s,c}function at(s){for(var c=0;c!=392;++c)s[c]!==void 0&&_t(s[c],c)}function Et(){var s;(s=s||{})[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"/ "hh""mm""ss" "',ae=s}var qt={format:Wt,load:_t,_table:ae,load_table:at,parse_date_code:je,is_date:xt,get_table:function(){return qt._table=ae}},gn={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Sn=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Zt,Kn=(function(){var s={};s.version="1.2.0";var c=(function(){for(var Y=0,he=new Array(256),Ce=0;Ce!=256;++Ce)Y=1&(Y=1&(Y=1&(Y=1&(Y=1&(Y=1&(Y=1&(Y=1&(Y=Ce)?-306674912^Y>>>1:Y>>>1)?-306674912^Y>>>1:Y>>>1)?-306674912^Y>>>1:Y>>>1)?-306674912^Y>>>1:Y>>>1)?-306674912^Y>>>1:Y>>>1)?-306674912^Y>>>1:Y>>>1)?-306674912^Y>>>1:Y>>>1)?-306674912^Y>>>1:Y>>>1,he[Ce]=Y;return typeof Int32Array<"u"?new Int32Array(he):he})(),u=(function(Y){for(var he=0,Ce=0,$e=0,we=new(typeof Int32Array<"u"?Int32Array:Array)(4096),$e=0;$e!=256;++$e)we[$e]=Y[$e];for($e=0;$e!=256;++$e)for(Ce=Y[$e],he=256+$e;he<4096;he+=256)Ce=we[he]=Ce>>>8^Y[255&Ce];var ot=[];for($e=1;$e!=16;++$e)ot[$e-1]=typeof Int32Array<"u"?we.subarray(256*$e,256*$e+256):we.slice(256*$e,256*$e+256);return ot})(c),h=u[0],g=u[1],x=u[2],v=u[3],S=u[4],T=u[5],k=u[6],_=u[7],L=u[8],B=u[9],z=u[10],Z=u[11],G=u[12],me=u[13],re=u[14];return s.table=c,s.bstr=function(Y,he){for(var Ce=-1^he,we=0,$e=Y.length;we<$e;)Ce=Ce>>>8^c[255&(Ce^Y.charCodeAt(we++))];return~Ce},s.buf=function(Y,he){for(var Ce=-1^he,we=Y.length-15,$e=0;$e<we;)Ce=re[Y[$e++]^255&Ce]^me[Y[$e++]^Ce>>8&255]^G[Y[$e++]^Ce>>16&255]^Z[Y[$e++]^Ce>>>24]^z[Y[$e++]]^B[Y[$e++]]^L[Y[$e++]]^_[Y[$e++]]^k[Y[$e++]]^T[Y[$e++]]^S[Y[$e++]]^v[Y[$e++]]^x[Y[$e++]]^g[Y[$e++]]^h[Y[$e++]]^c[Y[$e++]];for(we+=15;$e<we;)Ce=Ce>>>8^c[255&(Ce^Y[$e++])];return~Ce},s.str=function(Y,he){for(var Ce,we=-1^he,$e=0,ot=Y.length,et=0;$e<ot;)we=(et=Y.charCodeAt($e++))<128?we>>>8^c[255&(we^et)]:et<2048?(we=we>>>8^c[255&(we^(192|et>>6&31))])>>>8^c[255&(we^(128|63&et))]:55296<=et&&et<57344?(et=64+(1023&et),Ce=1023&Y.charCodeAt($e++),(we=(we=(we=we>>>8^c[255&(we^(240|et>>8&7))])>>>8^c[255&(we^(128|et>>2&63))])>>>8^c[255&(we^(128|Ce>>6&15|(3&et)<<4))])>>>8^c[255&(we^(128|63&Ce))]):(we=(we=we>>>8^c[255&(we^(224|et>>12&15))])>>>8^c[255&(we^(128|et>>6&63))])>>>8^c[255&(we^(128|63&et))];return~we},s})(),$t=(function(){var s,c={};function u(De){if(De.charAt(De.length-1)=="/")return De.slice(0,-1).indexOf("/")===-1?De:u(De.slice(0,-1));var vt=De.lastIndexOf("/");return vt===-1?De:De.slice(0,vt+1)}function h(De){if(De.charAt(De.length-1)=="/")return h(De.slice(0,-1));var vt=De.lastIndexOf("/");return vt===-1?De:De.slice(vt+1)}function g(De){ds(De,0);for(var vt,He={};De.l<=De.length-4;){var yt=De.read_shift(2),Ue=De.read_shift(2),Gt=De.l+Ue,ft={};yt===21589&&(1&(vt=De.read_shift(1))&&(ft.mtime=De.read_shift(4)),5<Ue&&(2&vt&&(ft.atime=De.read_shift(4)),4&vt&&(ft.ctime=De.read_shift(4))),ft.mtime&&(ft.mt=new Date(1e3*ft.mtime))),De.l=Gt,He[yt]=ft}return He}function x(){return s=s||Ow}function v(De,vt){if(De[0]==80&&De[1]==75)return Qr(De,vt);if((32|De[0])==109&&(32|De[1])==105)return(function(nn,Vn){if(Y(nn.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var kn=Vn&&Vn.root||"",on=(W&&Buffer.isBuffer(nn)?nn.toString("binary"):Y(nn)).split(`\r
`),er=0,Gn="";for(er=0;er<on.length;++er)if(Gn=on[er],/^Content-Location:/i.test(Gn)&&(Gn=Gn.slice(Gn.indexOf("file")),kn=kn||Gn.slice(0,Gn.lastIndexOf("/")+1),Gn.slice(0,kn.length)!=kn))for(;0<kn.length&&(kn=(kn=kn.slice(0,kn.length-1)).slice(0,kn.lastIndexOf("/")+1),Gn.slice(0,kn.length)!=kn););if(nn=(on[1]||"").match(/boundary="(.*?)"/),!nn)throw new Error("MAD cannot find boundary");var Ro="--"+(nn[1]||""),ir={FileIndex:[],FullPaths:[]};T(ir);var xr,Ln=0;for(er=0;er<on.length;++er){var zr=on[er];zr!==Ro&&zr!==Ro+"--"||(Ln++&&(function(Pr,i,l){for(var p,b="",D="",P="",q=0;q<10;++q){var ge=i[q];if(!ge||ge.match(/^\s*$/))break;var Le=ge.match(/^(.*?):\s*([^\s].*)$/);if(Le)switch(Le[1].toLowerCase()){case"content-location":b=Le[2].trim();break;case"content-type":P=Le[2].trim();break;case"content-transfer-encoding":D=Le[2].trim()}}switch(++q,D.toLowerCase()){case"base64":p=de(K(i.slice(q).join("")));break;case"quoted-printable":p=(function(ct){for(var Dt=[],It=0;It<ct.length;++It){for(var ht=ct[It];It<=ct.length&&ht.charAt(ht.length-1)=="=";)ht=ht.slice(0,ht.length-1)+ct[++It];Dt.push(ht)}for(var Ct=0;Ct<Dt.length;++Ct)Dt[Ct]=Dt[Ct].replace(/[=][0-9A-Fa-f]{2}/g,function(Bn){return String.fromCharCode(parseInt(Bn.slice(1),16))});return de(Dt.join(`\r
`))})(i.slice(q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+D)}l=Wi(Pr,b.slice(l.length),p,{unsafe:!0}),P&&(l.ctype=P)})(ir,on.slice(xr,er),kn),xr=er)}return ir})(De,vt);if(De.length<512)throw new Error("CFB file size "+De.length+" < 512");var He,yt,Ue,Gt=3,ft=512,fn=0,St=[],ut=De.slice(0,512);ds(ut,0);var Rt=(function(nn){if(nn[nn.l]==80&&nn[nn.l+1]==75)return[0,0];nn.chk(Z,"Header Signature: "),nn.l+=16;var Vn=nn.read_shift(2,"u");return[nn.read_shift(2,"u"),Vn]})(ut);switch(Gt=Rt[0]){case 3:ft=512;break;case 4:ft=4096;break;case 0:if(Rt[1]==0)return Qr(De,vt);default:throw new Error("Major Version: Expected 3 or 4 saw "+Gt)}ft!==512&&ds(ut=De.slice(0,ft),28);var Jt=De.slice(0,ft);(function(nn,Vn){var kn=9;switch(nn.l+=2,kn=nn.read_shift(2)){case 9:if(Vn!=3)throw new Error("Sector Shift: Expected 9 saw "+kn);break;case 12:if(Vn!=4)throw new Error("Sector Shift: Expected 12 saw "+kn);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+kn)}nn.chk("0600","Mini Sector Shift: "),nn.chk("000000000000","Reserved: ")})(ut,Gt);var Hn=ut.read_shift(4,"i");if(Gt===3&&Hn!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Hn);ut.l+=4,yt=ut.read_shift(4,"i"),ut.l+=4,ut.chk("00100000","Mini Stream Cutoff Size: "),Ue=ut.read_shift(4,"i"),He=ut.read_shift(4,"i"),zn=ut.read_shift(4,"i"),fn=ut.read_shift(4,"i");for(var Mn,Pn=0;Pn<109&&!((Mn=ut.read_shift(4,"i"))<0);++Pn)St[Pn]=Mn;var xn=(function(nn,Vn){for(var kn=Math.ceil(nn.length/Vn)-1,on=[],er=1;er<kn;++er)on[er-1]=nn.slice(er*Vn,(er+1)*Vn);return on[kn-1]=nn.slice(kn*Vn),on})(De,ft);(function nn(Vn,kn,on,er,Gn){var Ro=z;if(Vn===z){if(kn!==0)throw new Error("DIFAT chain shorter than expected")}else if(Vn!==-1){var ir=on[Vn],xr=(er>>>2)-1;if(ir){for(var Ln=0;Ln<xr&&(Ro=Nu(ir,4*Ln))!==z;++Ln)Gn.push(Ro);nn(Nu(ir,er-4),kn-1,on,er,Gn)}}})(zn,fn,xn,ft,St);var _n=(function(nn,Vn,kn,on){var er=nn.length,Gn=[],Ro=[],ir=[],xr=[],Ln=on-1,zr=0,Pr=0,i=0,l=0;for(zr=0;zr<er;++zr)if(ir=[],er<=(i=zr+Vn)&&(i-=er),!Ro[i]){xr=[];var p=[];for(Pr=i;0<=Pr;){p[Pr]=!0,Ro[Pr]=!0,ir[ir.length]=Pr,xr.push(nn[Pr]);var b=kn[Math.floor(4*Pr/on)];if(on<4+(l=4*Pr&Ln))throw new Error("FAT boundary crossed: "+Pr+" 4 "+on);if(!nn[b]||(Pr=Nu(nn[b],l),p[Pr]))break}Gn[i]={nodes:ir,data:Yb([xr])}}return Gn})(xn,yt,St,ft);_n[yt].name="!Directory",0<He&&Ue!==z&&(_n[Ue].name="!MiniFAT"),_n[St[0]].name="!FAT",_n.fat_addrs=St,_n.ssz=ft;var Hn=[],zn=[],fn=[];return(function(nn,Vn,kn,on,er,Gn,Ro){for(var ir,xr=0,Ln=kn.length?2:0,zr=nn[yt].data,Pr=0,i=0;Pr<zr.length;Pr+=128){var l=zr.slice(Pr,Pr+128);ds(l,64),i=l.read_shift(2),ir=Bp(l,0,i-Ln),kn.push(ir);var p={name:ir,type:l.read_shift(1),color:l.read_shift(1),L:l.read_shift(4,"i"),R:l.read_shift(4,"i"),C:l.read_shift(4,"i"),clsid:l.read_shift(16),state:l.read_shift(4,"i"),start:0,size:0};l.read_shift(2)+l.read_shift(2)+l.read_shift(2)+l.read_shift(2)!==0&&(p.ct=S(l,l.l-8)),l.read_shift(2)+l.read_shift(2)+l.read_shift(2)+l.read_shift(2)!==0&&(p.mt=S(l,l.l-8)),p.start=l.read_shift(4,"i"),p.size=l.read_shift(4,"i"),p.size<0&&p.start<0&&(p.size=p.type=0,p.start=z,p.name=""),p.type===5?(xr=p.start,0<on&&xr!==z&&(nn[xr].name="!StreamData")):4096<=p.size?(p.storage="fat",nn[p.start]===void 0&&(nn[p.start]=(function(b,D,P,q,ge){var Le=[],ct=[];ge=ge||[];var Dt=q-1,It=0,ht=0;for(It=D;0<=It;){ge[It]=!0,Le[Le.length]=It,ct.push(b[It]);var Ct=P[Math.floor(4*It/q)];if(q<4+(ht=4*It&Dt))throw new Error("FAT boundary crossed: "+It+" 4 "+q);if(!b[Ct])break;It=Nu(b[Ct],ht)}return{nodes:Le,data:Yb([ct])}})(Vn,p.start,nn.fat_addrs,nn.ssz)),nn[p.start].name=p.name,p.content=nn[p.start].data.slice(0,p.size)):(p.storage="minifat",p.size<0?p.size=0:xr!==z&&p.start!==z&&nn[xr]&&(p.content=(function(b,D,P){for(var q=b.start,ge=b.size,Le=[],ct=q;P&&0<ge&&0<=ct;)Le.push(D.slice(ct*B,ct*B+B)),ge-=B,ct=Nu(P,4*ct);return Le.length===0?Mt(0):ce(Le).slice(0,b.size)})(p,nn[xr].data,(nn[Ro]||{}).data))),p.content&&ds(p.content,0),er[ir]=p,Gn.push(p)}})(_n,xn,Hn,He,{},zn,Ue),(function(nn,Vn,kn){for(var on=0,er=0,Gn=0,Ro=0,ir=0,xr=kn.length,Ln=[],zr=[];on<xr;++on)Ln[on]=zr[on]=on,Vn[on]=kn[on];for(;ir<zr.length;++ir)on=zr[ir],er=nn[on].L,Gn=nn[on].R,Ro=nn[on].C,Ln[on]===on&&(er!==-1&&Ln[er]!==er&&(Ln[on]=Ln[er]),Gn!==-1&&Ln[Gn]!==Gn&&(Ln[on]=Ln[Gn])),Ro!==-1&&(Ln[Ro]=on),er!==-1&&on!=Ln[on]&&(Ln[er]=Ln[on],zr.lastIndexOf(er)<ir&&zr.push(er)),Gn!==-1&&on!=Ln[on]&&(Ln[Gn]=Ln[on],zr.lastIndexOf(Gn)<ir&&zr.push(Gn));for(on=1;on<xr;++on)Ln[on]===on&&(Gn!==-1&&Ln[Gn]!==Gn?Ln[on]=Ln[Gn]:er!==-1&&Ln[er]!==er&&(Ln[on]=Ln[er]));for(on=1;on<xr;++on)if(nn[on].type!==0){if((ir=on)!=Ln[ir])for(;ir=Ln[ir],Vn[on]=Vn[ir]+"/"+Vn[on],ir!==0&&Ln[ir]!==-1&&ir!=Ln[ir];);Ln[on]=-1}for(Vn[0]+="/",on=1;on<xr;++on)nn[on].type!==2&&(Vn[on]+="/")})(zn,fn,Hn),Hn.shift(),fn={FileIndex:zn,FullPaths:fn},vt&&vt.raw&&(fn.raw={header:Jt,sectors:xn}),fn}function S(De,vt){return new Date(1e3*(ns(De,vt+4)/1e7*Math.pow(2,32)+ns(De,vt)/1e7-11644473600))}function T(De,yt){var He=yt||{},yt=He.root||"Root Entry";if(De.FullPaths||(De.FullPaths=[]),De.FileIndex||(De.FileIndex=[]),De.FullPaths.length!==De.FileIndex.length)throw new Error("inconsistent CFB structure");De.FullPaths.length===0&&(De.FullPaths[0]=yt+"/",De.FileIndex[0]={name:yt,type:5}),He.CLSID&&(De.FileIndex[0].clsid=He.CLSID),yt=De,He="Sh33tJ5",$t.find(yt,"/"+He)||((De=Mt(4))[0]=55,De[1]=De[3]=50,De[2]=54,yt.FileIndex.push({name:He,type:2,content:De,size:4,L:69,R:69,C:69}),yt.FullPaths.push(yt.FullPaths[0]+He),k(yt))}function k(De,vt){T(De);for(var He=!1,yt=!1,Ue=De.FullPaths.length-1;0<=Ue;--Ue){var Gt=De.FileIndex[Ue];switch(Gt.type){case 0:yt?He=!0:(De.FileIndex.pop(),De.FullPaths.pop());break;case 1:case 2:case 5:yt=!0,isNaN(Gt.R*Gt.L*Gt.C)&&(He=!0),-1<Gt.R&&-1<Gt.L&&Gt.R==Gt.L&&(He=!0);break;default:He=!0}}if(He||vt){for(var ft=new Date(1987,1,19),St=0,ut=Object.create?Object.create(null):{},Rt=[],Ue=0;Ue<De.FullPaths.length;++Ue)ut[De.FullPaths[Ue]]=!0,De.FileIndex[Ue].type!==0&&Rt.push([De.FullPaths[Ue],De.FileIndex[Ue]]);for(Ue=0;Ue<Rt.length;++Ue){var Jt=u(Rt[Ue][0]);(yt=ut[Jt])||(Rt.push([Jt,{name:h(Jt).replace("/",""),type:1,clsid:me,ct:ft,mt:ft,content:null}]),ut[Jt]=!0)}for(Rt.sort(function(xn,_n){return(function(Hn,zn){for(var fn,nn=Hn.split("/"),Vn=zn.split("/"),kn=0,on=Math.min(nn.length,Vn.length);kn<on;++kn){if(fn=nn[kn].length-Vn[kn].length)return fn;if(nn[kn]!=Vn[kn])return nn[kn]<Vn[kn]?-1:1}return nn.length-Vn.length})(xn[0],_n[0])}),De.FullPaths=[],De.FileIndex=[],Ue=0;Ue<Rt.length;++Ue)De.FullPaths[Ue]=Rt[Ue][0],De.FileIndex[Ue]=Rt[Ue][1];for(Ue=0;Ue<Rt.length;++Ue){var Mn=De.FileIndex[Ue],Pn=De.FullPaths[Ue];if(Mn.name=h(Pn).replace("/",""),Mn.L=Mn.R=Mn.C=-(Mn.color=1),Mn.size=Mn.content?Mn.content.length:0,Mn.start=0,Mn.clsid=Mn.clsid||me,Ue===0)Mn.C=1<Rt.length?1:-1,Mn.size=0,Mn.type=5;else if(Pn.slice(-1)=="/"){for(St=Ue+1;St<Rt.length&&u(De.FullPaths[St])!=Pn;++St);for(Mn.C=St>=Rt.length?-1:St,St=Ue+1;St<Rt.length&&u(De.FullPaths[St])!=u(Pn);++St);Mn.R=St>=Rt.length?-1:St,Mn.type=1}else u(De.FullPaths[Ue+1]||"")==u(Pn)&&(Mn.R=Ue+1),Mn.type=2}}}function _(De,vt){var He=vt||{};if(He.fileType=="mad")return(function(Pn,xn){for(var _n=xn||{},Hn=_n.boundary||"SheetJS",zn=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(Hn="------="+Hn).slice(2)+'"',"","",""],fn=Pn.FullPaths[0],nn=fn,Vn=Pn.FileIndex[0],kn=1;kn<Pn.FullPaths.length;++kn)if(nn=Pn.FullPaths[kn].slice(fn.length),(Vn=Pn.FileIndex[kn]).size&&Vn.content&&nn!="Sh33tJ5"){nn=nn.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ln){return"_x"+Ln.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ln){return"_u"+Ln.charCodeAt(0).toString(16)+"_"});for(var on=Vn.content,er=W&&Buffer.isBuffer(on)?on.toString("binary"):Y(on),Gn=0,Ro=Math.min(1024,er.length),ir=0,xr=0;xr<=Ro;++xr)32<=(ir=er.charCodeAt(xr))&&ir<128&&++Gn;on=4*Ro/5<=Gn,zn.push(Hn),zn.push("Content-Location: "+(_n.root||"file:///C:/SheetJS/")+nn),zn.push("Content-Transfer-Encoding: "+(on?"quoted-printable":"base64")),zn.push("Content-Type: "+(function(i,zr){if(i.ctype)return i.ctype;var Pr=i.name||"",i=Pr.match(/\.([^\.]+)$/);return i&&Ka[i[1]]||zr&&(i=(Pr=zr).match(/[\.\\]([^\.\\])+$/))&&Ka[i[1]]?Ka[i[1]]:"application/octet-stream"})(Vn,nn)),zn.push(""),zn.push((on?function(Ln){Ln=Ln.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(P){return P=P.charCodeAt(0).toString(16).toUpperCase(),"="+(P.length==1?"0"+P:P)}),(Ln=Ln.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(Ln="=0D"+Ln.slice(1)),Ln=Ln.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var zr=[],Pr=Ln.split(`\r
`),i=0;i<Pr.length;++i){var l=Pr[i];if(l.length!=0)for(var p=0;p<l.length;){var b=76,D=l.slice(p,p+b);D.charAt(b-1)=="="?b--:D.charAt(b-2)=="="?b-=2:D.charAt(b-3)=="="&&(b-=3),D=l.slice(p,p+b),(p+=b)<l.length&&(D+="="),zr.push(D)}else zr.push("")}return zr.join(`\r
`)}:function(Ln){for(var zr=H(Ln),Pr=[],i=0;i<zr.length;i+=76)Pr.push(zr.slice(i,i+76));return Pr.join(`\r
`)+`\r
`})(er))}return zn.push(Hn+`--\r
`),zn.join(`\r
`)})(De,He);if(k(De),He.fileType==="zip")return(function(Pn,_n){var _n=_n||{},Hn=[],zn=[],fn=Mt(1),nn=_n.compression?8:0,Vn=0,kn=0,on=0,er=0,Gn=0,Ro=Pn.FullPaths[0],ir=Ro,xr=Pn.FileIndex[0],Ln=[],zr=0;for(kn=1;kn<Pn.FullPaths.length;++kn)if(ir=Pn.FullPaths[kn].slice(Ro.length),(xr=Pn.FileIndex[kn]).size&&xr.content&&ir!="Sh33tJ5"){var Pr=er,i=Mt(ir.length);for(on=0;on<ir.length;++on)i.write_shift(1,127&ir.charCodeAt(on));i=i.slice(0,i.l),Ln[Gn]=Kn.buf(xr.content,0);var l=xr.content;nn==8&&(l=(function(p){return L?L.deflateRawSync(p):An(p)})(l)),(fn=Mt(30)).write_shift(4,67324752),fn.write_shift(2,20),fn.write_shift(2,Vn),fn.write_shift(2,nn),xr.mt?(function(p,b){var D=(b=typeof b=="string"?new Date(b):b).getHours();D=(D=D<<6|b.getMinutes())<<5|b.getSeconds()>>>1,p.write_shift(2,D),D=(D=(D=b.getFullYear()-1980)<<4|b.getMonth()+1)<<5|b.getDate(),p.write_shift(2,D)})(fn,xr.mt):fn.write_shift(4,0),fn.write_shift(-4,Ln[Gn]),fn.write_shift(4,l.length),fn.write_shift(4,xr.content.length),fn.write_shift(2,i.length),fn.write_shift(2,0),er+=fn.length,Hn.push(fn),er+=i.length,Hn.push(i),er+=l.length,Hn.push(l),(fn=Mt(46)).write_shift(4,33639248),fn.write_shift(2,0),fn.write_shift(2,20),fn.write_shift(2,Vn),fn.write_shift(2,nn),fn.write_shift(4,0),fn.write_shift(-4,Ln[Gn]),fn.write_shift(4,l.length),fn.write_shift(4,xr.content.length),fn.write_shift(2,i.length),fn.write_shift(2,0),fn.write_shift(2,0),fn.write_shift(2,0),fn.write_shift(2,0),fn.write_shift(4,0),fn.write_shift(4,Pr),zr+=fn.l,zn.push(fn),zr+=i.length,zn.push(i),++Gn}return(fn=Mt(22)).write_shift(4,101010256),fn.write_shift(2,0),fn.write_shift(2,0),fn.write_shift(2,Gn),fn.write_shift(2,Gn),fn.write_shift(4,zr),fn.write_shift(4,er),fn.write_shift(2,0),ce([ce(Hn),ce(zn),fn])})(De,He);for(var yt=(function(Pn){for(var xn=0,_n=0,Hn=0;Hn<Pn.FileIndex.length;++Hn){var zn=Pn.FileIndex[Hn];zn.content&&0<(zn=zn.content.length)&&(zn<4096?xn+=zn+63>>6:_n+=zn+511>>9)}for(var fn=Pn.FullPaths.length+3>>2,nn=xn+127>>7,Vn=(xn+7>>3)+_n+fn+nn,kn=Vn+127>>7,on=kn<=109?0:Math.ceil((kn-109)/127);kn<Vn+kn+on+127>>7;)on=++kn<=109?0:Math.ceil((kn-109)/127);return fn=[1,on,kn,nn,fn,_n,xn,0],Pn.FileIndex[0].size=xn<<6,fn[7]=(Pn.FileIndex[0].start=fn[0]+fn[1]+fn[2]+fn[3]+fn[4]+fn[5])+(fn[6]+7>>3),fn})(De),Ue=Mt(yt[7]<<9),ft=0,Gt=0,ft=0;ft<8;++ft)Ue.write_shift(1,G[ft]);for(ft=0;ft<8;++ft)Ue.write_shift(2,0);for(Ue.write_shift(2,62),Ue.write_shift(2,3),Ue.write_shift(2,65534),Ue.write_shift(2,9),Ue.write_shift(2,6),ft=0;ft<3;++ft)Ue.write_shift(2,0);for(Ue.write_shift(4,0),Ue.write_shift(4,yt[2]),Ue.write_shift(4,yt[0]+yt[1]+yt[2]+yt[3]-1),Ue.write_shift(4,0),Ue.write_shift(4,4096),Ue.write_shift(4,yt[3]?yt[0]+yt[1]+yt[2]-1:z),Ue.write_shift(4,yt[3]),Ue.write_shift(-4,yt[1]?yt[0]-1:z),Ue.write_shift(4,yt[1]),ft=0;ft<109;++ft)Ue.write_shift(-4,ft<yt[2]?yt[1]+ft:-1);if(yt[1])for(Gt=0;Gt<yt[1];++Gt){for(;ft<236+127*Gt;++ft)Ue.write_shift(-4,ft<yt[2]?yt[1]+ft:-1);Ue.write_shift(-4,Gt===yt[1]-1?z:Gt+1)}function St(Pn){for(Gt+=Pn;ft<Gt-1;++ft)Ue.write_shift(-4,ft+1);Pn&&(++ft,Ue.write_shift(-4,z))}for(Gt=ft=0,Gt+=yt[1];ft<Gt;++ft)Ue.write_shift(-4,re.DIFSECT);for(Gt+=yt[2];ft<Gt;++ft)Ue.write_shift(-4,re.FATSECT);St(yt[3]),St(yt[4]);for(var ut=0,Rt=0,Jt=De.FileIndex[0];ut<De.FileIndex.length;++ut)(Jt=De.FileIndex[ut]).content&&((Rt=Jt.content.length)<4096||(Jt.start=Gt,St(Rt+511>>9)));for(St(yt[6]+7>>3);511&Ue.l;)Ue.write_shift(-4,re.ENDOFCHAIN);for(ut=Gt=ft=0;ut<De.FileIndex.length;++ut)(Jt=De.FileIndex[ut]).content&&(!(Rt=Jt.content.length)||4096<=Rt||(Jt.start=Gt,St(Rt+63>>6)));for(;511&Ue.l;)Ue.write_shift(-4,re.ENDOFCHAIN);for(ft=0;ft<yt[4]<<2;++ft){var Mn=De.FullPaths[ft];if(Mn&&Mn.length!==0){if(Jt=De.FileIndex[ft],ft===0&&(Jt.start=Jt.size?Jt.start-1:z),Mn=ft===0&&He.root||Jt.name,Rt=2*(Mn.length+1),Ue.write_shift(64,Mn,"utf16le"),Ue.write_shift(2,Rt),Ue.write_shift(1,Jt.type),Ue.write_shift(1,Jt.color),Ue.write_shift(-4,Jt.L),Ue.write_shift(-4,Jt.R),Ue.write_shift(-4,Jt.C),Jt.clsid)Ue.write_shift(16,Jt.clsid,"hex");else for(ut=0;ut<4;++ut)Ue.write_shift(4,0);Ue.write_shift(4,Jt.state||0),Ue.write_shift(4,0),Ue.write_shift(4,0),Ue.write_shift(4,0),Ue.write_shift(4,0),Ue.write_shift(4,Jt.start),Ue.write_shift(4,Jt.size),Ue.write_shift(4,0)}else{for(ut=0;ut<17;++ut)Ue.write_shift(4,0);for(ut=0;ut<3;++ut)Ue.write_shift(4,-1);for(ut=0;ut<12;++ut)Ue.write_shift(4,0)}}for(ft=1;ft<De.FileIndex.length;++ft)if(4096<=(Jt=De.FileIndex[ft]).size)if(Ue.l=Jt.start+1<<9,W&&Buffer.isBuffer(Jt.content))Jt.content.copy(Ue,Ue.l,0,Jt.size),Ue.l+=Jt.size+511&-512;else{for(ut=0;ut<Jt.size;++ut)Ue.write_shift(1,Jt.content[ut]);for(;511&ut;++ut)Ue.write_shift(1,0)}for(ft=1;ft<De.FileIndex.length;++ft)if(0<(Jt=De.FileIndex[ft]).size&&Jt.size<4096)if(W&&Buffer.isBuffer(Jt.content))Jt.content.copy(Ue,Ue.l,0,Jt.size),Ue.l+=Jt.size+63&-64;else{for(ut=0;ut<Jt.size;++ut)Ue.write_shift(1,Jt.content[ut]);for(;63&ut;++ut)Ue.write_shift(1,0)}if(W)Ue.l=Ue.length;else for(;Ue.l<Ue.length;)Ue.write_shift(1,0);return Ue}c.version="1.2.1";var L,B=64,z=-2,Z="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:Z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(De){for(var vt=new Array(De.length),He=0;He<De.length;++He)vt[He]=String.fromCharCode(De[He]);return vt.join("")}for(var he=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],$e,ot=typeof Uint8Array<"u",et=ot?new Uint8Array(256):[],dt=0;dt<256;++dt)et[dt]=255&(($e=139536&(($e=dt)<<1|$e<<11)|558144&($e<<5|$e<<15))>>16|$e>>8|$e);function Ot(De,yt){var He=7&yt,yt=yt>>>3;return(De[yt]|(He<=5?0:De[1+yt]<<8))>>>He&7}function jt(De,yt){var He=7&yt,yt=yt>>>3;return(De[yt]|(He<=3?0:De[1+yt]<<8))>>>He&31}function bt(De,yt){var He=7&yt,yt=yt>>>3;return(De[yt]|(He<=1?0:De[1+yt]<<8))>>>He&127}function Qt(De,ft,He){var yt=7&ft,Ue=ft>>>3,Gt=(1<<He)-1,ft=De[Ue]>>>yt;return He<8-yt?ft&Gt:(ft|=De[1+Ue]<<8-yt,He<16-yt?ft&Gt:(ft|=De[2+Ue]<<16-yt,He<24-yt?ft&Gt:(ft|=De[3+Ue]<<24-yt)&Gt))}function Tn(De,vt,He){var yt=7&vt,Ue=vt>>>3;return yt<=5?De[Ue]|=(7&He)<<yt:(De[Ue]|=He<<yt&255,De[1+Ue]=(7&He)>>8-yt),vt+3}function wn(De,vt,He){var yt=vt>>>3;return He<<=7&vt,De[yt]|=255&He,He>>>=8,De[1+yt]=He,vt+8}function sn(De,vt,He){var yt=vt>>>3;return He<<=7&vt,De[yt]|=255&He,He>>>=8,De[1+yt]=255&He,De[2+yt]=He>>>8,vt+16}function dn(De,vt){var He=De.length,yt=vt<2*He?2*He:vt+5,Ue=0;if(vt<=He)return De;if(W){var Gt=ie(yt);if(De.copy)De.copy(Gt);else for(;Ue<De.length;++Ue)Gt[Ue]=De[Ue];return Gt}if(ot){var ft=new Uint8Array(yt);if(ft.set)ft.set(De);else for(;Ue<He;++Ue)ft[Ue]=De[Ue];return ft}return De.length=yt,De}function rn(De){for(var vt=new Array(De),He=0;He<De;++He)vt[He]=0;return vt}function Vt(De,vt,He){for(var yt,Ue=1,Rt=0,Gt=0,ft=0,St=De.length,ut=ot?new Uint16Array(32):rn(32),Rt=0;Rt<32;++Rt)ut[Rt]=0;for(Rt=St;Rt<He;++Rt)De[Rt]=0;St=De.length;var Jt=ot?new Uint16Array(St):rn(St);for(Rt=0;Rt<St;++Rt)ut[yt=De[Rt]]++,Ue<yt&&(Ue=yt),Jt[Rt]=0;for(ut[0]=0,Rt=1;Rt<=Ue;++Rt)ut[Rt+16]=ft=ft+ut[Rt-1]<<1;for(Rt=0;Rt<St;++Rt)(ft=De[Rt])!=0&&(Jt[Rt]=ut[ft+16]++);var Mn,Pn,xn,_n;for(Rt=0;Rt<St;++Rt)if((Mn=De[Rt])!=0)for(Pn=Jt[Rt],xn=Ue,_n=void 0,_n=et[255&Pn],ft=(xn<=8?_n>>>8-xn:(_n=_n<<8|et[Pn>>8&255],xn<=16?_n>>>16-xn:(_n=_n<<8|et[Pn>>16&255])>>>24-xn))>>Ue-Mn,Gt=(1<<Ue+4-Mn)-1;0<=Gt;--Gt)vt[ft|Gt<<Mn]=15&Mn|Rt<<4;return Ue}var Rn=ot?new Uint16Array(512):rn(512),Fn=ot?new Uint16Array(32):rn(32);if(!ot){for(var qn=0;qn<512;++qn)Rn[qn]=0;for(qn=0;qn<32;++qn)Fn[qn]=0}(function(){for(var De=[],vt=0;vt<32;vt++)De.push(5);Vt(De,Fn,32);for(var He=[],vt=0;vt<=143;vt++)He.push(8);for(;vt<=255;vt++)He.push(9);for(;vt<=279;vt++)He.push(7);for(;vt<=287;vt++)He.push(8);Vt(He,Rn,288)})();var Dr=(function(){for(var De=ot?new Uint8Array(32768):[],vt=0,He=0;vt<we.length-1;++vt)for(;He<we[vt+1];++He)De[He]=vt;for(;He<32768;++He)De[He]=29;for(var yt=ot?new Uint8Array(259):[],vt=0,He=0;vt<Ce.length-1;++vt)for(;He<Ce[vt+1];++He)yt[He]=vt;return function(Ue,Gt){return(Ue.length<8?function(ft,St){for(var ut=0;ut<ft.length;){var Rt=Math.min(65535,ft.length-ut),Jt=ut+Rt==ft.length;for(St.write_shift(1,+Jt),St.write_shift(2,Rt),St.write_shift(2,65535&~Rt);0<Rt--;)St[St.l++]=ft[ut++]}return St.l}:function(ft,St){for(var ut=0,Rt=0,Jt=ot?new Uint16Array(32768):[];Rt<ft.length;){var Mn=Math.min(65535,ft.length-Rt);if(Mn<10){for(7&(ut=Tn(St,ut,+(Rt+Mn==ft.length)))&&(ut+=8-(7&ut)),St.l=ut/8|0,St.write_shift(2,Mn),St.write_shift(2,65535&~Mn);0<Mn--;)St[St.l++]=ft[Rt++];ut=8*St.l}else{ut=Tn(St,ut,+(Rt+Mn==ft.length)+2);for(var Pn=0;0<Mn--;){var xn=ft[Rt],Pn=32767&(Pn<<5^xn),_n=-1,Hn=0;if((_n=Jt[Pn])&&(Rt<(_n|=-32768&Rt)&&(_n-=32768),_n<Rt))for(;ft[_n+Hn]==ft[Rt+Hn]&&Hn<250;)++Hn;if(2<Hn){(xn=yt[Hn])<=22?ut=wn(St,ut,et[xn+1]>>1)-1:(wn(St,ut,3),wn(St,ut+=5,et[xn-23]>>5),ut+=3);var zn=xn<8?0:xn-4>>2;0<zn&&(sn(St,ut,Hn-Ce[xn]),ut+=zn),xn=De[Rt-_n],ut=wn(St,ut,et[xn]>>3),ut-=3;var fn=xn<4?0:xn-2>>1;0<fn&&(sn(St,ut,Rt-_n-we[xn]),ut+=fn);for(var nn=0;nn<Hn;++nn)Jt[Pn]=32767&Rt,Pn=32767&(Pn<<5^ft[Rt]),++Rt;Mn-=Hn-1}else xn<=143?xn+=48:(zn=((zn=1)&zn)<<(7&(fn=ut)),St[fn>>>3]|=zn,ut=fn+1),ut=wn(St,ut,et[xn]),Jt[Pn]=32767&Rt,++Rt}ut=wn(St,ut,0)-1}}return St.l=(ut+7)/8|0,St.l})(Ue,Gt)}})();function An(He){var vt=Mt(50+Math.floor(1.1*He.length)),He=Dr(He,vt);return vt.slice(0,He)}var Xt=ot?new Uint16Array(32768):rn(32768),pr=ot?new Uint16Array(32768):rn(32768),Vr=ot?new Uint16Array(128):rn(128),jr=1,so=1;function oa(De,vt){if(De[0]==3&&!(3&De[1]))return[ee(vt),2];for(var He=0,yt=0,Ue=ie(vt||1<<18),Gt=0,ft=Ue.length>>>0,St=0,ut=0;(1&yt)==0;)if(yt=Ot(De,He),He+=3,yt>>>1!=0)for(ut=yt>>1==1?(St=9,5):(He=(function(Hn,zn){var fn,nn,Vn,kn=jt(Hn,zn)+257,on=jt(Hn,zn+=5)+1,er=(Vn=7&(nn=zn+=5),4+(((fn=Hn)[nn=nn>>>3]|(Vn<=4?0:fn[1+nn]<<8))>>>Vn&15));zn+=4;for(var Gn=0,Ro=ot?new Uint8Array(19):rn(19),ir=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xr=1,Ln=ot?new Uint8Array(8):rn(8),zr=ot?new Uint8Array(8):rn(8),Pr=Ro.length,i=0;i<er;++i)Ro[he[i]]=Gn=Ot(Hn,zn),xr<Gn&&(xr=Gn),Ln[Gn]++,zn+=3;var l=0;for(Ln[0]=0,i=1;i<=xr;++i)zr[i]=l=l+Ln[i-1]<<1;for(i=0;i<Pr;++i)(l=Ro[i])!=0&&(ir[i]=zr[l]++);for(var p,i=0;i<Pr;++i)if((p=Ro[i])!=0){l=et[ir[i]]>>8-p;for(var b=(1<<7-p)-1;0<=b;--b)Vr[l|b<<p]=7&p|i<<3}for(var D,P,q,ge=[],xr=1;ge.length<kn+on;)switch(zn+=7&(l=Vr[bt(Hn,zn)]),l>>>=3){case 16:for(Gn=3+(q=void 0,q=7&(P=zn),((D=Hn)[P=P>>>3]|(q<=6?0:D[1+P]<<8))>>>q&3),zn+=2,l=ge[ge.length-1];0<Gn--;)ge.push(l);break;case 17:for(Gn=3+Ot(Hn,zn),zn+=3;0<Gn--;)ge.push(0);break;case 18:for(Gn=11+bt(Hn,zn),zn+=7;0<Gn--;)ge.push(0);break;default:ge.push(l),xr<l&&(xr=l)}var Le=ge.slice(0,kn),ct=ge.slice(kn);for(i=kn;i<286;++i)Le[i]=0;for(i=on;i<30;++i)ct[i]=0;return jr=Vt(Le,Xt,286),so=Vt(ct,pr,30),zn})(De,He),St=jr,so);;){!vt&&ft<Gt+32767&&(ft=(Ue=dn(Ue,Gt+32767)).length);var Rt=Qt(De,He,St),Jt=(yt>>>1==1?Rn:Xt)[Rt];if(He+=15&Jt,((Jt>>>=4)>>>8&255)==0)Ue[Gt++]=Jt;else{if(Jt==256)break;var Mn=(Jt-=257)<8?0:Jt-4>>2;5<Mn&&(Mn=0);var Pn=Gt+Ce[Jt];0<Mn&&(Pn+=Qt(De,He,Mn),He+=Mn),Rt=Qt(De,He,ut),He+=15&(Jt=(yt>>>1==1?Fn:pr)[Rt]);var Rt=(Jt>>>=4)<4?0:Jt-2>>1,xn=we[Jt];for(0<Rt&&(xn+=Qt(De,He,Rt),He+=Rt),!vt&&ft<Pn&&(ft=(Ue=dn(Ue,Pn+100)).length);Gt<Pn;)Ue[Gt]=Ue[Gt-xn],++Gt}}else{7&He&&(He+=8-(7&He));var _n=De[He>>>3]|De[1+(He>>>3)]<<8;if(He+=32,0<_n)for(!vt&&ft<Gt+_n&&(ft=(Ue=dn(Ue,Gt+_n)).length);0<_n--;)Ue[Gt++]=De[He>>>3],He+=8}return vt?[Ue,He+7>>>3]:[Ue.slice(0,Gt),He+7>>>3]}function Ye(De,vt){return vt=oa(De.slice(De.l||0),vt),De.l+=vt[1],vt[0]}function io(De,vt){if(!De)throw new Error(vt);typeof console<"u"&&console.error(vt)}function Qr(De,vt){var He=De;ds(He,0);var yt={FileIndex:[],FullPaths:[]};T(yt,{root:vt.root});for(var Ue=He.length-4;(He[Ue]!=80||He[Ue+1]!=75||He[Ue+2]!=5||He[Ue+3]!=6)&&0<=Ue;)--Ue;He.l=Ue+4,He.l+=4;var Gt=He.read_shift(2);for(He.l+=6,vt=He.read_shift(4),He.l=vt,Ue=0;Ue<Gt;++Ue){He.l+=20;var ft=He.read_shift(4),St=He.read_shift(4),ut=He.read_shift(2),Rt=He.read_shift(2),Jt=He.read_shift(2);He.l+=8;var Mn=He.read_shift(4),Pn=g(He.slice(He.l+ut,He.l+ut+Rt));He.l+=ut+Rt+Jt,Jt=He.l,He.l=Mn+4,(function(xn,_n,Hn,zn,fn){xn.l+=2;var nn=xn.read_shift(2),Vn=xn.read_shift(2),kn=(function(D){var i=65535&D.read_shift(2),l=65535&D.read_shift(2),p=new Date,b=31&l,D=15&(l>>>=5);return l>>>=4,p.setMilliseconds(0),p.setFullYear(1980+l),p.setMonth(D-1),p.setDate(b),D=31&i,b=63&(i>>>=5),i>>>=6,p.setHours(i),p.setMinutes(b),p.setSeconds(D<<1),p})(xn);if(8257&nn)throw new Error("Unsupported ZIP encryption");xn.read_shift(4);for(var on,er=xn.read_shift(4),Gn=xn.read_shift(4),Ro=xn.read_shift(2),ir=xn.read_shift(2),xr="",Ln=0;Ln<Ro;++Ln)xr+=String.fromCharCode(xn[xn.l++]);ir&&(((on=g(xn.slice(xn.l,xn.l+ir)))[21589]||{}).mt&&(kn=on[21589].mt),((fn||{})[21589]||{}).mt&&(kn=fn[21589].mt)),xn.l+=ir;var zr=xn.slice(xn.l,xn.l+er);switch(Vn){case 8:zr=(function(Pr,p){if(!L)return Ye(Pr,p);var l=new L.InflateRaw,p=l._processChunk(Pr.slice(Pr.l),l._finishFlushFlag);return Pr.l+=l.bytesRead,p})(xn,Gn);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Vn)}ir=!1,8&nn&&(xn.read_shift(4)==134695760&&(xn.read_shift(4),ir=!0),er=xn.read_shift(4),Gn=xn.read_shift(4)),er!=_n&&io(ir,"Bad compressed size: "+_n+" != "+er),Gn!=Hn&&io(ir,"Bad uncompressed size: "+Hn+" != "+Gn),Wi(zn,xr,zr,{unsafe:!0,mt:kn})})(He,ft,St,yt,Pn),He.l=Jt}return yt}var Ka={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wi(De,vt,He,yt){var Ue=yt&&yt.unsafe;Ue||T(De);var Gt,ft=!Ue&&$t.find(De,vt);return ft||(Gt=De.FullPaths[0],Gt=vt.slice(0,Gt.length)==Gt?vt:(Gt.slice(-1)!="/"&&(Gt+="/"),(Gt+vt).replace("//","/")),ft={name:h(vt),type:2},De.FileIndex.push(ft),De.FullPaths.push(Gt),Ue||$t.utils.cfb_gc(De)),ft.content=He,ft.size=He?He.length:0,yt&&(yt.CLSID&&(ft.clsid=yt.CLSID),yt.mt&&(ft.mt=yt.mt),yt.ct&&(ft.ct=yt.ct)),ft}return c.find=function(De,vt){var He=De.FullPaths.map(function(ut){return ut.toUpperCase()}),yt=He.map(function(ut){var Rt=ut.split("/");return Rt[Rt.length-(ut.slice(-1)=="/"?2:1)]}),Ue=!1;vt.charCodeAt(0)===47?(Ue=!0,vt=He[0].slice(0,-1)+vt):Ue=vt.indexOf("/")!==-1;var St=vt.toUpperCase(),Gt=(Ue===!0?He:yt).indexOf(St);if(Gt!==-1)return De.FileIndex[Gt];var ft=!St.match(Se),St=St.replace(ne,"");for(ft&&(St=St.replace(Se,"!")),Gt=0;Gt<He.length;++Gt)if((ft?He[Gt].replace(Se,"!"):He[Gt]).replace(ne,"")==St||(ft?yt[Gt].replace(Se,"!"):yt[Gt]).replace(ne,"")==St)return De.FileIndex[Gt];return null},c.read=function(De,vt){var He,yt,Ue=vt&&vt.type;switch(Ue||W&&Buffer.isBuffer(De)&&(Ue="buffer"),Ue||"base64"){case"file":return He=De,yt=vt,x(),v(s.readFileSync(He),yt);case"base64":return v(de(K(De)),vt);case"binary":return v(de(De),vt)}return v(De,vt)},c.parse=v,c.write=function(De,vt){var He=_(De,vt);switch(vt&&vt.type||"buffer"){case"file":return x(),s.writeFileSync(vt.filename,He),He;case"binary":return typeof He=="string"?He:Y(He);case"base64":return H(typeof He=="string"?He:Y(He));case"buffer":if(W)return Buffer.isBuffer(He)?He:X(He);case"array":return typeof He=="string"?de(He):He}return He},c.writeFile=function(De,vt,He){x(),He=_(De,He),s.writeFileSync(vt,He)},c.utils={cfb_new:function(De){var vt={};return T(vt,De),vt},cfb_add:Wi,cfb_del:function(De,vt){T(De);var He=$t.find(De,vt);if(He){for(var yt=0;yt<De.FileIndex.length;++yt)if(De.FileIndex[yt]==He)return De.FileIndex.splice(yt,1),De.FullPaths.splice(yt,1),!0}return!1},cfb_mov:function(De,vt,He){T(De);var yt=$t.find(De,vt);if(yt){for(var Ue=0;Ue<De.FileIndex.length;++Ue)if(De.FileIndex[Ue]==yt)return De.FileIndex[Ue].name=h(He),De.FullPaths[Ue]=He,!0}return!1},cfb_gc:function(De){k(De,!0)},ReadShift:jd,CheckField:qb,prep_blob:ds,bconcat:ce,use_zlib:function(De){try{var vt=new De.InflateRaw;if(vt._processChunk(new Uint8Array([3,0]),vt._finishFlushFlag),!vt.bytesRead)throw new Error("zlib does not expose bytesRead");L=De}catch(He){console.error("cannot use native zlib: "+(He.message||He))}},_deflateRaw:An,_inflateRaw:Ye,consts:re},c})();if(typeof d2<"u")try{Zt=Ow}catch{}function Cr(s){return typeof s=="string"?le(s):Array.isArray(s)?(function(c){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(c)})(s):s}function tr(s,c,u){if(Zt!==void 0&&Zt.writeFileSync)return u?Zt.writeFileSync(s,c,u):Zt.writeFileSync(s,c);if(typeof Deno<"u"){if(u&&typeof c=="string")switch(u){case"utf8":c=new TextEncoder(u).encode(c);break;case"binary":c=le(c);break;default:throw new Error("Unsupported encoding "+u)}return Deno.writeFileSync(s,c)}var h=u=="utf8"?ks(c):c;if(typeof IE_SaveFile<"u")return IE_SaveFile(h,s);if(typeof Blob<"u"){if(h=new Blob([Cr(h)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(h,s);if(typeof saveAs<"u")return saveAs(h,s);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var g=URL.createObjectURL(h);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),chrome.downloads.download({url:g,filename:s,saveAs:!0});if(h=document.createElement("a"),h.download!=null)return h.download=s,h.href=g,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(g)},6e4),g}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var x=File(s);return x.open("w"),x.encoding="binary",Array.isArray(c)&&(c=oe(c)),x.write(c),x.close(),c}catch(v){if(!v.message||!v.message.match(/onstruct/))throw v}throw new Error("cannot save file "+s)}function Bt(s){for(var c=Object.keys(s),u=[],h=0;h<c.length;++h)Object.prototype.hasOwnProperty.call(s,c[h])&&u.push(c[h]);return u}function gr(s,c){for(var u=[],h=Bt(s),g=0;g!==h.length;++g)u[s[h[g]][c]]==null&&(u[s[h[g]][c]]=h[g]);return u}function en(s){for(var c=[],u=Bt(s),h=0;h!==u.length;++h)c[s[u[h]]]=u[h];return c}function un(s){for(var c=[],u=Bt(s),h=0;h!==u.length;++h)c[s[u[h]]]=parseInt(u[h],10);return c}var Yn=new Date(1899,11,30,0,0,0);function En(s,c){var u=s.getTime();return(u-(Yn.getTime()+6e4*(s.getTimezoneOffset()-Yn.getTimezoneOffset())))/864e5}var fr=new Date,fo=Yn.getTime()+6e4*(fr.getTimezoneOffset()-Yn.getTimezoneOffset()),xo=fr.getTimezoneOffset();function Qn(s){var c=new Date;return c.setTime(24*s*60*60*1e3+fo),c.getTimezoneOffset()!==xo&&c.setTime(c.getTime()+6e4*(c.getTimezoneOffset()-xo)),c}var Or=new Date("2017-02-19T19:06:09.000Z"),Ko=isNaN(Or.getFullYear())?new Date("2/19/17"):Or,Rr=Ko.getFullYear()==2017;function Jn(s,c){var u=new Date(s);return Rr?(0<c?u.setTime(u.getTime()+60*u.getTimezoneOffset()*1e3):c<0&&u.setTime(u.getTime()-60*u.getTimezoneOffset()*1e3),u):s instanceof Date?s:Ko.getFullYear()==1917&&!isNaN(u.getFullYear())?(c=u.getFullYear(),-1<s.indexOf(""+c)||u.setFullYear(u.getFullYear()+100),u):(u=s.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0),u=-1<s.indexOf("Z")?new Date(u.getTime()-60*u.getTimezoneOffset()*1e3):u)}function aa(s,c){if(W&&Buffer.isBuffer(s)){if(c){if(s[0]==255&&s[1]==254)return ks(s.slice(2).toString("utf16le"));if(s[1]==254&&s[2]==255)return ks(M(s.slice(2).toString("binary")))}return s.toString("binary")}if(typeof TextDecoder<"u")try{if(c){if(s[0]==255&&s[1]==254)return ks(new TextDecoder("utf-16le").decode(s.slice(2)));if(s[0]==254&&s[1]==255)return ks(new TextDecoder("utf-16be").decode(s.slice(2)))}var u={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(s)&&(s=new Uint8Array(s)),new TextDecoder("latin1").decode(s).replace(/[]/g,function(x){return u[x]||x})}catch{}for(var h=[],g=0;g!=s.length;++g)h.push(String.fromCharCode(s[g]));return h.join("")}function qr(s){if(typeof JSON<"u"&&!Array.isArray(s))return JSON.parse(JSON.stringify(s));if(typeof s!="object"||s==null)return s;if(s instanceof Date)return new Date(s.getTime());var c,u={};for(c in s)Object.prototype.hasOwnProperty.call(s,c)&&(u[c]=qr(s[c]));return u}function ho(s,c){for(var u="";u.length<c;)u+=s;return u}function ts(h){var c=Number(h);if(!isNaN(c))return isFinite(c)?c:NaN;if(!/\d/.test(h))return c;var u=1,h=h.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return u*=100,""});return isNaN(c=Number(h))?(h=h.replace(/[(](.*)[)]/,function(g,x){return u=-u,x}),isNaN(c=Number(h))?c:c/u):c/u}var Pt=["january","february","march","april","may","june","july","august","september","october","november","december"];function Tt(s){var c=new Date(s),u=new Date(NaN),h=c.getYear(),g=c.getMonth(),x=c.getDate();if(isNaN(x))return u;var v=s.toLowerCase();if(v.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(v=v.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&Pt.indexOf(v)==-1)return u}else if(v.match(/[a-z]/))return u;return h<0||8099<h||(!(0<g||1<x)||h==101)&&s.match(/[^-0-9:,\/\\]/)?u:c}var Dn,nr=(Dn="abacaba".split(/(:?b)/i).length==5,function(s,c,u){if(Dn||typeof c=="string")return s.split(c);for(var h=s.split(c),g=[h[0]],x=1;x<h.length;++x)g.push(u),g.push(h[x]);return g});function or(s){return s?s.content&&s.type?aa(s.content,!0):s.data?F(s.data):s.asNodeBuffer&&W?F(s.asNodeBuffer().toString("binary")):s.asBinary?F(s.asBinary()):s._data&&s._data.getContent?F(aa(Array.prototype.slice.call(s._data.getContent(),0))):null:null}function Ao(s){if(!s)return null;if(s.data)return I(s.data);if(s.asNodeBuffer&&W)return s.asNodeBuffer();if(s._data&&s._data.getContent){var c=s._data.getContent();return typeof c=="string"?I(c):Array.prototype.slice.call(c)}return s.content&&s.type?s.content:null}function kr(s,c){for(var u=s.FullPaths||Bt(s.files),h=c.toLowerCase().replace(/[\/]/g,"\\"),g=h.replace(/\\/g,"/"),x=0;x<u.length;++x){var v=u[x].replace(/^Root Entry[\/]/,"").toLowerCase();if(h==v||g==v)return s.files?s.files[u[x]]:s.FileIndex[x]}return null}function Zr(s,c){if(s=kr(s,c),s==null)throw new Error("Cannot find file "+c+" in zip");return s}function Eo(s,c,u){if(!u)return((u=Zr(s,c))&&u.name.slice(-4)===".bin"?Ao:or)(u);if(!c)return null;try{return Eo(s,c)}catch{return null}}function da(s,c,u){if(!u)return or(Zr(s,c));if(!c)return null;try{return da(s,c)}catch{return null}}function bs(s){for(var c=s.FullPaths||Bt(s.files),u=[],h=0;h<c.length;++h)c[h].slice(-1)!="/"&&u.push(c[h].replace(/^Root Entry[\/]/,""));return u.sort()}function ar(s,c,u){if(s.FullPaths){if(typeof u=="string"){var h=(W?X:function(g){for(var x=[],v=0,S=g.length+250,T=ee(g.length+255),k=0;k<g.length;++k){var _,L=g.charCodeAt(k);L<128?T[v++]=L:L<2048?(T[v++]=192|L>>6&31,T[v++]=128|63&L):55296<=L&&L<57344?(L=64+(1023&L),_=1023&g.charCodeAt(++k),T[v++]=240|L>>8&7,T[v++]=128|L>>2&63,T[v++]=128|_>>6&15|(3&L)<<4,T[v++]=128|63&_):(T[v++]=224|L>>12&15,T[v++]=128|L>>6&63,T[v++]=128|63&L),S<v&&(x.push(T.slice(0,v)),v=0,T=ee(65535),S=65530)}return x.push(T.slice(0,v)),ce(x)})(u);return $t.utils.cfb_add(s,c,h)}$t.utils.cfb_add(s,c,u)}else s.file(c,u)}function Fr(){return $t.utils.cfb_new()}function Vs(s,c){switch(c.type){case"base64":return $t.read(s,{type:"base64"});case"binary":return $t.read(s,{type:"binary"});case"buffer":case"array":return $t.read(s,{type:"buffer"})}throw new Error("Unrecognized type "+c.type)}function ke(s,c){if(s.charAt(0)=="/")return s.slice(1);var u=c.split("/");c.slice(-1)!="/"&&u.pop();for(var h=s.split("/");h.length!==0;){var g=h.shift();g===".."?u.pop():g!=="."&&u.push(g)}return u.join("/")}var Ke=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,cn=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_h=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,$n=Ke.match(_h)?_h:/<[^>]*>/g,Zo=/<\w*:/,Ra=/<(\/?)\w+:/;function sr(s,c,u){for(var h={},g=0,x=0;g!==s.length&&(x=s.charCodeAt(g))!==32&&x!==10&&x!==13;++g);if(c||(h[0]=s.slice(0,g)),g===s.length)return h;var v,S,T,k=s.match(cn),_=0,L=0,B="",z="";if(k)for(L=0;L!=k.length;++L){for(z=k[L],x=0;x!=z.length&&z.charCodeAt(x)!==61;++x);for(B=z.slice(0,x).trim();z.charCodeAt(x+1)==32;)++x;for(S=(g=z.charCodeAt(x+1))==34||g==39?1:0,v=z.slice(x+1+S,z.length-S),_=0;_!=B.length&&B.charCodeAt(_)!==58;++_);_===B.length?(h[B=0<B.indexOf("_")?B.slice(0,B.indexOf("_")):B]=v,h[B.toLowerCase()]=v):h[T=(_===5&&B.slice(0,5)==="xmlns"?"xmlns":"")+B.slice(_+1)]&&B.slice(_-3,_)=="ext"||(h[T]=v,h[T.toLowerCase()]=v)}return h}function Gs(s){return s.replace(Ra,"<$1")}var Rd,Ks,Yf={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sg=en(Yf),Sr=(Rd=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,Ks=/_x([\da-fA-F]{4})_/gi,function s(c){var u=c+"",h=u.indexOf("<![CDATA[");return h==-1?u.replace(Rd,function(g,x){return Yf[g]||String.fromCharCode(parseInt(x,-1<g.indexOf("x")?16:10))||g}).replace(Ks,function(g,x){return String.fromCharCode(parseInt(x,16))}):(c=u.indexOf("]]>"),s(u.slice(0,h))+u.slice(h+9,c)+s(u.slice(c+3)))}),qf=/[&<>'"]/g,zb=/[\u0000-\u0008\u000b-\u001f]/g;function co(s){return(s+"").replace(qf,function(c){return Sg[c]}).replace(zb,function(c){return"_x"+("000"+c.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ou(s){return co(s).replace(/ /g,"_x0020_")}var wg=/[\u0000-\u001f]/g;function Op(s){return(s+"").replace(qf,function(c){return Sg[c]}).replace(/\n/g,"<br/>").replace(wg,function(c){return"&#x"+("000"+c.charCodeAt(0).toString(16)).slice(-4)+";"})}var Fu,Ub=(Fu=/&#(\d+);/g,function(s){return s.replace(Fu,$b)});function $b(s,c){return String.fromCharCode(parseInt(c,10))}function Bo(s){switch(s){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Qf(s){for(var c,u,h,g,x="",v=0,S=0;v<s.length;)(c=s.charCodeAt(v++))<128?x+=String.fromCharCode(c):(u=s.charCodeAt(v++),191<c&&c<224?(S=(31&c)<<6,S|=63&u,x+=String.fromCharCode(S)):(h=s.charCodeAt(v++),c<240?x+=String.fromCharCode((15&c)<<12|(63&u)<<6|63&h):(g=((7&c)<<18|(63&u)<<12|(63&h)<<6|63&(S=s.charCodeAt(v++)))-65536,x+=String.fromCharCode(55296+(g>>>10&1023)),x+=String.fromCharCode(56320+(1023&g)))));return x}function Hb(s){for(var c,u,h=ee(2*s.length),g=1,x=0,v=0,S=0;S<s.length;S+=g)g=1,(u=s.charCodeAt(S))<128?c=u:u<224?(c=64*(31&u)+(63&s.charCodeAt(S+1)),g=2):u<240?(c=4096*(15&u)+64*(63&s.charCodeAt(S+1))+(63&s.charCodeAt(S+2)),g=3):(g=4,c=262144*(7&u)+4096*(63&s.charCodeAt(S+1))+64*(63&s.charCodeAt(S+2))+(63&s.charCodeAt(S+3)),v=55296+((c-=65536)>>>10&1023),c=56320+(1023&c)),v!==0&&(h[x++]=255&v,h[x++]=v>>>8,v=0),h[x++]=c%256,h[x++]=c>>>8;return h.slice(0,x).toString("ucs2")}function Wb(s){return X(s,"binary").toString("utf8")}var Id,_i,Pd,Bl="foo bar baz",po=W&&(Wb(Bl)==Qf(Bl)?Wb:Hb(Bl)==Qf(Bl)&&Hb)||Qf,ks=W?function(s){return X(s,"utf8").toString("binary")}:function(s){for(var c,u=[],h=0,g=0;h<s.length;)switch(!0){case(g=s.charCodeAt(h++))<128:u.push(String.fromCharCode(g));break;case g<2048:u.push(String.fromCharCode(192+(g>>6))),u.push(String.fromCharCode(128+(63&g)));break;case(55296<=g&&g<57344):g-=55296,c=s.charCodeAt(h++)-56320+(g<<10),u.push(String.fromCharCode(240+(c>>18&7))),u.push(String.fromCharCode(144+(c>>12&63))),u.push(String.fromCharCode(128+(c>>6&63))),u.push(String.fromCharCode(128+(63&c)));break;default:u.push(String.fromCharCode(224+(g>>12))),u.push(String.fromCharCode(128+(g>>6&63))),u.push(String.fromCharCode(128+(63&g)))}return u.join("")},El=(Id={},function(s,c){var u=s+"|"+(c||"");return Id[u]||(Id[u]=new RegExp("<(?:\\w+:)?"+s+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+s+">",c||""))}),Tg=(_i=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(s){return[new RegExp("&"+s[0]+";","ig"),s[1]]}),function(s){for(var c=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<_i.length;++u)c=c.replace(_i[u][0],_i[u][1]);return c}),Ag=(Pd={},function(s){return Pd[s]!==void 0?Pd[s]:Pd[s]=new RegExp("<(?:vt:)?"+s+">([\\s\\S]*?)</(?:vt:)?"+s+">","g")}),Vb=/<\/?(?:vt:)?variant>/g,Xf=/<(?:vt:)([^>]*)>([\s\S]*)</;function kl(h,c){var u=sr(h),h=h.match(Ag(u.baseType))||[],g=[];if(h.length==u.size)return h.forEach(function(x){x=x.replace(Vb,"").match(Xf),x&&g.push({v:po(x[2]),t:x[1]})}),g;if(c.WTF)throw new Error("unexpected vector length "+h.length+" != "+u.size);return g}var Fp=/(^\s|\s$|\n)/;function va(s,c){return"<"+s+(c.match(Fp)?' xml:space="preserve"':"")+">"+c+"</"+s+">"}function Oi(s){return Bt(s).map(function(c){return" "+c+'="'+s[c]+'"'}).join("")}function mn(s,c,u){return"<"+s+(u!=null?Oi(u):"")+(c!=null?(c.match(Fp)?' xml:space="preserve"':"")+">"+c+"</"+s:"/")+">"}function Md(s,c){try{return s.toISOString().replace(/\.\d*/,"")}catch(u){if(c)throw u}return""}function Np(s){if(W&&Buffer.isBuffer(s))return s.toString("utf8");if(typeof s=="string")return s;if(typeof Uint8Array<"u"&&s instanceof Uint8Array)return po(oe(N(s)));throw new Error("Bad input format: expected Buffer or string")}var Uc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,fa={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$c=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],zo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Hc(s){for(var c=[],u=0;u<s[0].length;++u)if(s[0][u])for(var h=0,g=s[0][u].length;h<g;h+=10240)c.push.apply(c,s[0][u].slice(h,h+10240));return c}function Jf(s,c,u){for(var h=[],g=c;g<u;g+=2)h.push(String.fromCharCode(oc(s,g)));return h.join("").replace(ne,"")}function _d(s,c,u){for(var h=[],g=c;g<c+u;++g)h.push(("0"+s[g].toString(16)).slice(-2));return h.join("")}function Gb(s,c,u){for(var h=[],g=c;g<u;g++)h.push(String.fromCharCode(Nd(s,g)));return h.join("")}function jp(s,c){var u=ns(s,c);return 0<u?Fd(s,c+4,c+4+u-1):""}function Lp(s,c){var u=ns(s,c);return 0<u?Fd(s,c+4,c+4+u-1):""}function Od(s,c){var u=2*ns(s,c);return 0<u?Fd(s,c+4,c+4+u-1):""}function Zf(s,c){var u=ns(s,c);return 0<u?Bp(s,c+4,c+4+u):""}function Eg(s,c){var u=ns(s,c);return 0<u?Fd(s,c+4,c+4+u):""}function Kb(s,c){for(var u=1-2*(s[c+7]>>>7),h=((127&s[c+7])<<4)+(s[c+6]>>>4&15),g=15&s[c+6],x=5;0<=x;--x)g=256*g+s[c+x];return h==2047?g==0?1/0*u:NaN:(h==0?h=-1022:(h-=1023,g+=Math.pow(2,52)),u*Math.pow(2,h-52)*g)}var Yb=W?function(s){return 0<s[0].length&&Buffer.isBuffer(s[0][0])?Buffer.concat(s[0].map(function(c){return Buffer.isBuffer(c)?c:X(c)})):Hc(s)}:Hc,Bp=W?function(s,c,u){return Buffer.isBuffer(s)?s.toString("utf16le",c,u).replace(ne,""):Jf(s,c,u)}:Jf,zp=W?function(s,c,u){return Buffer.isBuffer(s)?s.toString("hex",c,c+u):_d(s,c,u)}:_d,Fd=W?function(s,c,u){return Buffer.isBuffer(s)?s.toString("utf8",c,u):Gb(s,c,u)}:Gb,kg=jp,Dg=Lp,Rg=Od,Ig=Zf,Up=Eg,$p=Kb,Pg=function(s){return Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array};W&&(kg=function(s,c){if(!Buffer.isBuffer(s))return jp(s,c);var u=s.readUInt32LE(c);return 0<u?s.toString("utf8",c+4,c+4+u-1):""},Dg=function(s,c){if(!Buffer.isBuffer(s))return Lp(s,c);var u=s.readUInt32LE(c);return 0<u?s.toString("utf8",c+4,c+4+u-1):""},Rg=function(s,c){if(!Buffer.isBuffer(s))return Od(s,c);var u=2*s.readUInt32LE(c);return s.toString("utf16le",c+4,c+4+u-1)},Ig=function(s,c){if(!Buffer.isBuffer(s))return Zf(s,c);var u=s.readUInt32LE(c);return s.toString("utf16le",c+4,c+4+u)},Up=function(s,c){if(!Buffer.isBuffer(s))return Eg(s,c);var u=s.readUInt32LE(c);return s.toString("utf8",c+4,c+4+u)},$p=function(s,c){return Buffer.isBuffer(s)?s.readDoubleLE(c):Kb(s,c)},Pg=function(s){return Buffer.isBuffer(s)||Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array}),n!==void 0&&(Bp=function(s,c,u){return n.utils.decode(1200,s.slice(c,u)).replace(ne,"")},Fd=function(s,c,u){return n.utils.decode(65001,s.slice(c,u))},kg=function(s,c){var u=ns(s,c);return 0<u?n.utils.decode(m,s.slice(c+4,c+4+u-1)):""},Dg=function(s,c){var u=ns(s,c);return 0<u?n.utils.decode(f,s.slice(c+4,c+4+u-1)):""},Rg=function(s,c){var u=2*ns(s,c);return 0<u?n.utils.decode(1200,s.slice(c+4,c+4+u-1)):""},Ig=function(s,c){var u=ns(s,c);return 0<u?n.utils.decode(1200,s.slice(c+4,c+4+u)):""},Up=function(s,c){var u=ns(s,c);return 0<u?n.utils.decode(65001,s.slice(c+4,c+4+u)):""});var Nd=function(s,c){return s[c]},oc=function(s,c){return 256*s[c+1]+s[c]},Mg=function(s,c){return c=256*s[c+1]+s[c],c<32768?c:-1*(65535-c+1)},ns=function(s,c){return s[c+3]*(1<<24)+(s[c+2]<<16)+(s[c+1]<<8)+s[c]},Nu=function(s,c){return s[c+3]<<24|s[c+2]<<16|s[c+1]<<8|s[c]},AS=function(s,c){return s[c]<<24|s[c+1]<<16|s[c+2]<<8|s[c+3]};function jd(s,c){var u,h,g,x,v,S,T="",k=[];switch(c){case"dbcs":if(S=this.l,W&&Buffer.isBuffer(this))T=this.slice(this.l,this.l+2*s).toString("utf16le");else for(v=0;v<s;++v)T+=String.fromCharCode(oc(this,S)),S+=2;s*=2;break;case"utf8":T=Fd(this,this.l,this.l+s);break;case"utf16le":s*=2,T=Bp(this,this.l,this.l+s);break;case"wstr":if(n===void 0)return jd.call(this,s,"dbcs");T=n.utils.decode(f,this.slice(this.l,this.l+2*s)),s*=2;break;case"lpstr-ansi":T=kg(this,this.l),s=4+ns(this,this.l);break;case"lpstr-cp":T=Dg(this,this.l),s=4+ns(this,this.l);break;case"lpwstr":T=Rg(this,this.l),s=4+2*ns(this,this.l);break;case"lpp4":s=4+ns(this,this.l),T=Ig(this,this.l),2&s&&(s+=2);break;case"8lpp4":s=4+ns(this,this.l),T=Up(this,this.l),3&s&&(s+=4-(3&s));break;case"cstr":for(s=0,T="";(g=Nd(this,this.l+s++))!==0;)k.push(O(g));T=k.join("");break;case"_wstr":for(s=0,T="";(g=oc(this,this.l+s))!==0;)k.push(O(g)),s+=2;s+=2,T=k.join("");break;case"dbcs-cont":for(T="",S=this.l,v=0;v<s;++v){if(this.lens&&this.lens.indexOf(S)!==-1)return g=Nd(this,S),this.l=S+1,x=jd.call(this,s-v,g?"dbcs-cont":"sbcs-cont"),k.join("")+x;k.push(O(oc(this,S))),S+=2}T=k.join(""),s*=2;break;case"cpstr":if(n!==void 0){T=n.utils.decode(f,this.slice(this.l,this.l+s));break}case"sbcs-cont":for(T="",S=this.l,v=0;v!=s;++v){if(this.lens&&this.lens.indexOf(S)!==-1)return g=Nd(this,S),this.l=S+1,x=jd.call(this,s-v,g?"dbcs-cont":"sbcs-cont"),k.join("")+x;k.push(O(Nd(this,S))),S+=1}T=k.join("");break;default:switch(s){case 1:return u=Nd(this,this.l),this.l++,u;case 2:return u=(c==="i"?Mg:oc)(this,this.l),this.l+=2,u;case 4:case-4:return c==="i"||(128&this[this.l+3])==0?(u=(0<s?Nu:AS)(this,this.l),this.l+=4,u):(h=ns(this,this.l),this.l+=4,h);case 8:case-8:if(c==="f")return h=s==8?$p(this,this.l):$p([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,h;s=8;case 16:T=zp(this,this.l,s)}}return this.l+=s,T}var ES=function(s,c,u){s[u]=255&c,s[u+1]=c>>>8&255,s[u+2]=c>>>16&255,s[u+3]=c>>>24&255},kS=function(s,c,u){s[u]=255&c,s[u+1]=c>>8&255,s[u+2]=c>>16&255,s[u+3]=c>>24&255},DS=function(s,c,u){s[u]=255&c,s[u+1]=c>>>8&255};function RS(s,c,u){var h=0,g=0;if(u==="dbcs"){for(g=0;g!=c.length;++g)DS(this,c.charCodeAt(g),this.l+2*g);h=2*c.length}else if(u==="sbcs"){if(n!==void 0&&m==874)for(g=0;g!=c.length;++g){var x=n.utils.encode(m,c.charAt(g));this[this.l+g]=x[0]}else for(c=c.replace(/[^\x00-\x7F]/g,"_"),g=0;g!=c.length;++g)this[this.l+g]=255&c.charCodeAt(g);h=c.length}else{if(u==="hex"){for(;g<s;++g)this[this.l++]=parseInt(c.slice(2*g,2*g+2),16)||0;return this}if(u==="utf16le"){for(var v=Math.min(this.l+s,this.length),g=0;g<Math.min(c.length,s);++g){var S=c.charCodeAt(g);this[this.l++]=255&S,this[this.l++]=S>>8}for(;this.l<v;)this[this.l++]=0;return this}switch(s){case 1:h=1,this[this.l]=255&c;break;case 2:h=2,this[this.l]=255&c,c>>>=8,this[this.l+1]=255&c;break;case 3:h=3,this[this.l]=255&c,c>>>=8,this[this.l+1]=255&c,c>>>=8,this[this.l+2]=255&c;break;case 4:h=4,ES(this,c,this.l);break;case 8:if(h=8,u==="f"){(function(T,k,_){var L=(k<0||1/k==-1/0?1:0)<<7,B=0,z=0,Z=L?-k:k;isFinite(Z)?Z==0?B=z=0:(B=Math.floor(Math.log(Z)/Math.LN2),z=Z*Math.pow(2,52-B),B<=-1023&&(!isFinite(z)||z<Math.pow(2,52))?B=-1022:(z-=Math.pow(2,52),B+=1023)):(B=2047,z=isNaN(k)?26985:0);for(var G=0;G<=5;++G,z/=256)T[_+G]=255&z;T[_+6]=(15&B)<<4|15&z,T[_+7]=B>>4|L})(this,c,this.l);break}case 16:break;case-4:h=4,kS(this,c,this.l)}}return this.l+=h,this}function qb(s,c){var u=zp(this,this.l,s.length>>1);if(u!==s)throw new Error(c+"Expected "+s+" saw "+u);this.l+=s.length>>1}function ds(s,c){s.l=c,s.read_shift=jd,s.chk=qb,s.write_shift=RS}function vs(s,c){s.l+=c}function Mt(s){return s=ee(s),ds(s,0),s}function ac(s,c,u){if(s){ds(s,s.l||0);for(var h,g=s.length,x=0;s.l<g;){128&(x=s.read_shift(1))&&(x=(127&x)+((127&s.read_shift(1))<<7));for(var v,S=ld[x]||ld[65535],T=127&(v=s.read_shift(1)),k=1;k<4&&128&v;++k)T+=(127&(v=s.read_shift(1)))<<7*k;h=s.l+T;var _=S.f&&S.f(s,T,u);if(s.l=h,c(_,S,x))return}}}function xs(){function s(v){return ds(v=Mt(v),0),v}function c(){x&&(x.length>x.l&&((x=x.slice(0,x.l)).l=x.length),0<x.length&&h.push(x),x=null)}function u(v){return x&&v<x.length-x.l?x:(c(),x=s(Math.max(v+1,g)))}var h=[],g=W?256:2048,x=s(g);return{next:u,push:function(v){c(),(x=v).l==null&&(x.l=x.length),u(g)},end:function(){return c(),ce(h)},_bufs:h}}function Ut(s,c,u,h){var g=+c;if(!isNaN(g)){c=1+(128<=g?1:0)+1,128<=(h=h||ld[g].p||(u||[]).length||0)&&++c,16384<=h&&++c,2097152<=h&&++c;var x=s.next(c);g<=127?x.write_shift(1,g):(x.write_shift(1,128+(127&g)),x.write_shift(1,g>>7));for(var v=0;v!=4;++v){if(!(128<=h)){x.write_shift(1,h);break}x.write_shift(1,128+(127&h)),h>>=7}0<h&&Pg(u)&&s.push(u)}}function eh(s,c,u){var h=qr(s);if(c.s?(h.cRel&&(h.c+=c.s.c),h.rRel&&(h.r+=c.s.r)):(h.cRel&&(h.c+=c.c),h.rRel&&(h.r+=c.r)),!u||u.biff<12){for(;256<=h.c;)h.c-=256;for(;65536<=h.r;)h.r-=65536}return h}function _g(s,c,u){return s=qr(s),s.s=eh(s.s,c.s,u),s.e=eh(s.e,c.s,u),s}function Ld(s,c){if(s.cRel&&s.c<0)for(s=qr(s);s.c<0;)s.c+=8<c?16384:256;if(s.rRel&&s.r<0)for(s=qr(s);s.r<0;)s.r+=8<c?1048576:5<c?65536:16384;var u=yr(s);return s.cRel||s.cRel==null||(u=u.replace(/^([A-Z])/,"$$$1")),u=!s.rRel&&s.rRel!=null?u.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):u}function Hp(s,c){return s.s.r!=0||s.s.rRel||s.e.r!=(12<=c.biff?1048575:8<=c.biff?65536:16384)||s.e.rRel?s.s.c!=0||s.s.cRel||s.e.c!=(12<=c.biff?16383:255)||s.e.cRel?Ld(s.s,c.biff)+":"+Ld(s.e,c.biff):(s.s.rRel?"":"$")+sa(s.s.r)+":"+(s.e.rRel?"":"$")+sa(s.e.r):(s.s.cRel?"":"$")+Yo(s.s.c)+":"+(s.e.cRel?"":"$")+Yo(s.e.c)}function Wp(s){return parseInt(s.replace(/\$(\d+)$/,"$1"),10)-1}function sa(s){return""+(s+1)}function Wc(s){for(var c=s.replace(/^\$([A-Z])/,"$1"),u=0,h=0;h!==c.length;++h)u=26*u+c.charCodeAt(h)-64;return u-1}function Yo(s){if(s<0)throw new Error("invalid column "+s);var c="";for(++s;s;s=Math.floor((s-1)/26))c=String.fromCharCode((s-1)%26+65)+c;return c}function ia(s){for(var c=0,u=0,h=0;h<s.length;++h){var g=s.charCodeAt(h);48<=g&&g<=57?c=10*c+(g-48):65<=g&&g<=90&&(u=26*u+(g-64))}return{c:u-1,r:c-1}}function yr(s){for(var c=s.c+1,u="";c;c=(c-1)/26|0)u=String.fromCharCode((c-1)%26+65)+u;return u+(s.r+1)}function Cs(s){var c=s.indexOf(":");return c==-1?{s:ia(s),e:ia(s)}:{s:ia(s.slice(0,c)),e:ia(s.slice(c+1))}}function Tr(s,c){return c===void 0||typeof c=="number"?Tr(s.s,s.e):(s=typeof s!="string"?yr(s):s)==(c=typeof c!="string"?yr(c):c)?s:s+":"+c}function Ir(s){for(var c={s:{c:0,r:0},e:{c:0,r:0}},x=0,u=0,h=0,g=s.length,x=0;u<g&&!((h=s.charCodeAt(u)-64)<1||26<h);++u)x=26*x+h;for(c.s.c=--x,x=0;u<g&&!((h=s.charCodeAt(u)-48)<0||9<h);++u)x=10*x+h;if(c.s.r=--x,u===g||h!=10)return c.e.c=c.s.c,c.e.r=c.s.r,c;for(++u,x=0;u!=g&&!((h=s.charCodeAt(u)-64)<1||26<h);++u)x=26*x+h;for(c.e.c=--x,x=0;u!=g&&!((h=s.charCodeAt(u)-48)<0||9<h);++u)x=10*x+h;return c.e.r=--x,c}function th(s,c){var u=s.t=="d"&&c instanceof Date;if(s.z!=null)try{return s.w=Wt(s.z,u?En(c):c)}catch{}try{return s.w=Wt((s.XF||{}).numFmtId||(u?14:0),u?En(c):c)}catch{return""+c}}function Dl(s,c,u){return s==null||s.t==null||s.t=="z"?"":s.w!==void 0?s.w:(s.t=="d"&&!s.z&&u&&u.dateNF&&(s.z=u.dateNF),s.t=="e"?al[s.v]||s.v:th(s,c??s.v))}function rl(s,h){var u=h&&h.sheet?h.sheet:"Sheet1",h={};return h[u]=s,{SheetNames:[u],Sheets:h}}function Og(s,c,u){var h=u||{},g=s?Array.isArray(s):h.dense,x=s||(g?[]:{}),v=0,S=0;x&&h.origin!=null&&(typeof h.origin=="number"?v=h.origin:(v=(T=typeof h.origin=="string"?ia(h.origin):h.origin).r,S=T.c),x["!ref"]||(x["!ref"]="A1:A1"));var T,k={s:{c:1e7,r:1e7},e:{c:0,r:0}};x["!ref"]&&(T=Ir(x["!ref"]),k.s.c=T.s.c,k.s.r=T.s.r,k.e.c=Math.max(k.e.c,T.e.c),k.e.r=Math.max(k.e.r,T.e.r),v==-1&&(k.e.r=v=T.e.r+1));for(var _=0;_!=c.length;++_)if(c[_]){if(!Array.isArray(c[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var L=0;L!=c[_].length;++L)if(c[_][L]!==void 0){var B={v:c[_][L]},z=v+_,Z=S+L;if(k.s.r>z&&(k.s.r=z),k.s.c>Z&&(k.s.c=Z),k.e.r<z&&(k.e.r=z),k.e.c<Z&&(k.e.c=Z),!c[_][L]||typeof c[_][L]!="object"||Array.isArray(c[_][L])||c[_][L]instanceof Date)if(Array.isArray(B.v)&&(B.f=c[_][L][1],B.v=B.v[0]),B.v===null)if(B.f)B.t="n";else if(h.nullError)B.t="e",B.v=0;else{if(!h.sheetStubs)continue;B.t="z"}else typeof B.v=="number"?B.t="n":typeof B.v=="boolean"?B.t="b":B.v instanceof Date?(B.z=h.dateNF||ae[14],h.cellDates?(B.t="d",B.w=Wt(B.z,En(B.v))):(B.t="n",B.v=En(B.v),B.w=Wt(B.z,B.v))):B.t="s";else B=c[_][L];g?(x[z]||(x[z]=[]),x[z][Z]&&x[z][Z].z&&(B.z=x[z][Z].z),x[z][Z]=B):(x[z=yr({c:Z,r:z})]&&x[z].z&&(B.z=x[z].z),x[z]=B)}}return k.s.c<1e7&&(x["!ref"]=Tr(k)),x}function ju(s,c){return Og(null,s,c)}function ii(s,c){return(c=c||Mt(4)).write_shift(4,s),c}function rs(s){var c=s.read_shift(4);return c===0?"":s.read_shift(c,"dbcs")}function Wa(s,c){var u=!1;return c==null&&(u=!0,c=Mt(4+2*s.length)),c.write_shift(4,s.length),0<s.length&&c.write_shift(0,s,"dbcs"),u?c.slice(0,c.l):c}function Vp(s,c){var u,h=s.l,g=s.read_shift(1),v=rs(s),x=[],v={t:v,h:v};if((1&g)!=0){for(var S=s.read_shift(4),T=0;T!=S;++T)x.push({ich:(u=s).read_shift(2),ifnt:u.read_shift(2)});v.r=x}else v.r=[{ich:0,ifnt:0}];return s.l=h+c,v}var Qb=Vp;function IS(s,c){var u,h=!1;return c==null&&(h=!0,c=Mt(23+4*s.t.length)),c.write_shift(1,1),Wa(s.t,c),c.write_shift(4,1),u={ich:0,ifnt:0},(s=(s=c)||Mt(4)).write_shift(2,u.ich||0),s.write_shift(2,u.ifnt||0),h?c.slice(0,c.l):c}function Fi(s){var c=s.read_shift(4),u=s.read_shift(2);return u+=s.read_shift(1)<<16,s.l++,{c,iStyleRef:u}}function Lu(s,c){return(c=c??Mt(8)).write_shift(-4,s.c),c.write_shift(3,s.iStyleRef||s.s),c.write_shift(1,0),c}function Bu(s){var c=s.read_shift(2);return c+=s.read_shift(1)<<16,s.l++,{c:-1,iStyleRef:c}}function zu(s,c){return(c=c??Mt(4)).write_shift(3,s.iStyleRef||s.s),c.write_shift(1,0),c}var li=rs,Bd=Wa;function Gp(s){var c=s.read_shift(4);return c===0||c===4294967295?"":s.read_shift(c,"dbcs")}function nh(s,c){var u=!1;return c==null&&(u=!0,c=Mt(127)),c.write_shift(4,0<s.length?s.length:4294967295),0<s.length&&c.write_shift(0,s,"dbcs"),u?c.slice(0,c.l):c}var Xb=rs,Kp=Gp,rh=nh;function Fg(s){var c=s.slice(s.l,s.l+4),u=1&c[0],h=2&c[0];return s.l+=4,c=h==0?$p([0,0,0,0,252&c[0],c[1],c[2],c[3]],0):Nu(c,0)>>2,u?c/100:c}function Uu(s,c){c==null&&(c=Mt(4));var u=0,h=0,g=100*s;if(s==(0|s)&&-536870912<=s&&s<1<<29?h=1:g==(0|g)&&-536870912<=g&&g<1<<29&&(u=h=1),!h)throw new Error("unsupported RkNumber "+s);c.write_shift(-4,((u?g:s)<<2)+(u+2))}function Yp(s){var c={s:{},e:{}};return c.s.r=s.read_shift(4),c.e.r=s.read_shift(4),c.s.c=s.read_shift(4),c.e.c=s.read_shift(4),c}var ol=Yp,Vc=function(s,c){return(c=c||Mt(16)).write_shift(4,s.s.r),c.write_shift(4,s.e.r),c.write_shift(4,s.s.c),c.write_shift(4,s.e.c),c};function fs(s){if(s.length-s.l<8)throw"XLS Xnum Buffer underflow";return s.read_shift(8,"f")}function Ni(s,c){return(c||Mt(8)).write_shift(8,s,"f")}function sc(s,c){if(c=c||Mt(8),!s||s.auto)return c.write_shift(4,0),c.write_shift(4,0),c;s.index!=null?(c.write_shift(1,2),c.write_shift(1,s.index)):s.theme!=null?(c.write_shift(1,6),c.write_shift(1,s.theme)):(c.write_shift(1,5),c.write_shift(1,0));var u=s.tint||0;return 0<u?u*=32767:u<0&&(u*=32768),c.write_shift(2,u),s.rgb&&s.theme==null?(typeof(s=s.rgb||"FFFFFF")=="number"&&(s=("000000"+s.toString(16)).slice(-6)),c.write_shift(1,parseInt(s.slice(0,2),16)),c.write_shift(1,parseInt(s.slice(2,4),16)),c.write_shift(1,parseInt(s.slice(4,6),16)),c.write_shift(1,255)):(c.write_shift(2,0),c.write_shift(1,0),c.write_shift(1,0)),c}function qp(s,c){var u=s.read_shift(4);switch(u){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[s.read_shift(4)]||""}if(400<u)throw new Error("Unsupported Clipboard: "+u.toString(16));return s.l-=4,s.read_shift(0,c==1?"lpstr":"lpwstr")}var Qp=2,Ia=3,Ng=12,jg=81,Jb=[80,jg],Lg={1:{n:"CodePage",t:Qp},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:Ia},5:{n:"LineCount",t:Ia},6:{n:"ParagraphCount",t:Ia},7:{n:"SlideCount",t:Ia},8:{n:"NoteCount",t:Ia},9:{n:"HiddenCount",t:Ia},10:{n:"MultimediaClipCount",t:Ia},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:Ia},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:Ia,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Bg={1:{n:"CodePage",t:Qp},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:Ia},15:{n:"WordCount",t:Ia},16:{n:"CharCount",t:Ia},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:Ia},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Zb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ev=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zd=qr([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(s){return[s>>16&255,s>>8&255,255&s]})),al={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ji={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ud={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ds={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Gc(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Xp(s,c){var u,h=(function(T){for(var k=[],_=Bt(T),L=0;L!==_.length;++L)k[T[_[L]]]==null&&(k[T[_[L]]]=[]),k[T[_[L]]].push(_[L]);return k})(Ud),g=[];g[g.length]=Ke,g[g.length]=mn("Types",null,{xmlns:fa.CT,"xmlns:xsd":fa.xsd,"xmlns:xsi":fa.xsi}),g=g.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(T){return mn("Default",null,{Extension:T[0],ContentType:T[1]})}));function x(T){s[T]&&0<s[T].length&&(u=s[T][0],g[g.length]=mn("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ds[T][c.bookType]||Ds[T].xlsx}))}function v(T){(s[T]||[]).forEach(function(k){g[g.length]=mn("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:Ds[T][c.bookType]||Ds[T].xlsx})})}function S(T){(s[T]||[]).forEach(function(k){g[g.length]=mn("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:h[T][0]})})}return x("workbooks"),v("sheets"),v("charts"),S("themes"),["strs","styles"].forEach(x),["coreprops","extprops","custprops"].forEach(S),S("vba"),S("comments"),S("threadedcomments"),S("drawings"),v("metadata"),S("people"),2<g.length&&(g[g.length]="</Types>",g[1]=g[1].replace("/>",">")),g.join("")}var wr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Kc(s){var c=s.lastIndexOf("/");return s.slice(0,c+1)+"_rels/"+s.slice(c+1)+".rels"}function $u(s,c){var u={"!id":{}};if(!s)return u;c.charAt(0)!=="/"&&(c="/"+c);var h={};return(s.match($n)||[]).forEach(function(g){var x,v=sr(g);v[0]==="<Relationship"&&((x={}).Type=v.Type,x.Target=v.Target,x.Id=v.Id,v.TargetMode&&(x.TargetMode=v.TargetMode),g=v.TargetMode==="External"?v.Target:ke(v.Target,c),u[g]=x,h[v.Id]=x)}),u["!id"]=h,u}function Li(s){var c=[Ke,mn("Relationships",null,{xmlns:fa.RELS})];return Bt(s["!id"]).forEach(function(u){c[c.length]=mn("Relationship",null,s["!id"][u])}),2<c.length&&(c[c.length]="</Relationships>",c[1]=c[1].replace("/>",">")),c.join("")}function mo(s,c,u,h,g,x){if(g=g||{},s["!id"]||(s["!id"]={}),s["!idx"]||(s["!idx"]=1),c<0)for(c=s["!idx"];s["!id"]["rId"+c];++c);if(s["!idx"]=c+1,g.Id="rId"+c,g.Type=h,g.Target=u,-1<[wr.HLINK,wr.XPATH,wr.XMISS].indexOf(g.Type)&&(g.TargetMode="External"),s["!id"][g.Id])throw new Error("Cannot rewrite rId "+c);return s["!id"][g.Id]=g,s[("/"+g.Target).replace("//","/")]=g,c}var Jp="application/vnd.oasis.opendocument.spreadsheet";function Hu(s,c,u){return['  <rdf:Description rdf:about="'+s+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(u||"odf")+"#"+c+`"/>
`,`  </rdf:Description>
`].join("")}function tv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+o.version+"</meta:generator></office:meta></office:document-meta>"}var ea=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],zg=(function(){for(var s=new Array(ea.length),c=0;c<ea.length;++c){var u=ea[c],u="(?:"+u[0].slice(0,u[0].indexOf(":"))+":)"+u[0].slice(u[0].indexOf(":")+1);s[c]=new RegExp("<"+u+"[^>]*>([\\s\\S]*?)</"+u+">")}return s})();function Rl(s){var c={};s=po(s);for(var u=0;u<ea.length;++u){var h=ea[u],g=s.match(zg[u]);g!=null&&0<g.length&&(c[h[1]]=Sr(g[1])),h[2]==="date"&&c[h[1]]&&(c[h[1]]=Jn(c[h[1]]))}return c}function Zp(s,c,u,h,g){g[s]==null&&c!=null&&c!==""&&(c=co(g[s]=c),h[h.length]=u?mn(s,c,u):va(s,c))}function oh(s,c){var u=c||{},h=[Ke,mn("cp:coreProperties",null,{"xmlns:cp":fa.CORE_PROPS,"xmlns:dc":fa.dc,"xmlns:dcterms":fa.dcterms,"xmlns:dcmitype":fa.dcmitype,"xmlns:xsi":fa.xsi})],g={};if(!s&&!u.Props)return h.join("");s&&(s.CreatedDate!=null&&Zp("dcterms:created",typeof s.CreatedDate=="string"?s.CreatedDate:Md(s.CreatedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},h,g),s.ModifiedDate!=null&&Zp("dcterms:modified",typeof s.ModifiedDate=="string"?s.ModifiedDate:Md(s.ModifiedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},h,g));for(var x=0;x!=ea.length;++x){var v=ea[x],S=u.Props&&u.Props[v[1]]!=null?u.Props[v[1]]:s?s[v[1]]:null;S===!0?S="1":S===!1?S="0":typeof S=="number"&&(S=String(S)),S!=null&&Zp(v[0],S,null,h,g)}return 2<h.length&&(h[h.length]="</cp:coreProperties>",h[1]=h[1].replace("/>",">")),h.join("")}var ci=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],e0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ug(s,c,u,h){var g=[];if(typeof s=="string")g=kl(s,h);else for(var x=0;x<s.length;++x)g=g.concat(s[x].map(function(_){return{v:_}}));var v,S=typeof c=="string"?kl(c,h).map(function(_){return _.v}):c,T=0;if(0<S.length)for(var k=0;k!==g.length;k+=2){switch(v=+g[k+1].v,g[k].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":u.Worksheets=v,u.SheetNames=S.slice(T,T+v);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":u.NamedRanges=v,u.DefinedNames=S.slice(T,T+v);break;case"Charts":case"Diagramme":u.Chartsheets=v,u.ChartNames=S.slice(T,T+v)}T+=v}}function t0(s){var c=[],u=mn;return(s=s||{}).Application="SheetJS",c[c.length]=Ke,c[c.length]=mn("Properties",null,{xmlns:fa.EXT_PROPS,"xmlns:vt":fa.vt}),ci.forEach(function(h){if(s[h[1]]!==void 0){var g;switch(h[2]){case"string":g=co(String(s[h[1]]));break;case"bool":g=s[h[1]]?"true":"false"}g!==void 0&&(c[c.length]=u(h[0],g))}}),c[c.length]=u("HeadingPairs",u("vt:vector",u("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+u("vt:variant",u("vt:i4",String(s.Worksheets))),{size:2,baseType:"variant"})),c[c.length]=u("TitlesOfParts",u("vt:vector",s.SheetNames.map(function(h){return"<vt:lpstr>"+co(h)+"</vt:lpstr>"}).join(""),{size:s.Worksheets,baseType:"lpstr"})),2<c.length&&(c[c.length]="</Properties>",c[1]=c[1].replace("/>",">")),c.join("")}var nv=/<[^>]+>[^<]*/g;function ui(s){var c=[Ke,mn("Properties",null,{xmlns:fa.CUST_PROPS,"xmlns:vt":fa.vt})];if(!s)return c.join("");var u=1;return Bt(s).forEach(function(h){++u,c[c.length]=mn("property",(function(g,x){switch(typeof g){case"string":var v=mn("vt:lpwstr",co(g));return v=v.replace(/&quot;/g,"_x0022_");case"number":return mn((0|g)==g?"vt:i4":"vt:r8",co(String(g)));case"boolean":return mn("vt:bool",g?"true":"false")}if(g instanceof Date)return mn("vt:filetime",Md(g));throw new Error("Unable to serialize "+g)})(s[h]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:u,name:co(h)})}),2<c.length&&(c[c.length]="</Properties>",c[1]=c[1].replace("/>",">")),c.join("")}var Wu,Yc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function $d(u){var c=u.read_shift(4),u=u.read_shift(4);return new Date(1e3*(u/1e7*Math.pow(2,32)+c/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Hd(s,c,u){var h=s.l,g=s.read_shift(0,"lpstr-cp");if(u)for(;s.l-h&3;)++s.l;return g}function di(s,c,u){var h=s.read_shift(0,"lpwstr");return h}function fi(s,c,u){return c===31?di(s):Hd(s,0,u)}function ic(s,c,u){return fi(s,c,u===!1?0:4)}function Il(s){for(var c,u,h,g=s.read_shift(4),x=[],v=0;v<g/2;++v)x.push((h=u=void 0,u=(c=s).l,h=ah(c,jg),c[c.l]==0&&c[c.l+1]==0&&c.l-u&2&&(c.l+=2),[h,ah(c,Ia)]));return x}function sl(s,c){for(var u=s.read_shift(4),h={},g=0;g!=u;++g){var x=s.read_shift(4),v=s.read_shift(4);h[x]=s.read_shift(v,c===1200?"utf16le":"utf8").replace(ne,"").replace(Se,"!"),c===1200&&v%2&&(s.l+=2)}return 3&s.l&&(s.l=s.l>>3<<2),h}function Pl(s){var c=s.read_shift(4),u=s.slice(s.l,s.l+c);return s.l+=c,0<(3&c)&&(s.l+=4-(3&c)&3),u}function ah(s,c,u){var h,g,x=s.read_shift(2),v=u||{};if(s.l+=2,c!==Ng&&x!==c&&Jb.indexOf(c)===-1&&((65534&c)!=4126||(65534&x)!=4126))throw new Error("Expected type "+c+" saw "+x);switch(c===Ng?x:c){case 2:return h=s.read_shift(2,"i"),v.raw||(s.l+=2),h;case 3:return h=s.read_shift(4,"i");case 11:return s.read_shift(4)!==0;case 19:return h=s.read_shift(4);case 30:return Hd(s,0,4).replace(ne,"");case 31:return di(s);case 64:return $d(s);case 65:return Pl(s);case 71:return(g={}).Size=(h=s).read_shift(4),h.l+=g.Size+3-(g.Size-1)%4,g;case 80:return ic(s,x,!v.raw).replace(ne,"");case 81:return(function(S,T){if(!T)throw new Error("VtUnalignedString must have positive length");return fi(S,T,0)})(s,x).replace(ne,"");case 4108:return Il(s);case 4126:case 4127:return(x==4127?function(S){for(var T=S.read_shift(4),k=[],_=0;_!=T;++_){var L=S.l;k[_]=S.read_shift(0,"lpwstr").replace(ne,""),S.l-L&2&&(S.l+=2)}return k}:function(S){for(var T=S.read_shift(4),k=[],_=0;_!=T;++_)k[_]=S.read_shift(0,"lpstr-cp").replace(ne,"");return k})(s);default:throw new Error("TypedPropertyValue unrecognized type "+c+" "+x)}}function n0(s,c){var u,h,g,x=Mt(4),v=Mt(4);switch(x.write_shift(4,s==80?31:s),s){case 3:v.write_shift(-4,c);break;case 5:(v=Mt(8)).write_shift(8,c,"f");break;case 11:v.write_shift(4,c?1:0);break;case 64:h=(typeof(u=c)=="string"?new Date(Date.parse(u)):u).getTime()/1e3+11644473600,g=h%Math.pow(2,32),u=(h-g)/Math.pow(2,32),u*=1e7,0<(h=(g*=1e7)/Math.pow(2,32)|0)&&(g%=Math.pow(2,32),u+=h),(h=Mt(8)).write_shift(4,g),h.write_shift(4,u),v=h;break;case 31:case 80:for((v=Mt(4+2*(c.length+1)+(c.length%2?0:2))).write_shift(4,c.length+1),v.write_shift(0,c,"dbcs");v.l!=v.length;)v.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+c)}return ce([x,v])}function r0(s,c){for(var u=s.l,h=s.read_shift(4),g=s.read_shift(4),x=[],k=0,v=0,S=-1,T={},k=0;k!=g;++k){var _=s.read_shift(4),L=s.read_shift(4);x[k]=[_,L+u]}x.sort(function(re,Y){return re[1]-Y[1]});var B={};for(k=0;k!=g;++k){if(s.l!==x[k][1]){var z=!0;if(0<k&&c)switch(c[x[k-1][0]].t){case 2:s.l+2===x[k][1]&&(s.l+=2,z=!1);break;case 80:case 4108:s.l<=x[k][1]&&(s.l=x[k][1],z=!1)}if((!c||k==0)&&s.l<=x[k][1]&&(z=!1,s.l=x[k][1]),z)throw new Error("Read Error: Expected address "+x[k][1]+" at "+s.l+" :"+k)}if(c){var Z=c[x[k][0]];if(B[Z.n]=ah(s,Z.t,{raw:!0}),Z.p==="version"&&(B[Z.n]=String(B[Z.n]>>16)+"."+("0000"+String(65535&B[Z.n])).slice(-4)),Z.n=="CodePage")switch(B[Z.n]){case 0:B[Z.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:A(v=B[Z.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+B[Z.n])}}else if(x[k][0]===1)v=B.CodePage=ah(s,Qp),A(v),S!==-1&&(me=s.l,s.l=x[S][1],T=sl(s,v),s.l=me);else if(x[k][0]===0)v!==0?T=sl(s,v):(S=k,s.l=x[k+1][1]);else{var G,me=T[x[k][0]];switch(s[s.l]){case 65:s.l+=4,G=Pl(s);break;case 30:case 31:s.l+=4,G=ic(s,s[s.l-4]).replace(/\u0000+$/,"");break;case 3:s.l+=4,G=s.read_shift(4,"i");break;case 19:s.l+=4,G=s.read_shift(4);break;case 5:s.l+=4,G=s.read_shift(8,"f");break;case 11:s.l+=4,G=ao(s,4);break;case 64:s.l+=4,G=Jn($d(s));break;default:throw new Error("unparsed value: "+s[s.l])}B[me]=G}}return s.l=u+h,B}var $g=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function os(s,c,u){var h,g,x,v,S=Mt(8),T=[],k=[],_=8,L=0,B=Mt(8),z=Mt(8);if(B.write_shift(4,2),B.write_shift(4,1200),z.write_shift(4,1),k.push(B),T.push(z),_+=8+B.length,!c){(z=Mt(8)).write_shift(4,0),T.unshift(z);var Z=[Mt(4)];for(Z[0].write_shift(4,s.length),L=0;L<s.length;++L){var G=s[L][0];for((B=Mt(8+2*(G.length+1)+(G.length%2?0:2))).write_shift(4,L+2),B.write_shift(4,G.length+1),B.write_shift(0,G,"dbcs");B.l!=B.length;)B.write_shift(1,0);Z.push(B)}B=ce(Z),k.unshift(B),_+=8+B.length}for(L=0;L<s.length;++L)c&&!c[s[L][0]]||-1<$g.indexOf(s[L][0])||-1<e0.indexOf(s[L][0])||s[L][1]!=null&&(x=s[L][1],h=0,B=c?((v=u[h=+c[s[L][0]]]).p=="version"&&typeof x=="string"&&(x=(+(g=x.split("."))[0]<<16)+(+g[1]||0)),n0(v.t,x)):((v=(function(re){switch(typeof re){case"boolean":return 11;case"number":return(0|re)==re?3:5;case"string":return 31;case"object":if(re instanceof Date)return 64}return-1})(x))==-1&&(v=31,x=String(x)),n0(v,x)),k.push(B),(z=Mt(8)).write_shift(4,c?h:2+L),T.push(z),_+=8+B.length);for(var me=8*(k.length+1),L=0;L<k.length;++L)T[L].write_shift(4,me),me+=k[L].length;return S.write_shift(4,_),S.write_shift(4,k.length),ce([S].concat(T).concat(k))}function Uo(s,c,u){var h=s.content;if(!h)return{};ds(h,0);var g,x=0;h.chk("feff","Byte Order: "),h.read_shift(2);var v=h.read_shift(4),S=h.read_shift(16);if(S!==$t.utils.consts.HEADER_CLSID&&S!==u)throw new Error("Bad PropertySet CLSID "+S);if((s=h.read_shift(4))!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(u=h.read_shift(16),S=h.read_shift(4),s===1&&S!==h.l)throw new Error("Length mismatch: "+S+" !== "+h.l);s===2&&(g=h.read_shift(16),x=h.read_shift(4));var T,k,_=r0(h,c),L={SystemIdentifier:v};for(T in _)L[T]=_[T];if(L.FMTID=u,s===1)return L;if(x-h.l==2&&(h.l+=2),h.l!==x)throw new Error("Length mismatch 2: "+h.l+" !== "+x);try{k=r0(h,null)}catch{}for(T in k)L[T]=k[T];return L.FMTID=[u,g],L}function Gr(s,c,u,h,g,x){var v=Mt(g?68:48),S=[v];return v.write_shift(2,65534),v.write_shift(2,0),v.write_shift(4,842412599),v.write_shift(16,$t.utils.consts.HEADER_CLSID,"hex"),v.write_shift(4,g?2:1),v.write_shift(16,c,"hex"),v.write_shift(4,g?68:48),h=os(s,u,h),S.push(h),g&&(g=os(g,null,null),v.write_shift(16,x,"hex"),v.write_shift(4,68+h.length),S.push(g)),ce(S)}function Rs(s,c){return s.read_shift(c),null}function ao(s,c){return s.read_shift(c)===1}function hs(s,c){return(c=c||Mt(2)).write_shift(2,+!!s),c}function _o(s){return s.read_shift(2,"u")}function hi(s,c){return(c=c||Mt(2)).write_shift(2,s),c}function Hg(s,c){return(function(u,h,g){for(var x=[],v=u.l+h;u.l<v;)x.push(g(u,v-u.l));if(v!==u.l)throw new Error("Slurp error");return x})(s,c,_o)}function Vu(s,c,u){return(u=u||Mt(2)).write_shift(1,c=="e"?+s:+!!s),u.write_shift(1,c=="e"?1:0),u}function il(s,c,u){var h=s.read_shift(u&&12<=u.biff?2:1),g="sbcs-cont",x=f;return u&&8<=u.biff&&(f=1200),u&&u.biff!=8?u.biff==12&&(g="wstr"):s.read_shift(1)&&(g="dbcs-cont"),2<=u.biff&&u.biff<=5&&(g="cpstr"),g=h?s.read_shift(h,g):"",f=x,g}function lc(s,c,u){if(u){if(2<=u.biff&&u.biff<=5)return s.read_shift(c,"cpstr");if(12<=u.biff)return s.read_shift(c,"dbcs-cont")}return s.read_shift(1)===0?s.read_shift(c,"sbcs-cont"):s.read_shift(c,"dbcs-cont")}function cc(s,c,u){var h=s.read_shift(u&&u.biff==2?1:2);return h===0?(s.l++,""):lc(s,h,u)}function uc(s,c,u){if(5<u.biff)return cc(s,0,u);var h=s.read_shift(1);return h===0?(s.l++,""):s.read_shift(h,u.biff<=4||!s.lens?"cpstr":"sbcs-cont")}function qc(s,c,u){return(u=u||Mt(3+2*s.length)).write_shift(2,s.length),u.write_shift(1,1),u.write_shift(31,s,"utf16le"),u}function dc(s){var c,u,h,g,x=s.read_shift(16);switch(x){case"e0c9ea79f9bace118c8200aa004ba90b":return u=(c=s).read_shift(4),h=c.l,g=!1,24<u&&(c.l+=u-24,c.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(g=!0),c.l=h),u=c.read_shift((g?u-24:u)>>1,"utf16le").replace(ne,""),g&&(c.l+=24),u;case"0303000000000000c000000000000046":return(function(v){for(var S=v.read_shift(2),T="";0<S--;)T+="../";var k=v.read_shift(0,"lpstr-ansi");if(v.l+=2,v.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(v.read_shift(4)===0)return T+k.replace(/\\/g,"/");if(k=v.read_shift(4),v.read_shift(2)!=3)throw new Error("Bad FileMoniker");return T+v.read_shift(k>>1,"utf16le").replace(ne,"")})(s);default:throw new Error("Unsupported Moniker "+x)}}function ll(s){var c=s.read_shift(4);return 0<c?s.read_shift(c,"utf16le").replace(ne,""):""}function Ml(s,c){(c=c||Mt(6+2*s.length)).write_shift(4,1+s.length);for(var u=0;u<s.length;++u)c.write_shift(2,s.charCodeAt(u));return c.write_shift(2,0),c}function o0(s){return[s.read_shift(1),s.read_shift(1),s.read_shift(1),s.read_shift(1)]}function a0(s){return s=o0(s),s[3]=0,s}function Is(s){return{r:s.read_shift(2),c:s.read_shift(2),ixfe:s.read_shift(2)}}function _l(s,c,u,h){return(h=h||Mt(6)).write_shift(2,s),h.write_shift(2,c),h.write_shift(2,u||0),h}function Qc(s){return[s.read_shift(2),Fg(s)]}function Pa(s){var c=s.read_shift(2),u=s.read_shift(2);return{s:{c:s.read_shift(2),r:c},e:{c:s.read_shift(2),r:u}}}function sh(s,c){return(c=c||Mt(8)).write_shift(2,s.s.r),c.write_shift(2,s.e.r),c.write_shift(2,s.s.c),c.write_shift(2,s.e.c),c}function Wg(s){var c=s.read_shift(2),u=s.read_shift(2);return{s:{c:s.read_shift(1),r:c},e:{c:s.read_shift(1),r:u}}}var PS=Wg;function rv(s){s.l+=4;var c=s.read_shift(2),u=s.read_shift(2),h=s.read_shift(2);return s.l+=12,[u,c,h]}function Ss(s){s.l+=2,s.l+=s.read_shift(2)}var Ma={0:Ss,4:Ss,5:Ss,6:Ss,7:function(s){return s.l+=4,s.cf=s.read_shift(2),{}},8:Ss,9:Ss,10:Ss,11:Ss,12:Ss,13:function(s){var c={};return s.l+=4,s.l+=16,c.fSharedNote=s.read_shift(2),s.l+=4,c},14:Ss,15:Ss,16:Ss,17:Ss,18:Ss,19:Ss,20:Ss,21:rv};function Wd(s,c){var u={BIFFVer:0,dt:0};switch(u.BIFFVer=s.read_shift(2),2<=(c-=2)&&(u.dt=s.read_shift(2),s.l-=2),u.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<c)throw new Error("Unexpected BIFF Ver "+u.BIFFVer)}return s.read_shift(c),u}function Gu(s,c,u){var h=1536,g=16;switch(u.bookType){case"biff8":break;case"biff5":h=1280,g=8;break;case"biff4":h=4,g=6;break;case"biff3":h=3,g=6;break;case"biff2":h=2,g=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return u=Mt(g),u.write_shift(2,h),u.write_shift(2,c),4<g&&u.write_shift(2,29282),6<g&&u.write_shift(2,1997),8<g&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function ih(s){var c=Mt(8);c.write_shift(4,s.Count),c.write_shift(4,s.Unique);for(var u,h,g,x=[],v=0;v<s.length;++v)x[v]=(u=s[v],g=h=void 0,h=u.t||"",(g=Mt(3)).write_shift(2,h.length),g.write_shift(1,1),(u=Mt(2*h.length)).write_shift(2*h.length,h,"utf16le"),ce([g,u]));var S=ce([c].concat(x));return S.parts=[c.length].concat(x.map(function(T){return T.length})),S}function s0(s,c,u){var h=0;return u&&u.biff==2||(h=s.read_shift(2)),s=s.read_shift(2),u&&u.biff==2&&(h=1-(s>>15),s&=32767),[{Unsynced:1&h,DyZero:(2&h)>>1,ExAsc:(4&h)>>2,ExDsc:(8&h)>>3},s]}var uu=uc;function Ku(s,x,v){var h=s.l+x,S=v.biff!=8&&v.biff?2:4,g=s.read_shift(S),x=s.read_shift(S),v=s.read_shift(2),S=s.read_shift(2);return s.l=h,{s:{r:g,c:v},e:{r:x,c:S}}}function Yu(s,c,u,h){return u=u&&u.biff==5,(h=h||Mt(u?16:20)).write_shift(2,0),s.style?(h.write_shift(2,s.numFmtId||0),h.write_shift(2,65524)):(h.write_shift(2,s.numFmtId||0),h.write_shift(2,c<<4)),c=0,0<s.numFmtId&&u&&(c|=1024),h.write_shift(4,c),h.write_shift(4,0),u||h.write_shift(4,0),h.write_shift(2,0),h}function ov(s,c,u){var h=Is(s);return u.biff!=2&&c!=9||++s.l,s=(c=s).read_shift(1),s=c.read_shift(1)===1?s:s===1,h.val=s,h.t=s===!0||s===!1?"b":"e",h}function Vg(s,c,u){return c===0?"":uc(s,0,u)}function av(s,c,u){var h,g=s.read_shift(2),g={fBuiltIn:1&g,fWantAdvise:g>>>1&1,fWantPict:g>>>2&1,fOle:g>>>3&1,fOleLink:g>>>4&1,cf:g>>>5&1023,fIcon:g>>>15&1};return u.sbcch===14849&&(h=(function(x,k,S){x.l+=4,k-=4;var T=x.l+k,k=il(x,0,S);if((S=x.read_shift(2))!==(T-=x.l))throw new Error("Malformed AddinUdf: padding = "+T+" != "+S);return x.l+=S,k})(s,c-2,u)),g.body=h||s.read_shift(c-2),typeof h=="string"&&(g.Name=h),g}var sv=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Xc(s,T,u){var h=s.l+T,g=s.read_shift(2),x=s.read_shift(1),v=s.read_shift(1),S=s.read_shift(u&&u.biff==2?1:2),T=0;return(!u||5<=u.biff)&&(u.biff!=5&&(s.l+=2),T=s.read_shift(2),u.biff==5&&(s.l+=2),s.l+=4),v=lc(s,v,u),32&g&&(v=sv[v.charCodeAt(0)]),g=h-s.l,u&&u.biff==2&&--g,{chKey:x,Name:v,itab:T,rgce:h!=s.l&&S!==0&&0<g?(function(k,Z,L,G){var z,Z=k.l+Z,G=Rh(k,G,L);return Z!==k.l&&(z=ad(k,Z-k.l,G,L)),[G,z]})(s,g,u,S):[]}}function i0(s,c,u){if(u.biff<8)return(function(S,T){return S[S.l+1]==3&&S[S.l]++,T=il(S,0,T),T.charCodeAt(0)==3?T.slice(1):T})(s,u);for(var h,g,x=[],c=s.l+c,v=s.read_shift(8<u.biff?4:2);v--!=0;)x.push((h=s,u.biff,g=8<(g=u).biff?4:2,[h.read_shift(g),h.read_shift(g,"i"),h.read_shift(g,"i")]));if(s.l!=c)throw new Error("Bad ExternSheet: "+s.l+" != "+c);return x}function lh(s,c,u){var h=PS(s);switch(u.biff){case 2:s.l++,c-=7;break;case 3:case 4:s.l+=2,c-=8;break;default:s.l+=6,c-=12}return[h,(function(g,x,v){var S,T=g.l+x,k=v.biff==2?1:2,_=g.read_shift(k);if(_==65535)return[[],vs(g,x-2)];var L=Rh(g,_,v);return x!==_+k&&(S=ad(g,x-_-k,L,v)),g.l=T,[L,S]})(s,c,u)]}var iv={8:function(s,c){var u=s.l+c;s.l+=10;var h=s.read_shift(2);return s.l+=4,s.l+=2,s.l+=2,s.l+=2,s.l+=4,c=s.read_shift(1),s.l+=c,s.l=u,{fmt:h}}};function Vd(s){var c=Mt(24),u=ia(s[0]);c.write_shift(2,u.r),c.write_shift(2,u.r),c.write_shift(2,u.c),c.write_shift(2,u.c);for(var h="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),g=0;g<16;++g)c.write_shift(1,parseInt(h[g],16));return ce([c,(function(x){var v=Mt(512),S=0,T=x.Target,k=-1<(x=(T=T.slice(0,7)=="file://"?T.slice(7):T).indexOf("#"))?31:23;switch(T.charAt(0)){case"#":k=28;break;case".":k&=-3}v.write_shift(4,2),v.write_shift(4,k);for(var _=[8,6815827,6619237,4849780,83],S=0;S<_.length;++S)v.write_shift(4,_[S]);if(k==28)Ml(T=T.slice(1),v);else if(2&k){for(_="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),S=0;S<_.length;++S)v.write_shift(1,parseInt(_[S],16));var L=-1<x?T.slice(0,x):T;for(v.write_shift(4,2*(L.length+1)),S=0;S<L.length;++S)v.write_shift(2,L.charCodeAt(S));v.write_shift(2,0),8&k&&Ml(-1<x?T.slice(x+1):"",v)}else{for(_="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),S=0;S<_.length;++S)v.write_shift(1,parseInt(_[S],16));for(var B=0;T.slice(3*B,3*B+3)=="../"||T.slice(3*B,3*B+3)=="..\\";)++B;for(v.write_shift(2,B),v.write_shift(4,T.length-3*B+1),S=0;S<T.length-3*B;++S)v.write_shift(1,255&T.charCodeAt(S+3*B));for(v.write_shift(1,0),v.write_shift(2,65535),v.write_shift(2,57005),S=0;S<6;++S)v.write_shift(4,0)}return v.slice(0,v.l)})(s[1])])}function l0(s,T,u){if(!u.cellStyles)return vs(s,T);var h=u&&12<=u.biff?4:2,g=s.read_shift(h),x=s.read_shift(h),v=s.read_shift(h),S=s.read_shift(h),T=s.read_shift(2);return h==2&&(s.l+=2),S={s:g,e:x,w:v,ixfe:S,flags:T},(5<=u.biff||!u.biff)&&(S.level=T>>8&7),S}var c0=Is,u0=Hg,oy=cc,Gg,Kg,Ol,qu=[2,3,48,49,131,139,140,245],d0=(Gg={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},Kg=en({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),Ol={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(s,c){try{return rl(Yg(s,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}},to_sheet:Yg,from_sheet:function(s,c){if(0<=+(c=c||{}).codepage&&A(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");for(var u=xs(),h=(c=cm(s,{header:1,raw:!0,cellDates:!0}))[0],g=c.slice(1),x=s["!cols"]||[],k=0,v=0,S=0,T=1,k=0;k<h.length;++k)if(((x[k]||{}).DBF||{}).name)h[k]=x[k].DBF.name,++S;else if(h[k]!=null){if(++S,typeof h[k]=="number"&&(h[k]=h[k].toString(10)),typeof h[k]!="string")throw new Error("DBF Invalid column name "+h[k]+" |"+typeof h[k]+"|");if(h.indexOf(h[k])!==k){for(v=0;v<1024;++v)if(h.indexOf(h[k]+"_"+v)==-1){h[k]+="_"+v;break}}}var _=Ir(s["!ref"]),L=[],B=[],z=[];for(k=0;k<=_.e.c-_.s.c;++k){for(var Z="",G="",me=0,re=[],v=0;v<g.length;++v)g[v][k]!=null&&re.push(g[v][k]);if(re.length!=0&&h[k]!=null){for(v=0;v<re.length;++v){switch(typeof re[v]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=re[v]instanceof Date?"D":"C";break;default:G="C"}me=Math.max(me,String(re[v]).length),Z=Z&&Z!=G?"C":G}250<me&&(me=250),(G=((x[k]||{}).DBF||{}).type)=="C"&&x[k].DBF.len>me&&(me=x[k].DBF.len),Z=="B"&&G=="N"&&(Z="N",z[k]=x[k].DBF.dec,me=x[k].DBF.len),B[k]=Z=="C"||G=="N"?me:Ol[Z]||0,T+=B[k],L[k]=Z}else L[k]="?"}var Y,he,Ce=u.next(32);for(Ce.write_shift(4,318902576),Ce.write_shift(4,g.length),Ce.write_shift(2,296+32*S),Ce.write_shift(2,T),k=0;k<4;++k)Ce.write_shift(4,0);for(Ce.write_shift(4,0|(+Kg[m]||3)<<8),v=k=0;k<h.length;++k)h[k]!=null&&(Y=u.next(32),he=(h[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),Y.write_shift(1,he,"sbcs"),Y.write_shift(1,L[k]=="?"?"C":L[k],"sbcs"),Y.write_shift(4,v),Y.write_shift(1,B[k]||Ol[L[k]]||0),Y.write_shift(1,z[k]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),v+=B[k]||Ol[L[k]]||0);var we=u.next(264);for(we.write_shift(4,13),k=0;k<65;++k)we.write_shift(4,0);for(k=0;k<g.length;++k){var $e=u.next(T);for($e.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(L[v]){case"L":$e.write_shift(1,g[k][v]==null?63:g[k][v]?84:70);break;case"B":$e.write_shift(8,g[k][v]||0,"f");break;case"N":var ot="0";for(typeof g[k][v]=="number"&&(ot=g[k][v].toFixed(z[v]||0)),S=0;S<B[v]-ot.length;++S)$e.write_shift(1,32);$e.write_shift(1,ot,"sbcs");break;case"D":g[k][v]?($e.write_shift(4,("0000"+g[k][v].getFullYear()).slice(-4),"sbcs"),$e.write_shift(2,("00"+(g[k][v].getMonth()+1)).slice(-2),"sbcs"),$e.write_shift(2,("00"+g[k][v].getDate()).slice(-2),"sbcs")):$e.write_shift(8,"00000000","sbcs");break;case"C":var et=String(g[k][v]!=null?g[k][v]:"").slice(0,B[v]);for($e.write_shift(1,et,"sbcs"),S=0;S<B[v]-et.length;++S)$e.write_shift(1,32)}}return u.next(1).write_shift(1,26),u.end()}});function Yg(s,c){return c=c||{},c.dateNF||(c.dateNF="yyyymmdd"),s=ju((function(u,h){var g=[],x=ee(1);switch(h.type){case"base64":x=de(K(u));break;case"binary":x=de(u);break;case"buffer":case"array":x=u}ds(x,0);var v=x.read_shift(1),S=!!(136&v),T=!1,k=!1;switch(v){case 2:case 3:break;case 48:case 49:S=T=!0;break;case 131:case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var _=0,L=521;v==2&&(_=x.read_shift(2)),x.l+=3,1048576<(_=v!=2?x.read_shift(4):_)&&(_=1e6),v!=2&&(L=x.read_shift(2));var B=x.read_shift(2),z=h.codepage||1252;v!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(z=Gg[x[x.l]]),x.l+=1,x.l+=2),k&&(x.l+=36);for(var Z=[],G={},me=Math.min(x.length,v==2?521:L-10-(T?264:0)),re=k?32:11;x.l<me&&x[x.l]!=13;)switch((G={}).name=n.utils.decode(z,x.slice(x.l,x.l+re)).replace(/[\u0000\r\n].*$/g,""),x.l+=re,G.type=String.fromCharCode(x.read_shift(1)),v==2||k||(G.offset=x.read_shift(4)),G.len=x.read_shift(1),v==2&&(G.offset=x.read_shift(2)),G.dec=x.read_shift(1),G.name.length&&Z.push(G),v!=2&&(x.l+=k?13:14),G.type){case"B":T&&G.len==8||!h.WTF||console.log("Skipping "+G.name+":"+G.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+G.type)}if(x[x.l]!==13&&(x.l=L-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=L;var Y=0,he=0;for(g[0]=[],he=0;he!=Z.length;++he)g[0][he]=Z[he].name;for(;0<_--;)if(x[x.l]!==42)for(++x.l,g[++Y]=[],he=he=0;he!=Z.length;++he){var Ce=x.slice(x.l,x.l+Z[he].len);x.l+=Z[he].len,ds(Ce,0);var we=n.utils.decode(z,Ce);switch(Z[he].type){case"C":we.trim().length&&(g[Y][he]=we.replace(/\s+$/,""));break;case"D":we.length===8?g[Y][he]=new Date(+we.slice(0,4),+we.slice(4,6)-1,+we.slice(6,8)):g[Y][he]=we;break;case"F":g[Y][he]=parseFloat(we.trim());break;case"+":case"I":g[Y][he]=k?2147483648^Ce.read_shift(-4,"i"):Ce.read_shift(4,"i");break;case"L":switch(we.trim().toUpperCase()){case"Y":case"T":g[Y][he]=!0;break;case"N":case"F":g[Y][he]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+we+"|")}break;case"M":if(!S)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));g[Y][he]="##MEMO##"+(k?parseInt(we.trim(),10):Ce.read_shift(4));break;case"N":(we=we.replace(/\u0000/g,"").trim())&&we!="."&&(g[Y][he]=+we||0);break;case"@":g[Y][he]=new Date(Ce.read_shift(-8,"f")-621356832e5);break;case"T":g[Y][he]=new Date(864e5*(Ce.read_shift(4)-2440588)+Ce.read_shift(4));break;case"Y":g[Y][he]=Ce.read_shift(4,"i")/1e4+Ce.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[Y][he]=-Ce.read_shift(-8,"f");break;case"B":if(T&&Z[he].len==8){g[Y][he]=Ce.read_shift(8,"f");break}case"G":case"P":Ce.l+=Z[he].len;break;case"0":if(Z[he].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+Z[he].type)}}else x.l+=B;if(v!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),h.DBF=Z,g})(s,c),c),s["!cols"]=c.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete c.DBF,s}var fc,Gd,ch,Kd,uh=(fc={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},Gd=new RegExp("\x1BN("+Bt(fc).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),ch=function(s,c){return c=fc[c],typeof c=="number"?j(c):c},Kd=function(s,c,u){return u=c.charCodeAt(0)-32<<4|u.charCodeAt(0)-48,u==59?s:j(u)},fc["|"]=254,{to_workbook:function(s,c){return rl(Jc(s,c),c)},to_sheet:Jc,from_sheet:function(s,c){var u,h,g=["ID;PWXL;N;E"],x=[],v=Ir(s["!ref"]),S=Array.isArray(s),T=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),s["!cols"]&&(u=g,s["!cols"].forEach(function(B,z){z="F;W"+(z+1)+" "+(z+1)+" ",B.hidden?z+="0":(typeof B.width!="number"||B.wpx||(B.wpx=Zd(B.width)),typeof B.wpx!="number"||B.wch||(B.wch=eu(B.wpx)),typeof B.wch=="number"&&(z+=Math.round(B.wch))),z.charAt(z.length-1)!=" "&&u.push(z)})),s["!rows"]&&(h=g,s["!rows"].forEach(function(B,z){var Z="F;";B.hidden?Z+="M0;":B.hpt?Z+="M"+20*B.hpt+";":B.hpx&&(Z+="M"+20*ef(B.hpx)+";"),2<Z.length&&h.push(Z+"R"+(z+1))})),g.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var k=v.s.r;k<=v.e.r;++k)for(var _=v.s.c;_<=v.e.c;++_){var L=yr({r:k,c:_});(L=S?(s[k]||[])[_]:s[L])&&(L.v!=null||L.f&&!L.F)&&x.push((function(B,z,Z){var G="C;Y"+(z+1)+";X"+(Z+1)+";K";switch(B.t){case"n":G+=B.v||0,B.f&&!B.F&&(G+=";E"+P0(B.f,{r:z,c:Z}));break;case"b":G+=B.v?"TRUE":"FALSE";break;case"e":G+=B.w||B.v;break;case"d":G+='"'+(B.w||B.v)+'"';break;case"s":G+='"'+B.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return G})(L,k,_))}return g.join(T)+T+x.join(T)+T+"E"+T}});function dh(B,c){var u,h,g=B.split(/[\n\r]+/),x=-1,v=-1,S=0,T=0,k=[],_=[],L=null,B={},z=[],Z=[],G=0;for(0<=+c.codepage&&A(+c.codepage);S!==g.length;++S){G=0;var me,re=g[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,Kd).replace(Gd,ch),Y=re.replace(/;;/g,"\0").split(";").map(function(Qt){return Qt.replace(/\u0000/g,";")}),he=Y[0];if(0<re.length)switch(he){case"ID":case"E":case"B":case"O":case"W":break;case"P":Y[1].charAt(0)=="P"&&_.push(re.slice(3).replace(/;;/g,";"));break;case"C":for(var Ce=!1,we=!1,$e=!1,ot=!1,et=-1,dt=-1,T=1;T<Y.length;++T)switch(Y[T].charAt(0)){case"A":break;case"X":v=parseInt(Y[T].slice(1))-1,we=!0;break;case"Y":for(x=parseInt(Y[T].slice(1))-1,we||(v=0),h=k.length;h<=x;++h)k[h]=[];break;case"K":(me=Y[T].slice(1)).charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(ts(me))?isNaN(Tt(me).getDate())||(me=Jn(me)):(me=ts(me),L!==null&&xt(L)&&(me=Qn(me))),n!==void 0&&typeof me=="string"&&(c||{}).type!="string"&&(c||{}).codepage&&(me=n.utils.decode(c.codepage,me)),Ce=!0;break;case"E":ot=!0;var Ot=rd(Y[T].slice(1),{r:x,c:v});k[x][v]=[k[x][v],Ot];break;case"S":$e=!0,k[x][v]=[k[x][v],"S5S"];break;case"G":break;case"R":et=parseInt(Y[T].slice(1))-1;break;case"C":dt=parseInt(Y[T].slice(1))-1;break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+re)}if(Ce&&(k[x][v]&&k[x][v].length==2?k[x][v][0]=me:k[x][v]=me,L=null),$e){if(ot)throw new Error("SYLK shared formula cannot have own formula");var jt=-1<et&&k[et][dt];if(!jt||!jt[1])throw new Error("SYLK shared formula cannot find base");k[x][v][1]=Eh(jt[1],{r:x-et,c:v-dt})}break;case"F":var bt=0;for(T=1;T<Y.length;++T)switch(Y[T].charAt(0)){case"X":v=parseInt(Y[T].slice(1))-1,++bt;break;case"Y":for(x=parseInt(Y[T].slice(1))-1,h=k.length;h<=x;++h)k[h]=[];break;case"M":G=parseInt(Y[T].slice(1))/20;break;case"F":case"G":break;case"P":L=_[parseInt(Y[T].slice(1))];break;case"S":case"D":case"N":break;case"W":for(u=Y[T].slice(1).split(" "),h=parseInt(u[0],10);h<=parseInt(u[1],10);++h)G=parseInt(u[2],10),Z[h-1]=G===0?{hidden:!0}:{wch:G},tu(Z[h-1]);break;case"C":Z[v=parseInt(Y[T].slice(1))-1]||(Z[v]={});break;case"R":z[x=parseInt(Y[T].slice(1))-1]||(z[x]={}),0<G?(z[x].hpt=G,z[x].hpx=nd(G)):G===0&&(z[x].hidden=!0);break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+re)}bt<1&&(L=null);break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+re)}}return 0<z.length&&(B["!rows"]=z),0<Z.length&&(B["!cols"]=Z),[k=c&&c.sheetRows?k.slice(0,c.sheetRows):k,B]}function Jc(h,c){var u=(function(v,S){switch(S.type){case"base64":return dh(K(v),S);case"binary":return dh(v,S);case"buffer":return dh(W&&Buffer.isBuffer(v)?v.toString("binary"):oe(v),S);case"array":return dh(aa(v),S)}throw new Error("Unrecognized type "+S.type)})(h,c),h=u[0],g=u[1],x=ju(h,c);return Bt(g).forEach(function(v){x[v]=g[v]}),x}var qg={to_workbook:function(s,c){return rl(f0(s,c),c)},to_sheet:f0,from_sheet:function(s){var c=[],u=Ir(s["!ref"]),h=Array.isArray(s);Yd(c,"TABLE",0,1,"sheetjs"),Yd(c,"VECTORS",0,u.e.r-u.s.r+1,""),Yd(c,"TUPLES",0,u.e.c-u.s.c+1,""),Yd(c,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){ps(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var v,S=yr({r:g,c:x});if(v=h?(s[g]||[])[x]:s[S])switch(v.t){case"n":var T=v.w;(T=!T&&v.v!=null?v.v:T)==null?v.f&&!v.F?ps(c,1,0,"="+v.f):ps(c,1,0,""):ps(c,0,T,"V");break;case"b":ps(c,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":ps(c,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Wt(v.z||ae[14],En(Jn(v.v)))),ps(c,0,v.w,"V");break;default:ps(c,1,0,"")}else ps(c,1,0,"")}}return ps(c,-1,0,"EOD"),c.join(`\r
`)}};function cl(s,c){for(var u=s.split(`
`),h=-1,g=-1,x=0,v=[];x!==u.length;++x)if(u[x].trim()!=="BOT"){if(!(h<0)){for(var S=u[x].trim().split(","),T=S[0],k=S[1],_=u[++x]||"";1&(_.match(/["]/g)||[]).length&&x<u.length-1;)_+=`
`+u[++x];switch(_=_.trim(),+T){case-1:if(_==="BOT"){v[++h]=[],g=0;continue}if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[h][g]=!0:_==="FALSE"?v[h][g]=!1:isNaN(ts(k))?isNaN(Tt(k).getDate())?v[h][g]=k:v[h][g]=Jn(k):v[h][g]=ts(k),++g;break;case 1:_=(_=_.slice(1,_.length-1)).replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[h][g++]=_!==""?_:null}if(_==="EOD")break}}else v[++h]=[],g=0;return v=c&&c.sheetRows?v.slice(0,c.sheetRows):v}function f0(s,c){return ju((function(u,h){switch(h.type){case"base64":return cl(K(u),h);case"binary":return cl(u,h);case"buffer":return cl(W&&Buffer.isBuffer(u)?u.toString("binary"):oe(u),h);case"array":return cl(aa(u),h)}throw new Error("Unrecognized type "+h.type)})(s,c),c)}function Yd(s,c,u,h,g){s.push(c),s.push(u+","+h),s.push('"'+g.replace(/"/g,'""')+'"')}function ps(s,c,u,h){s.push(c+","+u),s.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)}var hc,Qu,h0,p0,qd=(hc=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),Qu=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h0=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p0="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(s,c){return rl(Qg(s,c),c)},to_sheet:Qg,from_sheet:function(s){return[hc,Qu,h0,Qu,(function(c){if(!c||!c["!ref"])return"";for(var u,h,g=[],x=[],v=Cs(c["!ref"]),S=Array.isArray(c),T=v.s.r;T<=v.e.r;++T)for(var k=v.s.c;k<=v.e.c;++k)if(h=yr({r:T,c:k}),(u=S?(c[T]||[])[k]:c[h])&&u.v!=null&&u.t!=="z"){switch(x=["cell",h,"t"],u.t){case"s":case"str":x.push(Xu(u.v));break;case"n":u.f?(x[2]="vtf",x[3]="n",x[4]=u.v,x[5]=Xu(u.f)):(x[2]="v",x[3]=u.v);break;case"b":x[2]="vt"+(u.f?"f":"c"),x[3]="nl",x[4]=u.v?"1":"0",x[5]=Xu(u.f||(u.v?"TRUE":"FALSE"));break;case"d":var _=En(Jn(u.v));x[2]="vtc",x[3]="nd",x[4]=""+_,x[5]=u.w||Wt(u.z||ae[14],_);break;case"e":continue}g.push(x.join(":"))}return g.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)})(s),p0].join(`
`)}});function Xu(s){return s.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function Qg(s,c){return ju((function(u,h){for(var g,x=u.split(`
`),v=-1,S=0,T=[];S!==x.length;++S){var k=x[S].trim().split(":");if(k[0]==="cell"){var _=ia(k[1]);if(T.length<=_.r)for(v=T.length;v<=_.r;++v)T[v]||(T[v]=[]);switch(v=_.r,g=_.c,k[2]){case"t":T[v][g]=k[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":T[v][g]=+k[3];break;case"vtf":var L=k[k.length-1];case"vtc":k[3]==="nl"?T[v][g]=!!+k[4]:T[v][g]=+k[4],k[2]=="vtf"&&(T[v][g]=[T[v][g],L])}}}return T=h&&h.sheetRows?T.slice(0,h.sheetRows):T})(s,c),c)}var m0,pc,mc=(m0={44:",",9:"	",59:";",124:"|"},pc={44:3,9:2,59:1,124:0},{to_workbook:function(s,c){return rl(mi(s,c),c)},to_sheet:mi,from_sheet:function(s){for(var c=[],u=Ir(s["!ref"]),h=Array.isArray(s),g=u.s.r;g<=u.e.r;++g){for(var x=[],v=u.s.c;v<=u.e.c;++v){var S=yr({r:g,c:v});if((S=h?(s[g]||[])[v]:s[S])&&S.v!=null){for(var T=(S.w||(Dl(S),S.w)||"").slice(0,10);T.length<10;)T+=" ";x.push(T+(v===0?" ":""))}else x.push("          ")}c.push(x.join(""))}return c.join(`
`)}});function Xg(s,c,u,h,g){g.raw?c[u][h]=s:s===""||(s==="TRUE"?c[u][h]=!0:s==="FALSE"?c[u][h]=!1:isNaN(ts(s))?isNaN(Tt(s).getDate())?c[u][h]=s:c[u][h]=Jn(s):c[u][h]=ts(s))}function g0(s){for(var c={},u=!1,h=0,g=0;h<s.length;++h)(g=s.charCodeAt(h))==34?u=!u:!u&&g in m0&&(c[g]=(c[g]||0)+1);for(h in g=[],c)Object.prototype.hasOwnProperty.call(c,h)&&g.push([c[h],h]);if(!g.length)for(h in c=pc)Object.prototype.hasOwnProperty.call(c,h)&&g.push([c[h],h]);return g.sort(function(x,v){return x[0]-v[0]||pc[x[1]]-pc[v[1]]}),m0[g.pop()[1]]||44}function Jg(s,h){var u=h||{},h="",g=u.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};s.slice(0,4)=="sep="?s.charCodeAt(5)==13&&s.charCodeAt(6)==10?(h=s.charAt(4),s=s.slice(7)):s.charCodeAt(5)==13||s.charCodeAt(5)==10?(h=s.charAt(4),s=s.slice(6)):h=g0(s.slice(0,1024)):h=u&&u.FS?u.FS:g0(s.slice(0,1024));var v=0,S=0,T=0,k=0,_=0,L=h.charCodeAt(0),B=!1,z=0,Z=s.charCodeAt(0);s=s.replace(/\r\n/gm,`
`);var G=u.dateNF!=null?(h=(h=typeof(h=u.dateNF)=="number"?ae[h]:h).replace(Sn,"(\\d+)"),new RegExp("^"+h+"$")):null;function me(){var re,Y=s.slice(k,_),he={};if((Y=Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'?Y.slice(1,-1).replace(/""/g,'"'):Y).length===0?he.t="z":u.raw||Y.trim().length===0?(he.t="s",he.v=Y):Y.charCodeAt(0)==61?Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(he.t="s",he.v=Y.slice(2,-1).replace(/""/g,'"')):Y.length!=1?(he.t="n",he.f=Y.slice(1)):(he.t="s",he.v=Y):Y=="TRUE"?(he.t="b",he.v=!0):Y=="FALSE"?(he.t="b",he.v=!1):isNaN(T=ts(Y))?!isNaN(Tt(Y).getDate())||G&&Y.match(G)?(he.z=u.dateNF||ae[14],re=0,G&&Y.match(G)&&(Y=(function(Ce,we){var $e=-1,ot=-1,et=-1,dt=-1,Ot=-1,jt=-1;(Ce.match(Sn)||[]).forEach(function(Qt,Tn){var wn=parseInt(we[Tn+1],10);switch(Qt.toLowerCase().charAt(0)){case"y":$e=wn;break;case"d":et=wn;break;case"h":dt=wn;break;case"s":jt=wn;break;case"m":0<=dt?Ot=wn:ot=wn}}),0<=jt&&Ot==-1&&0<=ot&&(Ot=ot,ot=-1);var bt=(""+(0<=$e?$e:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=ot?ot:1)).slice(-2)+"-"+("00"+(1<=et?et:1)).slice(-2);return(bt=bt.length==7?"0"+bt:bt).length==8&&(bt="20"+bt),Ce=("00"+(0<=dt?dt:0)).slice(-2)+":"+("00"+(0<=Ot?Ot:0)).slice(-2)+":"+("00"+(0<=jt?jt:0)).slice(-2),dt==-1&&Ot==-1&&jt==-1?bt:$e==-1&&ot==-1&&et==-1?Ce:bt+"T"+Ce})(u.dateNF,Y.match(G)||[]),re=1),u.cellDates?(he.t="d",he.v=Jn(Y,re)):(he.t="n",he.v=En(Jn(Y,re))),u.cellText!==!1&&(he.w=Wt(he.z,he.v instanceof Date?En(he.v):he.v)),u.cellNF||delete he.z):(he.t="s",he.v=Y):(!(he.t="n")!==u.cellText&&(he.w=Y),he.v=T),he.t=="z"||(u.dense?(g[v]||(g[v]=[]),g[v][S]=he):g[yr({c:S,r:v})]=he),k=_+1,Z=s.charCodeAt(k),x.e.c<S&&(x.e.c=S),x.e.r<v&&(x.e.r=v),z!=L)return S=0,++v,u.sheetRows&&u.sheetRows<=v?1:void 0;++S}e:for(;_<s.length;++_)switch(z=s.charCodeAt(_)){case 34:Z===34&&(B=!B);break;case L:case 10:case 13:if(!B&&me())break e}return 0<_-k&&me(),g["!ref"]=Tr(x),g}function pi(s,c){return!c||!c.PRN||c.FS||s.slice(0,4)=="sep="||0<=s.indexOf("	")||0<=s.indexOf(",")||0<=s.indexOf(";")?Jg(s,c):ju((function(u,h){var g=h||{},x=[];if(!u||u.length===0)return x;for(var v=u.split(/[\r\n]/),S=v.length-1;0<=S&&v[S].length===0;)--S;for(var T=10,k=0,_=0;_<=S;++_)(k=v[_].indexOf(" "))==-1?k=v[_].length:k++,T=Math.max(T,k);for(_=0;_<=S;++_){x[_]=[];var L=0;for(Xg(v[_].slice(0,T).trim(),x,_,L,g),L=1;L<=(v[_].length-T)/10+1;++L)Xg(v[_].slice(T+10*(L-1),T+10*L).trim(),x,_,L,g)}return x=g.sheetRows?x.slice(0,g.sheetRows):x})(s,c),c)}function mi(s,c){var u="",h=c.type=="string"?[0,0,0,0]:X1(s,c);switch(c.type){case"base64":u=K(s);break;case"binary":u=s;break;case"buffer":u=c.codepage==65001?s.toString("utf8"):c.codepage&&n!==void 0?n.utils.decode(c.codepage,s):W&&Buffer.isBuffer(s)?s.toString("binary"):oe(s);break;case"array":u=aa(s);break;case"string":u=s;break;default:throw new Error("Unrecognized type "+c.type)}return h[0]==239&&h[1]==187&&h[2]==191?u=po(u.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?u=po(u):c.type=="binary"&&n!==void 0&&c.codepage&&(u=n.utils.decode(c.codepage,n.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?qd.to_sheet(c.type=="string"?u:po(u),c):pi(u,c)}var ul,fh,y0,gc,Va=(ul={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},fh=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],y0={0:{n:"BOF",f:_o},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(s,c,u){var h={s:{c:0,r:0},e:{c:0,r:0}};return c==8&&u.qpro?(h.s.c=s.read_shift(1),s.l++,h.s.r=s.read_shift(2),h.e.c=s.read_shift(1),s.l++,h.e.r=s.read_shift(2)):(h.s.c=s.read_shift(2),h.s.r=s.read_shift(2),c==12&&u.qpro&&(s.l+=2),h.e.c=s.read_shift(2),h.e.r=s.read_shift(2),c==12&&u.qpro&&(s.l+=2),h.s.c==65535&&(h.s.c=h.e.c=h.s.r=h.e.r=0)),h}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(s,c,u){return(u=Bi(s,0,u))[1].v=s.read_shift(2,"i"),u}},14:{n:"NUMBER",f:function(s,c,u){return(u=Bi(s,0,u))[1].v=s.read_shift(8,"f"),u}},15:{n:"LABEL",f:Ar},16:{n:"FORMULA",f:function(s,c,u){var h=s.l+c;return(c=Bi(s,0,u))[1].v=s.read_shift(8,"f"),u.qpro?s.l=h:(h=s.read_shift(2),(function(g,x){ds(g,0);for(var v=[],S=0,T="",k="",_="",L="";g.l<g.length;){var B=g[g.l++];switch(B){case 0:v.push(g.read_shift(8,"f"));break;case 1:k=oo(x[0].c,g.read_shift(2),!0),T=oo(x[0].r,g.read_shift(2),!1),v.push(k+T);break;case 2:var z=oo(x[0].c,g.read_shift(2),!0),Z=oo(x[0].r,g.read_shift(2),!1);k=oo(x[0].c,g.read_shift(2),!0),T=oo(x[0].r,g.read_shift(2),!1),v.push(z+Z+":"+k+T);break;case 3:if(g.l<g.length)return console.error("WK1 premature formula end");break;case 4:v.push("("+v.pop()+")");break;case 5:v.push(g.read_shift(2));break;case 6:for(var G="";B=g[g.l++];)G+=String.fromCharCode(B);v.push('"'+G.replace(/"/g,'""')+'"');break;case 8:v.push("-"+v.pop());break;case 23:v.push("+"+v.pop());break;case 22:v.push("NOT("+v.pop()+")");break;case 20:case 21:L=v.pop(),_=v.pop(),v.push(["AND","OR"][B-20]+"("+_+","+L+")");break;default:if(B<32&&fh[B])L=v.pop(),_=v.pop(),v.push(_+fh[B]+L);else{if(!ul[B])return B<=7?console.error("WK1 invalid opcode "+B.toString(16)):B<=24?console.error("WK1 unsupported op "+B.toString(16)):B<=30?console.error("WK1 invalid opcode "+B.toString(16)):B<=115?console.error("WK1 unsupported function opcode "+B.toString(16)):console.error("WK1 unrecognized opcode "+B.toString(16));if((S=(S=ul[B][1])==69?g[g.l++]:S)>v.length)return console.error("WK1 bad formula parse 0x"+B.toString(16)+":|"+v.join("|")+"|");Z=v.slice(-S),v.length-=S,v.push(ul[B][0]+"("+Z.join(",")+")")}}}v.length==1?x[1].f=""+v[0]:console.error("WK1 bad formula parse |"+v.join("|")+"|")})(s.slice(s.l,s.l+h),c),s.l+=h),c}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:Ar},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Zc},222:{n:"SHEETNAMELP",f:function(s,c){var u=s[s.l++];c-1<u&&(u=c-1);for(var h="";h.length<u;)h+=String.fromCharCode(s[s.l++]);return h}},65535:{n:""}},gc={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(s,c){var u=ta(s);return u[1].t="s",u[1].v=s.read_shift(c-4,"cstr"),u}},23:{n:"NUMBER17",f:hh},24:{n:"NUMBER18",f:function(s,c){var u=ta(s);u[1].v=s.read_shift(2);var h=u[1].v>>1;if(1&u[1].v)switch(7&h){case 0:h=5e3*(h>>3);break;case 1:h=500*(h>>3);break;case 2:h=(h>>3)/20;break;case 3:h=(h>>3)/200;break;case 4:h=(h>>3)/2e3;break;case 5:h=(h>>3)/2e4;break;case 6:h=(h>>3)/16;break;case 7:h=(h>>3)/64}return u[1].v=h,u}},25:{n:"FORMULA19",f:function(s,c){var u=hh(s);return s.l+=c-14,u}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(s,c){for(var u={},h=s.l+c;s.l<h;){var g=s.read_shift(2);if(g==14e3){for(u[g]=[0,""],u[g][0]=s.read_shift(2);s[s.l];)u[g][1]+=String.fromCharCode(s[s.l]),s.l++;s.l++}}return u}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(h,c){var u=ta(h),h=h.read_shift(4);return u[1].v=h>>6,u}},38:{n:"??"},39:{n:"NUMBER27",f:Ju},40:{n:"FORMULA28",f:function(s,c){var u=Ju(s);return s.l+=c-10,u}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Zc},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(s,c,u){if(u.qpro&&!(c<21))return u=s.read_shift(1),s.l+=17,s.l+=1,s.l+=2,[u,s.read_shift(c-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(s,c){var u=c||{};if(0<=+u.codepage&&A(+u.codepage),u.type=="string")throw new Error("Cannot write WK1 to JS string");var h=xs(),g=Ir(s["!ref"]),x=Array.isArray(s),v=[];vn(h,0,(c=1030,(u=Mt(2)).write_shift(2,c),u)),vn(h,6,(c=g,(u=Mt(8)).write_shift(2,c.s.c),u.write_shift(2,c.s.r),u.write_shift(2,c.e.c),u.write_shift(2,c.e.r),u));for(var S,T,k,_,L=Math.min(g.e.r,8191),B=g.s.r;B<=L;++B)for(var z=sa(B),Z=g.s.c;Z<=g.e.c;++Z){B===g.s.r&&(v[Z]=Yo(Z));var G=v[Z]+z,G=x?(s[B]||[])[Z]:s[G];G&&G.t!="z"&&(G.t=="n"?(0|G.v)==G.v&&-32768<=G.v&&G.v<=32767?vn(h,13,(S=B,T=Z,k=G.v,_=void 0,(_=Mt(7)).write_shift(1,255),_.write_shift(2,T),_.write_shift(2,S),_.write_shift(2,k,"i"),_)):vn(h,14,(T=B,S=Z,k=G.v,_=void 0,(_=Mt(13)).write_shift(1,255),_.write_shift(2,S),_.write_shift(2,T),_.write_shift(8,k,"f"),_)):vn(h,15,(function(me,re,Y){var he=Mt(7+Y.length);he.write_shift(1,255),he.write_shift(2,re),he.write_shift(2,me),he.write_shift(1,39);for(var Ce=0;Ce<he.length;++Ce){var we=Y.charCodeAt(Ce);he.write_shift(1,128<=we?95:we)}return he.write_shift(1,0),he})(B,Z,Dl(G).slice(0,239))))}return vn(h,1),h.end()},book_to_wk3:function(s,c){if(0<=+(c=c||{}).codepage&&A(+c.codepage),c.type=="string")throw new Error("Cannot write WK3 to JS string");var u=xs();vn(u,0,(function(G){var me=Mt(26);me.write_shift(2,4096),me.write_shift(2,4),me.write_shift(4,0);for(var re=0,Y=0,he=0,Ce=0;Ce<G.SheetNames.length;++Ce){var we=G.SheetNames[Ce],we=G.Sheets[we];we&&we["!ref"]&&(++he,we=Cs(we["!ref"]),re<we.e.r&&(re=we.e.r),Y<we.e.c&&(Y=we.e.c))}return 8191<re&&(re=8191),me.write_shift(2,re),me.write_shift(1,he),me.write_shift(1,Y),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(1,1),me.write_shift(1,2),me.write_shift(4,0),me.write_shift(4,0),me})(s));for(var h=0,g=0;h<s.SheetNames.length;++h)(s.Sheets[s.SheetNames[h]]||{})["!ref"]&&vn(u,27,(function(G,me){var re=Mt(5+G.length);re.write_shift(2,14e3),re.write_shift(2,me);for(var Y=0;Y<G.length;++Y){var he=G.charCodeAt(Y);re[re.l++]=127<he?95:he}return re[re.l++]=0,re})(s.SheetNames[h],g++));for(var x=0,h=0;h<s.SheetNames.length;++h){var v=s.Sheets[s.SheetNames[h]];if(v&&v["!ref"]){for(var S=Ir(v["!ref"]),T=Array.isArray(v),k=[],_=Math.min(S.e.r,8191),L=S.s.r;L<=_;++L)for(var B=sa(L),z=S.s.c;z<=S.e.c;++z){L===S.s.r&&(k[z]=Yo(z));var Z=k[z]+B,Z=T?(v[L]||[])[z]:v[Z];Z&&Z.t!="z"&&(Z.t=="n"?vn(u,23,(function($e,et,ot,he){var Ce=Mt(14);if(Ce.write_shift(2,$e),Ce.write_shift(1,ot),Ce.write_shift(1,et),he==0)return Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(2,65535),Ce;var we=0,$e=0,ot=0,et=0;return he<0&&(we=1,he=-he),$e=0|Math.log2(he),he/=Math.pow(2,$e-31),(2147483648&(et=he>>>0))==0&&(++$e,et=(he/=2)>>>0),he-=et,et|=2147483648,et>>>=0,he*=Math.pow(2,32),ot=he>>>0,Ce.write_shift(4,ot),Ce.write_shift(4,et),$e+=16383+(we?32768:0),Ce.write_shift(2,$e),Ce})(L,z,x,Z.v)):vn(u,22,(function(me,re,Y,he){var Ce=Mt(6+he.length);Ce.write_shift(2,me),Ce.write_shift(1,Y),Ce.write_shift(1,re),Ce.write_shift(1,39);for(var we=0;we<he.length;++we){var $e=he.charCodeAt(we);Ce.write_shift(1,128<=$e?95:$e)}return Ce.write_shift(1,0),Ce})(L,z,x,Dl(Z).slice(0,239))))}++x}}return vn(u,1),u.end()},to_workbook:function(s,c){switch(c.type){case"base64":return Qd(de(K(s)),c);case"binary":return Qd(de(s),c);case"buffer":case"array":return Qd(s,c)}throw"Unsupported type "+c.type}});function ha(s,c,u){if(s){ds(s,s.l||0);for(var h=u.Enum||y0;s.l<s.length;){var g=s.read_shift(2),x=h[g]||h[65535],S=s.read_shift(2),v=s.l+S,S=x.f&&x.f(s,S,u);if(s.l=v,c(S,x,g))return}}}function Qd(s,c){if(!s)return s;var u=c||{},h=u.dense?[]:{},g="Sheet1",x="",v=0,S={},T=[],k=[],_={s:{r:0,c:0},e:{r:0,c:0}},L=u.sheetRows||0;if(s[2]==0&&(s[3]==8||s[3]==9)&&16<=s.length&&s[14]==5&&s[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(s[2]==2)u.Enum=y0,ha(s,function(G,me,re){switch(re){case 0:4096<=(u.vers=G)&&(u.qpro=!0);break;case 6:_=G;break;case 204:G&&(x=G);break;case 222:x=G;break;case 15:case 51:u.qpro||(G[1].v=G[1].v.slice(1));case 13:case 14:case 16:re==14&&(112&G[2])==112&&1<(15&G[2])&&(15&G[2])<15&&(G[1].z=u.dateNF||ae[14],u.cellDates&&(G[1].t="d",G[1].v=Qn(G[1].v))),u.qpro&&G[3]>v&&(h["!ref"]=Tr(_),S[g]=h,T.push(g),h=u.dense?[]:{},_={s:{r:0,c:0},e:{r:0,c:0}},v=G[3],g=x||"Sheet"+(v+1),x="");var Y=u.dense?(h[G[0].r]||[])[G[0].c]:h[yr(G[0])];if(Y){Y.t=G[1].t,Y.v=G[1].v,G[1].z!=null&&(Y.z=G[1].z),G[1].f!=null&&(Y.f=G[1].f);break}u.dense?(h[G[0].r]||(h[G[0].r]=[]),h[G[0].r][G[0].c]=G[1]):h[yr(G[0])]=G[1]}},u);else{if(s[2]!=26&&s[2]!=14)throw new Error("Unrecognized LOTUS BOF "+s[2]);u.Enum=gc,s[2]==14&&(u.qpro=!0,s.l=0),ha(s,function(G,me,re){switch(re){case 204:g=G;break;case 22:G[1].v=G[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(G[3]>v&&(h["!ref"]=Tr(_),S[g]=h,T.push(g),h=u.dense?[]:{},_={s:{r:0,c:0},e:{r:0,c:0}},v=G[3],g="Sheet"+(v+1)),0<L&&G[0].r>=L)break;u.dense?(h[G[0].r]||(h[G[0].r]=[]),h[G[0].r][G[0].c]=G[1]):h[yr(G[0])]=G[1],_.e.c<G[0].c&&(_.e.c=G[0].c),_.e.r<G[0].r&&(_.e.r=G[0].r);break;case 27:G[14e3]&&(k[G[14e3][0]]=G[14e3][1]);break;case 1537:k[G[0]]=G[1],G[0]==v&&(g=G[1])}},u)}if(h["!ref"]=Tr(_),S[x||g]=h,T.push(x||g),!k.length)return{SheetNames:T,Sheets:S};for(var B={},z=[],Z=0;Z<k.length;++Z)S[T[Z]]?(z.push(k[Z]||T[Z]),B[k[Z]]=S[k[Z]]||S[T[Z]]):(z.push(k[Z]),B[k[Z]]={"!ref":"A1"});return{SheetNames:z,Sheets:B}}function Bi(s,c,u){var h=[{c:0,r:0},{t:"n",v:0},0,0];return u.qpro&&u.vers!=20768?(h[0].c=s.read_shift(1),h[3]=s.read_shift(1),h[0].r=s.read_shift(2),s.l+=2):(h[2]=s.read_shift(1),h[0].c=s.read_shift(2),h[0].r=s.read_shift(2)),h}function Ar(s,g,u){var h=s.l+g,g=Bi(s,0,u);return g[1].t="s",u.vers!=20768?(u.qpro&&s.l++,g[1].v=s.read_shift(h-s.l,"cstr"),g):(s.l++,h=s.read_shift(1),g[1].v=s.read_shift(h,"utf8"),g)}function oo(s,c,u){var h=32768&c;return(h?"":"$")+(u?Yo:sa)(c=(h?s:0)+(8192<=(c&=-32769)?c-16384:c))}function ta(s){var c=[{c:0,r:0},{t:"n",v:0},0];return c[0].r=s.read_shift(2),c[3]=s[s.l++],c[0].c=s[s.l++],c}function hh(x,c){var u=ta(x),h=x.read_shift(4),g=x.read_shift(4);if((v=x.read_shift(2))==65535)return h===0&&g===3221225472?(u[1].t="e",u[1].v=15):h===0&&g===3489660928?(u[1].t="e",u[1].v=42):u[1].v=0,u;var x=32768&v,v=(32767&v)-16446;return u[1].v=(1-2*x)*(g*Math.pow(2,32+v)+h*Math.pow(2,v)),u}function Ju(h,c){var u=ta(h),h=h.read_shift(8,"f");return u[1].v=h,u}function Zc(s,c){return s[s.l+c-1]==0?s.read_shift(c,"cstr"):""}var ph,Xd,Zu,lv,pa=(ph=El("t"),Xd=El("rPr"),Zu=/<(?:\w+:)?r>/g,lv=/<\/(?:\w+:)?r>/,function(s){return s.replace(Zu,"").split(lv).map(Zg).filter(function(c){return c.v})});function Zg(s){var c=s.match(ph);return c?(c={t:"s",v:Sr(c[1])},s=s.match(Xd),s&&(c.s=(function(u){var h={},g=u.match($n),x=0,v=!1;if(g)for(;x!=g.length;++x){var S=sr(g[x]);switch(S[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!S.val)break;case"<shadow>":case"<shadow/>":h.shadow=1;break;case"</shadow>":break;case"<charset":if(S.val=="1")break;h.cp=C[parseInt(S.val,10)];break;case"<outline":if(!S.val)break;case"<outline>":case"<outline/>":h.outline=1;break;case"</outline>":break;case"<rFont":h.name=S.val;break;case"<sz":h.sz=S.val;break;case"<strike":if(!S.val)break;case"<strike>":case"<strike/>":h.strike=1;break;case"</strike>":break;case"<u":if(!S.val)break;switch(S.val){case"double":h.uval="double";break;case"singleAccounting":h.uval="single-accounting";break;case"doubleAccounting":h.uval="double-accounting"}case"<u>":case"<u/>":h.u=1;break;case"</u>":break;case"<b":if(S.val=="0")break;case"<b>":case"<b/>":h.b=1;break;case"</b>":break;case"<i":if(S.val=="0")break;case"<i>":case"<i/>":h.i=1;break;case"</i>":break;case"<color":S.rgb&&(h.color=S.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":h.family=S.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":h.valign=S.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":v=!0;break;case"</ext>":v=!1;break;default:if(S[0].charCodeAt(1)!==47&&!v)throw new Error("Unrecognized rich format "+S[0])}}return h})(s[1])),c):{t:"s",v:""}}var b0,cv=(b0=/(\r\n|\n)/g,function(s){return s.map(uv).join("")});function uv(s){var c,u,h,g=[[],s.v,[]];return s.v?(s.s&&(c=s.s,u=g[0],h=g[2],s=[],c.u&&s.push("text-decoration: underline;"),c.uval&&s.push("text-underline-style:"+c.uval+";"),c.sz&&s.push("font-size:"+c.sz+"pt;"),c.outline&&s.push("text-effect: outline;"),c.shadow&&s.push("text-shadow: auto;"),u.push('<span style="'+s.join("")+'">'),c.b&&(u.push("<b>"),h.push("</b>")),c.i&&(u.push("<i>"),h.push("</i>")),c.strike&&(u.push("<s>"),h.push("</s>")),(s=c.valign||"")=="superscript"||s=="super"?s="sup":s=="subscript"&&(s="sub"),s!=""&&(u.push("<"+s+">"),h.push("</"+s+">")),h.push("</span>")),g[0].join("")+g[1].replace(b0,"<br/>")+g[2].join("")):""}var MS=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,e1=/<(?:\w+:)?r>/,t1=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function mh(s,h){var u=!h||h.cellHTML,h={};return s?(s.match(/^\s*<(?:\w+:)?t[^>]*>/)?(h.t=Sr(po(s.slice(s.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),h.r=po(s),u&&(h.h=Op(h.t))):s.match(e1)&&(h.r=po(s),h.t=Sr(po((s.replace(t1,"").match(MS)||[]).join("").replace($n,""))),u&&(h.h=cv(pa(h.r)))),h):{t:""}}var Ps=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,xa=/<(?:\w+:)?(?:si|sstItem)>/g,v0=/<\/(?:\w+:)?(?:si|sstItem)>/,gh=/^\s|\s$|[\t\n\r]/;function yh(s,c){if(!c.bookSST)return"";var u=[Ke];u[u.length]=mn("sst",null,{xmlns:$c[0],count:s.Count,uniqueCount:s.Unique});for(var h,g,x=0;x!=s.length;++x)s[x]!=null&&(g="<si>",(h=s[x]).r?g+=h.r:(g+="<t",h.t||(h.t=""),h.t.match(gh)&&(g+=' xml:space="preserve"'),g+=">"+co(h.t)+"</t>"),g+="</si>",u[u.length]=g);return 2<u.length&&(u[u.length]="</sst>",u[1]=u[1].replace("/>",">")),u.join("")}var n1=function(s,c){var u=!1;return c==null&&(u=!0,c=Mt(15+4*s.t.length)),c.write_shift(1,0),Wa(s.t,c),u?c.slice(0,c.l):c};function yc(s){var c,u,h=xs();Ut(h,159,(c=s,(u=u||Mt(8)).write_shift(4,c.Count),u.write_shift(4,c.Unique),u));for(var g=0;g<s.length;++g)Ut(h,19,n1(s[g]));return Ut(h,160),h.end()}function bh(s){if(n!==void 0)return n.utils.encode(m,s);for(var c=[],u=s.split(""),h=0;h<u.length;++h)c[h]=u[h].charCodeAt(0);return c}function dl(s,c){var u={};return u.Major=s.read_shift(2),u.Minor=s.read_shift(2),4<=c&&(s.l+=c-4),u}function r1(s){var c=[];s.l+=4;for(var u=s.read_shift(4);0<u--;)c.push((function(h){for(var x=h.read_shift(4),g=h.l+x-4,x={},v=h.read_shift(4),S=[];0<v--;)S.push({t:h.read_shift(4),v:h.read_shift(0,"lpp4")});if(x.name=h.read_shift(0,"lpp4"),x.comps=S,h.l!=g)throw new Error("Bad DataSpaceMapEntry: "+h.l+" != "+g);return x})(s));return c}function dv(s){var c,u,u=(u={},(c=s).read_shift(4),c.l+=4,u.id=c.read_shift(0,"lpp4"),u.name=c.read_shift(0,"lpp4"),u.R=dl(c,4),u.U=dl(c,4),u.W=dl(c,4),u);if(u.ename=s.read_shift(0,"8lpp4"),u.blksz=s.read_shift(4),u.cmode=s.read_shift(4),s.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function o1(s,u){var u=s.l+u,h={};h.Flags=63&s.read_shift(4),s.l+=4,h.AlgID=s.read_shift(4);var g=!1;switch(h.AlgID){case 26126:case 26127:case 26128:g=h.Flags==36;break;case 26625:g=h.Flags==4;break;case 0:g=h.Flags==16||h.Flags==4||h.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+h.AlgID}if(!g)throw new Error("Encryption Flags/AlgID mismatch");return h.AlgIDHash=s.read_shift(4),h.KeySize=s.read_shift(4),h.ProviderType=s.read_shift(4),s.l+=8,h.CSPName=s.read_shift(u-s.l>>1,"utf16le"),s.l=u,h}function a1(s,h){var u={},h=s.l+h;return s.l+=4,u.Salt=s.slice(s.l,s.l+16),s.l+=16,u.Verifier=s.slice(s.l,s.l+16),s.l+=16,s.read_shift(4),u.VerifierHash=s.slice(s.l,h),s.l=h,u}function fv(s){var c=dl(s);switch(c.Minor){case 2:return[c.Minor,(function(g){if((63&g.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var h=g.read_shift(4),h=o1(g,h),g=a1(g,g.length-g.l);return{t:"Std",h,v:g}})(s)];case 3:return[c.Minor,(function(){throw new Error("File is password-protected: ECMA-376 Extensible")})()];case 4:return[c.Minor,(function(g){var h=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];g.l+=4;var g=g.read_shift(g.length-g.l,"utf8"),x={};return g.replace($n,function(v){var S=sr(v);switch(Gs(S[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":h.forEach(function(T){x[T]=S[T]});break;case"<dataIntegrity":x.encryptedHmacKey=S.encryptedHmacKey,x.encryptedHmacValue=S.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":x.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":x.uri=S.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":x.encs.push(S);break;default:throw S[0]}}),x})(s)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+c.Minor)}function x0(s){var c,u=0,h=bh(s),g=h.length+1,x=ee(g);for(x[0]=h.length,c=1;c!=g;++c)x[c]=h[c-1];for(c=g-1;0<=c;--c)u=(((16384&u)==0?0:1)|u<<1&32767)^x[c];return 52811^u}var C0,S0,s1,hv=(C0=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],S0=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],s1=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(s){for(var c,u,h=bh(s),g=(function(T){for(var k=S0[T.length-1],_=104,L=T.length-1;0<=L;--L)for(var B=T[L],z=0;z!=7;++z)64&B&&(k^=s1[_]),B*=2,--_;return k})(h),x=h.length,v=ee(16),S=0;S!=16;++S)v[S]=0;for((1&x)==1&&(c=g>>8,v[x]=ed(C0[0],c),--x,c=255&g,s=h[h.length-1],v[x]=ed(s,c));0<x;)c=g>>8,v[--x]=ed(h[x],c),c=255&g,v[--x]=ed(h[x],c);for(u=(x=15)-h.length;0<u;)c=g>>8,v[x]=ed(C0[u],c),--u,c=255&g,v[--x]=ed(h[x],c),--x,--u;return v});function ed(s,c){return 255&((c=s^c)/2|128*c)}var pv=function(s){var c=0,u=hv(s);return function(h){return h=(function(g,x,v,S,T){var k,_;for(T=T||x,S=S||hv(g),k=0;k!=x.length;++k)_=x[k],_=255&((_^=S[v])>>5|_<<3),T[k]=_,++v;return[T,v,S]})("",h,c,u),c=h[1],h[0]}};function mv(s,c,u){return u=u||{},u.Info=s.read_shift(2),s.l-=2,u.Info===1?u.Data=(function(h){var g={},x=g.EncryptionVersionInfo=dl(h,4);if(x.Major!=1||x.Minor!=1)throw"unrecognized version code "+x.Major+" : "+x.Minor;return g.Salt=h.read_shift(16),g.EncryptedVerifier=h.read_shift(16),g.EncryptedVerifierHash=h.read_shift(16),g})(s):u.Data=(function(h,g){var x={},v=x.EncryptionVersionInfo=dl(h,4);if(g-=4,v.Minor!=2)throw new Error("unrecognized minor version code: "+v.Minor);if(4<v.Major||v.Major<2)throw new Error("unrecognized major version code: "+v.Major);return x.Flags=h.read_shift(4),g-=4,v=h.read_shift(4),g-=4,x.EncryptionHeader=o1(h,v),g-=v,x.EncryptionVerifier=a1(h,g),x})(s,c),u}var w0={to_workbook:function(s,c){return rl(i1(s,c),c)},to_sheet:i1,from_sheet:function(s){for(var c=["{\\rtf1\\ansi"],u=Ir(s["!ref"]),h=Array.isArray(s),g=u.s.r;g<=u.e.r;++g){c.push("\\trowd\\trautofit1");for(var x=u.s.c;x<=u.e.c;++x)c.push("\\cellx"+(x+1));for(c.push("\\pard\\intbl"),x=u.s.c;x<=u.e.c;++x){var v=yr({r:g,c:x});(v=h?(s[g]||[])[x]:s[v])&&(v.v!=null||v.f&&!v.F)&&(c.push(" "+(v.w||(Dl(v),v.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}};function i1(s,c){switch(c.type){case"base64":return vh(K(s),c);case"binary":return vh(s,c);case"buffer":return vh(W&&Buffer.isBuffer(s)?s.toString("binary"):oe(s),c);case"array":return vh(aa(s),c)}throw new Error("Unrecognized type "+c.type)}function vh(h,c){var u=(c||{}).dense?[]:{},h=h.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(x,v){Array.isArray(u)&&(u[v]=[]);for(var S,T=/\\\w+\b/g,k=0,_=-1;S=T.exec(x);)S[0]==="\\cell"&&(++_,(S=(S=x.slice(k,T.lastIndex-S[0].length))[0]==" "?S.slice(1):S).length&&(S={v:S,t:"s"},Array.isArray(u)?u[v][_]=S:u[yr({r:v,c:_})]=S)),k=T.lastIndex;_>g.e.c&&(g.e.c=_)}),u["!ref"]=Tr(g),u}function Jd(s){for(var c=0,u=1;c!=3;++c)u=256*u+(255<s[c]?255:s[c]<0?0:s[c]);return u.toString(16).toUpperCase().slice(1)}function xh(s,c){return c===0?s:(s=(function(_){var h=_[0]/255,g=_[1]/255,x=_[2]/255,v=Math.max(h,g,x),S=Math.min(h,g,x),T=v-S;if(T==0)return[0,0,h];var k=0,_=0,_=T/(1<(S=v+S)?2-S:S);switch(v){case h:k=((g-x)/T+6)%6;break;case g:k=(x-h)/T+2;break;case x:k=(h-g)/T+4}return[k/6,_,S/2]})((s=(s=s).slice(s[0]==="#"?1:0).slice(0,6),[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)])),s[2]=c<0?s[2]*(1+c):1-(1-s[2])*(1-c),Jd((function(v){var h,g=v[0],x=v[1],v=v[2],S=2*x*(v<.5?v:1-v),T=[v=v-S/2,v,v],k=6*g;if(x!==0)switch(0|k){case 0:case 6:h=S*k,T[0]+=S,T[1]+=h;break;case 1:h=S*(2-k),T[0]+=h,T[1]+=S;break;case 2:h=S*(k-2),T[1]+=S,T[2]+=h;break;case 3:h=S*(4-k),T[1]+=h,T[2]+=S;break;case 4:h=S*(k-4),T[2]+=S,T[0]+=h;break;case 5:h=S*(6-k),T[2]+=h,T[0]+=S}for(var _=0;_!=3;++_)T[_]=Math.round(255*T[_]);return T})(s)))}var l1=6,_S=15,gv=1,Ca=l1;function Zd(s){return Math.floor((s+Math.round(128/Ca)/256)*Ca)}function eu(s){return Math.floor((s-5)/Ca*100+.5)/100}function td(s){return Math.round((s*Ca+5)/Ca*256)/256}function T0(s){return td(eu(Zd(s)))}function Ch(s){var c=Math.abs(s-T0(s)),u=Ca;if(.005<c)for(Ca=gv;Ca<_S;++Ca)Math.abs(s-T0(s))<=c&&(c=Math.abs(s-T0(s)),u=Ca);Ca=u}function tu(s){s.width?(s.wpx=Zd(s.width),s.wch=eu(s.wpx),s.MDW=Ca):s.wpx?(s.wch=eu(s.wpx),s.width=td(s.wch),s.MDW=Ca):typeof s.wch=="number"&&(s.width=td(s.wch),s.wpx=Zd(s.width),s.MDW=Ca),s.customWidth&&delete s.customWidth}var c1=96;function ef(s){return 96*s/c1}function nd(s){return s*c1/96}var yv={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},Sh=["numFmtId","fillId","fontId","borderId","xfId"],tf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],u1,d1,A0,f1,h1,wh,p1=(u1=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,d1=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,A0=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,f1=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,h1=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(s,c,u){var h,g,x,v,S,T={};return s&&((h=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(u1))&&(function(k,_,L){_.NumberFmt=[];for(var B=Bt(ae),z=0;z<B.length;++z)_.NumberFmt[B[z]]=ae[B[z]];var Z=k[0].match($n);if(Z)for(z=0;z<Z.length;++z){var G=sr(Z[z]);switch(Gs(G[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var me=Sr(po(G.formatCode)),re=parseInt(G.numFmtId,10);if(_.NumberFmt[re]=me,0<re){if(392<re){for(re=392;60<re&&_.NumberFmt[re]!=null;--re);_.NumberFmt[re]=me}_t(me,re)}break;case"</numFmt>":break;default:if(L.WTF)throw new Error("unrecognized "+G[0]+" in numFmts")}}})(h,T,u),(h=s.match(f1))&&(function(k,_,L,B){_.Fonts=[];var z={},Z=!1;(k[0].match($n)||[]).forEach(function(G){var me,re=sr(G);switch(Gs(re[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":_.Fonts.push(z),z={};break;case"<name":re.val&&(z.name=po(re.val));break;case"<name/>":case"</name>":break;case"<b":z.bold=re.val?Bo(re.val):1;break;case"<b/>":z.bold=1;break;case"<i":z.italic=re.val?Bo(re.val):1;break;case"<i/>":z.italic=1;break;case"<u":switch(re.val){case"none":z.underline=0;break;case"single":z.underline=1;break;case"double":z.underline=2;break;case"singleAccounting":z.underline=33;break;case"doubleAccounting":z.underline=34}break;case"<u/>":z.underline=1;break;case"<strike":z.strike=re.val?Bo(re.val):1;break;case"<strike/>":z.strike=1;break;case"<outline":z.outline=re.val?Bo(re.val):1;break;case"<outline/>":z.outline=1;break;case"<shadow":z.shadow=re.val?Bo(re.val):1;break;case"<shadow/>":z.shadow=1;break;case"<condense":z.condense=re.val?Bo(re.val):1;break;case"<condense/>":z.condense=1;break;case"<extend":z.extend=re.val?Bo(re.val):1;break;case"<extend/>":z.extend=1;break;case"<sz":re.val&&(z.sz=+re.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":re.val&&(z.vertAlign=re.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":re.val&&(z.family=parseInt(re.val,10));break;case"<family/>":case"</family>":break;case"<scheme":re.val&&(z.scheme=re.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(re.val=="1")break;re.codepage=C[parseInt(re.val,10)];break;case"<color":z.color||(z.color={}),re.auto&&(z.color.auto=Bo(re.auto)),re.rgb?z.color.rgb=re.rgb.slice(-6):re.indexed?(z.color.index=parseInt(re.indexed,10),me=zd[z.color.index],me=(me=z.color.index==81?zd[1]:me)||zd[1],z.color.rgb=me[0].toString(16)+me[1].toString(16)+me[2].toString(16)):re.theme&&(z.color.theme=parseInt(re.theme,10),re.tint&&(z.color.tint=parseFloat(re.tint)),re.theme&&L.themeElements&&L.themeElements.clrScheme&&(z.color.rgb=xh(L.themeElements.clrScheme[z.color.theme].rgb,z.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":Z=!0;break;case"</AlternateContent>":Z=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":Z=!0;break;case"</ext>":Z=!1;break;default:if(B&&B.WTF&&!Z)throw new Error("unrecognized "+re[0]+" in fonts")}})})(h,T,c,u),(h=s.match(A0))&&(function(k,_,L){_.Fills=[];var B={},z=!1;(k[0].match($n)||[]).forEach(function(Z){var G=sr(Z);switch(Gs(G[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":B={},_.Fills.push(B);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":_.Fills.push(B),B={};break;case"<patternFill":case"<patternFill>":G.patternType&&(B.patternType=G.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":B.bgColor||(B.bgColor={}),G.indexed&&(B.bgColor.indexed=parseInt(G.indexed,10)),G.theme&&(B.bgColor.theme=parseInt(G.theme,10)),G.tint&&(B.bgColor.tint=parseFloat(G.tint)),G.rgb&&(B.bgColor.rgb=G.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":B.fgColor||(B.fgColor={}),G.theme&&(B.fgColor.theme=parseInt(G.theme,10)),G.tint&&(B.fgColor.tint=parseFloat(G.tint)),G.rgb!=null&&(B.fgColor.rgb=G.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":z=!0;break;case"</ext>":z=!1;break;default:if(L&&L.WTF&&!z)throw new Error("unrecognized "+G[0]+" in fills")}})})(h,T,u),(h=s.match(h1))&&(function(k,_,L){_.Borders=[];var B={},z=!1;(k[0].match($n)||[]).forEach(function(Z){var G=sr(Z);switch(Gs(G[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":B={},G.diagonalUp&&(B.diagonalUp=Bo(G.diagonalUp)),G.diagonalDown&&(B.diagonalDown=Bo(G.diagonalDown)),_.Borders.push(B);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":z=!0;break;case"</ext>":z=!1;break;default:if(L&&L.WTF&&!z)throw new Error("unrecognized "+G[0]+" in borders")}})})(h,T,u),(h=s.match(d1))&&(h=h,x=u,S=!((g=T).CellXf=[]),(h[0].match($n)||[]).forEach(function(k){var _=sr(k),L=0;switch(Gs(_[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(v=_)[0],L=0;L<Sh.length;++L)v[Sh[L]]&&(v[Sh[L]]=parseInt(v[Sh[L]],10));for(L=0;L<tf.length;++L)v[tf[L]]&&(v[tf[L]]=Bo(v[tf[L]]));if(g.NumberFmt&&392<v.numFmtId){for(L=392;60<L;--L)if(g.NumberFmt[v.numFmtId]==g.NumberFmt[L]){v.numFmtId=L;break}}g.CellXf.push(v);break;case"</xf>":break;case"<alignment":case"<alignment/>":var B={};_.vertical&&(B.vertical=_.vertical),_.horizontal&&(B.horizontal=_.horizontal),_.textRotation!=null&&(B.textRotation=_.textRotation),_.indent&&(B.indent=_.indent),_.wrapText&&(B.wrapText=Bo(_.wrapText)),v.alignment=B;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":S=!0;break;case"</AlternateContent>":S=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":S=!0;break;case"</ext>":S=!1;break;default:if(x&&x.WTF&&!S)throw new Error("unrecognized "+_[0]+" in cellXfs")}}))),T});function m1(s,c){if(wh!==void 0)return wh.toXml();var u,h,g,x,v=[Ke,mn("styleSheet",null,{xmlns:$c[0],"xmlns:vt":fa.vt})];return s.SSF&&(h=s.SSF,g=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(S){for(var T=S[0];T<=S[1];++T)h[T]!=null&&(g[g.length]=mn("numFmt",null,{numFmtId:T,formatCode:co(h[T])}))}),(u=g.length===1?"":(g[g.length]="</numFmts>",g[0]=mn("numFmts",null,{count:g.length-2}).replace("/>",">"),g.join("")))!=null)&&(v[v.length]=u),v[v.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',v[v.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',v[v.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',v[v.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',c=c.cellXfs,(x=[])[x.length]="<cellXfs/>",c.forEach(function(S){x[x.length]=mn("xf",null,S)}),x[x.length]="</cellXfs>",(u=x.length===2?"":(x[0]=mn("cellXfs",null,{count:x.length-2}).replace("/>",">"),x.join("")))&&(v[v.length]=u),v[v.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',v[v.length]='<dxfs count="0"/>',v[v.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<v.length&&(v[v.length]="</styleSheet>",v[1]=v[1].replace("/>",">")),v.join("")}function bv(s,c){var u;(c=c||Mt(153)).write_shift(2,20*s.sz),u=s,h=(h=c)||Mt(2),u=(u.italic?2:0)|(u.strike?8:0)|(u.outline?16:0)|(u.shadow?32:0)|(u.condense?64:0)|(u.extend?128:0),h.write_shift(1,u),h.write_shift(1,0),c.write_shift(2,s.bold?700:400);var h=0;return s.vertAlign=="superscript"?h=1:s.vertAlign=="subscript"&&(h=2),c.write_shift(2,h),c.write_shift(1,s.underline||0),c.write_shift(1,s.family||0),c.write_shift(1,s.charset||0),c.write_shift(1,0),sc(s.color,c),h=0,s.scheme=="major"&&(h=1),s.scheme=="minor"&&(h=2),c.write_shift(1,h),Wa(s.name,c),c.length>c.l?c.slice(0,c.l):c}var E0,vv=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],xv=vs;function Cv(s,c){c=c||Mt(84),s=(E0=E0||en(vv))[s.patternType],s==null&&(s=40),c.write_shift(4,s);var u=0;if(s!=40)for(sc({auto:1},c),sc({auto:1},c);u<12;++u)c.write_shift(4,0);else{for(;u<4;++u)c.write_shift(4,0);for(;u<12;++u)c.write_shift(4,0)}return c.length>c.l?c.slice(0,c.l):c}function Sv(s,c,u){return(u=u||Mt(16)).write_shift(2,c||0),u.write_shift(2,s.numFmtId||0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u}function nf(s,c){return(c=c||Mt(10)).write_shift(1,0),c.write_shift(1,0),c.write_shift(4,0),c.write_shift(4,0),c}fr=vs;function Th(s,c){var u;c&&(u=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g=h[0];g<=h[1];++g)c[g]!=null&&++u}),u!=0&&(Ut(s,615,ii(u)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g,x,v,S=h[0];S<=h[1];++S)c[S]!=null&&Ut(s,44,(g=S,x=c[S],(v=(v=void 0)||Mt(6+4*x.length)).write_shift(2,g),Wa(x,v),x=v.length>v.l?v.slice(0,v.l):v,v.l==null&&(v.l=v.length),x))}),Ut(s,616)))}function g1(s){var c;Ut(s,613,ii(1)),Ut(s,46,((c=c||Mt(51)).write_shift(1,0),nf(0,c),nf(0,c),nf(0,c),nf(0,c),nf(0,c),c.length>c.l?c.slice(0,c.l):c)),Ut(s,614)}function k0(s){var c,u;Ut(s,619,ii(1)),Ut(s,48,(c={xfId:0,builtinId:0,name:"Normal"},(u=u||Mt(52)).write_shift(4,c.xfId),u.write_shift(2,1),u.write_shift(1,+c.builtinId),u.write_shift(1,0),nh(c.name||"",u),u.length>u.l?u.slice(0,u.l):u)),Ut(s,620)}function wv(s){var c,u,h,g;Ut(s,508,(c=0,u="TableStyleMedium9",h="PivotStyleMedium4",(g=Mt(2052)).write_shift(4,c),nh(u,g),nh(h,g),g.length>g.l?g.slice(0,g.l):g)),Ut(s,509)}function Tv(s,c){var u,h=xs();return Ut(h,278),Th(h,s.SSF),Ut(s=h,611,ii(1)),Ut(s,43,bv({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ut(s,612),Ut(s=h,603,ii(2)),Ut(s,45,Cv({patternType:"none"})),Ut(s,45,Cv({patternType:"gray125"})),Ut(s,604),g1(h),Ut(s=h,626,ii(1)),Ut(s,47,Sv({numFmtId:0},65535)),Ut(s,627),u=h,c=c.cellXfs,Ut(u,617,ii(c.length)),c.forEach(function(g){Ut(u,47,Sv(g,0))}),Ut(u,618),k0(h),Ut(c=h,505,ii(0)),Ut(c,506),wv(h),Ut(h,279),h.end()}var Ah=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Av(s,c,u){c.themeElements.clrScheme=[];var h={};(s[0].match($n)||[]).forEach(function(g){var x=sr(g);switch(x[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":h.rgb=x.val;break;case"<a:sysClr":h.rgb=x.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":x[0].charAt(1)==="/"?(c.themeElements.clrScheme[Ah.indexOf(x[0])]=h,h={}):h.name=x[0].slice(3,x[0].length-1);break;default:if(u&&u.WTF)throw new Error("Unrecognized "+x[0]+" in clrScheme")}})}function y1(){}function Ev(){}var b1=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,v1=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,kv=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,Dv=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function nu(s,c){var u,h,g,x,v,S={};if(!(u=(s=!s||s.length===0?D0():s).match(Dv)))throw new Error("themeElements not found in theme");return h=u[0],x=c,(g=S).themeElements={},[["clrScheme",b1,Av],["fontScheme",v1,y1],["fmtScheme",kv,Ev]].forEach(function(T){if(!(v=h.match(T[1])))throw new Error(T[0]+" not found in themeElements");T[2](v,g,x)}),S.raw=s,S}function D0(s,c){return c&&c.themeXLSX?c.themeXLSX:s&&typeof s.raw=="string"?s.raw:(s=[Ke],s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join(""))}function Rv(s){var c={};switch(c.xclrType=s.read_shift(2),c.nTintShade=s.read_shift(2),c.xclrType){case 0:s.l+=4;break;case 1:c.xclrValue=vs(s,4);break;case 2:c.xclrValue=o0(s);break;case 3:c.xclrValue=s.read_shift(4);break;case 4:s.l+=4}return s.l+=8,c}function Iv(s){var c=s.read_shift(2),u=s.read_shift(2)-4,h=[c];switch(c){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:h[1]=Rv(s);break;case 6:h[1]=vs(s,u);break;case 14:case 15:h[1]=s.read_shift(u==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+c+" "+u)}return h}function R0(){var s,c,u,h=xs();return Ut(h,332),Ut(h,334,ii(1)),Ut(h,335,((u=Mt(12+2*(c={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,c.flags),u.write_shift(4,c.version),Wa(c.name,u),u.slice(0,u.l))),Ut(h,336),Ut(h,339,(s=1,(u=Mt(8+2*(c="XLDAPR").length)).write_shift(4,s),Wa(c,u),u.slice(0,u.l))),Ut(h,52),Ut(h,35,ii(514)),Ut(h,4096,ii(0)),Ut(h,4097,hi(1)),Ut(h,36),Ut(h,53),Ut(h,340),Ut(h,337,(s=1,c=!0,(u=Mt(8)).write_shift(4,s),u.write_shift(4,c?1:0),u)),Ut(h,51,(function(g){var x=Mt(4+8*g.length);x.write_shift(4,g.length);for(var v=0;v<g.length;++v)x.write_shift(4,g[v][0]),x.write_shift(4,g[v][1]);return x})([[1,0]])),Ut(h,338),Ut(h,333),h.end()}function x1(){var s=[Ke];return s.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),s.join("")}var ru=1024;function C1(s,c){for(var u=[21600,21600],h=["m0,0l0",u[1],u[0],u[1],u[0],"0xe"].join(","),g=[mn("xml",null,{"xmlns:v":zo.v,"xmlns:o":zo.o,"xmlns:x":zo.x,"xmlns:mv":zo.mv}).replace(/\/>/,">"),mn("o:shapelayout",mn("o:idmap",null,{"v:ext":"edit",data:s}),{"v:ext":"edit"}),mn("v:shapetype",[mn("v:stroke",null,{joinstyle:"miter"}),mn("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:u.join(","),path:h})];ru<1e3*s;)ru+=1e3;return c.forEach(function(x){var v=ia(x[0]),T={color2:"#BEFF82",type:"gradient"};T.type=="gradient"&&(T.angle="-180");var S=T.type=="gradient"?mn("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,T=mn("v:fill",S,T);++ru,g=g.concat(["<v:shape"+Oi({id:"_x0000_s"+ru,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(x[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",T,mn("v:shadow",null,{on:"t",obscured:"t"}),mn("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",va("x:Anchor",[v.c+1,0,v.r+1,0,v.c+3,20,v.r+5,20].join(",")),va("x:AutoFill","False"),va("x:Row",String(v.r)),va("x:Column",String(v.c)),x[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),g.push("</xml>"),g.join("")}function S1(s,c,u,h){var g,x=Array.isArray(s);c.forEach(function(v){var S,T=ia(v.ref);(g=x?(s[T.r]||(s[T.r]=[]),s[T.r][T.c]):s[v.ref])||(g={t:"z"},x?s[T.r][T.c]=g:s[v.ref]=g,(S=Ir(s["!ref"]||"BDWGO1000001:A1")).s.r>T.r&&(S.s.r=T.r),S.e.r<T.r&&(S.e.r=T.r),S.s.c>T.c&&(S.s.c=T.c),S.e.c<T.c&&(S.e.c=T.c),(S=Tr(S))!==s["!ref"]&&(s["!ref"]=S)),g.c||(g.c=[]);var k={a:v.author,t:v.t,r:v.r,T:u};v.h&&(k.h=v.h);for(var _=g.c.length-1;0<=_;--_){if(!u&&g.c[_].T)return;u&&!g.c[_].T&&g.c.splice(_,1)}if(u&&h){for(_=0;_<h.length;++_)if(k.a==h[_].id){k.a=h[_].name||k.a;break}}g.c.push(k)})}function Pv(s){var c=[Ke,mn("comments",null,{xmlns:$c[0]})],u=[];return c.push("<authors>"),s.forEach(function(h){h[1].forEach(function(g){var x=co(g.a);u.indexOf(x)==-1&&(u.push(x),c.push("<author>"+x+"</author>")),g.T&&g.ID&&u.indexOf("tc="+g.ID)==-1&&(u.push("tc="+g.ID),c.push("<author>tc="+g.ID+"</author>"))})}),u.length==0&&(u.push("SheetJ5"),c.push("<author>SheetJ5</author>")),c.push("</authors>"),c.push("<commentList>"),s.forEach(function(h){var g=0,x=[];if(h[1][0]&&h[1][0].T&&h[1][0].ID?g=u.indexOf("tc="+h[1][0].ID):h[1].forEach(function(T){T.a&&(g=u.indexOf(co(T.a))),x.push(T.t||"")}),c.push('<comment ref="'+h[0]+'" authorId="'+g+'"><text>'),x.length<=1)c.push(va("t",co(x[0]||"")));else{for(var v=`Comment:
    `+x[0]+`
`,S=1;S<x.length;++S)v+=`Reply:
    `+x[S]+`
`;c.push(va("t",co(v)))}c.push("</text></comment>")}),c.push("</commentList>"),2<c.length&&(c[c.length]="</comments>",c[1]=c[1].replace("/>",">")),c.join("")}Or=rs;function w1(s){var c=xs(),u=[];return Ut(c,628),Ut(c,630),s.forEach(function(h){h[1].forEach(function(g){-1<u.indexOf(g.a)||(u.push(g.a.slice(0,54)),Ut(c,632,Wa(g.a.slice(0,54))))})}),Ut(c,631),Ut(c,633),s.forEach(function(h){h[1].forEach(function(g){g.iauthor=u.indexOf(g.a);var x,v={s:ia(h[0]),e:ia(h[0])};Ut(c,635,(v=[v,g],(x=x??Mt(36)).write_shift(4,v[1].iauthor),Vc(v[0],x),x.write_shift(4,0),x.write_shift(4,0),x.write_shift(4,0),x.write_shift(4,0),x)),g.t&&0<g.t.length&&Ut(c,637,IS(g)),Ut(c,636),delete g.iauthor})}),Ut(c,634),Ut(c,629),c.end()}var _a="application/vnd.ms-office.vbaProject",as=["xlsb","xlsm","xlam","biff8","xla"],I0,T1,rd=(T1=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(s,c){return I0=c,s.replace(T1,Mv)});function Mv(s,c,u,h){var g=!1,x=!1;return u.length==0?x=!0:u.charAt(0)=="["&&(x=!0,u=u.slice(1,-1)),h.length==0?g=!0:h.charAt(0)=="["&&(g=!0,h=h.slice(1,-1)),u=0<u.length?0|parseInt(u,10):0,h=0<h.length?0|parseInt(h,10):0,g?h+=I0.c:--h,x?u+=I0.r:--u,c+(g?"":"$")+Yo(h)+(x?"":"$")+sa(u)}var od=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,P0=function(s,c){return s.replace(od,function(u,h,g,x,v,S){return x=Wc(x)-(g?0:c.c),S=Wp(S)-(v?0:c.r),h+"R"+(S==0?"":v?1+S:"["+S+"]")+"C"+(x==0?"":g?1+x:"["+x+"]")})};function Eh(s,c){return s.replace(od,function(u,h,g,x,v,S){return h+(g=="$"?g+x:Yo(Wc(x)+c.c))+(v=="$"?v+S:sa(Wp(S)+c.r))})}function A1(s){return s.replace(/_xlfn\./g,"")}function Oa(s){s.l+=1}function fl(s,c){return c=s.read_shift(c==1?1:2),[16383&c,c>>14&1,c>>15&1]}function M0(v,c,g){var x=2;if(g){if(2<=g.biff&&g.biff<=5)return E1(v);g.biff==12&&(x=4)}var h=v.read_shift(x),g=v.read_shift(x),x=fl(v,2),v=fl(v,2);return{s:{r:h,c:x[0],cRel:x[1],rRel:x[2]},e:{r:g,c:v[0],cRel:v[1],rRel:v[2]}}}function E1(g){var c=fl(g,2),u=fl(g,2),h=g.read_shift(1),g=g.read_shift(1);return{s:{r:c[0],c:h,cRel:c[1],rRel:c[2]},e:{r:u[0],c:g,cRel:u[1],rRel:u[2]}}}function k1(v,c,x){if(x&&2<=x.biff&&x.biff<=5)return g=fl(h=v,2),h=h.read_shift(1),{r:g[0],c:h,cRel:g[1],rRel:g[2]};var h,g,x=v.read_shift(x&&x.biff==12?4:2),v=fl(v,2);return{r:x,c:v[0],cRel:v[1],rRel:v[2]}}function _v(v,c,x){if(x=x&&x.biff?x.biff:8,2<=x&&x<=5)return(function(L){var T=L.read_shift(2),k=L.read_shift(1),_=(32768&T)>>15,L=(16384&T)>>14;return T&=16383,_==1&&8192<=T&&(T-=16384),L==1&&128<=k&&(k-=256),{r:T,c:k,cRel:L,rRel:_}})(v);var h=v.read_shift(12<=x?4:2),g=v.read_shift(2),x=(16384&g)>>14,v=(32768&g)>>15;if(g&=16383,v==1)for(;524287<h;)h-=1048576;if(x==1)for(;8191<g;)g-=16384;return{r:h,c:g,cRel:x,rRel:v}}function _0(s){var c=1&s[s.l+1];return s.l+=4,[c,1]}function O0(s){return[s.read_shift(1),s.read_shift(1)]}function D1(s,c,u){var h=0,g=0;u.biff==12?(h=s.read_shift(4),g=s.read_shift(4)):(g=1+s.read_shift(1),h=1+s.read_shift(2)),2<=u.biff&&u.biff<8&&(--h,--g==0&&(g=256));for(var x=0,v=[];x!=h&&(v[x]=[]);++x)for(var S=0;S!=g;++S)v[x][S]=(function(T,k){var _=[T.read_shift(1)];if(k==12)switch(_[0]){case 2:_[0]=4;break;case 4:_[0]=16;break;case 0:_[0]=1;break;case 1:_[0]=2}switch(_[0]){case 4:_[1]=ao(T,1)?"TRUE":"FALSE",k!=12&&(T.l+=7);break;case 37:case 16:_[1]=al[T[T.l]],T.l+=k==12?4:8;break;case 0:T.l+=8;break;case 1:_[1]=fs(T);break;case 2:_[1]=uc(T,0,{biff:0<k&&k<8?2:k});break;default:throw new Error("Bad SerAr: "+_[0])}return _})(s,u.biff);return v}function rf(s,c,u){return s.l+=2,[(s=(h=s).read_shift(2),h=h.read_shift(2),{r:s,c:255&h,fQuoted:!!(16384&h),cRel:h>>15,rRel:h>>15})];var h}function kh(s){return s.l+=6,[]}function Dh(s){return s.l+=2,[_o(s),1&s.read_shift(2)]}var R1=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],I1={1:{n:"PtgExp",f:function(s,c,u){return s.l++,u&&u.biff==12?[s.read_shift(4,"i"),0]:[s.read_shift(2),s.read_shift(u&&u.biff==2?1:2)]}},2:{n:"PtgTbl",f:vs},3:{n:"PtgAdd",f:Oa},4:{n:"PtgSub",f:Oa},5:{n:"PtgMul",f:Oa},6:{n:"PtgDiv",f:Oa},7:{n:"PtgPower",f:Oa},8:{n:"PtgConcat",f:Oa},9:{n:"PtgLt",f:Oa},10:{n:"PtgLe",f:Oa},11:{n:"PtgEq",f:Oa},12:{n:"PtgGe",f:Oa},13:{n:"PtgGt",f:Oa},14:{n:"PtgNe",f:Oa},15:{n:"PtgIsect",f:Oa},16:{n:"PtgUnion",f:Oa},17:{n:"PtgRange",f:Oa},18:{n:"PtgUplus",f:Oa},19:{n:"PtgUminus",f:Oa},20:{n:"PtgPercent",f:Oa},21:{n:"PtgParen",f:Oa},22:{n:"PtgMissArg",f:Oa},23:{n:"PtgStr",f:function(s,c,u){return s.l++,il(s,0,u)}},26:{n:"PtgSheet",f:function(s,c,u){return s.l+=5,s.l+=2,s.l+=u.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(s,c,u){return s.l+=u.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(s){return s.l++,al[s.read_shift(1)]}},29:{n:"PtgBool",f:function(s){return s.l++,s.read_shift(1)!==0}},30:{n:"PtgInt",f:function(s){return s.l++,s.read_shift(2)}},31:{n:"PtgNum",f:function(s){return s.l++,fs(s)}},32:{n:"PtgArray",f:function(s,c,u){var h=(96&s[s.l++])>>5;return s.l+=u.biff==2?6:u.biff==12?14:7,[h]}},33:{n:"PtgFunc",f:function(s,c,u){var h=(96&s[s.l])>>5;return s.l+=1,u=s.read_shift(u&&u.biff<=3?1:2),[jv[u],M1[u],h]}},34:{n:"PtgFuncVar",f:function(s,c,u){var h=s[s.l++],g=s.read_shift(1),x=u&&u.biff<=3?[h==88?-1:0,s.read_shift(1)]:[(x=s)[x.l+1]>>7,32767&x.read_shift(2)];return[g,(x[0]===0?M1:ou)[x[1]]]}},35:{n:"PtgName",f:function(s,c,u){var h=s.read_shift(1)>>>5&3,g=!u||8<=u.biff?4:2,g=s.read_shift(g);switch(u.biff){case 2:s.l+=5;break;case 3:case 4:s.l+=8;break;case 5:s.l+=12}return[h,0,g]}},36:{n:"PtgRef",f:function(s,c,u){var h=(96&s[s.l])>>5;return s.l+=1,[h,k1(s,0,u)]}},37:{n:"PtgArea",f:function(s,c,u){return[(96&s[s.l++])>>5,M0(s,2<=u.biff&&u.biff,u)]}},38:{n:"PtgMemArea",f:function(s,c,u){var h=s.read_shift(1)>>>5&3;return s.l+=u&&u.biff==2?3:4,[h,s.read_shift(u&&u.biff==2?1:2)]}},39:{n:"PtgMemErr",f:vs},40:{n:"PtgMemNoMem",f:vs},41:{n:"PtgMemFunc",f:function(s,c,u){return[s.read_shift(1)>>>5&3,s.read_shift(u&&u.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(s,c,u){var h=s.read_shift(1)>>>5&3;return s.l+=4,u.biff<8&&s.l--,u.biff==12&&(s.l+=2),[h]}},43:{n:"PtgAreaErr",f:function(s,c,u){var h=(96&s[s.l++])>>5;return s.l+=u&&8<u.biff?12:u.biff<8?6:8,[h]}},44:{n:"PtgRefN",f:function(s,c,u){var h=(96&s[s.l])>>5;return s.l+=1,[h,_v(s,0,u)]}},45:{n:"PtgAreaN",f:function(s,c,u){return[(96&s[s.l++])>>5,(function(T,S){if(S.biff<8)return E1(T);var x=T.read_shift(S.biff==12?4:2),v=T.read_shift(S.biff==12?4:2),S=fl(T,2),T=fl(T,2);return{s:{r:x,c:S[0],cRel:S[1],rRel:S[2]},e:{r:v,c:T[0],cRel:T[1],rRel:T[2]}}})(s,u)]}},46:{n:"PtgMemAreaN",f:function(s){return[s.read_shift(1)>>>5&3,s.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(s){return[s.read_shift(1)>>>5&3,s.read_shift(2)]}},57:{n:"PtgNameX",f:function(s,c,u){return u.biff==5?(function(h){var g=h.read_shift(1)>>>5&3,x=h.read_shift(2,"i");h.l+=8;var v=h.read_shift(2);return h.l+=12,[g,x,v]})(s):[s.read_shift(1)>>>5&3,s.read_shift(2),s.read_shift(4)]}},58:{n:"PtgRef3d",f:function(s,c,u){var h=(96&s[s.l])>>5;s.l+=1;var g=s.read_shift(2);return u&&u.biff==5&&(s.l+=12),[h,g,k1(s,0,u)]}},59:{n:"PtgArea3d",f:function(s,c,u){var h=(96&s[s.l++])>>5,g=s.read_shift(2,"i");if(u)switch(u.biff){case 5:s.l+=12;break}return[h,g,M0(s,0,u)]}},60:{n:"PtgRefErr3d",f:function(s,c,u){var h=(96&s[s.l++])>>5,g=s.read_shift(2),x=4;if(u)switch(u.biff){case 5:x=15;break;case 12:x=6}return s.l+=x,[h,g]}},61:{n:"PtgAreaErr3d",f:function(s,c,u){var h=(96&s[s.l++])>>5,g=s.read_shift(2),x=8;if(u)switch(u.biff){case 5:s.l+=12,x=6;break;case 12:x=12}return s.l+=x,[h,g]}},255:{}},P1={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ov={1:{n:"PtgElfLel",f:Dh},2:{n:"PtgElfRw",f:rf},3:{n:"PtgElfCol",f:rf},6:{n:"PtgElfRwV",f:rf},7:{n:"PtgElfColV",f:rf},10:{n:"PtgElfRadical",f:rf},11:{n:"PtgElfRadicalS",f:kh},13:{n:"PtgElfColS",f:kh},15:{n:"PtgElfColSV",f:kh},16:{n:"PtgElfRadicalLel",f:Dh},25:{n:"PtgList",f:function(x){x.l+=2;var c=x.read_shift(2),u=x.read_shift(2),h=x.read_shift(4),g=x.read_shift(2),x=x.read_shift(2);return{ixti:c,coltype:3&u,rt:R1[u>>2&31],idx:h,c:g,C:x}}},29:{n:"PtgSxName",f:function(s){return s.l+=2,[s.read_shift(4)]}},255:{}},bc={0:{n:"PtgAttrNoop",f:function(s){return s.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(s,c,u){var h=255&s[s.l+1]?1:0;return s.l+=u&&u.biff==2?3:4,[h]}},2:{n:"PtgAttrIf",f:function(s,c,u){var h=255&s[s.l+1]?1:0;return s.l+=2,[h,s.read_shift(u&&u.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(s,c,u){s.l+=2;for(var h=s.read_shift(u&&u.biff==2?1:2),g=[],x=0;x<=h;++x)g.push(s.read_shift(u&&u.biff==2?1:2));return g}},8:{n:"PtgAttrGoto",f:function(s,c,u){var h=255&s[s.l+1]?1:0;return s.l+=2,[h,s.read_shift(u&&u.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(s,c,u){s.l+=u&&u.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:_0},33:{n:"PtgAttrBaxcel",f:_0},64:{n:"PtgAttrSpace",f:function(s){return s.read_shift(2),O0(s)}},65:{n:"PtgAttrSpaceSemi",f:function(s){return s.read_shift(2),O0(s)}},128:{n:"PtgAttrIfError",f:function(s){var c=255&s[s.l+1]?1:0;return s.l+=2,[c,s.read_shift(2)]}},255:{}};function ad(s,c,u,h){if(h.biff<8)return vs(s,c);for(var g=s.l+c,x=[],v=0;v!==u.length;++v)switch(u[v][0]){case"PtgArray":u[v][1]=D1(s,0,h),x.push(u[v][1]);break;case"PtgMemArea":u[v][2]=(function(S,T){for(var k=S.read_shift(T.biff==12?4:2),_=[],L=0;L!=k;++L)_.push((T.biff==12?ol:Pa)(S));return _})(s,(u[v][1],h)),x.push(u[v][2]);break;case"PtgExp":h&&h.biff==12&&(u[v][1][1]=s.read_shift(4),x.push(u[v][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+u[v][0]}return(c=g-s.l)!==0&&x.push(vs(s,c)),x}function Rh(s,c,u){for(var h,g,x=s.l+c,v=[];x!=s.l;)c=x-s.l,g=s[s.l],h=I1[g]||I1[P1[g]],(h=g===24||g===25?(g===24?Ov:bc)[s[s.l+1]]:h)&&h.f?v.push([h.n,h.f(s,c,u)]):vs(s,c);return v}var Fv={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fl(s,c,u){if(!s)return"SH33TJSERR0";if(8<u.biff&&(!s.XTI||!s.XTI[c]))return s.SheetNames[c];if(!s.XTI)return"SH33TJSERR6";var h=s.XTI[c];if(u.biff<8)return 1e4<c&&(c-=65536),(c=c<0?-c:c)==0?"":s.XTI[c-1];if(!h)return"SH33TJSERR1";var g="";if(8<u.biff)switch(s[h[0]][0]){case 357:return g=h[1]==-1?"#REF":s.SheetNames[h[1]],h[1]==h[2]?g:g+":"+s.SheetNames[h[2]];case 358:return u.SID!=null?s.SheetNames[u.SID]:"SH33TJSSAME"+s[h[0]][0];case 355:default:return"SH33TJSSRC"+s[h[0]][0]}switch(s[h[0]][0][0]){case 1025:return g=h[1]==-1?"#REF":s.SheetNames[h[1]]||"SH33TJSERR3",h[1]==h[2]?g:g+":"+s.SheetNames[h[2]];case 14849:return s[h[0]].slice(1).map(function(x){return x.Name}).join(";;");default:return s[h[0]][0][3]?(g=h[1]==-1?"#REF":s[h[0]][0][3][h[1]]||"SH33TJSERR4",h[1]==h[2]?g:g+":"+s[h[0]][0][3][h[2]]):"SH33TJSERR2"}}function F0(s,c,u){return c=Fl(s,c,u),c=="#REF"?c:(function(h,g){if(!(h||g&&g.biff<=5&&2<=g.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(h)?"'"+h+"'":h})(c,u)}function ws(s,c,u,h,g){var x,v,S,T=g&&g.biff||8,k={s:{c:0,r:0}},_=[],L=0,B=0,z="";if(!s[0]||!s[0][0])return"";for(var Z=-1,G="",me=0,re=s[0].length;me<re;++me){var Y=s[0][me];switch(Y[0]){case"PtgUminus":_.push("-"+_.pop());break;case"PtgUplus":_.push("+"+_.pop());break;case"PtgPercent":_.push(_.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(Tn=_.pop(),x=_.pop(),0<=Z){switch(s[0][Z][1][0]){case 0:G=ho(" ",s[0][Z][1][1]);break;case 1:G=ho("\r",s[0][Z][1][1]);break;default:if(G="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][Z][1][0])}x+=G,Z=-1}_.push(x+Fv[Y[0]]+Tn);break;case"PtgIsect":Tn=_.pop(),x=_.pop(),_.push(x+" "+Tn);break;case"PtgUnion":Tn=_.pop(),x=_.pop(),_.push(x+","+Tn);break;case"PtgRange":Tn=_.pop(),x=_.pop(),_.push(x+":"+Tn);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":v=eh(Y[1][1],k,g),_.push(Ld(v,T));break;case"PtgRefN":v=u?eh(Y[1][1],u,g):Y[1][1],_.push(Ld(v,T));break;case"PtgRef3d":L=Y[1][1],v=eh(Y[1][2],k,g),z=F0(h,L,g),_.push(z+"!"+Ld(v,T));break;case"PtgFunc":case"PtgFuncVar":var Ce=Y[1][0],he=Y[1][1],Ce=Ce||0,we=(Ce&=127)==0?[]:_.slice(-Ce);_.length-=Ce,he==="User"&&(he=we.shift()),_.push(he+"("+we.join(",")+")");break;case"PtgBool":_.push(Y[1]?"TRUE":"FALSE");break;case"PtgInt":_.push(Y[1]);break;case"PtgNum":_.push(String(Y[1]));break;case"PtgStr":_.push('"'+Y[1].replace(/"/g,'""')+'"');break;case"PtgErr":_.push(Y[1]);break;case"PtgAreaN":S=_g(Y[1][1],u?{s:u}:k,g),_.push(Hp(S,g));break;case"PtgArea":S=_g(Y[1][1],k,g),_.push(Hp(S,g));break;case"PtgArea3d":L=Y[1][1],S=Y[1][2],z=F0(h,L,g),_.push(z+"!"+Hp(S,g));break;case"PtgAttrSum":_.push("SUM("+_.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":B=Y[1][2];var $e=(h.names||[])[B-1]||(h[0]||[])[B],ot=$e?$e.Name:"SH33TJSNAME"+String(B);ot&&ot.slice(0,6)=="_xlfn."&&!g.xlfn&&(ot=ot.slice(6)),_.push(ot);break;case"PtgNameX":var et,dt=Y[1][1],B=Y[1][2];if(!(g.biff<=5)){$e="",((h[dt]||[])[0]||[])[0]==14849||(((h[dt]||[])[0]||[])[0]==1025?h[dt][B]&&0<h[dt][B].itab&&($e=h.SheetNames[h[dt][B].itab-1]+"!"):$e=h.SheetNames[B-1]+"!"),h[dt]&&h[dt][B]?$e+=h[dt][B].Name:h[0]&&h[0][B]?$e+=h[0][B].Name:(ot=(Fl(h,dt,g)||"").split(";;"))[B-1]?$e=ot[B-1]:$e+="SH33TJSERRX",_.push($e);break}et=(et=h[dt=dt<0?-dt:dt]?h[dt][B]:et)||{Name:"SH33TJSERRY"},_.push(et.Name);break;case"PtgParen":var Ot="(",jt=")";if(0<=Z){switch(G="",s[0][Z][1][0]){case 2:Ot=ho(" ",s[0][Z][1][1])+Ot;break;case 3:Ot=ho("\r",s[0][Z][1][1])+Ot;break;case 4:jt=ho(" ",s[0][Z][1][1])+jt;break;case 5:jt=ho("\r",s[0][Z][1][1])+jt;break;default:if(g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][Z][1][0])}Z=-1}_.push(Ot+_.pop()+jt);break;case"PtgRefErr":case"PtgRefErr3d":_.push("#REF!");break;case"PtgExp":v={c:Y[1][1],r:Y[1][0]};var bt={c:u.c,r:u.r};if(h.sharedf[yr(v)])dt=h.sharedf[yr(v)],_.push(ws(dt,0,bt,h,g));else{for(var Qt=!1,Tn=0;Tn!=h.arrayf.length;++Tn)if(x=h.arrayf[Tn],!(v.c<x[0].s.c||v.c>x[0].e.c||v.r<x[0].s.r||v.r>x[0].e.r)){_.push(ws(x[1],0,bt,h,g)),Qt=!0;break}Qt||_.push(Y[1])}break;case"PtgArray":_.push("{"+(function(dn){for(var rn=[],Vt=0;Vt<dn.length;++Vt){for(var Rn=dn[Vt],Fn=[],qn=0;qn<Rn.length;++qn){var Dr=Rn[qn];Dr?Dr[0]===2?Fn.push('"'+Dr[1].replace(/"/g,'""')+'"'):Fn.push(Dr[1]):Fn.push("")}rn.push(Fn.join(","))}return rn.join(";")})(Y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":Z=me;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":_.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":_.push("#REF!");break;case"PtgList":_.push("Table"+Y[1].idx+"[#"+Y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":default:throw new Error("Unrecognized Formula Token: "+String(Y))}if(g.biff!=3&&0<=Z&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(s[0][me][0])==-1){var wn=!0;switch((Y=s[0][Z])[1][0]){case 4:wn=!1;case 0:G=ho(" ",Y[1][1]);break;case 5:wn=!1;case 1:G=ho("\r",Y[1][1]);break;default:if(G="",g.WTF)throw new Error("Unexpected PtgAttrSpaceType "+Y[1][0])}_.push((wn?G:"")+_.pop()+(wn?"":G)),Z=-1}}if(1<_.length&&g.WTF)throw new Error("bad formula stack");return _[0]}function of(s,v,u){var h=s.l+v,g=Is(s);u.biff==2&&++s.l;var x=(function(S){var T;if(oc(S,S.l+6)!==65535)return[fs(S),"n"];switch(S[S.l]){case 0:return S.l+=8,["String","s"];case 1:return T=S[S.l+2]===1,S.l+=8,[T,"b"];case 2:return T=S[S.l+2],S.l+=8,[T,"e"];case 3:return S.l+=8,["","s"]}return[]})(s),v=s.read_shift(1);return u.biff!=2&&(s.read_shift(1),5<=u.biff&&s.read_shift(4)),u=(function(S,T,k){var _,L=S.l+T,B=k.biff==2?1:2,z=S.read_shift(B);if(z==65535)return[[],vs(S,T-2)];var Z=Rh(S,z,k);return T!==z+B&&(_=ad(S,T-z-B,Z,k)),S.l=L,[Z,_]})(s,h-s.l,u),{cell:g,val:x[0],formula:u,shared:v>>3&1,tt:x[1]}}function Ih(s,c,u,h,g){c=_l(c,u,g),g=(u=s.v)!=null?Ni(typeof u=="number"?u:0):((u=Mt(8)).write_shift(1,3),u.write_shift(1,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,65535),u),u=Mt(6),u.write_shift(2,33),u.write_shift(4,0);for(var x=Mt(s.bf.length),v=0;v<s.bf.length;++v)x[v]=s.bf[v];return ce([c,g,u,x])}function ko(s,c,u){var g=s.read_shift(4),h=Rh(s,g,u),g=s.read_shift(4);return[h,0<g?ad(s,g,h,u):null]}var OS=ko,N0=ko,Nv=ko,Ph=ko,ou={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},M1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jv={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function af(s){return(s=(s=(s=(s=(s=s.slice(0,3)=="of:"?s.slice(3):s).charCodeAt(0)==61&&(s=s.slice(1)).charCodeAt(0)==61?s.slice(1):s).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(c,u){return u.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function zi(s){return s=s.split(":"),[s[0].split(".")[0],s[0].split(".")[1]+(1<s.length?":"+(s[1].split(".")[1]||s[1].split(".")[0]):"")]}var sf={},au={},lf=typeof Map<"u";function Mh(s,c,u){var h=0,g=s.length;if(u){if(lf?u.has(c):Object.prototype.hasOwnProperty.call(u,c)){for(var x=lf?u.get(c):u[c];h<x.length;++h)if(s[x[h]].t===c)return s.Count++,x[h]}}else for(;h<g;++h)if(s[h].t===c)return s.Count++,h;return s[g]={t:c},s.Count++,s.Unique++,u&&(lf?(u.has(c)||u.set(c,[]),u.get(c).push(g)):(Object.prototype.hasOwnProperty.call(u,c)||(u[c]=[]),u[c].push(g))),g}function cf(h,c){var u={min:h+1,max:h+1},h=-1;return c.MDW&&(Ca=c.MDW),c.width!=null?u.customWidth=1:c.wpx!=null?h=eu(c.wpx):c.wch!=null&&(h=c.wch),-1<h?(u.width=td(h),u.customWidth=1):c.width!=null&&(u.width=c.width),c.hidden&&(u.hidden=!0),c.level!=null&&(u.outlineLevel=u.level=c.level),u}function Nl(s,c){s&&(c=c=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],s.left==null&&(s.left=c[0]),s.right==null&&(s.right=c[1]),s.top==null&&(s.top=c[2]),s.bottom==null&&(s.bottom=c[3]),s.header==null&&(s.header=c[4]),s.footer==null&&(s.footer=c[5]))}function vc(s,c,u){if(wh!==void 0){if(/^\d+$/.exec(c.s)||c.s&&c.s==+c.s)return c.s;var h=c.s||{};return c.z&&(h.numFmt=c.z),wh.addStyle(h)}var g=u.revssf[c.z!=null?c.z:"General"],x=60,v=s.length;if(g==null&&u.ssf){for(;x<392;++x)if(u.ssf[x]==null){_t(c.z,x),u.ssf[x]=c.z,u.revssf[c.z]=g=x;break}}for(x=0;x!=v;++x)if(s[x].numFmtId===g)return x;return s[v]={numFmtId:g,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},v}function jl(s,c,u,h,g,x){try{h.cellNF&&(s.z=ae[c])}catch(S){if(h.WTF)throw S}if(s.t!=="z"||h.cellStyles){if(s.t==="d"&&typeof s.v=="string"&&(s.v=Jn(s.v)),(!h||h.cellText!==!1)&&s.t!=="z")try{if(ae[c]==null&&_t(gn[c]||"General",c),s.t==="e")s.w=s.w||al[s.v];else if(c===0)if(s.t==="n")(0|s.v)===s.v?s.w=s.v.toString(10):s.w=mt(s.v);else if(s.t==="d"){var v=En(s.v);s.w=(0|v)===v?v.toString(10):mt(v)}else{if(s.v===void 0)return;s.w=qe(s.v,au)}else s.t==="d"?s.w=Wt(c,En(s.v),au):s.w=Wt(c,s.v,au)}catch(S){if(h.WTF)throw S}if(h.cellStyles&&u!=null)try{s.s=x.Fills[u],s.s.fgColor&&s.s.fgColor.theme&&!s.s.fgColor.rgb&&(s.s.fgColor.rgb=xh(g.themeElements.clrScheme[s.s.fgColor.theme].rgb,s.s.fgColor.tint||0),h.WTF&&(s.s.fgColor.raw_rgb=g.themeElements.clrScheme[s.s.fgColor.theme].rgb)),s.s.bgColor&&s.s.bgColor.theme&&(s.s.bgColor.rgb=xh(g.themeElements.clrScheme[s.s.bgColor.theme].rgb,s.s.bgColor.tint||0),h.WTF&&(s.s.bgColor.raw_rgb=g.themeElements.clrScheme[s.s.bgColor.theme].rgb))}catch(S){if(h.WTF&&x.Fills)throw S}}}var Fa=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_1=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Lv=/<(?:\w:)?hyperlink [^>]*>/gm,ss=/"(\w*:\w*)"/,FS=/<(?:\w:)?col\b[^>]*[\/]?>/g,Bv=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,zv=/<(?:\w:)?pageMargins[^>]*\/>/g,qo=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ys=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,xc=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Uv(s,c,u,h,g,x,v){if(!s)return s;h=h||{"!id":{}};var S=c.dense?[]:{},T={s:{r:2e6,c:2e6},e:{r:0,c:0}},k="",ot="",_=s.match(_1);_?(k=s.slice(0,_.index),ot=s.slice(_.index+_[0].length)):k=ot=s;var L=k.match(qo);L?j0(L[0],0,g,u):(L=k.match(Ys))&&(s=L[0],L[1],L=S,B=g,z=u,j0(s.slice(0,s.indexOf(">")),0,B,z));var B,z,Z=(k.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<Z&&(B=k.slice(Z,Z+50).match(ss))&&(z=S,(me=Ir(me=B[1])).s.r<=me.e.r&&me.s.c<=me.e.c&&0<=me.s.r&&0<=me.s.c&&(z["!ref"]=Tr(me)));var G,me=k.match(xc);me&&me[1]&&(Y=me[1],(G=g).Views||(G.Views=[{}]),(Y.match(L0)||[]).forEach(function(et,dt){et=sr(et),G.Views[dt]||(G.Views[dt]={}),+et.zoomScale&&(G.Views[dt].zoom=+et.zoomScale),Bo(et.rightToLeft)&&(G.Views[dt].RTL=!0)}));var re,Y=[];c.cellStyles&&(re=k.match(FS))&&(function(et,dt){for(var Ot=!1,jt=0;jt!=dt.length;++jt){var bt=sr(dt[jt],!0);bt.hidden&&(bt.hidden=Bo(bt.hidden));var Qt=parseInt(bt.min,10)-1,Tn=parseInt(bt.max,10)-1;for(bt.outlineLevel&&(bt.level=+bt.outlineLevel||0),delete bt.min,delete bt.max,bt.width=+bt.width,!Ot&&bt.width&&(Ot=!0,Ch(bt.width)),tu(bt);Qt<=Tn;)et[Qt++]=qr(bt)}})(Y,re),_&&Cc(_[1],S,c,T,x,v),v=ot.match(Bv),v&&(S["!autofilter"]={ref:(v[0].match(/ref="([^"]*)"/)||[])[1]});var he=[],Ce=ot.match(Fa);if(Ce)for(Z=0;Z!=Ce.length;++Z)he[Z]=Ir(Ce[Z].slice(Ce[Z].indexOf('"')+1));v=ot.match(Lv),v&&(function(et,dt,Ot){for(var jt=Array.isArray(et),bt=0;bt!=dt.length;++bt){var Qt=sr(po(dt[bt]),!0);if(!Qt.ref)return;var Tn=((Ot||{})["!id"]||[])[Qt.id];Tn?(Qt.Target=Tn.Target,Qt.location&&(Qt.Target+="#"+Sr(Qt.location))):(Qt.Target="#"+Sr(Qt.location),Tn={Target:Qt.Target,TargetMode:"Internal"}),Qt.Rel=Tn,Qt.tooltip&&(Qt.Tooltip=Qt.tooltip,delete Qt.tooltip);for(var wn=Ir(Qt.ref),sn=wn.s.r;sn<=wn.e.r;++sn)for(var dn=wn.s.c;dn<=wn.e.c;++dn){var rn=yr({c:dn,r:sn});jt?(et[sn]||(et[sn]=[]),et[sn][dn]||(et[sn][dn]={t:"z",v:void 0}),et[sn][dn].l=Qt):(et[rn]||(et[rn]={t:"z",v:void 0}),et[rn].l=Qt)}}})(S,v,h);var we,$e,ot=ot.match(zv);return ot&&(S["!margins"]=(we=sr(ot[0]),$e={},["left","right","top","bottom","header","footer"].forEach(function(et){we[et]&&($e[et]=parseFloat(we[et]))}),$e)),!S["!ref"]&&T.e.c>=T.s.c&&T.e.r>=T.s.r&&(S["!ref"]=Tr(T)),0<c.sheetRows&&S["!ref"]&&(ot=Ir(S["!ref"]),c.sheetRows<=+ot.e.r&&(ot.e.r=c.sheetRows-1,ot.e.r>T.e.r&&(ot.e.r=T.e.r),ot.e.r<ot.s.r&&(ot.s.r=ot.e.r),ot.e.c>T.e.c&&(ot.e.c=T.e.c),ot.e.c<ot.s.c&&(ot.s.c=ot.e.c),S["!fullref"]=S["!ref"],S["!ref"]=Tr(ot))),0<Y.length&&(S["!cols"]=Y),0<he.length&&(S["!merges"]=he),S}function j0(s,c,u,h){s=sr(s),u.Sheets[h]||(u.Sheets[h]={}),s.codeName&&(u.Sheets[h].CodeName=Sr(po(s.codeName)))}var $v=["objects","scenarios","selectLockedCells","selectUnlockedCells"],NS=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],L0=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,Ms,Ui,O1,_s,F1,Ll,su,Cc=(Ms=/<(?:\w+:)?c[ \/>]/,Ui=/<\/(?:\w+:)?row>/,O1=/r=["']([^"']*)["']/,_s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,F1=/ref=["']([^"']*)["']/,Ll=El("v"),su=El("f"),function(s,c,u,h,g,x){for(var v,S,T,k,_,L,B=0,z="",Z=[],G=[],me=0,re=0,Y="",he=0,Ce=0,we=0,$e=0,ot=Array.isArray(x.CellXf),et=[],dt=[],Ot=Array.isArray(c),jt=[],bt={},Qt=!1,Tn=!!u.sheetStubs,wn=s.split(Ui),sn=0,dn=wn.length;sn!=dn;++sn){var rn=(z=wn[sn].trim()).length;if(rn!==0){var Vt=0;e:for(B=0;B<rn;++B)switch(z[B]){case">":if(z[B-1]!="/"){++B;break e}if(u&&u.cellStyles){if(he=(T=sr(z.slice(Vt,B),!0)).r!=null?parseInt(T.r,10):he+1,Ce=-1,u.sheetRows&&u.sheetRows<he)continue;Qt=!(bt={}),T.ht&&(Qt=!0,bt.hpt=parseFloat(T.ht),bt.hpx=nd(bt.hpt)),T.hidden=="1"&&(Qt=!0,bt.hidden=!0),T.outlineLevel!=null&&(Qt=!0,bt.level=+T.outlineLevel),Qt&&(jt[he-1]=bt)}break;case"<":Vt=B}if(B<=Vt)break;if(he=(T=sr(z.slice(Vt,B),!0)).r!=null?parseInt(T.r,10):he+1,Ce=-1,!(u.sheetRows&&u.sheetRows<he)){h.s.r>he-1&&(h.s.r=he-1),h.e.r<he-1&&(h.e.r=he-1),u&&u.cellStyles&&(Qt=!(bt={}),T.ht&&(Qt=!0,bt.hpt=parseFloat(T.ht),bt.hpx=nd(bt.hpt)),T.hidden=="1"&&(Qt=!0,bt.hidden=!0),T.outlineLevel!=null&&(Qt=!0,bt.level=+T.outlineLevel),Qt&&(jt[he-1]=bt)),Z=z.slice(B).split(Ms);for(var Rn,Fn=0;Fn!=Z.length&&Z[Fn].trim().charAt(0)=="<";++Fn);for(Z=Z.slice(Fn),B=0;B!=Z.length;++B)if((z=Z[B].trim()).length!==0){if(G=z.match(O1),me=B,re=0,z="<c "+(z.slice(0,1)=="<"?">":"")+z,G!=null&&G.length===2){for(me=0,Y=G[1],re=0;re!=Y.length&&!((v=Y.charCodeAt(re)-64)<1||26<v);++re)me=26*me+v;Ce=--me}else++Ce;for(re=0;re!=z.length&&z.charCodeAt(re)!==62;++re);if(++re,(T=sr(z.slice(0,re),!0)).r||(T.r=yr({r:he-1,c:Ce})),S={t:""},(G=(Y=z.slice(re)).match(Ll))!=null&&G[1]!==""&&(S.v=Sr(G[1])),u.cellFormula){(G=Y.match(su))!=null&&G[1]!==""?(S.f=Sr(po(G[1])).replace(/\r\n/g,`
`),u.xlfn||(S.f=A1(S.f)),-1<G[0].indexOf('t="array"')?(S.F=(Y.match(F1)||[])[1],-1<S.F.indexOf(":")&&et.push([Ir(S.F),S.F])):-1<G[0].indexOf('t="shared"')&&(_=sr(G[0]),Rn=Sr(po(G[1])),u.xlfn||(Rn=A1(Rn)),dt[parseInt(_.si,10)]=[_,Rn,T.r])):(G=Y.match(/<f[^>]*\/>/))&&dt[(_=sr(G[0])).si]&&(S.f=(L=dt[_.si][1],An=dt[_.si][2],Rn=T.r,An=Cs(An).s,Rn=ia(Rn),Eh(L,{r:Rn.r-An.r,c:Rn.c-An.c})));for(var qn=ia(T.r),re=0;re<et.length;++re)qn.r>=et[re][0].s.r&&qn.r<=et[re][0].e.r&&qn.c>=et[re][0].s.c&&qn.c<=et[re][0].e.c&&(S.F=et[re][1])}if(T.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else{if(!Tn)continue;S.t="z"}else S.t=T.t||"n";switch(h.s.c>Ce&&(h.s.c=Ce),h.e.c<Ce&&(h.e.c=Ce),S.t){case"n":if(S.v==""||S.v==null){if(!Tn)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(S.v===void 0){if(!Tn)continue;S.t="z"}else k=sf[parseInt(S.v,10)],S.v=k.t,S.r=k.r,u.cellHTML&&(S.h=k.h);break;case"str":S.t="s",S.v=S.v!=null?po(S.v):"",u.cellHTML&&(S.h=Op(S.v));break;case"inlineStr":G=Y.match(_s),S.t="s",G!=null&&(k=mh(G[1]))?(S.v=k.t,u.cellHTML&&(S.h=k.h)):S.v="";break;case"b":S.v=Bo(S.v);break;case"d":u.cellDates?S.v=Jn(S.v,1):(S.v=En(Jn(S.v,1)),S.t="n");break;case"e":u&&u.cellText===!1||(S.w=S.v),S.v=ji[S.v]}var Dr,we=$e=0,An=null;ot&&T.s!==void 0&&(An=x.CellXf[T.s])!=null&&(An.numFmtId!=null&&(we=An.numFmtId),u.cellStyles&&An.fillId!=null&&($e=An.fillId)),jl(S,we,$e,u,g,x),u.cellDates&&ot&&S.t=="n"&&xt(ae[we])&&(S.t="d",S.v=Qn(S.v)),T.cm&&u.xlmeta&&(Dr=(u.xlmeta.Cell||[])[+T.cm-1])&&Dr.type=="XLDAPR"&&(S.D=!0),Ot?(c[(Dr=ia(T.r)).r]||(c[Dr.r]=[]),c[Dr.r][Dr.c]=S):c[T.r]=S}}}}0<jt.length&&(c["!rows"]=jt)});function N1(s,c){for(var u,h,g,x,v=[],S=[],T=Ir(s["!ref"]),k=[],_=0,G=0,L=s["!rows"],B=Array.isArray(s),z={r:""},Z=-1,G=T.s.c;G<=T.e.c;++G)k[G]=Yo(G);for(_=T.s.r;_<=T.e.r;++_){for(S=[],g=sa(_),G=T.s.c;G<=T.e.c;++G){h=k[G]+g;var me=B?(s[_]||[])[G]:s[h];me!==void 0&&(u=(function(re,Y,he,Ce){if(re.c&&he["!comments"].push([Y,re.c]),re.v===void 0&&typeof re.f!="string"||re.t==="z"&&!re.f)return"";var we="",$e=re.t,ot=re.v;if(re.t!=="z")switch(re.t){case"b":we=re.v?"1":"0";break;case"n":we=""+re.v;break;case"e":we=al[re.v];break;case"d":we=Ce&&Ce.cellDates?Jn(re.v,-1).toISOString():((re=qr(re)).t="n",""+(re.v=En(Jn(re.v)))),re.z===void 0&&(re.z=ae[14]);break;default:we=re.v}var et=va("v",co(we)),dt={r:Y},Ot=vc(Ce.cellXfs,re,Ce);switch(Ot!==0&&(dt.s=Ot),re.t){case"n":break;case"d":dt.t="d";break;case"b":dt.t="b";break;case"e":dt.t="e";break;case"z":break;default:if(re.v==null){delete re.t;break}if(32767<re.v.length)throw new Error("Text length must not exceed 32767 characters");if(Ce&&Ce.bookSST){et=va("v",""+Mh(Ce.Strings,re.v,Ce.revStrings)),dt.t="s";break}dt.t="str"}return re.t!=$e&&(re.t=$e,re.v=ot),typeof re.f=="string"&&re.f&&(ot=re.F&&re.F.slice(0,Y.length)==Y?{t:"array",ref:re.F}:null,et=mn("f",co(re.f),ot)+(re.v!=null?et:"")),re.l&&he["!links"].push([Y,re.l]),re.D&&(dt.cm=1),mn("c",et,dt)})(me,h,s,c))!=null&&S.push(u)}(0<S.length||L&&L[_])&&(z={r:g},L&&L[_]&&((x=L[_]).hidden&&(z.hidden=1),Z=-1,x.hpx?Z=ef(x.hpx):x.hpt&&(Z=x.hpt),-1<Z&&(z.ht=Z,z.customHeight=1),x.level&&(z.outlineLevel=x.level)),v[v.length]=mn("row",S.join(""),z))}if(L)for(;_<L.length;++_)L&&L[_]&&(z={r:_+1},(x=L[_]).hidden&&(z.hidden=1),Z=-1,x.hpx?Z=ef(x.hpx):x.hpt&&(Z=x.hpt),-1<Z&&(z.ht=Z,z.customHeight=1),x.level&&(z.outlineLevel=x.level),v[v.length]=mn("row","",z));return v.join("")}function B0(s,c,u,h){var g,x,v=[Ke,mn("worksheet",null,{xmlns:$c[0],"xmlns:r":fa.r})],S=u.SheetNames[s],T=u.Sheets[S],k=(T=T??{})["!ref"]||"A1",_=Ir(k);if(16383<_.e.c||1048575<_.e.r){if(c.WTF)throw new Error("Range "+k+" exceeds format limit A1:XFD1048576");_.e.c=Math.min(_.e.c,16383),_.e.r=Math.min(_.e.c,1048575),k=Tr(_)}h=h||{},T["!comments"]=[];var L,B,z=[];(function(re,Y,he,Ce,we){var $e=!1,ot={},et=null;if(Ce.bookType!=="xlsx"&&Y.vbaraw){var dt=Y.SheetNames[he];try{Y.Workbook&&(dt=Y.Workbook.Sheets[he].CodeName||dt)}catch{}$e=!0,ot.codeName=ks(co(dt))}re&&re["!outline"]&&(Ce={summaryBelow:1,summaryRight:1},re["!outline"].above&&(Ce.summaryBelow=0),re["!outline"].left&&(Ce.summaryRight=0),et=(et||"")+mn("outlinePr",null,Ce)),($e||et)&&(we[we.length]=mn("sheetPr",et,ot))})(T,u,s,c,v),v[v.length]=mn("dimension",null,{ref:k}),v[v.length]=(S={workbookViewId:"0"},((((_=u)||{}).Workbook||{}).Views||[])[0]&&(S.rightToLeft=_.Workbook.Views[0].RTL?"1":"0"),mn("sheetViews",mn("sheetView",null,S),{})),c.sheetFormat&&(v[v.length]=mn("sheetFormatPr",null,{defaultRowHeight:c.sheetFormat.defaultRowHeight||"16",baseColWidth:c.sheetFormat.baseColWidth||"10",outlineLevelRow:c.sheetFormat.outlineLevelRow||"7"})),T["!cols"]!=null&&0<T["!cols"].length&&(v[v.length]=(function(re){for(var Y,he=["<cols>"],Ce=0;Ce!=re.length;++Ce)(Y=re[Ce])&&(he[he.length]=mn("col",null,cf(Ce,Y)));return he[he.length]="</cols>",he.join("")})(T["!cols"])),v[g=v.length]="<sheetData/>",T["!links"]=[],T["!ref"]!=null&&0<(x=N1(T,c)).length&&(v[v.length]=x),v.length>g+1&&(v[v.length]="</sheetData>",v[g]=v[g].replace("/>",">")),T["!protect"]&&(v[v.length]=(L=T["!protect"],B={sheet:1},$v.forEach(function(re){L[re]!=null&&L[re]&&(B[re]="1")}),NS.forEach(function(re){L[re]==null||L[re]||(B[re]="0")}),L.password&&(B.password=x0(L.password).toString(16).toUpperCase()),mn("sheetProtection",null,B))),T["!autofilter"]!=null&&(v[v.length]=(function(re,Y,he,Ce){var we=typeof re.ref=="string"?re.ref:Tr(re.ref);he.Workbook||(he.Workbook={Sheets:[]}),he.Workbook.Names||(he.Workbook.Names=[]);var $e=he.Workbook.Names;(re=Cs(we)).s.r==re.e.r&&(re.e.r=Cs(Y["!ref"]).e.r,we=Tr(re));for(var ot=0;ot<$e.length;++ot){var et=$e[ot];if(et.Name=="_xlnm._FilterDatabase"&&et.Sheet==Ce){et.Ref="'"+he.SheetNames[Ce]+"'!"+we;break}}return ot==$e.length&&$e.push({Name:"_xlnm._FilterDatabase",Sheet:Ce,Ref:"'"+he.SheetNames[Ce]+"'!"+we}),mn("autoFilter",null,{ref:we})})(T["!autofilter"],T,u,s)),T["!merges"]!=null&&0<T["!merges"].length&&(v[v.length]=(function(re){if(re.length===0)return"";for(var Y='<mergeCells count="'+re.length+'">',he=0;he!=re.length;++he)Y+='<mergeCell ref="'+Tr(re[he])+'"/>';return Y+"</mergeCells>"})(T["!merges"]));var Z,G,me=-1;return 0<T["!links"].length&&(v[v.length]="<hyperlinks>",T["!links"].forEach(function(re){re[1].Target&&(G={ref:re[0]},re[1].Target.charAt(0)!="#"&&(me=mo(h,-1,co(re[1].Target).replace(/#.*$/,""),wr.HLINK),G["r:id"]="rId"+me),-1<(Z=re[1].Target.indexOf("#"))&&(G.location=co(re[1].Target.slice(Z+1))),re[1].Tooltip&&(G.tooltip=co(re[1].Tooltip)),v[v.length]=mn("hyperlink",null,G))}),v[v.length]="</hyperlinks>"),delete T["!links"],T["!margins"]!=null&&(v[v.length]=(Nl(u=T["!margins"]),mn("pageMargins",null,u))),c&&!c.ignoreEC&&c.ignoreEC!=null||(v[v.length]=va("ignoredErrors",mn("ignoredError",null,{numberStoredAsText:1,sqref:k}))),0<z.length&&(me=mo(h,-1,"../drawings/drawing"+(s+1)+".xml",wr.DRAW),v[v.length]=mn("drawing",null,{"r:id":"rId"+me}),T["!drawing"]=z),0<T["!comments"].length&&(me=mo(h,-1,"../drawings/vmlDrawing"+(s+1)+".vml",wr.VML),v[v.length]=mn("legacyDrawing",null,{"r:id":"rId"+me}),T["!legacy"]=me),1<v.length&&(v[v.length]="</worksheet>",v[1]=v[1].replace("/>",">")),v.join("")}function hl(s,c,u,h){u=(function(g,x,v){var S=Mt(145),T=(v["!rows"]||[])[g]||{};S.write_shift(4,g),S.write_shift(4,0);var _=320;T.hpx?_=20*ef(T.hpx):T.hpt&&(_=20*T.hpt),S.write_shift(2,_),S.write_shift(1,0),_=0,T.level&&(_|=T.level),T.hidden&&(_|=16),(T.hpx||T.hpt)&&(_|=32),S.write_shift(1,_),S.write_shift(1,0);var k=0,_=S.l;S.l+=4;for(var L={r:g,c:0},B=0;B<16;++B)if(!(x.s.c>B+1<<10||x.e.c<B<<10)){for(var z=-1,Z=-1,G=B<<10;G<B+1<<10;++G)L.c=G,(Array.isArray(v)?(v[L.r]||[])[L.c]:v[yr(L)])&&(z<0&&(z=G),Z=G);z<0||(++k,S.write_shift(4,z),S.write_shift(4,Z))}return g=S.l,S.l=_,S.write_shift(4,k),S.l=g,S.length>S.l?S.slice(0,S.l):S})(h,u,c),(17<u.length||(c["!rows"]||[])[h])&&Ut(s,0,u)}var _h=ol,uf=Vc;function df(s){return[Bu(s),fs(s),"n"]}var Bl=ol,ff=Vc,j1=["left","right","top","bottom","header","footer"];function Hv(s,c,u,h,g,x,v){if(c.v===void 0)return!1;var S="";switch(c.t){case"b":S=c.v?"1":"0";break;case"d":(c=qr(c)).z=c.z||ae[14],c.v=En(Jn(c.v)),c.t="n";break;case"n":case"e":S=""+c.v;break;default:S=c.v}var T,k,_,L,B,z,Z,G,me,re,Y,he,Ce,we,$e,ot,et,dt,Ot,jt,bt={r:u,c:h};switch(bt.s=vc(g.cellXfs,c,g),c.l&&x["!links"].push([yr(bt),c.l]),c.c&&x["!comments"].push([yr(bt),c.c]),c.t){case"s":case"str":return g.bookSST?(S=Mh(g.Strings,c.v,g.revStrings),bt.t="s",bt.v=S,v?Ut(s,18,(zu(et=bt,dt=dt??Mt(8)),dt.write_shift(4,et.v),dt)):Ut(s,7,(Lu(et=bt,ot=ot??Mt(12)),ot.write_shift(4,et.v),ot))):(bt.t="str",v?Ut(s,17,(we=c,zu(bt,$e=$e??Mt(8+4*we.v.length)),Wa(we.v,$e),$e.length>$e.l?$e.slice(0,$e.l):$e)):Ut(s,6,(we=c,Lu(bt,Ce=Ce??Mt(12+4*we.v.length)),Wa(we.v,Ce),Ce.length>Ce.l?Ce.slice(0,Ce.l):Ce))),!0;case"n":return c.v==(0|c.v)&&-1e3<c.v&&c.v<1e3?v?Ut(s,13,(Y=c,zu(bt,he=he??Mt(8)),Uu(Y.v,he),he)):Ut(s,2,(Y=c,Lu(bt,re=re??Mt(12)),Uu(Y.v,re),re)):v?Ut(s,16,(G=c,zu(bt,me=me??Mt(12)),Ni(G.v,me),me)):Ut(s,5,(G=c,Lu(bt,Z=Z??Mt(16)),Ni(G.v,Z),Z)),!0;case"b":return bt.t="b",v?Ut(s,15,(B=c,zu(bt,z=z??Mt(5)),z.write_shift(1,B.v?1:0),z)):Ut(s,4,(B=c,Lu(bt,L=L??Mt(9)),L.write_shift(1,B.v?1:0),L)),!0;case"e":return bt.t="e",v?Ut(s,14,(k=c,zu(bt,_=_??Mt(8)),_.write_shift(1,k.v),_.write_shift(2,0),_.write_shift(1,0),_)):Ut(s,3,(k=c,Lu(bt,T=T??Mt(9)),T.write_shift(1,k.v),T)),!0}return v?Ut(s,12,zu(bt,jt=jt??Mt(4))):Ut(s,1,Lu(bt,Ot=Ot??Mt(8))),!0}function Oh(s,c){var u,h;c&&c["!merges"]&&(Ut(s,177,(u=c["!merges"].length,(h=h??Mt(4)).write_shift(4,u),h)),c["!merges"].forEach(function(g){Ut(s,176,ff(g))}),Ut(s,178))}function Wv(s,c){c&&c["!cols"]&&(Ut(s,390),c["!cols"].forEach(function(u,h){u&&Ut(s,60,(function(g,x,v){v==null&&(v=Mt(18));var S=cf(g,x);return v.write_shift(-4,g),v.write_shift(-4,g),v.write_shift(4,256*(S.width||10)),v.write_shift(4,0),g=0,x.hidden&&(g|=1),typeof S.width=="number"&&(g|=2),x.level&&(g|=x.level<<8),v.write_shift(2,g),v})(h,u))}),Ut(s,391))}function z0(s,c){var u;c&&c["!ref"]&&(Ut(s,648),Ut(s,649,(u=Ir(c["!ref"]),(c=Mt(24)).write_shift(4,4),c.write_shift(4,1),Vc(u,c),c)),Ut(s,650))}function Vv(s,c,u){c["!links"].forEach(function(h){var g,x;h[1].Target&&(g=mo(u,-1,h[1].Target.replace(/#.*$/,""),wr.HLINK),Ut(s,494,(x=g,h=Mt(50+4*((g=h)[1].Target.length+(g[1].Tooltip||"").length)),Vc({s:ia(g[0]),e:ia(g[0])},h),rh("rId"+x,h),Wa(((x=g[1].Target.indexOf("#"))==-1?"":g[1].Target.slice(x+1))||"",h),Wa(g[1].Tooltip||"",h),Wa("",h),h.slice(0,h.l))))}),delete c["!links"]}function jS(s,c,u){Ut(s,133),Ut(s,137,(function(h,g){g==null&&(g=Mt(30));var x=924;return(((h||{}).Views||[])[0]||{}).RTL&&(x|=32),g.write_shift(2,x),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(4,0),g.write_shift(1,0),g.write_shift(1,0),g.write_shift(2,0),g.write_shift(2,100),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(2,0),g.write_shift(4,0),g})(u)),Ut(s,138),Ut(s,134)}function LS(s,c){var u,h;c["!protect"]&&Ut(s,535,(u=c["!protect"],(h=h??Mt(66)).write_shift(2,u.password?x0(u.password):0),h.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(g){g[1]?h.write_shift(4,u[g[0]]==null||u[g[0]]?0:1):h.write_shift(4,u[g[0]]!=null&&u[g[0]]?0:1)}),h))}function uo(s,c,u,h){var g=xs(),k=u.SheetNames[s],x=u.Sheets[k]||{},v=k;try{u&&u.Workbook&&(v=u.Workbook.Sheets[s].CodeName||v)}catch{}var S,T,k=Ir(x["!ref"]||"A1");if(16383<k.e.c||1048575<k.e.r){if(c.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");k.e.c=Math.min(k.e.c,16383),k.e.r=Math.min(k.e.c,1048575)}return x["!links"]=[],x["!comments"]=[],Ut(g,129),(u.vbaraw||x["!outline"])&&Ut(g,147,(function(_,L,B){B==null&&(B=Mt(84+4*_.length));var z=192;L&&(L.above&&(z&=-65),L.left&&(z&=-129)),B.write_shift(1,z);for(var Z=1;Z<3;++Z)B.write_shift(1,0);return sc({auto:1},B),B.write_shift(-4,-1),B.write_shift(-4,-1),Bd(_,B),B.slice(0,B.l)})(v,x["!outline"])),Ut(g,148,uf(k)),jS(g,0,u.Workbook),Wv(g,x),(function(_,L,B){var z,Z=Ir(L["!ref"]||"A1"),G=[];Ut(_,145);var me=Array.isArray(L),re=Z.e.r;L["!rows"]&&(re=Math.max(Z.e.r,L["!rows"].length-1));for(var Y=Z.s.r;Y<=re;++Y){z=sa(Y),hl(_,L,Z,Y);var he=!1;if(Y<=Z.e.r)for(var Ce=Z.s.c;Ce<=Z.e.c;++Ce){Y===Z.s.r&&(G[Ce]=Yo(Ce)),we=G[Ce]+z;var we=me?(L[Y]||[])[Ce]:L[we];we?he=Hv(_,we,Y,Ce,B,L,he):he=!1}}Ut(_,146)})(g,x,c),LS(g,x),(function(_,L,B,z){if(L["!autofilter"]){var me=L["!autofilter"],Z=typeof me.ref=="string"?me.ref:Tr(me.ref);B.Workbook||(B.Workbook={Sheets:[]}),B.Workbook.Names||(B.Workbook.Names=[]);var G=B.Workbook.Names,me=Cs(Z);me.s.r==me.e.r&&(me.e.r=Cs(L["!ref"]).e.r,Z=Tr(me));for(var re=0;re<G.length;++re){var Y=G[re];if(Y.Name=="_xlnm._FilterDatabase"&&Y.Sheet==z){Y.Ref="'"+B.SheetNames[z]+"'!"+Z;break}}re==G.length&&G.push({Name:"_xlnm._FilterDatabase",Sheet:z,Ref:"'"+B.SheetNames[z]+"'!"+Z}),Ut(_,161,Vc(Ir(Z))),Ut(_,162)}})(g,x,u,s),Oh(g,x),Vv(g,x,h),x["!margins"]&&Ut(g,476,(S=x["!margins"],T==null&&(T=Mt(48)),Nl(S),j1.forEach(function(_){Ni(S[_],T)}),T)),c&&!c.ignoreEC&&c.ignoreEC!=null||z0(g,x),k=g,c=s,h=h,0<(x=x)["!comments"].length&&(c=mo(h,-1,"../drawings/vmlDrawing"+(c+1)+".vml",wr.VML),Ut(k,551,rh("rId"+c)),x["!legacy"]=c),Ut(g,130),g.end()}function Oo(s,c,u,h,g,x){var v=x||{"!type":"chart"};if(!s)return x;var S,T=0,k=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(s.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(L){var B=(function(z){var Z,G=[],me=z.match(/^<c:numCache>/);(z.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(Y){Y=Y.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),Y&&(G[+Y[1]]=me?+Y[2]:Y[2])});var re=Sr((z.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(z.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(Y){Z=Y.replace(/<.*?>/g,"")}),[G,re,Z]})(L);_.s.r=_.s.c=0,_.e.c=T,S=Yo(T),B[0].forEach(function(z,Z){v[S+sa(Z)]={t:"n",v:z,z:B[1]},k=Z}),_.e.r<k&&(_.e.r=k),++T}),0<T&&(v["!ref"]=Tr(_)),v}var Nr=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Kr=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Co=[],gi=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Sc(s,c){for(var u=0;u!=s.length;++u)for(var h=s[u],g=0;g!=c.length;++g){var x=c[g];if(h[x[0]]==null)h[x[0]]=x[1];else switch(x[2]){case"bool":typeof h[x[0]]=="string"&&(h[x[0]]=Bo(h[x[0]]));break;case"int":typeof h[x[0]]=="string"&&(h[x[0]]=parseInt(h[x[0]],10))}}}function sd(s,c){for(var u=0;u!=c.length;++u){var h=c[u];if(s[h[0]]==null)s[h[0]]=h[1];else switch(h[2]){case"bool":typeof s[h[0]]=="string"&&(s[h[0]]=Bo(s[h[0]]));break;case"int":typeof s[h[0]]=="string"&&(s[h[0]]=parseInt(s[h[0]],10))}}}function U0(s){sd(s.WBProps,Nr),sd(s.CalcPr,gi),Sc(s.WBView,Kr),Sc(s.Sheets,Co),au.date1904=Bo(s.WBProps.date1904)}var wc="][*?/\\".split("");function la(s,c){if(31<s.length)throw new Error("Sheet names cannot exceed 31 chars");var u=!0;return wc.forEach(function(h){if(s.indexOf(h)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),u}function Tc(s){if(!s||!s.SheetNames||!s.Sheets)throw new Error("Invalid Workbook");if(!s.SheetNames.length)throw new Error("Workbook is empty");var c,u,h,g=s.Workbook&&s.Workbook.Sheets||[];c=s.SheetNames,u=g,h=!!s.vbaraw,c.forEach(function(v,S){la(v);for(var T=0;T<S;++T)if(v==c[T])throw new Error("Duplicate Sheet Name: "+v);if(h){var k=u&&u[S]&&u[S].CodeName||v;if(k.charCodeAt(0)==95&&22<k.length)throw new Error("Bad Code Name: Worksheet"+k)}});for(var x=0;x<s.SheetNames.length;++x)(function(v,S){if(v&&v["!ref"]){var T=Ir(v["!ref"]);if(T.e.c<T.s.c||T.e.r<T.s.r)throw new Error("Bad range ("+S+"): "+v["!ref"])}})(s.Sheets[s.SheetNames[x]],(s.SheetNames[x],x))}var id=/<\w+:workbook/;function $0(s){var c=[Ke];c[c.length]=mn("workbook",null,{xmlns:$c[0],"xmlns:r":fa.r});var u=s.Workbook&&0<(s.Workbook.Names||[]).length,h={codeName:"ThisWorkbook"};s.Workbook&&s.Workbook.WBProps&&(Nr.forEach(function(S){s.Workbook.WBProps[S[0]]!=null&&s.Workbook.WBProps[S[0]]!=S[1]&&(h[S[0]]=s.Workbook.WBProps[S[0]])}),s.Workbook.WBProps.CodeName&&(h.codeName=s.Workbook.WBProps.CodeName,delete h.CodeName)),c[c.length]=mn("workbookPr",null,h);var g=s.Workbook&&s.Workbook.Sheets||[],x=0;if(g&&g[0]&&g[0].Hidden){for(c[c.length]="<bookViews>",x=0;x!=s.SheetNames.length&&g[x]&&g[x].Hidden;++x);x==s.SheetNames.length&&(x=0),c[c.length]='<workbookView firstSheet="'+x+'" activeTab="'+x+'"/>',c[c.length]="</bookViews>"}for(c[c.length]="<sheets>",x=0;x!=s.SheetNames.length;++x){var v={name:co(s.SheetNames[x].slice(0,31))};if(v.sheetId=""+(x+1),v["r:id"]="rId"+(x+1),g[x])switch(g[x].Hidden){case 1:v.state="hidden";break;case 2:v.state="veryHidden"}c[c.length]=mn("sheet",null,v)}return c[c.length]="</sheets>",u&&(c[c.length]="<definedNames>",s.Workbook&&s.Workbook.Names&&s.Workbook.Names.forEach(function(S){var T={name:S.Name};S.Comment&&(T.comment=S.Comment),S.Sheet!=null&&(T.localSheetId=""+S.Sheet),S.Hidden&&(T.hidden="1"),S.Ref&&(c[c.length]=mn("definedName",co(S.Ref),T))}),c[c.length]="</definedNames>"),2<c.length&&(c[c.length]="</workbook>",c[1]=c[1].replace("/>",">")),c.join("")}function yi(s,c){var u={};return s.read_shift(4),u.ArchID=s.read_shift(4),s.l+=c-8,u}function hf(s,c){Ut(s,143);for(var u,h=0;h!=c.SheetNames.length;++h){var g={Hidden:c.Workbook&&c.Workbook.Sheets&&c.Workbook.Sheets[h]&&c.Workbook.Sheets[h].Hidden||0,iTabID:h+1,strRelID:"rId"+(h+1),name:c.SheetNames[h]};Ut(s,156,(u=g,(g=(g=void 0)||Mt(127)).write_shift(4,u.Hidden),g.write_shift(4,u.iTabID),rh(u.strRelID,g),Wa(u.name.slice(0,31),g),g.length>g.l?g.slice(0,g.l):g))}Ut(s,144)}function Fh(s,c){if(c.Workbook&&c.Workbook.Sheets){for(var u,h=c.Workbook.Sheets,g=0,x=-1,v=-1;g<h.length;++g)!h[g]||!h[g].Hidden&&x==-1?x=g:h[g].Hidden==1&&v==-1&&(v=g);x<v||(Ut(s,135),Ut(s,158,(c=x,(u=u||Mt(29)).write_shift(-4,0),u.write_shift(-4,460),u.write_shift(4,28800),u.write_shift(4,17600),u.write_shift(4,500),u.write_shift(4,c),u.write_shift(4,c),u.write_shift(1,120),u.length>u.l?u.slice(0,u.l):u)),Ut(s,136))}}function qs(s,c){var u=xs();return Ut(u,131),Ut(u,128,(function(h){h=h||Mt(127);for(var g=0;g!=4;++g)h.write_shift(4,0);return Wa("SheetJS",h),Wa(o.version,h),Wa(o.version,h),Wa("7262",h),h.length>h.l?h.slice(0,h.l):h})()),Ut(u,153,(function(h,g){g=g||Mt(72);var x=0;return h&&h.filterPrivacy&&(x|=8),g.write_shift(4,x),g.write_shift(4,0),Bd(h&&h.CodeName||"ThisWorkbook",g),g.slice(0,g.l)})(s.Workbook&&s.Workbook.WBProps||null)),Fh(u,s),hf(u,s),Ut(u,132),u.end()}function L1(s,c,u){return(c.slice(-4)===".bin"?function(h,g){var x={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},v=[],S=!1;(g=g||{}).biff=12;var T=[],k=[[]];return k.SheetNames=[],k.XTI=[],ld[16]={n:"BrtFRTArchID$",f:yi},ac(h,function(_,L,B){switch(B){case 156:k.SheetNames.push(_.name),x.Sheets.push(_);break;case 153:x.WBProps=_;break;case 39:_.Sheet!=null&&(g.SID=_.Sheet),_.Ref=ws(_.Ptg,0,null,k,g),delete g.SID,delete _.Ptg,T.push(_);break;case 1036:break;case 357:case 358:case 355:case 667:k[0].length?k.push([B,_]):k[0]=[B,_],k[k.length-1].XTI=[];break;case 362:k.length===0&&(k[0]=[],k[0].XTI=[]),k[k.length-1].XTI=k[k.length-1].XTI.concat(_),k.XTI=k.XTI.concat(_);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:v.push(B),S=!0;break;case 36:v.pop(),S=!1;break;case 37:v.push(B),S=!0;break;case 38:v.pop(),S=!1;break;case 16:break;default:if(!L.T&&(!S||g.WTF&&v[v.length-1]!=37&&v[v.length-1]!=35))throw new Error("Unexpected record 0x"+B.toString(16))}},g),U0(x),x.Names=T,x.supbooks=k,x}:function(h,g){if(!h)throw new Error("Could not find file");var x={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},v=!1,S="xmlns",T={},k=0;if(h.replace($n,function(_,L){var B=sr(_);switch(Gs(B[0])){case"<?xml":break;case"<workbook":_.match(id)&&(S="xmlns"+_.match(/<(\w+):/)[1]),x.xmlns=B[S];break;case"</workbook>":break;case"<fileVersion":delete B[0],x.AppVersion=B;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Nr.forEach(function(z){if(B[z[0]]!=null)switch(z[2]){case"bool":x.WBProps[z[0]]=Bo(B[z[0]]);break;case"int":x.WBProps[z[0]]=parseInt(B[z[0]],10);break;default:x.WBProps[z[0]]=B[z[0]]}}),B.codeName&&(x.WBProps.CodeName=po(B.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete B[0],x.WBView.push(B);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(B.state){case"hidden":B.Hidden=1;break;case"veryHidden":B.Hidden=2;break;default:B.Hidden=0}delete B.state,B.name=Sr(po(B.name)),delete B[0],x.Sheets.push(B);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":v=!0;break;case"</definedNames>":v=!1;break;case"<definedName":(T={}).Name=po(B.name),B.comment&&(T.Comment=B.comment),B.localSheetId&&(T.Sheet=+B.localSheetId),Bo(B.hidden||"0")&&(T.Hidden=!0),k=L+_.length;break;case"</definedName>":T.Ref=Sr(po(h.slice(k,L))),x.Names.push(T);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete B[0],x.CalcPr=B;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":v=!0;break;case"</ext>":v=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":v=!0;break;case"</AlternateContent>":v=!1;break;case"<revisionPtr":break;default:if(!v&&g.WTF)throw new Error("unrecognized "+B[0]+" in workbook")}return _}),$c.indexOf(x.xmlns)===-1)throw new Error("Unknown Namespace: "+x.xmlns);return U0(x),x})(s,u)}function H0(s,c,u,h,g,x,v,S){return(c.slice(-4)===".bin"?function(T,k,_,L,B,z,Z){if(!T)return T;var G=k||{};L=L||{"!id":{}};var me,re,Y,he,Ce,we,$e,ot,et,dt,Ot=G.dense?[]:{},jt={s:{r:2e6,c:2e6},e:{r:0,c:0}},bt=!1,Qt=!1,Tn=[];G.biff=12;var wn=G["!row"]=0,sn=!1,dn=[],rn={},Vt=G.supbooks||B.supbooks||[[]];if(Vt.sharedf=rn,Vt.arrayf=dn,Vt.SheetNames=B.SheetNames||B.Sheets.map(function(Xt){return Xt.name}),!G.supbooks&&(G.supbooks=Vt,B.Names))for(var Rn=0;Rn<B.Names.length;++Rn)Vt[0][Rn+1]=B.Names[Rn];var Fn,qn=[],Dr=[],An=!1;return ld[16]={n:"BrtShortReal",f:df},ac(T,function(Xt,pr,Vr){if(!Qt)switch(Vr){case 148:me=Xt;break;case 0:re=Xt,G.sheetRows&&G.sheetRows<=re.r&&(Qt=!0),et=sa(Ce=re.r),G["!row"]=re.r,(Xt.hidden||Xt.hpt||Xt.level!=null)&&(Xt.hpt&&(Xt.hpx=nd(Xt.hpt)),Dr[Xt.r]=Xt);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(Y={t:Xt[2]},Xt[2]){case"n":Y.v=Xt[1];break;case"s":ot=sf[Xt[1]],Y.v=ot.t,Y.r=ot.r;break;case"b":Y.v=!!Xt[1];break;case"e":Y.v=Xt[1],G.cellText!==!1&&(Y.w=al[Y.v]);break;case"str":Y.t="s",Y.v=Xt[1];break;case"is":Y.t="s",Y.v=Xt[1].t}if((he=Z.CellXf[Xt[0].iStyleRef])&&jl(Y,he.numFmtId,null,G,z,Z),we=Xt[0].c==-1?we+1:Xt[0].c,G.dense?(Ot[Ce]||(Ot[Ce]=[]),Ot[Ce][we]=Y):Ot[Yo(we)+et]=Y,G.cellFormula){for(sn=!1,wn=0;wn<dn.length;++wn){var jr=dn[wn];re.r>=jr[0].s.r&&re.r<=jr[0].e.r&&we>=jr[0].s.c&&we<=jr[0].e.c&&(Y.F=Tr(jr[0]),sn=!0)}!sn&&3<Xt.length&&(Y.f=Xt[3])}jt.s.r>re.r&&(jt.s.r=re.r),jt.s.c>we&&(jt.s.c=we),jt.e.r<re.r&&(jt.e.r=re.r),jt.e.c<we&&(jt.e.c=we),G.cellDates&&he&&Y.t=="n"&&xt(ae[he.numFmtId])&&(so=je(Y.v))&&(Y.t="d",Y.v=new Date(so.y,so.m-1,so.d,so.H,so.M,so.S,so.u)),Fn&&(Fn.type=="XLDAPR"&&(Y.D=!0),Fn=void 0);break;case 1:case 12:if(!G.sheetStubs||bt)break;Y={t:"z",v:void 0},we=Xt[0].c==-1?we+1:Xt[0].c,G.dense?(Ot[Ce]||(Ot[Ce]=[]),Ot[Ce][we]=Y):Ot[Yo(we)+et]=Y,jt.s.r>re.r&&(jt.s.r=re.r),jt.s.c>we&&(jt.s.c=we),jt.e.r<re.r&&(jt.e.r=re.r),jt.e.c<we&&(jt.e.c=we),Fn&&(Fn.type=="XLDAPR"&&(Y.D=!0),Fn=void 0);break;case 176:Tn.push(Xt);break;case 49:Fn=((G.xlmeta||{}).Cell||[])[Xt-1];break;case 494:var so=L["!id"][Xt.relId];for(so?(Xt.Target=so.Target,Xt.loc&&(Xt.Target+="#"+Xt.loc),Xt.Rel=so):Xt.relId==""&&(Xt.Target="#"+Xt.loc),Ce=Xt.rfx.s.r;Ce<=Xt.rfx.e.r;++Ce)for(we=Xt.rfx.s.c;we<=Xt.rfx.e.c;++we)G.dense?(Ot[Ce]||(Ot[Ce]=[]),Ot[Ce][we]||(Ot[Ce][we]={t:"z",v:void 0}),Ot[Ce][we].l=Xt):($e=yr({c:we,r:Ce}),Ot[$e]||(Ot[$e]={t:"z",v:void 0}),Ot[$e].l=Xt);break;case 426:if(!G.cellFormula)break;dn.push(Xt),(dt=G.dense?Ot[Ce][we]:Ot[Yo(we)+et]).f=ws(Xt[1],0,{r:re.r,c:we},Vt,G),dt.F=Tr(Xt[0]);break;case 427:if(!G.cellFormula)break;rn[yr(Xt[0].s)]=Xt[1],(dt=G.dense?Ot[Ce][we]:Ot[Yo(we)+et]).f=ws(Xt[1],0,{r:re.r,c:we},Vt,G);break;case 60:if(!G.cellStyles)break;for(;Xt.e>=Xt.s;)qn[Xt.e--]={width:Xt.w/256,hidden:!!(1&Xt.flags),level:Xt.level},An||(An=!0,Ch(Xt.w/256)),tu(qn[Xt.e+1]);break;case 161:Ot["!autofilter"]={ref:Tr(Xt)};break;case 476:Ot["!margins"]=Xt;break;case 147:B.Sheets[_]||(B.Sheets[_]={}),Xt.name&&(B.Sheets[_].CodeName=Xt.name),(Xt.above||Xt.left)&&(Ot["!outline"]={above:Xt.above,left:Xt.left});break;case 137:B.Views||(B.Views=[{}]),B.Views[0]||(B.Views[0]={}),Xt.RTL&&(B.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:bt=!0;break;case 36:bt=!1;break;case 37:bt=!0;break;case 38:bt=!1;break;default:if(!pr.T&&(!bt||G.WTF))throw new Error("Unexpected record 0x"+Vr.toString(16))}},G),delete G.supbooks,delete G["!row"],!Ot["!ref"]&&(jt.s.r<2e6||me&&(0<me.e.r||0<me.e.c||0<me.s.r||0<me.s.c))&&(Ot["!ref"]=Tr(me||jt)),G.sheetRows&&Ot["!ref"]&&(T=Ir(Ot["!ref"]),G.sheetRows<=+T.e.r&&(T.e.r=G.sheetRows-1,T.e.r>jt.e.r&&(T.e.r=jt.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>jt.e.c&&(T.e.c=jt.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),Ot["!fullref"]=Ot["!ref"],Ot["!ref"]=Tr(T))),0<Tn.length&&(Ot["!merges"]=Tn),0<qn.length&&(Ot["!cols"]=qn),0<Dr.length&&(Ot["!rows"]=Dr),Ot}:Uv)(s,h,u,g,x,v,S)}function Gv(s,c,u,h,g,x){return c.slice(-4)===".bin"?(function(v,S,T,k,_){if(!v)return v;k=k||{"!id":{}};var L={"!type":"chart","!drawel":null,"!rel":""},B=!1;return ac(v,function(z,Z,G){switch(G){case 550:L["!rel"]=z;break;case 651:_.Sheets[T]||(_.Sheets[T]={}),z.name&&(_.Sheets[T].CodeName=z.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:B=!0;break;case 36:B=!1;break;case 37:break;case 38:break;default:if(!(0<Z.T)){if(!(Z.T<0)){if(!B||S.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}}},S),k["!id"][L["!rel"]]&&(L["!drawel"]=k["!id"][L["!rel"]]),L})(s,h,u,g,x):(function(v,S,T,k){if(!v)return v;T=T||{"!id":{}};var _={"!type":"chart","!drawel":null,"!rel":""},L=v.match(qo);return L&&j0(L[0],0,k,S),(v=v.match(/drawing r:id="(.*?)"/))&&(_["!rel"]=v[1]),T["!id"][_["!rel"]]&&(_["!drawel"]=T["!id"][_["!rel"]]),_})(s,u,g,x)}function W0(s,c,u,h){return(c.slice(-4)===".bin"?function(g,x,v){var S,T={NumberFmt:[]};for(S in ae)T.NumberFmt[S]=ae[S];T.CellXf=[],T.Fonts=[];var k=[],_=!1;return ac(g,function(L,B,z){switch(z){case 44:T.NumberFmt[L[0]]=L[1],_t(L[1],L[0]);break;case 43:T.Fonts.push(L),L.color.theme!=null&&x&&x.themeElements&&x.themeElements.clrScheme&&(L.color.rgb=xh(x.themeElements.clrScheme[L.color.theme].rgb,L.color.tint||0));break;case 1025:case 45:case 46:break;case 47:k[k.length-1]==617&&T.CellXf.push(L);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:_=!0;break;case 36:_=!1;break;case 37:k.push(z),_=!0;break;case 38:k.pop(),_=!1;break;default:if(0<B.T)k.push(z);else if(B.T<0)k.pop();else if(!_||v.WTF&&k[k.length-1]!=37)throw new Error("Unexpected record 0x"+z.toString(16))}}),T}:p1)(s,u,h)}function V0(s,c,u){return c.slice(-4)===".bin"?(h=u,x=!(g=[]),ac(s,function(v,S,T){switch(T){case 159:g.Count=v[0],g.Unique=v[1];break;case 19:g.push(v);break;case 160:return 1;case 35:x=!0;break;case 36:x=!1;break;default:if(S.T,!x||h.WTF)throw new Error("Unexpected record 0x"+T.toString(16))}}),g):(function(v,S){var T=[],k="";if(!v)return T;if(v=v.match(Ps)){k=v[2].replace(xa,"").split(v0);for(var _=0;_!=k.length;++_){var L=mh(k[_].trim(),S);L!=null&&(T[T.length]=L)}v=sr(v[1]),T.Count=v.count,T.Unique=v.uniqueCount}return T})(s,u);var h,g,x}function iu(s,c,u){return c.slice(-4)===".bin"?(h=u,g=[],x=[],S=!(v={}),ac(s,function(T,k,_){switch(_){case 632:x.push(T);break;case 635:v=T;break;case 637:v.t=T.t,v.h=T.h,v.r=T.r;break;case 636:if(v.author=x[v.iauthor],delete v.iauthor,h.sheetRows&&v.rfx&&h.sheetRows<=v.rfx.r)break;v.t||(v.t=""),delete v.rfx,g.push(v);break;case 3072:break;case 35:S=!0;break;case 36:S=!1;break;case 37:case 38:break;default:if(!k.T&&(!S||h.WTF))throw new Error("Unexpected record 0x"+_.toString(16))}}),g):(function(T,k){if(T.match(/<(?:\w+:)?comments *\/>/))return[];var _=[],L=[],B=T.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return B&&B[1]&&B[1].split(/<\/\w*:?author>/).forEach(function(z){z===""||z.trim()===""||(z=z.match(/<(?:\w+:)?author[^>]*>(.*)/))&&_.push(z[1])}),(T=T.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&T[1]&&T[1].split(/<\/\w*:?comment>/).forEach(function(z){var Z,G;z===""||z.trim()===""||(Z=z.match(/<(?:\w+:)?comment[^>]*>/))&&(Z={author:(G=sr(Z[0])).authorId&&_[G.authorId]||"sheetjsghost",ref:G.ref,guid:G.guid},G=ia(G.ref),k.sheetRows&&k.sheetRows<=G.r||(z=!!(z=z.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!z[1]&&mh(z[1])||{r:"",t:"",h:""},Z.r=z.r,z.r=="<t></t>"&&(z.t=z.h=""),Z.t=(z.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),k.cellHTML&&(Z.h=z.h),L.push(Z)))}),L})(s,u);var h,g,x,v,S}function Ga(s,c){return c.slice(-4)===".bin"?(u=[],ac(s,function(h,g,x){if(x===63)u.push(h);else if(!g.T)throw new Error("Unexpected record 0x"+x.toString(16))}),u):(function(h){var g=[];if(!h)return g;var x=1;return(h.match($n)||[]).forEach(function(v){var S=sr(v);switch(S[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete S[0],S.i?x=S.i:S.i=x,g.push(S)}}),g})(s);var u}function lu(s,c,u,h){if(u.slice(-4)===".bin")return(function(g,x){if(!g)return g;var v=x||{},S=!1;ac(g,function(T,k,_){switch(_){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:S=!0;break;case 36:S=!1;break;default:if(!k.T&&(!S||v.WTF))throw new Error("Unexpected record 0x"+_.toString(16))}},v)})(s,h)}function pf(s,c,u){return c.slice(-4)===".bin"?(h={Types:[],Cell:[],Value:[]},g=u||{},v=!(x=[]),S=2,ac(s,function(T,k,_){switch(_){case 335:h.Types.push({name:T.name});break;case 51:T.forEach(function(L){S==1?h.Cell.push({type:h.Types[L[0]-1].name,index:L[1]}):S==0&&h.Value.push({type:h.Types[L[0]-1].name,index:L[1]})});break;case 337:S=T?1:0;break;case 338:S=2;break;case 35:x.push(_),v=!0;break;case 36:x.pop(),v=!1;break;default:if(!k.T&&(!v||g.WTF&&x[x.length-1]!=35))throw new Error("Unexpected record 0x"+_.toString(16))}}),h):(function(T,k){var _={Types:[],Cell:[],Value:[]};if(!T)return _;var L,B=!1,z=2;return T.replace($n,function(Z){var G=sr(Z);switch(Gs(G[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":_.Types.push({name:G.name});break;case"</metadataType>":break;case"<futureMetadata":for(var me=0;me<_.Types.length;++me)_.Types[me].name==G.name&&(L=_.Types[me]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":z==1?_.Cell.push({type:_.Types[G.t-1].name,index:+G.v}):z==0&&_.Value.push({type:_.Types[G.t-1].name,index:+G.v});break;case"</rc>":break;case"<cellMetadata":z=1;break;case"</cellMetadata>":z=2;break;case"<valueMetadata":z=0;break;case"</valueMetadata>":z=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":B=!0;break;case"</ext>":B=!1;break;case"<rvb":if(!L)break;L.offsets||(L.offsets=[]),L.offsets.push(+G.i);break;default:if(!B&&k.WTF)throw new Error("unrecognized "+G[0]+" in metadata")}return Z}),_})(s,u);var h,g,x,v,S}var bi,G0=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,K0=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $i(s,c){var u=s.split(/\s+/),h=[];if(h[0]=u[0],u.length===1)return h;var g,x,v,S=s.match(G0);if(S)for(v=0;v!=S.length;++v)(x=(g=S[v].match(K0))[1].indexOf(":"))===-1?h[g[1]]=g[2].slice(1,g[2].length-1):h[g[1].slice(0,6)==="xmlns:"?"xmlns"+g[1].slice(6):g[1].slice(x+1)]=g[2].slice(1,g[2].length-1);return h}function Nh(s,c,u){if(s.t!=="z"){if(!u||u.cellText!==!1)try{s.t==="e"?s.w=s.w||al[s.v]:c==="General"?s.t==="n"?(0|s.v)===s.v?s.w=s.v.toString(10):s.w=mt(s.v):s.w=qe(s.v):s.w=(h=c||"General",g=s.v,(h=bi[h]||Sr(h))==="General"?qe(g):Wt(h,g))}catch(v){if(u.WTF)throw v}var h,g;try{var x=bi[c]||c||"General";u.cellNF&&(s.z=x),u.cellDates&&s.t=="n"&&xt(x)&&(x=je(s.v))&&(s.t="d",s.v=new Date(x.y,x.m-1,x.d,x.H,x.M,x.S,x.u))}catch(v){if(u.WTF)throw v}}}function jh(s,c){var u=c||{};Et();var h,g=F(Np(s)),x=(g=u.type=="binary"||u.type=="array"||u.type=="base64"?n!==void 0?n.utils.decode(65001,I(g)):po(g):g).slice(0,1024).toLowerCase(),v=!1;if((1023&(x=x.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&x.indexOf(","),1023&x.indexOf(";"))){var S=qr(u);return S.type="string",mc.to_workbook(g,S)}if(x.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ue){0<=x.indexOf("<"+Ue)&&(v=!0)}),v)return(function(Ue,Gt){if(Ue=Ue.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!Ue||Ue.length==0)throw new Error("Invalid HTML: could not find <table>");if(Ue.length==1)return rl(Uh(Ue[0],Gt),Gt);var ft=ry();return Ue.forEach(function(St,ut){hm(ft,Uh(St,Gt),"Sheet"+(ut+1))}),ft})(g,u);bi={"General Number":"General","General Date":ae[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ae[15],"Short Date":ae[14],"Long Time":ae[19],"Medium Time":ae[18],"Short Time":ae[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ae[2],Standard:ae[4],Percent:ae[10],Scientific:ae[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var T,k=[],_,L={},B=[],z=u.dense?[]:{},Z="",G={},me={},re=$i('<Data ss:Type="String">'),Y=0,he=0,Ce=0,we={s:{r:2e6,c:2e6},e:{r:0,c:0}},$e={},ot={},et="",dt=0,Ot=[],jt={},bt={},Qt=0,Tn=[],wn=[],sn={},dn=[],rn=!1,Vt=[],Rn=[],Fn={},qn=0,Dr=0,An={Sheets:[],WBProps:{date1904:!1}},Xt={};Uc.lastIndex=0,g=g.replace(/<!--([\s\S]*?)-->/gm,"");for(var pr,Vr,jr,so,oa="";h=Uc.exec(g);)switch(h[3]=(oa=h[3]).toLowerCase()){case"data":if(oa=="data"){if(h[1]==="/"){if((T=k.pop())[0]!==h[3])throw new Error("Bad state: "+T.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break}if(k[k.length-1][1])break;h[1]==="/"?(function(Ue,Gt,ft,St,ut,Rt,Jt,Mn,Pn,xn){var _n="General",Hn=St.StyleID,zn={};xn=xn||{};var fn=[],nn=0;for((Hn=Hn===void 0&&Mn?Mn.StyleID:Hn)===void 0&&Jt&&(Hn=Jt.StyleID);Rt[Hn]!==void 0&&(Rt[Hn].nf&&(_n=Rt[Hn].nf),Rt[Hn].Interior&&fn.push(Rt[Hn].Interior),Rt[Hn].Parent);)Hn=Rt[Hn].Parent;switch(ft.Type){case"Boolean":St.t="b",St.v=Bo(Ue);break;case"String":St.t="s",St.r=Ub(Sr(Ue)),St.v=-1<Ue.indexOf("<")?Sr(Gt||Ue).replace(/<.*?>/g,""):St.r;break;case"DateTime":Ue.slice(-1)!="Z"&&(Ue+="Z"),St.v=(Jn(Ue)-new Date(Date.UTC(1899,11,30)))/864e5,St.v!=St.v?St.v=Sr(Ue):St.v<60&&(St.v=St.v-1),_n&&_n!="General"||(_n="yyyy-mm-dd");case"Number":St.v===void 0&&(St.v=+Ue),St.t||(St.t="n");break;case"Error":St.t="e",St.v=ji[Ue],xn.cellText!==!1&&(St.w=Ue);break;default:Ue==""&&Gt==""?St.t="z":(St.t="s",St.v=Ub(Gt||Ue))}if(Nh(St,_n,xn),xn.cellFormula!==!1)if(St.Formula)ft=Sr(St.Formula),ft.charCodeAt(0)==61&&(ft=ft.slice(1)),St.f=rd(ft,ut),delete St.Formula,St.ArrayRange=="RC"?St.F=rd("RC:RC",ut):St.ArrayRange&&(St.F=rd(St.ArrayRange,ut),Pn.push([Ir(St.F),St.F]));else for(nn=0;nn<Pn.length;++nn)ut.r>=Pn[nn][0].s.r&&ut.r<=Pn[nn][0].e.r&&ut.c>=Pn[nn][0].s.c&&ut.c<=Pn[nn][0].e.c&&(St.F=Pn[nn][1]);xn.cellStyles&&(fn.forEach(function(Vn){!zn.patternType&&Vn.patternType&&(zn.patternType=Vn.patternType)}),St.s=zn),St.StyleID!==void 0&&(St.ixfe=St.StyleID)})(g.slice(Y,h.index),et,re,k[k.length-1][0]=="comment"?sn:G,{c:he,r:Ce},$e,dn[he],me,Vt,u):(et="",re=$i(h[0]),Y=h.index+h[0].length);break;case"cell":if(h[1]==="/")if(0<wn.length&&(G.c=wn),(!u.sheetRows||u.sheetRows>Ce)&&G.v!==void 0&&(u.dense?(z[Ce]||(z[Ce]=[]),z[Ce][he]=G):z[Yo(he)+sa(Ce)]=G),G.HRef&&(G.l={Target:Sr(G.HRef)},G.HRefScreenTip&&(G.l.Tooltip=G.HRefScreenTip),delete G.HRef,delete G.HRefScreenTip),(G.MergeAcross||G.MergeDown)&&(qn=he+(0|parseInt(G.MergeAcross,10)),Dr=Ce+(0|parseInt(G.MergeDown,10)),Ot.push({s:{c:he,r:Ce},e:{c:qn,r:Dr}})),u.sheetStubs)if(G.MergeAcross||G.MergeDown){for(var Ye=he;Ye<=qn;++Ye)for(var io=Ce;io<=Dr;++io)(he<Ye||Ce<io)&&(u.dense?(z[io]||(z[io]=[]),z[io][Ye]={t:"z"}):z[Yo(Ye)+sa(io)]={t:"z"});he=qn+1}else++he;else G.MergeAcross?he=qn+1:++he;else(he=(G=(function(Ue){var Gt={};if(Ue.split(/\s+/).length===1)return Gt;var ft,St,ut,Rt=Ue.match(G0);if(Rt)for(ut=0;ut!=Rt.length;++ut)(St=(ft=Rt[ut].match(K0))[1].indexOf(":"))===-1?Gt[ft[1]]=ft[2].slice(1,ft[2].length-1):Gt[ft[1].slice(0,6)==="xmlns:"?"xmlns"+ft[1].slice(6):ft[1].slice(St+1)]=ft[2].slice(1,ft[2].length-1);return Gt})(h[0])).Index?+G.Index-1:he)<we.s.c&&(we.s.c=he),he>we.e.c&&(we.e.c=he),h[0].slice(-2)==="/>"&&++he,wn=[];break;case"row":h[1]==="/"||h[0].slice(-2)==="/>"?(Ce<we.s.r&&(we.s.r=Ce),Ce>we.e.r&&(we.e.r=Ce),h[0].slice(-2)==="/>"&&(me=$i(h[0])).Index&&(Ce=+me.Index-1),he=0,++Ce):((me=$i(h[0])).Index&&(Ce=+me.Index-1),Fn={},me.AutoFitHeight!="0"&&!me.Height||(Fn.hpx=parseInt(me.Height,10),Fn.hpt=ef(Fn.hpx),Rn[Ce]=Fn),me.Hidden=="1"&&(Fn.hidden=!0,Rn[Ce]=Fn));break;case"worksheet":if(h[1]==="/"){if((T=k.pop())[0]!==h[3])throw new Error("Bad state: "+T.join("|"));B.push(Z),we.s.r<=we.e.r&&we.s.c<=we.e.c&&(z["!ref"]=Tr(we),u.sheetRows&&u.sheetRows<=we.e.r&&(z["!fullref"]=z["!ref"],we.e.r=u.sheetRows-1,z["!ref"]=Tr(we))),Ot.length&&(z["!merges"]=Ot),0<dn.length&&(z["!cols"]=dn),0<Rn.length&&(z["!rows"]=Rn),L[Z]=z}else we={s:{r:2e6,c:2e6},e:{r:0,c:0}},Ce=he=0,k.push([h[3],!1]),T=$i(h[0]),Z=Sr(T.Name),z=u.dense?[]:{},Ot=[],Vt=[],Rn=[],Xt={name:Z,Hidden:0},An.Sheets.push(Xt);break;case"table":if(h[1]==="/"){if((T=k.pop())[0]!==h[3])throw new Error("Bad state: "+T.join("|"))}else{if(h[0].slice(-2)=="/>")break;k.push([h[3],!1]),rn=!(dn=[])}break;case"style":h[1]==="/"?(Vr=$e,jr=ot,(so=u).cellStyles&&(!jr.Interior||(so=jr.Interior).Pattern&&(so.patternType=yv[so.Pattern]||so.Pattern)),Vr[jr.ID]=jr):ot=$i(h[0]);break;case"numberformat":ot.nf=Sr($i(h[0]).Format||"General"),bi[ot.nf]&&(ot.nf=bi[ot.nf]);for(var Qr=0;Qr!=392&&ae[Qr]!=ot.nf;++Qr);if(Qr==392){for(Qr=57;Qr!=392;++Qr)if(ae[Qr]==null){_t(ot.nf,Qr);break}}break;case"column":if(k[k.length-1][0]!=="table")break;if((_=$i(h[0])).Hidden&&(_.hidden=!0,delete _.Hidden),_.Width&&(_.wpx=parseInt(_.Width,10)),!rn&&10<_.wpx){rn=!0,Ca=l1;for(var Ka=0;Ka<dn.length;++Ka)dn[Ka]&&tu(dn[Ka])}rn&&tu(_),dn[_.Index-1||dn.length]=_;for(var Wi=0;Wi<+_.Span;++Wi)dn[dn.length]=qr(_);break;case"namedrange":if(h[1]==="/")break;An.Names||(An.Names=[]);var De=sr(h[0]),vt={Name:De.Name,Ref:rd(De.RefersTo.slice(1),{r:0,c:0})};0<An.Sheets.length&&(vt.Sheet=An.Sheets.length-1),An.Names.push(vt);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(h[0].slice(-2)==="/>")break;h[1]==="/"?et+=g.slice(dt,h.index):dt=h.index+h[0].length;break;case"interior":if(!u.cellStyles)break;ot.Interior=$i(h[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(h[0].slice(-2)==="/>")break;h[1]==="/"?(jr=jt,De=oa,vt=g.slice(Qt,h.index),jr[De=(Wu=Wu||en(Yc))[De]||De]=vt):Qt=h.index+h[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(h[1]==="/"){if((T=k.pop())[0]!==h[3])throw new Error("Bad state: "+T.join("|"))}else k.push([h[3],!1]);break;case"comment":if(h[1]==="/"){if((T=k.pop())[0]!==h[3])throw new Error("Bad state: "+T.join("|"));(pr=sn).t=pr.v||"",pr.t=pr.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),pr.v=pr.w=pr.ixfe=void 0,wn.push(sn)}else k.push([h[3],!1]),sn={a:(T=$i(h[0])).Author};break;case"autofilter":if(h[1]==="/"){if((T=k.pop())[0]!==h[3])throw new Error("Bad state: "+T.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&(pr=$i(h[0]),z["!autofilter"]={ref:rd(pr.Range).replace(/\$/g,"")},k.push([h[3],!0]));break;case"name":break;case"datavalidation":if(h[1]==="/"){if((T=k.pop())[0]!==h[3])throw new Error("Bad state: "+T.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(h[1]==="/"){if((T=k.pop())[0]!==h[3])throw new Error("Bad state: "+T.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&k.push([h[3],!0]);break;case"null":break;default:if(k.length==0&&h[3]=="document"||k.length==0&&h[3]=="uof")return J0(g,u);var He=!0;switch(k[k.length-1][0]){case"officedocumentsettings":switch(h[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(h[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(h[3]){case"date1904":An.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(h[3]){case"owcversion":case"height":case"width":break;default:He=!1}break;case"worksheetoptions":switch(h[3]){case"visible":if(h[0].slice(-2)!=="/>")if(h[1]==="/")switch(g.slice(Qt,h.index)){case"SheetHidden":Xt.Hidden=1;break;case"SheetVeryHidden":Xt.Hidden=2}else Qt=h.index+h[0].length;break;case"header":z["!margins"]||Nl(z["!margins"]={},"xlml"),isNaN(+sr(h[0]).Margin)||(z["!margins"].header=+sr(h[0]).Margin);break;case"footer":z["!margins"]||Nl(z["!margins"]={},"xlml"),isNaN(+sr(h[0]).Margin)||(z["!margins"].footer=+sr(h[0]).Margin);break;case"pagemargins":var yt=sr(h[0]);z["!margins"]||Nl(z["!margins"]={},"xlml"),isNaN(+yt.Top)||(z["!margins"].top=+yt.Top),isNaN(+yt.Left)||(z["!margins"].left=+yt.Left),isNaN(+yt.Right)||(z["!margins"].right=+yt.Right),isNaN(+yt.Bottom)||(z["!margins"].bottom=+yt.Bottom);break;case"displayrighttoleft":An.Views||(An.Views=[]),An.Views[0]||(An.Views[0]={}),An.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":z["!outline"]||(z["!outline"]={}),z["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":z["!outline"]||(z["!outline"]={}),z["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(h[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:He=!1}break;case"pagebreaks":switch(h[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:He=!1}break;case"autofilter":switch(h[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:He=!1}break;case"querytable":switch(h[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(h[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1}if(He||h[3].match(/!\[CDATA/))break;if(!k[k.length-1][1])throw"Unrecognized tag: "+h[3]+"|"+k.join("|");if(k[k.length-1][0]==="customdocumentproperties"){if(h[0].slice(-2)==="/>")break;h[1]==="/"?(function(Ue,Gt,ft,St){var ut=St;switch((ft[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":ut=Bo(St);break;case"i2":case"int":ut=parseInt(St,10);break;case"r4":case"float":ut=parseFloat(St);break;case"date":case"dateTime.tz":ut=Jn(St);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+ft[0])}Ue[Sr(Gt)]=ut})(bt,oa,Tn,g.slice(Qt,h.index)):Qt=(Tn=h).index+h[0].length;break}if(u.WTF)throw"Unrecognized tag: "+h[3]+"|"+k.join("|")}return S={},u.bookSheets||u.bookProps||(S.Sheets=L),S.SheetNames=B,S.Workbook=An,S.SSF=qr(ae),S.Props=jt,S.Custprops=bt,S}function Os(s,c){switch(Y1(c=c||{}),c.type||"base64"){case"base64":return jh(K(s),c);case"binary":case"buffer":case"file":return jh(s,c);case"array":return jh(oe(s),c)}}function Kv(s,c){var u,h,g,x,v,S,T,k=[];return s.Props&&k.push((u=s.Props,h=c,g=[],Bt(Yc).map(function(_){for(var L=0;L<ea.length;++L)if(ea[L][1]==_)return ea[L];for(L=0;L<ci.length;++L)if(ci[L][1]==_)return ci[L];throw _}).forEach(function(_){var L;u[_[1]]!=null&&(L=(h&&h.Props&&h.Props[_[1]]!=null?h.Props:u)[_[1]],typeof(L=_[2]==="date"?new Date(L).toISOString().replace(/\.\d*Z/,"Z"):L)=="number"?L=String(L):L===!0||L===!1?L=L?"1":"0":L instanceof Date&&(L=new Date(L).toISOString().replace(/\.\d*Z/,"")),g.push(va(Yc[_[1]]||_[1],L)))}),mn("DocumentProperties",g.join(""),{xmlns:zo.o}))),s.Custprops&&k.push((x=s.Props,v=s.Custprops,S=["Worksheets","SheetNames"],s="CustomDocumentProperties",T=[],x&&Bt(x).forEach(function(_){if(Object.prototype.hasOwnProperty.call(x,_)){for(var L=0;L<ea.length;++L)if(_==ea[L][1])return;for(L=0;L<ci.length;++L)if(_==ci[L][1])return;for(L=0;L<S.length;++L)if(_==S[L])return;var B="string",z=typeof(z=x[_])=="number"?(B="float",String(z)):z===!0||z===!1?(B="boolean",z?"1":"0"):String(z);T.push(mn(Ou(_),z,{"dt:dt":B}))}}),v&&Bt(v).forEach(function(_){var L,B;Object.prototype.hasOwnProperty.call(v,_)&&(x&&Object.prototype.hasOwnProperty.call(x,_)||(L="string",B=typeof(B=v[_])=="number"?(L="float",String(B)):B===!0||B===!1?(L="boolean",B?"1":"0"):B instanceof Date?(L="dateTime.tz",B.toISOString()):String(B),T.push(mn(Ou(_),B,{"dt:dt":L}))))}),"<"+s+' xmlns="'+zo.o+'">'+T.join("")+"</"+s+">")),k.join("")}function Fs(s){return mn("NamedRange",null,{"ss:Name":s.Name,"ss:RefersTo":"="+P0(s.Ref,{r:0,c:0})})}function Yv(s,c,u,h,g,x,v){if(!s||s.v==null&&s.f==null)return"";var S={};if(s.f&&(S["ss:Formula"]="="+co(P0(s.f,v))),s.F&&s.F.slice(0,c.length)==c&&(c=ia(s.F.slice(c.length+1)),S["ss:ArrayRange"]="RC:R"+(c.r==v.r?"":"["+(c.r-v.r)+"]")+"C"+(c.c==v.c?"":"["+(c.c-v.c)+"]")),s.l&&s.l.Target&&(S["ss:HRef"]=co(s.l.Target),s.l.Tooltip&&(S["x:HRefScreenTip"]=co(s.l.Tooltip))),u["!merges"])for(var T=u["!merges"],k=0;k!=T.length;++k)T[k].s.c==v.c&&T[k].s.r==v.r&&(T[k].e.c>T[k].s.c&&(S["ss:MergeAcross"]=T[k].e.c-T[k].s.c),T[k].e.r>T[k].s.r&&(S["ss:MergeDown"]=T[k].e.r-T[k].s.r));var _="",L="";switch(s.t){case"z":if(!h.sheetStubs)return"";break;case"n":_="Number",L=String(s.v);break;case"b":_="Boolean",L=s.v?"1":"0";break;case"e":_="Error",L=al[s.v];break;case"d":_="DateTime",L=new Date(s.v).toISOString(),s.z==null&&(s.z=s.z||ae[14]);break;case"s":_="String",L=((s.v||"")+"").replace(qf,function(B){return Sg[B]}).replace(wg,function(B){return"&#x"+B.charCodeAt(0).toString(16).toUpperCase()+";"})}return u=vc(h.cellXfs,s,h),S["ss:StyleID"]="s"+(21+u),S["ss:Index"]=v.c+1,u=s.v!=null?L:"",u=s.t=="z"?"":'<Data ss:Type="'+_+'">'+u+"</Data>",0<(s.c||[]).length&&(u+=s.c.map(function(B){var z=mn("ss:Data",(B.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return mn("Comment",z,{"ss:Author":B.a})}).join("")),mn("Cell",u,S)}function qv(s,c){if(!s["!ref"])return"";var u=Ir(s["!ref"]),h=s["!merges"]||[],g=0,x=[];s["!cols"]&&s["!cols"].forEach(function(me,Ce){tu(me);var Y=!!me.width,he=cf(Ce,me),Ce={"ss:Index":Ce+1};Y&&(Ce["ss:Width"]=Zd(he.width)),me.hidden&&(Ce["ss:Hidden"]="1"),x.push(mn("Column",null,Ce))});for(var v,S,T=Array.isArray(s),k=u.s.r;k<=u.e.r;++k){for(var _=[(v=k,S=(s["!rows"]||[])[k],v='<Row ss:Index="'+(v+1)+'"',S&&(S.hpt&&!S.hpx&&(S.hpx=nd(S.hpt)),S.hpx&&(v+=' ss:AutoFitHeight="0" ss:Height="'+S.hpx+'"'),S.hidden&&(v+=' ss:Hidden="1"')),v+">")],L=u.s.c;L<=u.e.c;++L){for(var B,z,Z,G=!1,g=0;g!=h.length;++g)if(!(h[g].s.c>L||h[g].s.r>k||h[g].e.c<L||h[g].e.r<k)){h[g].s.c==L&&h[g].s.r==k||(G=!0);break}G||(z=yr(B={r:k,c:L}),Z=T?(s[k]||[])[L]:s[z],_.push(Yv(Z,z,s,c,0,0,B)))}_.push("</Row>"),2<_.length&&x.push(_.join(""))}return x.join("")}function BS(s,c,u){var h=[],x=u.SheetNames[s],g=u.Sheets[x],x=g?(function(v,S,T){if(!v||!((T||{}).Workbook||{}).Names)return"";for(var k=T.Workbook.Names,_=[],L=0;L<k.length;++L){var B=k[L];B.Sheet==S&&(B.Name.match(/^_xlfn\./)||_.push(Fs(B)))}return _.join("")})(g,s,u):"";return 0<x.length&&h.push("<Names>"+x+"</Names>"),0<(x=g?qv(g,c):"").length&&h.push("<Table>"+x+"</Table>"),h.push((function(v,S,T){if(!v)return"";var k=[];if(v["!margins"]&&(k.push("<PageSetup>"),v["!margins"].header&&k.push(mn("Header",null,{"x:Margin":v["!margins"].header})),v["!margins"].footer&&k.push(mn("Footer",null,{"x:Margin":v["!margins"].footer})),k.push(mn("PageMargins",null,{"x:Bottom":v["!margins"].bottom||"0.75","x:Left":v["!margins"].left||"0.7","x:Right":v["!margins"].right||"0.7","x:Top":v["!margins"].top||"0.75"})),k.push("</PageSetup>")),T&&T.Workbook&&T.Workbook.Sheets&&T.Workbook.Sheets[S])if(T.Workbook.Sheets[S].Hidden)k.push(mn("Visible",T.Workbook.Sheets[S].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var _=0;_<S&&(!T.Workbook.Sheets[_]||T.Workbook.Sheets[_].Hidden);++_);_==S&&k.push("<Selected/>")}return((((T||{}).Workbook||{}).Views||[])[0]||{}).RTL&&k.push("<DisplayRightToLeft/>"),v["!protect"]&&(k.push(va("ProtectContents","True")),v["!protect"].objects&&k.push(va("ProtectObjects","True")),v["!protect"].scenarios&&k.push(va("ProtectScenarios","True")),v["!protect"].selectLockedCells==null||v["!protect"].selectLockedCells?v["!protect"].selectUnlockedCells==null||v["!protect"].selectUnlockedCells||k.push(va("EnableSelection","UnlockedCells")):k.push(va("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(L){v["!protect"][L[0]]&&k.push("<"+L[1]+"/>")})),k.length==0?"":mn("WorksheetOptions",k.join(""),{xmlns:zo.x})})(g,s,u)),h.join("")}function cu(s,c){c=c||{},s.SSF||(s.SSF=qr(ae)),s.SSF&&(Et(),at(s.SSF),c.revssf=un(s.SSF),c.revssf[s.SSF[65535]]=0,c.ssf=s.SSF,c.cellXfs=[],vc(c.cellXfs,{},{revssf:{General:0}}));var u=[];u.push(Kv(s,c)),u.push(""),u.push(""),u.push("");for(var h,g=0;g<s.SheetNames.length;++g)u.push(mn("Worksheet",BS(g,c,s),{"ss:Name":co(s.SheetNames[g])}));return u[2]=(h=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],c.cellXfs.forEach(function(x,v){var S=[];S.push(mn("NumberFormat",null,{"ss:Format":co(ae[x.numFmtId])})),v={"ss:ID":"s"+(21+v)},h.push(mn("Style",S.join(""),v))}),mn("Styles",h.join(""))),u[3]=(function(x){if(!((x||{}).Workbook||{}).Names)return"";for(var v=x.Workbook.Names,S=[],T=0;T<v.length;++T){var k=v[T];k.Sheet==null&&(k.Name.match(/^_xlfn\./)||S.push(Fs(k)))}return mn("Names",S.join(""))})(s),Ke+mn("Workbook",u.join(""),{xmlns:zo.ss,"xmlns:o":zo.o,"xmlns:x":zo.x,"xmlns:ss":zo.ss,"xmlns:dt":zo.dt,"xmlns:html":zo.html})}function Y0(s){var c={},u=s.content;return u.l=28,c.AnsiUserType=u.read_shift(0,"lpstr-ansi"),c.AnsiClipboardFormat=qp(u,1),u.length-u.l<=4?c:(s=u.read_shift(4),s==0||40<s?c:(u.l-=4,c.Reserved1=u.read_shift(0,"lpstr-ansi"),u.length-u.l<=4||(s=u.read_shift(4))!==1907505652?c:(c.UnicodeClipboardFormat=qp(u,2),(s=u.read_shift(4))==0||40<s?c:(u.l-=4,void(c.Reserved2=u.read_shift(0,"lpwstr"))))))}var B1=[60,1084,2066,2165,2175];function Ns(s,c,u){if(s.t!=="z"&&s.XF){var h,g=0;try{g=s.z||s.XF.numFmtId||0,c.cellNF&&(s.z=ae[g])}catch(x){if(c.WTF)throw x}if(!c||c.cellText!==!1)try{s.t==="e"?s.w=s.w||al[s.v]:g===0||g=="General"?s.t==="n"?(0|s.v)===s.v?s.w=s.v.toString(10):s.w=mt(s.v):s.w=qe(s.v):s.w=Wt(g,s.v,{date1904:!!u,dateNF:c&&c.dateNF})}catch(x){if(c.WTF)throw x}c.cellDates&&g&&s.t=="n"&&xt(ae[g]||String(g))&&(h=je(s.v))&&(s.t="d",s.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}}function Lh(s,c,u){return{v:s,ixfe:c,t:u}}function Qv(s,c){var u={opts:{}},h={};function g(ut){return!(ut<8)&&ut<64&&$e[ut-8]||zd[ut]}function x(ut,Rt,Jt){if(!(1<rn||Jt.sheetRows&&ut.r>=Jt.sheetRows)){var Mn,Pn,xn;if(Jt.cellStyles&&Rt.XF&&Rt.XF.data&&(Pn=Jt,(xn=(Mn=Rt).XF.data)&&xn.patternType&&Pn&&Pn.cellStyles&&(Mn.s={},Mn.s.patternType=xn.patternType,(Pn=Jd(g(xn.icvFore)))&&(Mn.s.fgColor={rgb:Pn}),(Pn=Jd(g(xn.icvBack)))&&(Mn.s.bgColor={rgb:Pn}))),delete Rt.ixfe,delete Rt.XF,Y=yr(v=ut),z&&z.s&&z.e||(z={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<z.s.r&&(z.s.r=ut.r),ut.c<z.s.c&&(z.s.c=ut.c),ut.r+1>z.e.r&&(z.e.r=ut.r+1),ut.c+1>z.e.c&&(z.e.c=ut.c+1),Jt.cellFormula&&Rt.f){for(var _n=0;_n<Ce.length;++_n)if(!(Ce[_n][0].s.c>ut.c||Ce[_n][0].s.r>ut.r||Ce[_n][0].e.c<ut.c||Ce[_n][0].e.r<ut.r)){Rt.F=Tr(Ce[_n][0]),Ce[_n][0].s.c==ut.c&&Ce[_n][0].s.r==ut.r||delete Rt.f,Rt.f&&(Rt.f=""+ws(Ce[_n][1],0,ut,wn,dt));break}}Jt.dense?(L[ut.r]||(L[ut.r]=[]),L[ut.r][ut.c]=Rt):L[Y]=Rt}}var v,S,T,k,_,L=c.dense?[]:{},B={},z={},Z=null,G=[],me="",re={},Y="",he={},Ce=[],we=[],$e=[],ot={Sheets:[],WBProps:{date1904:!1},Views:[{}]},et={},dt={enc:!1,sbcch:0,snames:[],sharedf:he,arrayf:Ce,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!c&&!!c.cellStyles,WTF:!!c&&!!c.wtf};c.password&&(dt.password=c.password);var Ot=[],jt=[],bt=[],Qt=[],Tn=!1,wn=[];wn.SheetNames=dt.snames,wn.sharedf=dt.sharedf,wn.arrayf=dt.arrayf,wn.names=[],wn.XTI=[];var sn,dn=0,rn=0,Vt=0,Rn=[],Fn=[];dt.codepage=1200,A(1200);for(var qn=!1;s.l<s.length-1;){var Dr=s.l,An=s.read_shift(2);if(An===0&&dn===10)break;var Xt=s.l===s.length?0:s.read_shift(2),pr=z1[An];if(pr&&pr.f){if(c.bookSheets&&dn===133&&An!==133)break;if(dn=An,pr.r===2||pr.r==12){var Vr=s.read_shift(2);if(Xt-=2,!dt.enc&&Vr!==An&&((255&Vr)<<8|Vr>>8)!==An)throw new Error("rt mismatch: "+Vr+"!="+An);pr.r==12&&(s.l+=10,Xt-=10)}var jr,so,oa,Ye={},Ye=An===10?pr.f(s,Xt,dt):(function(ut,Rt,Jt,Mn,Pn){var xn=Mn,_n=[],Hn=Jt.slice(Jt.l,Jt.l+xn);if(Pn&&Pn.enc&&Pn.enc.insitu&&0<Hn.length)switch(ut){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:Pn.enc.insitu(Hn)}_n.push(Hn),Jt.l+=xn;for(var zn=oc(Jt,Jt.l),fn=z1[zn],nn=0;fn!=null&&-1<B1.indexOf(zn);)xn=oc(Jt,Jt.l+2),nn=Jt.l+4,zn==2066?nn+=4:zn!=2165&&zn!=2175||(nn+=12),Hn=Jt.slice(nn,Jt.l+4+xn),_n.push(Hn),Jt.l+=4+xn,fn=z1[zn=oc(Jt,Jt.l)];var Vn=ce(_n);ds(Vn,0);var kn=0;Vn.lens=[];for(var on=0;on<_n.length;++on)Vn.lens.push(kn),kn+=_n[on].length;if(Vn.length<Mn)throw"XLS Record 0x"+ut.toString(16)+" Truncated: "+Vn.length+" < "+Mn;return Rt.f(Vn,Vn.length,Pn)})(An,pr,s,Xt,dt);if(rn!=0||[9,521,1033,2057].indexOf(dn)!==-1)switch(An){case 34:u.opts.Date1904=ot.WBProps.date1904=Ye;break;case 134:u.opts.WriteProtect=!0;break;case 47:if(dt.enc||(s.l=0),dt.enc=Ye,!c.password)throw new Error("File is password-protected");if(Ye.valid==null)throw new Error("Encryption scheme unsupported");if(!Ye.valid)throw new Error("Password is incorrect");break;case 92:dt.lastuser=Ye;break;case 66:var io=Number(Ye);switch(io){case 21010:io=1200;break;case 32768:io=1e4;break;case 32769:io=1252}A(dt.codepage=io),qn=!0;break;case 317:dt.rrtabid=Ye;break;case 25:dt.winlocked=Ye;break;case 439:u.opts.RefreshAll=Ye;break;case 12:u.opts.CalcCount=Ye;break;case 16:u.opts.CalcDelta=Ye;break;case 17:u.opts.CalcIter=Ye;break;case 13:u.opts.CalcMode=Ye;break;case 14:u.opts.CalcPrecision=Ye;break;case 95:u.opts.CalcSaveRecalc=Ye;break;case 15:dt.CalcRefMode=Ye;break;case 2211:u.opts.FullCalc=Ye;break;case 129:Ye.fDialog&&(L["!type"]="dialog"),Ye.fBelow||((L["!outline"]||(L["!outline"]={})).above=!0),Ye.fRight||((L["!outline"]||(L["!outline"]={})).left=!0);break;case 224:we.push(Ye);break;case 430:wn.push([Ye]),wn[wn.length-1].XTI=[];break;case 35:case 547:wn[wn.length-1].push(Ye);break;case 24:case 536:sn={Name:Ye.Name,Ref:ws(Ye.rgce,0,null,wn,dt)},0<Ye.itab&&(sn.Sheet=Ye.itab-1),wn.names.push(sn),wn[0]||(wn[0]=[],wn[0].XTI=[]),wn[wn.length-1].push(Ye),Ye.Name=="_xlnm._FilterDatabase"&&0<Ye.itab&&Ye.rgce&&Ye.rgce[0]&&Ye.rgce[0][0]&&Ye.rgce[0][0][0]=="PtgArea3d"&&(Fn[Ye.itab-1]={ref:Tr(Ye.rgce[0][0][1][2])});break;case 22:dt.ExternCount=Ye;break;case 23:wn.length==0&&(wn[0]=[],wn[0].XTI=[]),wn[wn.length-1].XTI=wn[wn.length-1].XTI.concat(Ye),wn.XTI=wn.XTI.concat(Ye);break;case 2196:if(dt.biff<8)break;sn!=null&&(sn.Comment=Ye[1]);break;case 18:L["!protect"]=Ye;break;case 19:Ye!==0&&dt.WTF&&console.error("Password verifier: "+Ye);break;case 133:B[Ye.pos]=Ye,dt.snames.push(Ye.name);break;case 10:if(--rn)break;z.e&&(0<z.e.r&&0<z.e.c&&(z.e.r--,z.e.c--,L["!ref"]=Tr(z),c.sheetRows&&c.sheetRows<=z.e.r&&(Qr=z.e.r,z.e.r=c.sheetRows-1,L["!fullref"]=L["!ref"],L["!ref"]=Tr(z),z.e.r=Qr),z.e.r++,z.e.c++),0<Ot.length&&(L["!merges"]=Ot),0<jt.length&&(L["!objects"]=jt),0<bt.length&&(L["!cols"]=bt),0<Qt.length&&(L["!rows"]=Qt),ot.Sheets.push(et)),me===""?re=L:h[me]=L,L=c.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(dt.biff===8&&(dt.biff={9:2,521:3,1033:4}[An]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Ye.BIFFVer]||8),dt.biffguess=Ye.BIFFVer==0,Ye.BIFFVer==0&&Ye.dt==4096&&(dt.biff=5,qn=!0,A(dt.codepage=28591)),dt.biff==8&&Ye.BIFFVer==0&&Ye.dt==16&&(dt.biff=2),rn++)break;var Qr,L=c.dense?[]:{};dt.biff<8&&!qn&&(qn=!0,A(dt.codepage=c.codepage||1252)),dt.biff<5||Ye.BIFFVer==0&&Ye.dt==4096?(me===""&&(me="Sheet1"),z={s:{r:0,c:0},e:{r:0,c:0}},Qr={pos:s.l-Xt,name:me},B[Qr.pos]=Qr,dt.snames.push(me)):me=(B[Dr]||{name:""}).name,Ye.dt==32&&(L["!type"]="chart"),Ye.dt==64&&(L["!type"]="macro"),Ot=[],jt=[],dt.arrayf=Ce=[],bt=[],Tn=!(Qt=[]),et={Hidden:(B[Dr]||{hs:0}).hs,name:me};break;case 515:case 3:case 2:L["!type"]=="chart"&&(c.dense?(L[Ye.r]||[])[Ye.c]:L[yr({c:Ye.c,r:Ye.r})])&&++Ye.c,De={ixfe:Ye.ixfe,XF:we[Ye.ixfe]||{},v:Ye.val,t:"n"},0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x({c:Ye.c,r:Ye.r},De,c);break;case 5:case 517:De={ixfe:Ye.ixfe,XF:we[Ye.ixfe],v:Ye.val,t:Ye.t},0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x({c:Ye.c,r:Ye.r},De,c);break;case 638:De={ixfe:Ye.ixfe,XF:we[Ye.ixfe],v:Ye.rknum,t:"n"},0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x({c:Ye.c,r:Ye.r},De,c);break;case 189:for(var Ka=Ye.c;Ka<=Ye.C;++Ka){var Wi=Ye.rkrec[Ka-Ye.c][0],De={ixfe:Wi,XF:we[Wi],v:Ye.rkrec[Ka-Ye.c][1],t:"n"};0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x({c:Ka,r:Ye.r},De,c)}break;case 6:case 518:case 1030:if(Ye.val=="String"){Z=Ye;break}(De=Lh(Ye.val,Ye.cell.ixfe,Ye.tt)).XF=we[De.ixfe],c.cellFormula&&(!((vt=Ye.formula)&&vt[0]&&vt[0][0]&&vt[0][0][0]=="PtgExp")||he[oa=yr({r:jr=vt[0][0][1][0],c:so=vt[0][0][1][1]})]?De.f=""+ws(Ye.formula,0,Ye.cell,wn,dt):De.F=((c.dense?(L[jr]||[])[so]:L[oa])||{}).F),0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x(Ye.cell,De,c),Z=Ye;break;case 7:case 519:if(!Z)throw new Error("String record expects Formula");(De=Lh(Z.val=Ye,Z.cell.ixfe,"s")).XF=we[De.ixfe],c.cellFormula&&(De.f=""+ws(Z.formula,0,Z.cell,wn,dt)),0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x(Z.cell,De,c),Z=null;break;case 33:case 545:Ce.push(Ye);var vt=yr(Ye[0].s),He=c.dense?(L[Ye[0].s.r]||[])[Ye[0].s.c]:L[vt];if(c.cellFormula&&He){if(!Z||!vt||!He)break;He.f=""+ws(Ye[1],0,Ye[0],wn,dt),He.F=Tr(Ye[0])}break;case 1212:if(!c.cellFormula)break;if(Y){if(!Z)break;he[yr(Z.cell)]=Ye[0],((He=c.dense?(L[Z.cell.r]||[])[Z.cell.c]:L[yr(Z.cell)])||{}).f=""+ws(Ye[0],0,v,wn,dt)}break;case 253:De=Lh(G[Ye.isst].t,Ye.ixfe,"s"),G[Ye.isst].h&&(De.h=G[Ye.isst].h),De.XF=we[De.ixfe],0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x({c:Ye.c,r:Ye.r},De,c);break;case 513:c.sheetStubs&&(De={ixfe:Ye.ixfe,XF:we[Ye.ixfe],t:"z"},0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x({c:Ye.c,r:Ye.r},De,c));break;case 190:if(c.sheetStubs)for(var yt=Ye.c;yt<=Ye.C;++yt){var Ue=Ye.ixfe[yt-Ye.c];De={ixfe:Ue,XF:we[Ue],t:"z"},0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x({c:yt,r:Ye.r},De,c)}break;case 214:case 516:case 4:(De=Lh(Ye.val,Ye.ixfe,"s")).XF=we[De.ixfe],0<Vt&&(De.z=Rn[De.ixfe>>8&63]),Ns(De,c,u.opts.Date1904),x({c:Ye.c,r:Ye.r},De,c);break;case 0:case 512:rn===1&&(z=Ye);break;case 252:G=Ye;break;case 1054:if(dt.biff==4){Rn[Vt++]=Ye[1];for(var Gt=0;Gt<Vt+163&&ae[Gt]!=Ye[1];++Gt);163<=Gt&&_t(Ye[1],Vt+163)}else _t(Ye[1],Ye[0]);break;case 30:Rn[Vt++]=Ye;for(var ft=0;ft<Vt+163&&ae[ft]!=Ye;++ft);163<=ft&&_t(Ye,Vt+163);break;case 229:Ot=Ot.concat(Ye);break;case 93:jt[Ye.cmo[0]]=dt.lastobj=Ye;break;case 438:dt.lastobj.TxO=Ye;break;case 127:dt.lastobj.ImData=Ye;break;case 440:for(T=Ye[0].s.r;T<=Ye[0].e.r;++T)for(S=Ye[0].s.c;S<=Ye[0].e.c;++S)(He=c.dense?(L[T]||[])[S]:L[yr({c:S,r:T})])&&(He.l=Ye[1]);break;case 2048:for(T=Ye[0].s.r;T<=Ye[0].e.r;++T)for(S=Ye[0].s.c;S<=Ye[0].e.c;++S)(He=c.dense?(L[T]||[])[S]:L[yr({c:S,r:T})])&&He.l&&(He.l.Tooltip=Ye[1]);break;case 28:if(dt.biff<=5&&2<=dt.biff)break;He=c.dense?(L[Ye[0].r]||[])[Ye[0].c]:L[yr(Ye[0])];var St=jt[Ye[2]];He||(He=c.dense?(L[Ye[0].r]||(L[Ye[0].r]=[]),L[Ye[0].r][Ye[0].c]={t:"z"}):L[yr(Ye[0])]={t:"z"},z.e.r=Math.max(z.e.r,Ye[0].r),z.s.r=Math.min(z.s.r,Ye[0].r),z.e.c=Math.max(z.e.c,Ye[0].c),z.s.c=Math.min(z.s.c,Ye[0].c)),He.c||(He.c=[]),St={a:Ye[1],t:St.TxO.t},He.c.push(St);break;case 2173:we[Ye.ixfe],Ye.ext.forEach(function(Rt){Rt[0]});break;case 125:if(!dt.cellStyles)break;for(;Ye.e>=Ye.s;)bt[Ye.e--]={width:Ye.w/256,level:Ye.level||0,hidden:!!(1&Ye.flags)},Tn||(Tn=!0,Ch(Ye.w/256)),tu(bt[Ye.e+1]);break;case 520:St={},Ye.level!=null&&((Qt[Ye.r]=St).level=Ye.level),Ye.hidden&&((Qt[Ye.r]=St).hidden=!0),Ye.hpt&&((Qt[Ye.r]=St).hpt=Ye.hpt,St.hpx=nd(Ye.hpt));break;case 38:case 39:case 40:case 41:L["!margins"]||Nl(L["!margins"]={}),L["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[An]]=Ye;break;case 161:L["!margins"]||Nl(L["!margins"]={}),L["!margins"].header=Ye.header,L["!margins"].footer=Ye.footer;break;case 574:Ye.RTL&&(ot.Views[0].RTL=!0);break;case 146:$e=Ye;break;case 2198:_=Ye;break;case 140:k=Ye;break;case 442:me?et.CodeName=Ye||et.name:ot.WBProps.CodeName=Ye||"ThisWorkbook"}}else pr||console.error("Missing Info for XLS Record 0x"+An.toString(16)),s.l+=Xt}return u.SheetNames=Bt(B).sort(function(ut,Rt){return Number(ut)-Number(Rt)}).map(function(ut){return B[ut].name}),c.bookSheets||(u.Sheets=h),!u.SheetNames.length&&re["!ref"]?(u.SheetNames.push("Sheet1"),u.Sheets&&(u.Sheets.Sheet1=re)):u.Preamble=re,u.Sheets&&Fn.forEach(function(ut,Rt){u.Sheets[u.SheetNames[Rt]]["!autofilter"]=ut}),u.Strings=G,u.SSF=qr(ae),dt.enc&&(u.Encryption=dt.enc),_&&(u.Themes=_),u.Metadata={},k!==void 0&&(u.Metadata.Country=k),0<wn.names.length&&(ot.Names=wn.names),u.Workbook=ot,u}var mf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Bh(s,c){var u,h,g,x,v;if(Y1(c=c||{}),R(),c.codepage&&w(c.codepage),s.FullPaths){if($t.find(s,"/encryption"))throw new Error("File is password-protected");u=$t.find(s,"!CompObj"),g=$t.find(s,"/Workbook")||$t.find(s,"/Book")}else{switch(c.type){case"base64":s=de(K(s));break;case"binary":s=de(s);break;case"buffer":break;case"array":Array.isArray(s)||(s=Array.prototype.slice.call(s))}ds(s,0),g={content:s}}if(u&&Y0(u),c.bookProps&&!c.bookSheets)h={};else{var S=W?"buffer":"array";if(g&&g.content)h=Qv(g.content,c);else if((g=$t.find(s,"PerfectOffice_MAIN"))&&g.content)h=Va.to_workbook(g.content,(c.type=S,c));else{if(!(g=$t.find(s,"NativeContent_MAIN"))||!g.content)throw(g=$t.find(s,"MN0"))&&g.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");h=Va.to_workbook(g.content,(c.type=S,c))}c.bookVBA&&s.FullPaths&&$t.find(s,"/_VBA_PROJECT_CUR/VBA/dir")&&(h.vbaraw=(x=s,v=$t.utils.cfb_new({root:"R"}),x.FullPaths.forEach(function(T,k){T.slice(-1)!=="/"&&T.match(/_VBA_PROJECT_CUR/)&&(T=T.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),$t.utils.cfb_add(v,T,x.FileIndex[k].content))}),$t.write(v)))}return S={},s.FullPaths&&(function(T,k,_){var L=$t.find(T,"/!DocumentSummaryInformation");if(L&&0<L.size)try{var B,z=Uo(L,Lg,mf.DSI);for(B in z)k[B]=z[B]}catch(re){if(_.WTF)throw re}var Z=$t.find(T,"/!SummaryInformation");if(Z&&0<Z.size)try{var G,me=Uo(Z,Bg,mf.SI);for(G in me)k[G]==null&&(k[G]=me[G])}catch(re){if(_.WTF)throw re}k.HeadingPairs&&k.TitlesOfParts&&(Ug(k.HeadingPairs,k.TitlesOfParts,k,_),delete k.HeadingPairs,delete k.TitlesOfParts)})(s,S,c),h.Props=h.Custprops=S,c.bookFiles&&(h.cfb=s),h}function q0(s,x){var u,h,g=x||{},x=$t.utils.cfb_new({root:"R"}),v="/Workbook";switch(g.bookType||"xls"){case"xls":g.bookType="biff8";case"xla":g.bookType||(g.bookType="xla");case"biff8":v="/Workbook",g.biff=8;break;case"biff5":v="/Book",g.biff=5;break;default:throw new Error("invalid type "+g.bookType+" for XLS CFB")}return $t.utils.cfb_add(x,v,U1(s,g)),g.biff==8&&(s.Props||s.Custprops)&&(function(S,T){var k,_=[],L=[],B=[],z=0,Z=gr(Lg,"n"),G=gr(Bg,"n");if(S.Props)for(k=Bt(S.Props),z=0;z<k.length;++z)(Object.prototype.hasOwnProperty.call(Z,k[z])?_:Object.prototype.hasOwnProperty.call(G,k[z])?L:B).push([k[z],S.Props[k[z]]]);if(S.Custprops)for(k=Bt(S.Custprops),z=0;z<k.length;++z)Object.prototype.hasOwnProperty.call(S.Props||{},k[z])||(Object.prototype.hasOwnProperty.call(Z,k[z])?_:Object.prototype.hasOwnProperty.call(G,k[z])?L:B).push([k[z],S.Custprops[k[z]]]);for(var me=[],z=0;z<B.length;++z)-1<$g.indexOf(B[z][0])||-1<e0.indexOf(B[z][0])||B[z][1]!=null&&me.push(B[z]);L.length&&$t.utils.cfb_add(T,"/SummaryInformation",Gr(L,mf.SI,G,Bg)),(_.length||me.length)&&$t.utils.cfb_add(T,"/DocumentSummaryInformation",Gr(_,mf.DSI,Z,Lg,me.length?me:null,mf.UDI))})(s,x),g.biff==8&&s.vbaraw&&(u=x,(h=$t.read(s.vbaraw,{type:typeof s.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(S,T){T==0||(S=S.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&$t.utils.cfb_add(u,S,h.FileIndex[T].content)})),x}var ld={0:{f:function(s,c){var u={},h=s.l+c;u.r=s.read_shift(4),s.l+=4;var g=s.read_shift(2);return s.l+=1,c=s.read_shift(1),s.l=h,7&c&&(u.level=7&c),16&c&&(u.hidden=!0),32&c&&(u.hpt=g/20),u}},1:{f:function(s){return[Fi(s)]}},2:{f:function(s){return[Fi(s),Fg(s),"n"]}},3:{f:function(s){return[Fi(s),s.read_shift(1),"e"]}},4:{f:function(s){return[Fi(s),s.read_shift(1),"b"]}},5:{f:function(s){return[Fi(s),fs(s),"n"]}},6:{f:function(s){return[Fi(s),rs(s),"str"]}},7:{f:function(s){return[Fi(s),s.read_shift(4),"s"]}},8:{f:function(s,c,u){var h=s.l+c,g=Fi(s);g.r=u["!row"];var x=[g,rs(s),"str"];return u.cellFormula?(s.l+=2,c=N0(s,h-s.l,u),x[3]=ws(c,0,g,u.supbooks,u)):s.l=h,x}},9:{f:function(s,c,u){var h=s.l+c,g=Fi(s);g.r=u["!row"];var x=[g,fs(s),"n"];return u.cellFormula?(s.l+=2,c=N0(s,h-s.l,u),x[3]=ws(c,0,g,u.supbooks,u)):s.l=h,x}},10:{f:function(s,c,u){var h=s.l+c,g=Fi(s);g.r=u["!row"];var x=[g,s.read_shift(1),"b"];return u.cellFormula?(s.l+=2,c=N0(s,h-s.l,u),x[3]=ws(c,0,g,u.supbooks,u)):s.l=h,x}},11:{f:function(s,c,u){var h=s.l+c,g=Fi(s);g.r=u["!row"];var x=[g,s.read_shift(1),"e"];return u.cellFormula?(s.l+=2,c=N0(s,h-s.l,u),x[3]=ws(c,0,g,u.supbooks,u)):s.l=h,x}},12:{f:function(s){return[Bu(s)]}},13:{f:function(s){return[Bu(s),Fg(s),"n"]}},14:{f:function(s){return[Bu(s),s.read_shift(1),"e"]}},15:{f:function(s){return[Bu(s),s.read_shift(1),"b"]}},16:{f:df},17:{f:function(s){return[Bu(s),rs(s),"str"]}},18:{f:function(s){return[Bu(s),s.read_shift(4),"s"]}},19:{f:Vp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(s,v,S){var h=s.l+v;s.l+=4,s.l+=1;var g=s.read_shift(4),x=Xb(s),v=Nv(s,0,S),S=Gp(s);return s.l=h,v={Name:x,Ptg:v},g<268435455&&(v.Sheet=g),S&&(v.Comment=S),v}},40:{},42:{},43:{f:function(s,c,u){var h={};h.sz=s.read_shift(2)/20;var g,x=(x=(g=s).read_shift(1),g.l++,{fBold:1&x,fItalic:2&x,fUnderline:4&x,fStrikeout:8&x,fOutline:16&x,fShadow:32&x,fCondense:64&x,fExtend:128&x});switch(x.fItalic&&(h.italic=1),x.fCondense&&(h.condense=1),x.fExtend&&(h.extend=1),x.fShadow&&(h.shadow=1),x.fOutline&&(h.outline=1),x.fStrikeout&&(h.strike=1),s.read_shift(2)===700&&(h.bold=1),s.read_shift(2)){case 1:h.vertAlign="superscript";break;case 2:h.vertAlign="subscript"}switch((x=s.read_shift(1))!=0&&(h.underline=x),0<(x=s.read_shift(1))&&(h.family=x),0<(x=s.read_shift(1))&&(h.charset=x),s.l++,h.color=(function(v){var S={},T=v.read_shift(1)>>>1,k=v.read_shift(1),_=v.read_shift(2,"i"),L=v.read_shift(1),B=v.read_shift(1),z=v.read_shift(1);switch(v.l++,T){case 0:S.auto=1;break;case 1:S.index=k;var Z=zd[k];Z&&(S.rgb=Jd(Z));break;case 2:S.rgb=Jd([L,B,z]);break;case 3:S.theme=k}return _!=0&&(S.tint=0<_?_/32767:_/32768),S})(s),s.read_shift(1)){case 1:h.scheme="major";break;case 2:h.scheme="minor"}return h.name=rs(s),h}},44:{f:function(s,c){return[s.read_shift(2),rs(s)]}},45:{f:xv},46:{f:fr},47:{f:function(s,g){var u=s.l+g,h=s.read_shift(2),g=s.read_shift(2);return s.l=u,{ixfe:h,numFmtId:g}}},48:{},49:{f:function(s){return s.read_shift(4,"i")}},50:{},51:{f:function(s){for(var c=[],u=s.read_shift(4);0<u--;)c.push([s.read_shift(4),s.read_shift(4)]);return c}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:l0},62:{f:function(s){return[Fi(s),Vp(s),"is"]}},63:{f:function(s){var c={};c.i=s.read_shift(4);var u={};return u.r=s.read_shift(4),u.c=s.read_shift(4),c.r=yr(u),2&(s=s.read_shift(1))&&(c.l="1"),8&s&&(c.a="1"),c}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(s){var c=s.read_shift(2);return s.l+=28,{RTL:32&c}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(s,c){var u={},h=s[s.l];return++s.l,u.above=!(64&h),u.left=!(128&h),s.l+=18,u.name=li(s),u}},148:{f:_h,p:16},151:{f:function(){}},152:{},153:{f:function(s,c){var u={},h=s.read_shift(4);return u.defaultThemeVersion=s.read_shift(4),0<(s=8<c?rs(s):"").length&&(u.CodeName=s),u.autoCompressPictures=!!(65536&h),u.backupFile=!!(64&h),u.checkCompatibility=!!(4096&h),u.date1904=!!(1&h),u.filterPrivacy=!!(8&h),u.hidePivotFieldList=!!(1024&h),u.promptedSolutions=!!(16&h),u.publishItems=!!(2048&h),u.refreshAllConnections=!!(262144&h),u.saveExternalLinkValues=!!(128&h),u.showBorderUnselectedTables=!!(4&h),u.showInkAnnotation=!!(32&h),u.showObjects=["all","placeholders","none"][h>>13&3],u.showPivotChartFilter=!!(32768&h),u.updateLinks=["userSet","never","always"][h>>8&3],u}},154:{},155:{},156:{f:function(s,c){var u={};return u.Hidden=s.read_shift(4),u.iTabID=s.read_shift(4),u.strRelID=Kp(s),u.name=rs(s),u}},157:{},158:{},159:{T:1,f:function(s){return[s.read_shift(4),s.read_shift(4)]}},160:{T:-1},161:{T:1,f:ol},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Bl},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(s,c){return{flags:s.read_shift(4),version:s.read_shift(4),name:rs(s)}}},336:{T:-1},337:{f:function(s){return s.l+=4,s.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:i0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(s,x,u){var h=s.l+x,g=Yp(s),x=s.read_shift(1);return(g=[g])[2]=x,u.cellFormula?(u=OS(s,h-s.l,u),g[1]=u):s.l=h,g}},427:{f:function(s,g,u){var h=s.l+g,g=[ol(s)];return u.cellFormula&&(u=Ph(s,h-s.l,u),g[1]=u),s.l=h,g}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(s){var c={};return j1.forEach(function(u){c[u]=fs(s)}),c}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(s,S){var u=s.l+S,h=ol(s),g=Gp(s),x=rs(s),v=rs(s),S=rs(s);return s.l=u,S={rfx:h,relId:g,loc:x,display:S},v&&(S.Tooltip=v),S}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Or},633:{T:1},634:{T:-1},635:{T:1,f:function(s){var c={};c.iauthor=s.read_shift(4);var u=ol(s);return c.rfx=u.s,c.ref=yr(u.s),s.l+=16,c}},636:{T:-1},637:{f:Qb},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(s,c){return s.l+=10,{name:rs(s)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},z1={6:{f:of},10:{f:Rs},12:{f:_o},13:{f:_o},14:{f:ao},15:{f:ao},16:{f:fs},17:{f:ao},18:{f:ao},19:{f:_o},20:{f:Vg},21:{f:Vg},23:{f:i0},24:{f:Xc},25:{f:ao},26:{},27:{},28:{f:function(s,c,u){return(function(h,g){if(!(g.biff<8)){var x=h.read_shift(2),v=h.read_shift(2),S=h.read_shift(2),T=h.read_shift(2),k=uc(h,0,g);return g.biff<8&&h.read_shift(1),[{r:x,c:v},k,T,S]}})(s,u)}},29:{},34:{f:ao},35:{f:av},38:{f:fs},39:{f:fs},40:{f:fs},41:{f:fs},42:{f:ao},43:{f:ao},47:{f:function(s,c,u){var h={Type:8<=u.biff?s.read_shift(2):0};return h.Type?mv(s,c-2,h):(c=s,u.biff,s=u,u=h,c={key:_o(c),verificationBytes:_o(c)},s.password&&(c.verifier=x0(s.password)),u.valid=c.verificationBytes===c.verifier,u.valid&&(u.insitu=pv(s.password))),h}},49:{f:function(s,c,u){var h={dyHeight:s.read_shift(2),fl:s.read_shift(2)};switch(u&&u.biff||8){case 2:break;case 3:case 4:s.l+=2;break;default:s.l+=10}return h.name=il(s,0,u),h}},51:{f:_o},60:{},61:{f:function(s){return{Pos:[s.read_shift(2),s.read_shift(2)],Dim:[s.read_shift(2),s.read_shift(2)],Flags:s.read_shift(2),CurTab:s.read_shift(2),FirstTab:s.read_shift(2),Selected:s.read_shift(2),TabRatio:s.read_shift(2)}}},64:{f:ao},65:{f:function(){}},66:{f:_o},77:{},80:{},81:{},82:{},85:{f:_o},89:{},90:{},91:{},92:{f:function(s,c,g){if(g.enc)return s.l+=c,"";var h=s.l,g=uc(s,0,g);return s.read_shift(c+h-s.l),g}},93:{f:function(s,c,u){return u&&u.biff<8?(function(h,g,x){h.l+=4;var v=h.read_shift(2),S=h.read_shift(2),T=h.read_shift(2);h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=6,g-=36;var k=[];return k.push((iv[v]||vs)(h,g,x)),{cmo:[S,v,T],ft:k}})(s,c,u):{cmo:u=rv(s),ft:(function(h,g){for(var x=h.l+g,v=[];h.l<x;){var S=h.read_shift(2);h.l-=2;try{v.push(Ma[S](h,x-h.l))}catch{return h.l=x,v}}return h.l!=x&&(h.l=x),v})(s,c-22,u[1])}}},94:{},95:{f:ao},96:{},97:{},99:{f:ao},125:{f:l0},128:{f:function(s){if(s.l+=4,(s=[s.read_shift(2),s.read_shift(2)])[0]!==0&&s[0]--,s[1]!==0&&s[1]--,7<s[0]||7<s[1])throw new Error("Bad Gutters: "+s.join("|"));return s}},129:{f:function(s,c,u){return{fDialog:16&(c=u&&u.biff==8||c==2?s.read_shift(2):(s.l+=c,0)),fBelow:64&c,fRight:128&c}}},130:{f:_o},131:{f:ao},132:{f:ao},133:{f:function(s,c,u){var h=s.read_shift(4),g=3&s.read_shift(1),x=s.read_shift(1);switch(x){case 0:x="Worksheet";break;case 1:x="Macrosheet";break;case 2:x="Chartsheet";break;case 6:x="VBAModule"}return u=il(s,0,u),{pos:h,hs:g,dt:x,name:u=u.length===0?"Sheet1":u}}},134:{},140:{f:function(s){var c=[0,0],u=s.read_shift(2);return c[0]=Zb[u]||u,u=s.read_shift(2),c[1]=Zb[u]||u,c}},141:{f:_o},144:{},146:{f:function(s){for(var c=s.read_shift(2),u=[];0<c--;)u.push(a0(s));return u}},151:{},152:{},153:{},154:{},155:{},156:{f:_o},157:{},158:{},160:{f:u0},161:{f:function(s,c){var u={};return c<32||(s.l+=16,u.header=fs(s),u.footer=fs(s),s.l+=2),u}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(s,c){for(var u=s.l+c-2,h=s.read_shift(2),g=s.read_shift(2),x=[];s.l<u;)x.push(Qc(s));if(s.l!==u)throw new Error("MulRK read error");if(c=s.read_shift(2),x.length!=c-g+1)throw new Error("MulRK length mismatch");return{r:h,c:g,C:c,rkrec:x}}},190:{f:function(s,c){for(var u=s.l+c-2,h=s.read_shift(2),g=s.read_shift(2),x=[];s.l<u;)x.push(s.read_shift(2));if(s.l!==u)throw new Error("MulBlank read error");if(c=s.read_shift(2),x.length!=c-g+1)throw new Error("MulBlank length mismatch");return{r:h,c:g,C:c,ixfe:x}}},193:{f:Rs},197:{},198:{},199:{},200:{},201:{},202:{f:ao},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_o},220:{},221:{f:ao},222:{},224:{f:function(s,c,u){var h,g,x,v={};return v.ifnt=s.read_shift(2),v.numFmtId=s.read_shift(2),v.flags=s.read_shift(2),v.fStyle=v.flags>>2&1,c-=6,v.data=(h=s,v.fStyle,g=u,x={},c=h.read_shift(4),s=h.read_shift(4),u=h.read_shift(4),h=h.read_shift(2),x.patternType=ev[u>>26],g.cellStyles&&(x.alc=7&c,x.fWrap=c>>3&1,x.alcV=c>>4&7,x.fJustLast=c>>7&1,x.trot=c>>8&255,x.cIndent=c>>16&15,x.fShrinkToFit=c>>20&1,x.iReadOrder=c>>22&2,x.fAtrNum=c>>26&1,x.fAtrFnt=c>>27&1,x.fAtrAlc=c>>28&1,x.fAtrBdr=c>>29&1,x.fAtrPat=c>>30&1,x.fAtrProt=c>>31&1,x.dgLeft=15&s,x.dgRight=s>>4&15,x.dgTop=s>>8&15,x.dgBottom=s>>12&15,x.icvLeft=s>>16&127,x.icvRight=s>>23&127,x.grbitDiag=s>>30&3,x.icvTop=127&u,x.icvBottom=u>>7&127,x.icvDiag=u>>14&127,x.dgDiag=u>>21&15,x.icvFore=127&h,x.icvBack=h>>7&127,x.fsxButton=h>>14&1),x),v}},225:{f:function(s,c){return c===0||s.read_shift(2),1200}},226:{f:Rs},227:{},229:{f:function(s,c){for(var u=[],h=s.read_shift(2);h--;)u.push(Pa(s));return u}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(s,c){for(var u=s.l+c,c=s.read_shift(4),h=s.read_shift(4),g=[],x=0;x!=h&&s.l<u;++x)g.push((function(S){var T=f;f=1200;var k,_=S.read_shift(2),L=4&(G=S.read_shift(1)),B=8&G,z=1+(1&G),Z=0,G={};return B&&(Z=S.read_shift(2)),L&&(k=S.read_shift(4)),z=z==2?"dbcs-cont":"sbcs-cont",z=_===0?"":S.read_shift(_,z),B&&(S.l+=4*Z),L&&(S.l+=k),G.t=z,B||(G.raw="<t>"+G.t+"</t>",G.r=G.t),f=T,G})(s));return g.Count=c,g.Unique=h,g}},253:{f:function(s){var c=Is(s);return c.isst=s.read_shift(4),c}},255:{f:function(s,c){var u={};return u.dsst=s.read_shift(2),s.l+=c-2,u}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Hg},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ao},353:{f:Rs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(s,x,u){var h=s.l+x,g=s.read_shift(2),x=s.read_shift(2);if((u.sbcch=x)==1025||x==14849)return[x,g];if(x<1||255<x)throw new Error("Unexpected SupBook type: "+x);for(var u=lc(s,x),v=[];h>s.l;)v.push(cc(s));return[x,g,u,v]}},431:{f:ao},432:{},433:{},434:{},437:{},438:{f:function(s,c,u){var h=s.l,g="";try{s.l+=4;var x=(u.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(x)==-1?s.l+=6:(function(k){var _=k.read_shift(1);k.l++;var L=k.read_shift(2);k.l+=2})(s);var v=s.read_shift(2);s.read_shift(2),_o(s),x=s.read_shift(2),s.l+=x;for(var S=1;S<s.lens.length-1;++S){if(s.l-h!=s.lens[S])throw new Error("TxO: bad continue record");var T=s[s.l];if((g+=lc(s,s.lens[S+1]-s.lens[S]-1)).length>=(T?v:2*v))break}if(g.length!==v&&g.length!==2*v)throw new Error("cchText: "+v+" != "+g.length);return s.l=h+c,{t:g}}catch{return s.l=h+c,{t:g}}}},439:{f:ao},440:{f:function(s,c){var u=Pa(s);return s.l+=16,[u,(function(h,g){var x=h.l+g;if((L=h.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+L);g=h.read_shift(2),h.l+=2;var v,S,T,k,_,L="";16&g&&(v=ll(h,h.l)),128&g&&(S=ll(h,h.l)),(257&g)==257&&(T=ll(h,h.l)),(257&g)==1&&(B=dc(h,h.l)),8&g&&(L=ll(h,h.l)),32&g&&(k=h.read_shift(16)),64&g&&(_=$d(h)),h.l=x;var B=S||T||B||"";return B&&L&&(B+="#"+L),B=B||"#"+L,B={Target:B=2&g&&B.charAt(0)=="/"&&B.charAt(1)!="/"?"file://"+B:B},k&&(B.guid=k),_&&(B.time=_),v&&(B.Tooltip=v),B})(s,c-24)]}},441:{},442:{f:cc},443:{},444:{f:_o},445:{},446:{},448:{f:Rs},449:{f:function(s){return s.read_shift(2),s.read_shift(4)},r:2},450:{f:Rs},512:{f:Ku},513:{f:c0},515:{f:function(s,c,u){return u.biffguess&&u.biff==2&&(u.biff=5),u=Is(s),s=fs(s),u.val=s,u}},516:{f:function(s,c,u){return u.biffguess&&u.biff==2&&(u.biff=5),s.l,c=Is(s),u.biff==2&&s.l++,u=cc(s,s.l,u),c.val=u,c}},517:{f:ov},519:{f:oy},520:{f:function(s){var c={};c.r=s.read_shift(2),c.c=s.read_shift(2),c.cnt=s.read_shift(2)-c.c;var u=s.read_shift(2);s.l+=4;var h=s.read_shift(1);return s.l+=3,7&h&&(c.level=7&h),32&h&&(c.hidden=!0),64&h&&(c.hpt=u/20),c}},523:{},545:{f:lh},549:{f:s0},566:{},574:{f:function(s,c,u){return u&&2<=u.biff&&u.biff<5?{}:{RTL:64&s.read_shift(2)}}},638:{f:function(h){var c=h.read_shift(2),u=h.read_shift(2),h=Qc(h);return{r:c,c:u,ixfe:h[0],rknum:h[1]}}},659:{},1048:{},1054:{f:function(s,c,u){return[s.read_shift(2),uc(s,0,u)]}},1084:{},1212:{f:function(s,c,u){var h=Wg(s);s.l++;var g=s.read_shift(1);return[(function(x,v,S){var T,k=x.l+v,_=x.read_shift(2),L=Rh(x,_,S);return _==65535?[[],vs(x,v-2)]:(v!==_+2&&(T=ad(x,k-_-2,L,S)),[L,T])})(s,c-=8,u),g,h]}},2048:{f:function(s,c){return s.read_shift(2),[Pa(s),s.read_shift((c-10)/2,"dbcs-cont").replace(ne,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Wd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Rs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(s){s.l+=2;var c={cxfs:0,crc:0};return c.cxfs=s.read_shift(2),c.crc=s.read_shift(4),c},r:12},2173:{f:function(s,c){s.l,s.l+=2,c=s.read_shift(2),s.l+=2;for(var u=s.read_shift(2),h=[];0<u--;)h.push(Iv(s,s.l));return{ixfe:c,ext:h}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ao,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(s,c,u){if(!(u.biff<8)){var h=s.read_shift(2),g=s.read_shift(2);return[lc(s,h,u),lc(s,g,u)]}s.l+=c},r:12},2197:{},2198:{f:function(s,c,u){var h=s.l+c;if(s.read_shift(4)!==124226)if(u.cellStyles){var g,x=s.slice(s.l);s.l=h;try{g=Vs(x,{type:"array"})}catch{return}if(c=da(g,"theme/theme/theme1.xml",!0),c)return nu(c,u)}else s.l=h},r:12},2199:{},2200:{},2201:{},2202:{f:function(s){return[s.read_shift(4)!==0,s.read_shift(4)!==0,s.read_shift(4)]},r:12},2203:{f:Rs},2204:{},2205:{},2206:{},2207:{},2211:{f:function(s){var c,u,h=(u=(c=s).read_shift(2),h=c.read_shift(2),c.l+=8,{type:u});if(h.type!=2211)throw new Error("Invalid Future Record "+h.type);return s.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_o},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(s,c,u){var h={area:!1};return u.biff!=5?s.l+=c:(c=s.read_shift(1),s.l+=3,16&c&&(h.area=!0)),h}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(s){for(var c=s.read_shift(2),u=[];0<c--;)u.push(a0(s));return u}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ku},1:{},2:{f:function(s){var c=Is(s);return++s.l,s=s.read_shift(2),c.t="n",c.val=s,c}},3:{f:function(s){var c=Is(s);return++s.l,s=fs(s),c.t="n",c.val=s,c}},4:{f:function(s,c,u){u.biffguess&&u.biff==5&&(u.biff=2);var h=Is(s);return++s.l,u=uc(s,0,u),h.t="str",h.val=u,h}},5:{f:ov},7:{f:function(s){var c=s.read_shift(1);return c===0?(s.l++,""):s.read_shift(c,"sbcs-cont")}},8:{},9:{f:Wd},11:{},22:{f:_o},30:{f:uu},31:{},32:{},33:{f:lh},36:{},37:{f:s0},50:{f:function(s,c){s.l+=6,s.l+=2,s.l+=1,s.l+=3,s.l+=1,s.l+=c-13}},62:{},52:{},67:{},68:{f:_o},69:{},86:{},126:{},127:{f:function(s){var c=s.read_shift(2),h=s.read_shift(2),u=s.read_shift(4),h={fmt:c,env:h,len:u,data:s.slice(s.l,s.l+u)};return s.l+=u,h}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(s,x,v){var h=s.l+x,g=Is(s),x=s.read_shift(2),v=lc(s,x,v);return s.l=h,g.t="str",g.val=v,g}},223:{},234:{},354:{},421:{},518:{f:of},521:{f:Wd},536:{f:Xc},547:{f:av},561:{},579:{},1030:{f:of},1033:{f:Wd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vn(s,c,u,h){var g=c;isNaN(g)||(c=h||(u||[]).length||0,(h=s.next(4)).write_shift(2,g),h.write_shift(2,c),0<c&&Pg(u)&&s.push(u))}function zh(s,c,u){return(s=s||Mt(7)).write_shift(2,c),s.write_shift(2,u),s.write_shift(2,0),s.write_shift(1,0),s}function Xv(s,c,u,h){if(c.v!=null)switch(c.t){case"d":case"n":var g=c.t=="d"?En(Jn(c.v)):c.v;return void(g==(0|g)&&0<=g&&g<65536?vn(s,2,(_=u,L=h,B=g,zh(z=Mt(9),_,L),z.write_shift(2,B),z)):vn(s,3,(B=u,z=h,g=g,zh(k=Mt(15),B,z),k.write_shift(8,g,"f"),k)));case"b":case"e":return void vn(s,5,(k=u,x=h,v=c.v,S=c.t,zh(T=Mt(9),k,x),Vu(v,S||"b",T),T));case"s":case"str":return void vn(s,4,(x=u,v=h,S=(c.v||"").slice(0,255),zh(T=Mt(8+2*S.length),x,v),T.write_shift(1,S.length),T.write_shift(S.length,S,"sbcs"),T.l<T.length?T.slice(0,T.l):T))}var x,v,S,T,k,_,L,B,z;vn(s,1,zh(null,u,h))}function Jv(s,c){for(var u=c||{},c=xs(),h=0,g=0;g<s.SheetNames.length;++g)s.SheetNames[g]==u.sheet&&(h=g);if(h==0&&u.sheet&&s.SheetNames[0]!=u.sheet)throw new Error("Sheet not found: "+u.sheet);return vn(c,u.biff==4?1033:u.biff==3?521:9,Gu(0,16,u)),(function(x,v,S){var T,k,_=Array.isArray(v),L=Ir(v["!ref"]||"A1"),B=[];if(255<L.e.c||16383<L.e.r){if(S.WTF)throw new Error("Range "+(v["!ref"]||"A1")+" exceeds format limit A1:IV16384");L.e.c=Math.min(L.e.c,255),L.e.r=Math.min(L.e.c,16383),T=Tr(L)}for(var z=L.s.r;z<=L.e.r;++z){k=sa(z);for(var Z=L.s.c;Z<=L.e.c;++Z){z===L.s.r&&(B[Z]=Yo(Z)),T=B[Z]+k;var G=_?(v[z]||[])[Z]:v[T];G&&Xv(x,G,z,Z)}}})(c,s.Sheets[s.SheetNames[h]],u),vn(c,10),c.end()}function gf(s,c,u){var h,g;vn(s,49,(g=(h={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(s=Mt((u=(s=u)&&s.biff==5)?15+g.length:16+2*g.length)).write_shift(2,20*(h.sz||12)),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,g.length),u||s.write_shift(1,1),s.write_shift((u?1:2)*g.length,g,u?"sbcs":"utf16le"),s))}function Q0(s,c,u){c&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var g,x,v,S,T=h[0];T<=h[1];++T)c[T]!=null&&vn(s,1054,(g=T,x=c[T],S=void 0,v=(v=u)&&v.biff==5,(S=S||Mt(v?3+x.length:5+2*x.length)).write_shift(2,g),S.write_shift(v?1:2,x.length),v||S.write_shift(1,1),S.write_shift((v?1:2)*x.length,x,v?"sbcs":"utf16le"),(S=S.length>S.l?S.slice(0,S.l):S).l==null&&(S.l=S.length),S))})}function Zv(s,c){for(var u=0;u<c["!links"].length;++u){var h=c["!links"][u];vn(s,440,Vd(h)),h[1].Tooltip&&vn(s,2048,(function(g){var x=g[1].Tooltip,v=Mt(10+2*(x.length+1));v.write_shift(2,2048),g=ia(g[0]),v.write_shift(2,g.r),v.write_shift(2,g.r),v.write_shift(2,g.c),v.write_shift(2,g.c);for(var S=0;S<x.length;++S)v.write_shift(2,x.charCodeAt(S));return v.write_shift(2,0),v})(h))}delete c["!links"]}function ex(s,c){var u;c&&(u=0,c.forEach(function(h,g){var x;++u<=256&&h&&vn(s,125,(x=cf(g,h),h=g,(g=Mt(12)).write_shift(2,h),g.write_shift(2,h),g.write_shift(2,256*x.width),g.write_shift(2,0),h=0,x.hidden&&(h|=1),g.write_shift(1,h),h=x.level||0,g.write_shift(1,h),g.write_shift(2,0),g))}))}function tx(s,c,u,h,g){var x,v,S,T,k,_,L,B,z,Z,G,me=16+vc(g.cellXfs,c,g);if(c.v!=null||c.bf)if(c.bf)vn(s,6,Ih(c,u,h,0,me));else switch(c.t){case"d":case"n":var re=c.t=="d"?En(Jn(c.v)):c.v;vn(s,515,(_=u,L=h,B=re,z=me,Z=Mt(14),_l(_,L,z,Z),Ni(B,Z),Z));break;case"b":case"e":vn(s,517,(re=u,_=h,L=c.v,z=me,B=c.t,Z=Mt(8),_l(re,_,z,Z),Vu(L,B,Z),Z));break;case"s":case"str":g.bookSST?(G=Mh(g.Strings,c.v,g.revStrings),vn(s,253,(x=u,v=h,S=G,T=me,k=Mt(10),_l(x,v,T,k),k.write_shift(4,S),k))):vn(s,516,(G=u,x=h,v=(c.v||"").slice(0,255),T=me,S=Mt(+(k=!(S=g)||S.biff==8)+8+(1+k)*v.length),_l(G,x,T,S),S.write_shift(2,v.length),k&&S.write_shift(1,1),S.write_shift((1+k)*v.length,v,k?"utf16le":"sbcs"),S));break;default:vn(s,513,_l(u,h,me))}else vn(s,513,_l(u,h,me))}function nx(s,c,u){var h,g,x=xs(),he=u.SheetNames[s],v=u.Sheets[he]||{},S=(u||{}).Workbook||{},T=(S.Sheets||[])[s]||{},k=Array.isArray(v),_=c.biff==8,L=[],B=Ir(v["!ref"]||"A1"),z=_?65536:16384;if(255<B.e.c||B.e.r>=z){if(c.WTF)throw new Error("Range "+(v["!ref"]||"A1")+" exceeds format limit A1:IV16384");B.e.c=Math.min(B.e.c,255),B.e.r=Math.min(B.e.c,z-1)}vn(x,2057,Gu(0,16,c)),vn(x,13,hi(1)),vn(x,12,hi(100)),vn(x,15,hs(!0)),vn(x,17,hs(!1)),vn(x,16,Ni(.001)),vn(x,95,hs(!0)),vn(x,42,hs(!1)),vn(x,43,hs(!1)),vn(x,130,hi(1)),vn(x,128,(u=[0,0],(s=Mt(8)).write_shift(4,0),s.write_shift(2,u[0]?u[0]+1:0),s.write_shift(2,u[1]?u[1]+1:0),s)),vn(x,131,hs(!1)),vn(x,132,hs(!1)),_&&ex(x,v["!cols"]),vn(x,512,(z=B,(u=Mt(2*(s=(u=c).biff!=8&&u.biff?2:4)+6)).write_shift(s,z.s.r),u.write_shift(s,z.e.r+1),u.write_shift(2,z.s.c),u.write_shift(2,z.e.c+1),u.write_shift(2,0),u)),_&&(v["!links"]=[]);for(var Z=B.s.r;Z<=B.e.r;++Z){g=sa(Z);for(var G=B.s.c;G<=B.e.c;++G){Z===B.s.r&&(L[G]=Yo(G)),h=L[G]+g;var me=k?(v[Z]||[])[G]:v[h];me&&(tx(x,me,Z,G,c),_&&me.l&&v["!links"].push([h,me.l]))}}var re,Y,he=T.CodeName||T.name||he;return _&&vn(x,574,(S=(S.Views||[])[0],Y=Mt(18),re=1718,S&&S.RTL&&(re|=64),Y.write_shift(2,re),Y.write_shift(4,0),Y.write_shift(4,64),Y.write_shift(4,0),Y.write_shift(4,0),Y)),_&&(v["!merges"]||[]).length&&vn(x,229,(function(Ce){var we=Mt(2+8*Ce.length);we.write_shift(2,Ce.length);for(var $e=0;$e<Ce.length;++$e)sh(Ce[$e],we);return we})(v["!merges"])),_&&Zv(x,v),vn(x,442,qc(he)),_&&(re=x,Y=v,(he=Mt(19)).write_shift(4,2151),he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,3),he.write_shift(1,1),he.write_shift(4,0),vn(re,2151,he),(he=Mt(39)).write_shift(4,2152),he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,3),he.write_shift(1,0),he.write_shift(4,0),he.write_shift(2,1),he.write_shift(4,4),he.write_shift(2,0),sh(Ir(Y["!ref"]||"A1"),he),he.write_shift(4,4),vn(re,2152,he)),vn(x,10),x.end()}function rx(s,c,u){var h=xs(),S=(s||{}).Workbook||{},g=S.Sheets||[],x=S.WBProps||{},v=u.biff==8,S=u.biff==5;vn(h,2057,Gu(0,5,u)),u.bookType=="xla"&&vn(h,135),vn(h,225,v?hi(1200):null),vn(h,193,(function(re,Y){Y=Y||Mt(re);for(var he=0;he<re;++he)Y.write_shift(1,0);return Y})(2)),S&&vn(h,191),S&&vn(h,192),vn(h,226),vn(h,92,(function(re){var Y=!re||re.biff==8,he=Mt(Y?112:54);for(he.write_shift(re.biff==8?2:1,7),Y&&he.write_shift(1,0),he.write_shift(4,859007059),he.write_shift(4,5458548|(Y?0:536870912));he.l<he.length;)he.write_shift(1,Y?0:32);return he})(u)),vn(h,66,hi(v?1200:1252)),v&&vn(h,353,hi(0)),v&&vn(h,448),vn(h,317,(function(re){for(var Y=Mt(2*re),he=0;he<re;++he)Y.write_shift(2,he+1);return Y})(s.SheetNames.length)),v&&s.vbaraw&&vn(h,211),v&&s.vbaraw&&vn(h,442,qc(x.CodeName||"ThisWorkbook")),vn(h,156,hi(17)),vn(h,25,hs(!1)),vn(h,18,hs(!1)),vn(h,19,hi(0)),v&&vn(h,431,hs(!1)),v&&vn(h,444,hi(0)),vn(h,61,((S=Mt(18)).write_shift(2,0),S.write_shift(2,0),S.write_shift(2,29280),S.write_shift(2,17600),S.write_shift(2,56),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,1),S.write_shift(2,500),S)),vn(h,64,hs(!1)),vn(h,141,hi(0)),vn(h,34,hs(((x=s).Workbook&&x.Workbook.WBProps&&Bo(x.Workbook.WBProps.date1904)?"true":"false")=="true")),vn(h,14,hs(!0)),v&&vn(h,439,hs(!1)),vn(h,218,hi(0)),gf(h,0,u),Q0(h,s.SSF,u),(function(re,Y){for(var he=0;he<16;++he)vn(re,224,Yu({numFmtId:0,style:!0},0,Y));Y.cellXfs.forEach(function(Ce){vn(re,224,Yu(Ce,0,Y))})})(h,u),v&&vn(h,352,hs(!1)),S=h.end(),x=xs(),v&&vn(x,140,((me=me||Mt(4)).write_shift(2,1),me.write_shift(2,1),me)),v&&u.Strings&&(function(re,Y,he){var Ce=(he||[]).length||0;if(Ce<=8224)return vn(re,Y,he,Ce);if(!isNaN(Y)){for(var we=he.parts||[],$e=0,ot=0,et=0;et+(we[$e]||8224)<=8224;)et+=we[$e]||8224,$e++;var dt=re.next(4);for(dt.write_shift(2,Y),dt.write_shift(2,et),re.push(he.slice(ot,ot+et)),ot+=et;ot<Ce;){for((dt=re.next(4)).write_shift(2,60),et=0;et+(we[$e]||8224)<=8224;)et+=we[$e]||8224,$e++;dt.write_shift(2,et),re.push(he.slice(ot,ot+et)),ot+=et}}})(x,252,ih(u.Strings)),vn(x,10);for(var h=x.end(),T=xs(),k=0,_=0,_=0;_<s.SheetNames.length;++_)k+=(v?12:11)+(v?2:1)*s.SheetNames[_].length;var L,B,z,Z,G=S.length+k+h.length;for(_=0;_<s.SheetNames.length;++_)vn(T,133,(L={pos:G,hs:(g[_]||{}).Hidden||0,dt:0,name:s.SheetNames[_]},Z=z=void 0,z=!(B=u)||8<=B.biff?2:1,(Z=Mt(8+z*L.name.length)).write_shift(4,L.pos),Z.write_shift(1,L.hs||0),Z.write_shift(1,L.dt),Z.write_shift(1,L.name.length),8<=B.biff&&Z.write_shift(1,1),Z.write_shift(z*L.name.length,L.name,B.biff<8?"sbcs":"utf16le"),(B=Z.slice(0,Z.l)).l=Z.l,B)),G+=c[_].length;var me=T.end();if(k!=me.length)throw new Error("BS8 "+k+" != "+me.length);return x=[],S.length&&x.push(S),me.length&&x.push(me),h.length&&x.push(h),ce(x)}function U1(s,c){for(var u=0;u<=s.SheetNames.length;++u){var h=s.Sheets[s.SheetNames[u]];h&&h["!ref"]&&255<Cs(h["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+s.SheetNames[u]+"' extends beyond column IV (255).  Data may be lost.")}var g=c||{};switch(g.biff||2){case 8:case 5:return(function(x,v){var S=v||{},T=[];x&&!x.SSF&&(x.SSF=qr(ae)),x&&x.SSF&&(Et(),at(x.SSF),S.revssf=un(x.SSF),S.revssf[x.SSF[65535]]=0,S.ssf=x.SSF),S.Strings=[],S.Strings.Count=0,S.Strings.Unique=0,am(S),S.cellXfs=[],vc(S.cellXfs,{},{revssf:{General:0}}),x.Props||(x.Props={});for(var k=0;k<x.SheetNames.length;++k)T[T.length]=nx(k,S,x);return T.unshift(rx(x,T,S)),ce(T)})(s,c);case 4:case 3:case 2:return Jv(s,c)}throw new Error("invalid type "+g.bookType+" for BIFF")}function Uh(s,c){var u=c||{},h=u.dense?[]:{},g=(s=s.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!g)throw new Error("Invalid HTML: could not find <table>");for(var x,c=s.match(/<\/table/i),B=g.index,v=c&&c.index||s.length,S=nr(s.slice(B,v),/(:?<tr[^>]*>)/i,"<tr>"),T=-1,k=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},L=[],B=0;B<S.length;++B){var z=S[B].trim(),Z=z.slice(0,3).toLowerCase();if(Z!="<tr"){if(Z=="<td"||Z=="<th")for(var G=z.split(/<\/t[dh]>/i),v=0;v<G.length;++v){var me=G[v].trim();if(me.match(/<t[dh]/i)){for(var re=me,Y=0;re.charAt(0)=="<"&&-1<(Y=re.indexOf(">"));)re=re.slice(Y+1);for(var he=0;he<L.length;++he){var Ce=L[he];Ce.s.c==k&&Ce.s.r<T&&T<=Ce.e.r&&(k=Ce.e.c+1,he=-1)}var we=sr(me.slice(0,me.indexOf(">"))),$e=we.colspan?+we.colspan:1;(1<(x=+we.rowspan)||1<$e)&&L.push({s:{r:T,c:k},e:{r:T+(x||1)-1,c:k+$e-1}}),me=we.t||we["data-t"]||"",re.length&&(re=Tg(re),_.s.r>T&&(_.s.r=T),_.e.r<T&&(_.e.r=T),_.s.c>k&&(_.s.c=k),_.e.c<k&&(_.e.c=k),re.length&&(we={t:"s",v:re},u.raw||!re.trim().length||me=="s"||(re==="TRUE"?we={t:"b",v:!0}:re==="FALSE"?we={t:"b",v:!1}:isNaN(ts(re))?isNaN(Tt(re).getDate())||(we={t:"d",v:Jn(re)},(we=u.cellDates?we:{t:"n",v:En(we.v)}).z=u.dateNF||ae[14]):we={t:"n",v:ts(re)}),u.dense?(h[T]||(h[T]=[]),h[T][k]=we):h[yr({r:T,c:k})]=we)),k+=$e}}}else{if(++T,u.sheetRows&&u.sheetRows<=T){--T;break}k=0}}return h["!ref"]=Tr(_),L.length&&(h["!merges"]=L),h}function $1(s,c,u,h){for(var g=s["!merges"]||[],x=[],v=c.s.c;v<=c.e.c;++v){for(var S,T,k,_,L=0,B=0,z=0;z<g.length;++z)if(!(g[z].s.r>u||g[z].s.c>v||g[z].e.r<u||g[z].e.c<v)){if(g[z].s.r<u||g[z].s.c<v){L=-1;break}L=g[z].e.r-g[z].s.r+1,B=g[z].e.c-g[z].s.c+1;break}L<0||(S=yr({r:u,c:v}),k=(T=h.dense?(s[u]||[])[v]:s[S])&&T.v!=null&&(T.h||Op(T.w||(Dl(T),T.w)||""))||"",_={},1<L&&(_.rowspan=L),1<B&&(_.colspan=B),h.editable?k='<span contenteditable="true">'+k+"</span>":T&&(_["data-t"]=T&&T.t||"z",T.v!=null&&(_["data-v"]=T.v),T.z!=null&&(_["data-z"]=T.z),T.l&&(T.l.Target||"#").charAt(0)!="#"&&(k='<a href="'+T.l.Target+'">'+k+"</a>")),_.id=(h.id||"sjs")+"-"+S,x.push(mn("td",k,_)))}return"<tr>"+x.join("")+"</tr>"}var H1='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',go="</body></html>";function X0(s,c,u){return[].join("")+"<table"+(u&&u.id?' id="'+u.id+'"':"")+">"}function ox(s,g){var u=g||{},h=u.header!=null?u.header:H1,g=u.footer!=null?u.footer:go,x=[h],v=Cs(s["!ref"]);u.dense=Array.isArray(s),x.push(X0(0,0,u));for(var S=v.s.r;S<=v.e.r;++S)x.push($1(s,v,S,u));return x.push("</table>"+g),x.join("")}function W1(s,c,u){var h=u||{},g=0,x=0;h.origin!=null&&(typeof h.origin=="number"?g=h.origin:(g=(u=typeof h.origin=="string"?ia(h.origin):h.origin).r,x=u.c));var v=c.getElementsByTagName("tr"),S=Math.min(h.sheetRows||1e7,v.length),T={s:{r:0,c:0},e:{r:g,c:x}};s["!ref"]&&(c=Cs(s["!ref"]),T.s.r=Math.min(T.s.r,c.s.r),T.s.c=Math.min(T.s.c,c.s.c),T.e.r=Math.max(T.e.r,c.e.r),T.e.c=Math.max(T.e.c,c.e.c),g==-1&&(T.e.r=g=c.e.r+1));var k,_,L=[],B=0,z=s["!rows"]||(s["!rows"]=[]),Z=0,G=0,me=0,re=0;for(s["!cols"]||(s["!cols"]=[]);Z<v.length&&G<S;++Z){var Y=v[Z];if(sx(Y)){if(h.display)continue;z[G]={hidden:!0}}for(var he=Y.children,me=re=0;me<he.length;++me){var Ce=he[me];if(!h.display||!sx(Ce)){for(var we=Ce.hasAttribute("data-v")?Ce.getAttribute("data-v"):Ce.hasAttribute("v")?Ce.getAttribute("v"):Tg(Ce.innerHTML),$e=Ce.getAttribute("data-z")||Ce.getAttribute("z"),B=0;B<L.length;++B){var ot=L[B];ot.s.c==re+x&&ot.s.r<G+g&&G+g<=ot.e.r&&(re=ot.e.c+1-x,B=-1)}_=+Ce.getAttribute("colspan")||1,(1<(k=+Ce.getAttribute("rowspan")||1)||1<_)&&L.push({s:{r:G+g,c:re+x},e:{r:G+g+(k||1)-1,c:re+x+(_||1)-1}});var et={t:"s",v:we},dt=Ce.getAttribute("data-t")||Ce.getAttribute("t")||"";we!=null&&(we.length==0?et.t=dt||"z":h.raw||we.trim().length==0||dt=="s"||(we==="TRUE"?et={t:"b",v:!0}:we==="FALSE"?et={t:"b",v:!1}:isNaN(ts(we))?isNaN(Tt(we).getDate())||(et={t:"d",v:Jn(we)},(et=h.cellDates?et:{t:"n",v:En(et.v)}).z=h.dateNF||ae[14]):et={t:"n",v:ts(we)})),et.z===void 0&&$e!=null&&(et.z=$e);var Ot="",jt=Ce.getElementsByTagName("A");if(jt&&jt.length)for(var bt=0;bt<jt.length&&(!jt[bt].hasAttribute("href")||(Ot=jt[bt].getAttribute("href")).charAt(0)=="#");++bt);Ot&&Ot.charAt(0)!="#"&&(et.l={Target:Ot}),h.dense?(s[G+g]||(s[G+g]=[]),s[G+g][re+x]=et):s[yr({c:re+x,r:G+g})]=et,T.e.c<re+x&&(T.e.c=re+x),re+=_}}++G}return L.length&&(s["!merges"]=(s["!merges"]||[]).concat(L)),T.e.r=Math.max(T.e.r,G-1+g),s["!ref"]=Tr(T),S<=G&&(s["!fullref"]=Tr((T.e.r=v.length-Z+G-1+g,T))),s}function ax(s,c){return W1((c||{}).dense?[]:{},s,c)}function sx(s){var u,c="",u=(u=s).ownerDocument.defaultView&&typeof u.ownerDocument.defaultView.getComputedStyle=="function"?u.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(c=(c=u?u(s).getPropertyValue("display"):c)||s.style&&s.style.display)==="none"}var ix={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $h(s,c){var u=c||{},h,g,x,v,S,T=Np(s),k=[],_={name:""},L="",B=0,z={},Z=[],G=u.dense?[]:{},me={value:""},re="",Y=0,he=[],Ce=-1,we=-1,$e={s:{r:1e6,c:1e7},e:{r:0,c:0}},ot=0,et={},dt=[],Ot={},jt=[],bt=1,Qt=1,Tn=[],wn={Names:[]},sn={},dn=["",""],rn=[],Vt={},Rn="",Fn=0,qn=!1,Dr=!1,An=0;for(Uc.lastIndex=0,T=T.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Uc.exec(T);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?($e.e.c>=$e.s.c&&$e.e.r>=$e.s.r?G["!ref"]=Tr($e):G["!ref"]="A1:A1",0<u.sheetRows&&u.sheetRows<=$e.e.r&&(G["!fullref"]=G["!ref"],$e.e.r=u.sheetRows-1,G["!ref"]=Tr($e)),dt.length&&(G["!merges"]=dt),jt.length&&(G["!rows"]=jt),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),Z.push(x.name),z[x.name]=G,Dr=!1):v[0].charAt(v[0].length-2)!=="/"&&(x=sr(v[0],!1),Ce=we=-1,$e.s.r=$e.s.c=1e7,$e.e.r=$e.e.c=0,G=u.dense?[]:{},dt=[],jt=[],Dr=!0);break;case"table-row-group":v[1]==="/"?--ot:++ot;break;case"table-row":case"":if(v[1]==="/"){Ce+=bt,bt=1;break}if((Xt=sr(v[0],!1)).?Ce=Xt.-1:Ce==-1&&(Ce=0),(bt=+Xt["number-rows-repeated"]||1)<10)for(An=0;An<bt;++An)0<ot&&(jt[Ce+An]={level:ot});we=-1;break;case"covered-table-cell":v[1]!=="/"&&++we,u.sheetStubs&&(u.dense?(G[Ce]||(G[Ce]=[]),G[Ce][we]={t:"z"}):G[yr({r:Ce,c:we})]={t:"z"}),re="",he=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++we,me=sr(v[0],!1),Qt=parseInt(me["number-columns-repeated"]||"1",10),S={t:"z",v:null},me.formula&&u.cellFormula!=0&&(S.f=af(Sr(me.formula))),(me.||me["value-type"])=="string"&&(S.t="s",S.v=Sr(me["string-value"]||""),u.dense?(G[Ce]||(G[Ce]=[]),G[Ce][we]=S):G[yr({r:Ce,c:we})]=S),we+=Qt-1;else if(v[1]!=="/"){re="",Y=0,he=[],Qt=1;var Xt=bt?Ce+bt-1:Ce;if(++we>$e.e.c&&($e.e.c=we),we<$e.s.c&&($e.s.c=we),Ce<$e.s.r&&($e.s.r=Ce),Xt>$e.e.r&&($e.e.r=Xt),rn=[],Vt={},S={t:(me=sr(v[0],!1)).||me["value-type"],v:null},u.cellFormula)if(me.formula&&(me.formula=Sr(me.formula)),me["number-matrix-columns-spanned"]&&me["number-matrix-rows-spanned"]&&(Ot={s:{r:Ce,c:we},e:{r:Ce+(parseInt(me["number-matrix-rows-spanned"],10)||0)-1,c:we+(parseInt(me["number-matrix-columns-spanned"],10)||0)-1}},S.F=Tr(Ot),Tn.push([Ot,S.F])),me.formula)S.f=af(me.formula);else for(An=0;An<Tn.length;++An)Ce>=Tn[An][0].s.r&&Ce<=Tn[An][0].e.r&&we>=Tn[An][0].s.c&&we<=Tn[An][0].e.c&&(S.F=Tn[An][1]);switch((me["number-columns-spanned"]||me["number-rows-spanned"])&&(Ot={s:{r:Ce,c:we},e:{r:Ce+(parseInt(me["number-rows-spanned"],10)||0)-1,c:we+(parseInt(me["number-columns-spanned"],10)||0)-1}},dt.push(Ot)),me["number-columns-repeated"]&&(Qt=parseInt(me["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Bo(me["boolean-value"]);break;case"float":case"percentage":case"currency":S.t="n",S.v=parseFloat(me.value);break;case"date":S.t="d",S.v=Jn(me["date-value"]),u.cellDates||(S.t="n",S.v=En(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=(function(jr){var so=0,oa=0,Ye=!1,io=jr.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!io)throw new Error("|"+jr+"| is not an ISO8601 Duration");for(var Qr=1;Qr!=io.length;++Qr)if(io[Qr]){switch(oa=1,3<Qr&&(Ye=!0),io[Qr].slice(io[Qr].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+io[Qr].slice(io[Qr].length-1));case"D":oa*=24;case"H":oa*=60;case"M":if(!Ye)throw new Error("Unsupported ISO Duration Field: M");oa*=60}so+=oa*parseInt(io[Qr],10)}return so})(me["time-value"])/86400,u.cellDates&&(S.t="d",S.v=Qn(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(me.);break;default:if(S.t!=="string"&&S.t!=="text"&&S.t)throw new Error("Unsupported value type "+S.t);S.t="s",me["string-value"]!=null&&(re=Sr(me["string-value"]),he=[])}}else{if(qn=!1,S.t==="s"&&(S.v=re||"",he.length&&(S.R=he),qn=Y==0),sn.Target&&(S.l=sn),0<rn.length&&(S.c=rn,rn=[]),re&&u.cellText!==!1&&(S.w=re),qn&&(S.t="z",delete S.v),(!qn||u.sheetStubs)&&!(u.sheetRows&&u.sheetRows<=Ce))for(var pr=0;pr<bt;++pr){if(Qt=parseInt(me["number-columns-repeated"]||"1",10),u.dense)for(G[Ce+pr]||(G[Ce+pr]=[]),G[Ce+pr][we]=pr==0?S:qr(S);0<--Qt;)G[Ce+pr][we+Qt]=qr(S);else for(G[yr({r:Ce+pr,c:we})]=S;0<--Qt;)G[yr({r:Ce+pr,c:we+Qt})]=qr(S);$e.e.c<=we&&($e.e.c=we)}we+=(Qt=parseInt(me["number-columns-repeated"]||"1",10))-1,Qt=0,S={},re="",he=[]}sn={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((h=k.pop())[0]!==v[3])throw"Bad state: "+h}else v[0].charAt(v[0].length-2)!=="/"&&k.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((h=k.pop())[0]!==v[3])throw"Bad state: "+h;Vt.t=re,he.length&&(Vt.R=he),Vt.a=Rn,rn.push(Vt)}else v[0].charAt(v[0].length-2)!=="/"&&k.push([v[3],!1]);re=Rn="",Y=Fn=0,he=[];break;case"creator":v[1]==="/"?Rn=T.slice(Fn,v.index):Fn=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((h=k.pop())[0]!==v[3])throw"Bad state: "+h}else v[0].charAt(v[0].length-2)!=="/"&&k.push([v[3],!1]);re="",Y=0,he=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(et[_.name]=L,(h=k.pop())[0]!==v[3])throw"Bad state: "+h}else v[0].charAt(v[0].length-2)!=="/"&&(L="",_=sr(v[0],!1),k.push([v[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(k[k.length-1][0]){case"time-style":case"date-style":g=sr(v[0],!1),L+=ix[v[3]][g.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(k[k.length-1][0]){case"time-style":case"date-style":g=sr(v[0],!1),L+=ix[v[3]][g.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(k[k.length-1][0]){case"number-style":case"date-style":case"time-style":L+=T.slice(B,v.index)}else B=v.index+v[0].length;break;case"named-range":dn=zi((g=sr(v[0],!1))["cell-range-address"]);var Vr={Name:g.name,Ref:dn[0]+"!"+dn[1]};Dr&&(Vr.Sheet=Z.length),wn.Names.push(Vr);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(k[k.length-1][0]))break;v[1]!=="/"||me&&me["string-value"]?(sr(v[0],!1),Y=v.index+v[0].length):(Vr=(Vr=T.slice(Y,v.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(jr,so){return Array(parseInt(so,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),Vr=[Sr(Vr.replace(/<[^>]*>/g,""))],re=(0<re.length?re+`
`:"")+Vr[0]);break;case"s":break;case"database-range":if(v[1]==="/")break;try{z[(dn=zi(sr(v[0])["target-range-address"]))[0]]["!autofilter"]={ref:dn[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(v[1]!=="/"){if(!(sn=sr(v[0],!1)).href)break;sn.Target=Sr(sn.href),delete sn.href,sn.Target.charAt(0)=="#"&&-1<sn.Target.indexOf(".")?(dn=zi(sn.Target.slice(1)),sn.Target="#"+dn[0]+"!"+dn[1]):sn.Target.match(/^\.\.[\\\/]/)&&(sn.Target=sn.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(u.WTF)throw new Error(v)}}return s={Sheets:z,SheetNames:Z,Workbook:wn},u.bookSheets&&delete s.Sheets,s}function cd(s,c){c=c||{},kr(s,"META-INF/manifest.xml")&&(function(h,g){for(var x,v,S=Np(h);x=Uc.exec(S);)switch(x[3]){case"manifest":break;case"file-entry":if((v=sr(x[0],!1)).path=="/"&&v.type!==Jp)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(g&&g.WTF)throw x}})(Eo(s,"META-INF/manifest.xml"),c);var u=da(s,"content.xml");if(!u)throw new Error("Missing content.xml in ODS / UOF file");return c=$h(po(u),c),kr(s,"meta.xml")&&(c.Props=Rl(Eo(s,"meta.xml"))),c}function J0(s,c){return $h(s,c)}var Z0=(function(){var s=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),c="<office:document-styles "+Oi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+s+"</office:document-styles>";return function(){return Ke+c}})(),em=(function(){function s(u,h,g){var x=[];x.push('      <table:table table:name="'+co(h.SheetNames[g])+`" table:style-name="ta1">
`);var v=0,S=0,T=Cs(u["!ref"]||"A1"),k=u["!merges"]||[],_=0,L=Array.isArray(u);if(u["!cols"])for(S=0;S<=T.e.c;++S)x.push("        <table:table-column"+(u["!cols"][S]?' table:style-name="co'+u["!cols"][S].ods+'"':"")+`></table:table-column>
`);for(var B="",z=u["!rows"]||[],v=0;v<T.s.r;++v)B=z[v]?' table:style-name="ro'+z[v].ods+'"':"",x.push("        <table:table-row"+B+`></table:table-row>
`);for(;v<=T.e.r;++v){for(B=z[v]?' table:style-name="ro'+z[v].ods+'"':"",x.push("        <table:table-row"+B+`>
`),S=0;S<T.s.c;++S)x.push(c);for(;S<=T.e.c;++S){for(var Z=!1,G={},me="",_=0;_!=k.length;++_)if(!(k[_].s.c>S||k[_].s.r>v||k[_].e.c<S||k[_].e.r<v)){k[_].s.c==S&&k[_].s.r==v||(Z=!0),G["table:number-columns-spanned"]=k[_].e.c-k[_].s.c+1,G["table:number-rows-spanned"]=k[_].e.r-k[_].s.r+1;break}if(Z)x.push(`          <table:covered-table-cell/>
`);else{var re=yr({r:v,c:S}),Y=L?(u[v]||[])[S]:u[re];if(Y&&Y.f&&(G["table:formula"]=co(("of:="+Y.f.replace(od,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),Y.F&&Y.F.slice(0,re.length)==re&&(he=Cs(Y.F),G["table:number-matrix-columns-spanned"]=he.e.c-he.s.c+1,G["table:number-matrix-rows-spanned"]=he.e.r-he.s.r+1)),Y){switch(Y.t){case"b":me=Y.v?"TRUE":"FALSE",G["office:value-type"]="boolean",G["office:boolean-value"]=Y.v?"true":"false";break;case"n":me=Y.w||String(Y.v||0),G["office:value-type"]="float",G["office:value"]=Y.v||0;break;case"s":case"str":me=Y.v==null?"":Y.v,G["office:value-type"]="string";break;case"d":me=Y.w||Jn(Y.v).toISOString(),G["office:value-type"]="date",G["office:date-value"]=Jn(Y.v).toISOString(),G["table:style-name"]="ce1";break;default:x.push(c);continue}var he,re=co(me).replace(/  +/g,function(we){return'<text:s text:c="'+we.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");Y.l&&Y.l.Target&&(re=mn("text:a",re,{"xlink:href":(he=(he=(he=Y.l.Target).charAt(0)=="#"?"#"+he.slice(1).replace(/\./,"!"):he).charAt(0)!="#"&&!he.match(/^\w+:/)?"../"+he:he).replace(/&/g,"&amp;")})),x.push("          "+mn("table:table-cell",mn("text:p",re,{}),G)+`
`)}else x.push(c)}}x.push(`        </table:table-row>
`)}return x.push(`      </table:table>
`),x.join("")}var c=`          <table:table-cell />
`;return function(u,h){var g=[Ke],x=Oi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),v=Oi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+x+v+`>
`),g.push(tv().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+x+`>
`),(function(T,k){T.push(` <office:automatic-styles>
`),T.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),T.push(`   <number:month number:style="long"/>
`),T.push(`   <number:text>/</number:text>
`),T.push(`   <number:day number:style="long"/>
`),T.push(`   <number:text>/</number:text>
`),T.push(`   <number:year/>
`),T.push(`  </number:date-style>
`);var _=0;k.SheetNames.map(function(B){return k.Sheets[B]}).forEach(function(B){if(B&&B["!cols"]){for(var z=0;z<B["!cols"].length;++z)if(B["!cols"][z]){var Z=B["!cols"][z];if(Z.width==null&&Z.wpx==null&&Z.wch==null)continue;tu(Z),Z.ods=_,Z=B["!cols"][z].wpx+"px",T.push('  <style:style style:name="co'+_+`" style:family="table-column">
`),T.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+Z+`"/>
`),T.push(`  </style:style>
`),++_}}});var L=0;k.SheetNames.map(function(B){return k.Sheets[B]}).forEach(function(B){if(B&&B["!rows"])for(var z,Z=0;Z<B["!rows"].length;++Z)B["!rows"][Z]&&(B["!rows"][Z].ods=L,z=B["!rows"][Z].hpx+"px",T.push('  <style:style style:name="ro'+L+`" style:family="table-row">
`),T.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+z+`"/>
`),T.push(`  </style:style>
`),++L)}),T.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),T.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),T.push(`  </style:style>
`),T.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),T.push(` </office:automatic-styles>
`)})(g,u),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var S=0;S!=u.SheetNames.length;++S)g.push(s(u.Sheets[u.SheetNames[S]],u,S));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function Ac(s,c){if(c.bookType=="fods")return em(s,c);var u=Fr(),h=[],g=[];return ar(u,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),ar(u,"content.xml",em(s,c)),h.push(["content.xml","text/xml"]),g.push(["content.xml","ContentFile"]),ar(u,"styles.xml",Z0(s,c)),h.push(["styles.xml","text/xml"]),g.push(["styles.xml","StylesFile"]),ar(u,"meta.xml",Ke+tv()),h.push(["meta.xml","text/xml"]),g.push(["meta.xml","MetadataFile"]),ar(u,"manifest.rdf",(function(x){var v=[Ke];v.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var S=0;S!=x.length;++S)v.push(Hu(x[S][0],x[S][1])),v.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+x[S][0]+`"/>
`,`  </rdf:Description>
`].join(""));return v.push(Hu("","Document","pkg")),v.push("</rdf:RDF>"),v.join("")})(g)),h.push(["manifest.rdf","application/rdf+xml"]),ar(u,"META-INF/manifest.xml",(function(x){var v=[Ke];v.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),v.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var S=0;S<x.length;++S)v.push('  <manifest:file-entry manifest:full-path="'+x[S][0]+'" manifest:media-type="'+x[S][1]+`"/>
`);return v.push("</manifest:manifest>"),v.join("")})(h)),u}function is(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function ud(s){return typeof TextDecoder<"u"?new TextDecoder().decode(s):po(oe(s))}function lx(s){return typeof TextEncoder<"u"?new TextEncoder().encode(s):de(ks(s))}function Ec(s){var c=s.reduce(function(g,x){return g+x.length},0),u=new Uint8Array(c),h=0;return s.forEach(function(g){u.set(g,h),h+=g.length}),u}function V1(s){return 16843009*((s=(858993459&(s-=s>>1&1431655765))+(s>>2&858993459))+(s>>4)&252645135)>>>24}function yf(s,c){var u=c?c[0]:0,h=127&s[u];return 128<=s[u++]&&(h|=(127&s[u])<<7,s[u++]<128||(h|=(127&s[u])<<14,s[u++]<128||(h|=(127&s[u])<<21,s[u++]<128||(h+=(127&s[u])*Math.pow(2,28),++u,s[u++]<128||(h+=(127&s[u])*Math.pow(2,35),++u,s[u++]<128||(h+=(127&s[u])*Math.pow(2,42),++u,s[u++])))))),c&&(c[0]=u),h}function eo(s){var c=new Uint8Array(7);c[0]=127&s;var u=1;return 127<s&&(c[u-1]|=128,c[u]=s>>7&127,++u,s<=16383||(c[u-1]|=128,c[u]=s>>14&127,++u,s<=2097151||(c[u-1]|=128,c[u]=s>>21&127,++u,s<=268435455||(c[u-1]|=128,c[u]=s/256>>>21&127,++u,s<=34359738367||(c[u-1]|=128,c[u]=s/65536>>>21&127,++u,s<=4398046511103||(c[u-1]|=128,c[u]=s/16777216>>>21&127,++u)))))),c.slice(0,u)}function na(s){var c=0,u=127&s[0];return 128<=s[c++]&&(u|=(127&s[1])<<7,s[c++]<128||(u|=(127&s[2])<<14,s[c++]<128||(u|=(127&s[3])<<21,s[+c]<128||(u|=(127&s[4])<<28)))),u}function Br(s){for(var c=[],u=[0];u[0]<s.length;){var h,g=u[0],x=yf(s,u),v=7&x,S=0;if((x=Math.floor(x/8))==0)break;switch(v){case 0:for(var T=u[0];128<=s[u[0]++];);h=s.slice(T,u[0]);break;case 5:S=4,h=s.slice(u[0],u[0]+S),u[0]+=S;break;case 1:S=8,h=s.slice(u[0],u[0]+S),u[0]+=S;break;case 2:S=yf(s,u),h=s.slice(u[0],u[0]+S),u[0]+=S;break;case 3:case 4:default:throw new Error("PB Type ".concat(v," for Field ").concat(x," at offset ").concat(g))}var k={data:h,type:v};c[x]==null?c[x]=[k]:c[x].push(k)}return c}function ra(s){var c=[];return s.forEach(function(u,h){h!=0&&u.forEach(function(g){g.data&&(c.push(eo(8*h+g.type)),g.type==2&&c.push(eo(g.data.length)),c.push(g.data))})}),Ec(c)}function tm(s,c){return s?.map(function(u){return c(u.data)})||[]}function Hi(s){for(var c=[],u=[0];u[0]<s.length;){var h=yf(s,u),g=Br(s.slice(u[0],u[0]+h));u[0]+=h;var x={id:na(g[1][0].data),messages:[]};g[2].forEach(function(T){var S=Br(T.data),T=na(S[3][0].data);x.messages.push({meta:S,data:s.slice(u[0],u[0]+T)}),u[0]+=T}),(h=g[3])!=null&&h[0]&&(x.merge=0<na(g[3][0].data)>>>0),c.push(x)}return c}function kc(s){var c=[];return s.forEach(function(u){var h=[[],[{data:eo(u.id),type:0}],[]];u.merge!=null&&(h[3]=[{data:eo(+!!u.merge),type:0}]);var g=[];u.messages.forEach(function(x){g.push(x.data),x.meta[3]=[{type:0,data:eo(x.data.length)}],h[2].push({data:ra(x.meta),type:2})}),u=ra(h),c.push(eo(u.length)),c.push(u),g.forEach(function(x){return c.push(x)})}),Ec(c)}function Qs(s){for(var c=[],u=0;u<s.length;){var h=s[u++],g=s[u]|s[u+1]<<8|s[u+2]<<16;u+=3,c.push((function(x,v){if(x!=0)throw new Error("Unexpected Snappy chunk type ".concat(x));for(var S=[0],T=yf(v,S),k=[];S[0]<v.length;){var _=3&v[S[0]];if(_!=0){var L=0,B=0;if(_==1?(B=4+(v[S[0]]>>2&7),L=(224&v[S[0]++])<<3,L|=v[S[0]++]):(B=1+(v[S[0]++]>>2),_==2?(L=v[S[0]]|v[S[0]+1]<<8,S[0]+=2):(L=(v[S[0]]|v[S[0]+1]<<8|v[S[0]+2]<<16|v[S[0]+3]<<24)>>>0,S[0]+=4)),k=[Ec(k)],L==0)throw new Error("Invalid offset 0");if(L>k[0].length)throw new Error("Invalid offset beyond length");if(L<=B)for(k.push(k[0].slice(-L)),B-=L;B>=k[k.length-1].length;)k.push(k[k.length-1]),B-=k[k.length-1].length;k.push(k[0].slice(-L,-L+B))}else _=v[S[0]++]>>2,_<60?++_:(L=_-59,_=v[S[0]],1<L&&(_|=v[S[0]+1]<<8),2<L&&(_|=v[S[0]+2]<<16),3<L&&(_|=v[S[0]+3]<<24),_>>>=0,_++,S[0]+=L),k.push(v.slice(S[0],S[0]+_)),S[0]+=_}if((x=Ec(k)).length!=T)throw new Error("Unexpected length: ".concat(x.length," != ").concat(T));return x})(h,s.slice(u,u+g))),u+=g}if(u!==s.length)throw new Error("data is not a valid framed stream!");return Ec(c)}function dd(s){for(var c=[],u=0;u<s.length;){var h=Math.min(s.length-u,268435455),g=new Uint8Array(4);c.push(g);var x=eo(h),v=x.length;c.push(x),h<=60?(v++,c.push(new Uint8Array([h-1<<2]))):h<=256?(v+=2,c.push(new Uint8Array([240,h-1&255]))):h<=65536?(v+=3,c.push(new Uint8Array([244,h-1&255,h-1>>8&255]))):h<=16777216?(v+=4,c.push(new Uint8Array([248,h-1&255,h-1>>8&255,h-1>>16&255]))):h<=4294967296&&(v+=5,c.push(new Uint8Array([252,h-1&255,h-1>>8&255,h-1>>16&255,h-1>>>24&255]))),c.push(s.slice(u,u+h)),v+=h,g[0]=0,g[1]=255&v,g[2]=v>>8&255,g[3]=v>>16&255,u+=h}return Ec(c)}function zS(s,c,u){var h,g=is(s),x=g.getUint32(8,!0),v=12,S=-1,T=-1,k=NaN,_=NaN,L=new Date(2001,0,1);switch(1&x&&(k=(function(B,z){for(var Z=(127&B[z+15])<<7|B[z+14]>>1,G=1&B[z+14],me=z+13;z<=me;--me)G=256*G+B[me];return(128&B[z+15]?-G:G)*Math.pow(10,Z-6176)})(s,v),v+=16),2&x&&(_=g.getFloat64(v,!0),v+=8),4&x&&(L.setTime(L.getTime()+1e3*g.getFloat64(v,!0)),v+=8),8&x&&(T=g.getUint32(v,!0),v+=4),16&x&&(S=g.getUint32(v,!0),v+=4),s[1]){case 0:break;case 2:h={t:"n",v:k};break;case 3:h={t:"s",v:c[T]};break;case 5:h={t:"d",v:L};break;case 6:h={t:"b",v:0<_};break;case 7:h={t:"n",v:_/86400};break;case 8:h={t:"e",v:0};break;case 9:if(!(-1<S))throw new Error("Unsupported cell type ".concat(s[1]," : ").concat(31&x," : ").concat(s.slice(0,4)));h={t:"s",v:u[S]};break;case 10:h={t:"n",v:k};break;default:throw new Error("Unsupported cell type ".concat(s[1]," : ").concat(31&x," : ").concat(s.slice(0,4)))}return h}function fd(s,c){var u=new Uint8Array(32),h=is(u),g=12,x=0;switch(u[0]=5,s.t){case"n":u[1]=2,(function(v,S,T){var k=Math.floor(T==0?0:Math.LOG10E*Math.log(Math.abs(T)))+6176-16,_=T/Math.pow(10,k-6176);v[S+15]|=k>>7,v[S+14]|=(127&k)<<1;for(var L=0;1<=_;++L,_/=256)v[S+L]=255&_;v[S+15]|=0<=T?0:128})(u,g,s.v),x|=1,g+=16;break;case"b":u[1]=6,h.setFloat64(g,s.v?1:0,!0),x|=2,g+=8;break;case"s":if(c.indexOf(s.v)==-1)throw new Error("Value ".concat(s.v," missing from SST!"));u[1]=3,h.setUint32(g,c.indexOf(s.v),!0),x|=8,g+=4;break;default:throw"unsupported cell type "+s.t}return h.setUint32(8,x,!0),u.slice(0,g)}function G1(s,c){var u=new Uint8Array(32),h=is(u),g=12,x=0;switch(u[0]=3,s.t){case"n":u[2]=2,h.setFloat64(g,s.v,!0),x|=32,g+=8;break;case"b":u[2]=6,h.setFloat64(g,s.v?1:0,!0),x|=32,g+=8;break;case"s":if(c.indexOf(s.v)==-1)throw new Error("Value ".concat(s.v," missing from SST!"));u[2]=3,h.setUint32(g,c.indexOf(s.v),!0),x|=16,g+=4;break;default:throw"unsupported cell type "+s.t}return h.setUint32(4,x,!0),u.slice(0,g)}function cx(s,c,u){switch(s[0]){case 0:case 1:case 2:case 3:return(function(h,g,x,v){var S,T=is(h),k=T.getUint32(4,!0),_=(1<v?12:8)+4*V1(k&(1<v?3470:398)),L=-1,B=-1,z=NaN,Z=new Date(2001,0,1);switch(512&k&&(L=T.getUint32(_,!0),_+=4),_+=4*V1(k&(1<v?12288:4096)),16&k&&(B=T.getUint32(_,!0),_+=4),32&k&&(z=T.getFloat64(_,!0),_+=8),64&k&&(Z.setTime(Z.getTime()+1e3*T.getFloat64(_,!0)),_+=8),h[2]){case 0:break;case 2:S={t:"n",v:z};break;case 3:S={t:"s",v:g[B]};break;case 5:S={t:"d",v:Z};break;case 6:S={t:"b",v:0<z};break;case 7:S={t:"n",v:z/86400};break;case 8:S={t:"e",v:0};break;case 9:if(-1<L)S={t:"s",v:x[L]};else if(-1<B)S={t:"s",v:g[B]};else{if(isNaN(z))throw new Error("Unsupported cell type ".concat(h.slice(0,4)));S={t:"n",v:z}}break;default:throw new Error("Unsupported cell type ".concat(h.slice(0,4)))}return S})(s,c,u,s[0]);case 5:return zS(s,c,u);default:throw new Error("Unsupported payload version ".concat(s[0]))}}function cr(s){return yf(Br(s)[1][0].data)}function nm(s,h){var h=Br(h.data),u=na(h[1][0].data),h=h[3],g=[];return(h||[]).forEach(function(x){var v=Br(x.data),S=na(v[1][0].data)>>>0;switch(u){case 1:g[S]=ud(v[3][0].data);break;case 8:var k=Br(s[cr(v[9][0].data)][0].data),T=s[cr(k[1][0].data)][0],k=na(T.meta[1][0].data);if(k!=2001)throw new Error("2000 unexpected reference to ".concat(k));T=Br(T.data),g[S]=T[3].map(function(_){return ud(_.data)}).join("")}}),g}function rm(s,g){var u=Br(g.data),h=(g=u?.[7])!=null&&g[0]?0<na(u[7][0].data)>>>0?1:0:-1,g=tm(u[5],function(x){return(function(v,S){var T,k,_,L=Br(v),B=na(L[1][0].data)>>>0,z=na(L[2][0].data)>>>0,Z=((v=(Z=L[8])==null?void 0:Z[0])==null?void 0:v.data)&&0<na(L[8][0].data)||!1;if((v=(v=L[7])==null?void 0:v[0])!=null&&v.data&&S!=0)k=(T=(T=L[7])==null?void 0:T[0])==null?void 0:T.data,_=(T=(T=L[6])==null?void 0:T[0])==null?void 0:T.data;else{if((T=(T=L[4])==null?void 0:T[0])==null||!T.data||S==1)throw"NUMBERS Tile missing ".concat(S," cell storage");k=(S=(S=L[4])==null?void 0:S[0])==null?void 0:S.data,_=(L=(L=L[3])==null?void 0:L[0])==null?void 0:L.data}for(var G=Z?4:1,me=is(k),re=[],Y=0;Y<k.length/2;++Y){var he=me.getUint16(2*Y,!0);he<65535&&re.push([Y,he])}if(re.length!=z)throw"Expected ".concat(z," cells, found ").concat(re.length);for(var Ce=[],Y=0;Y<re.length-1;++Y)Ce[re[Y][0]]=_.subarray(re[Y][1]*G,re[Y+1][1]*G);return 1<=re.length&&(Ce[re[re.length-1][0]]=_.subarray(re[re.length-1][1]*G)),{R:B,cells:Ce}})(x,h)});return{nrows:na(u[4][0].data)>>>0,data:g.reduce(function(x,v){return x[v.R]||(x[v.R]=[]),v.cells.forEach(function(S,T){if(x[v.R][T])throw new Error("Duplicate cell r=".concat(v.R," c=").concat(T));x[v.R][T]=S}),x},[])}}function K1(s,g){var u={"!ref":"A1"},h=s[cr(Br(g.data)[2][0].data)],g=na(h[0].meta[1][0].data);if(g!=6001)throw new Error("6000 unexpected reference to ".concat(g));return(function(x,T,S){var L=Br(T.data);if((T={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(na(L[6][0].data)>>>0)-1,T.e.r<0)throw new Error("Invalid row varint ".concat(L[6][0].data));if(T.e.c=(na(L[7][0].data)>>>0)-1,T.e.c<0)throw new Error("Invalid col varint ".concat(L[7][0].data));S["!ref"]=Tr(T);var T=Br(L[4][0].data),k=nm(x,x[cr(T[4][0].data)][0]),_=(L=T[17])!=null&&L[0]?nm(x,x[cr(T[17][0].data)][0]):[],L=Br(T[3][0].data),B=0;if(L[1].forEach(function(Z){var G=Br(Z.data),Z=x[cr(G[2][0].data)][0],G=na(Z.meta[1][0].data);if(G!=6002)throw new Error("6001 unexpected reference to ".concat(G));Z=rm(0,Z),Z.data.forEach(function(me,re){me.forEach(function(Y,he){he=yr({r:B+re,c:he}),Y=cx(Y,k,_),Y&&(S[he]=Y)})}),B+=Z.nrows}),(L=T[13])!=null&&L[0]){if(L=x[cr(T[13][0].data)][0],T=na(L.meta[1][0].data),T!=6144)throw new Error("Expected merge type 6144, found ".concat(T));S["!merges"]=(L=Br(L.data))==null?void 0:L[1].map(function(Z){var G=Br(Z.data),Z=is(Br(G[1][0].data)[1][0].data),G=is(Br(G[2][0].data)[1][0].data);return{s:{r:Z.getUint16(0,!0),c:Z.getUint16(2,!0)},e:{r:Z.getUint16(0,!0)+G.getUint16(0,!0)-1,c:Z.getUint16(2,!0)+G.getUint16(2,!0)-1}}})}})(s,h[0],u),u}function ux(s,c){var u=ry(),h=Br(c.data);if((c=h[2])!=null&&c[0])throw new Error("Keynote presentations are not supported");if(tm(h[1],cr).forEach(function(g){s[g].forEach(function(x){var v,S,T,k;na(x.meta[1][0].data)==2&&(S=s,x=Br((T=x).data),k={name:(T=x[1])!=null&&T[0]?ud(x[1][0].data):"",sheets:[]},tm(x[2],cr).forEach(function(_){S[_].forEach(function(L){na(L.meta[1][0].data)==6e3&&k.sheets.push(K1(S,L))})}),(v=k).sheets.forEach(function(_,L){hm(u,_,L==0?v.name:v.name+"_"+L,!0)}))})}),u.SheetNames.length==0)throw new Error("Empty NUMBERS file");return u}function om(s){var c={},u=[];if(s.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),s.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var x,v;try{x=Qs(g.content)}catch(S){return console.log("?? "+g.content.length+" "+(S.message||S))}try{v=Hi(x)}catch(S){return console.log("## "+(S.message||S))}v.forEach(function(S){c[S.id]=S.messages,u.push(S.id)})}}),!u.length)throw new Error("File has no messages");if((s=(s=(s=(s=c?.[1])==null?void 0:s[0])==null?void 0:s.meta)==null?void 0:s[1])!=null&&s[0].data&&na(c[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var h=((s=(s=(s=(s=c?.[1])==null?void 0:s[0])==null?void 0:s.meta)==null?void 0:s[1])==null?void 0:s[0].data)&&na(c[1][0].meta[1][0].data)==1&&c[1][0];if(h||u.forEach(function(g){c[g].forEach(function(x){if(na(x.meta[1][0].data)>>>0==1){if(h)throw new Error("Document has multiple roots");h=x}})}),!h)throw new Error("Cannot find Document root");return ux(c,h)}function Hh(s,c){if(!c||!c.numbers)throw new Error("Must pass a `numbers` option -- check the README");var u=s.Sheets[s.SheetNames[0]];1<s.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var h=Cs(u["!ref"]);h.s.r=h.s.c=0;var g=!1;9<h.e.c&&(g=!0,h.e.c=9),49<h.e.r&&(g=!0,h.e.r=49),g&&console.error("The Numbers writer is currently limited to ".concat(Tr(h)));var x=cm(u,{range:h,header:1}),v=["~Sh33tJ5~"];x.forEach(function(sn){return sn.forEach(function(dn){typeof dn=="string"&&v.push(dn)})});var S={},T=[],k=$t.read(c.numbers,{type:"base64"});k.FileIndex.map(function(sn,dn){return[sn,k.FullPaths[dn]]}).forEach(function(sn){var dn=sn[0],rn=sn[1];dn.type==2&&dn.name.match(/\.iwa/)&&Hi(Qs(dn.content)).forEach(function(Vt){T.push(Vt.id),S[Vt.id]={deps:[],location:rn,type:na(Vt.messages[0].meta[1][0].data)}})}),T.sort(function(sn,dn){return sn-dn});var _=T.filter(function(sn){return 1<sn}).map(function(sn){return[sn,eo(sn)]});k.FileIndex.map(function(sn,dn){return[sn,k.FullPaths[dn]]}).forEach(function(sn){var dn=sn[0];sn[1],dn.name.match(/\.iwa/)&&Hi(Qs(dn.content)).forEach(function(rn){rn.messages.forEach(function(Vt){_.forEach(function(Rn){rn.messages.some(function(Fn){return na(Fn.meta[1][0].data)!=11006&&(function(qn,Dr){e:for(var An=0;An<=qn.length-Dr.length;++An){for(var Xt=0;Xt<Dr.length;++Xt)if(qn[An+Xt]!=Dr[Xt])continue e;return!0}return!1})(Fn.data,Rn[1])})&&S[Rn[0]].deps.push(rn.id)})})})});for(var L,B=$t.find(k,S[1].location),z=Hi(Qs(B.content)),Z=0;Z<z.length;++Z){var G=z[Z];G.id==1&&(L=G)}for(var me=cr(Br(L.messages[0].data)[1][0].data),z=Hi(Qs((B=$t.find(k,S[me].location)).content)),Z=0;Z<z.length;++Z)(G=z[Z]).id==me&&(L=G);var Ot=Br(L.messages[0].data);for(Ot[1]=[{type:2,data:lx(s.SheetNames[0])}],L.messages[0].data=ra(Ot),B.content=dd(kc(z)),B.size=B.content.length,me=cr(Ot[2][0].data),z=Hi(Qs((B=$t.find(k,S[me].location)).content)),Z=0;Z<z.length;++Z)(G=z[Z]).id==me&&(L=G);for(me=cr(Br(L.messages[0].data)[2][0].data),z=Hi(Qs((B=$t.find(k,S[me].location)).content)),Z=0;Z<z.length;++Z)(G=z[Z]).id==me&&(L=G);g=Br(L.messages[0].data),g[6][0].data=eo(h.e.r+1),g[7][0].data=eo(h.e.c+1);for(var re=cr(g[46][0].data),c=$t.find(k,S[re].location),Y=Hi(Qs(c.content)),he=0;he<Y.length&&Y[he].id!=re;++he);if(Y[he].id!=re)throw"Bad ColumnRowUIDMapArchive";var Ce=Br(Y[he].messages[0].data);Ce[1]=[],Ce[2]=[],Ce[3]=[];for(var we=0;we<=h.e.c;++we)Ce[1].push({type:2,data:ra([[],[{type:0,data:eo(we+420690)}],[{type:0,data:eo(we+420690)}]])}),Ce[2].push({type:0,data:eo(we)}),Ce[3].push({type:0,data:eo(we)});Ce[4]=[],Ce[5]=[],Ce[6]=[];for(var $e=0;$e<=h.e.r;++$e)Ce[4].push({type:2,data:ra([[],[{type:0,data:eo($e+726270)}],[{type:0,data:eo($e+726270)}]])}),Ce[5].push({type:0,data:eo($e)}),Ce[6].push({type:0,data:eo($e)});if(Y[he].messages[0].data=ra(Ce),c.content=dd(kc(Y)),c.size=c.content.length,delete g[46],s=Br(g[4][0].data),s[7][0].data=eo(h.e.r+1),Ot=cr(Br(s[1][0].data)[2][0].data),(Y=Hi(Qs((c=$t.find(k,S[Ot].location)).content)))[0].id!=Ot)throw"Bad HeaderStorageBucket";for(var ot=Br(Y[0].messages[0].data),$e=0;$e<x.length;++$e){var et=Br(ot[2][0].data);et[1][0].data=eo($e),et[4][0].data=eo(x[$e].length),ot[2][$e]={type:ot[2][0].type,data:ra(et)}}Y[0].messages[0].data=ra(ot),c.content=dd(kc(Y)),c.size=c.content.length;var dt,Ot=cr(s[2][0].data);if((Y=Hi(Qs((c=$t.find(k,S[Ot].location)).content)))[0].id!=Ot)throw"Bad HeaderStorageBucket";for(ot=Br(Y[0].messages[0].data),we=0;we<=h.e.c;++we)(et=Br(ot[2][0].data))[1][0].data=eo(we),et[4][0].data=eo(h.e.r+1),ot[2][we]={type:ot[2][0].type,data:ra(et)};Y[0].messages[0].data=ra(ot),c.content=dd(kc(Y)),c.size=c.content.length,u["!merges"]&&(Tn=(function(sn){for(var dn=927262;dn<2e6;++dn)if(!S[dn])return S[dn]=sn,dn;throw new Error("Too many messages")})({type:6144,deps:[me],location:S[me].location}),dt=[[],[]],u["!merges"].forEach(function(sn){dt[1].push({type:2,data:ra([[],[{type:2,data:ra([[],[{type:5,data:new Uint8Array(new Uint16Array([sn.s.r,sn.s.c]).buffer)}]])}],[{type:2,data:ra([[],[{type:5,data:new Uint8Array(new Uint16Array([sn.e.r-sn.s.r+1,sn.e.c-sn.s.c+1]).buffer)}]])}]])})}),s[13]=[{type:2,data:ra([[],[{type:0,data:eo(Tn)}]])}],z.push({id:Tn,messages:[(Qt=6144,Tn=ra(dt),{meta:[[],[{type:0,data:eo(Qt)}]],data:Tn})]}));var jt=cr(s[4][0].data);(function(){for(var sn,dn=$t.find(k,S[jt].location),rn=Hi(Qs(dn.content)),Vt=0;Vt<rn.length;++Vt){var Rn=rn[Vt];Rn.id==jt&&(sn=Rn)}var Fn=Br(sn.messages[0].data);Fn[3]=[],v.forEach(function(qn,Dr){Fn[3].push({type:2,data:ra([[],[{type:0,data:eo(Dr)}],[{type:0,data:eo(1)}],[{type:2,data:lx(qn)}]])})}),sn.messages[0].data=ra(Fn),dn.content=dd(kc(rn)),dn.size=dn.content.length})();var bt=Br(s[3][0].data),Qt=bt[1][0];delete bt[2];var Qt,Tn,Tn=Br(Qt.data),wn=cr(Tn[2][0].data);return(function(){for(var sn,dn=$t.find(k,S[wn].location),rn=Hi(Qs(dn.content)),Vt=0;Vt<rn.length;++Vt){var Rn=rn[Vt];Rn.id==wn&&(sn=Rn)}var Fn=Br(sn.messages[0].data);delete Fn[6],delete bt[7];var qn=new Uint8Array(Fn[5][0].data);Fn[5]=[];for(var Dr=0,An=0;An<=h.e.r;++An){var Xt=Br(qn);Dr+=(function(pr,Vr,jr){var so,oa;if((so=pr[6])==null||!so[0]||(oa=pr[7])==null||!oa[0])throw"Mutation only works on post-BNC storages!";if((oa=(oa=pr[8])==null?void 0:oa[0])!=null&&oa.data&&0<na(pr[8][0].data))throw"Math only works with normal offsets";for(var Ye,io,Qr=0,Ka=is(pr[7][0].data),Wi=0,De=[],vt=is(pr[4][0].data),He=0,yt=[],Ue=0;Ue<Vr.length;++Ue)if(Vr[Ue]!=null){switch(Ka.setUint16(2*Ue,Wi,!0),vt.setUint16(2*Ue,He,!0),typeof Vr[Ue]){case"string":Ye=fd({t:"s",v:Vr[Ue]},jr),io=G1({t:"s",v:Vr[Ue]},jr);break;case"number":Ye=fd({t:"n",v:Vr[Ue]},jr),io=G1({t:"n",v:Vr[Ue]},jr);break;case"boolean":Ye=fd({t:"b",v:Vr[Ue]},jr),io=G1({t:"b",v:Vr[Ue]},jr);break;default:throw new Error("Unsupported value "+Vr[Ue])}De.push(Ye),Wi+=Ye.length,yt.push(io),He+=io.length,++Qr}else Ka.setUint16(2*Ue,65535,!0),vt.setUint16(2*Ue,65535);for(pr[2][0].data=eo(Qr);Ue<pr[7][0].data.length/2;++Ue)Ka.setUint16(2*Ue,65535,!0),vt.setUint16(2*Ue,65535,!0);return pr[6][0].data=Ec(De),pr[3][0].data=Ec(yt),Qr})(Xt,x[An],v),Xt[1][0].data=eo(An),Fn[5].push({data:ra(Xt),type:2})}Fn[1]=[{type:0,data:eo(h.e.c+1)}],Fn[2]=[{type:0,data:eo(h.e.r+1)}],Fn[3]=[{type:0,data:eo(Dr)}],Fn[4]=[{type:0,data:eo(h.e.r+1)}],sn.messages[0].data=ra(Fn),dn.content=dd(kc(rn)),dn.size=dn.content.length})(),Qt.data=ra(Tn),s[3][0].data=ra(bt),g[4][0].data=ra(s),L.messages[0].data=ra(g),B.content=dd(kc(z)),B.size=B.content.length,k}function Wh(s){return function(c){for(var u=0;u!=s.length;++u){var h=s[u];c[h[0]]===void 0&&(c[h[0]]=h[1]),h[2]==="n"&&(c[h[0]]=Number(c[h[0]]))}}}function Y1(s){Wh([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(s)}function am(s){Wh([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(s)}function US(s,c){if(!s)return 0;try{s=c.map(function(u){return u.id||(u.id=u.strRelID),[u.name,s["!id"][u.id].Target,(u=s["!id"][u.id].Type,-1<wr.WS.indexOf(u)?"sheet":wr.CS&&u==wr.CS?"chart":wr.DS&&u==wr.DS?"dialog":wr.MS&&u==wr.MS?"macro":u&&u.length?u:"sheet")]})}catch{return null}return s&&s.length!==0?s:null}function $S(s,c,u,h,g,x,v,S,T,k,_,L){try{x[h]=$u(da(s,u,!0),c);var B=Eo(s,c);switch(S){case"sheet":G=H0(B,c,g,T,x[h],k,_,L);break;case"chart":if(!(G=Gv(B,c,g,T,x[h],k))||!G["!drawel"])break;var Z=ke(G["!drawel"].Target,c),z=Kc(Z),Y=ke((Y=da(s,Z,!0),z=$u(da(s,z,!0),Z),Y?(Y=(Y.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],z["!id"][Y].Target):"??"),Z),Z=Kc(Y),G=Oo(da(s,Y,!0),0,0,$u(da(s,Z,!0),Y),0,G);break;case"macro":re=c,x[h],re.slice(-4),G={"!type":"macro"};break;case"dialog":re=c,x[h],re.slice(-4),G={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+S)}v[h]=G;var me=[];x&&x[h]&&Bt(x[h]).forEach(function(he){var Ce,we,$e,ot,et,dt,Ot="";if(x[h][he].Type==wr.CMNT){Ot=ke(x[h][he].Target,c);var jt=iu(Eo(s,Ot,!0),Ot,T);if(!jt||!jt.length)return;S1(G,jt,!1)}x[h][he].Type==wr.TCMNT&&(Ot=ke(x[h][he].Target,c),me=me.concat((Ce=Eo(s,Ot,!0),we=T,ot=!($e=[]),et={},dt=0,Ce.replace($n,function(bt,Qt){var Tn=sr(bt);switch(Gs(Tn[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":et={author:Tn.personId,guid:Tn.id,ref:Tn.ref,T:1};break;case"</threadedComment>":et.t!=null&&$e.push(et);break;case"<text>":case"<text":dt=Qt+bt.length;break;case"</text>":et.t=Ce.slice(dt,Qt).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":ot=!0;break;case"</mentions>":ot=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":ot=!0;break;case"</ext>":ot=!1;break;default:if(!ot&&we.WTF)throw new Error("unrecognized "+Tn[0]+" in threaded comments")}return bt}),$e)))}),me&&me.length&&S1(G,me,!0,T.people||[])}catch(he){if(T.WTF)throw he}var re,Y}function vi(s){return s.charAt(0)=="/"?s.slice(1):s}function q1(s,c){if(Et(),Y1(c=c||{}),kr(s,"META-INF/manifest.xml")||kr(s,"objectdata.xml"))return cd(s,c);if(kr(s,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(s.FileIndex)return om(s);var u=$t.utils.cfb_new();return bs(s).forEach(function(rn){ar(u,rn,(function(Rn,Fn,qn){return Ao(Zr(Rn,Fn))})(s,rn))}),om(u)}if(!kr(s,"[Content_Types].xml"))throw kr(s,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):kr(s,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var h,g,x=bs(s),v=(function(rn){var Vt=Gc();if(!rn||!rn.match)return Vt;var Rn={};if((rn.match($n)||[]).forEach(function(Fn){var qn=sr(Fn);switch(qn[0].replace(Zo,"<")){case"<?xml":break;case"<Types":Vt.xmlns=qn["xmlns"+(qn[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":Rn[qn.Extension]=qn.ContentType;break;case"<Override":Vt[Ud[qn.ContentType]]!==void 0&&Vt[Ud[qn.ContentType]].push(qn.PartName)}}),Vt.xmlns!==fa.CT)throw new Error("Unknown Namespace: "+Vt.xmlns);return Vt.calcchain=0<Vt.calcchains.length?Vt.calcchains[0]:"",Vt.sst=0<Vt.strs.length?Vt.strs[0]:"",Vt.style=0<Vt.styles.length?Vt.styles[0]:"",Vt.defaults=Rn,delete Vt.calcchains,Vt})(da(s,"[Content_Types].xml")),et=!1;if(v.workbooks.length===0&&Eo(s,g="xl/workbook.xml",!0)&&v.workbooks.push(g),v.workbooks.length===0){if(!Eo(s,g="xl/workbook.bin",!0))throw new Error("Could not find workbook");v.workbooks.push(g),et=!0}v.workbooks[0].slice(-3)=="bin"&&(et=!0);var S={},T={};if(!c.bookSheets&&!c.bookProps){if(sf=[],v.sst)try{sf=V0(Eo(s,vi(v.sst)),v.sst,c)}catch(rn){if(c.WTF)throw rn}c.cellStyles&&v.themes.length&&(Z=da(s,v.themes[0].replace(/^\//,""),!0)||"",v.themes[0],S=nu(Z,c)),v.style&&(T=W0(Eo(s,vi(v.style)),v.style,S,c))}v.links.map(function(rn){try{return $u(da(s,Kc(vi(rn))),rn),lu(Eo(s,vi(rn)),0,rn,c)}catch{}});var k,_,L,B=L1(Eo(s,vi(v.workbooks[0])),v.workbooks[0],c),z={},Z="";v.coreprops.length&&((Z=Eo(s,vi(v.coreprops[0]),!0))&&(z=Rl(Z)),v.extprops.length!==0&&(Z=Eo(s,vi(v.extprops[0]),!0))&&(G=c,L={},_=(_=z)||{},k=po(k=Z),ci.forEach(function(rn){var Vt=(k.match(El(rn[0]))||[])[1];switch(rn[2]){case"string":Vt&&(_[rn[1]]=Sr(Vt));break;case"bool":_[rn[1]]=Vt==="true";break;case"raw":var Rn=k.match(new RegExp("<"+rn[0]+"[^>]*>([\\s\\S]*?)</"+rn[0]+">"));Rn&&0<Rn.length&&(L[rn[1]]=Rn[1])}}),L.HeadingPairs&&L.TitlesOfParts&&Ug(L.HeadingPairs,L.TitlesOfParts,_,G)));var G={};c.bookSheets&&!c.bookProps||v.custprops.length!==0&&(Z=da(s,vi(v.custprops[0]),!0))&&(G=(function(rn,Vt){var Rn={},Fn="",qn=rn.match(nv);if(qn)for(var Dr=0;Dr!=qn.length;++Dr){var An=qn[Dr],Xt=sr(An);switch(Xt[0]){case"<?xml":case"<Properties":break;case"<property":Fn=Sr(Xt.name);break;case"</property>":Fn=null;break;default:if(An.indexOf("<vt:")===0){var pr=An.split(">"),Vr=pr[0].slice(4),jr=pr[1];switch(Vr){case"lpstr":case"bstr":case"lpwstr":Rn[Fn]=Sr(jr);break;case"bool":Rn[Fn]=Bo(jr);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":Rn[Fn]=parseInt(jr,10);break;case"r4":case"r8":case"decimal":Rn[Fn]=parseFloat(jr);break;case"filetime":case"date":Rn[Fn]=Jn(jr);break;case"cy":case"error":Rn[Fn]=Sr(jr);break;default:if(Vr.slice(-1)=="/")break;Vt.WTF&&typeof console<"u"&&console.warn("Unexpected",An,Vr,pr)}}else if(An.slice(0,2)!=="</"&&Vt.WTF)throw new Error(An)}}return Rn})(Z,c));var me={};if((c.bookSheets||c.bookProps)&&(B.Sheets?h=B.Sheets.map(function(rn){return rn.name}):z.Worksheets&&0<z.SheetNames.length&&(h=z.SheetNames),c.bookProps&&(me.Props=z,me.Custprops=G),c.bookSheets&&h!==void 0&&(me.SheetNames=h),c.bookSheets?me.SheetNames:c.bookProps))return me;h={},Z={},c.bookDeps&&v.calcchain&&(Z=Ga(Eo(s,vi(v.calcchain)),v.calcchain));var re,Y,he=0,Ce={},we=B.Sheets;z.Worksheets=we.length,z.SheetNames=[];for(var $e=0;$e!=we.length;++$e)z.SheetNames[$e]=we[$e].name;var ot=et?"bin":"xml",et=v.workbooks[0].lastIndexOf("/"),dt=(v.workbooks[0].slice(0,et+1)+"_rels/"+v.workbooks[0].slice(et+1)+".rels").replace(/^\//,"");kr(s,dt)||(dt="xl/_rels/workbook."+ot+".rels");var Ot,jt,bt,Qt=$u(da(s,dt,!0),dt.replace(/_rels.*/,"s5s"));1<=(v.metadata||[]).length&&(c.xlmeta=pf(Eo(s,vi(v.metadata[0])),v.metadata[0],c)),1<=(v.people||[]).length&&(c.people=(et=Eo(s,vi(v.people[0])),Ot=c,bt=!(jt=[]),et.replace($n,function(rn){var Vt=sr(rn);switch(Gs(Vt[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":jt.push({name:Vt.displayname,id:Vt.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":bt=!0;break;case"</ext>":bt=!1;break;default:if(!bt&&Ot.WTF)throw new Error("unrecognized "+Vt[0]+" in threaded comments")}return rn}),jt)),Qt=Qt&&US(Qt,B.Sheets);var Tn=Eo(s,"xl/worksheets/sheet.xml",!0)?1:0;e:for(he=0;he!=z.Worksheets;++he){var wn="sheet";if(Qt&&Qt[he]?(re="xl/"+Qt[he][1].replace(/[\/]?xl\//,""),kr(s,re)||(re=Qt[he][1]),kr(s,re)||(re=dt.replace(/_rels\/.*$/,"")+Qt[he][1]),wn=Qt[he][2]):re=(re="xl/worksheets/sheet"+(he+1-Tn)+"."+ot).replace(/sheet0\./,"sheet."),Y=re.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),c&&c.sheets!=null)switch(typeof c.sheets){case"number":if(he!=c.sheets)continue e;break;case"string":if(z.SheetNames[he].toLowerCase()!=c.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(c.sheets)){for(var sn=!1,dn=0;dn!=c.sheets.length;++dn)typeof c.sheets[dn]=="number"&&c.sheets[dn]==he&&(sn=1),typeof c.sheets[dn]=="string"&&c.sheets[dn].toLowerCase()==z.SheetNames[he].toLowerCase()&&(sn=1);if(!sn)continue e}}$S(s,re,Y,z.SheetNames[he],he,Ce,h,wn,c,B,S,T)}return me={Directory:v,Workbook:B,Props:z,Custprops:G,Deps:Z,Sheets:h,SheetNames:z.SheetNames,Strings:sf,Styles:T,Themes:S,SSF:qr(ae)},c&&c.bookFiles&&(s.files?(me.keys=x,me.files=s.files):(me.keys=[],me.files={},s.FullPaths.forEach(function(rn,Vt){rn=rn.replace(/^Root Entry[\/]/,""),me.keys.push(rn),me.files[rn]=s.FileIndex[Vt]}))),c&&c.bookVBA&&(0<v.vba.length?me.vbaraw=Eo(s,vi(v.vba[0]),!0):v.defaults&&v.defaults.bin===_a&&(me.vbaraw=Eo(s,"xl/vbaProject.bin",!0))),me}function Do(s,c){var u,h=c||{},g="Workbook",x=$t.find(s,g);try{if(g="/!DataSpaces/Version",!(x=$t.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(v=x.content,(u={}).id=v.read_shift(0,"lpp4"),u.R=dl(v,4),u.U=dl(v,4),u.W=dl(v,4),g="/!DataSpaces/DataSpaceMap",!(x=$t.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);var v=r1(x.content);if(v.length!==1||v[0].comps.length!==1||v[0].comps[0].t!==0||v[0].name!=="StrongEncryptionDataSpace"||v[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(x=$t.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(v=(function(S){var T=[];S.l+=4;for(var k=S.read_shift(4);0<k--;)T.push(S.read_shift(0,"lpp4"));return T})(x.content),v.length!=1||v[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+g);if(g="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(x=$t.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);dv(x.content)}catch{}if(g="/EncryptionInfo",!(x=$t.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(c=fv(x.content),g="/EncryptedPackage",!(x=$t.find(s,g))||!x.content)throw new Error("ECMA-376 Encrypted file missing "+g);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],x.content,h.password||"",h);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],x.content,h.password||"",h);throw new Error("File is password-protected")}function Q1(s,c){return(c.bookType=="ods"?Ac:c.bookType=="numbers"?Hh:c.bookType=="xlsb"?function(u,h){ru=1024,u&&!u.SSF&&(u.SSF=qr(ae)),u&&u.SSF&&(Et(),at(u.SSF),h.revssf=un(u.SSF),h.revssf[u.SSF[65535]]=0,h.ssf=u.SSF),h.rels={},h.wbrels={},h.Strings=[],h.Strings.Count=0,h.Strings.Unique=0,lf?h.revStrings=new Map:(h.revStrings={},h.revStrings.foo=[],delete h.revStrings.foo);var g=h.bookType=="xlsb"?"bin":"xml",x=-1<as.indexOf(h.bookType),v=Gc();am(h=h||{});var S=Fr(),T="",k=0;if(h.cellXfs=[],vc(h.cellXfs,{},{revssf:{General:0}}),u.Props||(u.Props={}),ar(S,T="docProps/core.xml",oh(u.Props,h)),v.coreprops.push(T),mo(h.rels,2,T,wr.CORE_PROPS),T="docProps/app.xml",!u.Props||!u.Props.SheetNames)if(u.Workbook&&u.Workbook.Sheets){for(var _=[],L=0;L<u.SheetNames.length;++L)(u.Workbook.Sheets[L]||{}).Hidden!=2&&_.push(u.SheetNames[L]);u.Props.SheetNames=_}else u.Props.SheetNames=u.SheetNames;for(u.Props.Worksheets=u.Props.SheetNames.length,ar(S,T,t0(u.Props)),v.extprops.push(T),mo(h.rels,3,T,wr.EXT_PROPS),u.Custprops!==u.Props&&0<Bt(u.Custprops||{}).length&&(ar(S,T="docProps/custom.xml",ui(u.Custprops)),v.custprops.push(T),mo(h.rels,4,T,wr.CUST_PROPS)),k=1;k<=u.SheetNames.length;++k){var B,z,Z,G={"!id":{}},me=u.Sheets[u.SheetNames[k-1]];ar(S,T="xl/worksheets/sheet"+k+"."+g,(function(re,Y,he,Ce,we){return(Y.slice(-4)===".bin"?uo:B0)(re,he,Ce,we)})(k-1,T,h,u,G)),v.sheets.push(T),mo(h.wbrels,-1,"worksheets/sheet"+k+"."+g,wr.WS[0]),me&&(B=me["!comments"],z=!1,Z="",B&&0<B.length&&(ar(S,Z="xl/comments"+k+"."+g,(function(re,Y,he){return(Y.slice(-4)===".bin"?w1:Pv)(re)})(B,Z)),v.comments.push(Z),mo(G,-1,"../comments"+k+"."+g,wr.CMNT),z=!0),me["!legacy"]&&z&&ar(S,"xl/drawings/vmlDrawing"+k+".vml",C1(k,me["!comments"])),delete me["!comments"],delete me["!legacy"]),G["!id"].rId1&&ar(S,Kc(T),Li(G))}return h.Strings!=null&&0<h.Strings.length&&(ar(S,T="xl/sharedStrings."+g,(function(re,Y,he){return(Y.slice(-4)===".bin"?yc:yh)(re,he)})(h.Strings,T,h)),v.strs.push(T),mo(h.wbrels,-1,"sharedStrings."+g,wr.SST)),ar(S,T="xl/workbook."+g,(function(re,Y,he){return(Y.slice(-4)===".bin"?qs:$0)(re)})(u,T)),v.workbooks.push(T),mo(h.rels,1,T,wr.WB),ar(S,T="xl/theme/theme1.xml",D0(u.Themes,h)),v.themes.push(T),mo(h.wbrels,-1,"theme/theme1.xml",wr.THEME),ar(S,T="xl/styles."+g,(function(re,Y,he){return(Y.slice(-4)===".bin"?Tv:m1)(re,he)})(u,T,h)),v.styles.push(T),mo(h.wbrels,-1,"styles."+g,wr.STY),u.vbaraw&&x&&(ar(S,T="xl/vbaProject.bin",u.vbaraw),v.vba.push(T),mo(h.wbrels,-1,"vbaProject.bin",wr.VBA)),ar(S,T="xl/metadata."+g,(function(re){return(re.slice(-4)===".bin"?R0:x1)()})(T)),v.metadata.push(T),mo(h.wbrels,-1,"metadata."+g,wr.XLMETA),ar(S,"[Content_Types].xml",Xp(v,h)),ar(S,"_rels/.rels",Li(h.rels)),ar(S,"xl/_rels/workbook."+g+".rels",Li(h.wbrels)),delete h.revssf,delete h.ssf,S}:ls)(s,c)}function ls(s,c){ru=1024,s&&!s.SSF&&(s.SSF=qr(ae)),s&&s.SSF&&(Et(),at(s.SSF),c.revssf=un(s.SSF),c.revssf[s.SSF[65535]]=0,c.ssf=s.SSF),c.rels={},c.wbrels={},c.Strings=[],c.Strings.Count=0,c.Strings.Unique=0,lf?c.revStrings=new Map:(c.revStrings={},c.revStrings.foo=[],delete c.revStrings.foo);var u="xml",h=-1<as.indexOf(c.bookType),g=Gc();am(c=c||{});var x=Fr(),v="",S=0;if(c.cellXfs=[],vc(c.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),v="docProps/core.xml",ar(x,v,oh(s.Props,c)),g.coreprops.push(v),mo(c.rels,2,v,wr.CORE_PROPS),v="docProps/app.xml",!s.Props||!s.Props.SheetNames)if(s.Workbook&&s.Workbook.Sheets){for(var T=[],k=0;k<s.SheetNames.length;++k)(s.Workbook.Sheets[k]||{}).Hidden!=2&&T.push(s.SheetNames[k]);s.Props.SheetNames=T}else s.Props.SheetNames=s.SheetNames;s.Props.Worksheets=s.Props.SheetNames.length,ar(x,v,t0(s.Props)),g.extprops.push(v),mo(c.rels,3,v,wr.EXT_PROPS),s.Custprops!==s.Props&&0<Bt(s.Custprops||{}).length&&(ar(x,v="docProps/custom.xml",ui(s.Custprops)),g.custprops.push(v),mo(c.rels,4,v,wr.CUST_PROPS));var _,L=["SheetJ5"];for(c.tcid=0,S=1;S<=s.SheetNames.length;++S){var B,z,Z,G,me={"!id":{}},re=s.Sheets[s.SheetNames[S-1]];ar(x,v="xl/worksheets/sheet"+S+"."+u,B0(S-1,c,s,me)),g.sheets.push(v),mo(c.wbrels,-1,"worksheets/sheet"+S+"."+u,wr.WS[0]),re&&(z=!1,Z="",(B=re["!comments"])&&0<B.length&&(G=!1,B.forEach(function(Y){Y[1].forEach(function(he){he.T==1&&(G=!0)})}),G&&(ar(x,Z="xl/threadedComments/threadedComment"+S+"."+u,(function(Y,he,Ce){var we=[Ke,mn("ThreadedComments",null,{xmlns:fa.TCMNT}).replace(/[\/]>/,">")];return Y.forEach(function($e){var ot="";($e[1]||[]).forEach(function(et,dt){var Ot;et.T?(et.a&&he.indexOf(et.a)==-1&&he.push(et.a),Ot={ref:$e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+Ce.tcid++).slice(-12)+"}"},dt==0?ot=Ot.id:Ot.parentId=ot,et.ID=Ot.id,et.a&&(Ot.personId="{54EE7950-7262-4200-6969-"+("000000000000"+he.indexOf(et.a)).slice(-12)+"}"),we.push(mn("threadedComment",va("text",et.t||""),Ot))):delete et.ID})}),we.push("</ThreadedComments>"),we.join("")})(B,L,c)),g.threadedcomments.push(Z),mo(me,-1,"../threadedComments/threadedComment"+S+"."+u,wr.TCMNT)),ar(x,Z="xl/comments"+S+"."+u,Pv(B)),g.comments.push(Z),mo(me,-1,"../comments"+S+"."+u,wr.CMNT),z=!0),re["!legacy"]&&z&&ar(x,"xl/drawings/vmlDrawing"+S+".vml",C1(S,re["!comments"])),delete re["!comments"],delete re["!legacy"]),me["!id"].rId1&&ar(x,Kc(v),Li(me))}return c.Strings!=null&&0<c.Strings.length&&(ar(x,v="xl/sharedStrings.xml",yh(c.Strings,c)),g.strs.push(v),mo(c.wbrels,-1,"sharedStrings.xml",wr.SST)),ar(x,v="xl/workbook.xml",$0(s)),g.workbooks.push(v),mo(c.rels,1,v,wr.WB),ar(x,v="xl/theme/theme1.xml",D0(s.Themes,c)),g.themes.push(v),mo(c.wbrels,-1,"theme/theme1.xml",wr.THEME),ar(x,v="xl/styles.xml",m1(s,c)),g.styles.push(v),mo(c.wbrels,-1,"styles.xml",wr.STY),s.vbaraw&&h&&(ar(x,v="xl/vbaProject.bin",s.vbaraw),g.vba.push(v),mo(c.wbrels,-1,"vbaProject.bin",wr.VBA)),ar(x,v="xl/metadata.xml",x1()),g.metadata.push(v),mo(c.wbrels,-1,"metadata.xml",wr.XLMETA),1<L.length&&(ar(x,v="xl/persons/person.xml",(h=L,_=[Ke,mn("personList",null,{xmlns:fa.TCMNT,"xmlns:x":$c[0]}).replace(/[\/]>/,">")],h.forEach(function(Y,he){_.push(mn("person",null,{displayName:Y,id:"{54EE7950-7262-4200-6969-"+("000000000000"+he).slice(-12)+"}",userId:Y,providerId:"None"}))}),_.push("</personList>"),_.join(""))),g.people.push(v),mo(c.wbrels,-1,"persons/person.xml",wr.PEOPLE)),ar(x,"[Content_Types].xml",Xp(g,c)),ar(x,"_rels/.rels",Li(c.rels)),ar(x,"xl/_rels/workbook.xml.rels",Li(c.wbrels)),delete c.revssf,delete c.ssf,x}function X1(s,c){var u="";switch((c||{}).type||"base64"){case"buffer":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];case"base64":u=K(s.slice(0,12));break;case"binary":u=s;break;case"array":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];default:throw new Error("Unrecognized type "+(c&&c.type||"undefined"))}return[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3),u.charCodeAt(4),u.charCodeAt(5),u.charCodeAt(6),u.charCodeAt(7)]}function J1(s,c){var u=0;e:for(;u<s.length;)switch(s.charCodeAt(u)){case 10:case 13:case 32:++u;break;case 60:return Os(s.slice(u),c);default:break e}return mc.to_workbook(s,c)}function Z1(s,c,u,h){return h?(u.type="string",mc.to_workbook(s,u)):mc.to_workbook(c,u)}function bf(s,c){R();var u=c||{};if(typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer)return bf(new Uint8Array(s),((u=qr(u)).type="array",u));typeof Uint8Array<"u"&&s instanceof Uint8Array&&!u.type&&(u.type=typeof Deno<"u"?"buffer":"array");var h,g,x,v,S,T=s,k=!1;if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),au={},u.dateNF&&(au.dateNF=u.dateNF),u.type||(u.type=W&&Buffer.isBuffer(s)?"buffer":"base64"),u.type=="file"&&(u.type=W?"buffer":"binary",T=(function(L){if(Zt!==void 0)return Zt.readFileSync(L);if(typeof Deno<"u")return Deno.readFileSync(L);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var B=File(L);B.open("r"),B.encoding="binary";var z=B.read();return B.close(),z}catch(Z){if(!Z.message||!Z.message.match(/onstruct/))throw Z}throw new Error("Cannot access file "+L)})(s),typeof Uint8Array>"u"||W||(u.type="array")),u.type=="string"&&(k=!0,u.type="binary",u.codepage=65001,T=(_=s).match(/[^\x00-\x7F]/)?ks(_):_),u.type=="array"&&typeof Uint8Array<"u"&&s instanceof Uint8Array&&typeof ArrayBuffer<"u"){var _=new ArrayBuffer(3),_=new Uint8Array(_);if(_.foo="bar",!_.foo)return(u=qr(u)).type="array",bf(N(T),u)}switch((h=X1(T,u))[0]){case 208:if(h[1]===207&&h[2]===17&&h[3]===224&&h[4]===161&&h[5]===177&&h[6]===26&&h[7]===225)return v=$t.read(T,u),S=u,($t.find(v,"EncryptedPackage")?Do:Bh)(v,S);break;case 9:if(h[1]<=8)return Bh(T,u);break;case 60:return Os(T,u);case 73:if(h[1]===73&&h[2]===42&&h[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(h[1]===68)return(function(L,B){var z=B||{},Z=!!z.WTF;z.WTF=!0;try{var G=uh.to_workbook(L,z);return z.WTF=Z,G}catch(me){if(z.WTF=Z,!me.message.match(/SYLK bad record ID/)&&Z)throw me;return mc.to_workbook(L,B)}})(T,u);break;case 84:if(h[1]===65&&h[2]===66&&h[3]===76)return qg.to_workbook(T,u);break;case 80:return h[1]===75&&h[2]<9&&h[3]<9?(x=S=T,(g=(g=u)||{}).type||(g.type=W&&Buffer.isBuffer(S)?"buffer":"base64"),q1(Vs(x,g),g)):Z1(s,T,u,k);case 239:return h[3]===60?Os(T,u):Z1(s,T,u,k);case 255:if(h[1]===254)return x=T,(g=u).type=="base64"&&(x=K(x)),x=n.utils.decode(1200,x.slice(2),"str"),g.type="binary",J1(x,g);if(h[1]===0&&h[2]===2&&h[3]===0)return Va.to_workbook(T,u);break;case 0:if(h[1]===0&&(2<=h[2]&&h[3]===0||h[2]===0&&(h[3]===8||h[3]===9)))return Va.to_workbook(T,u);break;case 3:case 131:case 139:case 140:return d0.to_workbook(T,u);case 123:if(h[1]===92&&h[2]===114&&h[3]===116)return w0.to_workbook(T,u);break;case 10:case 13:case 32:return(function(L,B){var z="",Z=X1(L,B);switch(B.type){case"base64":z=K(L);break;case"binary":z=L;break;case"buffer":z=L.toString("binary");break;case"array":z=aa(L);break;default:throw new Error("Unrecognized type "+B.type)}return Z[0]==239&&Z[1]==187&&Z[2]==191&&(z=po(z)),B.type="binary",J1(z,B)})(T,u);case 137:if(h[1]===80&&h[2]===78&&h[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<qu.indexOf(h[0])&&h[2]<=12&&h[3]<=31?d0.to_workbook(T,u):Z1(s,T,u,k)}function sm(s,c){return c=c||{},c.type="file",bf(s,c)}function Vh(s,c){switch(c.type){case"base64":case"binary":break;case"buffer":case"array":c.type="";break;case"file":return tr(c.file,$t.write(s,{type:W?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+c.bookType+"' files");default:throw new Error("Unrecognized type "+c.type)}return $t.write(s,c)}function ey(s,c){var u={},h=W?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(c.compression&&(u.compression="DEFLATE"),c.password)u.type=h;else switch(c.type){case"base64":u.type="base64";break;case"binary":u.type="string";break;case"string":throw new Error("'string' output type invalid for '"+c.bookType+"' files");case"buffer":case"file":u.type=h;break;default:throw new Error("Unrecognized type "+c.type)}if(s=s.FullPaths?$t.write(s,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[u.type]||u.type,compression:!!c.compression}):s.generate(u),typeof Deno<"u"&&typeof s=="string"){if(c.type=="binary"||c.type=="base64")return s;s=new Uint8Array(le(s))}return c.password&&typeof encrypt_agile<"u"?Vh(encrypt_agile(s,c.password),c):c.type==="file"?tr(c.file,s):c.type=="string"?po(s):s}function pl(s,c,u){var h=(u=u||"")+s;switch(c.type){case"base64":return H(ks(h));case"binary":return ks(h);case"string":return s;case"file":return tr(c.file,h,"utf8");case"buffer":return W?X(h,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(h):pl(h,{type:"binary"}).split("").map(function(g){return g.charCodeAt(0)})}throw new Error("Unrecognized type "+c.type)}function vf(s,c){switch(c.type){case"string":case"base64":case"binary":for(var u="",h=0;h<s.length;++h)u+=String.fromCharCode(s[h]);return c.type=="base64"?H(u):c.type=="string"?po(u):u;case"file":return tr(c.file,s);case"buffer":return s;default:throw new Error("Unrecognized type "+c.type)}}function Gh(s,c){R(),Tc(s);var u,h=qr(c||{});return h.cellStyles&&(h.cellNF=!0,h.sheetStubs=!0),h.type!="array"?(u=s,c=qr((c=h)||{}),ey(ls(u,c),c)):(h.type="binary",s=Gh(s,h),h.type="array",le(s))}function im(s,c){R(),Tc(s);var u=qr(c||{});if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),u.type=="array")return u.type="binary",c=im(s,u),u.type="array",le(c);var h,g,x,v=0;if(u.sheet&&(v=typeof u.sheet=="number"?u.sheet:s.SheetNames.indexOf(u.sheet),!s.SheetNames[v]))throw new Error("Sheet not found: "+u.sheet+" : "+typeof u.sheet);switch(u.bookType||"xlsb"){case"xml":case"xlml":return pl(cu(s,u),u);case"slk":case"sylk":return pl(uh.from_sheet(s.Sheets[s.SheetNames[v]],u),u);case"htm":case"html":return pl(ox(s.Sheets[s.SheetNames[v]],u),u);case"txt":return(function(S,T){switch(T.type){case"base64":return H(S);case"binary":case"string":return S;case"file":return tr(T.file,S,"binary");case"buffer":return W?X(S,"binary"):S.split("").map(function(k){return k.charCodeAt(0)})}throw new Error("Unrecognized type "+T.type)})(ny(s.Sheets[s.SheetNames[v]],u),u);case"csv":return pl(um(s.Sheets[s.SheetNames[v]],u),u,"\uFEFF");case"dif":return pl(qg.from_sheet(s.Sheets[s.SheetNames[v]],u),u);case"dbf":return vf(d0.from_sheet(s.Sheets[s.SheetNames[v]],u),u);case"prn":return pl(mc.from_sheet(s.Sheets[s.SheetNames[v]],u),u);case"rtf":return pl(w0.from_sheet(s.Sheets[s.SheetNames[v]],u),u);case"eth":return pl(qd.from_sheet(s.Sheets[s.SheetNames[v]],u),u);case"fods":return pl(Ac(s,u),u);case"wk1":return vf(Va.sheet_to_wk1(s.Sheets[s.SheetNames[v]],u),u);case"wk3":return vf(Va.book_to_wk3(s,u),u);case"biff2":u.biff||(u.biff=2);case"biff3":u.biff||(u.biff=3);case"biff4":return u.biff||(u.biff=4),vf(U1(s,u),u);case"biff5":u.biff||(u.biff=5);case"biff8":case"xla":case"xls":return u.biff||(u.biff=8),Vh(q0(s,x=(x=u)||{}),x);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return h=s,x=qr((g=u)||{}),wh=new hx(g),ey(Q1(h,x),x);default:throw new Error("Unrecognized bookType |"+u.bookType+"|")}}function lm(s){var c;s.bookType||((c=s.file.slice(s.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(s.bookType=c.slice(1)),s.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[s.bookType]||s.bookType)}function dx(s,c,u){return u=u||{},u.type="file",u.file=c,lm(u),im(s,u)}function ty(s,c,u,h,g,x,v,S){var T=sa(u),k=S.defval,_=S.raw||!Object.prototype.hasOwnProperty.call(S,"raw"),L=!0,B=g===1?[]:{};if(g!==1)if(Object.defineProperty)try{Object.defineProperty(B,"__rowNum__",{value:u,enumerable:!1})}catch{B.__rowNum__=u}else B.__rowNum__=u;if(!v||s[u])for(var z=c.s.c;z<=c.e.c;++z){var Z=v?s[u][z]:s[h[z]+T];if(Z!==void 0&&Z.t!==void 0){var G=Z.v;switch(Z.t){case"z":if(G==null)break;continue;case"e":G=G==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+Z.t)}if(x[z]!=null){if(G==null)if(Z.t=="e"&&G===null)B[x[z]]=null;else if(k!==void 0)B[x[z]]=k;else{if(!_||G!==null)continue;B[x[z]]=null}else B[x[z]]=_&&(Z.t!=="n"||Z.t==="n"&&S.rawNumbers!==!1)?G:Dl(Z,G,S);G!=null&&(L=!1)}}else k!==void 0&&x[z]!=null&&(B[x[z]]=k)}return{row:B,isempty:L}}function cm(s,c){if(s==null||s["!ref"]==null)return[];var u,h={t:"n",v:0},g=0,x=1,v=[],S="",T={s:{r:0,c:0},e:{r:0,c:0}},k=c||{},_=k.range!=null?k.range:s["!ref"];switch(k.header===1?g=1:k.header==="A"?g=2:Array.isArray(k.header)?g=3:k.header==null&&(g=0),typeof _){case"string":T=Ir(_);break;case"number":(T=Ir(s["!ref"])).s.r=_;break;default:T=_}0<g&&(x=0);var L=sa(T.s.r),B=[],z=[],Z=0,G=0,me=Array.isArray(s),re=T.s.r,Y=0,he={};me&&!s[re]&&(s[re]=[]);for(var Ce,we=k.skipHidden&&s["!cols"]||[],$e=k.skipHidden&&s["!rows"]||[],Y=T.s.c;Y<=T.e.c;++Y)if(!(we[Y]||{}).hidden)switch(B[Y]=Yo(Y),h=me?s[re][Y]:s[B[Y]+L],g){case 1:v[Y]=Y-T.s.c;break;case 2:v[Y]=B[Y];break;case 3:v[Y]=k.header[Y-T.s.c];break;default:if(S=u=Dl(h=h??{w:"__EMPTY",t:"s"},null,k),G=he[u]||0){for(;S=u+"_"+G++,he[S];);he[u]=G,he[S]=1}else he[u]=1;v[Y]=S}for(re=T.s.r+x;re<=T.e.r;++re)($e[re]||{}).hidden||(Ce=ty(s,T,re,B,g,v,me,k)).isempty!==!1&&(g===1?k.blankrows===!1:!k.blankrows)||(z[Z++]=Ce.row);return z.length=Z,z}var fx=/"/g;function Dc(s,c,u,h,g,x,v,S){for(var T=!0,k=[],_="",L=sa(u),B=c.s.c;B<=c.e.c;++B)if(h[B]){var z=S.dense?(s[u]||[])[B]:s[h[B]+L];if(z==null)_="";else if(z.v!=null){T=!1,_=""+(S.rawNumbers&&z.t=="n"?z.v:Dl(z,null,S));for(var Z,G=0;G!==_.length;++G)if((Z=_.charCodeAt(G))===g||Z===x||Z===34||S.forceQuotes){_='"'+_.replace(fx,'""')+'"';break}_=="ID"&&(_='"ID"')}else z.f==null||z.F?_="":(T=!1,0<=(_="="+z.f).indexOf(",")&&(_='"'+_.replace(fx,'""')+'"'));k.push(_)}return S.blankrows===!1&&T?null:k.join(v)}function um(s,c){var u=[],h=c??{};if(s==null||s["!ref"]==null)return"";var g=Ir(s["!ref"]),x=h.FS!==void 0?h.FS:",",v=x.charCodeAt(0),S=h.RS!==void 0?h.RS:`
`,T=S.charCodeAt(0),k=new RegExp((x=="|"?"\\|":x)+"+$"),_="",L=[];h.dense=Array.isArray(s);for(var B=h.skipHidden&&s["!cols"]||[],z=h.skipHidden&&s["!rows"]||[],Z=g.s.c;Z<=g.e.c;++Z)(B[Z]||{}).hidden||(L[Z]=Yo(Z));for(var G=0,me=g.s.r;me<=g.e.r;++me)(z[me]||{}).hidden||(_=Dc(s,g,me,L,v,T,x,h))!=null&&(!(_=h.strip?_.replace(k,""):_)&&h.blankrows===!1||u.push((G++?S:"")+_));return delete h.dense,u.join("")}function ny(s,c){return(c=c||{}).FS="	",c.RS=`
`,s=um(s,c),n===void 0||c.type=="string"?s:(s=n.utils.encode(1200,s,"str"),""+s)}function dm(_,c,u){var h,g=u||{},x=+!g.skipHeader,v=_||{},S=0,T=0;v&&g.origin!=null&&(typeof g.origin=="number"?S=g.origin:(k=typeof g.origin=="string"?ia(g.origin):g.origin,S=k.r,T=k.c));var k,_={s:{c:0,r:0},e:{c:T,r:S+c.length-1+x}};v["!ref"]?(k=Ir(v["!ref"]),_.e.c=Math.max(_.e.c,k.e.c),_.e.r=Math.max(_.e.r,k.e.r),S==-1&&(S=k.e.r+1,_.e.r=S+c.length-1+x)):S==-1&&(S=0,_.e.r=c.length-1+x);var L=g.header||[],B=0;c.forEach(function(Z,G){Bt(Z).forEach(function(Ce){(B=L.indexOf(Ce))==-1&&(L[B=L.length]=Ce);var re=Z[Ce],Y="z",he="",Ce=yr({c:T+B,r:S+G+x});h=fm(v,Ce),!re||typeof re!="object"||re instanceof Date?(typeof re=="number"?Y="n":typeof re=="boolean"?Y="b":typeof re=="string"?Y="s":re instanceof Date?(Y="d",g.cellDates||(Y="n",re=En(re)),he=g.dateNF||ae[14]):re===null&&g.nullError&&(Y="e",re=0),h?(h.t=Y,h.v=re,delete h.w,delete h.R,he&&(h.z=he)):v[Ce]=h={t:Y,v:re},he&&(h.z=he)):v[Ce]=re})}),_.e.c=Math.max(_.e.c,T+L.length-1);var z=sa(S);if(x)for(B=0;B<L.length;++B)v[Yo(B+T)+z]={t:"s",v:L[B]};return v["!ref"]=Tr(_),v}function fm(s,c,u){return typeof c!="string"?fm(s,yr(typeof c!="number"?c:{r:c,c:u||0})):Array.isArray(s)?(u=ia(c),s[u.r]||(s[u.r]=[]),s[u.r][u.c]||(s[u.r][u.c]={t:"z"})):s[c]||(s[c]={t:"z"})}function ry(){return{SheetNames:[],Sheets:{}}}function hm(s,c,u,h){var g=1;if(!u)for(;g<=65535&&s.SheetNames.indexOf(u="Sheet"+g)!=-1;++g,u=void 0);if(!u||65535<=s.SheetNames.length)throw new Error("Too many worksheets");if(h&&0<=s.SheetNames.indexOf(u)){var h=u.match(/(^.*?)(\d+)$/),g=h&&+h[2]||0,x=h&&h[1]||u;for(++g;g<=65535&&s.SheetNames.indexOf(u=x+g)!=-1;++g);}if(la(u),0<=s.SheetNames.indexOf(u))throw new Error("Worksheet with name |"+u+"| already exists!");return s.SheetNames.push(u),s.Sheets[u]=c,u}function pm(s,c,u){return c?(s.l={Target:c},u&&(s.l.Tooltip=u)):delete s.l,s}var xf,oy={encode_col:Yo,encode_row:sa,encode_cell:yr,encode_range:Tr,decode_col:Wc,decode_row:Wp,split_cell:function(s){return s.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ia,decode_range:Cs,format_cell:Dl,sheet_add_aoa:Og,sheet_add_json:dm,sheet_add_dom:W1,aoa_to_sheet:ju,json_to_sheet:function(s,c){return dm(null,s,c)},table_to_sheet:ax,table_to_book:function(s,c){return rl(ax(s,c),c)},sheet_to_csv:um,sheet_to_txt:ny,sheet_to_json:cm,sheet_to_html:ox,sheet_to_formulae:function(s){var c,u="",h="";if(s==null||s["!ref"]==null)return[];for(var g,x=Ir(s["!ref"]),v=[],S=[],T=Array.isArray(s),k=x.s.c;k<=x.e.c;++k)v[k]=Yo(k);for(var _=x.s.r;_<=x.e.r;++_)for(g=sa(_),k=x.s.c;k<=x.e.c;++k)if(u=v[k]+g,h="",(c=T?(s[_]||[])[k]:s[u])!==void 0){if(c.F!=null){if(u=c.F,!c.f)continue;h=c.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(c.f!=null)h=c.f;else{if(c.t=="z")continue;if(c.t=="n"&&c.v!=null)h=""+c.v;else if(c.t=="b")h=c.v?"TRUE":"FALSE";else if(c.w!==void 0)h="'"+c.w;else{if(c.v===void 0)continue;h=c.t=="s"?"'"+c.v:""+c.v}}S[S.length]=u+"="+h}return S},sheet_to_row_object_array:cm,sheet_get_cell:fm,book_new:ry,book_append_sheet:hm,book_set_sheet_visibility:function(s,c,u){switch(s.Workbook||(s.Workbook={}),s.Workbook.Sheets||(s.Workbook.Sheets=[]),c=(function(h,g){if(typeof g=="number"){if(0<=g&&h.SheetNames.length>g)return g;throw new Error("Cannot find sheet # "+g)}if(typeof g!="string")throw new Error("Cannot find sheet |"+g+"|");if(-1<(h=h.SheetNames.indexOf(g)))return h;throw new Error("Cannot find sheet name |"+g+"|")})(s,c),s.Workbook.Sheets[c]||(s.Workbook.Sheets[c]={}),u){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+u)}s.Workbook.Sheets[c].Hidden=u},cell_set_number_format:function(s,c){return s.z=c,s},cell_set_hyperlink:pm,cell_set_internal_link:function(s,c,u){return pm(s,"#"+c,u)},cell_add_comment:function(s,c,u){s.c||(s.c=[]),s.c.push({t:c,a:u||"SheetJS"})},sheet_set_array_formula:function(s,c,u,h){for(var g=typeof c!="string"?c:Ir(c),x=typeof c=="string"?c:Tr(c),v=g.s.r;v<=g.e.r;++v)for(var S=g.s.c;S<=g.e.c;++S){var T=fm(s,v,S);T.t="n",T.F=x,delete T.v,v==g.s.r&&S==g.s.c&&(T.f=u,h&&(T.D=!0))}return s},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function xi(s){xf=s}var uu={to_json:function(s,c){var u=xf({objectMode:!0});if(s==null||s["!ref"]==null)return u.push(null),u;var h,g={t:"n",v:0},x=0,v=1,S=[],T="",k={s:{r:0,c:0},e:{r:0,c:0}},_=c||{},L=_.range!=null?_.range:s["!ref"];switch(_.header===1?x=1:_.header==="A"?x=2:Array.isArray(_.header)&&(x=3),typeof L){case"string":k=Ir(L);break;case"number":(k=Ir(s["!ref"])).s.r=L;break;default:k=L}0<x&&(v=0);var B=sa(k.s.r),z=[],Z=0,G=Array.isArray(s),me=k.s.r,re=0,Y={};G&&!s[me]&&(s[me]=[]);for(var he=_.skipHidden&&s["!cols"]||[],Ce=_.skipHidden&&s["!rows"]||[],re=k.s.c;re<=k.e.c;++re)if(!(he[re]||{}).hidden)switch(z[re]=Yo(re),g=G?s[me][re]:s[z[re]+B],x){case 1:S[re]=re-k.s.c;break;case 2:S[re]=z[re];break;case 3:S[re]=_.header[re-k.s.c];break;default:if(T=h=Dl(g=g??{w:"__EMPTY",t:"s"},null,_),Z=Y[h]||0){for(;T=h+"_"+Z++,Y[T];);Y[h]=Z,Y[T]=1}else Y[h]=1;S[re]=T}return me=k.s.r+v,u._read=function(){for(;me<=k.e.r;)if(!(Ce[me-1]||{}).hidden){var we=ty(s,k,me,z,x,S,G,_);if(++me,we.isempty===!1||(x===1?_.blankrows!==!1:_.blankrows))return void u.push(we.row)}return u.push(null)},u},to_html:function(s,g){var u=xf(),h=g||{},g=h.header!=null?h.header:H1,x=h.footer!=null?h.footer:go;u.push(g);var v=Cs(s["!ref"]);h.dense=Array.isArray(s),u.push(X0(0,0,h));var S=v.s.r,T=!1;return u._read=function(){if(S>v.e.r)return T||(T=!0,u.push("</table>"+x)),u.push(null);for(;S<=v.e.r;){u.push($1(s,v,S,h)),++S;break}},u},to_csv:function(s,c){var u=xf(),h=c??{};if(s==null||s["!ref"]==null)return u.push(null),u;var g=Ir(s["!ref"]),x=h.FS!==void 0?h.FS:",",v=x.charCodeAt(0),S=h.RS!==void 0?h.RS:`
`,T=S.charCodeAt(0),k=new RegExp((x=="|"?"\\|":x)+"+$"),_="",L=[];h.dense=Array.isArray(s);for(var B=h.skipHidden&&s["!cols"]||[],z=h.skipHidden&&s["!rows"]||[],Z=g.s.c;Z<=g.e.c;++Z)(B[Z]||{}).hidden||(L[Z]=Yo(Z));var G=g.s.r,me=!1,re=0;return u._read=function(){if(!me)return me=!0,u.push("\uFEFF");for(;G<=g.e.r;)if(++G,!(z[G-1]||{}).hidden&&(_=Dc(s,g,G-1,L,v,T,x,h),_!=null&&((_=h.strip?_.replace(k,""):_)||h.blankrows!==!1)))return u.push((re++?S:"")+_);return u.push(null)},u},set_readable:xi},Yr=(function(){function s(c,u,h){return this instanceof s?(this.tagName=c,this._attributes=u||{},this._children=h||[],this._prefix="",this):new s(c,u,h)}return s.prototype.createElement=function(){return new s(arguments)},s.prototype.children=function(){return this._children},s.prototype.append=function(c){return this._children.push(c),this},s.prototype.prefix=function(c){return arguments.length==0?this._prefix:(this._prefix=c,this)},s.prototype.attr=function(c,u){if(u==null)return delete this._attributes[c],this;if(arguments.length==0)return this._attributes;if(typeof c=="string"&&arguments.length==1)return this._attributes.attr[c];if(typeof c=="object"&&arguments.length==1)for(var h in c)this._attributes[h]=c[h];else arguments.length==2&&typeof c=="string"&&(this._attributes[c]=u);return this},s.prototype.escapeAttributeValue=function(c){return'"'+c.replace(/\"/g,"&quot;")+'"'},s.prototype.toXml=function(c){var u=(c=c||this)._prefix;if(u+="<"+c.tagName,c._attributes)for(var h in c._attributes)u+=" "+h+"="+this.escapeAttributeValue(""+c._attributes[h]);if(c._children&&0<c._children.length){u+=">";for(var g=0;g<c._children.length;g++)u+=this.toXml(c._children[g]);u+="</"+c.tagName+">"}else u+="/>";return u},s})(),hx=function(s){var c,u=164,h={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},g={};for(c in h)g[h[c]]=c;var x={};return{initialize:function(v){this.$fonts=Yr("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=Yr("fills").attr("count",0),this.$borders=Yr("borders").attr("count",0),this.$numFmts=Yr("numFmts").attr("count",0),this.$cellStyleXfs=Yr("cellStyleXfs"),this.$xf=Yr("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=Yr("cellXfs").attr("count",0),this.$cellStyles=Yr("cellStyles").append(Yr("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=Yr("dxfs").attr("count","0"),this.$tableStyles=Yr("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=Yr("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var S=v.defaultCellStyle||{};return S.font||(S.font={name:"Calibri",sz:"11"}),S.font.name||(S.font.name="Calibri"),S.font.sz||(S.font.sz=11),S.fill||(S.fill={patternType:"none",fgColor:{}}),S.border||(S.border={}),S.numFmt||(S.numFmt=0),this.defaultStyle=S,v=JSON.parse(JSON.stringify(S)),v.fill={patternType:"gray125",fgColor:{}},this.addStyles([S,v]),this},addStyle:function(v){var S=JSON.stringify(v),T=x[S];return T==null?(T=this._addXf(v),x[S]=T):T=x[S],T},addStyles:function(v){var S=this;return v.map(function(T){return S.addStyle(T)})},_duckTypeStyle:function(v){return typeof v=="object"&&(v.patternFill||v.fgColor)?{fill:v}:v.font||v.numFmt||v.border||v.fill?v:this._getStyleCSS(v)},_getStyleCSS:function(v){return v},_addXf:function(v){var S=this._addFont(v.font),T=this._addFill(v.fill),k=this._addBorder(v.border),_=this._addNumFmt(v.numFmt),L=Yr("xf").attr("numFmtId",_).attr("fontId",S).attr("fillId",T).attr("borderId",k).attr("xfId","0");return 0<S&&L.attr("applyFont","1"),0<T&&L.attr("applyFill","1"),0<k&&L.attr("applyBorder","1"),0<_&&L.attr("applyNumberFormat","1"),v.alignment&&(_=Yr("alignment"),v.alignment.horizontal&&_.attr("horizontal",v.alignment.horizontal),v.alignment.vertical&&_.attr("vertical",v.alignment.vertical),v.alignment.indent&&_.attr("indent",v.alignment.indent),v.alignment.readingOrder&&_.attr("readingOrder",v.alignment.readingOrder),v.alignment.wrapText&&_.attr("wrapText",v.alignment.wrapText),v.alignment.textRotation!=null&&_.attr("textRotation",v.alignment.textRotation),L.append(_).attr("applyAlignment",1)),this.$cellXfs.append(L),L=+this.$cellXfs.children().length,this.$cellXfs.attr("count",L),L-1},_addFont:function(v){if(!v)return 0;var S=Yr("font").append(Yr("sz").attr("val",v.sz||this.defaultStyle.font.sz)).append(Yr("name").attr("val",v.name||this.defaultStyle.font.name));return v.bold&&S.append(Yr("b")),v.underline&&S.append(Yr("u")),v.italic&&S.append(Yr("i")),v.strike&&S.append(Yr("strike")),v.outline&&S.append(Yr("outline")),v.shadow&&S.append(Yr("shadow")),v.vertAlign&&S.append(Yr("vertAlign").attr("val",v.vertAlign)),v.color&&(v.color.theme?(S.append(Yr("color").attr("theme",v.color.theme)),v.color.tint&&S.append(Yr("tint").attr("theme",v.color.tint))):v.color.rgb&&S.append(Yr("color").attr("rgb",v.color.rgb))),this.$fonts.append(S),S=this.$fonts.children().length,this.$fonts.attr("count",S),S-1},_addNumFmt:function(v){if(!v)return 0;if(typeof v=="string"){var S=g[v];if(0<=S)return S}return/^[0-9]+$/.exec(v)?v:(v=v.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),v=Yr("numFmt").attr("numFmtId",++u).attr("formatCode",v),this.$numFmts.append(v),v=this.$numFmts.children().length,this.$numFmts.attr("count",v),u)},_addFill:function(v){if(!v)return 0;var S,T=Yr("patternFill").attr("patternType",v.patternType||"solid");return v.fgColor&&(S=Yr("fgColor"),v.fgColor.rgb?(v.fgColor.rgb.length==6&&(v.fgColor.rgb="FF"+v.fgColor.rgb),S.attr("rgb",v.fgColor.rgb),T.append(S)):v.fgColor.theme&&(S.attr("theme",v.fgColor.theme),v.fgColor.tint&&S.attr("tint",v.fgColor.tint),T.append(S)),v.bgColor||(v.bgColor={indexed:"64"})),v.bgColor&&(v=Yr("bgColor").attr(v.bgColor),T.append(v)),T=Yr("fill").append(T),this.$fills.append(T),T=this.$fills.children().length,this.$fills.attr("count",T),T-1},_getSubBorder:function(v,S){var T=Yr(v);return S&&(T.attr("style",S.style||"medium"),S.color&&(v=Yr("color"),S.color.auto?v.attr("auto",S.color.auto):S.color.rgb?v.attr("rgb",S.color.rgb):(S.color.theme||S.color.tint)&&(v.attr("theme",S.color.theme||"1"),v.attr("tint",S.color.tint||"0")),T.append(v))),T},_addBorder:function(v){if(!v)return 0;var S=this,T=Yr("border").attr("diagonalUp",v.diagonalUp).attr("diagonalDown",v.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(_){T.append(S._getSubBorder(_,v[_]))}),this.$borders.append(T);var k=this.$borders.children().length;return this.$borders.attr("count",k),k-1},toXml:function(){return this.$styles.toXml()}}.initialize(s||{})};Bh!==void 0&&(o.parse_xlscfb=Bh),o.parse_zip=q1,o.read=bf,o.readFile=sm,o.readFileSync=sm,o.write=im,o.writeFile=dx,o.writeFileSync=dx,o.writeFileAsync=function(s,c,u,h){var g=u||{};return g.type="file",g.file=s,lm(g),g.type="buffer",h instanceof Function||(h=u),Zt.writeFile(s,im(c,g),h)},o.utils=oy,o.writeXLSX=Gh,o.writeFileXLSX=function(s,c,u){return(u=u||{}).type="file",u.file=c,lm(u),Gh(s,u)},o.SSF=qt,uu!==void 0&&(o.stream=uu),$t!==void 0&&(o.CFB=$t),typeof d2>"u"||((uu=Ow)||{}).Readable&&xi(uu.Readable)}if(a(e),typeof window<"u"&&!window.XLSX)try{window.XLSX=r}catch{}})($x,$x.exports)),$x.exports}var lo=Sie();const wie=hb(lo),qR=ZR({__proto__:null,default:wie},[lo]),QR=["Staff","SME"],XR=["Mon-Fri","Sun-Thu"];function Tie(){const t=Dd(),e=E.useRef(null),{getPagePermissions:r}=Gf(),a=r("resources"),[o,n]=E.useState({open:!1,message:"",severity:"success"}),[f,m]=E.useState(""),[y,C]=E.useState("all"),[w,A]=E.useState("all"),[R,I]=E.useState(null),M=(N,ce="success")=>{n({open:!0,message:N,severity:ce})},F=()=>{try{const N=le.map(se=>({Name:se.Name||"",Type:se.ResourceType||"",Entity:se.EntityName||se.Entity||"","Vendor Account":se.DynamicsVendorAcc||"","Start Date":se.StartDate?In(new Date(se.StartDate),"yyyy-MM-dd"):"","End Date":se.EndDate?In(new Date(se.EndDate),"yyyy-MM-dd"):"","Work Days":se.WorkDays||"",Department:se.Department||""})),ce=lo.utils.json_to_sheet(N),ne=lo.utils.book_new();lo.utils.book_append_sheet(ne,ce,"Resources");const Se=[{wch:20},{wch:10},{wch:15},{wch:15},{wch:12},{wch:12},{wch:10},{wch:15}];ce["!cols"]=Se,lo.writeFile(ne,`resources_${In(new Date,"yyyy-MM-dd")}.xlsx`),M("Resources downloaded successfully!","success")}catch{M("Error downloading Excel file","error")}},O=N=>{const ce=N.target.files?.[0];if(!ce)return;const ne=new FileReader;ne.onload=Se=>{try{const se=new Uint8Array(Se.target?.result),ye=lo.read(se,{type:"array"}),ze=ye.Sheets[ye.SheetNames[0]],Re=lo.utils.sheet_to_json(ze);let ve=0,V=0;Re.forEach(ue=>{try{const Ee={Name:ue.Name||"",ResourceType:ue.Type||"",Entity:ue.Entity||"",DynamicsVendorAcc:ue["Vendor Account"]||"",StartDate:ue["Start Date"]?new Date(ue["Start Date"]).toISOString().split("T")[0]:"",EndDate:ue["End Date"]?new Date(ue["End Date"]).toISOString().split("T")[0]:null,WorkDays:ue["Work Days"]||"",Department:ue.Department||""};Ee.Name&&Ee.ResourceType&&Ee.Entity&&Ee.StartDate&&Ee.WorkDays&&Ee.Department?(H.mutate(Ee),ve++):V++}catch{V++}}),M(`Upload completed: ${ve} resources added, ${V} failed`,ve>0?"success":"error")}catch{M("Error reading Excel file","error")}},ne.readAsArrayBuffer(ce),e.current&&(e.current.value="")},{data:j}=zs({queryKey:["resources"],queryFn:o_,staleTime:1e3*60*5}),{data:U}=zs({queryKey:["entities"],queryFn:ck,staleTime:1e3*60*5}),H=Ua({mutationFn:N=>Cee(N),onSuccess:()=>{t.invalidateQueries({queryKey:["resources"]}),M("Resource created successfully!","success")},onError:N=>{M(`Error creating resource: ${N.message}`,"error")}}),K=Ua({mutationFn:({id:N,payload:ce})=>See(N,ce),onSuccess:()=>{t.invalidateQueries({queryKey:["resources"]}),M("Resource updated successfully!","success")},onError:N=>{M(`Error updating resource: ${N.message}`,"error")}}),W=Ua({mutationFn:N=>wee(N),onSuccess:()=>{t.invalidateQueries({queryKey:["resources"]}),M("Resource deleted successfully!","success")},onError:N=>{console.log("=== DELETE ERROR DEBUG ==="),console.log("Full error object:",N),console.log("error.response:",N.response),console.log("error.response?.data:",N.response?.data),console.log("error.response?.data?.details:",N.response?.data?.details),console.log("error.response?.data?.error:",N.response?.data?.error),console.log("error.message:",N.message),console.log("========================");let ce="Failed to delete resource";N.response?.data?(console.log("Using response.data"),ce=N.response.data.details||N.response.data.error||N.response.data.message||ce):N.message&&(console.log("Using error.message"),ce=N.message),console.log("Final error message:",ce),M(ce,"error")}}),[X,ee]=E.useState({Name:"",ResourceType:"",Entity:"",DynamicsVendorAcc:"",StartDate:"",EndDate:null,WorkDays:"",Department:""}),ie=j??[],de=U??[],le=E.useMemo(()=>ie.filter(N=>{const ce=N.Name?.toLowerCase().includes(f.toLowerCase())||N.Department?.toLowerCase().includes(f.toLowerCase())||N.DynamicsVendorAcc?.toLowerCase().includes(f.toLowerCase())||N.EntityName?.toLowerCase().includes(f.toLowerCase()),ne=y==="all"||y==="staff"&&N.ResourceType==="Staff"||y==="sme"&&N.ResourceType==="SME",Se=w==="all"||N.Entity===w;return ce&&ne&&Se}).sort((N,ce)=>{const ne=N.StartDate?new Date(N.StartDate).getTime():0;return(ce.StartDate?new Date(ce.StartDate).getTime():0)-ne}),[ie,f,y,w]),oe=()=>{if(!X.Name||!X.ResourceType||!X.Entity||!X.StartDate||!X.WorkDays||!X.Department){M("Please fill in all required fields!","error");return}H.mutate(X),ee({Name:"",ResourceType:"",Entity:"",DynamicsVendorAcc:"",StartDate:"",EndDate:null,WorkDays:"",Department:""})};return d.jsx(Nb,{dateAdapter:TS,children:d.jsxs(_e,{sx:{p:2,backgroundColor:"#f8f9fa",minHeight:"100vh"},children:[d.jsxs(_e,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx(We,{variant:"h5",component:"h1",sx:{fontWeight:"bold",color:"#333"},children:"Resources"}),d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:1},children:[d.jsx(Un,{variant:"outlined",size:"small",startIcon:d.jsx(yp,{}),onClick:F,sx:{fontSize:"0.75rem"},children:"Download Excel"}),d.jsx(Un,{variant:"outlined",size:"small",startIcon:d.jsx(_C,{}),onClick:()=>e.current?.click(),sx:{fontSize:"0.75rem"},children:"Upload Excel"}),d.jsx("input",{ref:e,type:"file",accept:".xlsx,.xls",onChange:O,style:{display:"none"}}),d.jsx(Sa,{label:`${le.length}/${ie.length}`,color:"primary",variant:"outlined",size:"small"})]})]}),a.canEdit&&d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsxs(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",mb:1,display:"block",color:"#666"},children:"ADD NEW RESOURCE"}),d.jsxs(_e,{sx:{display:"flex",gap:1,mb:.5,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 180px",minWidth:"180px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"NAME *"})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"TYPE *"})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ENTITY *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"VENDOR ACC"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"START *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"END"})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"WORK DAYS *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"DEPARTMENT *"})}),d.jsx(_e,{sx:{flex:"0 1 60px",minWidth:"60px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ACTION"})})]}),d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:1,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 180px",minWidth:"180px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Resource name",value:X.Name||"",onChange:N=>ee({...X,Name:N.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:X.ResourceType||"",displayEmpty:!0,onChange:N=>ee({...X,ResourceType:N.target.value}),renderValue:N=>N?d.jsx("span",{style:{fontSize:"0.75rem"},children:N}):d.jsx("em",{style:{fontSize:"0.75rem"},children:"Type"}),sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"",children:d.jsx("em",{style:{fontSize:"0.75rem"},children:"Type"})}),QR.map(N=>d.jsx(ln,{value:N,sx:{fontSize:"0.75rem"},children:N},N))]})})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:X.Entity||"",displayEmpty:!0,onChange:N=>ee({...X,Entity:N.target.value}),renderValue:N=>{if(!N)return d.jsx("em",{style:{fontSize:"0.75rem"},children:"Select entity"});const ce=de.find(ne=>ne.ID===N);return d.jsx("span",{style:{fontSize:"0.75rem"},children:ce?.Name||N})},sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"",children:d.jsx("em",{style:{fontSize:"0.75rem"},children:"Select entity"})}),de.map(N=>d.jsx(ln,{value:N.ID,sx:{fontSize:"0.75rem"},children:N.Name},N.ID))]})})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Vendor account",value:X.DynamicsVendorAcc||"",onChange:N=>ee({...X,DynamicsVendorAcc:N.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(Gi,{value:X.StartDate?new Date(X.StartDate):null,onChange:N=>ee({...X,StartDate:N?N.toISOString().split("T")[0]:""}),slotProps:{textField:{size:"small",placeholder:"Start date",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(Gi,{value:X.EndDate?new Date(X.EndDate):null,onChange:N=>ee({...X,EndDate:N?N.toISOString().split("T")[0]:null}),slotProps:{textField:{size:"small",placeholder:"End date",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}}})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:X.WorkDays||"",displayEmpty:!0,onChange:N=>ee({...X,WorkDays:N.target.value}),renderValue:N=>N?d.jsx("span",{style:{fontSize:"0.75rem"},children:N}):d.jsx("em",{style:{fontSize:"0.75rem"},children:"Days"}),sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"",children:d.jsx("em",{style:{fontSize:"0.75rem"},children:"Days"})}),XR.map(N=>d.jsx(ln,{value:N,sx:{fontSize:"0.75rem"},children:N},N))]})})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Department",value:X.Department||"",onChange:N=>ee({...X,Department:N.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 60px",minWidth:"60px"},children:d.jsx(Un,{variant:"contained",fullWidth:!0,onClick:oe,disabled:H.isPending,startIcon:d.jsx(sg,{}),size:"small",sx:{fontSize:"0.75rem",minHeight:"32px"},children:"Add"})})]})]})}),d.jsx(Ta,{sx:{boxShadow:1},children:d.jsxs(Aa,{sx:{p:0,"&:last-child":{pb:0}},children:[d.jsx(_e,{sx:{p:2,borderBottom:1,borderColor:"divider",backgroundColor:"#fafafa"},children:d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 300px",minWidth:"250px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Search resources...",value:f,onChange:N=>m(N.target.value),InputProps:{startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(ig,{})})}})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:w,onChange:N=>A(N.target.value),startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(MC,{})}),children:[d.jsx(ln,{value:"all",children:"All Entities"}),de.map(N=>d.jsx(ln,{value:N.ID,children:N.Name},N.ID))]})})}),d.jsx(_e,{sx:{flex:"0 1 150px",minWidth:"150px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:y,onChange:N=>C(N.target.value),children:[d.jsx(ln,{value:"all",children:"All Types"}),d.jsx(ln,{value:"staff",children:"Staff"}),d.jsx(ln,{value:"sme",children:"SME"})]})})}),d.jsx(_e,{sx:{flex:"0 1 auto"},children:d.jsxs(We,{variant:"body2",color:"text.secondary",children:[le.length," of ",ie.length," resources"]})})]})}),d.jsx(qa,{sx:{maxHeight:"60vh"},children:d.jsxs(Ba,{size:"small",stickyHeader:!0,sx:{"& .MuiTableCell-root":{py:.5}},children:[d.jsx(wa,{children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Name"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Type"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Entity"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Vendor Acc"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Start Date"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"End Date"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Work Days"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5},children:"Department"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5,textAlign:"center"},children:"Track"}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:.5,textAlign:"center"},children:"Actions"})]})}),d.jsx(za,{children:le.length===0?d.jsx(hn,{children:d.jsx(Q,{colSpan:10,align:"center",sx:{py:2},children:d.jsx(We,{variant:"body2",color:"text.secondary",children:ie.length===0?"No resources found. Create your first resource above!":"No resources match your filters."})})}):le.map(N=>d.jsxs(hn,{hover:!0,sx:{"&:hover":{backgroundColor:"#f8f9fa"}},children:[d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:N.Name})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:N.ResourceType})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:N.EntityName||N.Entity})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:N.DynamicsVendorAcc||"N/A"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:N.StartDate?In(new Date(N.StartDate),"MMM dd, yyyy"):"No start date"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:N.EndDate?In(new Date(N.EndDate),"MMM dd, yyyy"):"No end date"})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:N.WorkDays})}),d.jsx(Q,{sx:{p:.5},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem"},children:N.Department})}),d.jsx(Q,{sx:{p:.5,textAlign:"center"},children:d.jsx(lB,{checked:N.Track!==!1,onChange:ce=>{K.mutate({id:N.ID,payload:{Track:ce.target.checked}})},disabled:!a.canEdit||K.isPending,size:"small"})}),d.jsx(Q,{sx:{p:.5,textAlign:"center"},children:d.jsxs(_e,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:[a.canEdit&&d.jsx(_r,{size:"small",color:"primary",onClick:()=>I(N),disabled:K.isPending,children:d.jsx(bp,{fontSize:"small"})}),a.canDelete&&d.jsx(_r,{size:"small",color:"error",onClick:()=>W.mutate(N.ID),disabled:W.isPending,children:d.jsx(Rp,{fontSize:"small"})})]})})]},N.ID))})]})})]})}),d.jsx(Wf,{open:o.open,autoHideDuration:o.severity==="error"?8e3:4e3,onClose:()=>n({...o,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:d.jsx(Hs,{onClose:()=>n({...o,open:!1}),severity:o.severity,sx:{width:"100%"},children:o.message})}),d.jsxs(oi,{open:!!R,onClose:()=>I(null),maxWidth:"md",fullWidth:!0,children:[d.jsx(Ii,{children:"Edit Resource"}),d.jsx(ai,{children:R&&d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[d.jsx(On,{label:"Name",fullWidth:!0,defaultValue:R.Name,onBlur:N=>{N.target.value!==R.Name&&K.mutate({id:R.ID,payload:{Name:N.target.value}})}}),d.jsx(Hr,{fullWidth:!0,children:d.jsxs(Wr,{value:R.ResourceType||"",onChange:N=>{K.mutate({id:R.ID,payload:{ResourceType:N.target.value}})},children:[d.jsx(ln,{value:"",children:"Resource Type"}),QR.map(N=>d.jsx(ln,{value:N,children:N},N))]})}),d.jsx(Hr,{fullWidth:!0,children:d.jsxs(Wr,{value:R.Entity||"",onChange:N=>{K.mutate({id:R.ID,payload:{Entity:N.target.value}})},children:[d.jsx(ln,{value:"",children:"Select Entity"}),de.map(N=>d.jsx(ln,{value:N.ID,children:N.Name},N.ID))]})}),d.jsx(On,{label:"Vendor Account",fullWidth:!0,defaultValue:R.DynamicsVendorAcc,onBlur:N=>{N.target.value!==R.DynamicsVendorAcc&&K.mutate({id:R.ID,payload:{DynamicsVendorAcc:N.target.value}})}}),d.jsx(Gi,{label:"Start Date",value:R.StartDate?new Date(R.StartDate):null,onChange:N=>{N&&K.mutate({id:R.ID,payload:{StartDate:N.toISOString().split("T")[0]}})}}),d.jsx(Gi,{label:"End Date",value:R.EndDate?new Date(R.EndDate):null,onChange:N=>{N?K.mutate({id:R.ID,payload:{EndDate:N.toISOString().split("T")[0]}}):K.mutate({id:R.ID,payload:{EndDate:null}})}}),d.jsx(Hr,{fullWidth:!0,children:d.jsxs(Wr,{value:R.WorkDays||"",onChange:N=>{K.mutate({id:R.ID,payload:{WorkDays:N.target.value}})},children:[d.jsx(ln,{value:"",children:"Work Days"}),XR.map(N=>d.jsx(ln,{value:N,children:N},N))]})}),d.jsx(On,{label:"Department",fullWidth:!0,defaultValue:R.Department,onBlur:N=>{N.target.value!==R.Department&&K.mutate({id:R.ID,payload:{Department:N.target.value}})}})]})}),d.jsx(tl,{children:d.jsx(Un,{onClick:()=>I(null),children:"Close"})})]})]})})}function Hx(t,e,r){const a=new Date(t,e,1),o=Ti(a),n=cG({start:a,end:o});let f=0;return r==="Mon-Fri"?n.forEach(m=>{const y=gw(m);y>=1&&y<=5&&f++}):r==="Sun-Thu"?n.forEach(m=>{const y=gw(m);(y===0||y>=1&&y<=4)&&f++}):n.forEach(m=>{const y=gw(m);y>=1&&y<=5&&f++}),f}function Aie({selectedDate:t}){const e=Dd(),{getPagePermissions:r,isAdmin:a}=Gf(),o=r("payroll"),[n,f]=E.useState({open:!1,message:"",severity:"success"}),[m,y]=E.useState(new Set),[C,w]=E.useState(new Map),[A,R]=E.useState(!1),[I,M]=E.useState(!1),[F,O]=E.useState(!1),[j,U]=E.useState(new Map),[H,K]=E.useState(new Map),W=E.useMemo(()=>In(ga(t),"yyyy-MM-dd"),[t]),X=(Ae,te="success")=>{f({open:!0,message:Ae,severity:te})},{data:ee,isLoading:ie,refetch:de}=zs({queryKey:["payrollResources",W],queryFn:()=>Aee(W),staleTime:1e3*60*2}),{data:le,isLoading:oe,refetch:N}=zs({queryKey:["payrollRecords",W],queryFn:()=>Eee(W),staleTime:1e3*60*2}),{data:ce,isLoading:ne}=zs({queryKey:["payrollProjects",W],queryFn:()=>Tee(W),staleTime:1e3*60*5}),{data:Se}=zs({queryKey:["entities"],queryFn:()=>ck(),staleTime:1e3*60*10}),{data:se}=zs({queryKey:["payrollAllocations",W],queryFn:()=>kee(W),staleTime:1e3*60*2}),ye=E.useMemo(()=>{if(!ee)return[];const Ae=new Map;ee.forEach(pe=>{Ae.has(pe.ResourceID)||Ae.set(pe.ResourceID,pe)});const te=new Map;return Ae.forEach(pe=>{const J=pe.EntityID||"no-entity",fe=pe.EntityName||"No Entity";te.has(J)||te.set(J,{entityName:fe,entityId:J,resources:[]}),te.get(J).resources.push(pe)}),Array.from(te.values()).sort((pe,J)=>pe.entityName.localeCompare(J.entityName))},[ee]);E.useEffect(()=>{ye.length>0&&m.size===0&&y(new Set(ye.map(Ae=>Ae.entityId)))},[ye]);const ze=E.useMemo(()=>{const Ae=new Map;return le?.forEach(te=>{Ae.set(te.ResourceID,te)}),Ae},[le]);E.useEffect(()=>{if(le&&le.length>0){const Ae=le.some(te=>te.Locked);R(Ae)}},[le]);const Re=Ua({mutationFn:dR,onSuccess:()=>{e.invalidateQueries({queryKey:["payrollRecords"]}),X("Payroll record saved successfully!","success")},onError:Ae=>{X(`Error saving payroll record: ${Ae.message}`,"error")}}),ve=Ua({mutationFn:async Ae=>{const te=Ae.map(pe=>dR(pe.data));return Promise.all(te)},onSuccess:()=>{e.invalidateQueries({queryKey:["payrollRecords"]}),X("All payroll records saved successfully!","success"),w(new Map)},onError:Ae=>{X(`Error batch saving payroll records: ${Ae.message}`,"error")}}),V=E.useCallback(Ae=>!Ae||Ae===0?null:Ae*12/220,[]),ue=E.useCallback((Ae,te,pe=null)=>{const J=C.get(Ae);if(J&&te in J)return J[te];const fe=ze.get(Ae);return fe&&te in fe?fe[te]:pe},[C,ze]),Ee=(Ae,te,pe)=>{w(J=>{const fe=new Map(J),xe=fe.get(Ae)||{};return fe.set(Ae,{...xe,[te]:pe}),fe})},Ie=async()=>{const Ae=[];if(C.forEach((te,pe)=>{const J=ee?.find(xe=>xe.ResourceID===pe),fe=ze.get(pe);if(J&&Object.keys(te).length>0){const xe=te.WorkingDays!==void 0?te.WorkingDays:fe?.WorkingDays||Hx(t.getFullYear(),t.getMonth(),J.WorkDays);let Ne=te.ProjectAllocations||fe?.ProjectAllocations||null;const Me={ResourceID:J.ResourceID,Department:J.Department||null,EntityID:J.EntityID||null,WorkingDays:xe.toString(),Currency:te.Currency!==void 0?te.Currency:fe?.Currency||J.Currency||null,NetSalary:te.NetSalary!==void 0?te.NetSalary:fe?.NetSalary,SocialSecurity:te.SocialSecurity!==void 0?te.SocialSecurity:fe?.SocialSecurity,EmployeeTax:te.EmployeeTax!==void 0?te.EmployeeTax:fe?.EmployeeTax,EmployerTax:te.EmployerTax!==void 0?te.EmployerTax:fe?.EmployerTax,Housing:te.Housing!==void 0?te.Housing:fe?.Housing,CommunicationsOther:te.CommunicationsOther!==void 0?te.CommunicationsOther:fe?.CommunicationsOther,AnnualLeave:te.AnnualLeave!==void 0?te.AnnualLeave:fe?.AnnualLeave,SickLeave:te.SickLeave!==void 0?te.SickLeave:fe?.SickLeave,PublicHolidays:te.PublicHolidays!==void 0?te.PublicHolidays:fe?.PublicHolidays,Month:W,ProjectAllocations:Ne};Ae.push({resourceId:pe,data:Me})}}),Ae.length===0){X("No changes to save","error");return}await ve.mutateAsync(Ae)},ae=()=>{const Ae=[],te=Ti(t),pe=In(te,"yyyy-MM-dd"),J=In(t,"MMM yyyy"),fe=`P${t.getMonth()+1}/${t.getFullYear()}`,xe=new Map,Ne=new Map;return ye.forEach(Me=>{Me.resources.forEach(Ve=>{const Qe=Fe(Ve.ResourceID),rt=Se?.find(tr=>tr.ID===Ve.EntityID),st=rt?.SalExpCode||"6000",it=rt?.SSExpCode||"6100",xt=rt?.TaxExpCode||"6200",pt=ue(Ve.ResourceID,"NetSalary",0)||0,Yt=ue(Ve.ResourceID,"SocialSecurity",0)||0,Kt=ue(Ve.ResourceID,"EmployeeTax",0)||0,tn=ue(Ve.ResourceID,"EmployerTax",0)||0,Wt=ue(Ve.ResourceID,"Housing",0)||0,_t=ue(Ve.ResourceID,"CommunicationsOther",0)||0,at=ue(Ve.ResourceID,"AnnualLeave",0)||0,Et=ue(Ve.ResourceID,"SickLeave",0)||0,qt=ue(Ve.ResourceID,"PublicHolidays",0)||0,gn=V(pt),Sn=Object.values(Qe).reduce((tr,Bt)=>tr+Bt,0);let Zt=0,Kn=0,$t=0,Cr=0;if(Object.entries(Qe).forEach(([tr,Bt])=>{const gr=ce?.find(Qn=>Qn.ID===tr),en=gr?.Name||"Unknown Project",un=se?.find(Qn=>Qn.ResourceID===Ve.ResourceID&&Qn.ProjectID===tr),Yn=un?.TaskID||"",En=un?.Fringe_Task||"",fr=Sn>0?Bt/Sn:0,fo=gr?.Fringe?.toLowerCase()==="yes";let xo=0;if(fo&&gn&&(xo=(at+Et+qt)*gn),Bt>0){if(pt>0){const Or=(fo?pt-xo:pt)*fr;Zt+=Or,Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:st.startsWith("6")?"Purchase":"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:st.startsWith("6")?"G/L Account":st.startsWith("1")?"Vendor":"",Account_No:st,Description:`${Ve.ResourceName} Salary for ${J}`,Vendor_Name:Ve.ResourceName,Transaction_Currency:Ve.Currency||"USD",Currency_Code:Ve.Currency||"USD",Transaction_Amount:Or.toFixed(2),Amount:Or.toFixed(2),Project_Quantity:"1",Project_No:en,Project_Task_No:st.startsWith("6")?Yn:""})}if(fo&&xo>0){const Qn=xo*fr;Kn+=Qn,Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:st.startsWith("6")?"Purchase":"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:st.startsWith("6")?"G/L Account":st.startsWith("1")?"Vendor":"",Account_No:st,Description:`${Ve.ResourceName} Fringe Benefit (Leave) ${J}`,Vendor_Name:Ve.ResourceName,Transaction_Currency:Ve.Currency||"USD",Currency_Code:Ve.Currency||"USD",Transaction_Amount:Qn.toFixed(2),Amount:Qn.toFixed(2),Project_Quantity:"1",Project_No:en,Project_Task_No:st.startsWith("6")?En||Yn:""})}if(Yt>0){const Qn=Yt*fr;if(rt){const Or=xe.get(rt.ID);Or?Or.total+=Qn:xe.set(rt.ID,{total:Qn,entityName:rt.Name||Ve.EntityName||"",ssAccCode:rt.SSAccCode||Ve.SSAccCode||"",currencyCode:rt.CurrencyCode||Ve.Currency||"USD"})}Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:it.startsWith("6")?"Purchase":"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:it.startsWith("6")?"G/L Account":it.startsWith("1")?"Vendor":"",Account_No:it,Description:`${Ve.ResourceName} Social Security for ${J}`,Vendor_Name:Ve.ResourceName,Transaction_Currency:Ve.Currency||"USD",Currency_Code:Ve.Currency||"USD",Transaction_Amount:Qn.toFixed(2),Amount:Qn.toFixed(2),Project_Quantity:"1",Project_No:en,Project_Task_No:it.startsWith("6")?En||Yn:""})}if(Kt>0){const Qn=Kt*fr;if(rt){const Or=Ne.get(rt.ID);Or?Or.total+=Qn:Ne.set(rt.ID,{total:Qn,entityName:rt.Name||Ve.EntityName||"",taxAccCode:rt.TaxAccCode||Ve.TaxAccCode||"",currencyCode:rt.CurrencyCode||Ve.Currency||"USD"})}Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:xt.startsWith("6")?"Purchase":"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:xt.startsWith("6")?"G/L Account":xt.startsWith("1")?"Vendor":"",Account_No:xt,Description:`${Ve.ResourceName} Employee tax for ${J}`,Vendor_Name:Ve.ResourceName,Transaction_Currency:Ve.Currency||"USD",Currency_Code:Ve.Currency||"USD",Transaction_Amount:Qn.toFixed(2),Amount:Qn.toFixed(2),Project_Quantity:"1",Project_No:en,Project_Task_No:xt.startsWith("6")?Yn:""})}if(tn>0){const Qn=tn*fr;if(rt){const Or=Ne.get(rt.ID);Or?Or.total+=Qn:Ne.set(rt.ID,{total:Qn,entityName:rt.Name||Ve.EntityName||"",taxAccCode:rt.TaxAccCode||Ve.TaxAccCode||"",currencyCode:rt.CurrencyCode||Ve.Currency||"USD"})}Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:xt.startsWith("6")?"Purchase":"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:xt.startsWith("6")?"G/L Account":xt.startsWith("1")?"Vendor":"",Account_No:xt,Description:`${Ve.ResourceName} Employer tax for ${J}`,Vendor_Name:Ve.ResourceName,Transaction_Currency:Ve.Currency||"USD",Currency_Code:Ve.Currency||"USD",Transaction_Amount:Qn.toFixed(2),Amount:Qn.toFixed(2),Project_Quantity:"1",Project_No:en,Project_Task_No:xt.startsWith("6")?En||Yn:""})}if(Wt>0){const Qn=Wt*fr;$t+=Qn,Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:st.startsWith("6")?"Purchase":"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:st.startsWith("6")?"G/L Account":st.startsWith("1")?"Vendor":"",Account_No:st,Description:`${Ve.ResourceName} Housing for ${J}`,Vendor_Name:Ve.ResourceName,Transaction_Currency:Ve.Currency||"USD",Currency_Code:Ve.Currency||"USD",Transaction_Amount:Qn.toFixed(2),Amount:Qn.toFixed(2),Project_Quantity:"1",Project_No:en,Project_Task_No:st.startsWith("6")?Yn:""})}if(_t>0){const Qn=_t*fr;Cr+=Qn,Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:st.startsWith("6")?"Purchase":"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:st.startsWith("6")?"G/L Account":st.startsWith("1")?"Vendor":"",Account_No:st,Description:`${Ve.ResourceName} Comms Allowance for ${J}`,Vendor_Name:Ve.ResourceName,Transaction_Currency:Ve.Currency||"USD",Currency_Code:Ve.Currency||"USD",Transaction_Amount:Qn.toFixed(2),Amount:Qn.toFixed(2),Project_Quantity:"1",Project_No:en,Project_Task_No:st.startsWith("6")?Yn:""})}}}),Zt>0||Kn>0||$t>0||Cr>0){const tr=Zt+Kn+$t+Cr,Bt=ue(Ve.ResourceID,"Currency",Ve.Currency)||Ve.Currency||"USD";Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:"Vendor",Account_No:Ve.DynamicsVendorAcc||"",Description:`Payroll for ${Ve.ResourceName} ${J}`,Vendor_Name:Ve.ResourceName,Transaction_Currency:Bt,Currency_Code:Bt,Transaction_Amount:(tr*-1).toFixed(2),Amount:(tr*-1).toFixed(2),Project_Quantity:"",Project_No:"",Project_Task_No:""})}})}),xe.forEach(Me=>{Me.total>0&&Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:"Vendor",Account_No:Me.ssAccCode,Description:`Social Security for ${Me.entityName} ${J}`,Vendor_Name:Me.entityName,Transaction_Currency:Me.currencyCode,Currency_Code:Me.currencyCode,Transaction_Amount:(Me.total*-1).toFixed(2),Amount:(Me.total*-1).toFixed(2),Project_Quantity:"",Project_No:"",Project_Task_No:""})}),Ne.forEach(Me=>{Me.total>0&&Ae.push({Journal_Batch_Name:"",Line_No:"",Gen_Posting_Type:"",Posting_Date:pe,Document_Date:pe,Invoice_Date:pe,Document_No:fe,Vendor_Invoice_Ref:fe,External_Document_No:fe,Account_Type:"Vendor",Account_No:Me.taxAccCode,Description:`Payroll Tax for ${Me.entityName} ${J}`,Vendor_Name:Me.entityName,Transaction_Currency:Me.currencyCode,Currency_Code:Me.currencyCode,Transaction_Amount:(Me.total*-1).toFixed(2),Amount:(Me.total*-1).toFixed(2),Project_Quantity:"",Project_No:"",Project_Task_No:""})}),Ae},be=async Ae=>{const te=C.get(Ae.ResourceID)||{},pe=ze.get(Ae.ResourceID),J=te.WorkingDays!==void 0?te.WorkingDays:pe?.WorkingDays||Hx(t.getFullYear(),t.getMonth(),Ae.WorkDays);let fe=te.ProjectAllocations||pe?.ProjectAllocations||null;const xe={ResourceID:Ae.ResourceID,Department:Ae.Department||null,EntityID:Ae.EntityID||null,WorkingDays:J.toString(),Currency:te.Currency!==void 0?te.Currency:pe?.Currency||Ae.Currency||null,NetSalary:te.NetSalary!==void 0?te.NetSalary:pe?.NetSalary,SocialSecurity:te.SocialSecurity!==void 0?te.SocialSecurity:pe?.SocialSecurity,EmployeeTax:te.EmployeeTax!==void 0?te.EmployeeTax:pe?.EmployeeTax,EmployerTax:te.EmployerTax!==void 0?te.EmployerTax:pe?.EmployerTax,Housing:te.Housing!==void 0?te.Housing:pe?.Housing,CommunicationsOther:te.CommunicationsOther!==void 0?te.CommunicationsOther:pe?.CommunicationsOther,AnnualLeave:te.AnnualLeave!==void 0?te.AnnualLeave:pe?.AnnualLeave,SickLeave:te.SickLeave!==void 0?te.SickLeave:pe?.SickLeave,PublicHolidays:te.PublicHolidays!==void 0?te.PublicHolidays:pe?.PublicHolidays,Month:W,ProjectAllocations:fe};await Re.mutateAsync(xe),w(Ne=>{const Me=new Map(Ne);return Me.delete(Ae.ResourceID),Me})},Te=Ae=>{y(te=>{const pe=new Set(te);return pe.has(Ae)?pe.delete(Ae):pe.add(Ae),pe})},tt=async()=>{const Ae=!A,te=In(t,"yyyy-MM-dd");try{const pe=await Dee(te,Ae);R(Ae),X(`${pe.updatedCount} records ${Ae?"locked":"unlocked"} for this month`,"success"),e.invalidateQueries({queryKey:["payrollRecords"]})}catch(pe){X(`Error updating lock status: ${pe.message}`,"error")}},je=()=>{if(I)ye.forEach(Ae=>{Ae.resources.forEach(te=>{const pe=j.get(te.ResourceID);if(pe){const J={};Object.entries(pe).forEach(([fe,xe])=>{J[fe]=xe}),Ee(te.ResourceID,"ProjectAllocations",JSON.stringify(J))}})}),M(!1),K(new Map),X("Project allocations reverted to original values","success");else{const Ae=new Map,te=new Map;ye.forEach(pe=>{const J={};pe.resources.forEach(xe=>{const Ne=Fe(xe.ResourceID);Ae.set(xe.ResourceID,{...Ne});const Me=Object.values(Ne).reduce((Ve,Qe)=>Ve+Qe,0);if(Me>0){const Ve={};Object.entries(Ne).forEach(([Qe,rt])=>{const st=rt/Me*100;Ve[Qe]=Math.round(st*100)/100,J[Qe]||(J[Qe]=[]),J[Qe].push(st)}),Ee(xe.ResourceID,"ProjectAllocations",JSON.stringify(Ve))}});const fe={};Object.entries(J).forEach(([xe,Ne])=>{const Me=Ne.reduce((Ve,Qe)=>Ve+Qe,0)/Ne.length;fe[xe]=Math.round(Me*100)/100}),te.set(pe.entityId,fe)}),U(Ae),K(te),M(!0),X("Project allocations converted to percentages with entity averages","success")}},Pe=()=>{de(),N(),X("Data refreshed","success")},Be=Ae=>C.has(Ae)&&Object.keys(C.get(Ae)).length>0,Fe=E.useCallback(Ae=>{const te=C.get(Ae);if(te&&"ProjectAllocations"in te)try{return JSON.parse(te.ProjectAllocations||"{}")}catch{return{}}const pe=ze.get(Ae);if(pe&&pe.ProjectAllocations)try{return JSON.parse(pe.ProjectAllocations)}catch{return{}}return{}},[C,ze]),Ge=E.useCallback((Ae,te,pe)=>{const fe={...Fe(Ae)};pe===0||pe===null||pe===void 0?delete fe[te]:fe[te]=pe,w(xe=>{const Ne=new Map(xe),Me=Ne.get(Ae)||{};return Ne.set(Ae,{...Me,ProjectAllocations:JSON.stringify(fe)}),Ne})},[Fe]),Oe=()=>{if(!ee||!ce)return;const Ae=lo.utils.json_to_sheet([]),te=["Entity Name","Resource Name","Work Days","Currency","Net Salary","Social Security","Employee Tax","Employer Tax","Housing","Communications/Other","Annual Leave","Sick Leave","Public Holidays","Daily Rate",...ce.map(fe=>fe.Name)];lo.utils.sheet_add_aoa(Ae,[te],{origin:"A1"});let pe=2;ye.forEach(fe=>{fe.resources.forEach(xe=>{const Ne=Hx(t.getFullYear(),t.getMonth(),xe.WorkDays),Me=Fe(xe.ResourceID),Ve=ue(xe.ResourceID,"NetSalary",null),Qe=V(Ve),rt=[fe.entityName,xe.ResourceName,Ne,ue(xe.ResourceID,"Currency","")||xe.Currency||"",ue(xe.ResourceID,"NetSalary","")||"",ue(xe.ResourceID,"SocialSecurity","")||"",ue(xe.ResourceID,"EmployeeTax","")||"",ue(xe.ResourceID,"EmployerTax","")||"",ue(xe.ResourceID,"Housing","")||"",ue(xe.ResourceID,"CommunicationsOther","")||"",ue(xe.ResourceID,"AnnualLeave","")||"",ue(xe.ResourceID,"SickLeave","")||"",ue(xe.ResourceID,"PublicHolidays","")||"",Qe?Qe.toFixed(2):"",...ce.map(st=>Me[st.ID]||0)];lo.utils.sheet_add_aoa(Ae,[rt],{origin:`A${pe}`}),pe++})});const J=lo.utils.book_new();lo.utils.book_append_sheet(J,Ae,`Payroll ${In(t,"MMM yyyy")}`),lo.writeFile(J,`Payroll_Allocation_${In(t,"yyyy-MM")}.xlsx`)},mt=Ae=>{const te=Ae.target.files?.[0];if(!te)return;const pe=new FileReader;pe.onload=J=>{try{const fe=new Uint8Array(J.target?.result),xe=lo.read(fe,{type:"array"}),Ne=xe.Sheets[xe.SheetNames[0]],Me=lo.utils.sheet_to_json(Ne,{header:1}),Ve=[];ce&&ce.forEach((Qe,rt)=>{Ve.push({columnIndex:14+rt,projectId:Qe.ID})}),Me.slice(1).forEach(Qe=>{if(Qe.length===0||!Qe[1])return;const rt=Qe[1],st=ee?.find(it=>it.ResourceName===rt);if(st){Ee(st.ResourceID,"Currency",Qe[3]||null),Ee(st.ResourceID,"NetSalary",Qe[4]?parseFloat(Qe[4]):null),Ee(st.ResourceID,"SocialSecurity",Qe[5]?parseFloat(Qe[5]):null),Ee(st.ResourceID,"EmployeeTax",Qe[6]?parseFloat(Qe[6]):null),Ee(st.ResourceID,"EmployerTax",Qe[7]?parseFloat(Qe[7]):null),Ee(st.ResourceID,"Housing",Qe[8]?parseFloat(Qe[8]):null),Ee(st.ResourceID,"CommunicationsOther",Qe[9]?parseFloat(Qe[9]):null),Ee(st.ResourceID,"AnnualLeave",Qe[10]?parseInt(Qe[10]):null),Ee(st.ResourceID,"SickLeave",Qe[11]?parseInt(Qe[11]):null),Ee(st.ResourceID,"PublicHolidays",Qe[12]?parseInt(Qe[12]):null);const it={};Ve.forEach(({columnIndex:xt,projectId:pt})=>{const Yt=Qe[xt];if(Yt!=null&&Yt!==""){const Kt=parseFloat(Yt);!isNaN(Kt)&&Kt>0&&(it[pt]=Kt)}}),Object.keys(it).length>0&&Ee(st.ResourceID,"ProjectAllocations",JSON.stringify(it))}}),X("Excel data imported successfully!","success")}catch{X("Error importing Excel file","error")}},pe.readAsArrayBuffer(te),Ae.target.value=""},qe=ie||oe||ne;return d.jsxs(_e,{sx:{p:1},children:[d.jsx(Ta,{sx:{mb:1},children:d.jsxs(Aa,{sx:{pb:1},children:[d.jsxs(_e,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:1},children:[d.jsxs(We,{variant:"h6",gutterBottom:!0,sx:{fontSize:"1.1rem"},children:["Payroll Allocation - ",In(t,"MMMM yyyy")]}),d.jsxs(_e,{sx:{display:"flex",gap:1},children:[a&&d.jsx(Mo,{title:A?"Unlock All Cells":"Lock All Cells",children:d.jsx("span",{children:d.jsx(_r,{onClick:tt,disabled:qe,size:"small",color:A?"warning":"default",children:A?d.jsx(_I,{fontSize:"small"}):d.jsx(BH,{fontSize:"small"})})})}),d.jsx(Mo,{title:I?"Revert to Original Values":"Convert to Percentages",children:d.jsx("span",{children:d.jsx(_r,{onClick:je,disabled:qe,size:"small",color:I?"success":"default",children:d.jsx(HH,{fontSize:"small"})})})}),d.jsx(Mo,{title:"Batch Save All Changes",children:d.jsx("span",{children:d.jsx(_r,{onClick:Ie,disabled:qe||C.size===0||ve.isPending,size:"small",color:"primary",children:d.jsx(FD,{fontSize:"small"})})})}),d.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:mt,style:{display:"none"},id:"excel-import-input"}),d.jsx("label",{htmlFor:"excel-import-input",children:d.jsx(Mo,{title:"Import from Excel",children:d.jsx("span",{children:d.jsx(_r,{component:"span",size:"small",disabled:qe,children:d.jsx(_C,{fontSize:"small"})})})})}),d.jsx(Mo,{title:"Export to Excel",children:d.jsx("span",{children:d.jsx(_r,{onClick:Oe,disabled:qe,size:"small",children:d.jsx(yp,{fontSize:"small"})})})}),d.jsx(Mo,{title:"Generate Journal",children:d.jsx("span",{children:d.jsx(_r,{onClick:()=>O(!0),disabled:qe,size:"small",children:d.jsx(FD,{fontSize:"small"})})})}),d.jsx(Mo,{title:"Refresh data",children:d.jsx("span",{children:d.jsx(_r,{onClick:Pe,disabled:qe,size:"small",children:d.jsx(OI,{fontSize:"small"})})})})]})]}),d.jsx(We,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem"},children:"Resources with allocations for selected month. Work days auto-calculated."})]})}),qe?d.jsx(_e,{sx:{display:"flex",justifyContent:"center",p:2},children:d.jsx(Ri,{size:24})}):ye.length===0?d.jsxs(Hs,{severity:"info",sx:{fontSize:"0.8rem"},children:["No resources found with allocations for ",In(t,"MMMM yyyy"),"."]}):d.jsx(qa,{component:ua,sx:{maxHeight:"70vh"},children:d.jsxs(Ba,{size:"small",sx:{minWidth:1e3,fontSize:"0.7rem",borderCollapse:"collapse","& .MuiTableCell-root":{border:"1px solid #e0e0e0",padding:"2px 4px",height:"24px",verticalAlign:"middle",textAlign:"left",boxSizing:"border-box"}},children:[d.jsxs(wa,{children:[d.jsxs(hn,{sx:{backgroundColor:"#f5f5f5"},children:[d.jsx(Q,{colSpan:9,sx:{fontWeight:"bold",fontSize:"0.8rem",py:1,px:1,height:"32px",backgroundColor:"#e3f2fd",border:"1px solid #ccc",textAlign:"center",verticalAlign:"middle"},children:"Payroll"}),d.jsx(Q,{colSpan:4,sx:{fontWeight:"bold",fontSize:"0.8rem",py:1,px:1,height:"32px",backgroundColor:"#f0f4c3",border:"1px solid #ccc",textAlign:"center",verticalAlign:"middle"},children:"Fringe"}),d.jsx(Q,{colSpan:ce?.length||0,sx:{fontWeight:"bold",fontSize:"0.8rem",py:1,px:1,height:"32px",backgroundColor:"#e8f5e8",border:"1px solid #ccc",textAlign:"center",verticalAlign:"middle"},children:"Projects"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.8rem",py:1,px:1,height:"32px",backgroundColor:"#f0f0f0",border:"1px solid #ccc",textAlign:"center",verticalAlign:"middle"}})]}),d.jsxs(hn,{sx:{backgroundColor:"#f5f5f5"},children:[d.jsx(Q,{sx:{fontWeight:"bold",minWidth:"110px",width:"110px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Resource Name"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"40px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Work Days"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"40px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Currency"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Net Salary"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Social Security"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Employee Tax"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Employer Tax"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Housing"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Comm/Other"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Annual Leave"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Sick Leave"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Public Holidays"}),d.jsx(Q,{sx:{fontWeight:"bold",width:"45px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"},children:"Daily Rate"}),ce?.map(Ae=>d.jsx(Q,{sx:{fontWeight:"bold",width:"50px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#e8f5e8",border:"1px solid #ccc"},children:Ae.Name},Ae.ID)),d.jsx(Q,{sx:{fontWeight:"bold",width:"40px",fontSize:"0.7rem",py:0,px:1,height:"28px",backgroundColor:"#f0f0f0",border:"1px solid #ccc"}})]})]}),d.jsx(za,{children:ye.map(Ae=>d.jsxs(Jr.Fragment,{children:[d.jsxs(hn,{sx:{backgroundColor:"#e3f2fd",cursor:"pointer","&:hover":{backgroundColor:"#bbdefb"}},onClick:()=>Te(Ae.entityId),children:[d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.75rem",py:0,px:1,height:"24px",backgroundColor:"#e8f4fd",border:"1px solid #ccc",minWidth:"110px",width:"110px"},children:d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:.5},children:[m.has(Ae.entityId)?d.jsx(RA,{fontSize:"small"}):d.jsx(IA,{fontSize:"small"}),Ae.entityName]})}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"40px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"40px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"45px",py:0,px:1,height:"24px"}}),ce?.map(te=>{const J=H.get(Ae.entityId)?.[te.ID]||0;return d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #ccc",width:"50px",backgroundColor:I&&J>0?"#d4edda":"#f0f8f0",fontWeight:I&&J>0?"bold":"normal",textAlign:"center"},children:I&&J>0?`${J}%`:""},`entity-avg-${te.ID}`)}),d.jsx(Q,{sx:{backgroundColor:"#e8f4fd",border:"1px solid #ccc",width:"40px",py:0,px:1,height:"24px"}})]}),m.has(Ae.entityId)&&Ae.resources.map(te=>{const pe=Hx(t.getFullYear(),t.getMonth(),te.WorkDays);return d.jsxs(hn,{sx:{backgroundColor:Be(te.ResourceID)?"#fff3e0":"inherit","&:hover":{backgroundColor:"#f5f5f5"}},children:[d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",minWidth:"110px",width:"110px",backgroundColor:"#f3f8ff"},children:te.ResourceName}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"40px",backgroundColor:"#f3f8ff"},children:d.jsx("input",{type:"number",step:"1",value:ue(te.ResourceID,"WorkingDays",pe),onChange:J=>Ee(te.ResourceID,"WorkingDays",J.target.value?J.target.value:null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"40px",backgroundColor:"#f3f8ff"},children:d.jsx("input",{type:"text",value:ue(te.ResourceID,"Currency","")||te.Currency||"",onChange:J=>Ee(te.ResourceID,"Currency",J.target.value),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#f3f8ff"},children:d.jsx("input",{type:"number",step:"0.01",value:ue(te.ResourceID,"NetSalary","")||"",onChange:J=>Ee(te.ResourceID,"NetSalary",J.target.value?parseFloat(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#f3f8ff"},children:d.jsx("input",{type:"number",step:"0.01",value:ue(te.ResourceID,"SocialSecurity","")||"",onChange:J=>Ee(te.ResourceID,"SocialSecurity",J.target.value?parseFloat(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#f3f8ff"},children:d.jsx("input",{type:"number",step:"0.01",value:ue(te.ResourceID,"EmployeeTax","")||"",onChange:J=>Ee(te.ResourceID,"EmployeeTax",J.target.value?parseFloat(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#f3f8ff"},children:d.jsx("input",{type:"number",step:"0.01",value:ue(te.ResourceID,"EmployerTax","")||"",onChange:J=>Ee(te.ResourceID,"EmployerTax",J.target.value?parseFloat(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#f3f8ff"},children:d.jsx("input",{type:"number",step:"0.01",value:ue(te.ResourceID,"Housing","")||"",onChange:J=>Ee(te.ResourceID,"Housing",J.target.value?parseFloat(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#f3f8ff"},children:d.jsx("input",{type:"number",step:"0.01",value:ue(te.ResourceID,"CommunicationsOther","")||"",onChange:J=>Ee(te.ResourceID,"CommunicationsOther",J.target.value?parseFloat(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#fcf8e3"},children:d.jsx("input",{type:"number",value:ue(te.ResourceID,"AnnualLeave","")||"",onChange:J=>Ee(te.ResourceID,"AnnualLeave",J.target.value?parseInt(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#fcf8e3"},children:d.jsx("input",{type:"number",value:ue(te.ResourceID,"SickLeave","")||"",onChange:J=>Ee(te.ResourceID,"SickLeave",J.target.value?parseInt(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#fcf8e3"},children:d.jsx("input",{type:"number",value:ue(te.ResourceID,"PublicHolidays","")||"",onChange:J=>Ee(te.ResourceID,"PublicHolidays",J.target.value?parseInt(J.target.value):null),disabled:A,style:{width:"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit"}})}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"45px",backgroundColor:"#fcf8e3"},children:(()=>{const J=ue(te.ResourceID,"NetSalary",null),fe=V(J);return fe?fe.toFixed(2):""})()}),ce?.map(J=>{const xe=Fe(te.ResourceID)[J.ID]||0;return d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",backgroundColor:"#f0f8f0",width:"50px"},children:d.jsxs(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"2px"},children:[d.jsx("input",{type:"number",step:"0.01",value:xe,onChange:Ne=>Ge(te.ResourceID,J.ID,parseFloat(Ne.target.value)||0),disabled:A||I,placeholder:"0",style:{width:I?"70%":"100%",border:"none",outline:"none",background:"transparent",fontSize:"0.65rem",height:"20px",padding:"0",color:"inherit",cursor:I?"not-allowed":"inherit",opacity:I?.6:1}}),I&&xe>0&&d.jsx("span",{style:{fontSize:"0.6rem",fontWeight:"bold",minWidth:"20px"},children:"%"})]})},J.ID)}),d.jsx(Q,{sx:{fontSize:"0.7rem",py:0,px:1,height:"24px",border:"1px solid #e0e0e0",width:"40px",backgroundColor:"#f9f9f9"},children:o.canEdit&&d.jsx(Mo,{title:A?"Records are locked":"Save record",children:d.jsx("span",{children:d.jsx(_r,{size:"small",color:Be(te.ResourceID)?"primary":"default",onClick:()=>be(te),disabled:Re.isPending||A,sx:{padding:"2px",height:"20px",width:"20px"},children:d.jsx(PA,{fontSize:"inherit",sx:{fontSize:"14px"}})})})})})]},te.ResourceID)})]},`group-${Ae.entityId}`))})]})}),d.jsx(Wf,{open:n.open,autoHideDuration:2e3,onClose:()=>f(Ae=>({...Ae,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:d.jsx(Hs,{onClose:()=>f(Ae=>({...Ae,open:!1})),severity:n.severity,sx:{fontSize:"0.8rem"},children:n.message})}),d.jsxs(oi,{open:F,onClose:()=>O(!1),maxWidth:"xl",fullWidth:!0,PaperProps:{sx:{height:"80vh",maxHeight:"80vh"}},children:[d.jsx(Ii,{children:d.jsxs(We,{variant:"h6",children:["Journal Entries - ",In(t,"MMMM yyyy")]})}),d.jsx(ai,{children:d.jsx(qa,{sx:{maxHeight:"60vh",overflow:"auto"},children:d.jsxs(Ba,{size:"small",stickyHeader:!0,children:[d.jsx(wa,{children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"120px"},children:"Journal_Batch_Name"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"60px"},children:"Line No."}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Gen. Posting Type"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Posting Date"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Document Date"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Invoice Date"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"120px"},children:"Document No."}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"120px"},children:"Vendor Invoice Ref."}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"140px"},children:"External Document No."}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Account Type"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Account No."}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"200px"},children:"Description"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"150px"},children:"Vendor Name"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"120px"},children:"Transaction Currency"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Currency Code"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"120px"},children:"Transaction Amount"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Amount"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Project Quantity"}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"100px"},children:"Project No."}),d.jsx(Q,{sx:{fontWeight:"bold",fontSize:"0.7rem",minWidth:"120px"},children:"Project Task No."})]})}),d.jsx(za,{children:ae().map((Ae,te)=>d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Journal_Batch_Name}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Line_No}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Gen_Posting_Type}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Posting_Date}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Document_Date}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Invoice_Date}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Document_No}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Vendor_Invoice_Ref}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.External_Document_No}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Account_Type}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Account_No}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Description}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Vendor_Name}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Transaction_Currency}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Currency_Code}),d.jsx(Q,{sx:{fontSize:"0.65rem",textAlign:"right"},children:Ae.Transaction_Amount}),d.jsx(Q,{sx:{fontSize:"0.65rem",textAlign:"right"},children:Ae.Amount}),d.jsx(Q,{sx:{fontSize:"0.65rem",textAlign:"right"},children:Ae.Project_Quantity}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Project_No}),d.jsx(Q,{sx:{fontSize:"0.65rem"},children:Ae.Project_Task_No})]},te))})]})})}),d.jsxs(tl,{children:[d.jsx(Un,{onClick:()=>O(!1),children:"Close"}),d.jsx(Un,{variant:"contained",startIcon:d.jsx(yp,{}),onClick:()=>{const Ae=ae(),te=lo.utils.json_to_sheet(Ae),pe=lo.utils.decode_range(te["!ref"]||"A1");let J=-1,fe=-1;for(let Ne=pe.s.c;Ne<=pe.e.c;Ne++){const Me=lo.utils.encode_cell({r:0,c:Ne}),Ve=te[Me];Ve&&Ve.v==="Transaction_Amount"&&(J=Ne),Ve&&Ve.v==="Amount"&&(fe=Ne)}for(let Ne=pe.s.r+1;Ne<=pe.e.r;Ne++){if(J>=0){const Me=lo.utils.encode_cell({r:Ne,c:J});te[Me]&&(te[Me].t="n",te[Me].z="0.00")}if(fe>=0){const Me=lo.utils.encode_cell({r:Ne,c:fe});te[Me]&&(te[Me].t="n",te[Me].z="0.00")}}const xe=lo.utils.book_new();lo.utils.book_append_sheet(xe,te,"Journal Entries"),lo.writeFile(xe,`Journal_${In(t,"yyyy-MM")}.xlsx`)},children:"Export to Excel"})]})]})]})}const Wx={getAllScheduledRecords:async()=>(await Xn.get("/scheduled-records")).data,getScheduledRecord:async t=>(await Xn.get(`/scheduled-records/${t}`)).data,createScheduledRecord:async t=>(await Xn.post("/scheduled-records",t)).data,updateScheduledRecord:async(t,e)=>(await Xn.put(`/scheduled-records/${t}`,e)).data,deleteScheduledRecord:async t=>{await Xn.delete(`/scheduled-records/${t}`)}},Eie=["USD","EUR","GBP","JPY","CAD","AUD","CHF","CNY","AED","LBP","JOD","YER"],kie=["Prepaid Expense","Prepaid Rent","Other Insurance","Life Insurance","Medical Insurance","Fixed Asset"];function JR({open:t,onClose:e,onSave:r,record:a,isEdit:o}){const[n,f]=E.useState({Type:"",PurchaseDate:new Date().toISOString().split("T")[0],Supplier:"",Description:"",PurchaseCurrency:"USD",OriginalCurrencyValue:0,USDValue:0,UsefulMonths:12,Disposed:!1,DisposalDate:null}),[m,y]=E.useState({}),[C,w]=E.useState(!1);E.useEffect(()=>{f(o&&a?{Type:a.Type,PurchaseDate:a.PurchaseDate,Supplier:a.Supplier||"",Description:a.Description||"",PurchaseCurrency:a.PurchaseCurrency,OriginalCurrencyValue:a.OriginalCurrencyValue,USDValue:a.USDValue,UsefulMonths:a.UsefulMonths,Disposed:a.Disposed,DisposalDate:a.DisposalDate}:{Type:"",PurchaseDate:new Date().toISOString().split("T")[0],Supplier:"",Description:"",PurchaseCurrency:"USD",OriginalCurrencyValue:0,USDValue:0,UsefulMonths:12,Disposed:!1,DisposalDate:null}),y({})},[a,o,t]);const A=()=>{const M={};return n.Type.trim()||(M.Type="Type is required"),n.PurchaseDate||(M.PurchaseDate="Purchase date is required"),n.OriginalCurrencyValue<=0&&(M.OriginalCurrencyValue="Original value must be greater than 0"),n.USDValue<=0&&(M.USDValue="USD value must be greater than 0"),n.UsefulMonths<=0&&(M.UsefulMonths="Useful months must be greater than 0"),n.Type==="Fixed Asset"&&n.Disposed&&!n.DisposalDate&&(M.DisposalDate="Disposal date is required when disposed"),y(M),Object.keys(M).length===0},R=async M=>{if(M.preventDefault(),!!A()){w(!0);try{o&&a?await r({...n,ScheduledID:a.ScheduledID}):await r(n),e()}catch(F){console.error("Error saving record:",F)}finally{w(!1)}}},I=(M,F)=>{f(O=>({...O,[M]:F})),m[M]&&y(O=>({...O,[M]:""}))};return d.jsx(Nb,{dateAdapter:TS,children:d.jsxs(oi,{open:t,onClose:e,maxWidth:"md",fullWidth:!0,children:[d.jsx(Ii,{children:o?"Edit Scheduled Record":"Add Scheduled Record"}),d.jsxs("form",{onSubmit:R,children:[d.jsx(ai,{children:d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:2,mt:1},children:[d.jsx(_e,{sx:{flex:"1 1 300px"},children:d.jsxs(Hr,{fullWidth:!0,error:!!m.Type,children:[d.jsx(Qi,{children:"Type"}),d.jsx(Wr,{value:n.Type,label:"Type",onChange:M=>I("Type",M.target.value),children:kie.map(M=>d.jsx(ln,{value:M,children:M},M))}),m.Type&&d.jsx(_e,{sx:{color:"error.main",fontSize:"0.75rem",mt:.5},children:m.Type})]})}),d.jsx(_e,{sx:{flex:"1 1 300px"},children:d.jsx(Gi,{label:"Purchase Date",value:n.PurchaseDate?new Date(n.PurchaseDate):null,onChange:M=>I("PurchaseDate",M?M.toISOString().split("T")[0]:""),slotProps:{textField:{fullWidth:!0,error:!!m.PurchaseDate,helperText:m.PurchaseDate}}})}),d.jsx(_e,{sx:{flex:"1 1 300px"},children:d.jsx(On,{fullWidth:!0,label:"Supplier",value:n.Supplier,onChange:M=>I("Supplier",M.target.value)})}),d.jsx(_e,{sx:{flex:"1 1 300px"},children:d.jsx(On,{fullWidth:!0,label:"Description",value:n.Description,onChange:M=>I("Description",M.target.value),multiline:!0,rows:2})}),d.jsx(_e,{sx:{flex:"1 1 200px"},children:d.jsxs(Hr,{fullWidth:!0,children:[d.jsx(Qi,{children:"Purchase Currency"}),d.jsx(Wr,{value:n.PurchaseCurrency,label:"Purchase Currency",onChange:M=>I("PurchaseCurrency",M.target.value),children:Eie.map(M=>d.jsx(ln,{value:M,children:M},M))})]})}),d.jsx(_e,{sx:{flex:"1 1 200px"},children:d.jsx(On,{fullWidth:!0,label:"Original Value",type:"number",value:n.OriginalCurrencyValue,onChange:M=>I("OriginalCurrencyValue",parseFloat(M.target.value)||0),error:!!m.OriginalCurrencyValue,helperText:m.OriginalCurrencyValue,inputProps:{step:"0.01",min:"0"}})}),d.jsx(_e,{sx:{flex:"1 1 200px"},children:d.jsx(On,{fullWidth:!0,label:"USD Value",type:"number",value:n.USDValue,onChange:M=>I("USDValue",parseFloat(M.target.value)||0),error:!!m.USDValue,helperText:m.USDValue,inputProps:{step:"0.01",min:"0"}})}),d.jsx(_e,{sx:{flex:"1 1 300px"},children:d.jsx(On,{fullWidth:!0,label:"Useful Months",type:"number",value:n.UsefulMonths,onChange:M=>I("UsefulMonths",parseInt(M.target.value)||0),error:!!m.UsefulMonths,helperText:m.UsefulMonths,inputProps:{min:"1"}})}),d.jsx(_e,{sx:{flex:"1 1 300px"},children:d.jsx(Gi,{label:"Disposal Date",value:n.DisposalDate?new Date(n.DisposalDate):null,onChange:M=>I("DisposalDate",M?M.toISOString().split("T")[0]:null),disabled:!n.Disposed||n.Type!=="Fixed Asset",slotProps:{textField:{fullWidth:!0,error:!!m.DisposalDate,helperText:m.DisposalDate}}})}),d.jsx(_e,{sx:{flex:"1 1 100%"},children:d.jsx(oT,{control:d.jsx(I$,{checked:n.Disposed,onChange:M=>{if(I("Disposed",M.target.checked),M.target.checked&&n.Type!=="Fixed Asset"){const F=new Date(n.PurchaseDate);F.setMonth(F.getMonth()+n.UsefulMonths),F.setDate(0),I("DisposalDate",F.toISOString().split("T")[0])}else M.target.checked||I("DisposalDate",null)},color:"primary"}),label:n.Type==="Fixed Asset"?"Disposed":"Expensed"})})]})}),d.jsxs(tl,{children:[d.jsx(Un,{onClick:e,disabled:C,children:"Cancel"}),d.jsx(Un,{type:"submit",variant:"contained",disabled:C,children:C?"Saving...":o?"Update":"Create"})]})]})]})})}function Die({open:t,onCancel:e,onConfirm:r,title:a,message:o,loading:n=!1}){return d.jsxs(oi,{open:t,onClose:e,maxWidth:"sm",fullWidth:!0,children:[d.jsx(Ii,{children:a}),d.jsx(ai,{children:d.jsx(We,{variant:"body1",children:o})}),d.jsxs(tl,{sx:{px:3,pb:2},children:[d.jsx(Un,{onClick:e,disabled:n,color:"secondary",children:"Cancel"}),d.jsx(Un,{onClick:r,variant:"contained",color:"error",disabled:n,children:n?"Deleting...":"Delete"})]})]})}function Rie({open:t,record:e,onClose:r}){return e?d.jsxs(oi,{open:t,onClose:r,maxWidth:"sm",fullWidth:!0,children:[d.jsx(Ii,{children:"View Scheduled Record"}),d.jsx(ai,{children:d.jsx(_e,{sx:{pt:2},children:d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",gap:2},children:[d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"textSecondary",children:"ID"}),d.jsx(We,{children:e.ScheduledID})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"textSecondary",children:"Type"}),d.jsx(We,{children:e.Type})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"textSecondary",children:"Item Name"}),d.jsx(We,{children:e.ItemName})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"textSecondary",children:"Purchase Date"}),d.jsx(We,{children:new Date(e.PurchaseDate).toLocaleDateString()})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"textSecondary",children:"USD Value"}),d.jsxs(We,{children:["$",e.USDValue.toFixed(2)]})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"textSecondary",children:"Useful Months"}),d.jsx(We,{children:e.UsefulMonths})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"textSecondary",children:"Status"}),d.jsx(We,{children:e.Disposed?"Disposed/Expensed":"Active"})]}),e.Disposed&&e.DisposalDate&&d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",color:"textSecondary",children:e.Type==="Fixed Asset"?"Disposal Date":"Expensed Date"}),d.jsx(We,{children:new Date(e.DisposalDate).toLocaleDateString()})]})]})})}),d.jsx(tl,{children:d.jsx(Un,{onClick:r,children:"Close"})})]}):null}function Iie(){const[t,e]=E.useState([]),[r,a]=E.useState(!0),[o,n]=E.useState(null),[f,m]=E.useState(new Date),[y,C]=E.useState("Prepaid Expense"),[w,A]=E.useState("active"),[R,I]=E.useState(!1),[M,F]=E.useState(!1),[O,j]=E.useState(!1),[U,H]=E.useState(!1),[K,W]=E.useState(null),[X,ee]=E.useState(!1);E.useEffect(()=>{const ae=localStorage.getItem("selectedDate");if(ae)try{m(new Date(JSON.parse(ae)))}catch{m(new Date)}ie()},[]),E.useEffect(()=>{let ae=JSON.stringify(f);const Te=setInterval(()=>{const je=localStorage.getItem("selectedDate");if(je&&je!==ae)try{m(new Date(JSON.parse(je))),ae=je}catch{m(new Date)}},500),tt=()=>{const je=localStorage.getItem("selectedDate");if(je)try{m(new Date(JSON.parse(je))),ae=je}catch{m(new Date)}};return window.addEventListener("storage",tt),()=>{clearInterval(Te),window.removeEventListener("storage",tt)}},[]);const ie=async()=>{try{a(!0),n(null);const ae=await Wx.getAllScheduledRecords();e(ae)}catch(ae){n("Failed to load scheduled records"),console.error("Error loading scheduled records:",ae)}finally{a(!1)}},de=ae=>ae?new Date(ae).toLocaleDateString():"-",le=(ae,be)=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ae),oe=[{value:"Prepaid Expense",label:"Prepaid Expense"},{value:"Prepaid Rent",label:"Prepaid Rent"},{value:"Other Insurance",label:"Other Insurance"},{value:"Life Insurance",label:"Life Insurance"},{value:"Medical Insurance",label:"Medical Insurance"},{value:"Fixed Asset",label:"Fixed Asset"}],N=t.filter(ae=>ae.Type===y).filter(ae=>w==="all"?!0:w==="disposed"?ae.Disposed:w==="active"?!ae.Disposed:!0),ce=async ae=>{try{ee(!0),await Wx.createScheduledRecord(ae),await ie()}catch(be){throw console.error("Error creating record:",be),be}finally{ee(!1)}},ne=async ae=>{try{if(ee(!0),"ScheduledID"in ae){const be={...ae,Disposed:ae.Disposed||!1,DisposalDate:ae.DisposalDate||void 0};await Wx.updateScheduledRecord(ae.ScheduledID,be)}await ie()}catch(be){throw console.error("Error updating record:",be),be}finally{ee(!1)}},Se=async()=>{if(K)try{ee(!0),await Wx.deleteScheduledRecord(K.ScheduledID),await ie(),H(!1),W(null)}catch(ae){throw console.error("Error deleting record:",ae),ae}finally{ee(!1)}},se=async ae=>{ee(!0);try{const be=await I_.createOrOpenFolder(ae.ScheduledID,ae.Type);be.success&&be.folderUrl?(window.open(be.folderUrl,"_blank"),be.created?console.log(` Created and opened folder for record ${ae.ScheduledID}`):console.log(` Opened existing folder for record ${ae.ScheduledID}`)):n(be.error||"Failed to access SharePoint folder")}catch(be){n("Failed to open folder: "+(be.message||"Unknown error"))}finally{ee(!1)}},ye=ae=>{W(ae),F(!0)},ze=ae=>{W(ae),j(!0)},Re=ae=>{W(ae),H(!0)},ve=(ae,be)=>{if(be<=0)return 0;const Te=be*30;return ae/Te},V=(ae,be)=>{const Te=new Date(ae.PurchaseDate),tt=Te.getDate(),je=Te.getMonth(),Pe=Te.getFullYear(),Be=new Date(f);Be.setMonth(Be.getMonth()+be);const Fe=Be.getMonth(),Ge=Be.getFullYear(),Oe=ae.USDValue/ae.UsefulMonths,mt=ae.UsefulMonths*30,qe=(Ge-Pe)*12+(Fe-je);if(qe<0)return 0;if(ae.Type==="Fixed Asset"&&ae.Disposed&&ae.DisposalDate){const xe=new Date(ae.DisposalDate);if(Be>=xe)return 0}let Ae=0;qe===0?Ae=30-tt+1:Ae=30;let te=0;qe>0&&(te=30-tt+1+(qe-1)*30);let pe=te+Ae;if(te>=mt||(pe>mt&&(Ae=mt-te),Ae<=0))return 0;const fe=Oe/30*Ae;return Math.min(fe,Oe)},ue=(ae,be)=>{const Te=new Date(ae);Te.setMonth(Te.getMonth()+be);const je=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][Te.getMonth()],Pe=Te.getFullYear();return`${je} ${Pe}`},Ee=(ae,be)=>V(ae,be),Ie=ae=>{const be=new Date(f),Te=new Date(ae.PurchaseDate),tt=Te.getDate(),je=Te.getMonth(),Pe=Te.getFullYear(),Be=be.getMonth(),Fe=be.getFullYear();if(ae.Type==="Fixed Asset"&&ae.Disposed)return 0;if(Fe<Pe||Fe===Pe&&Be<je)return ae.USDValue;const Ge=(Fe-Pe)*12+(Be-je);let Oe=0;const mt=ae.USDValue/ae.UsefulMonths,qe=ae.UsefulMonths*30;for(let pe=0;pe<=Ge&&Oe<qe;pe++){let J=0;pe===0?J=30-tt+1:J=Math.min(30,qe-Oe),Oe+=J}Oe=Math.min(Oe,qe);const te=mt/30*Oe;return Math.max(0,ae.USDValue-te)};return r?d.jsxs(_e,{sx:{p:3},children:[d.jsx(We,{variant:"h4",gutterBottom:!0,children:"Scheduled Records"}),d.jsx(We,{color:"text.secondary",children:"Loading..."})]}):o?d.jsxs(_e,{sx:{p:3},children:[d.jsx(We,{variant:"h4",gutterBottom:!0,children:"Scheduled Records"}),d.jsx(Hs,{severity:"error",sx:{mb:2},children:o})]}):d.jsxs(_e,{sx:{p:3},children:[d.jsxs(_e,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[d.jsx(We,{variant:"h4",children:"Scheduled Records"}),d.jsx(Un,{variant:"contained",startIcon:d.jsx(sg,{}),onClick:()=>I(!0),children:"Add Record"})]}),d.jsxs(_e,{sx:{mb:2,p:1.5,backgroundColor:"#f5f5f5",borderRadius:1,border:"1px solid #e0e0e0"},children:[d.jsxs(_e,{sx:{mb:1.5},children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",color:"#666",display:"block",mb:.75},children:"STATUS"}),d.jsx(_e,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:["all","active","disposed"].map(ae=>d.jsx(Un,{size:"small",variant:w===ae?"contained":"outlined",onClick:()=>A(ae),sx:{textTransform:"capitalize",fontSize:"0.8rem",px:1.5,py:.5,borderColor:w===ae?"primary.main":"#d0d0d0",color:w===ae?"primary.contrastText":"text.primary",backgroundColor:w===ae?"primary.main":"white","&:hover":{backgroundColor:w===ae?"primary.dark":"#f0f0f0",borderColor:"primary.main"}},children:ae==="all"?"All":ae==="active"?"Active":"Expensed/Disposed"},ae))})]}),d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",color:"#666",display:"block",mb:.75},children:"TYPE"}),d.jsx(_e,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:oe.map(ae=>d.jsxs(Un,{size:"small",variant:y===ae.value?"contained":"outlined",onClick:()=>C(ae.value),sx:{textTransform:"none",fontSize:"0.8rem",px:1.5,py:.5,borderColor:y===ae.value?"primary.main":"#d0d0d0",color:y===ae.value?"primary.contrastText":"text.primary",backgroundColor:y===ae.value?"primary.main":"white","&:hover":{backgroundColor:y===ae.value?"primary.dark":"#f0f0f0",borderColor:"primary.main"}},children:[ae.label,d.jsx(Sa,{size:"small",label:t.filter(be=>be.Type===ae.value).length,sx:{ml:.75,minWidth:18,height:18,fontSize:"0.65rem",backgroundColor:y===ae.value?"rgba(255,255,255,0.3)":"#e0e0e0"}})]},ae.value))})]})]}),d.jsx(qa,{component:ua,sx:{mt:2},children:d.jsxs(Ba,{size:"small",children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{backgroundColor:"#f5f5f5"},children:[d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"ID"}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Type"}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Description"}),d.jsx(Q,{align:"center",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Purchase Currency"}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Original Curr Value"}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Purchase Date"}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"USD Value"}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Useful Months"}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Monthly Cost"}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:ue(f,-2)}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:ue(f,-1)}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:ue(f,0)}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Balance"}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Status"}),y==="Fixed Asset"&&d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Disposal Date"}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},children:"Actions"})]})}),d.jsx(za,{children:N.length===0?d.jsx(hn,{children:d.jsx(Q,{colSpan:y==="Fixed Asset"?15:14,align:"center",sx:{py:2,fontSize:"0.85rem"},children:d.jsxs(We,{color:"text.secondary",sx:{py:1},children:["No scheduled records found for type: ",y]})})}):N.map(ae=>d.jsxs(hn,{hover:!0,sx:{"&:hover":{backgroundColor:"#fafafa"}},children:[d.jsx(Q,{sx:{fontSize:"0.75rem",py:.5},children:ae.ScheduledID}),d.jsx(Q,{sx:{fontSize:"0.75rem",py:.5},children:ae.Type}),d.jsx(Q,{sx:{fontSize:"0.75rem",py:.5,maxWidth:150,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.jsx(Mo,{title:ae.Description||"",children:d.jsx("span",{children:ae.Description||"-"})})}),d.jsx(Q,{align:"center",sx:{fontSize:"0.75rem",py:.5},children:ae.PurchaseCurrency||"-"}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",py:.5},children:ae.OriginalCurrencyValue?.toFixed(2)||"0.00"}),d.jsx(Q,{sx:{fontSize:"0.75rem",py:.5},children:de(ae.PurchaseDate)}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",py:.5},children:le(ae.USDValue)}),d.jsx(Q,{sx:{fontSize:"0.75rem",py:.5},children:ae.UsefulMonths}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",py:.5},children:le(ve(ae.USDValue,ae.UsefulMonths)*30)}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",py:.5},children:le(Ee(ae,-2))}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",py:.5},children:le(Ee(ae,-1))}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",py:.5},children:le(Ee(ae,0))}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",py:.5,fontWeight:"bold"},children:le(Ie(ae))}),d.jsx(Q,{sx:{fontSize:"0.75rem",py:.5},children:d.jsx(Sa,{label:ae.Disposed?ae.Type==="Fixed Asset"?"Disposed":"Expensed":"Active",color:ae.Disposed?"error":"success",size:"small",sx:{fontSize:"0.65rem"}})}),y==="Fixed Asset"&&d.jsx(Q,{sx:{fontSize:"0.75rem",py:.5},children:de(ae.DisposalDate||null)}),d.jsx(Q,{sx:{fontSize:"0.75rem",py:.5},children:d.jsxs(_e,{sx:{display:"flex",gap:.5},children:[d.jsx(Mo,{title:"View",children:d.jsx(_r,{size:"small",color:"info",onClick:()=>ze(ae),sx:{padding:"4px"},children:d.jsx(Tf,{fontSize:"small"})})}),d.jsx(Mo,{title:"Open SharePoint Folder",children:d.jsx(_r,{size:"small",color:"secondary",onClick:()=>se(ae),disabled:X,sx:{padding:"4px"},children:d.jsx(MI,{fontSize:"small"})})}),d.jsx(Mo,{title:"Edit",children:d.jsx(_r,{size:"small",color:"primary",onClick:()=>ye(ae),sx:{padding:"4px"},children:d.jsx(bp,{fontSize:"small"})})}),d.jsx(Mo,{title:"Delete",children:d.jsx(_r,{size:"small",color:"error",onClick:()=>Re(ae),sx:{padding:"4px"},children:d.jsx(Rp,{fontSize:"small"})})})]})})]},ae.ScheduledID))}),d.jsx(wa,{children:d.jsxs(hn,{sx:{backgroundColor:"#e8e8e8",fontWeight:"bold"},children:[d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},colSpan:6}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5,color:"#1976d2"},children:le(N.reduce((ae,be)=>ae+be.USDValue,0))}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5}}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5,color:"#1976d2"},children:le(N.reduce((ae,be)=>ae+ve(be.USDValue,be.UsefulMonths)*30,0))}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5,color:"#1976d2"},children:le(N.reduce((ae,be)=>ae+Ee(be,-2),0))}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5,color:"#1976d2"},children:le(N.reduce((ae,be)=>ae+Ee(be,-1),0))}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5,color:"#1976d2"},children:le(N.reduce((ae,be)=>ae+Ee(be,0),0))}),d.jsx(Q,{align:"right",sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5,color:"#1976d2"},children:le(N.reduce((ae,be)=>ae+Ie(be),0))}),d.jsx(Q,{sx:{fontSize:"0.75rem",fontWeight:"bold",py:.5},colSpan:y==="Fixed Asset"?3:2})]})})]})}),d.jsx(JR,{open:R,onClose:()=>I(!1),onSave:ce,isEdit:!1}),d.jsx(JR,{open:M,onClose:()=>F(!1),onSave:ne,record:K,isEdit:!0}),d.jsx(Rie,{open:O,onClose:()=>j(!1),record:K}),d.jsx(Die,{open:U,onCancel:()=>H(!1),onConfirm:Se,title:"Delete Scheduled Record",message:"Are you sure you want to delete this scheduled record? This action cannot be undone.",loading:X})]})}function Pie(){const{isAuthenticated:t,login:e,logout:r,userDisplayName:a,isLoading:o,error:n,clearError:f}=_p(),[m,y]=E.useState(""),[C,w]=E.useState([]),[A,R]=E.useState([]),[I,M]=E.useState([]),[F,O]=E.useState([]),[j,U]=E.useState(null),[H,K]=E.useState(!1),[W,X]=E.useState(!1),[ee,ie]=E.useState(!1),[de,le]=E.useState(null),[oe,N]=E.useState(new Date(new Date().setMonth(new Date().getMonth()-1)).toISOString().split("T")[0]),[ce,ne]=E.useState(new Date().toISOString().split("T")[0]),[Se,se]=E.useState(null),[ye,ze]=E.useState(!1);E.useEffect(()=>{t&&ve()},[t]),E.useEffect(()=>{m?Re(m):(O([]),U(null))},[m]);const Re=async pe=>{K(!0);try{const xe=(await Xn.get(`/budget/versions/${encodeURIComponent(pe)}`)).data.versions||[];O(xe),xe.length>0?U(xe[0].Version_ID):U(null)}catch(J){console.error("Failed to fetch budget versions:",J),O([]),U(null)}finally{K(!1)}},ve=async()=>{ie(!0);try{const J=(await Xn.get("/bc/projects")).data;w(J.projects.sort()),console.log(` Loaded ${J.projects.length} projects from Job_List`)}catch(pe){console.error("Failed to fetch projects:",pe),le("Failed to load project list: "+(pe.message||"Unknown error"))}finally{ie(!1)}},V=async()=>{if(!m){le("Please select a project");return}X(!0),le(null);try{const pe=new URLSearchParams({project:m,...oe&&{startDate:oe},...ce&&{endDate:ce},...j&&{versionId:j.toString()}}),fe=(await Xn.get(`/bc/ledger-entries?${pe}`)).data;R(fe.entries),M(fe.jobTaskHierarchy||[]),console.log(` Fetched ${fe.count} ledger entries for project ${m} (${oe} to ${ce})`),console.log(` Fetched ${fe.jobTaskHierarchy?.length||0} job task hierarchy items`)}catch(pe){console.error("Failed to generate report:",pe),le(pe.message||"Failed to generate report")}finally{X(!1)}},ue=pe=>pe.Formula||pe.Azz_Transaction_Amount,Ee=(()=>{const pe={};return I.forEach(J=>{const fe=`${J.Level1_Job_Task_No} - ${J.Level1_Description||"Uncategorized"}`,xe=J.Has_Middle_Level?`${J.Level2_Job_Task_No} - ${J.Level2_Description||"Uncategorized"}`:"",Ne=`${J.Job_Task_No} - ${J.Description}`;pe[fe]||(pe[fe]={});const Me=xe||"_NO_MIDDLE_LEVEL_";pe[fe][Me]||(pe[fe][Me]={}),pe[fe][Me][Ne]||(pe[fe][Me][Ne]={entries:[],budget:J.Budget_Amount||0,jobTaskNo:J.Job_Task_No})}),A.forEach(J=>{const fe=`${J.Level1_Job_Task_No} - ${J.Level1_Description||"Uncategorized"}`,xe=J.Has_Middle_Level?`${J.Level2_Job_Task_No} - ${J.Level2_Description||"Uncategorized"}`:"",Ne=`${J.Donor_Project_Task_No} - ${J.Job_Task_Description}`,Me=xe||"_NO_MIDDLE_LEVEL_";pe[fe]?.[Me]?.[Ne]&&pe[fe][Me][Ne].entries.push(J)}),pe})(),Ie=pe=>pe.entries.reduce((J,fe)=>J+ue(fe),0),ae=pe=>pe.budget,be=pe=>Object.values(pe).reduce((J,fe)=>J+Object.values(fe).reduce((xe,Ne)=>xe+Ie(Ne),0),0),Te=pe=>Object.values(pe).reduce((J,fe)=>J+Object.values(fe).reduce((xe,Ne)=>xe+ae(Ne),0),0),tt=pe=>Object.values(pe).reduce((J,fe)=>J+Ie(fe),0),je=pe=>Object.values(pe).reduce((J,fe)=>J+ae(fe),0),Pe=()=>A.reduce((pe,J)=>pe+ue(J),0),Be=()=>I.reduce((pe,J)=>pe+(J.Budget_Amount||0),0),Fe=()=>{if(Object.keys(Ee).length===0)return;const pe=[],J=[],fe=[];let xe=0;pe.push([`${m} Financial Report`,"","","","","","","","","",""]),fe.push({s:{r:xe,c:0},e:{r:xe,c:10}}),J.push({level:"title",row:xe++}),pe.push([`Report Period: ${oe} to ${ce}`,"","","","","","","","","",""]),fe.push({s:{r:xe,c:0},e:{r:xe,c:10}}),J.push({level:"title",row:xe++}),pe.push(["","","","","","","","","","",""]),fe.push({s:{r:xe,c:0},e:{r:xe,c:10}}),xe++,pe.push(["Category","Category Detail","Invoice Number","Document Date","Supplier","Invoice Currency","Invoice Amount","Project Currency","Amount","Budget","Variance"]),J.push({level:"header",row:xe++}),Object.entries(Ee).sort(([Kt],[tn])=>Kt.localeCompare(tn)).forEach(([Kt,tn])=>{const Wt=be(tn),_t=Te(tn),at=_t-Wt;pe.push([Kt,"","","","","","","",Wt,_t,at]),fe.push({s:{r:xe,c:0},e:{r:xe,c:7}}),J.push({level:"level1",row:xe++}),Object.entries(tn).sort(([Et],[qt])=>Et.localeCompare(qt)).forEach(([Et,qt])=>{if(Et!=="_NO_MIDDLE_LEVEL_"){const gn=tt(qt),Sn=je(qt),Zt=Sn-gn;pe.push([`  ${Et}`,"","","","","","","",gn,Sn,Zt]),fe.push({s:{r:xe,c:0},e:{r:xe,c:7}}),J.push({level:"level2",row:xe++})}Object.entries(qt).sort(([gn],[Sn])=>gn.localeCompare(Sn)).forEach(([gn,Sn])=>{const Zt=Ie(Sn),Kn=Sn.budget||0,$t=Kn-Zt,Cr=Et==="_NO_MIDDLE_LEVEL_"?"  ":"    ";pe.push([`${Cr}${gn}`,"","","","","","","",Zt,Kn,$t]),fe.push({s:{r:xe,c:0},e:{r:xe,c:7}}),J.push({level:"level3",row:xe++}),Sn.entries.sort((tr,Bt)=>new Date(tr.Posting_Date).getTime()-new Date(Bt.Posting_Date).getTime()).forEach(tr=>{const Bt=Et==="_NO_MIDDLE_LEVEL_"?"    ":"      ";pe.push([`${Bt}${tr.Donor_Project_Task_No}`,tr.Donor_Description,tr.External_Document_No||"",tr.Document_Date?new Date(tr.Document_Date).toLocaleDateString():"",tr.Azz_Vendor_Name,tr.Azz_Transaction_Currency,tr.Azz_Transaction_Amount,tr.Project_Currency,ue(tr),"",""]),J.push({level:"data",row:xe++})})})})});const Ne=Pe(),Me=Be(),Ve=Me-Ne;pe.push([`GRAND TOTAL (${Ae})`,"","","","","","","",Ne,Me,Ve]),fe.push({s:{r:xe,c:0},e:{r:xe,c:7}}),J.push({level:"grandTotal",row:xe++});const Qe=lo.utils.aoa_to_sheet(pe);Qe["!merges"]=fe;const rt={title:{fill:"FFFFFF",font:"000000",bold:!0},header:{fill:"005272",font:"FFFFFF",bold:!0},level1:{fill:"ADD8E6",font:"000000",bold:!0},level2:{fill:"ADD8E6",font:"000000",bold:!0},level3:{fill:"E8F4F8",font:"000000",bold:!0},data:{fill:"FFFFFF",font:"000000",bold:!1},grandTotal:{fill:"0D47A1",font:"FFFFFF",bold:!0}},st=11;J.forEach(({level:Kt,row:tn})=>{const Wt=rt[Kt];for(let _t=0;_t<st;_t++){const at=lo.utils.encode_cell({r:tn,c:_t});Qe[at]||(Qe[at]={v:"",t:"s"});let Et="left";Kt==="title"||_t===5||_t===7?Et="center":(_t===6||_t>=8)&&(Et="right");const qt=_t===5||_t===7,gn=Kt==="data"?{top:{style:"thin",color:{rgb:"CCCCCC"}},bottom:{style:"thin",color:{rgb:"CCCCCC"}},left:{style:"thin",color:{rgb:"CCCCCC"}},right:{style:"thin",color:{rgb:"CCCCCC"}}}:{};if(Qe[at].s={fill:{patternType:"solid",fgColor:{rgb:Wt.fill}},font:{name:"Arial",sz:8,bold:Wt.bold,color:{rgb:Wt.font}},border:gn,alignment:{horizontal:Et,vertical:"center",wrapText:qt}},(_t===6||_t>=8)&&_t<=10&&Kt!=="header"&&Kt!=="title"&&!(Kt==="data"&&(_t===9||_t===10))){const Sn=Qe[at].v;(typeof Sn=="number"||Sn===""||Sn===null)&&(typeof Sn!="number"&&(Qe[at].v=0,Qe[at].t="n"),Qe[at].z="#,##0.00")}}}),Qe["!cols"]=[{wch:12},{wch:60},{wch:18},{wch:12},{wch:30},{wch:8},{wch:15},{wch:8},{wch:15},{wch:15},{wch:15}],Qe["!rows"]=[],Qe["!rows"][3]={hpx:25};const it=lo.utils.book_new();lo.utils.book_append_sheet(it,Qe,"Financial Report");const xt=lo.write(it,{bookType:"xlsx",type:"array",cellStyles:!0}),pt=new Blob([xt],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Yt=`Financial_Report_${m}_${oe}_to_${ce}.xlsx`;X2.saveAs(pt,Yt)},Ge=()=>{if(Object.keys(Ee).length===0)return;const{months:pe,rows:J}=te();if(J.length===0)return;const fe=[],xe=[],Ne=[];let Me=0;fe.push([`${m} - Activity-Based Budget Monthly Breakdown`,...Array(pe.length+3).fill("")]),Ne.push({s:{r:Me,c:0},e:{r:Me,c:pe.length+3}}),xe.push({level:"title",row:Me++}),fe.push([`Report Period: ${In(Hl(oe),"MMM dd, yyyy")} to ${In(Hl(ce),"MMM dd, yyyy")}`,...Array(pe.length+3).fill("")]),Ne.push({s:{r:Me,c:0},e:{r:Me,c:pe.length+3}}),xe.push({level:"title",row:Me++}),fe.push(["",...Array(pe.length+3).fill("")]),Ne.push({s:{r:Me,c:0},e:{r:Me,c:pe.length+3}}),Me++;const Ve=["Description",...pe.map(at=>In(at,"MMM yy")),"Total","Budget","Variance"];fe.push(Ve),xe.push({level:"header",row:Me++}),J.forEach(at=>{const Et=at.monthlyAmounts.reduce((Sn,Zt)=>Sn+Zt,0),qt=at.budget-Et,gn=at.level==="Top"?"level1":at.level==="Middle"?"level2":"level3";fe.push([at.description,...at.monthlyAmounts,Et,at.budget,qt]),xe.push({level:gn,row:Me++})});const Qe=pe.map((at,Et)=>J.filter(qt=>qt.level==="Detail").reduce((qt,gn)=>qt+gn.monthlyAmounts[Et],0)),rt=Qe.reduce((at,Et)=>at+Et,0),st=J.filter(at=>at.level==="Detail").reduce((at,Et)=>at+Et.budget,0),it=st-rt;fe.push(["GRAND TOTAL",...Qe,rt,st,it]),xe.push({level:"grandTotal",row:Me++});const xt=lo.utils.aoa_to_sheet(fe);xt["!merges"]=Ne;const pt={title:{fill:"FFFFFF",font:"000000",bold:!0},header:{fill:"005272",font:"FFFFFF",bold:!0},level1:{fill:"ADD8E6",font:"000000",bold:!0},level2:{fill:"ADD8E6",font:"000000",bold:!0},level3:{fill:"E8F4F8",font:"000000",bold:!1},grandTotal:{fill:"0D47A1",font:"FFFFFF",bold:!0}},Yt=pe.length+4;xe.forEach(({level:at,row:Et})=>{const qt=pt[at];for(let gn=0;gn<Yt;gn++){const Sn=lo.utils.encode_cell({r:Et,c:gn});xt[Sn]||(xt[Sn]={v:"",t:"s"});let Zt="left";if(at==="title"?Zt="center":gn>0&&(Zt="right"),xt[Sn].s={fill:{patternType:"solid",fgColor:{rgb:qt.fill}},font:{name:"Arial",sz:8,bold:qt.bold,color:{rgb:qt.font}},alignment:{horizontal:Zt,vertical:"center"}},gn>0&&at!=="header"&&at!=="title"){const Kn=xt[Sn].v;(typeof Kn=="number"||Kn===""||Kn===null)&&(typeof Kn!="number"&&(xt[Sn].v=0,xt[Sn].t="n"),xt[Sn].z="#,##0.00")}}}),xt["!cols"]=[{wch:60},...Array(pe.length).fill({wch:12}),{wch:15},{wch:15},{wch:15}],xt["!rows"]=[],xt["!rows"][3]={hpx:25};const Kt=lo.utils.book_new();lo.utils.book_append_sheet(Kt,xt,"ABB Monthly Breakdown");const tn=lo.write(Kt,{bookType:"xlsx",type:"array",cellStyles:!0}),Wt=new Blob([tn],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),_t=`ABB_Monthly_Breakdown_${m}_${oe}_to_${ce}.xlsx`;X2.saveAs(Wt,_t)},Oe=(pe,J)=>{pe.preventDefault(),se({mouseX:pe.clientX-2,mouseY:pe.clientY-4,documentNo:J})},mt=()=>{se(null)},qe=()=>{if(Se){const J=`https://businesscentral.dynamics.com/9f4e2976-b07e-4f8f-9c78-055f6c855a11/Production?company=ARK%20Group%20Live&page=92&filter=%27Job%20Ledger%20Entry%27.%27Document%20No.%27%20IS%20%27${encodeURIComponent(Se.documentNo)}%27&dc=0`;window.open(J,"_blank"),mt()}},Ae=A.length>0?A[0].Project_Currency:"",te=()=>{if(!oe||!ce||A.length===0)return{months:[],rows:[]};const pe=dP({start:Hl(oe),end:Hl(ce)}),J=[];return Object.entries(Ee).forEach(([fe,xe])=>{const Ne=Object.values(xe).flatMap(Qe=>Object.values(Qe).flatMap(rt=>rt.entries)),Me=pe.map(Qe=>{const rt=In(ga(Qe),"yyyy-MM");return Ne.filter(st=>In(Hl(st.Posting_Date),"yyyy-MM")===rt).reduce((st,it)=>st+it.Formula,0)}),Ve=Object.values(xe).reduce((Qe,rt)=>Qe+Object.values(rt).reduce((st,it)=>st+(it.budget||0),0),0);J.push({level:"Top",taskNo:fe.split(" - ")[0],description:fe,monthlyAmounts:Me,budget:Ve}),Object.entries(xe).forEach(([Qe,rt])=>{const st=Object.values(rt).flatMap(pt=>pt.entries),it=pe.map(pt=>{const Yt=In(ga(pt),"yyyy-MM");return st.filter(Kt=>In(Hl(Kt.Posting_Date),"yyyy-MM")===Yt).reduce((Kt,tn)=>Kt+tn.Formula,0)}),xt=Object.values(rt).reduce((pt,Yt)=>pt+(Yt.budget||0),0);Qe!=="_NO_MIDDLE_LEVEL_"&&J.push({level:"Middle",taskNo:Qe.split(" - ")[0],description:Qe,monthlyAmounts:it,budget:xt}),Object.entries(rt).forEach(([pt,Yt])=>{const Kt=pe.map(tn=>{const Wt=In(ga(tn),"yyyy-MM");return Yt.entries.filter(_t=>In(Hl(_t.Posting_Date),"yyyy-MM")===Wt).reduce((_t,at)=>_t+at.Formula,0)});J.push({level:"Detail",taskNo:Yt.jobTaskNo,description:pt,monthlyAmounts:Kt,budget:Yt.budget||0})})})}),{months:pe,rows:J}};return d.jsxs(_e,{sx:{p:2},children:[d.jsx(We,{variant:"h5",gutterBottom:!0,sx:{mb:2},children:"Financial Report"}),(n||de)&&d.jsx(Hs,{severity:"error",sx:{mb:2},onClose:()=>{f(),le(null)},children:n||de}),d.jsx(Ta,{sx:{mb:3,backgroundColor:"#f5f5f5",border:"2px solid #1976d2"},children:d.jsxs(Aa,{sx:{py:1.5,px:2,"&:last-child":{pb:1.5}},children:[d.jsxs(_e,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:2,mb:1.5},children:[d.jsxs(_e,{sx:{display:"flex",gap:1.5,alignItems:"center"},children:[d.jsx(_e,{children:d.jsx(We,{variant:"subtitle2",sx:{fontWeight:"bold"},children:"Business Central"})}),t&&d.jsx(Sa,{label:`Connected: ${a}`,color:"success",variant:"filled",size:"small",sx:{fontWeight:"bold"}})]}),d.jsx(Mo,{title:t?"Disconnect from Business Central":"Connect to Business Central",children:d.jsx(Un,{variant:t?"contained":"outlined",color:t?"success":"primary",startIcon:d.jsx(PI,{}),onClick:()=>t?r():e(),disabled:o,size:"small",sx:{minWidth:"140px"},children:o?"Connecting...":t?"Disconnect":"Connect to BC"})})]}),!t&&d.jsx(We,{variant:"caption",sx:{color:"#d32f2f",display:"block",mb:1},children:" Configure VITE_MSAL_CLIENT_ID and VITE_MSAL_TENANT_ID in .env.local"}),d.jsxs(_e,{sx:{display:"flex",gap:1.5,flexWrap:"wrap",alignItems:"flex-end"},children:[d.jsx(w2,{sx:{minWidth:250},size:"small",options:C,value:m,onChange:(pe,J)=>y(J||""),renderInput:pe=>d.jsx(On,{...pe,label:"Donor Project No"}),disabled:!t,loading:ee}),d.jsx(w2,{sx:{minWidth:200},size:"small",options:F,getOptionLabel:pe=>pe.Version_Name,value:F.find(pe=>pe.Version_ID===j)||null,onChange:(pe,J)=>U(J?.Version_ID||null),renderInput:pe=>d.jsx(On,{...pe,label:"Budget Version",InputProps:{...pe.InputProps,endAdornment:d.jsxs(d.Fragment,{children:[H?d.jsx(Ri,{color:"inherit",size:18}):null,pe.InputProps.endAdornment]})}}),disabled:!t||!m||F.length===0,loading:H,noOptionsText:m?"No versions available":"Select a project first"}),d.jsx(On,{label:"From Date",type:"date",size:"small",value:oe,onChange:pe=>N(pe.target.value),onKeyDown:pe=>{pe.stopPropagation()},InputLabelProps:{shrink:!0},sx:{minWidth:140},disabled:!t}),d.jsx(On,{label:"To Date",type:"date",size:"small",value:ce,onChange:pe=>ne(pe.target.value),onKeyDown:pe=>{pe.stopPropagation()},InputLabelProps:{shrink:!0},sx:{minWidth:140},disabled:!t}),d.jsx(Un,{variant:"contained",color:"primary",size:"small",disabled:!t||W||!m,onClick:V,startIcon:W?d.jsx(Ri,{size:16,color:"inherit"}):void 0,children:W?"Loading...":"Generate Report"}),d.jsx(Un,{variant:"outlined",color:"success",size:"small",disabled:Object.keys(Ee).length===0,onClick:Fe,startIcon:d.jsx(OD,{}),children:"Export to Excel"}),d.jsx(Un,{variant:"outlined",color:"info",size:"small",disabled:Object.keys(Ee).length===0,onClick:()=>ze(!0),startIcon:d.jsx(jH,{}),children:"ABB"})]})]})}),d.jsx(Ta,{children:d.jsx(Aa,{children:d.jsx(qa,{component:ua,sx:{maxHeight:600,border:"1px solid #ddd"},children:d.jsxs(Ba,{stickyHeader:!0,"aria-label":"invoice report table",children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{backgroundColor:"#0078D7"},children:[d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Category"}),d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Category Detail"}),d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Invoice Number"}),d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Document Date"}),d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Supplier"}),d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Invoice Currency"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Invoice Amount"}),d.jsx(Q,{sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Project Currency"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Amount"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Budget"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",color:"white",backgroundColor:"#0078D7",fontSize:"0.65rem",border:"1px solid #ddd"},children:"Variance"})]})}),d.jsxs(za,{children:[t?Object.keys(Ee).length===0?d.jsx(hn,{children:d.jsx(Q,{colSpan:11,align:"center",sx:{py:4,color:"text.secondary",fontSize:"0.75rem"},children:d.jsx(We,{variant:"body2",children:W?"Loading report data...":"No data. Select a project and click Generate Report."})})}):Object.entries(Ee).sort(([pe],[J])=>pe.localeCompare(J)).map(([pe,J])=>d.jsxs(E.Fragment,{children:[d.jsxs(hn,{children:[d.jsx(Q,{colSpan:8,sx:{fontWeight:"bold",backgroundColor:"#ADD8E6",color:"black",fontSize:"0.7rem",py:1,border:"1px solid #ddd"},children:pe}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#ADD8E6",color:"black",fontSize:"0.7rem",py:1,border:"1px solid #ddd"},children:be(J).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#ADD8E6",color:"black",fontSize:"0.7rem",py:1,border:"1px solid #ddd"},children:Te(J).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#ADD8E6",color:"black",fontSize:"0.7rem",py:1,border:"1px solid #ddd"},children:(()=>{const fe=Te(J),xe=be(J);return(fe-xe).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})()})]}),Object.entries(J).sort(([fe],[xe])=>fe.localeCompare(xe)).map(([fe,xe])=>d.jsxs(E.Fragment,{children:[fe!=="_NO_MIDDLE_LEVEL_"&&d.jsxs(hn,{children:[d.jsx(Q,{colSpan:8,sx:{fontWeight:"bold",backgroundColor:"#ADD8E6",color:"black",fontSize:"0.65rem",py:.75,pl:3,border:"1px solid #ddd"},children:fe}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#ADD8E6",color:"black",fontSize:"0.65rem",py:.75,border:"1px solid #ddd"},children:tt(xe).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#ADD8E6",color:"black",fontSize:"0.65rem",py:.75,border:"1px solid #ddd"},children:je(xe).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#ADD8E6",color:"black",fontSize:"0.65rem",py:.75,border:"1px solid #ddd"},children:(()=>{const Ne=je(xe),Me=tt(xe);return(Ne-Me).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})()})]}),Object.entries(xe).sort(([Ne],[Me])=>Ne.localeCompare(Me)).map(([Ne,Me])=>d.jsxs(E.Fragment,{children:[d.jsxs(hn,{children:[d.jsx(Q,{colSpan:8,sx:{fontWeight:"bold",backgroundColor:"#E8F4F8",color:"black",fontSize:"0.65rem",py:.75,pl:fe==="_NO_MIDDLE_LEVEL_"?3:6,border:"1px solid #ddd"},children:Ne}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#E8F4F8",color:"black",fontSize:"0.65rem",py:.75,border:"1px solid #ddd"},children:Ie(Me).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#E8F4F8",color:"black",fontSize:"0.65rem",py:.75,border:"1px solid #ddd"},children:Me.budget?Me.budget.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#E8F4F8",color:"black",fontSize:"0.65rem",py:.75,border:"1px solid #ddd"},children:(()=>{const Ve=Me.budget||0,Qe=Ie(Me),rt=Ve-Qe;return rt!==0?rt.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"})()})]}),Me.entries.sort((Ve,Qe)=>new Date(Ve.Posting_Date).getTime()-new Date(Qe.Posting_Date).getTime()).map((Ve,Qe)=>d.jsxs(hn,{hover:!0,onContextMenu:rt=>Oe(rt,Ve.Document_No),sx:{cursor:"context-menu"},children:[d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,pl:fe==="_NO_MIDDLE_LEVEL_"?4:8,border:"1px solid #ddd"},children:Ve.Donor_Project_Task_No}),d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"},children:Ve.Donor_Description}),d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"},children:Ve.External_Document_No||""}),d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"},children:Ve.Document_Date?new Date(Ve.Document_Date).toLocaleDateString():"-"}),d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"},children:Ve.Azz_Vendor_Name}),d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"},children:Ve.Azz_Transaction_Currency}),d.jsx(Q,{align:"right",sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"},children:Ve.Azz_Transaction_Amount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"},children:Ve.Project_Currency}),d.jsx(Q,{align:"right",sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"},children:ue(Ve).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"}}),d.jsx(Q,{sx:{fontSize:"0.65rem",py:.5,px:1,border:"1px solid #ddd"}})]},`entry-${pe}-${fe}-${Ne}-${Qe}`))]},`detail-group-${pe}-${fe}-${Ne}`))]},`middle-group-${pe}-${fe}`))]},`top-group-${pe}`)):d.jsx(hn,{children:d.jsx(Q,{colSpan:11,align:"center",sx:{py:4,color:"text.secondary"},children:d.jsx(We,{variant:"body2",children:"No data. Connect to Business Central to generate a report."})})}),Object.keys(Ee).length>0&&d.jsxs(hn,{children:[d.jsxs(Q,{colSpan:8,sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem",py:1.5,border:"1px solid #ddd"},children:["GRAND TOTAL (",Ae,")"]}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem",py:1.5,border:"1px solid #ddd"},children:Pe().toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem",py:1.5,border:"1px solid #ddd"},children:Be().toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem",py:1.5,border:"1px solid #ddd"},children:(()=>{const pe=Be(),J=Pe();return(pe-J).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})()})]})]})]})})})}),d.jsx(lp,{open:Se!==null,onClose:mt,anchorReference:"anchorPosition",anchorPosition:Se!==null?{top:Se.mouseY,left:Se.mouseX}:void 0,children:d.jsxs(ln,{onClick:qe,children:[d.jsx($H,{sx:{mr:1,fontSize:18}}),"View Entry in Business Central"]})}),d.jsxs(oi,{open:ye,onClose:()=>ze(!1),maxWidth:"xl",fullWidth:!0,children:[d.jsxs(Ii,{children:["Activity-Based Budget - Monthly Breakdown",d.jsxs(We,{variant:"subtitle2",color:"text.secondary",children:[m,oe&&ce?` | ${In(Hl(oe),"MMM dd, yyyy")} - ${In(Hl(ce),"MMM dd, yyyy")}`:""]})]}),d.jsx(ai,{children:(()=>{const{months:pe,rows:J}=te();return J.length===0?d.jsx(We,{children:"No data available"}):d.jsx(qa,{component:ua,sx:{maxHeight:600},children:d.jsxs(Ba,{stickyHeader:!0,size:"small",children:[d.jsx(wa,{children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontWeight:"bold",backgroundColor:"#005272",color:"white",minWidth:300,position:"sticky",left:0,zIndex:3},children:"Description"}),pe.map((fe,xe)=>d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#005272",color:"white",minWidth:100},children:In(fe,"MMM yy")},xe)),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",minWidth:120},children:"Total"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",minWidth:120},children:"Budget"}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",minWidth:120},children:"Variance"})]})}),d.jsxs(za,{children:[J.map((fe,xe)=>{const Ne=fe.monthlyAmounts.reduce((Ve,Qe)=>Ve+Qe,0),Me=fe.level==="Top"?"#ADD8E6":fe.level==="Middle"?"#E8F4F8":"white";return d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontWeight:fe.level==="Top"?"bold":"normal",backgroundColor:Me,fontSize:"0.75rem",pl:fe.level==="Detail"?4:fe.level==="Middle"?2:1,position:"sticky",left:0,zIndex:1},children:fe.description}),fe.monthlyAmounts.map((Ve,Qe)=>d.jsx(Q,{align:"right",sx:{backgroundColor:Me,fontSize:"0.75rem"},children:Ve!==0?Ve.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"},Qe)),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:Me,fontSize:"0.75rem"},children:Ne.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:fe.level==="Top"?"bold":"normal",backgroundColor:Me,fontSize:"0.75rem"},children:fe.budget!==0?fe.budget.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"}),d.jsx(Q,{align:"right",sx:{fontWeight:fe.level==="Top"?"bold":"normal",backgroundColor:Me,fontSize:"0.75rem",color:fe.budget-Ne<0?"#d32f2f":"inherit"},children:fe.budget!==0||Ne!==0?(fe.budget-Ne).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"})]},xe)}),d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem",position:"sticky",left:0,zIndex:1},children:"GRAND TOTAL"}),pe.map((fe,xe)=>{const Ne=J.filter(Me=>Me.level==="Detail").reduce((Me,Ve)=>Me+Ve.monthlyAmounts[xe],0);return d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem"},children:Ne.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},xe)}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem"},children:J.filter(fe=>fe.level==="Detail").reduce((fe,xe)=>fe+xe.monthlyAmounts.reduce((Ne,Me)=>Ne+Me,0),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem"},children:J.filter(fe=>fe.level==="Detail").reduce((fe,xe)=>fe+xe.budget,0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}),d.jsx(Q,{align:"right",sx:{fontWeight:"bold",backgroundColor:"#0d47a1",color:"white",fontSize:"0.75rem"},children:(()=>{const fe=J.filter(Ne=>Ne.level==="Detail").reduce((Ne,Me)=>Ne+Me.budget,0),xe=J.filter(Ne=>Ne.level==="Detail").reduce((Ne,Me)=>Ne+Me.monthlyAmounts.reduce((Ve,Qe)=>Ve+Qe,0),0);return(fe-xe).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})()})]})]})]})})})()}),d.jsxs(tl,{children:[d.jsx(Un,{onClick:Ge,variant:"outlined",color:"success",startIcon:d.jsx(OD,{}),children:"Export to Excel"}),d.jsx(Un,{onClick:()=>ze(!1),color:"primary",children:"Close"})]})]})]})}const Vx="sinan.mecit@arkgroupdmcc.com";function Mie(){const{isSuperAdmin:t,viewingAsRole:e,setViewingAsRole:r,actualRole:a}=Gf(),o=Dd(),[n,f]=E.useState({open:!1,message:"",severity:"success"}),[m,y]=E.useState(""),[C,w]=E.useState("all"),[A,R]=E.useState("all"),[I,M]=E.useState(null),[F,O]=E.useState({}),[j,U]=E.useState(!0),H=(ve,V="success")=>{f({open:!0,message:ve,severity:V})},{data:K,isLoading:W,isError:X}=zs({queryKey:["systemUsers"],queryFn:fS,staleTime:1e3*60*5}),ee=Ua({mutationFn:({id:ve,payload:V})=>uee(ve,V),onSuccess:()=>{o.invalidateQueries({queryKey:["systemUsers"]}),H("User updated successfully!","success")},onError:ve=>{H(`Error updating user: ${ve.message}`,"error")}}),ie=Ua({mutationFn:ve=>s_(ve),onSuccess:()=>{o.invalidateQueries({queryKey:["systemUsers"]}),H("User created successfully!","success")},onError:ve=>{H(`Error creating user: ${ve.message}`,"error")}}),de=Ua({mutationFn:ve=>dee(ve),onSuccess:()=>{o.invalidateQueries({queryKey:["systemUsers"]}),H("User deleted successfully!","success")},onError:ve=>{H(`Error deleting user: ${ve.message}`,"error")}}),[le,oe]=E.useState({Name:"",EmailAddress:"",StartDate:"",EndDate:null,Active:!0,Role:"Viewer"}),N=K??[],ce=E.useMemo(()=>["Admin","BudgetManager","Viewer","Editor"],[]),ne=E.useMemo(()=>N.filter(ve=>{const V=ve.Name.toLowerCase().includes(m.toLowerCase())||ve.EmailAddress.toLowerCase().includes(m.toLowerCase()),ue=C==="all"||ve.Role===C,Ee=A==="all"||A==="active"&&ve.Active||A==="inactive"&&!ve.Active;return V&&ue&&Ee}).sort((ve,V)=>ve.Name.localeCompare(V.Name)),[N,m,C,A]),Se=()=>{if(!le.Name||!le.EmailAddress||!le.StartDate){H("Please fill in all required fields!","error");return}ie.mutate(le),oe({Name:"",EmailAddress:"",StartDate:"",EndDate:null,Active:!0,Role:"Viewer"})},se=ve=>{M(ve.ID),O({Name:ve.Name,EmailAddress:ve.EmailAddress,StartDate:ve.StartDate,EndDate:ve.EndDate,Active:ve.Active,Role:ve.Role})},ye=()=>{I&&F&&(ee.mutate({id:I,payload:F}),M(null),O({}))},ze=()=>{M(null),O({})},Re=(ve,V)=>{O(ue=>({...ue,[ve]:V}))};return d.jsx(Nb,{dateAdapter:TS,children:d.jsxs(_e,{sx:{p:2,backgroundColor:"#f8f9fa",minHeight:"100vh"},children:[t&&d.jsx(Ta,{sx:{mb:2,boxShadow:2,border:"2px solid #1976d2"},children:d.jsxs(Aa,{sx:{p:2},children:[d.jsxs(_e,{sx:{display:"flex",alignItems:"flex-start",gap:2,mb:e?2:0},children:[d.jsx(WH,{sx:{color:"#1976d2",mt:.5}}),d.jsxs(_e,{sx:{flexGrow:1},children:[d.jsx(We,{variant:"h6",sx:{fontWeight:"bold",color:"#1976d2",mb:2},children:"Super Admin View Mode"}),d.jsxs(_e,{sx:{display:"flex",alignItems:"flex-end",gap:2,flexWrap:"wrap"},children:[d.jsxs(_e,{children:[d.jsx(We,{variant:"caption",sx:{display:"block",color:"#666",mb:.5},children:"Current View:"}),d.jsx(Sa,{label:e||a||"Admin",color:e?"warning":"primary",sx:{fontWeight:"bold"}})]}),d.jsxs(Hr,{size:"small",sx:{minWidth:180},children:[d.jsx(We,{variant:"caption",sx:{display:"block",color:"#666",mb:.5},children:"View as Role:"}),d.jsxs(Wr,{value:e||"",onChange:ve=>r(ve.target.value),displayEmpty:!0,renderValue:ve=>ve||d.jsx("em",{children:"Normal Admin View"}),children:[d.jsx(ln,{value:"",children:d.jsx("em",{children:"Normal Admin View"})}),ce.map(ve=>d.jsx(ln,{value:ve,children:ve},ve))]})]}),e&&d.jsx(Un,{variant:"contained",color:"error",startIcon:d.jsx(uT,{}),onClick:()=>r(null),size:"medium",children:"Exit View Mode"})]})]})]}),e&&d.jsxs(Hs,{severity:"info",sx:{mt:0},children:["You are viewing the application as a ",d.jsx("strong",{children:e}),' user. Navigation and permissions are temporarily restricted to review the user experience. Select "Normal Admin View" or click "Exit View Mode" to return to your full admin access.']})]})}),d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsx(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:d.jsxs(_e,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},onClick:()=>U(!j),children:[d.jsx(We,{variant:"h5",component:"h1",sx:{fontWeight:"bold",color:"#333"},children:"System Users"}),d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:1},children:[d.jsx(Sa,{label:`${ne.length}/${N.length} Users`,color:"primary",variant:"outlined",size:"small"}),j?d.jsx(IA,{}):d.jsx(RA,{})]})]})})}),!j&&d.jsxs(d.Fragment,{children:[d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsxs(Aa,{sx:{p:2},children:[d.jsx(We,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"#1976d2"},children:"Role Permissions Matrix"}),d.jsx(qa,{children:d.jsxs(Ba,{size:"small",sx:{"& td, & th":{fontSize:"0.75rem",py:.5}},children:[d.jsx(wa,{children:d.jsxs(hn,{sx:{backgroundColor:"#f5f5f5"},children:[d.jsx(Q,{sx:{fontWeight:"bold",width:"25%"},children:"Page / Feature"}),d.jsx(Q,{align:"center",sx:{fontWeight:"bold",width:"18.75%"},children:d.jsx(Sa,{label:"Admin",color:"error",size:"small"})}),d.jsx(Q,{align:"center",sx:{fontWeight:"bold",width:"18.75%"},children:d.jsx(Sa,{label:"BudgetManager",color:"primary",size:"small"})}),d.jsx(Q,{align:"center",sx:{fontWeight:"bold",width:"18.75%"},children:d.jsx(Sa,{label:"Viewer",color:"default",size:"small"})}),d.jsx(Q,{align:"center",sx:{fontWeight:"bold",width:"18.75%"},children:d.jsx(Sa,{label:"Editor",color:"success",size:"small"})})]})}),d.jsxs(za,{children:[d.jsxs(hn,{children:[d.jsx(Q,{children:d.jsx("strong",{children:"Home"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" View Only"}),d.jsx(Q,{align:"center",children:" View Only + Click Links"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{sx:{backgroundColor:"#fafafa"},children:[d.jsx(Q,{children:d.jsx("strong",{children:"Gantt Chart"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" View Only"}),d.jsx(Q,{align:"center",children:" View Only"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{children:[d.jsx(Q,{children:d.jsx("strong",{children:"Glidepath"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" Edit + Add + Delete"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{sx:{backgroundColor:"#fafafa"},children:[d.jsx(Q,{children:d.jsx("strong",{children:"Projects"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" View Only"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{children:[d.jsx(Q,{children:d.jsx("strong",{children:"Positions"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" View Only"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{sx:{backgroundColor:"#fafafa"},children:[d.jsx(Q,{children:d.jsx("strong",{children:"Resources"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" View Only"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{children:[d.jsx(Q,{children:d.jsx("strong",{children:"Payroll Allocation"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" View Only"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{sx:{backgroundColor:"#fafafa"},children:[d.jsx(Q,{children:d.jsx("strong",{children:"Scheduled Records"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" Edit + Delete"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{children:[d.jsx(Q,{children:d.jsx("strong",{children:"Reports"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" View +  Export"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" Full Access"})]}),d.jsxs(hn,{sx:{backgroundColor:"#fafafa"},children:[d.jsx(Q,{children:d.jsx("strong",{children:"Payments"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" View Only"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" View Only"})]}),d.jsxs(hn,{children:[d.jsx(Q,{children:d.jsx("strong",{children:"Settings"})}),d.jsx(Q,{align:"center",children:" Full Access"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" No Access"}),d.jsx(Q,{align:"center",children:" No Access"})]})]})]})}),d.jsx(_e,{sx:{mt:2,p:1,backgroundColor:"#e3f2fd",borderRadius:1},children:d.jsxs(We,{variant:"caption",sx:{display:"block",color:"#1565c0"},children:[d.jsx("strong",{children:"Legend:"}),"  Full Access (View/Edit/Delete)   View Only   Edit Access   Export   No Access"]})})]})}),d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsx(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:d.jsxs(_e,{sx:{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap"},children:[d.jsx(On,{size:"small",placeholder:"Search users...",value:m,onChange:ve=>y(ve.target.value),InputProps:{startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(ig,{fontSize:"small"})})},sx:{minWidth:200,"& .MuiInputBase-input":{fontSize:"0.75rem"}}}),d.jsx(Hr,{size:"small",sx:{minWidth:120},children:d.jsxs(Wr,{value:C,onChange:ve=>w(ve.target.value),displayEmpty:!0,renderValue:ve=>ve==="all"?d.jsx("em",{style:{fontSize:"0.75rem"},children:"All Roles"}):d.jsx("span",{style:{fontSize:"0.75rem"},children:ve}),sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"all",children:d.jsx("em",{style:{fontSize:"0.75rem"},children:"All Roles"})}),ce.map(ve=>d.jsx(ln,{value:ve,sx:{fontSize:"0.75rem"},children:ve},ve))]})}),d.jsx(Hr,{size:"small",sx:{minWidth:120},children:d.jsxs(Wr,{value:A,onChange:ve=>R(ve.target.value),displayEmpty:!0,renderValue:ve=>ve==="all"?d.jsx("em",{style:{fontSize:"0.75rem"},children:"All Status"}):d.jsx("span",{style:{fontSize:"0.75rem"},children:ve==="active"?"Active":"Inactive"}),sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"all",children:d.jsx("em",{style:{fontSize:"0.75rem"},children:"All Status"})}),d.jsx(ln,{value:"active",sx:{fontSize:"0.75rem"},children:"Active"}),d.jsx(ln,{value:"inactive",sx:{fontSize:"0.75rem"},children:"Inactive"})]})})]})})}),d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsxs(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",mb:1,display:"block",color:"#666"},children:"ADD NEW USER"}),d.jsxs(_e,{sx:{display:"flex",gap:1,mb:.5,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 150px",minWidth:"150px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"NAME *"})}),d.jsx(_e,{sx:{flex:"1 1 200px",minWidth:"200px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"EMAIL *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"START *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"END"})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ACTIVE"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ROLE *"})}),d.jsx(_e,{sx:{flex:"0 1 60px",minWidth:"60px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ACTION"})})]}),d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:1,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 150px",minWidth:"150px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"User name",value:le.Name||"",onChange:ve=>oe({...le,Name:ve.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"1 1 200px",minWidth:"200px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Email address",value:le.EmailAddress||"",onChange:ve=>oe({...le,EmailAddress:ve.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(Gi,{value:le.StartDate?new Date(le.StartDate):null,onChange:ve=>oe({...le,StartDate:ve?ve.toISOString().split("T")[0]:""}),slotProps:{textField:{size:"small",placeholder:"Start date",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(Gi,{value:le.EndDate?new Date(le.EndDate):null,onChange:ve=>oe({...le,EndDate:ve?ve.toISOString().split("T")[0]:null}),slotProps:{textField:{size:"small",placeholder:"End date",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}}})}),d.jsx(_e,{sx:{flex:"0 1 80px",minWidth:"80px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsxs(Wr,{value:String(le.Active),onChange:ve=>oe({...le,Active:ve.target.value==="true"}),sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"true",sx:{fontSize:"0.75rem"},children:"Yes"}),d.jsx(ln,{value:"false",sx:{fontSize:"0.75rem"},children:"No"})]})})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(Hr,{fullWidth:!0,size:"small",children:d.jsx(Wr,{value:le.Role,onChange:ve=>oe({...le,Role:String(ve.target.value)}),sx:{fontSize:"0.75rem"},children:ce.map(ve=>d.jsx(ln,{value:ve,sx:{fontSize:"0.75rem"},children:ve},ve))})})}),d.jsx(_e,{sx:{flex:"0 1 60px",minWidth:"60px"},children:d.jsx(Un,{variant:"contained",size:"small",onClick:Se,disabled:ie.status==="pending",sx:{fontSize:"0.7rem",minWidth:"50px"},children:"Add"})})]})]})}),d.jsx(Ta,{sx:{boxShadow:1},children:d.jsxs(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",mb:1,display:"block",color:"#666"},children:"SYSTEM USERS"}),W?d.jsx(_e,{sx:{display:"flex",justifyContent:"center",p:4},children:d.jsx(Ri,{})}):X?d.jsx(_e,{sx:{p:4},children:d.jsx(We,{color:"error",children:"Failed to load system users"})}):d.jsx(qa,{component:ua,sx:{boxShadow:"none"},children:d.jsxs(Ba,{size:"small",children:[d.jsx(wa,{children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"NAME"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"EMAIL"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"START"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"END"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"ACTIVE"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"ROLE"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"ACTIONS"})})]})}),d.jsx(za,{children:ne.length===0?d.jsx(hn,{children:d.jsx(Q,{colSpan:7,align:"center",sx:{fontSize:"0.75rem",p:2},children:"No system users found."})}):ne.map(ve=>d.jsxs(hn,{hover:!0,sx:{"&:hover":{backgroundColor:"action.hover"}},children:[d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:I===ve.ID?d.jsx(On,{size:"small",value:F.Name||"",onChange:V=>Re("Name",V.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):ve.Name}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:I===ve.ID?d.jsx(On,{size:"small",value:F.EmailAddress||"",onChange:V=>Re("EmailAddress",V.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):ve.EmailAddress}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:I===ve.ID?d.jsx(Gi,{value:F.StartDate?new Date(F.StartDate):null,onChange:V=>Re("StartDate",V?V.toISOString().split("T")[0]:""),slotProps:{textField:{size:"small",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}}}):ve.StartDate?In(new Date(ve.StartDate),"yyyy-MM-dd"):"-"}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:I===ve.ID?d.jsx(Gi,{value:F.EndDate?new Date(F.EndDate):null,onChange:V=>Re("EndDate",V?V.toISOString().split("T")[0]:null),slotProps:{textField:{size:"small",sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}}}):ve.EndDate?In(new Date(ve.EndDate),"yyyy-MM-dd"):"-"}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:I===ve.ID?d.jsx(Hr,{size:"small",children:d.jsxs(Wr,{value:String(F.Active),onChange:V=>Re("Active",V.target.value==="true"),sx:{fontSize:"0.75rem"},children:[d.jsx(ln,{value:"true",sx:{fontSize:"0.75rem"},children:"Yes"}),d.jsx(ln,{value:"false",sx:{fontSize:"0.75rem"},children:"No"})]})}):d.jsx(We,{sx:{fontSize:"0.75rem"},children:ve.Active?"Yes":"No"})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:I===ve.ID?d.jsx(Hr,{size:"small",children:d.jsx(Wr,{value:F.Role??"",onChange:V=>Re("Role",String(V.target.value)),disabled:ve.EmailAddress.toLowerCase()===Vx.toLowerCase(),sx:{fontSize:"0.75rem"},children:ce.map(V=>d.jsx(ln,{value:V,sx:{fontSize:"0.75rem"},children:V},V))})}):d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:.5},children:[d.jsx(We,{sx:{fontSize:"0.75rem"},children:ve.Role||"Admin"}),ve.EmailAddress.toLowerCase()===Vx.toLowerCase()&&d.jsx(Sa,{label:"Protected",size:"small",color:"error",sx:{height:"16px",fontSize:"0.65rem"}})]})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:I===ve.ID?d.jsxs(_e,{sx:{display:"flex",gap:.5},children:[d.jsx(_r,{size:"small",color:"primary",onClick:ye,sx:{p:.5},title:"Save Changes",children:d.jsx(PA,{fontSize:"small"})}),d.jsx(_r,{size:"small",color:"secondary",onClick:ze,sx:{p:.5},title:"Cancel",children:d.jsx(uT,{fontSize:"small"})})]}):d.jsxs(_e,{sx:{display:"flex",gap:.5},children:[d.jsx(_r,{size:"small",color:"primary",onClick:()=>se(ve),disabled:ve.EmailAddress.toLowerCase()===Vx.toLowerCase(),sx:{p:.5},title:"Edit User",children:d.jsx(bp,{fontSize:"small"})}),d.jsx(_r,{size:"small",color:"error",onClick:()=>de.mutate(ve.ID),disabled:ve.EmailAddress.toLowerCase()===Vx.toLowerCase(),sx:{p:.5},children:d.jsx(Rp,{fontSize:"small"})})]})})]},ve.ID))})]})})]})})]}),d.jsx(_e,{sx:{mt:3},children:d.jsx(_ie,{})}),d.jsx(Wf,{open:n.open,autoHideDuration:6e3,onClose:()=>f({...n,open:!1}),children:d.jsx(Hs,{severity:n.severity,onClose:()=>f({...n,open:!1}),sx:{fontSize:"0.75rem"},children:n.message})})]})})}function _ie(){const t=Dd(),[e,r]=E.useState({open:!1,message:"",severity:"success"}),[a,o]=E.useState(""),[n,f]=E.useState(null),[m,y]=E.useState({}),[C,w]=E.useState(!0),A=(oe,N="success")=>{r({open:!0,message:oe,severity:N})},{data:R,isLoading:I,isError:M}=zs({queryKey:["entities"],queryFn:ck,staleTime:1e3*60*5}),F=Ua({mutationFn:oe=>fee(oe),onSuccess:()=>{t.invalidateQueries({queryKey:["entities"]}),A("Entity created successfully!","success")},onError:oe=>{A(`Error creating entity: ${oe.message}`,"error")}}),O=Ua({mutationFn:({id:oe,payload:N})=>hee(oe,N),onSuccess:()=>{t.invalidateQueries({queryKey:["entities"]}),A("Entity updated successfully!","success")},onError:oe=>{A(`Error updating entity: ${oe.message}`,"error")}}),j=Ua({mutationFn:oe=>pee(oe),onSuccess:()=>{t.invalidateQueries({queryKey:["entities"]}),A("Entity deleted successfully!","success")},onError:oe=>{console.error("Delete entity error:",oe);let N="Failed to delete entity";oe.response?.data?N=oe.response.data.details||oe.response.data.error||oe.response.data.message||N:oe.message&&(N=oe.message),A(N,"error")}}),[U,H]=E.useState({Name:"",CurrencyCode:"",SSAccCode:"",TaxAccCode:"",SSExpCode:"",TaxExpCode:"",SalExpCode:""}),K=R??[],W=E.useMemo(()=>K.filter(oe=>oe.Name.toLowerCase().includes(a.toLowerCase())||oe.CurrencyCode.toLowerCase().includes(a.toLowerCase())||oe.SSAccCode.toLowerCase().includes(a.toLowerCase())||oe.TaxAccCode.toLowerCase().includes(a.toLowerCase())||oe.SSExpCode&&oe.SSExpCode.toLowerCase().includes(a.toLowerCase())||oe.TaxExpCode&&oe.TaxExpCode.toLowerCase().includes(a.toLowerCase())||oe.SalExpCode&&oe.SalExpCode.toLowerCase().includes(a.toLowerCase())).sort((oe,N)=>oe.Name.localeCompare(N.Name)),[K,a]),X=()=>{if(!U.Name||!U.CurrencyCode){A("Please fill in required fields!","error");return}F.mutate(U),H({Name:"",CurrencyCode:"",SSAccCode:"",TaxAccCode:"",SSExpCode:"",TaxExpCode:"",SalExpCode:""})},ee=oe=>{f(oe.ID),y({Name:oe.Name,CurrencyCode:oe.CurrencyCode,SSAccCode:oe.SSAccCode,TaxAccCode:oe.TaxAccCode,SSExpCode:oe.SSExpCode||"",TaxExpCode:oe.TaxExpCode||"",SalExpCode:oe.SalExpCode||""})},ie=()=>{n&&m&&(O.mutate({id:n,payload:m}),f(null),y({}))},de=()=>{f(null),y({})},le=(oe,N)=>{y(ce=>({...ce,[oe]:N}))};return d.jsxs(d.Fragment,{children:[d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsx(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:d.jsxs(_e,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},onClick:()=>w(!C),children:[d.jsx(We,{variant:"h5",component:"h2",sx:{fontWeight:"bold",color:"#333"},children:"Entities"}),d.jsxs(_e,{sx:{display:"flex",alignItems:"center",gap:1},children:[d.jsx(Sa,{label:`${W.length}/${K.length} Entities`,color:"primary",variant:"outlined",size:"small"}),C?d.jsx(IA,{}):d.jsx(RA,{})]})]})})}),!C&&d.jsxs(d.Fragment,{children:[d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsx(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:d.jsx(_e,{sx:{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap"},children:d.jsx(On,{size:"small",placeholder:"Search entities...",value:a,onChange:oe=>o(oe.target.value),InputProps:{startAdornment:d.jsx(Pu,{position:"start",children:d.jsx(ig,{fontSize:"small"})})},sx:{minWidth:200,"& .MuiInputBase-input":{fontSize:"0.75rem"}}})})})}),d.jsx(Ta,{sx:{mb:2,boxShadow:1},children:d.jsxs(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",mb:1,display:"block",color:"#666"},children:"ADD NEW ENTITY"}),d.jsxs(_e,{sx:{display:"flex",gap:1,mb:.5,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 200px",minWidth:"200px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"NAME *"})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"CURRENCY *"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"SS ACC CODE"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"TAX ACC CODE"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"SS EXP CODE"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"TAX EXP CODE"})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"SAL EXP CODE"})}),d.jsx(_e,{sx:{flex:"0 1 60px",minWidth:"60px"},children:d.jsx(We,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:"bold",color:"#666"},children:"ACTION"})})]}),d.jsxs(_e,{sx:{display:"flex",flexWrap:"wrap",gap:1,alignItems:"center"},children:[d.jsx(_e,{sx:{flex:"1 1 200px",minWidth:"200px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Entity name",value:U.Name||"",onChange:oe=>H({...U,Name:oe.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 100px",minWidth:"100px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Currency",value:U.CurrencyCode||"",onChange:oe=>H({...U,CurrencyCode:oe.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"SS account code",value:U.SSAccCode||"",onChange:oe=>H({...U,SSAccCode:oe.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Tax account code",value:U.TaxAccCode||"",onChange:oe=>H({...U,TaxAccCode:oe.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"SS expense code",value:U.SSExpCode||"",onChange:oe=>H({...U,SSExpCode:oe.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Tax expense code",value:U.TaxExpCode||"",onChange:oe=>H({...U,TaxExpCode:oe.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 120px",minWidth:"120px"},children:d.jsx(On,{fullWidth:!0,size:"small",placeholder:"Salary expense code",value:U.SalExpCode||"",onChange:oe=>H({...U,SalExpCode:oe.target.value}),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}})}),d.jsx(_e,{sx:{flex:"0 1 60px",minWidth:"60px"},children:d.jsx(Un,{variant:"contained",size:"small",onClick:X,disabled:F.status==="pending",sx:{fontSize:"0.7rem",minWidth:"50px"},children:"Add"})})]})]})}),d.jsx(Ta,{sx:{boxShadow:1},children:d.jsxs(Aa,{sx:{p:1,"&:last-child":{pb:1}},children:[d.jsx(We,{variant:"caption",sx:{fontWeight:"bold",mb:1,display:"block",color:"#666"},children:"ENTITIES"}),I?d.jsx(_e,{sx:{display:"flex",justifyContent:"center",p:4},children:d.jsx(Ri,{})}):M?d.jsx(_e,{sx:{p:4},children:d.jsx(We,{color:"error",children:"Failed to load entities"})}):d.jsx(qa,{component:ua,sx:{boxShadow:"none"},children:d.jsxs(Ba,{size:"small",children:[d.jsx(wa,{children:d.jsxs(hn,{children:[d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"NAME"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"CURRENCY"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"SS ACC CODE"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"TAX ACC CODE"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"SS EXP CODE"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"TAX EXP CODE"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"SAL EXP CODE"})}),d.jsx(Q,{sx:{fontSize:"0.7rem",fontWeight:"bold",p:1},children:d.jsx("strong",{children:"ACTIONS"})})]})}),d.jsx(za,{children:W.length===0?d.jsx(hn,{children:d.jsx(Q,{colSpan:8,align:"center",sx:{fontSize:"0.75rem",p:2},children:"No entities found."})}):W.map(oe=>d.jsxs(hn,{hover:!0,sx:{"&:hover":{backgroundColor:"action.hover"}},children:[d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:n===oe.ID?d.jsx(On,{size:"small",value:m.Name||"",onChange:N=>le("Name",N.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):d.jsx(We,{sx:{fontSize:"0.75rem"},children:oe.Name})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:n===oe.ID?d.jsx(On,{size:"small",value:m.CurrencyCode||"",onChange:N=>le("CurrencyCode",N.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):d.jsx(We,{sx:{fontSize:"0.75rem"},children:oe.CurrencyCode})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:n===oe.ID?d.jsx(On,{size:"small",value:m.SSAccCode||"",onChange:N=>le("SSAccCode",N.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):d.jsx(We,{sx:{fontSize:"0.75rem"},children:oe.SSAccCode})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:n===oe.ID?d.jsx(On,{size:"small",value:m.TaxAccCode||"",onChange:N=>le("TaxAccCode",N.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):d.jsx(We,{sx:{fontSize:"0.75rem"},children:oe.TaxAccCode})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:n===oe.ID?d.jsx(On,{size:"small",value:m.SSExpCode||"",onChange:N=>le("SSExpCode",N.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):d.jsx(We,{sx:{fontSize:"0.75rem"},children:oe.SSExpCode||""})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:n===oe.ID?d.jsx(On,{size:"small",value:m.TaxExpCode||"",onChange:N=>le("TaxExpCode",N.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):d.jsx(We,{sx:{fontSize:"0.75rem"},children:oe.TaxExpCode||""})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:n===oe.ID?d.jsx(On,{size:"small",value:m.SalExpCode||"",onChange:N=>le("SalExpCode",N.target.value),sx:{"& .MuiInputBase-input":{fontSize:"0.75rem"}}}):d.jsx(We,{sx:{fontSize:"0.75rem"},children:oe.SalExpCode||""})}),d.jsx(Q,{sx:{fontSize:"0.75rem",p:1},children:n===oe.ID?d.jsxs(_e,{sx:{display:"flex",gap:.5},children:[d.jsx(_r,{size:"small",color:"primary",onClick:ie,sx:{p:.5},children:d.jsx(PA,{fontSize:"small"})}),d.jsx(_r,{size:"small",color:"secondary",onClick:de,sx:{p:.5},children:d.jsx(bp,{fontSize:"small"})})]}):d.jsxs(_e,{sx:{display:"flex",gap:.5},children:[d.jsx(_r,{size:"small",color:"primary",onClick:()=>ee(oe),sx:{p:.5},children:d.jsx(bp,{fontSize:"small"})}),d.jsx(_r,{size:"small",color:"error",onClick:()=>j.mutate(oe.ID),sx:{p:.5},children:d.jsx(Rp,{fontSize:"small"})})]})})]},oe.ID))})]})})]})})]}),d.jsx(Wf,{open:e.open,autoHideDuration:e.severity==="error"?1e4:6e3,onClose:()=>r({...e,open:!1}),children:d.jsx(Hs,{severity:e.severity,onClose:()=>r({...e,open:!1}),sx:{fontSize:"0.75rem"},children:e.message})})]})}function Oie(){return d.jsx(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",bgcolor:"background.default",p:2},children:d.jsxs(ua,{elevation:3,sx:{p:4,maxWidth:500,textAlign:"center"},children:[d.jsx(_I,{sx:{fontSize:64,color:"warning.main",mb:2}}),d.jsx(We,{variant:"h4",gutterBottom:!0,children:"Access Pending"}),d.jsx(We,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Your account has been created successfully, but you don't have access to the application yet."}),d.jsx(Hs,{severity:"info",sx:{mt:2,textAlign:"left"},children:d.jsxs(We,{variant:"body2",children:[d.jsx("strong",{children:"Next Steps:"}),d.jsx("br",{}),"Please contact the administrator to grant you access. Once a role is assigned to your account, you will be able to access the application."]})}),d.jsx(We,{variant:"caption",color:"text.secondary",sx:{mt:3,display:"block"},children:"Your user record has been automatically created. An administrator needs to assign you a role before you can proceed."})]})})}function Fie(){const t=Ab();return d.jsx(_e,{sx:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"80vh",p:2},children:d.jsxs(ua,{elevation:3,sx:{p:4,maxWidth:500,textAlign:"center"},children:[d.jsx(NH,{sx:{fontSize:64,color:"error.main",mb:2}}),d.jsx(We,{variant:"h4",gutterBottom:!0,children:"Permission Denied"}),d.jsx(We,{variant:"body1",color:"text.secondary",paragraph:!0,children:"You don't have permission to access this page or perform this action."}),d.jsx(We,{variant:"body2",color:"text.secondary",paragraph:!0,children:"If you believe you should have access, please contact your administrator."}),d.jsx(Un,{variant:"contained",onClick:()=>t("/"),sx:{mt:2},children:"Go to Home"})]})})}const Nie=new LV;function jie(){const{isAuthenticated:t,userDisplayName:e,logout:r}=_p(),{userRole:a,hasAccess:o,getPagePermissions:n,canAccessSettings:f,isSuperAdmin:m,viewingAsRole:y,setViewingAsRole:C}=Gf(),w=()=>{const ie=localStorage.getItem("selectedDate");if(ie)try{return new Date(JSON.parse(ie))}catch{return new Date}return new Date},[A,R]=E.useState(w),[I,M]=E.useState(null),F=!!I,O=ie=>{M(ie.currentTarget)},j=()=>{M(null)},U=ie=>{R(ie),localStorage.setItem("selectedDate",JSON.stringify(ie))},H=["January","February","March","April","May","June","July","August","September","October","November","December"],K=xT(new Date),W=Array.from({length:10},(ie,de)=>K-1+de),X=ie=>{const de=parseInt(ie.target.value),le=new Date(A);le.setMonth(de),U(le)},ee=ie=>{const de=parseInt(ie.target.value),le=new Date(A);le.setFullYear(de),U(le)};return d.jsxs(_e,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[t&&o&&d.jsx(I7,{position:"static",children:d.jsxs(tH,{children:[d.jsx(_e,{component:ml,to:"/",sx:{display:"flex",alignItems:"center",textDecoration:"none",color:"inherit"},children:d.jsx("img",{src:"/logo.png",alt:"Stalo",style:{height:"40px",marginRight:"8px"}})}),d.jsxs(_e,{sx:{flexGrow:1,display:"flex",gap:1,alignItems:"center",ml:2},children:[n("home").canView&&d.jsx(Un,{component:ml,to:"/",color:"inherit",sx:{textTransform:"none"},children:"Home"}),(n("projects").canView||n("positions").canView||n("resources").canView)&&d.jsxs(d.Fragment,{children:[d.jsx(Un,{color:"inherit",sx:{textTransform:"none"},onClick:O,endIcon:d.jsx(FH,{}),children:"Staff Allocation"}),d.jsxs(lp,{anchorEl:I,open:F,onClose:j,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[n("projects").canView&&d.jsx(ln,{component:ml,to:"/projects",onClick:j,children:"Projects"}),n("positions").canView&&d.jsx(ln,{component:ml,to:"/positions",onClick:j,children:"Positions"}),n("resources").canView&&d.jsx(ln,{component:ml,to:"/resources",onClick:j,children:"Resources"})]})]}),n("payroll").canView&&d.jsx(Un,{component:ml,to:"/payroll-allocation",color:"inherit",sx:{textTransform:"none"},children:"Payroll Allocation"}),n("scheduled-records").canView&&d.jsx(Un,{component:ml,to:"/scheduled-records",color:"inherit",sx:{textTransform:"none"},children:"Scheduled Records"}),n("report").canView&&d.jsx(Un,{component:ml,to:"/report",color:"inherit",sx:{textTransform:"none"},children:"Report"}),n("glidepath").canView&&d.jsx(Un,{component:ml,to:"/glidepath",color:"inherit",sx:{textTransform:"none"},children:"Glidepath"}),n("payments").canView&&d.jsx(Un,{component:ml,to:"/payments",color:"inherit",sx:{textTransform:"none"},children:"Payments"})]}),d.jsxs(_e,{sx:{display:"flex",gap:2,alignItems:"center"},children:[d.jsxs(Hr,{sx:{minWidth:150},size:"small",children:[d.jsx(Qi,{sx:{color:"white"},children:"Month"}),d.jsx(Wr,{value:bP(A),label:"Month",onChange:X,sx:{color:"white",".MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.5)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"white"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"white"},".MuiSvgIcon-root":{color:"white"}},children:H.map((ie,de)=>d.jsx(ln,{value:de,children:ie},de))})]}),d.jsxs(Hr,{sx:{minWidth:120},size:"small",children:[d.jsx(Qi,{sx:{color:"white"},children:"Year"}),d.jsx(Wr,{value:xT(A),label:"Year",onChange:ee,sx:{color:"white",".MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255, 255, 255, 0.5)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"white"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"white"},".MuiSvgIcon-root":{color:"white"}},children:W.map(ie=>d.jsx(ln,{value:ie,children:ie},ie))})]}),m&&y&&d.jsx(Mo,{title:"Exit View Mode - Return to Super Admin",children:d.jsx(_r,{onClick:()=>C(null),sx:{color:"white",backgroundColor:"error.main","&:hover":{backgroundColor:"error.dark"},mr:1},size:"small",children:d.jsx(uT,{})})}),d.jsx(Sa,{label:`${e} (${a||"No Role"})`,color:a==="Admin"?"error":y?"warning":"default",size:"small",sx:{color:"white",borderColor:"white"},variant:"outlined"}),f()&&d.jsx(Mo,{title:"Settings",children:d.jsx(_r,{component:ml,to:"/settings",sx:{color:"white"},size:"small",children:d.jsx(VH,{})})}),d.jsx(Mo,{title:"Logout",children:d.jsx(_r,{onClick:r,sx:{color:"white"},size:"small",children:d.jsx(UH,{})})})]})]})}),d.jsx(nT,{maxWidth:"xl",sx:{mt:t&&o?4:0,mb:4,flexGrow:1},children:d.jsxs(jW,{children:[d.jsx(Ci,{path:"/login",element:d.jsx(Mee,{})}),d.jsx(Ci,{path:"/no-access",element:d.jsx(Oie,{})}),d.jsx(Ci,{path:"/permission-denied",element:d.jsx(Fie,{})}),d.jsx(Ci,{path:"/",element:d.jsx(Ic,{page:"home",children:d.jsx(gne,{selectedDate:A})})}),d.jsx(Ci,{path:"/projects",element:d.jsx(Ic,{page:"projects",children:d.jsx(yne,{})})}),d.jsx(Ci,{path:"/gantt",element:d.jsx(Ic,{page:"gantt",children:d.jsx(D_,{selectedDate:A})})}),d.jsx(Ci,{path:"/glidepath",element:d.jsx(Ic,{page:"glidepath",children:d.jsx(Sne,{})})}),d.jsx(Ci,{path:"/payments",element:d.jsx(Ic,{page:"payments",children:d.jsx(jne,{})})}),d.jsx(Ci,{path:"/positions",element:d.jsx(Ic,{page:"positions",children:d.jsx(yie,{})})}),d.jsx(Ci,{path:"/resources",element:d.jsx(Ic,{page:"resources",children:d.jsx(Tie,{})})}),d.jsx(Ci,{path:"/payroll-allocation",element:d.jsx(Ic,{page:"payroll",children:d.jsx(Aie,{selectedDate:A})})}),d.jsx(Ci,{path:"/scheduled-records",element:d.jsx(Ic,{page:"scheduled-records",children:d.jsx(Iie,{})})}),d.jsx(Ci,{path:"/report",element:d.jsx(Ic,{page:"report",children:d.jsx(Pie,{})})}),d.jsx(Ci,{path:"/settings",element:d.jsx(Ic,{page:"settings",children:d.jsx(Mie,{})})})]})})]})}function Lie(){return d.jsx(BV,{client:Nie,children:d.jsx(Iee,{children:d.jsx(Pee,{children:d.jsx(sV,{children:d.jsx(jie,{})})})})})}const Bie=CC({palette:{mode:"light",primary:{main:"#1976d2"},secondary:{main:"#dc004e"}}});LO.createRoot(document.getElementById("root")).render(d.jsx(Jr.StrictMode,{children:d.jsxs(g8,{theme:Bie,children:[d.jsx(mB,{}),d.jsx(Lie,{})]})}));
